import{a as p}from"./rolldown-runtime-BaZ8gS7u.js";import{T as k,b as w,u as y,y as _}from"./framework-DIDnLsp9.js";import"./database-DlIwwAmc.js";import{Sn as u,Xn as P,hn as b}from"./ui-libs-NviTY6uf.js";import{_t as F,dt as M,mt as S,zt as g}from"./index-DyT3K11Y.js";import{n as T}from"./post-YwKphrng.js";import"./linkify-DBRQwEj8.js";import"./hooks-D7kigjh3.js";var r=p(k(),1),e=p(y(),1),C=()=>{const{tag:t}=w(),l=_(),{currentUser:j}=F(),{addToast:n}=S(),[i,c]=(0,r.useState)([]),[v,d]=(0,r.useState)(!0),[o,m]=(0,r.useState)(!1),[x,h]=(0,r.useState)(!0);(0,r.useEffect)(()=>{t&&(async()=>{d(!0);try{const a=await g(`#${t}`,null,10);c(a),h(a.length>=10)}catch(a){console.error("Failed to load hashtag posts:",a),n("Failed to load posts","error")}finally{d(!1)}})()},[t,n]);const N=async()=>{if(!(o||!x)){m(!0);try{const s=i[i.length-1],a=s?s.sortTimestamp:null,f=await g(`#${t}`,a,10);f.length<10&&h(!1),c(z=>[...z,...f])}catch(s){console.error("Failed to load more posts:",s)}finally{m(!1)}}};return(0,e.jsx)("div",{className:"min-h-screen overflow-hidden rounded-none border-zinc-100 bg-white pb-20 dark:border-zinc-800 dark:bg-black md:rounded-xl",children:(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("div",{className:"sticky top-0 z-20 border-b border-zinc-100 bg-white/90 px-4 py-3 backdrop-blur-md dark:border-zinc-800 dark:bg-black/90",children:(0,e.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,e.jsx)("button",{onClick:()=>l(-1),className:"rounded-full p-1 transition-colors hover:bg-zinc-100 dark:text-white dark:hover:bg-zinc-800",children:(0,e.jsx)(P,{size:22})}),(0,e.jsxs)("div",{className:"flex flex-col",children:[(0,e.jsxs)("h5",{className:"text-lg font-bold leading-none dark:text-white",children:["#",t]}),(0,e.jsx)("span",{className:"mt-0.5 text-xs text-zinc-500",children:"Hashtag"})]})]})}),(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("div",{className:"relative h-32 overflow-hidden bg-gradient-to-r from-violet-500/10 to-fuchsia-500/10 sm:h-40",children:(0,e.jsx)("div",{className:"absolute inset-0 bg-grid-white/[0.02] bg-[size:20px_20px]"})}),(0,e.jsxs)("div",{className:"px-4 pb-6",children:[(0,e.jsx)("div",{className:"relative z-10 -mt-10 mb-4 flex items-end justify-between",children:(0,e.jsx)("div",{className:"flex size-20 items-center justify-center rounded-2xl border-4 border-white bg-zinc-100 shadow-xl dark:border-black dark:bg-zinc-800 sm:size-24",children:(0,e.jsx)(u,{size:40,className:"text-zinc-400"})})}),(0,e.jsxs)("div",{className:"space-y-1",children:[(0,e.jsxs)("h1",{className:"text-2xl font-black leading-tight tracking-tight dark:text-white sm:text-3xl",children:["#",t]}),(0,e.jsxs)("p",{className:"text-sm text-zinc-500 sm:text-base",children:["Posts tagged with #",t]})]})]})]}),(0,e.jsx)("div",{className:"border-t border-zinc-100 dark:border-zinc-800",children:v?(0,e.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,e.jsx)(b,{className:"animate-spin text-violet-500",size:32})}):i.length>0?(0,e.jsxs)(e.Fragment,{children:[i.map(s=>(0,e.jsx)(T,{currentUser:j,showToast:n,...s,onClick:()=>l(`/post/${s.id}`),onUserClick:a=>l(`/u/${a}`)},s.feed_id||s.id)),x&&(0,e.jsx)("div",{className:"flex justify-center p-6",children:(0,e.jsxs)(M,{variant:"secondary",className:"w-full max-w-xs",onClick:N,disabled:o,children:[o&&(0,e.jsx)(b,{size:18,className:"mr-2 animate-spin"}),"Load more"]})})]}):(0,e.jsxs)("div",{className:"flex flex-col items-center gap-4 p-20 text-center text-zinc-500",children:[(0,e.jsx)("div",{className:"mb-2 rounded-full bg-zinc-50 p-6 dark:bg-zinc-900",children:(0,e.jsx)(u,{size:40,className:"text-zinc-300"})}),(0,e.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"No posts found"}),(0,e.jsxs)("p",{className:"text-sm max-w-[250px]",children:["Be the first to post with #",t,"!"]})]})})]})})},X=C;export{X as default};
