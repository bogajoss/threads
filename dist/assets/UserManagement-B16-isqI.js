import{o as ce}from"./rolldown-runtime-CIzSbf4l.js";import{c as oe,l as me,w as xe}from"./framework-i0QTTZ5z.js";import"./database-OCX2jLsI.js";import{En as he,Pt as ae,Tn as re,Yt as ie,cn as fe,en as ue,wn as je}from"./ui-libs-BsCs0W7b.js";import{At as ge,Dt as be,Fn as ve,H as te,Mt as pe,Ot as Ne,Ut as K,_t as ye,at as r,b as Se,h as ke,in as ze,it as Q,jt as we,kt as _e,nn as Ce,ot as W,rn as Ue,rt as Z,st as ee,x as le,z as ne}from"./index-C2ebfMwK.js";var de=oe(),D=ce(xe(),1),s=ce(me(),1),De=()=>{const e=(0,de.c)(66),[l,x]=(0,D.useState)("");let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n={role:"all",status:"all"},e[0]=n):n=e[0];const[a,z]=(0,D.useState)(n),{users:R,actions:i}=ke(),[H,h]=(0,D.useState)(null);let w,c,B,u,j,d,L;if(e[1]!==i||e[2]!==a||e[3]!==l||e[4]!==R.data||e[5]!==R.isLoading){L=Symbol.for("react.early_return_sentinel");e:{let O;if(e[13]!==a||e[14]!==l?(O=t=>{if(!t)return!1;const f=t.name.toLowerCase().includes(l.toLowerCase())||t.handle.toLowerCase().includes(l.toLowerCase()),T=a.role==="all"||t.role===a.role,E=a.status==="all"||a.status==="verified"&&t.verified||a.status==="unverified"&&!t.verified||a.status==="banned"&&t.isBanned;return f&&T&&E},e[13]=a,e[14]=l,e[15]=O):O=e[15],w=(R.data||[]).filter(O),R.isLoading){let t;e[16]===Symbol.for("react.memo_cache_sentinel")?(t=(0,s.jsx)("div",{className:"flex min-h-[600px] items-center justify-center",children:(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,s.jsx)(he,{className:"h-8 w-8 animate-spin text-violet-600"}),(0,s.jsx)("p",{className:"text-sm font-semibold text-zinc-500",children:"Loading users..."})]})}),e[16]=t):t=e[16],L=t;break e}u="space-y-6",e[17]===Symbol.for("react.memo_cache_sentinel")?(j=(0,s.jsx)("div",{className:"space-y-2",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-violet-600 text-white",children:(0,s.jsx)(ae,{className:"h-5 w-5"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-black tracking-tight",children:"User Directory"}),(0,s.jsx)("p",{className:"text-sm text-zinc-500",children:"Manage platform users and permissions"})]})]})}),e[17]=j):j=e[17];let I;e[18]===Symbol.for("react.memo_cache_sentinel")?(I=(0,s.jsx)(ue,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 text-zinc-400"}),e[18]=I):I=e[18];let q;e[19]===Symbol.for("react.memo_cache_sentinel")?(q=t=>x(t.target.value),e[19]=q):q=e[19];let o;e[20]!==l?(o=(0,s.jsxs)("div",{className:"relative",children:[I,(0,s.jsx)(ye,{placeholder:"Search by name or handle...",value:l,onChange:q,className:"h-11 rounded-xl border-zinc-200 bg-white pl-10 text-sm font-medium dark:border-zinc-800 dark:bg-black"})]}),e[20]=l,e[21]=o):o=e[21];let b;e[22]!==a?(b=t=>z({...a,role:t}),e[22]=a,e[23]=b):b=e[23];let v;e[24]===Symbol.for("react.memo_cache_sentinel")?(v=(0,s.jsx)(W,{className:"w-[180px] rounded-xl border-zinc-200 dark:border-zinc-800",children:(0,s.jsx)(ee,{placeholder:"Filter by role"})}),e[24]=v):v=e[24];let P;e[25]===Symbol.for("react.memo_cache_sentinel")?(P=(0,s.jsxs)(Q,{className:"rounded-xl dark:bg-zinc-900",children:[(0,s.jsx)(r,{value:"all",children:"All Roles"}),(0,s.jsx)(r,{value:"user",children:"Users"}),(0,s.jsx)(r,{value:"moderator",children:"Moderators"}),(0,s.jsx)(r,{value:"admin",children:"Admins"})]}),e[25]=P):P=e[25];let p;e[26]!==a.role||e[27]!==b?(p=(0,s.jsxs)(Z,{value:a.role,onValueChange:b,children:[v,P]}),e[26]=a.role,e[27]=b,e[28]=p):p=e[28];let N;e[29]!==a?(N=t=>z({...a,status:t}),e[29]=a,e[30]=N):N=e[30];let y;e[31]===Symbol.for("react.memo_cache_sentinel")?(y=(0,s.jsx)(W,{className:"w-[180px] rounded-xl border-zinc-200 dark:border-zinc-800",children:(0,s.jsx)(ee,{placeholder:"Filter by status"})}),e[31]=y):y=e[31];let A;e[32]===Symbol.for("react.memo_cache_sentinel")?(A=(0,s.jsxs)(Q,{className:"rounded-xl dark:bg-zinc-900",children:[(0,s.jsx)(r,{value:"all",children:"All Status"}),(0,s.jsx)(r,{value:"verified",children:"Verified"}),(0,s.jsx)(r,{value:"unverified",children:"Unverified"}),(0,s.jsx)(r,{value:"banned",children:"Banned"})]}),e[32]=A):A=e[32];let S;e[33]!==a.status||e[34]!==N?(S=(0,s.jsxs)(Z,{value:a.status,onValueChange:N,children:[y,A]}),e[33]=a.status,e[34]=N,e[35]=S):S=e[35];let k;e[36]!==a.role||e[37]!==a.status?(k=(a.role!=="all"||a.status!=="all")&&(0,s.jsx)(K,{variant:"outline",size:"sm",onClick:()=>z({role:"all",status:"all"}),className:"rounded-xl",children:"Clear Filters"}),e[36]=a.role,e[37]=a.status,e[38]=k):k=e[38];let m;e[39]!==p||e[40]!==S||e[41]!==k?(m=(0,s.jsxs)("div",{className:"flex flex-wrap gap-3",children:[p,S,k]}),e[39]=p,e[40]=S,e[41]=k,e[42]=m):m=e[42],e[43]!==o||e[44]!==m?(d=(0,s.jsxs)("div",{className:"space-y-4",children:[o,m]}),e[43]=o,e[44]=m,e[45]=d):d=e[45],c="overflow-hidden rounded-3xl border border-zinc-200 dark:border-zinc-800",B=w.length===0?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center bg-white py-12 text-center dark:bg-black",children:[(0,s.jsx)(ae,{className:"h-12 w-12 text-zinc-300 dark:text-zinc-700"}),(0,s.jsx)("p",{className:"mt-4 font-semibold text-zinc-600 dark:text-zinc-400",children:"No users found"}),(0,s.jsx)("p",{className:"text-sm text-zinc-500",children:"Try adjusting your search or filters"})]}):(0,s.jsx)("div",{className:"divide-y divide-zinc-200 bg-white dark:divide-zinc-800 dark:bg-black",children:w.map(t=>t?(0,s.jsxs)("div",{className:"flex flex-col gap-4 p-4 transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900/50 sm:flex-row sm:items-center sm:justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 min-w-0",children:[(0,s.jsxs)("div",{className:"relative shrink-0",children:[(0,s.jsxs)(Ce,{className:"h-12 w-12 rounded-2xl ring-2 ring-zinc-200 dark:ring-zinc-800",children:[(0,s.jsx)(ze,{src:t.avatar,className:"rounded-2xl"}),(0,s.jsx)(Ue,{className:"rounded-2xl bg-violet-500/10 text-sm font-bold text-violet-600",children:t.name[0]?.toUpperCase()})]}),t.verified&&(0,s.jsx)(te,{size:20,className:"absolute -bottom-2 -right-2 rounded-full bg-white p-0.5"}),t.isPro&&(0,s.jsx)(ne,{size:20,className:"absolute -bottom-2 -left-2 rounded-full bg-white p-0.5"})]}),(0,s.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,s.jsx)("h3",{className:"truncate font-semibold text-foreground",children:t.name}),(0,s.jsxs)("p",{className:"truncate text-sm text-zinc-500",children:["@",t.handle]})]})]}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2 sm:justify-end",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 rounded-xl bg-zinc-100 px-3 py-1.5 dark:bg-zinc-900",children:[(0,s.jsx)(je,{className:"h-3.5 w-3.5 text-zinc-600 dark:text-zinc-400"}),(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wider text-zinc-700 dark:text-zinc-300",children:t.role})]}),(0,s.jsx)("div",{className:"flex items-center gap-2 rounded-xl bg-zinc-100 px-3 py-1.5 dark:bg-zinc-900",children:(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wider text-zinc-700 dark:text-zinc-300",children:t.roles})}),t.isPro&&(0,s.jsxs)("div",{className:"flex items-center gap-1.5 rounded-xl bg-amber-500/10 px-3 py-1.5",children:[(0,s.jsx)(ne,{size:14}),(0,s.jsx)("span",{className:"text-xs font-semibold text-amber-700 dark:text-amber-400",children:"PRO"})]}),t.verified&&(0,s.jsxs)("div",{className:"flex items-center gap-1.5 rounded-xl bg-blue-500/10 px-3 py-1.5",children:[(0,s.jsx)(te,{size:14}),(0,s.jsx)("span",{className:"text-xs font-semibold text-blue-700 dark:text-blue-400",children:"Verified"})]}),t.isBanned&&(0,s.jsxs)("div",{className:"flex items-center gap-1.5 rounded-xl bg-rose-500/10 px-3 py-1.5",children:[(0,s.jsx)(ie,{className:"h-3.5 w-3.5 text-rose-600 dark:text-rose-400"}),(0,s.jsx)("span",{className:"text-xs font-semibold text-rose-700 dark:text-rose-400",children:"Banned"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 sm:justify-end",children:[(0,s.jsx)(K,{variant:"outline",size:"sm",onClick:()=>h(t),title:"Manage user",className:"h-9 rounded-lg px-3",children:(0,s.jsx)(fe,{className:"h-4 w-4"})}),(0,s.jsxs)(Z,{value:t.role,onValueChange:f=>i.updateRole({userId:t.id,role:f}),children:[(0,s.jsx)(W,{className:"w-[130px] rounded-lg border-zinc-200 text-xs font-semibold dark:border-zinc-800",children:(0,s.jsx)(ee,{})}),(0,s.jsxs)(Q,{className:"rounded-xl dark:bg-zinc-900",children:[(0,s.jsx)(r,{value:"user",children:"User"}),(0,s.jsx)(r,{value:"moderator",children:"Moderator"}),(0,s.jsx)(r,{value:"admin",children:"Admin"})]})]}),(0,s.jsx)(K,{variant:"outline",size:"sm",onClick:()=>i.toggleVerification({userId:t.id,verified:!t.verified}),title:t.verified?"Remove verification":"Verify user",className:"h-9 rounded-lg px-3",children:t.verified?(0,s.jsx)(re,{className:"h-4 w-4"}):(0,s.jsx)(te,{size:16})}),(0,s.jsx)(K,{variant:"outline",size:"sm",onClick:()=>{const f=t.isBanned?"unban":"ban";confirm(`Are you sure you want to ${f} @${t.handle}?`)&&i.toggleBan({userId:t.id,banned:!t.isBanned})},title:t.isBanned?"Unban user":"Ban user",className:ve("h-9 rounded-lg px-3",t.isBanned?"border-emerald-200 bg-emerald-50 text-emerald-700 hover:bg-emerald-100 dark:border-emerald-900 dark:bg-emerald-900/20 dark:text-emerald-400":"border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 dark:border-rose-900 dark:bg-rose-900/20 dark:text-rose-400"),children:t.isBanned?(0,s.jsx)(re,{className:"h-4 w-4"}):(0,s.jsx)(ie,{className:"h-4 w-4"})})]})]},t.id):null)})}e[1]=i,e[2]=a,e[3]=l,e[4]=R.data,e[5]=R.isLoading,e[6]=w,e[7]=c,e[8]=B,e[9]=u,e[10]=j,e[11]=d,e[12]=L}else w=e[6],c=e[7],B=e[8],u=e[9],j=e[10],d=e[11],L=e[12];if(L!==Symbol.for("react.early_return_sentinel"))return L;let _;e[46]!==c||e[47]!==B?(_=(0,s.jsx)("div",{className:c,children:B}),e[46]=c,e[47]=B,e[48]=_):_=e[48];let M;e[49]!==w.length?(M=(0,s.jsx)("span",{className:"font-semibold text-foreground",children:w.length}),e[49]=w.length,e[50]=M):M=e[50];const $=R.data?.length||0;let C;e[51]!==$?(C=(0,s.jsx)("span",{className:"font-semibold text-foreground",children:$}),e[51]=$,e[52]=C):C=e[52];let g;e[53]!==C||e[54]!==M?(g=(0,s.jsx)("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4 dark:border-zinc-800 dark:bg-black",children:(0,s.jsxs)("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:["Showing"," ",M," ","of"," ",C," ","users"]})}),e[53]=C,e[54]=M,e[55]=g):g=e[55];let F;e[56]!==i||e[57]!==H?(F=H&&(0,s.jsx)(Re,{user:H,onClose:()=>h(null),actions:i}),e[56]=i,e[57]=H,e[58]=F):F=e[58];let V;return e[59]!==g||e[60]!==F||e[61]!==u||e[62]!==j||e[63]!==d||e[64]!==_?(V=(0,s.jsxs)("div",{className:u,children:[j,d,_,g,F]}),e[59]=g,e[60]=F,e[61]=u,e[62]=j,e[63]=d,e[64]=_,e[65]=V):V=e[65],V},Re=e=>{const l=(0,de.c)(54),{user:x,onClose:n,actions:a}=e,[z,R]=(0,D.useState)(x.roles||"Newbie"),[i,H]=(0,D.useState)(x.role||"user"),[h,w]=(0,D.useState)(x.isPro||!1),[c,B]=(0,D.useState)(30),[u,j]=(0,D.useState)(!1),[d,L]=(0,D.useState)(!1),[_,M]=(0,D.useState)(!1);let $;l[0]!==a||l[1]!==h||l[2]!==u||l[3]!==_||l[4]!==d||l[5]!==n||l[6]!==c||l[7]!==i||l[8]!==x.id||l[9]!==z?($=async()=>{let U=null;u&&(U=h?c:0),_&&await a.updateRoleAsync({userId:x.id,role:i}),(d||u)&&a.adminUpdateUser({userId:x.id,role:d?z:null,proValidityDays:U}),n()},l[0]=a,l[1]=h,l[2]=u,l[3]=_,l[4]=d,l[5]=n,l[6]=c,l[7]=i,l[8]=x.id,l[9]=z,l[10]=$):$=l[10];const C=$;let g;l[11]===Symbol.for("react.memo_cache_sentinel")?(g=U=>{R(U),L(!0)},l[11]=g):g=l[11];const F=g;let V;l[12]===Symbol.for("react.memo_cache_sentinel")?(V=U=>{H(U),M(!0)},l[12]=V):V=l[12];const O=V;let I;l[13]===Symbol.for("react.memo_cache_sentinel")?(I=U=>{w(U),j(!0)},l[13]=I):I=l[13];const q=I;let o;l[14]!==x.name?(o=(0,s.jsxs)(pe,{children:["Manage ",x.name]}),l[14]=x.name,l[15]=o):o=l[15];let b;l[16]===Symbol.for("react.memo_cache_sentinel")?(b=(0,s.jsx)(_e,{children:"Update user role and pro status. Changes are saved upon clicking 'Save changes'."}),l[16]=b):b=l[16];let v;l[17]!==o?(v=(0,s.jsxs)(we,{children:[o,b]}),l[17]=o,l[18]=v):v=l[18];let P;l[19]===Symbol.for("react.memo_cache_sentinel")?(P=(0,s.jsx)(le,{htmlFor:"system-role",className:"text-right",children:"System Role"}),l[19]=P):P=l[19];let p;l[20]===Symbol.for("react.memo_cache_sentinel")?(p=(0,s.jsx)(W,{children:(0,s.jsx)(ee,{placeholder:"Select a role"})}),l[20]=p):p=l[20];let N;l[21]===Symbol.for("react.memo_cache_sentinel")?(N=(0,s.jsxs)(Q,{children:[(0,s.jsx)(r,{value:"user",children:"User"}),(0,s.jsx)(r,{value:"moderator",children:"Moderator"}),(0,s.jsx)(r,{value:"admin",children:"Admin"})]}),l[21]=N):N=l[21];let y;l[22]!==i?(y=(0,s.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[P,(0,s.jsx)("div",{className:"col-span-3",children:(0,s.jsxs)(Z,{value:i,onValueChange:O,children:[p,N]})})]}),l[22]=i,l[23]=y):y=l[23];let A;l[24]===Symbol.for("react.memo_cache_sentinel")?(A=(0,s.jsx)(le,{htmlFor:"user-role",className:"text-right",children:"User Role"}),l[24]=A):A=l[24];let S;l[25]===Symbol.for("react.memo_cache_sentinel")?(S=(0,s.jsx)(W,{children:(0,s.jsx)(ee,{placeholder:"Select a role"})}),l[25]=S):S=l[25];let k;l[26]===Symbol.for("react.memo_cache_sentinel")?(k=(0,s.jsxs)(Q,{children:[(0,s.jsx)(r,{value:"Newbie",children:"Newbie"}),(0,s.jsx)(r,{value:"Hunter",children:"Hunter"}),(0,s.jsx)(r,{value:"Elite",children:"Elite"})]}),l[26]=k):k=l[26];let m;l[27]!==z?(m=(0,s.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[A,(0,s.jsx)("div",{className:"col-span-3",children:(0,s.jsxs)(Z,{value:z,onValueChange:F,children:[S,k]})})]}),l[27]=z,l[28]=m):m=l[28];let t;l[29]===Symbol.for("react.memo_cache_sentinel")?(t=(0,s.jsx)(le,{htmlFor:"is-pro",className:"text-right",children:"Pro Status"}),l[29]=t):t=l[29];let f;l[30]!==h?(f=(0,s.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[t,(0,s.jsx)(Se,{id:"is-pro",checked:h,onCheckedChange:q})]}),l[30]=h,l[31]=f):f=l[31];let T;l[32]!==h||l[33]!==c?(T=h&&(0,s.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,s.jsx)(le,{htmlFor:"validity",className:"text-right",children:"Validity"}),(0,s.jsx)("div",{className:"col-span-3",children:(0,s.jsxs)(Z,{value:String(c),onValueChange:U=>{B(Number(U)),j(!0)},children:[(0,s.jsx)(W,{children:(0,s.jsx)(ee,{placeholder:"Select validity"})}),(0,s.jsxs)(Q,{children:[(0,s.jsx)(r,{value:"7",children:"7 days"}),(0,s.jsx)(r,{value:"15",children:"15 days"}),(0,s.jsx)(r,{value:"30",children:"30 days"}),(0,s.jsx)(r,{value:"90",children:"90 days"}),(0,s.jsx)(r,{value:"365",children:"365 days"})]})]})})]}),l[32]=h,l[33]=c,l[34]=T):T=l[34];let E;l[35]!==y||l[36]!==m||l[37]!==f||l[38]!==T?(E=(0,s.jsxs)("div",{className:"grid gap-6 py-4",children:[y,m,f,T]}),l[35]=y,l[36]=m,l[37]=f,l[38]=T,l[39]=E):E=l[39];let X;l[40]!==n?(X=(0,s.jsx)(K,{variant:"outline",onClick:n,children:"Cancel"}),l[40]=n,l[41]=X):X=l[41];let Y;l[42]!==C?(Y=(0,s.jsx)(K,{onClick:C,children:"Save changes"}),l[42]=C,l[43]=Y):Y=l[43];let G;l[44]!==X||l[45]!==Y?(G=(0,s.jsxs)(ge,{children:[X,Y]}),l[44]=X,l[45]=Y,l[46]=G):G=l[46];let J;l[47]!==E||l[48]!==G||l[49]!==v?(J=(0,s.jsxs)(Ne,{className:"sm:max-w-[425px] rounded-2xl",children:[v,E,G]}),l[47]=E,l[48]=G,l[49]=v,l[50]=J):J=l[50];let se;return l[51]!==n||l[52]!==J?(se=(0,s.jsx)(be,{open:!0,onOpenChange:n,children:J}),l[51]=n,l[52]=J,l[53]=se):se=l[53],se},Le=De;export{Le as default};
