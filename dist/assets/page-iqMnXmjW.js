import{a as u}from"./rolldown-runtime-BaZ8gS7u.js";import{b as v,l as y,v as N,w as k}from"./framework-3lkjbTvb.js";import"./database-COznt_u0.js";import{An as w,er as z,mr as S,nr as _}from"./ui-libs-oBja7Jpd.js";import"./media-libs-C98UjHPF.js";import{Ut as C,a as P,dn as T,ln as A}from"./index-BLu3NtD3.js";var s=u(k(),1),e=u(y(),1),V=()=>{const t=N(),[d]=v(),{verifyOtp:f}=T(),{addToast:l}=A(),i=d.get("email")||"",r=d.get("type")||"signup",[a,h]=(0,s.useState)(""),[g,c]=(0,s.useState)(!1),[m,n]=(0,s.useState)(null),[p,b]=(0,s.useState)(!1);(0,s.useEffect)(()=>{i||t("/login")},[i,t]);const j=async o=>{if(o.preventDefault(),a.length<6){n("Please enter the 6-digit code");return}c(!0),n(null);try{await f(i,a,r),b(!0),l(r==="signup"?"Account verified!":"Code verified!"),setTimeout(()=>{t(r==="signup"?"/":"/reset-password")},1500)}catch(x){console.error("OTP Verification error:",x),n(x.message||"Invalid or expired code. Please try again."),l("Verification failed","error")}finally{c(!1)}};return(0,e.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-background p-4",children:(0,e.jsx)(P,{noBackground:!0,className:"flex items-center justify-center",children:(0,e.jsxs)("div",{className:"mx-auto w-full max-w-md animate-in fade-in slide-in-from-bottom-5 duration-300 p-8 bg-card border border-border rounded-3xl shadow-xl",children:[(0,e.jsxs)("button",{onClick:()=>t(r==="signup"?"/register":"/forgot-password"),className:"group mb-8 flex items-center gap-2 text-sm font-medium text-zinc-500 transition-colors hover:text-black dark:hover:text-white",children:[(0,e.jsx)("div",{className:"flex size-8 items-center justify-center rounded-full border border-border bg-secondary transition-all group-hover:scale-110",children:(0,e.jsx)(S,{size:16})}),"Change Email"]}),(0,e.jsxs)("div",{className:"mb-10 text-center",children:[(0,e.jsx)("div",{className:"mb-6 flex justify-center",children:(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("div",{className:"absolute inset-0 scale-150 bg-indigo-500/20 blur-2xl rounded-full"}),(0,e.jsx)("div",{className:"relative flex size-20 items-center justify-center rounded-3xl bg-gradient-to-br from-indigo-500 to-indigo-700 p-4 shadow-xl shadow-indigo-500/20 text-white",children:(0,e.jsx)(w,{size:40,strokeWidth:1.5})})]})}),(0,e.jsx)("h2",{className:"mb-3 text-3xl font-extrabold tracking-tight dark:text-white md:text-4xl",children:"Verification"}),(0,e.jsxs)("p",{className:"font-medium text-zinc-500",children:["Enter the 6-digit code sent to ",(0,e.jsx)("br",{}),(0,e.jsx)("span",{className:"font-bold text-indigo-500",children:i})]})]}),p?(0,e.jsx)("div",{className:"space-y-6 animate-in zoom-in-95 duration-500",children:(0,e.jsxs)("div",{className:"flex flex-col items-center gap-4 rounded-3xl bg-emerald-500/10 p-8 border border-emerald-500/20 text-emerald-600 dark:text-emerald-400 text-center",children:[(0,e.jsx)("div",{className:"flex size-16 items-center justify-center rounded-full bg-emerald-500/20 shadow-inner",children:(0,e.jsx)(z,{size:32})}),(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"mb-2 font-black text-xl dark:text-white",children:"Verified Successfully"}),(0,e.jsx)("p",{className:"text-sm text-zinc-500",children:r==="signup"?"Welcome to MySys! Getting things ready...":"Identity confirmed. One more step..."})]})]})}):(0,e.jsxs)("form",{onSubmit:j,className:"space-y-8",children:[(0,e.jsx)("div",{className:"space-y-4",children:(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("input",{type:"text",maxLength:6,placeholder:"••••••",value:a,onChange:o=>h(o.target.value.replace(/[^0-9]/g,"")),className:"w-full tracking-[1.2rem] rounded-[1.5rem] border border-border bg-secondary px-6 py-6 text-center text-4xl font-black dark:text-white placeholder:text-zinc-300 dark:placeholder:text-zinc-700 focus:border-indigo-500 focus:outline-none transition-all",required:!0,autoFocus:!0}),(0,e.jsx)("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center opacity-5 dark:opacity-10",children:(0,e.jsx)("div",{className:"h-0.5 w-4/5 border-b-2 border-dashed border-zinc-900 dark:border-white"})})]})}),m&&(0,e.jsxs)("div",{className:"flex items-center gap-3 rounded-2xl bg-rose-500/10 p-4 text-sm text-rose-600 dark:text-rose-400 border border-rose-500/20 animate-in slide-in-from-top-2",children:[(0,e.jsx)(_,{size:18}),(0,e.jsx)("span",{className:"font-medium",children:m})]}),(0,e.jsx)(C,{type:"submit",className:"w-full py-4 text-lg font-bold",loading:g,children:"Verify Account"})]}),(0,e.jsx)("div",{className:"mt-10 pt-8 text-center border-t border-border",children:(0,e.jsxs)("p",{className:"text-sm font-medium text-zinc-500",children:["Didn't receive the code? "," ",(0,e.jsx)("button",{onClick:()=>t(r==="signup"?"/register":"/forgot-password"),className:"font-bold hover:underline dark:text-white",children:"Resend Code"})]})})]})})})},I=V;export{I as default};
