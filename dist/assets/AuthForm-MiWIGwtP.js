import{a as x}from"./rolldown-runtime-BaZ8gS7u.js";import{c as w,s as N}from"./animations-DZuN0xpW.js";import{Sn as k,Yn as S,Zn as _,qn as C}from"./ui-libs-BV6sU6gG.js";import{Jt as z,Wt as y,Xt as A,dt as m,mn as q}from"./index-DwFQeZBj.js";var t=x(w(),1),e=x(N(),1),L=({type:l,onComplete:g,onSwitch:b})=>{const{login:f,signup:p}=A(),{addToast:c}=z(),[a,n]=(0,t.useState)({name:"",email:"",username:"",password:""}),[v,d]=(0,t.useState)(!1),[u,h]=(0,t.useState)(null),[r,i]=(0,t.useState)({loading:!1,available:null});(0,t.useEffect)(()=>{if(l==="signup"&&a.username.length>=5){const s=setTimeout(async()=>{i({loading:!0,available:null});try{i({loading:!1,available:await q(a.username)})}catch{i({loading:!1,available:null})}},500);return()=>clearTimeout(s)}else i({loading:!1,available:null})},[a.username,l]);const j=async s=>{if(s.preventDefault(),l==="signup"&&(r.available===!1||a.username.length<5)){c(a.username.length<5?"Username must be at least 5 characters":"Please choose a different username","error");return}d(!0),h(null);try{l==="login"?(await f({email:a.email,password:a.password}),c("Welcome back!"),g()):(await p({email:a.email,password:a.password,username:a.username,name:a.name}),window.location.href="/onboarding")}catch(o){console.error("Auth error:",o),h(o.message||"Authentication failed. Please check your credentials."),c("Authentication failed!","error")}finally{d(!1)}};return(0,e.jsxs)("div",{className:"mx-auto w-full max-w-md animate-in fade-in slide-in-from-bottom-5 duration-300 p-8",children:[(0,e.jsxs)("div",{className:"mb-8 text-center",children:[(0,e.jsx)("div",{className:"mb-4 flex justify-center",children:(0,e.jsx)("div",{className:"rounded-2xl bg-black p-3 shadow-lg text-white dark:bg-white dark:text-black",children:(0,e.jsx)("img",{src:"/logo.webp",alt:"Logo",className:"size-16 rounded-2xl shadow-xl"})})}),(0,e.jsx)("h2",{className:"mb-2 text-3xl font-extrabold tracking-tight dark:text-white",children:l==="login"?"Welcome back!":"Join MySys today"}),(0,e.jsx)("p",{className:"font-medium text-zinc-500",children:"The decentralized social network"})]}),u&&(0,e.jsxs)("div",{className:"mb-6 flex items-center gap-3 rounded-xl border border-rose-100 bg-rose-50 p-4 text-sm text-rose-600 dark:border-rose-800 dark:bg-rose-900/20 dark:text-rose-400",children:[(0,e.jsx)(_,{size:18}),(0,e.jsx)("span",{children:u})]}),(0,e.jsxs)("form",{onSubmit:j,className:"space-y-4",children:[(0,e.jsx)(m,{label:"Email",type:"email",placeholder:"john@example.com",value:a.email,onChange:s=>n({...a,email:s.target.value}),required:!0}),l==="signup"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(m,{label:"Name",placeholder:"John Doe",value:a.name,onChange:s=>n({...a,name:s.target.value}),required:!0}),(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)(m,{label:"Username",placeholder:"johndoe",value:a.username,onChange:s=>{const o=s.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"");n({...a,username:o})},required:!0}),(0,e.jsx)("div",{className:"absolute right-3 top-[38px]",children:r.loading?(0,e.jsx)(k,{size:18,className:"animate-spin text-zinc-400"}):r.available===!0?(0,e.jsx)(S,{size:18,className:"text-emerald-500"}):r.available===!1?(0,e.jsx)(C,{size:18,className:"text-rose-500"}):null})]})]}),(0,e.jsx)(m,{label:"Password",type:"password",placeholder:"••••••••",value:a.password,onChange:s=>n({...a,password:s.target.value}),required:!0}),(0,e.jsx)(y,{type:"submit",className:"mt-6 w-full justify-center py-3 text-lg",loading:v,disabled:l==="signup"&&(r.available===!1||a.username.length<5),children:l==="login"?"Log in":"Sign up"})]}),(0,e.jsxs)("div",{className:"mt-8 text-center text-sm",children:[(0,e.jsx)("span",{className:"text-zinc-500",children:l==="login"?"Don't have an account?":"Already have an account?"}),(0,e.jsx)("button",{onClick:b,className:"ml-1 font-bold hover:underline dark:text-white",children:l==="login"?"Sign up":"Log in"})]})]})},U=L;export{U as t};
