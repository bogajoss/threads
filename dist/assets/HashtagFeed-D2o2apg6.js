import{a as y}from"./rolldown-runtime-BaZ8gS7u.js";import{E as F,b as S,c as M,d as $,x as q}from"./framework-CsA6nn9m.js";import{t as C}from"./query-QyXblnmD.js";import"./database-t9niRmCR.js";import{An as k,Sn as w,tr as H}from"./ui-libs-iJ4uMYcB.js";import{Ut as T,_t as L,bt as U,mt as A}from"./index-d64rCz7a.js";import{n as B}from"./post-DxpbvoBd.js";import"./linkify-CDs92yJ8.js";import"./hooks-CvRtEtMt.js";var E=M(),te=y(F(),1);const I=()=>{const e=(0,E.c)(19),{tag:s}=q(),x=S(),{currentUser:g}=U(),{addToast:h}=L();let i,l;e[0]!==s?(i=["hashtag",s],l=b=>{const{pageParam:j}=b;return T(`#${s}`,j,10)},e[0]=s,e[1]=i,e[2]=l):(i=e[1],l=e[2]);const a=!!s;let f;e[3]!==i||e[4]!==l||e[5]!==a?(f={queryKey:i,queryFn:l,initialPageParam:null,getNextPageParam:K,enabled:a},e[3]=i,e[4]=l,e[5]=a,e[6]=f):f=e[6];const{data:p,fetchNextPage:n,hasNextPage:u,isFetchingNextPage:c,isLoading:o}=C(f);let m;e[7]!==p?.pages?(m=p?.pages.flatMap(Q)||[],e[7]=p?.pages,e[8]=m):m=e[8];const d=m;let r;return e[9]!==h||e[10]!==g||e[11]!==n||e[12]!==u||e[13]!==c||e[14]!==o||e[15]!==x||e[16]!==d||e[17]!==s?(r={tag:s,posts:d,loading:o,fetchingMore:c,hasMore:u,loadMore:n,navigate:x,currentUser:g,addToast:h},e[9]=h,e[10]=g,e[11]=n,e[12]=u,e[13]=c,e[14]=o,e[15]=x,e[16]=d,e[17]=s,e[18]=r):r=e[18],r};function K(e){if(!(!e||e.length<10))return e[e.length-1].sortTimestamp||e[e.length-1].created_at}function Q(e){return e}var D=M(),t=y($(),1),G=()=>{const e=(0,D.c)(31),{tag:s,posts:x,loading:g,fetchingMore:h,hasMore:i,loadMore:l,navigate:a,currentUser:f,addToast:p}=I();let n;e[0]!==a?(n=()=>a(-1),e[0]=a,e[1]=n):n=e[1];let u;e[2]===Symbol.for("react.memo_cache_sentinel")?(u=(0,t.jsx)(H,{size:22}),e[2]=u):u=e[2];let c;e[3]!==n?(c=(0,t.jsx)("button",{onClick:n,className:"rounded-full p-1 transition-colors hover:bg-zinc-100 dark:text-white dark:hover:bg-zinc-800",children:u}),e[3]=n,e[4]=c):c=e[4];let o;e[5]!==s?(o=(0,t.jsxs)("h5",{className:"text-lg font-bold leading-none dark:text-white",children:["#",s]}),e[5]=s,e[6]=o):o=e[6];let m;e[7]===Symbol.for("react.memo_cache_sentinel")?(m=(0,t.jsx)("span",{className:"mt-0.5 text-xs text-zinc-500",children:"Hashtag"}),e[7]=m):m=e[7];let d;e[8]!==o?(d=(0,t.jsxs)("div",{className:"flex flex-col",children:[o,m]}),e[8]=o,e[9]=d):d=e[9];let r;e[10]!==c||e[11]!==d?(r=(0,t.jsx)("div",{className:"sticky top-0 z-20 border-b border-zinc-100 bg-white/90 px-4 py-3 backdrop-blur-md dark:border-zinc-800 dark:bg-black/90",children:(0,t.jsxs)("div",{className:"flex items-center gap-x-4",children:[c,d]})}),e[10]=c,e[11]=d,e[12]=r):r=e[12];let b;e[13]===Symbol.for("react.memo_cache_sentinel")?(b=(0,t.jsx)("div",{className:"relative h-32 overflow-hidden bg-gradient-to-r from-violet-500/10 to-fuchsia-500/10 sm:h-40",children:(0,t.jsx)("div",{className:"absolute inset-0 bg-grid-white/[0.02] bg-[size:20px_20px]"})}),e[13]=b):b=e[13];let j;e[14]===Symbol.for("react.memo_cache_sentinel")?(j=(0,t.jsx)("div",{className:"relative z-10 -mt-10 mb-4 flex items-end justify-between",children:(0,t.jsx)("div",{className:"flex size-20 items-center justify-center rounded-2xl border-4 border-white bg-zinc-100 shadow-xl dark:border-black dark:bg-zinc-800 sm:size-24",children:(0,t.jsx)(k,{size:40,className:"text-zinc-400"})})}),e[14]=j):j=e[14];let v;e[15]!==s?(v=(0,t.jsxs)("div",{className:"relative",children:[b,(0,t.jsxs)("div",{className:"px-4 pb-6",children:[j,(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("h1",{className:"text-2xl font-black leading-tight tracking-tight dark:text-white sm:text-3xl",children:["#",s]}),(0,t.jsxs)("p",{className:"text-sm text-zinc-500 sm:text-base",children:["Posts tagged with #",s]})]})]})]}),e[15]=s,e[16]=v):v=e[16];let N;e[17]!==p||e[18]!==f||e[19]!==h||e[20]!==i||e[21]!==l||e[22]!==g||e[23]!==a||e[24]!==x||e[25]!==s?(N=(0,t.jsx)("div",{className:"border-t border-zinc-100 dark:border-zinc-800",children:g?(0,t.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,t.jsx)(w,{className:"animate-spin text-violet-500",size:32})}):x.length>0?(0,t.jsxs)(t.Fragment,{children:[x.map(z=>(0,t.jsx)(B,{currentUser:f,showToast:p,...z,onClick:()=>a(`/post/${z.id}`),onUserClick:P=>a(`/u/${P}`)},z.feed_id||z.id)),i&&(0,t.jsx)("div",{className:"flex justify-center p-6",children:(0,t.jsxs)(A,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>l(),disabled:h,children:[h&&(0,t.jsx)(w,{size:18,className:"mr-2 animate-spin"}),"Load more"]})})]}):(0,t.jsxs)("div",{className:"flex flex-col items-center gap-4 p-20 text-center text-zinc-500",children:[(0,t.jsx)("div",{className:"mb-2 rounded-full bg-zinc-50 p-6 dark:bg-zinc-900",children:(0,t.jsx)(k,{size:40,className:"text-zinc-300"})}),(0,t.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"No posts found"}),(0,t.jsxs)("p",{className:"text-sm max-w-[250px]",children:["Be the first to post with #",s,"!"]})]})}),e[17]=p,e[18]=f,e[19]=h,e[20]=i,e[21]=l,e[22]=g,e[23]=a,e[24]=x,e[25]=s,e[26]=N):N=e[26];let _;return e[27]!==N||e[28]!==r||e[29]!==v?(_=(0,t.jsx)("div",{className:"min-h-screen overflow-hidden rounded-none border-zinc-100 bg-white pb-20 dark:border-zinc-800 dark:bg-black md:rounded-xl",children:(0,t.jsxs)("div",{className:"relative",children:[r,v,N]})}),e[27]=N,e[28]=r,e[29]=v,e[30]=_):_=e[30],_},se=G;export{se as default};
