const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/VideoPlayer-ChczQ3LK.js","assets/framework-pz3E8ggb.js","assets/database-OCX2jLsI.js","assets/rolldown-runtime-BaZ8gS7u.js","assets/framework-sg0yWRLc.css","assets/media-libs-_YS1-DNr.js","assets/media-libs-CqCaMccn.css","assets/VideoPlayer-Dd82JMnt.js","assets/index-BuTo3MQz.js","assets/ui-libs-DAoIcasR.js","assets/query-CR6y2Fqj.js","assets/animations-BjdNH4pZ.js","assets/index-CrhMSFa2.css"])))=>i.map(i=>d[i]);
import{a as pt}from"./rolldown-runtime-BaZ8gS7u.js";import{c as U,d as It,l as Et,n as Dt,v as gt,w as At,x as Lt}from"./framework-pz3E8ggb.js";import{r as Ot}from"./query-CR6y2Fqj.js";import{At as oe,Bt,Dn as Vt,En as Ut,Gn as ze,Hn as Wt,Ht as Ue,In as We,Pn as pe,Qt as qe,Rn as ke,Rt as He,Sn as qt,Vn as Ht,Wn as Gt,Yn as Qt,an as Xt,cn as Ge,dn as Jt,en as Yt,er as Kt,gn as Zt,in as Ne,on as es,pn as ts,qn as ss,sr as is,un as as,yn as vt,zn as ls}from"./ui-libs-DAoIcasR.js";import{n as ns}from"./media-libs-_YS1-DNr.js";import{$t as ee,A as bt,B as ge,Cn as rs,Dn as os,En as Qe,Et as cs,Fn as re,Gt as Xe,In as we,Jt as Je,Kt as Ye,L as ds,Ln as he,Mn as ms,N as xs,On as fs,P as us,Pn as Ce,Pt as hs,Qt as te,Sn as ps,St as gs,Tt as vs,Ut as Ke,V as bs,Vn as Ze,W as js,Wt as et,X as ys,Xt as tt,Y as zs,Yt as st,Zt as se,_n as ks,an as $e,cn as Ns,dn as jt,fn as ws,g as it,gn as Cs,gt as yt,hn as at,in as B,j as $s,k as _s,ln as Se,on as zt,qt as lt,sn as Ss,tn as kt,v as Ps,wn as Ts,wt as le,xn as Fs,xt as Rs,zn as nt}from"./index-BuTo3MQz.js";import{t as Pe}from"./rich-text-BdzlH2kv.js";import{n as ne,t as Ms}from"./actionsheet-ByDPt2aA.js";var Is=U(),j=pt(At(),1),t=pt(Et(),1),Es=i=>{const e=(0,Is.c)(37),{isComment:s,liked:r,reposted:a,handleLike:l,handleRepost:o,handleCommentClick:n,handleShareClick:d,isDetail:b}=i;if(b!==void 0&&b){let k;e[0]!==l||e[1]!==r?(k=(0,t.jsx)(J,{icon:pe,label:"Like",type:"like",onClick:l,active:r}),e[0]=l,e[1]=r,e[2]=k):k=e[2];let N;e[3]!==o||e[4]!==s||e[5]!==a?(N=!s&&(0,t.jsx)(J,{icon:Ne,label:"Repost",type:"repost",onClick:o,active:a}),e[3]=o,e[4]=s,e[5]=a,e[6]=N):N=e[6];let w;e[7]!==n?(w=(0,t.jsx)(J,{icon:bt,label:"Comment",type:"comment",onClick:n}),e[7]=n,e[8]=w):w=e[8];let _;e[9]!==d||e[10]!==s?(_=!s&&(0,t.jsx)(J,{icon:ge,label:"Share",type:"share",onClick:d}),e[9]=d,e[10]=s,e[11]=_):_=e[11];let x;return e[12]!==k||e[13]!==N||e[14]!==w||e[15]!==_?(x=(0,t.jsxs)("div",{className:"mt-5 flex w-full items-center justify-around py-2",children:[k,N,w,_]}),e[12]=k,e[13]=N,e[14]=w,e[15]=_,e[16]=x):x=e[16],x}const p=`flex items-center gap-x-1.5 ${s?"mt-2":"mt-3.5"}`,u=s?16:18;let f;e[17]!==l||e[18]!==r||e[19]!==u?(f=(0,t.jsx)(J,{icon:pe,size:u,type:"like",onClick:l,active:r}),e[17]=l,e[18]=r,e[19]=u,e[20]=f):f=e[20];const m=s?16:18;let c;e[21]!==n||e[22]!==m?(c=(0,t.jsx)(J,{icon:vt,size:m,type:"comment",onClick:n}),e[21]=n,e[22]=m,e[23]=c):c=e[23];const v=s?16:18;let g;e[24]!==o||e[25]!==a||e[26]!==v?(g=(0,t.jsx)(J,{icon:Ne,size:v,type:"repost",onClick:o,active:a}),e[24]=o,e[25]=a,e[26]=v,e[27]=g):g=e[27];let h;e[28]!==d||e[29]!==s?(h=!s&&d&&(0,t.jsx)(J,{icon:ge,type:"share",onClick:d}),e[28]=d,e[29]=s,e[30]=h):h=e[30];let z;return e[31]!==p||e[32]!==f||e[33]!==c||e[34]!==g||e[35]!==h?(z=(0,t.jsxs)("div",{className:p,children:[f,c,g,h]}),e[31]=p,e[32]=f,e[33]=c,e[34]=g,e[35]=h,e[36]=z):z=e[36],z},rt=Es,Ds=U(),As=i=>{const e=(0,Ds.c)(38),{views:s,likes:r,comments:a,isDetail:l,isComment:o,onRepliesClick:n}=i,d=l===void 0?!1:l,b=o===void 0?!1:o;if(d){const g=s||0;let h;e[0]!==g?(h=(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:g}),e[0]=g,e[1]=h):h=e[1];let z;e[2]===Symbol.for("react.memo_cache_sentinel")?(z=(0,t.jsx)("span",{className:"opacity-70",children:"Views"}),e[2]=z):z=e[2];let k;e[3]!==h?(k=(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[h," ",z]}),e[3]=h,e[4]=k):k=e[4];const N=r||0;let w;e[5]!==N?(w=(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:N}),e[5]=N,e[6]=w):w=e[6];let _;e[7]===Symbol.for("react.memo_cache_sentinel")?(_=(0,t.jsx)("span",{className:"opacity-70",children:"Likes"}),e[7]=_):_=e[7];let x;e[8]!==w?(x=(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[w," ",_]}),e[8]=w,e[9]=x):x=e[9];const S=a||0;let M;e[10]!==S?(M=(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:S}),e[10]=S,e[11]=M):M=e[11];let C;e[12]===Symbol.for("react.memo_cache_sentinel")?(C=(0,t.jsx)("span",{className:"opacity-70",children:"Comments"}),e[12]=C):C=e[12];let y;e[13]!==M?(y=(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[M," ",C]}),e[13]=M,e[14]=y):y=e[14];let P;return e[15]!==x||e[16]!==y||e[17]!==k?(P=(0,t.jsxs)("div",{className:"mt-5 flex items-center gap-x-6 border-b border-zinc-100 pb-4 text-sm text-zinc-500 dark:border-zinc-800 dark:text-zinc-400",children:[k,x,y]}),e[15]=x,e[16]=y,e[17]=k,e[18]=P):P=e[18],P}if(a===0&&r===0&&(s===0||b))return null;const p=`mt-2 flex items-center gap-x-2 px-0.5 ${b?"text-[12px]":"text-[14px]"} font-medium text-zinc-500 dark:text-zinc-400`;let u;e[19]!==a||e[20]!==b||e[21]!==r||e[22]!==s?(u=s>0&&!b&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{className:"hover:underline",children:[s," ",s===1?"view":"views"]}),(a>0||r>0)&&(0,t.jsx)("span",{className:"opacity-50",children:"·"})]}),e[19]=a,e[20]=b,e[21]=r,e[22]=s,e[23]=u):u=e[23];let f;e[24]!==a||e[25]!==n?(f=a>0&&(0,t.jsxs)("button",{className:"hover:underline",onClick:g=>{g.stopPropagation(),n&&n(g)},children:[a," ",a===1?"reply":"replies"]}),e[24]=a,e[25]=n,e[26]=f):f=e[26];let m;e[27]!==a||e[28]!==r?(m=a>0&&r>0&&(0,t.jsx)("span",{className:"opacity-50",children:"·"}),e[27]=a,e[28]=r,e[29]=m):m=e[29];let c;e[30]!==r?(c=r>0&&(0,t.jsxs)("button",{className:"hover:underline",children:[r," ",r===1?"like":"likes"]}),e[30]=r,e[31]=c):c=e[31];let v;return e[32]!==p||e[33]!==u||e[34]!==f||e[35]!==m||e[36]!==c?(v=(0,t.jsxs)("div",{className:p,children:[u,f,m,c]}),e[32]=p,e[33]=u,e[34]=f,e[35]=m,e[36]=c,e[37]=v):v=e[37],v},ot=As,Ls=U(),Os=i=>{const e=(0,Ls.c)(48),{user:s,timeAgo:r,community:a,onUserClick:l,actionsMenu:o,isComment:n,isDetail:d,showAvatar:b}=i,p=b===void 0?!1:b,u=gt();let f;e[0]!==l||e[1]!==s.handle?(f=I=>{I.stopPropagation(),l&&l(s.handle)},e[0]=l,e[1]=s.handle,e[2]=f):f=e[2];const m=f;let c;e[3]!==a||e[4]!==u?(c=I=>{I.stopPropagation(),a&&u(`/c/${a.handle}`)},e[3]=a,e[4]=u,e[5]=c):c=e[5];const v=c,g=`flex items-center justify-between ${d?"pb-5":"min-h-[40px] mb-2"}`;let h;e[6]!==m||e[7]!==n||e[8]!==d||e[9]!==p||e[10]!==s.avatar||e[11]!==s.handle?(h=p&&(0,t.jsx)("button",{className:"shrink-0",onClick:m,children:(0,t.jsxs)(se,{className:`${d?"size-12":n?"size-8":"size-10"} border-0 shadow-sm`,children:[(0,t.jsx)(ee,{src:s.avatar,alt:s.handle,className:"object-cover"}),(0,t.jsx)(te,{className:"text-xs",children:s.handle[0]?.toUpperCase()})]})}),e[6]=m,e[7]=n,e[8]=d,e[9]=p,e[10]=s.avatar,e[11]=s.handle,e[12]=h):h=e[12];const z=`flex shrink-0 items-center gap-1 font-bold text-zinc-900 hover:underline dark:text-white ${d?"text-base sm:text-lg":n?"text-[14px]":"text-[15px]"}`;let k;e[13]!==s.handle?(k=(0,t.jsx)("span",{className:"max-w-[150px] truncate sm:max-w-none",children:s.handle}),e[13]=s.handle,e[14]=k):k=e[14];let N;e[15]!==n||e[16]!==d||e[17]!==s.role?(N=s.role==="admin"&&(0,t.jsx)(_s,{size:d?28:n?22:24}),e[15]=n,e[16]=d,e[17]=s.role,e[18]=N):N=e[18];let w;e[19]!==n||e[20]!==d||e[21]!==s.verified?(w=s.verified&&(0,t.jsx)(bs,{size:d?16:n?12:14}),e[19]=n,e[20]=d,e[21]=s.verified,e[22]=w):w=e[22];let _;e[23]!==m||e[24]!==z||e[25]!==k||e[26]!==N||e[27]!==w?(_=(0,t.jsxs)("button",{className:z,onClick:m,children:[k,N,w]}),e[23]=m,e[24]=z,e[25]=k,e[26]=N,e[27]=w,e[28]=_):_=e[28];let x;e[29]!==a||e[30]!==v||e[31]!==d?(x=a&&(0,t.jsxs)("div",{className:"flex min-w-0 items-center gap-1 text-zinc-500",children:[(0,t.jsx)($s,{size:d?14:12,className:"shrink-0 text-zinc-400"}),(0,t.jsxs)("button",{className:`flex items-center gap-1 font-bold text-zinc-900 hover:underline dark:text-zinc-100 ${d?"text-[14px] sm:text-[15px]":"text-[13px]"}`,onClick:v,children:[(0,t.jsxs)(se,{className:"size-3.5 shrink-0 border border-zinc-200 bg-zinc-100 dark:border-zinc-700 dark:bg-zinc-800",children:[(0,t.jsx)(ee,{src:a.avatar,alt:a.name,className:"object-cover"}),(0,t.jsx)(te,{className:"text-[6px] font-bold text-zinc-500",children:a.name?.[0]?.toUpperCase()})]}),(0,t.jsx)("span",{className:"max-w-[150px] truncate sm:max-w-none",children:a.name})]})]}),e[29]=a,e[30]=v,e[31]=d,e[32]=x):x=e[32];let S;e[33]!==_||e[34]!==x?(S=(0,t.jsx)("div",{className:"flex min-w-0 flex-1 flex-col",children:(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-x-1.5 leading-none",children:(0,t.jsxs)("div",{className:"flex min-w-0 max-w-full items-center gap-1.5",children:[_,x]})})}),e[33]=_,e[34]=x,e[35]=S):S=e[35];let M;e[36]!==S||e[37]!==h?(M=(0,t.jsxs)("div",{className:"flex items-center gap-x-3.5 flex-1 min-w-0",children:[h,S]}),e[36]=S,e[37]=h,e[38]=M):M=e[38];const C=r||"Recent";let y;e[39]!==C?(y=(0,t.jsx)("span",{className:"whitespace-nowrap text-[12px] text-zinc-500 dark:text-zinc-400",children:C}),e[39]=C,e[40]=y):y=e[40];let P;e[41]!==o||e[42]!==y?(P=(0,t.jsxs)("div",{className:"-mt-1 flex items-center gap-2.5",children:[y,o]}),e[41]=o,e[42]=y,e[43]=P):P=e[43];let F;return e[44]!==M||e[45]!==P||e[46]!==g?(F=(0,t.jsxs)("div",{className:g,children:[M,P]}),e[44]=M,e[45]=P,e[46]=g,e[47]=F):F=e[47],F},ct=Os,Bs=U(),Vs=i=>{const e=(0,Bs.c)(40),{content:s,isDetail:r,isEditing:a,editedContent:l,setEditedContent:o,onCancelEdit:n,onSaveEdit:d,isUpdating:b,contentClass:p}=i,[u,f]=(0,j.useState)(!1),m=typeof s=="string"&&Ze(s);if(a&&o){let S;e[0]!==o?(S=L=>o(L.target.value),e[0]=o,e[1]=S):S=e[1];const M=`min-h-[100px] w-full rounded-xl border-zinc-200 bg-zinc-50 focus:ring-violet-500 dark:border-zinc-800 dark:bg-zinc-900 ${Ze(l||"")?"font-bangla text-lg":"font-english"}`;let C;e[2]!==l||e[3]!==S||e[4]!==M?(C=(0,t.jsx)(js,{value:l,onChange:S,className:M,autoFocus:!0}),e[2]=l,e[3]=S,e[4]=M,e[5]=C):C=e[5];let y;e[6]!==n?(y=(0,t.jsx)("button",{onClick:n,className:"px-4 py-1.5 text-sm font-bold text-zinc-500 transition-colors hover:text-zinc-700 dark:hover:text-zinc-300",children:"Cancel"}),e[6]=n,e[7]=y):y=e[7];let P;e[8]!==s||e[9]!==l||e[10]!==b?(P=b||!l?.trim()||l===s,e[8]=s,e[9]=l,e[10]=b,e[11]=P):P=e[11];const F=b?"Saving...":"Save";let I;e[12]!==d||e[13]!==P||e[14]!==F?(I=(0,t.jsx)("button",{onClick:d,disabled:P,className:"rounded-full bg-violet-600 px-4 py-1.5 text-sm font-bold text-white transition-all hover:bg-violet-700 disabled:opacity-50 active:scale-95",children:F}),e[12]=d,e[13]=P,e[14]=F,e[15]=I):I=e[15];let E;e[16]!==y||e[17]!==I?(E=(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[y,I]}),e[16]=y,e[17]=I,e[18]=E):E=e[18];let A;return e[19]!==C||e[20]!==E?(A=(0,t.jsxs)("div",{className:"mt-2 flex flex-col gap-2",onClick:Us,children:[C,E]}),e[19]=C,e[20]=E,e[21]=A):A=e[21],A}const c=!r&&s.length>280;let v;e[22]!==s||e[23]!==u||e[24]!==c?(v=c&&!u?s.substring(0,280):s,e[22]=s,e[23]=u,e[24]=c,e[25]=v):v=e[25];const g=v,h=r?"text-lg leading-relaxed sm:text-xl sm:leading-8 mt-1":"text-[15px] leading-snug mt-0.5",z=m?"font-bangla text-[1.15em]":"font-english";let k;e[26]!==p||e[27]!==h||e[28]!==z?(k=re("whitespace-pre-line break-words",h,z,p),e[26]=p,e[27]=h,e[28]=z,e[29]=k):k=e[29];let N;e[30]!==g?(N=(0,t.jsx)(Pe,{content:g}),e[30]=g,e[31]=N):N=e[31];const w=c&&!u&&"...";let _;e[32]!==u||e[33]!==c?(_=c&&(0,t.jsx)("button",{onClick:S=>{S.stopPropagation(),f(!u)},className:"ml-1 cursor-pointer font-bold text-rose-600 hover:underline dark:text-rose-400",children:u?"Show less":"See more"}),e[32]=u,e[33]=c,e[34]=_):_=e[34];let x;return e[35]!==k||e[36]!==N||e[37]!==w||e[38]!==_?(x=(0,t.jsxs)("div",{className:k,children:[N,w,_]}),e[35]=k,e[36]=N,e[37]=w,e[38]=_,e[39]=x):x=e[39],x},dt=Vs;function Us(i){return i.stopPropagation()}var Ws=U(),qs=i=>{const e=(0,Ws.c)(28),{media:s,isEditing:r,editedMedia:a,setEditedMedia:l,newFiles:o,setNewFiles:n}=i;let d;e[0]!==a?(d=a===void 0?[]:a,e[0]=a,e[1]=d):d=e[1];const b=d;let p;e[2]!==o?(p=o===void 0?[]:o,e[2]=o,e[3]=p):p=e[3];const u=p,f=(0,j.useRef)(null);if(r&&l&&n){let c;if(e[4]!==b||e[5]!==l){let N;e[7]!==l?(N=(w,_)=>(0,t.jsxs)("div",{className:"group relative aspect-square overflow-hidden rounded-xl border border-zinc-200 dark:border-zinc-800",children:[w.type==="video"?(0,t.jsx)("div",{className:"flex size-full items-center justify-center bg-zinc-100 dark:bg-zinc-900",children:(0,t.jsx)(ls,{size:24,className:"text-zinc-400"})}):(0,t.jsx)("img",{src:w.url||w.src,className:"size-full object-cover",alt:""}),(0,t.jsx)("button",{onClick:x=>{x.stopPropagation(),l(S=>S.filter((M,C)=>C!==_))},className:"absolute right-1.5 top-1.5 flex size-7 items-center justify-center rounded-full bg-black/60 text-white transition-colors hover:bg-black",children:(0,t.jsx)(oe,{size:16})})]},`old-${_}`),e[7]=l,e[8]=N):N=e[8],c=b.map(N),e[4]=b,e[5]=l,e[6]=c}else c=e[6];let v;if(e[9]!==u||e[10]!==n){let N;e[12]!==n?(N=(w,_)=>(0,t.jsxs)("div",{className:"group relative aspect-square overflow-hidden rounded-xl border-2 border-dashed border-violet-500 bg-violet-50/10",children:[w.type.startsWith("image/")?(0,t.jsx)("img",{src:URL.createObjectURL(w),className:"size-full object-cover",alt:""}):(0,t.jsx)("div",{className:"flex size-full items-center justify-center",children:(0,t.jsx)(Ut,{size:24,className:"animate-spin text-violet-500"})}),(0,t.jsx)("button",{onClick:x=>{x.stopPropagation(),n(S=>S.filter((M,C)=>C!==_))},className:"absolute right-1.5 top-1.5 flex size-7 items-center justify-center rounded-full bg-black/60 text-white transition-colors hover:bg-black",children:(0,t.jsx)(oe,{size:16})}),(0,t.jsx)("div",{className:"absolute bottom-1 left-1 rounded bg-violet-600 px-1 text-[8px] font-bold text-white",children:"NEW"})]},`new-${_}`),e[12]=n,e[13]=N):N=e[13],v=u.map(N),e[9]=u,e[10]=n,e[11]=v}else v=e[11];let g;e[14]!==b.length||e[15]!==u.length?(g=b.length+u.length<4&&(0,t.jsxs)("button",{onClick:N=>{N.stopPropagation(),f.current?.click()},className:"relative flex aspect-square flex-col items-center justify-center gap-1 rounded-xl border-2 border-dashed border-zinc-200 text-zinc-400 transition-all hover:border-violet-500 hover:bg-violet-50/5 hover:text-violet-500 dark:border-zinc-800",children:[(0,t.jsx)(Xt,{size:20}),(0,t.jsx)("span",{className:"text-[10px] font-bold",children:"Add Media"})]}),e[14]=b.length,e[15]=u.length,e[16]=g):g=e[16];let h;e[17]!==c||e[18]!==v||e[19]!==g?(h=(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:[c,v,g]}),e[17]=c,e[18]=v,e[19]=g,e[20]=h):h=e[20];let z;e[21]!==n?(z=(0,t.jsx)("input",{type:"file",ref:f,onChange:N=>{if(N.target.files){const w=Array.from(N.target.files);n(_=>[..._,...w])}},multiple:!0,className:"hidden",accept:"image/*,video/*"}),e[21]=n,e[22]=z):z=e[22];let k;return e[23]!==h||e[24]!==z?(k=(0,t.jsxs)("div",{className:"mt-3 space-y-3",children:[h,z]}),e[23]=h,e[24]=z,e[25]=k):k=e[25],k}if(!s||s.length===0)return null;let m;return e[26]!==s?(m=(0,t.jsx)(mi,{items:s}),e[26]=s,e[27]=m):m=e[27],m},mt=qs,Hs=U(),Gs=i=>{const e=(0,Hs.c)(48),{icon:s,count:r,label:a,onClick:l,active:o,activeColorClass:n,size:d,type:b}=i,p=d===void 0?18:d,u=b===void 0?"default":b;let f,m,c,v,g,h,z;if(e[0]!==o||e[1]!==n||e[2]!==r||e[3]!==a||e[4]!==l||e[5]!==u){const E={like:{hoverBg:"group-hover:bg-rose-500/10",hoverText:"group-hover:text-rose-500",activeText:"text-rose-500",activeFill:"fill-rose-500"},repost:{hoverBg:"group-hover:bg-emerald-500/10",hoverText:"group-hover:text-emerald-500",activeText:"text-emerald-500",activeFill:"fill-emerald-500"},comment:{hoverBg:"group-hover:bg-sky-500/10",hoverText:"group-hover:text-sky-500",activeText:"text-sky-500",activeFill:"fill-sky-500"},share:{hoverBg:"group-hover:bg-violet-500/10",hoverText:"group-hover:text-violet-500",activeText:"text-violet-500",activeFill:"fill-violet-500"},default:{hoverBg:"group-hover:bg-zinc-500/10",hoverText:"group-hover:text-zinc-500",activeText:"text-zinc-900 dark:text-white",activeFill:"fill-current"}};m=E[u]||E.default;const A=n||m.activeText;f=B.button,e[13]===Symbol.for("react.memo_cache_sentinel")?(v={scale:.85},e[13]=v):v=e[13],e[14]!==l?(g=L=>{L.stopPropagation(),l&&l(L)},e[14]=l,e[15]=g):g=e[15],h=`${a} ${r!==void 0?`(${r})`:""}`,z=re("group -ml-2 flex items-center gap-x-0.5 rounded-xl px-2 py-1.5 text-[12px] font-bold transition-all sm:gap-x-1 sm:text-[13px]",o?A:"text-zinc-500",!o&&m.hoverText),c=re("rounded-full p-2 transition-all duration-200",!o&&m.hoverBg),e[0]=o,e[1]=n,e[2]=r,e[3]=a,e[4]=l,e[5]=u,e[6]=f,e[7]=m,e[8]=c,e[9]=v,e[10]=g,e[11]=h,e[12]=z}else f=e[6],m=e[7],c=e[8],v=e[9],g=e[10],h=e[11],z=e[12];let k;e[16]!==o?(k=o?{scale:[1,1.4,1],rotate:[0,15,0]}:{scale:1},e[16]=o,e[17]=k):k=e[17];let N;e[18]===Symbol.for("react.memo_cache_sentinel")?(N={duration:.45,type:"spring",stiffness:300,damping:15},e[18]=N):N=e[18];const w=o?2.5:2,_=o&&m.activeFill;let x;e[19]!==_?(x=re("transition-colors duration-200",_),e[19]=_,e[20]=x):x=e[20];let S;e[21]!==s||e[22]!==p||e[23]!==w||e[24]!==x?(S=(0,t.jsx)(s,{size:p,strokeWidth:w,className:x}),e[21]=s,e[22]=p,e[23]=w,e[24]=x,e[25]=S):S=e[25];let M;e[26]!==S||e[27]!==k?(M=(0,t.jsx)(B.div,{animate:k,transition:N,children:S}),e[26]=S,e[27]=k,e[28]=M):M=e[28];let C;e[29]!==M||e[30]!==c?(C=(0,t.jsx)("div",{className:c,children:M}),e[29]=M,e[30]=c,e[31]=C):C=e[31];let y;e[32]!==a?(y=a&&(0,t.jsx)("span",{className:"hidden xs:inline",children:a}),e[32]=a,e[33]=y):y=e[33];let P;e[34]!==o||e[35]!==r?(P=r!=null&&(0,t.jsx)(B.span,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},className:re("transition-all",o?"font-black":"font-bold"),children:r||0},r),e[34]=o,e[35]=r,e[36]=P):P=e[36];let F;e[37]!==P?(F=(0,t.jsx)($e,{mode:"wait",children:P}),e[37]=P,e[38]=F):F=e[38];let I;return e[39]!==f||e[40]!==C||e[41]!==y||e[42]!==F||e[43]!==v||e[44]!==g||e[45]!==h||e[46]!==z?(I=(0,t.jsxs)(f,{whileTap:v,onClick:g,"aria-label":h,className:z,children:[C,y,F]}),e[39]=f,e[40]=C,e[41]=y,e[42]=F,e[43]=v,e[44]=g,e[45]=h,e[46]=z,e[47]=I):I=e[47],I},J=Gs,Qs=U(),Xs=i=>{const e=(0,Qs.c)(18),{poll:s,onVote:r}=i,a=s.options.reduce(Js,0),[l,o]=(0,j.useState)(null);let n;e[0]!==r||e[1]!==l?(n=c=>{l||(o(c),r&&r(c))},e[0]=r,e[1]=l,e[2]=n):n=e[2];const d=n;let b;if(e[3]!==d||e[4]!==s.options||e[5]!==a||e[6]!==l){let c;e[8]!==d||e[9]!==a||e[10]!==l?(c=(v,g)=>{const h=a>0?Math.round((v.votes+(l===v.id?1:0))/(a+(l?1:0))*100):0,z=l===v.id;return(0,t.jsxs)("div",{onClick:()=>d(v.id),className:`relative h-10 w-full overflow-hidden rounded-xl border cursor-pointer ${z?"border-violet-500 dark:border-violet-500":"border-zinc-200 dark:border-zinc-700"}`,children:[l&&(0,t.jsx)("div",{className:"absolute left-0 top-0 h-full bg-zinc-200 transition-all duration-500 dark:bg-zinc-800",style:{width:`${h}%`}}),(0,t.jsxs)("div",{className:"absolute inset-0 z-10 flex items-center justify-between px-4",children:[(0,t.jsxs)("span",{className:`text-sm font-medium ${z?"font-bold text-violet-600":"text-zinc-700 dark:text-zinc-200"}`,children:[v.text," ",z&&(0,t.jsx)(Kt,{size:14,className:"mb-0.5 inline ml-1"})]}),l&&(0,t.jsxs)("span",{className:"text-sm font-bold text-zinc-900 dark:text-white",children:[h,"%"]})]})]},v.id||g)},e[8]=d,e[9]=a,e[10]=l,e[11]=c):c=e[11],b=s.options.map(c),e[3]=d,e[4]=s.options,e[5]=a,e[6]=l,e[7]=b}else b=e[7];const p=a+(l?1:0),u=l?"6 days left":"Click to vote";let f;e[12]!==p||e[13]!==u?(f=(0,t.jsxs)("div",{className:"pl-1 text-xs text-zinc-500 dark:text-zinc-400",children:[p," votes •"," ",u]}),e[12]=p,e[13]=u,e[14]=f):f=e[14];let m;return e[15]!==b||e[16]!==f?(m=(0,t.jsxs)("div",{className:"mt-3 space-y-2",children:[b,f]}),e[15]=b,e[16]=f,e[17]=m):m=e[17],m},xt=Xs;function Js(i,e){return i+e.votes}var Ys=U(),Ks=i=>{const e=(0,Ys.c)(25),{user:s,time:r,content:a}=i;let l;e[0]!==s.avatar||e[1]!==s.handle?(l=(0,t.jsx)(ee,{src:s.avatar,alt:s.handle}),e[0]=s.avatar,e[1]=s.handle,e[2]=l):l=e[2];let o;e[3]!==s.handle[0]?(o=s.handle[0]?.toUpperCase(),e[3]=s.handle[0],e[4]=o):o=e[4];let n;e[5]!==o?(n=(0,t.jsx)(te,{children:o}),e[5]=o,e[6]=n):n=e[6];let d;e[7]!==l||e[8]!==n?(d=(0,t.jsxs)(se,{className:"size-6",children:[l,n]}),e[7]=l,e[8]=n,e[9]=d):d=e[9];let b;e[10]!==s.handle?(b=(0,t.jsx)("span",{className:"text-sm font-semibold",children:s.handle}),e[10]=s.handle,e[11]=b):b=e[11];let p;e[12]!==d||e[13]!==b?(p=(0,t.jsxs)("div",{className:"flex items-center gap-x-2",children:[d,b]}),e[12]=d,e[13]=b,e[14]=p):p=e[14];let u;e[15]!==r?(u=(0,t.jsx)("span",{className:"text-xs text-zinc-500 sm:text-sm",children:r}),e[15]=r,e[16]=u):u=e[16];let f;e[17]!==p||e[18]!==u?(f=(0,t.jsxs)("div",{className:"mb-2 flex items-center justify-between gap-x-2",children:[p,u]}),e[17]=p,e[18]=u,e[19]=f):f=e[19];let m;e[20]!==a?(m=(0,t.jsx)(Pe,{content:a,className:"text-sm text-zinc-800 dark:text-zinc-300"}),e[20]=a,e[21]=m):m=e[21];let c;return e[22]!==f||e[23]!==m?(c=(0,t.jsxs)("div",{className:"p-4",children:[f,m]}),e[22]=f,e[23]=m,e[24]=c):c=e[24],c},ft=Ks,Zs=({currentUser:i,newComment:e,setNewComment:s,handleSubmitComment:r,loading:a,selectedFiles:l=[],setSelectedFiles:o,isUploading:n})=>{const d=(0,j.useRef)(null),b=m=>{if(m.target.files){const c=Array.from(m.target.files);o&&o(v=>[...v,...c])}},p=m=>{o&&o(c=>c.filter((v,g)=>g!==m))},u=(0,j.useMemo)(()=>l.map(m=>URL.createObjectURL(m)),[l]);(0,j.useEffect)(()=>()=>{u.forEach(m=>URL.revokeObjectURL(m))},[u]);const f=m=>{const c=m.clipboardData.files;if(c&&c.length>0){const v=Array.from(c).filter(g=>g.type.startsWith("image/"));v.length>0&&(m.preventDefault(),o&&o(g=>[...g,...v]))}};return i?(0,t.jsx)("div",{className:"border-y border-zinc-100 bg-zinc-50/30 p-4 dark:border-zinc-800 dark:bg-zinc-900/10",children:(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsxs)(se,{className:"size-9 border border-zinc-200 dark:border-zinc-700",children:[(0,t.jsx)(ee,{src:i.avatar,alt:i.handle,className:"object-cover"}),(0,t.jsx)(te,{children:i.handle?.[0]?.toUpperCase()})]}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("textarea",{id:"comment-input",className:"min-h-[60px] w-full resize-none bg-transparent text-base outline-none placeholder:text-zinc-500 dark:text-white",placeholder:"Post your reply...",value:e,onChange:m=>s(m.target.value),onPaste:f}),l.length>0&&(0,t.jsx)("div",{className:"mt-2 mb-2 flex flex-wrap gap-2",children:l.map((m,c)=>(0,t.jsxs)("div",{className:"relative size-20 overflow-hidden rounded-xl border border-zinc-200 dark:border-zinc-800",children:[m.type.startsWith("image/")?(0,t.jsx)("img",{src:u[c],className:"size-full object-cover",alt:""}):(0,t.jsx)("div",{className:"flex size-full items-center justify-center bg-zinc-100 dark:bg-zinc-800",children:(0,t.jsx)(Jt,{size:20,className:"text-zinc-500"})}),(0,t.jsx)("button",{onClick:()=>p(c),className:"absolute right-1 top-1 rounded-full bg-black/60 p-1 text-white transition-colors hover:bg-black",children:(0,t.jsx)(oe,{size:12})})]},c))}),(0,t.jsxs)("div",{className:"mt-2 flex items-center justify-between border-t border-zinc-100 pt-3 dark:border-zinc-800",children:[(0,t.jsxs)("div",{className:"flex gap-1 text-violet-600",children:[(0,t.jsx)("button",{type:"button",onClick:()=>d.current?.click(),className:"rounded-full p-2 text-violet-600 transition-colors hover:bg-violet-50 dark:hover:bg-zinc-800",title:"Attach media",children:(0,t.jsx)(ds,{size:20})}),(0,t.jsx)("input",{type:"file",ref:d,onChange:b,multiple:!0,className:"hidden",accept:"image/*,video/*,application/pdf"})]}),(0,t.jsx)(kt,{variant:a||n?"primary":"animated",icon:!(a||n)&&(0,t.jsx)(ge,{size:20}),className:"min-w-[70px] !w-auto",onClick:r,loading:a||n,disabled:!e.trim()&&l.length===0,children:"Reply"})]})]})]})}):(0,t.jsx)("div",{className:"border-y border-zinc-100 bg-zinc-50/30 p-6 text-center dark:border-zinc-800 dark:bg-zinc-900/10",children:(0,t.jsx)("p",{className:"text-sm text-zinc-500",children:"Please login to join the conversation."})})},Nt=j.memo(Zs),ei=U(),ti=i=>{const e=(0,ei.c)(30),{url:s}=i;let r,a;e[0]!==s?(r=["link-preview",s],a=()=>ws(s),e[0]=s,e[1]=r,e[2]=a):(r=e[1],a=e[2]);const l=!!s;let o;e[3]!==r||e[4]!==a||e[5]!==l?(o={queryKey:r,queryFn:a,staleTime:864e5,enabled:l},e[3]=r,e[4]=a,e[5]=l,e[6]=o):o=e[6];const{data:n,isLoading:d,isError:b}=Ot(o);if(d){let k;return e[7]===Symbol.for("react.memo_cache_sentinel")?(k=(0,t.jsx)("div",{className:"mt-3 flex h-24 animate-pulse items-center justify-center overflow-hidden rounded-2xl border border-zinc-100 bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-900/50",children:(0,t.jsx)(We,{className:"animate-spin text-zinc-300 dark:text-zinc-700",size:24})}),e[7]=k):k=e[7],k}if(b||!n||!n.title&&!n.image)return null;let p;e[8]!==n.image||e[9]!==n.title?(p=n.image&&(0,t.jsx)("div",{className:"aspect-[1.91/1] w-full overflow-hidden border-b border-zinc-100 bg-zinc-100 dark:border-zinc-800 dark:bg-zinc-900",children:(0,t.jsx)("img",{src:n.image,alt:n.title??void 0,className:"h-full w-full object-cover transition-transform duration-500 group-hover:scale-[1.02]",onError:ii})}),e[8]=n.image,e[9]=n.title,e[10]=p):p=e[10];let u;e[11]===Symbol.for("react.memo_cache_sentinel")?(u=(0,t.jsx)(We,{size:12}),e[11]=u):u=e[11];let f;e[12]!==n.siteName?(f=(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs font-bold uppercase tracking-wider text-zinc-600",children:[u,(0,t.jsx)("span",{children:n.siteName})]}),e[12]=n.siteName,e[13]=f):f=e[13];let m;e[14]!==n.title?(m=(0,t.jsx)("div",{className:"line-clamp-2 text-[15px] font-bold leading-snug transition-colors group-hover:text-violet-700 dark:text-white",children:n.title}),e[14]=n.title,e[15]=m):m=e[15];let c;e[16]!==n.description?(c=n.description&&(0,t.jsx)("p",{className:"line-clamp-2 text-xs leading-relaxed text-zinc-600 dark:text-zinc-400",children:n.description}),e[16]=n.description,e[17]=c):c=e[17];let v;e[18]===Symbol.for("react.memo_cache_sentinel")?(v=(0,t.jsx)(Gt,{size:10}),e[18]=v):v=e[18];let g;e[19]!==s?(g=(0,t.jsxs)("div",{className:"flex items-center gap-1 pt-1 text-[11px] font-medium text-zinc-500",children:[v,(0,t.jsx)("span",{className:"truncate",children:s})]}),e[19]=s,e[20]=g):g=e[20];let h;e[21]!==g||e[22]!==f||e[23]!==m||e[24]!==c?(h=(0,t.jsxs)("div",{className:"space-y-1 p-3.5",children:[f,m,c,g]}),e[21]=g,e[22]=f,e[23]=m,e[24]=c,e[25]=h):h=e[25];let z;return e[26]!==h||e[27]!==p||e[28]!==s?(z=(0,t.jsxs)("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"group mt-3 flex flex-col overflow-hidden rounded-2xl border border-zinc-100 bg-white shadow-sm transition-all hover:bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-950 dark:hover:bg-zinc-900",onClick:si,children:[p,h]}),e[26]=h,e[27]=p,e[28]=s,e[29]=z):z=e[29],z},ut=ti;function si(i){return i.stopPropagation()}function ii(i){return i.target.style.display="none"}var ai=U(),li=i=>{const e=(0,ai.c)(15),{file:s}=i;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=(0,t.jsx)("div",{className:"flex size-10 items-center justify-center rounded-xl bg-violet-100 text-violet-600 dark:bg-violet-900/30",children:(0,t.jsx)(Ht,{size:20})}),e[0]=r):r=e[0];let a;e[1]!==s.name?(a=(0,t.jsx)("div",{className:"truncate text-sm font-bold dark:text-white",children:s.name}),e[1]=s.name,e[2]=a):a=e[2];let l;e[3]!==s.size?(l=s.size!==void 0&&(0,t.jsxs)("div",{className:"text-xs uppercase text-zinc-500",children:[(s.size/1024/1024).toFixed(2)," MB"]}),e[3]=s.size,e[4]=l):l=e[4];let o;e[5]!==a||e[6]!==l?(o=(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[a,l]}),e[5]=a,e[6]=l,e[7]=o):o=e[7];let n;e[8]===Symbol.for("react.memo_cache_sentinel")?(n=(0,t.jsx)(ss,{size:18}),e[8]=n):n=e[8];let d;e[9]!==s.name||e[10]!==s.url?(d=(0,t.jsx)("a",{href:s.url,download:s.name,className:"p-2 text-zinc-400 transition-colors hover:text-violet-600",onClick:ri,children:n}),e[9]=s.name,e[10]=s.url,e[11]=d):d=e[11];let b;return e[12]!==o||e[13]!==d?(b=(0,t.jsxs)("div",{className:"group mt-3 flex items-center gap-3 rounded-2xl border border-zinc-100 bg-zinc-50/50 p-3 transition-colors hover:border-violet-500/30 dark:border-zinc-800 dark:bg-zinc-900/10",children:[r,o,d]}),e[12]=o,e[13]=d,e[14]=b):b=e[14],b},ni=li;function ri(i){return i.stopPropagation()}var wt=U(),oi=j.lazy(()=>Lt(()=>import("./VideoPlayer-ChczQ3LK.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),ci=i=>{const e=(0,wt.c)(16),{item:s,onClick:r}=i,[a,l]=(0,j.useState)(!1);let o,n;e[0]===Symbol.for("react.memo_cache_sentinel")?(o={scale:.98},n={type:"spring",stiffness:400,damping:25},e[0]=o,e[1]=n):(o=e[0],n=e[1]);let d;e[2]!==a?(d=!a&&(0,t.jsx)("div",{className:"absolute inset-0 animate-pulse bg-zinc-200 dark:bg-zinc-800"}),e[2]=a,e[3]=d):d=e[3];const b=s.url||s.src;let p;e[4]===Symbol.for("react.memo_cache_sentinel")?(p={opacity:0,scale:1.05,filter:"blur(10px)"},e[4]=p):p=e[4];let u;e[5]!==a?(u=a?{opacity:1,scale:1,filter:"blur(0px)"}:{},e[5]=a,e[6]=u):u=e[6];let f;e[7]===Symbol.for("react.memo_cache_sentinel")?(f={duration:.4,ease:"easeOut"},e[7]=f):f=e[7];let m;e[8]===Symbol.for("react.memo_cache_sentinel")?(m=()=>l(!0),e[8]=m):m=e[8];let c;e[9]!==b||e[10]!==u?(c=(0,t.jsx)(B.img,{src:b,initial:p,animate:u,transition:f,className:"size-full object-cover",alt:"",loading:"lazy",onLoad:m}),e[9]=b,e[10]=u,e[11]=c):c=e[11];let v;return e[12]!==r||e[13]!==d||e[14]!==c?(v=(0,t.jsxs)(B.div,{whileTap:o,transition:n,className:"relative size-full overflow-hidden",onClick:r,children:[d,c]}),e[12]=r,e[13]=d,e[14]=c,e[15]=v):v=e[15],v},di=i=>{const e=(0,wt.c)(3),{items:s}=i,r=s===void 0?[]:s,{openLightbox:a}=Ss();if(!r||Array.isArray(r)&&r.length===0)return null;const l=Array.isArray(r)?r:[r],o=l.filter(xi),n=l.filter(fi),d=o.some(ui),b=c=>{const v=o.filter(hi).map(pi),g=o[c];a(v,v.indexOf(g.url||g.src))},p="mt-2 space-y-2",u=o.length>0&&(0,t.jsx)("div",{className:`grid gap-2 overflow-hidden rounded-2xl border border-zinc-100 dark:border-zinc-800 ${o.length===1?"grid-cols-1":o.length===2?d?"aspect-[8/9] grid-cols-1 grid-rows-2":"aspect-[16/9] grid-cols-2":(o.length===3,"aspect-[16/9] grid-cols-2 grid-rows-2")}`,children:o.map((c,v)=>(0,t.jsx)("div",{className:`relative cursor-pointer overflow-hidden bg-zinc-100 dark:bg-zinc-900 ${o.length===3&&v===0?"row-span-2":""}`,children:c.type==="video"?(0,t.jsx)(j.Suspense,{fallback:(0,t.jsx)("div",{className:"flex aspect-video w-full items-center justify-center bg-zinc-100 dark:bg-zinc-900",children:(0,t.jsx)("div",{className:"size-8 animate-spin rounded-full border-2 border-violet-500 border-t-transparent"})}),children:(0,t.jsx)(oi,{src:c.url,poster:c.poster||void 0})}):(0,t.jsx)(ci,{item:c,onClick:g=>{g.stopPropagation(),b(v)}})},v))}),f=n.map(gi);let m;return e[0]!==u||e[1]!==f?(m=(0,t.jsxs)("div",{className:p,children:[u,f]}),e[0]=u,e[1]=f,e[2]=m):m=e[2],m},mi=di;function xi(i){return i.type==="image"||i.type==="video"}function fi(i){return i.type==="file"}function ui(i){return i.type==="video"}function hi(i){return i.type==="image"}function pi(i){return i.url||i.src}function gi(i,e){return(0,t.jsx)(ni,{file:i},e)}var vi=({isOpen:i,onClose:e,url:s,title:r="Share",overlayClassName:a})=>{const[l,o]=(0,j.useState)(!1),[n,d]=(0,j.useState)(""),[b,p]=(0,j.useState)([]),[u,f]=(0,j.useState)(!1),[m,c]=(0,j.useState)(null),{addToast:v}=Se(),{currentUser:g}=jt(),h=(0,j.useCallback)(async()=>{if(g){f(!0);try{p((await at(g.id)).map(x=>x.user).filter(x=>x!==null).slice(0,5))}catch(x){console.error("Failed to fetch conversations:",x)}finally{f(!1)}}},[g]);(0,j.useEffect)(()=>{i&&g?h():(d(""),p([]))},[i,g,h]);const z=(0,j.useCallback)(async()=>{if(g){f(!0);try{p((await at(g.id)).map(x=>x.user).filter(x=>x!==null&&(x.name?.toLowerCase().includes(n.toLowerCase())||x.handle.toLowerCase().includes(n.toLowerCase()))))}catch(x){console.error("Search failed:",x)}finally{f(!1)}}},[n,g]);(0,j.useEffect)(()=>{const x=setTimeout(()=>{n.trim()&&i?z():!n.trim()&&i&&h()},300);return()=>clearTimeout(x)},[n,i,z,h]);const k=async x=>{x&&x.stopPropagation();try{await we(s),o(!0),v("Link copied to clipboard!","success"),setTimeout(()=>o(!1),2e3)}catch(S){console.error("Failed to copy:",S),v("Failed to copy link","error")}},N=async x=>{if(g){c(x.id);try{await ks(await Cs(g.id,x.id),g.id,s,"text"),v(`Sent to ${x.name||x.handle}!`,"success")}catch(S){console.error("Failed to send message:",S),v("Failed to send message","error")}finally{c(null)}}},w=[{name:"X",icon:Bt,color:"bg-black text-white",href:`https://twitter.com/intent/tweet?url=${encodeURIComponent(s)}`},{name:"Facebook",icon:Wt,color:"bg-[#1877F2] text-white",href:`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(s)}`},{name:"LinkedIn",icon:Vt,color:"bg-[#0A66C2] text-white",href:`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(s)}`},{name:"WhatsApp",icon:Zt,color:"bg-[#25D366] text-white",href:`https://wa.me/?text=${encodeURIComponent(s)}`},{name:"Email",icon:qt,color:"bg-zinc-600 text-white",href:`mailto:?body=${encodeURIComponent(s)}`}],_=async()=>{if(navigator.share)try{await navigator.share({title:r,url:s})}catch(x){x.name!=="AbortError"&&console.error("Native share failed:",x)}else k()};return(0,t.jsx)(yt,{isOpen:i,onClose:e,title:r,className:"max-w-[420px] !p-0 overflow-hidden",overlayClassName:a,children:(0,t.jsxs)("div",{className:"flex h-full flex-col bg-white dark:bg-zinc-900",children:[(0,t.jsx)("div",{className:"px-5 pb-2 pt-4",children:(0,t.jsxs)("div",{className:"group relative",children:[(0,t.jsx)(Yt,{className:"absolute left-3 top-1/2 size-4 -translate-y-1/2 text-zinc-400 transition-colors group-focus-within:text-violet-500"}),(0,t.jsx)("input",{type:"text",placeholder:"Search people...",value:n,onChange:x=>d(x.target.value),className:"w-full rounded-xl border-none bg-zinc-100 py-2.5 pl-10 pr-4 text-sm transition-all focus:ring-2 focus:ring-violet-500/20 outline-none dark:bg-zinc-800/50"})]})}),(0,t.jsx)("div",{className:"no-scrollbar flex min-h-[100px] items-center gap-4 overflow-x-auto px-5 py-4",children:u?(0,t.jsx)("div",{className:"flex flex-1 justify-center",children:(0,t.jsx)("span",{className:"animate-pulse font-bold text-zinc-400",children:"Loading..."})}):b.length>0?b.map(x=>(0,t.jsxs)("button",{onClick:()=>N(x),disabled:m!==null,className:"group flex shrink-0 flex-col items-center gap-1.5 disabled:opacity-50",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"size-14 overflow-hidden rounded-full border-2 border-white shadow-sm transition-transform group-hover:scale-105 bg-zinc-100 dark:bg-zinc-800 dark:border-zinc-900",children:(0,t.jsx)("img",{src:x.avatar||`https://i.pravatar.cc/150?u=${x.id}`,alt:x.handle,className:"size-full object-cover"})}),m===x.id&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center rounded-full bg-black/40",children:(0,t.jsx)("span",{className:"animate-pulse text-white font-bold",children:"..."})})]}),(0,t.jsx)("span",{className:"max-w-[60px] truncate text-[10px] font-medium text-zinc-500 dark:text-zinc-400",children:x.name?.split(" ")[0]||x.handle})]},x.id)):(0,t.jsx)("div",{className:"flex-1 py-2 text-center",children:(0,t.jsx)("span",{className:"text-xs text-zinc-400",children:"No people found"})})}),(0,t.jsx)("div",{className:"mx-5 h-px bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsxs)("div",{className:"grid grid-cols-5 gap-2 px-5 py-6",children:[w.map(x=>(0,t.jsxs)("a",{href:x.href,target:"_blank",rel:"noopener noreferrer",className:"group flex flex-col items-center gap-2",children:[(0,t.jsx)("div",{className:`size-12 ${x.color} flex items-center justify-center rounded-2xl shadow-md transition-all group-hover:-translate-y-1 group-hover:scale-110 group-hover:shadow-lg`,children:(0,t.jsx)(x.icon,{size:20,strokeWidth:2.5})}),(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-tighter text-zinc-500 dark:text-zinc-400",children:x.name})]},x.name)),(0,t.jsxs)("button",{onClick:_,className:"group flex flex-col items-center gap-2",children:[(0,t.jsx)("div",{className:"flex size-12 items-center justify-center rounded-2xl border border-zinc-200 bg-zinc-100 text-zinc-600 shadow-sm transition-all group-hover:-translate-y-1 group-hover:scale-110 dark:border-zinc-700 dark:bg-zinc-800 dark:text-zinc-300",children:(0,t.jsx)(ze,{size:20,strokeWidth:2.5})}),(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-tighter text-zinc-500 dark:text-zinc-400",children:"More"})]})]}),(0,t.jsx)("div",{className:"px-5 pb-6",children:(0,t.jsxs)("div",{className:"group relative",children:[(0,t.jsx)("input",{type:"text",readOnly:!0,value:s,className:"w-full rounded-2xl border border-zinc-200 bg-zinc-50 py-3.5 pl-4 pr-14 text-sm font-medium transition-colors focus:outline-none group-hover:border-zinc-300 dark:border-zinc-800 dark:bg-zinc-950 dark:group-hover:border-zinc-700"}),(0,t.jsx)("button",{onClick:k,className:`absolute right-1.5 top-1/2 flex -translate-y-1/2 items-center gap-2 rounded-xl h-10 px-4 text-xs font-bold shadow-sm transition-all active:scale-95 ${l?"bg-emerald-500 text-white":"bg-zinc-900 text-white hover:opacity-90 dark:bg-white dark:text-zinc-900"}`,children:l?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(is,{size:14,strokeWidth:3}),(0,t.jsx)("span",{children:"Copied"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Qt,{size:14,strokeWidth:3}),(0,t.jsx)("span",{children:"Copy"})]})})]})}),(0,t.jsx)("div",{className:"px-5 pb-5",children:(0,t.jsxs)("button",{onClick:e,className:"group relative flex w-full items-center justify-center overflow-hidden rounded-2xl bg-zinc-900 py-4 font-bold text-white transition-all hover:shadow-xl hover:shadow-zinc-900/10 active:scale-[0.98] dark:bg-white dark:text-zinc-900 dark:hover:shadow-white/10",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-zinc-500 to-zinc-600 opacity-0 transition-opacity duration-300 group-hover:opacity-100"}),(0,t.jsx)("div",{className:"relative flex items-center gap-2",children:(0,t.jsx)("span",{children:"Close"})})]})})]})})},Ct=vi,$t=U(),bi=i=>{const e=(0,$t.c)(6),{avatars:s}=i;if(!s||s.length===0)return null;let r,a;if(e[0]!==s){const o=s.slice(0,3);r="relative mt-2 h-7 w-7",a=o.map((n,d)=>{let b,p;return o.length===1?(b="top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",p="size-5"):o.length===2?(p="size-4",b=d===0?"top-0 right-0":"bottom-0 left-0"):(p=d===0?"size-3.5":"size-3",d===0?b="top-0 right-0":d===1?b="bottom-0 right-0":b="top-1/2 left-0 -translate-y-1/2"),(0,t.jsx)("div",{className:`absolute rounded-full border border-white bg-zinc-100 dark:border-black dark:bg-zinc-800 overflow-hidden shadow-sm ${b} ${p}`,style:{zIndex:10-d},children:(0,t.jsx)("img",{src:n,alt:"",className:"h-full w-full object-cover"})},d)}),e[0]=s,e[1]=r,e[2]=a}else r=e[1],a=e[2];let l;return e[3]!==r||e[4]!==a?(l=(0,t.jsx)("div",{className:r,children:a}),e[3]=r,e[4]=a,e[5]=l):l=e[5],l},ht=i=>{const e=(0,$t.c)(70),{id:s,user:r,isCurrentUser:a,isComment:l,onEdit:o,onDelete:n,addToast:d,trigger:b}=i,{openReport:p}=zt(),[u,f]=(0,j.useState)(!1);if(hs("(min-width: 1024px)")){let C;e[0]!==b?(C=(0,t.jsx)(cs,{asChild:!0,onClick:ki,children:(0,t.jsx)("div",{className:"cursor-pointer outline-none",children:b})}),e[0]=b,e[1]=C):C=e[1];let y;e[2]!==d||e[3]!==s||e[4]!==l?(y=!l&&(0,t.jsxs)(le,{onClick:V=>{V.stopPropagation(),we(`${nt()}/p/${s}`).then(()=>{d("Link copied"),f(!1)}).catch(()=>{d("Failed to copy link","error")})},children:[(0,t.jsx)(qe,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Copy link"})]}),e[2]=d,e[3]=s,e[4]=l,e[5]=y):y=e[5];let P;e[6]!==s||e[7]!==p?(P=V=>{V.stopPropagation(),p("post",s),f(!1)},e[6]=s,e[7]=p,e[8]=P):P=e[8];let F;e[9]===Symbol.for("react.memo_cache_sentinel")?(F=(0,t.jsx)(ke,{className:"mr-2 h-4 w-4"}),e[9]=F):F=e[9];const I=l?"comment":"post";let E;e[10]!==I?(E=(0,t.jsxs)("span",{children:["Report ",I]}),e[10]=I,e[11]=E):E=e[11];let A;e[12]!==P||e[13]!==E?(A=(0,t.jsxs)(le,{onClick:P,children:[F,E]}),e[12]=P,e[13]=E,e[14]=A):A=e[14];let L;e[15]!==a||e[16]!==p||e[17]!==r?(L=!a&&(0,t.jsxs)(le,{onClick:V=>{V.stopPropagation(),p("user",r.id),f(!1)},children:[(0,t.jsx)(He,{className:"mr-2 h-4 w-4"}),(0,t.jsxs)("span",{children:["Report @",r.handle]})]}),e[15]=a,e[16]=p,e[17]=r,e[18]=L):L=e[18];let H;e[19]!==l||e[20]!==a||e[21]!==n||e[22]!==o?(H=a&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(vs,{}),(0,t.jsxs)(le,{onClick:V=>{V.stopPropagation(),o(),f(!1)},children:[(0,t.jsx)(Ge,{className:"mr-2 h-4 w-4"}),(0,t.jsxs)("span",{children:["Edit ",l?"Comment":"Post"]})]}),(0,t.jsxs)(le,{className:"text-red-500 focus:text-red-500",onClick:V=>{V.stopPropagation(),n(),f(!1)},children:[(0,t.jsx)(Ue,{className:"mr-2 h-4 w-4"}),(0,t.jsxs)("span",{children:["Delete ",l?"comment":"post"]})]})]}),e[19]=l,e[20]=a,e[21]=n,e[22]=o,e[23]=H):H=e[23];let G;e[24]!==y||e[25]!==A||e[26]!==L||e[27]!==H?(G=(0,t.jsxs)(gs,{align:"end",className:"w-56",onClick:Ni,children:[y,A,L,H]}),e[24]=y,e[25]=A,e[26]=L,e[27]=H,e[28]=G):G=e[28];let Q;return e[29]!==u||e[30]!==C||e[31]!==G?(Q=(0,t.jsx)("div",{onClick:zi,children:(0,t.jsxs)(Rs,{open:u,onOpenChange:f,modal:!0,children:[C,G]})}),e[29]=u,e[30]=C,e[31]=G,e[32]=Q):Q=e[32],Q}let m;e[33]===Symbol.for("react.memo_cache_sentinel")?(m=C=>{C.stopPropagation(),f(!0)},e[33]=m):m=e[33];let c;e[34]!==b?(c=(0,t.jsx)("div",{onClick:m,className:"cursor-pointer",children:b}),e[34]=b,e[35]=c):c=e[35];let v;e[36]===Symbol.for("react.memo_cache_sentinel")?(v=()=>f(!1),e[36]=v):v=e[36];let g;e[37]!==d||e[38]!==s||e[39]!==l?(g=!l&&(0,t.jsx)(ne,{icon:(0,t.jsx)(qe,{size:18}),onClick:C=>{C.stopPropagation(),we(`${nt()}/p/${s}`).then(()=>{d("Link copied"),f(!1)}).catch(()=>{d("Failed to copy link","error")})},children:"Copy link"}),e[37]=d,e[38]=s,e[39]=l,e[40]=g):g=e[40];let h;e[41]===Symbol.for("react.memo_cache_sentinel")?(h=(0,t.jsx)(ke,{size:18}),e[41]=h):h=e[41];let z;e[42]!==s||e[43]!==p?(z=C=>{C.stopPropagation(),p("post",s),f(!1)},e[42]=s,e[43]=p,e[44]=z):z=e[44];const k=l?"comment":"post";let N;e[45]!==z||e[46]!==k?(N=(0,t.jsxs)(ne,{icon:h,onClick:z,children:["Report ",k]}),e[45]=z,e[46]=k,e[47]=N):N=e[47];let w;e[48]!==a||e[49]!==p||e[50]!==r?(w=!a&&(0,t.jsxs)(ne,{icon:(0,t.jsx)(He,{size:18}),onClick:C=>{C.stopPropagation(),p("user",r.id),f(!1)},children:["Report @",r.handle]}),e[48]=a,e[49]=p,e[50]=r,e[51]=w):w=e[51];let _;e[52]!==l||e[53]!==a||e[54]!==o?(_=a&&(0,t.jsxs)(ne,{icon:(0,t.jsx)(Ge,{size:18}),onClick:C=>{C.stopPropagation(),o(),f(!1)},children:["Edit ",l?"Comment":"Post"]}),e[52]=l,e[53]=a,e[54]=o,e[55]=_):_=e[55];let x;e[56]!==l||e[57]!==a||e[58]!==n?(x=a&&(0,t.jsxs)(ne,{variant:"destructive",icon:(0,t.jsx)(Ue,{size:18}),onClick:C=>{C.stopPropagation(),n(),f(!1)},children:["Delete ",l?"comment":"post"]}),e[56]=l,e[57]=a,e[58]=n,e[59]=x):x=e[59];let S;e[60]!==u||e[61]!==_||e[62]!==x||e[63]!==g||e[64]!==N||e[65]!==w?(S=(0,t.jsx)("div",{onClick:wi,children:(0,t.jsxs)(Ms,{isOpen:u,onClose:v,children:[g,N,w,_,x]})}),e[60]=u,e[61]=_,e[62]=x,e[63]=g,e[64]=N,e[65]=w,e[66]=S):S=e[66];let M;return e[67]!==S||e[68]!==c?(M=(0,t.jsxs)(t.Fragment,{children:[c,S]}),e[67]=S,e[68]=c,e[69]=M):M=e[69],M},_e=({id:i,user:e,timeAgo:s,content:r,contentClass:a,media:l,quotedPost:o,stats:n,onClick:d,repostedBy:b,onUserClick:p,currentUser:u,poll:f,isDetail:m,initialComments:c,onDelete:v,onUpdate:g,isComment:h,onReply:z,community:k,parent_id:N,post_id:w,commenterAvatars:_=[]})=>{const x=gt(),{addToast:S}=Se(),{liked:M,reposted:C,localStats:y,setLocalStats:P,handleLike:F,handleRepost:I}=Ps(w||i,n,u),{deletePost:E,updatePost:A}=Ns(),{comments:L,fetchNextPage:H,hasNextPage:G,isFetchingNextPage:Q,addComment:V,deleteComment:ve,updateComment:$,isSubmitting:R}=it(w||i,c),[D,q]=(0,j.useState)(""),[X,Te]=(0,j.useState)([]),[_t,Fe]=(0,j.useState)(!1),[Re,ie]=(0,j.useState)(!1),[ce,K]=(0,j.useState)(!1),[Y,de]=(0,j.useState)(r),[me,xe]=(0,j.useState)(l||[]),[fe,ae]=(0,j.useState)([]),[Me,Ie]=(0,j.useState)(!1),[St,be]=(0,j.useState)(!1),[je,ue]=(0,j.useState)(null),[ye,Ee]=(0,j.useState)(!1),{comments:Pt,refetch:De}=it(w||i,void 0,ye?i:void 0),{ref:Ae,inView:Le}=Dt({threshold:.5,triggerOnce:!0});(0,j.useEffect)(()=>{if(Le&&!h&&i&&!i.startsWith("temp-")){const T=setTimeout(()=>{Ts(i).catch(console.error)},1500);return()=>clearTimeout(T)}},[Le,i,h]);const Tt=(0,j.useCallback)(async()=>{!i||!w&&!i||y.comments===0||(Ee(!0),De())},[i,w,y.comments,De]),Oe=async()=>{const T=JSON.stringify(me)!==JSON.stringify(l||[])||fe.length>0;if(!Y.trim()||Y===r&&!T){K(!1);return}Ie(!0);try{const O=[];for(const Z of fe){const Mt=await Ce(Z);O.push(Mt)}const W=[...me,...O];h?await $({commentId:i,content:Y,media:W}):await A(i,{content:Y,media:W}),ae([]),K(!1),S(`${h?"Comment":"Post"} updated`),g&&g(i,Y,W)}catch(O){console.error(`Failed to update ${h?"comment":"post"}:`,O),S(`Failed to update ${h?"comment":"post"}`)}finally{Ie(!1)}},Be=async T=>{T&&T.stopPropagation();try{h?await ve(i):await E(i),S(`${h?"Comment":"Post"} deleted successfully`),v&&v(i)}catch(O){console.error(`Failed to delete ${h?"comment":"post"}:`,O),S(`Failed to delete ${h?"comment":"post"}`)}finally{ie(!1)}},Ft=async T=>{if(T.preventDefault(),!(!D.trim()&&X.length===0||!u)){Fe(!0);try{const O=[];for(const W of X){const Z=await Ce(W);O.push(Z)}await V({userId:u.id,content:D,media:O,replyToId:je?.id}),q(""),Te([]),ue(null),P(W=>({...W,comments:(W.comments||0)+1})),S("Reply posted!")}catch(O){console.error("Failed to post comment:",O),S("Failed to post reply.")}finally{Fe(!1)}}},Ve=u?.handle===e.handle,Rt=(T,O)=>{ue(O?{handle:T,id:h?N||i:O}:null),q(W=>{const Z=`@${T} `;return W.includes(Z)?W:Z+W}),document.getElementById("comment-input")?.focus()};return m?(0,t.jsxs)(B.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"flex flex-col",ref:Ae,children:[(0,t.jsxs)("article",{className:"p-6 dark:bg-black",children:[(0,t.jsx)(ct,{user:e,timeAgo:s,community:k,onUserClick:p,isDetail:!0,showAvatar:!0,actionsMenu:(0,t.jsx)(ht,{id:i,user:e,isCurrentUser:Ve,isComment:h,onEdit:()=>K(!0),onDelete:()=>ie(!0),addToast:S,trigger:(0,t.jsx)("button",{"aria-label":"More options",className:"rounded-full p-2 text-zinc-500 transition-colors hover:bg-zinc-100 dark:hover:bg-zinc-800",children:(0,t.jsx)(ze,{size:20})})})}),(0,t.jsx)(dt,{content:r,isDetail:!0,isEditing:ce,editedContent:Y,setEditedContent:de,onCancelEdit:()=>{K(!1),de(r),xe(l||[]),ae([])},onSaveEdit:Oe,isUpdating:Me,contentClass:a}),he(r)&&(0,t.jsx)(ut,{url:he(r)}),(0,t.jsx)(mt,{media:l,isEditing:ce,editedMedia:me,setEditedMedia:xe,newFiles:fe,setNewFiles:ae}),f&&(0,t.jsx)(xt,{poll:f,onVote:T=>os(i,T,u.id)}),o&&(0,t.jsx)("div",{className:"mt-5 overflow-hidden rounded-2xl border border-zinc-200 shadow-sm dark:border-zinc-700",children:(0,t.jsx)(ft,{...o})}),(0,t.jsx)(ot,{views:y.views||0,likes:y.likes||0,comments:y.comments||0,isDetail:!0}),(0,t.jsx)("div",{className:"my-4"}),(0,t.jsx)(rt,{liked:M,reposted:C,handleLike:F,handleRepost:I,handleCommentClick:()=>document.getElementById("comment-input")?.focus(),handleShareClick:()=>be(!0),isDetail:!0,isComment:h})]}),je&&(0,t.jsxs)("div",{className:"flex items-center justify-between bg-zinc-50 px-5 py-2 dark:bg-zinc-900/50",children:[(0,t.jsxs)("span",{className:"text-sm text-zinc-500",children:["Replying to"," ",(0,t.jsxs)("span",{className:"font-bold text-violet-600",children:["@",je.handle]})]}),(0,t.jsx)("button",{onClick:()=>ue(null),className:"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200",children:(0,t.jsx)(oe,{size:16})})]}),(0,t.jsx)(Nt,{currentUser:u,newComment:D,setNewComment:q,handleSubmitComment:Ft,loading:R,selectedFiles:X,setSelectedFiles:Te,isUploading:_t}),(0,t.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:[(0,t.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:(0,t.jsxs)(t.Fragment,{children:[G&&L.length>0&&(0,t.jsxs)("button",{onClick:()=>H(),disabled:Q,className:"flex w-full items-center justify-center gap-2 py-3 text-sm font-bold text-violet-600 transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[Q&&(0,t.jsx)("span",{className:"animate-spin",children:"⌛"}),"View more replies"]}),L.map(T=>(0,t.jsx)(_e,{...T,isComment:!0,post_id:i,onReply:Rt,onUserClick:p,currentUser:u,stats:{likes:T.stats?.likes||0,comments:T.stats?.comments||0,reposts:T.stats?.reposts||0},timeAgo:T.timeAgo||T.created_at},T.id))]})}),(0,t.jsx)(Ke,{open:Re,onOpenChange:ie,children:(0,t.jsxs)(Ye,{onClick:T=>T.stopPropagation(),children:[(0,t.jsxs)(st,{children:[(0,t.jsx)(tt,{children:"Are you absolutely sure?"}),(0,t.jsx)(lt,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,t.jsxs)(Je,{children:[(0,t.jsx)(Xe,{onClick:T=>T.stopPropagation(),children:"Cancel"}),(0,t.jsx)(et,{onClick:Be,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]})]}):(0,t.jsxs)(B.article,{initial:{opacity:0,y:10},whileInView:{opacity:1,y:0},viewport:{once:!0,margin:"-50px"},transition:{duration:.4,ease:"easeOut"},ref:Ae,onClick:d,className:`px-5 transition-all ${h?"py-3 bg-transparent hover:bg-zinc-50/30 dark:hover:bg-zinc-800/20":"py-5 bg-white hover:bg-zinc-50/30 dark:bg-black dark:hover:bg-white/[0.02]"} ${d?"cursor-pointer":""}`,children:[b&&(0,t.jsxs)("div",{className:"mb-2.5 ml-1 flex items-center space-x-1.5 text-[13px] font-semibold text-zinc-600",children:[(0,t.jsx)(Ne,{size:14,className:"text-zinc-500"}),(0,t.jsxs)("span",{className:"flex cursor-pointer items-center text-zinc-700 hover:underline dark:text-zinc-300",onClick:T=>{T.stopPropagation(),p&&p(b.handle)},children:[b.handle," Reposted"]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-x-3.5",children:[(0,t.jsxs)("div",{className:"flex shrink-0 flex-col items-center self-stretch pt-0.5",children:[(0,t.jsx)("div",{className:"cursor-pointer",onClick:T=>{T.stopPropagation(),p&&p(e.handle)},children:(0,t.jsxs)(se,{className:`${h?"size-8":"size-10"} border-0 shadow-sm`,children:[(0,t.jsx)(ee,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,t.jsx)(te,{className:"text-xs",children:e.handle[0]?.toUpperCase()})]})}),(!h&&y.comments>0||h&&!N&&y.comments>0)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"mt-2 w-0.5 flex-1 rounded-full bg-zinc-100 dark:bg-zinc-800"}),!h&&(0,t.jsx)(bi,{avatars:_.length>0?_:(L||[]).slice(0,3).map(T=>T.user.avatar)})]})]}),(0,t.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col",children:[(0,t.jsx)(ct,{user:e,timeAgo:s,community:k,onUserClick:p,isComment:h,actionsMenu:(0,t.jsx)(ht,{id:i,user:e,isCurrentUser:Ve,isComment:h,onEdit:()=>K(!0),onDelete:()=>ie(!0),addToast:S,trigger:(0,t.jsx)("button",{"aria-label":"More options",className:"rounded-full p-2 text-zinc-500 transition-colors hover:bg-zinc-100 group-hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:group-hover:bg-zinc-800/50",children:(0,t.jsx)(ze,{size:18})})})}),(0,t.jsx)(dt,{content:r,isEditing:ce,editedContent:Y,setEditedContent:de,onCancelEdit:()=>{K(!1),de(r),xe(l||[]),ae([])},onSaveEdit:Oe,isUpdating:Me,contentClass:a}),he(r)&&(0,t.jsx)(ut,{url:he(r)}),(0,t.jsx)(mt,{media:l,isEditing:ce,editedMedia:me,setEditedMedia:xe,newFiles:fe,setNewFiles:ae}),f&&(0,t.jsx)(xt,{poll:f}),o&&(0,t.jsx)("div",{className:"mt-3 overflow-hidden rounded-2xl border border-zinc-200 shadow-sm transition-all hover:bg-zinc-50 dark:border-zinc-800 dark:hover:bg-zinc-900",onClick:T=>{T.stopPropagation(),x(`/p/${o.id}`)},children:(0,t.jsx)(ft,{...o})}),(0,t.jsx)(rt,{liked:M,reposted:C,handleLike:F,handleRepost:I,handleCommentClick:T=>{if(T?.stopPropagation(),z){const O=h&&N||i;z(e.handle,O)}else d&&d()},handleShareClick:T=>{T?.stopPropagation(),be(!0)},isComment:h}),(0,t.jsx)(ot,{views:y.views||0,likes:y.likes||0,comments:y.comments||0,isComment:h,onRepliesClick:()=>{ye?Ee(!1):Tt()}}),ye&&(0,t.jsxs)("div",{className:"relative mt-2 space-y-0",children:[(0,t.jsx)("div",{className:"absolute left-[19px] top-0 bottom-4 w-0.5 bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsx)("div",{className:"flex flex-col",children:Pt.map(T=>(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute left-[19px] top-5 h-0.5 w-4 bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsx)("div",{className:"pl-6",children:(0,t.jsx)(_e,{...T,isComment:!0,post_id:w||i,onReply:z,onUserClick:p,currentUser:u,stats:{likes:T.stats?.likes||0,comments:T.stats?.comments||0,reposts:T.stats?.reposts||0},timeAgo:T.timeAgo||T.created_at})})]},T.id))})]}),(0,t.jsx)(Ct,{isOpen:St,onClose:()=>be(!1),url:`${window.location.origin}/p/${i}`,title:"Share Post",overlayClassName:"z-[9999]"}),(0,t.jsx)(Ke,{open:Re,onOpenChange:ie,children:(0,t.jsxs)(Ye,{onClick:T=>T.stopPropagation(),children:[(0,t.jsxs)(st,{children:[(0,t.jsx)(tt,{children:"Are you absolutely sure?"}),(0,t.jsx)(lt,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,t.jsxs)(Je,{children:[(0,t.jsx)(Xe,{onClick:T=>T.stopPropagation(),children:"Cancel"}),(0,t.jsx)(et,{onClick:Be,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]})]})]})};function ji(i,e){const s=!i.media&&!e.media||i.media?.length===e.media?.length&&i.media?.every((a,l)=>a.url===e.media?.[l].url),r=i.repostedBy?.handle===e.repostedBy?.handle;return i.id===e.id&&i.content===e.content&&i.timeAgo===e.timeAgo&&i.user.id===e.user.id&&i.user.avatar===e.user.avatar&&i.stats.likes===e.stats.likes&&i.stats.comments===e.stats.comments&&i.stats.reposts===e.stats.reposts&&i.currentUser?.id===e.currentUser?.id&&!!s&&!!r}var yi=j.memo(_e,ji);function zi(i){return i.stopPropagation()}function ki(i){return i.stopPropagation()}function Ni(i){return i.stopPropagation()}function wi(i){return i.stopPropagation()}var Ci=j.memo(({reel:i,isActive:e,volume:s,shouldLoad:r=!0})=>{const{currentUser:a}=jt(),{addToast:l}=Se(),{openReport:o}=zt(),n=(0,j.useRef)(null),[d,b]=(0,j.useState)(!1),[p,u]=(0,j.useState)(!1),[f,m]=(0,j.useState)(!1),[c,v]=(0,j.useState)(!1),[g,h]=(0,j.useState)(null),[z,k]=(0,j.useState)(!1),[N,w]=(0,j.useState)(i.stats?.likes||0),[_,x]=(0,j.useState)(!1),[S,M]=(0,j.useState)(0),[C,y]=(0,j.useState)(!1),P=(0,j.useRef)(null),F=(0,j.useMemo)(()=>Array.isArray(i.media)?i.media[0]?.src||i.media[0]?.url:i.media?.src||i.media?.url||i.url,[i.media,i.url]);(0,j.useEffect)(()=>{v(!1),y(!1);const $=n.current?.plyr;if($&&typeof $.on=="function"){const R=()=>v(!0),D=()=>y(!0);$.on("ready",R),$.on("canplay",R),$.on("loadeddata",R),$.on("playing",D);const q=setTimeout(()=>{!C&&e&&y(!0)},3e3);return()=>{clearTimeout(q),typeof $.off=="function"&&($.off("ready",R),$.off("canplay",R),$.off("loadeddata",R),$.off("playing",D))}}else{const R=setTimeout(()=>{v(!0),e&&y(!0)},1500);return()=>clearTimeout(R)}},[F,e]);const I=(0,j.useRef)(null);(0,j.useEffect)(()=>{const $=n.current?.plyr;if(I.current&&(clearTimeout(I.current),I.current=null),!(!$||!c))return e?I.current=setTimeout(()=>{I.current=null;const R=n.current?.plyr;R&&typeof R.play=="function"&&R.play().catch(()=>{const D=n.current?.plyr;D&&(D.muted=!0,D.play().catch(()=>{}))})},100):typeof $.pause=="function"&&$.pause(),()=>{I.current&&(clearTimeout(I.current),I.current=null);const R=n.current?.plyr;R&&typeof R.pause=="function"&&R.pause()}},[e,c]),(0,j.useEffect)(()=>()=>{I.current&&clearTimeout(I.current);const $=n.current?.plyr;$&&typeof $.pause=="function"&&$.pause()},[]),(0,j.useEffect)(()=>{if(!a?.id||!e)return;(async()=>{try{const[R,D]=await Promise.all([ps(i.id,a.id),fs(a.id,i.user?.id)]);k(R),x(D)}catch(R){console.error("Failed to check interaction status:",R)}})()},[i.id,a?.id,e,i.user?.id]),(0,j.useEffect)(()=>{const $=n.current?.plyr;$&&($.muted=s===0,$.volume=s)},[s,c]),(0,j.useEffect)(()=>{const $=n.current?.plyr;if(!$||!e)return;const R=()=>{const D=$.currentTime,q=$.duration;q>0&&M(D/q*100)};if(typeof $.on=="function")return $.on("timeupdate",R),()=>{typeof $.off=="function"&&$.off("timeupdate",R)}},[e]);const E=$=>{$.stopPropagation();const R=$.currentTarget.getBoundingClientRect(),D=$.clientX-R.left,q=Math.min(Math.max(0,D/R.width),1),X=n.current?.plyr;X&&X.duration&&(X.currentTime=q*X.duration,M(q*100))};(0,j.useEffect)(()=>()=>{P.current&&clearTimeout(P.current)},[]);const A=$=>{const R=$.target;R.closest("button")||R.closest("a")||R.closest(".plyr__controls")||(P.current?(clearTimeout(P.current),P.current=null,H()):P.current=setTimeout(()=>{P.current=null,L()},250))},L=()=>{const $=n.current?.plyr;$&&($.paused?($.play().catch(()=>{}),h("play")):($.pause(),h("pause")),setTimeout(()=>h(null),800))},H=async()=>{if(a&&(b(!0),setTimeout(()=>b(!1),800),!z)){k(!0),w($=>$+1);try{await Qe(i.id,a.id)}catch{k(!1),w($=>$-1)}}},G=async $=>{if($.stopPropagation(),!a)return;const R=!z;k(R),w(D=>R?D+1:D-1);try{await Qe(i.id,a.id)}catch{k(!R),w(D=>R?D-1:D+1)}},Q=async $=>{if($.stopPropagation(),!a)return;const R=!_;x(R);try{await ms(a.id,i.user?.id)}catch{x(!R)}},V=$=>{$.stopPropagation(),m(!0)},ve=(0,j.useMemo)(()=>({source:{type:"video",sources:[{src:F,type:"video/mp4"}]},options:{controls:[],loop:{active:!0},clickToPlay:!1,ratio:"9:16",autoplay:!0,playsinline:!0}}),[F]);return(0,t.jsxs)("div",{"data-id":i.id,className:"reel-item relative flex h-[100dvh] w-full snap-start items-center justify-center overflow-hidden bg-black cursor-pointer select-none",onClick:A,children:[(0,t.jsxs)("div",{className:"relative flex h-full w-full max-w-[450px] items-center justify-center",children:[(0,t.jsx)("div",{className:"w-full",children:r?(0,t.jsx)(ns,{ref:n,...ve}):(0,t.jsx)("div",{className:"aspect-[9/16] w-full bg-zinc-900",children:(0,t.jsx)("img",{src:i.media?.[0]?.preview||i.media?.[0]?.thumbnail||F,className:"h-full w-full object-cover opacity-50 blur-xl",alt:"Reel preview"})})}),!C&&(0,t.jsx)("div",{className:"absolute inset-0 z-[60] flex items-center justify-center bg-zinc-900 pointer-events-none",children:(0,t.jsx)(ys,{})}),(0,t.jsx)($e,{children:d&&(0,t.jsx)(B.div,{initial:{scale:0,opacity:0},animate:{scale:[0,1.2,1],opacity:1},exit:{scale:1.5,opacity:0},transition:{duration:.5,type:"spring",stiffness:400,damping:20},className:"pointer-events-none absolute inset-0 z-50 flex items-center justify-center",children:(0,t.jsx)(pe,{size:120,fill:"white",className:"text-white drop-shadow-[0_0_30px_rgba(255,255,255,0.4)]"})})}),(0,t.jsx)($e,{children:g&&(0,t.jsx)(B.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},exit:{scale:1.5,opacity:0},transition:{duration:.4},className:"pointer-events-none absolute inset-0 z-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"rounded-full border border-white/20 bg-white/10 p-8 shadow-2xl backdrop-blur-md",children:g==="play"?(0,t.jsx)(es,{size:50,fill:"white",className:"ml-1.5 text-white"}):(0,t.jsx)(as,{size:50,fill:"white",className:"text-white"})})})}),(0,t.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-black/60"}),(0,t.jsxs)("div",{className:"pointer-events-none absolute bottom-6 left-4 right-16 text-white",children:[(0,t.jsxs)("div",{className:"pointer-events-auto mb-3 flex items-center gap-2",children:[(0,t.jsxs)(It,{to:`/u/${i.user?.handle}`,className:"flex items-center gap-2 transition-opacity hover:opacity-80 active:scale-95",onClick:$=>$.stopPropagation(),children:[(0,t.jsxs)(se,{className:"size-10 border-2 border-white",children:[(0,t.jsx)(ee,{src:i.user?.avatar,alt:i.user?.handle,className:"object-cover"}),(0,t.jsx)(te,{children:i.user?.handle?.[0]?.toUpperCase()})]}),(0,t.jsxs)("span",{className:"font-bold",children:["@",i.user?.handle]})]}),a?.id!==i.user?.id&&(0,t.jsx)("button",{className:`ml-2 flex items-center gap-1.5 rounded-full px-3 py-1.5 text-xs font-bold transition-all active:scale-95 ${_?"border border-white/50 bg-transparent text-white":"bg-white text-black hover:bg-zinc-200"}`,onClick:Q,children:_?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(us,{size:14}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Following"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(xs,{size:14}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Follow"})]})})]}),(0,t.jsx)(Pe,{content:i.content,className:"mb-3 line-clamp-2 text-sm text-white"}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs opacity-90",children:[(0,t.jsx)(ts,{size:14,className:"animate-spin-slow"}),(0,t.jsxs)("span",{children:["Original Audio - ",i.user?.handle]})]})]}),(0,t.jsxs)("div",{className:"absolute bottom-6 right-2 z-10 flex flex-col items-center gap-6",children:[(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)(B.button,{whileTap:{scale:.8},className:`rounded-full p-3 backdrop-blur-md transition-all ${z?"bg-rose-500/20 text-rose-500":"bg-zinc-800/50 text-white hover:bg-zinc-700"}`,onClick:G,children:(0,t.jsx)(B.div,{animate:z?{scale:[1,1.3,1]}:{scale:1},transition:{duration:.3},children:(0,t.jsx)(pe,{size:28,fill:z?"currentColor":"none"})})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:N})]}),(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)(B.button,{whileTap:{scale:.8},className:"rounded-full bg-zinc-800/50 p-3 text-white backdrop-blur-md transition-colors hover:bg-zinc-700",onClick:$=>{$.stopPropagation(),u(!0)},children:(0,t.jsx)(bt,{size:28})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:i.stats?.comments||0})]}),(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)(B.button,{whileTap:{scale:.8},className:"rounded-full bg-zinc-800/50 p-3 text-white backdrop-blur-md transition-colors hover:bg-zinc-700",onClick:V,children:(0,t.jsx)(ge,{size:28})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:i.stats?.shares||0})]}),(0,t.jsx)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:(0,t.jsx)(B.button,{whileTap:{scale:.8},className:"rounded-full bg-zinc-800/50 p-3 text-white backdrop-blur-md transition-colors hover:bg-rose-500/20 hover:text-rose-500",onClick:$=>{$.stopPropagation(),o("reel",i.id)},children:(0,t.jsx)(ke,{size:28})})})]}),(0,t.jsx)("div",{className:"absolute bottom-0 left-0 z-50 h-[3px] w-full bg-white/20 hover:h-[8px] transition-all cursor-pointer group",onClick:E,children:(0,t.jsx)("div",{className:"h-full bg-white shadow-[0_0_8px_rgba(255,255,255,0.8)] transition-all duration-100 ease-linear relative",style:{width:`${S}%`},children:(0,t.jsx)("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 size-3 bg-white rounded-full shadow-lg scale-0 group-hover:scale-100 transition-transform"})})})]}),(0,t.jsx)(_i,{isOpen:p,onClose:()=>u(!1),reelId:i.id,currentUser:a,showToast:l}),(0,t.jsx)(Ct,{isOpen:f,onClose:()=>m(!1),url:`${window.location.origin}/r/${i.id}`,title:"Share Reel",overlayClassName:"z-[9999]"})]})},(i,e)=>i.isActive===e.isActive&&i.reel.id===e.reel.id&&i.volume===e.volume),Di=Ci,$i=({isOpen:i,onClose:e,reelId:s,currentUser:r,showToast:a})=>{const[l,o]=(0,j.useState)([]),[n,d]=(0,j.useState)(!1),[b,p]=(0,j.useState)(!1),[u,f]=(0,j.useState)(""),[m,c]=(0,j.useState)([]),[v,g]=(0,j.useState)(!1),[h,z]=(0,j.useState)(!0),[k,N]=(0,j.useState)(!1),[w,_]=(0,j.useState)(null),x=(0,j.useRef)(l);(0,j.useEffect)(()=>{x.current=l},[l]);const S=(0,j.useCallback)(async(C=!1)=>{if(!(!s||s.startsWith("temp-"))){C?N(!0):d(!0);try{const y=x.current,P=await rs(s,C&&y.length>0?y[y.length-1].created_at:null,10);P.length<10?z(!1):z(!0),o(C?F=>[...F,...P]:P)}catch(y){console.error("Failed to load comments:",y),a&&a("Failed to load comments","error")}finally{d(!1),N(!1)}}},[s,a]);(0,j.useEffect)(()=>{i&&s?S():(o([]),z(!0))},[i,s,S]);const M=async C=>{if(C.preventDefault(),!(!u.trim()&&m.length===0||!r)){p(!0),g(!0);try{const y=[];for(const P of m){const F=await Ce(P);y.push(F)}await Fs(s,r.id,u,y,w?.id),f(""),c([]),_(null),a&&a("Reply posted!"),S()}catch(y){console.error("Failed to post comment:",y),a&&a("Failed to post reply.","error")}finally{p(!1),g(!1)}}};return(0,t.jsx)(yt,{isOpen:i,onClose:e,title:"Comments",className:"max-sm:h-[95dvh] h-[85vh] overflow-hidden !p-0 sm:max-w-xl",children:(0,t.jsxs)("div",{className:"flex h-full flex-col overflow-hidden bg-white dark:bg-zinc-900",children:[(0,t.jsx)("div",{className:"mx-auto my-3 h-1.5 w-12 shrink-0 rounded-full bg-zinc-200 dark:bg-zinc-800 sm:hidden"}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto scroll-smooth scrollbar-thin scrollbar-thumb-zinc-200 dark:scrollbar-thumb-zinc-800",children:n?(0,t.jsx)("div",{className:"flex flex-col",children:[1,2,3].map(C=>(0,t.jsx)(zs,{},C))}):l.length>0?(0,t.jsxs)("div",{className:"flex flex-col",children:[l.map(C=>(0,t.jsx)(yi,{...C,isComment:!0,post_id:s,currentUser:r,showToast:a,onReply:(y,P)=>{_(P?{handle:y,id:P}:null),f(F=>F.includes(`@${y}`)?F:F+`@${y} `)},onDelete:y=>o(P=>P.filter(F=>F.id!==y)),onUpdate:(y,P,F)=>o(I=>I.map(E=>E.id===y?{...E,content:P,media:F}:E))},C.id)),h&&(0,t.jsx)("div",{className:"flex justify-center border-t border-zinc-100 py-4 dark:border-zinc-800",children:(0,t.jsx)(kt,{variant:"ghost",onClick:()=>S(!0),loading:k,className:"text-violet-600 font-bold",children:"View more replies"})})]}):(0,t.jsxs)("div",{className:"flex h-full min-h-[300px] flex-col items-center justify-center p-8 text-center text-zinc-500",children:[(0,t.jsx)("div",{className:"mb-4 flex size-16 items-center justify-center rounded-full bg-zinc-100 dark:bg-zinc-900",children:(0,t.jsx)(vt,{size:32,className:"text-zinc-400"})}),(0,t.jsx)("p",{className:"text-lg font-bold dark:text-zinc-300",children:"No comments yet"}),(0,t.jsx)("p",{className:"text-sm dark:text-zinc-500",children:"Be the first to share what you think!"})]})}),(0,t.jsxs)("div",{className:"shrink-0 border-t border-zinc-100 bg-white pb-safe dark:border-zinc-800 dark:bg-zinc-900",children:[w&&(0,t.jsxs)("div",{className:"flex items-center justify-between border-b border-zinc-50 bg-zinc-50/50 px-4 py-2 dark:border-zinc-800/50 dark:bg-zinc-900/50",children:[(0,t.jsxs)("span",{className:"text-xs text-zinc-500",children:["Replying to"," ",(0,t.jsxs)("span",{className:"font-bold text-violet-600",children:["@",w.handle]})]}),(0,t.jsx)("button",{onClick:()=>_(null),className:"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200",children:(0,t.jsx)(oe,{size:14})})]}),(0,t.jsx)(Nt,{currentUser:r,newComment:u,setNewComment:f,handleSubmitComment:M,loading:b,selectedFiles:m,setSelectedFiles:c,isUploading:v})]})]})})},_i=$i,Ai=U();export{yi as n,Di as t};
