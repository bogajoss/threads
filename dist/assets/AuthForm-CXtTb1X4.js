import{a as g}from"./rolldown-runtime-BaZ8gS7u.js";import{o as w,s as k}from"./animations-pEILWrFP.js";import{er as N,ir as S,nr as _}from"./ui-libs-CeA_mvKJ.js";import{Et as z,St as C,X as c,kt as A,pn as y}from"./index-z9RTDLkj.js";var t=g(k(),1),e=g(w(),1),q=({type:r,onComplete:b,onSwitch:d})=>{const{login:f,signup:p}=A(),{addToast:n}=z(),[a,i]=(0,t.useState)({name:"",email:"",username:"",password:""}),[v,u]=(0,t.useState)(!1),[h,x]=(0,t.useState)(null),[l,o]=(0,t.useState)({loading:!1,available:null});(0,t.useEffect)(()=>{if(r==="signup"&&a.username.length>=5){const s=setTimeout(async()=>{o({loading:!0,available:null});try{o({loading:!1,available:await y(a.username)})}catch{o({loading:!1,available:null})}},500);return()=>clearTimeout(s)}else o({loading:!1,available:null})},[a.username,r]);const j=async s=>{if(s.preventDefault(),r==="signup"&&(l.available===!1||a.username.length<5)){n(a.username.length<5?"Username must be at least 5 characters":"Please choose a different username","error");return}u(!0),x(null);try{r==="login"?(await f({email:a.email,password:a.password}),n("Welcome back!"),b()):(await p({email:a.email,password:a.password,username:a.username,name:a.name}),n("Confirm Your Email","info"),d())}catch(m){console.error("Auth error:",m),x(m.message||"Authentication failed. Please check your credentials."),n("Authentication failed!","error")}finally{u(!1)}};return(0,e.jsxs)("div",{className:"mx-auto w-full max-w-md animate-in fade-in slide-in-from-bottom-5 duration-300 p-8",children:[(0,e.jsxs)("div",{className:"mb-8 text-center",children:[(0,e.jsx)("div",{className:"mb-4 flex justify-center",children:(0,e.jsx)("div",{className:"rounded-2xl bg-black p-3 shadow-lg text-white dark:bg-white dark:text-black",children:(0,e.jsx)("img",{src:"/logo.webp",alt:"Logo",className:"size-16 rounded-2xl border-2 border-zinc-100 shadow-xl dark:border-zinc-800"})})}),(0,e.jsx)("h2",{className:"mb-2 text-3xl font-extrabold tracking-tight dark:text-white",children:r==="login"?"Welcome back!":"Join Sysm today"}),(0,e.jsx)("p",{className:"font-medium text-zinc-500",children:"The decentralized social network"})]}),h&&(0,e.jsxs)("div",{className:"mb-6 flex items-center gap-3 rounded-xl border border-rose-100 bg-rose-50 p-4 text-sm text-rose-600 dark:border-rose-800 dark:bg-rose-900/20 dark:text-rose-400",children:[(0,e.jsx)(S,{size:18}),(0,e.jsx)("span",{children:h})]}),(0,e.jsxs)("form",{onSubmit:j,className:"space-y-4",children:[(0,e.jsx)(c,{label:"Email",type:"email",placeholder:"john@example.com",value:a.email,onChange:s=>i({...a,email:s.target.value}),required:!0}),r==="signup"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(c,{label:"Name",placeholder:"John Doe",value:a.name,onChange:s=>i({...a,name:s.target.value}),required:!0}),(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)(c,{label:"Username",placeholder:"johndoe",value:a.username,onChange:s=>{const m=s.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"");i({...a,username:m})},required:!0}),(0,e.jsx)("div",{className:"absolute right-3 top-[38px]",children:l.loading?(0,e.jsx)("span",{className:"animate-pulse text-zinc-400 font-bold",children:"..."}):l.available===!0?(0,e.jsx)(_,{size:18,className:"text-emerald-500"}):l.available===!1?(0,e.jsx)(N,{size:18,className:"text-rose-500"}):null})]})]}),(0,e.jsx)(c,{label:"Password",type:"password",placeholder:"••••••••",value:a.password,onChange:s=>i({...a,password:s.target.value}),required:!0}),(0,e.jsx)(C,{type:"submit",className:"mt-6 w-full justify-center py-3 text-lg",loading:v,disabled:r==="signup"&&(l.available===!1||a.username.length<5),children:r==="login"?"Log in":"Sign up"})]}),(0,e.jsxs)("div",{className:"mt-8 text-center text-sm",children:[(0,e.jsx)("span",{className:"text-zinc-500",children:r==="login"?"Don't have an account?":"Already have an account?"}),(0,e.jsx)("button",{onClick:d,className:"ml-1 font-bold hover:underline dark:text-white",children:r==="login"?"Sign up":"Log in"})]})]})},F=q;export{F as t};
