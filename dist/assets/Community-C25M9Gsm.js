import{n as ue}from"./rolldown-runtime-2JzG8er9.js";import{E as ve,f as ge,l as ze}from"./framework-BpvJHMsq.js";import"./database-Bte7TL-V.js";import{Gt as Q,Nt as Ne,Sn as ke,Tt as ye,ft as xe,jt as _e}from"./ui-libs-ydju28Yg.js";import{D as we,H as fe,n as Ce,t as Me}from"./index-B0P19RxL.js";import{r as Se,t as ce}from"./SEOHead-C-zRWQJc.js";import"./linkify-CvGdyZEF.js";import{c as Pe}from"./hooks-DfWcb2bF.js";var $e=ze(),he=ue(ve(),1),t=ue(ge(),1),Ee=be=>{const e=(0,$e.c)(107),{onPostInCommunity:V}=be,[W,de]=he.useState(!1),[X,me]=he.useState(!1),{community:s,loading:pe,isMember:a,userRole:je,isJoining:n,communityPosts:U,loadingPosts:Y,isFetchingMorePosts:q,hasMorePosts:Z,handleJoinToggle:ee,loadCommunityPosts:te,currentUser:se,addToast:ie,navigate:l}=Pe(),I=je==="admin",le=a&&(!s.isPrivate||I);if(pe){let i;return e[0]===Symbol.for("react.memo_cache_sentinel")?(i=(0,t.jsxs)("div",{className:"flex items-center justify-center min-h-screen",children:[(0,t.jsx)(ce,{title:"Loading Community..."}),(0,t.jsx)(Q,{size:40,className:"animate-spin text-violet-500"})]}),e[0]=i):i=e[0],i}if(!s){let i;e[1]===Symbol.for("react.memo_cache_sentinel")?(i=(0,t.jsx)(ce,{title:"Community Not Found"}),e[1]=i):i=e[1];const L=`The community @${s?.handle||"unknown"} could not be found.`;let K;return e[2]!==L?(K=(0,t.jsxs)("div",{className:"bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-[600px] flex items-center justify-center",children:[i,(0,t.jsx)(we,{title:"Community doesn't exist",message:L,icon:xe})]}),e[2]=L,e[3]=K):K=e[3],K}const ae=`c/${s.handle} (${s.name})`,ne=s.description||`Join the ${s.name} community on Sysm.`;let r;e[4]!==s.avatar||e[5]!==ae||e[6]!==ne?(r=(0,t.jsx)(ce,{title:ae,description:ne,image:s.avatar}),e[4]=s.avatar,e[5]=ae,e[6]=ne,e[7]=r):r=e[7];let o;e[8]!==l?(o=()=>l(-1),e[8]=l,e[9]=o):o=e[9];let A;e[10]===Symbol.for("react.memo_cache_sentinel")?(A=(0,t.jsx)(ke,{size:22}),e[10]=A):A=e[10];let c;e[11]!==o?(c=(0,t.jsx)("button",{onClick:o,className:"p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:A}),e[11]=o,e[12]=c):c=e[12];let d;e[13]!==s.name?(d=(0,t.jsx)("h5",{className:"text-lg font-bold dark:text-white leading-none",children:s.name}),e[13]=s.name,e[14]=d):d=e[14];let m;e[15]!==s.membersCount?(m=(0,t.jsxs)("span",{className:"text-xs text-zinc-500 mt-0.5",children:[s.membersCount," Members"]}),e[15]=s.membersCount,e[16]=m):m=e[16];let x;e[17]!==d||e[18]!==m?(x=(0,t.jsxs)("div",{className:"flex flex-col",children:[d,m]}),e[17]=d,e[18]=m,e[19]=x):x=e[19];let f;e[20]!==c||e[21]!==x?(f=(0,t.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-x-4",children:[c,x]})}),e[20]=c,e[21]=x,e[22]=f):f=e[22];let h;e[23]!==s.cover?(h=(0,t.jsx)("div",{className:"h-32 sm:h-52 bg-zinc-100 dark:bg-zinc-900 overflow-hidden relative",children:s.cover?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("img",{src:s.cover,className:"w-full h-full object-cover",alt:""}),(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 to-transparent"})]}):(0,t.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-violet-500/20 to-fuchsia-500/20"})}),e[23]=s.cover,e[24]=h):h=e[24];let u;e[25]!==s.avatar?(u=(0,t.jsx)("div",{className:"size-24 sm:size-32 rounded-3xl border-4 border-white dark:border-black bg-zinc-100 dark:bg-zinc-800 overflow-hidden shadow-xl",children:(0,t.jsx)("img",{src:s.avatar,className:"size-full object-cover",alt:""})}),e[25]=s.avatar,e[26]=u):u=e[26];let b;e[27]!==I?(b=I&&(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>de(!0),className:"p-2 rounded-full border border-zinc-200 dark:border-zinc-800 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 transition-all active:scale-95 flex items-center justify-center size-10",title:"Edit Community",children:(0,t.jsx)(Ne,{size:20})}),(0,t.jsx)("button",{onClick:()=>me(!0),className:"p-2 rounded-full border border-zinc-200 dark:border-zinc-800 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 transition-all active:scale-95 flex items-center justify-center size-10",title:"Manage Members",children:(0,t.jsx)(ye,{size:20})})]}),e[27]=I,e[28]=b):b=e[28];const re=a?"outline":"default",oe=`rounded-full font-bold px-8 h-10 transition-all ${a?"border-zinc-200 dark:border-zinc-800 hover:bg-rose-50 hover:text-rose-500 hover:border-rose-100 dark:hover:bg-rose-900/20":"bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 hover:scale-105"}`;let p;e[29]!==n||e[30]!==a?(p=n?(0,t.jsx)(Q,{size:18,className:"animate-spin"}):a?"Joined":"Join",e[29]=n,e[30]=a,e[31]=p):p=e[31];let j;e[32]!==ee||e[33]!==n||e[34]!==re||e[35]!==oe||e[36]!==p?(j=(0,t.jsx)(fe,{variant:re,onClick:ee,disabled:n,className:oe,children:p}),e[32]=ee,e[33]=n,e[34]=re,e[35]=oe,e[36]=p,e[37]=j):j=e[37];let v;e[38]!==b||e[39]!==j?(v=(0,t.jsxs)("div",{className:"pb-1 flex gap-2",children:[b,j]}),e[38]=b,e[39]=j,e[40]=v):v=e[40];let g;e[41]!==u||e[42]!==v?(g=(0,t.jsxs)("div",{className:"flex justify-between items-end -mt-12 sm:-mt-16 mb-4 relative z-10",children:[u,v]}),e[41]=u,e[42]=v,e[43]=g):g=e[43];let z;e[44]!==s.name?(z=(0,t.jsx)("h1",{className:"text-2xl sm:text-3xl font-black dark:text-white tracking-tight leading-tight",children:s.name}),e[44]=s.name,e[45]=z):z=e[45];let N;e[46]!==s.handle?(N=(0,t.jsxs)("p",{className:"text-zinc-500 font-bold text-sm sm:text-base",children:["c/",s.handle]}),e[46]=s.handle,e[47]=N):N=e[47];let k;e[48]!==s.description?(k=s.description&&(0,t.jsx)("p",{className:"mt-4 text-[15px] sm:text-base dark:text-zinc-300 leading-relaxed max-w-2xl",children:s.description}),e[48]=s.description,e[49]=k):k=e[49];let y;e[50]!==s.membersCount?(y=(0,t.jsx)("span",{className:"text-base font-extrabold text-zinc-900 dark:text-white transition-colors",children:s.membersCount}),e[50]=s.membersCount,e[51]=y):y=e[51];let B;e[52]===Symbol.for("react.memo_cache_sentinel")?(B=(0,t.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400 font-medium",children:"Members"}),e[52]=B):B=e[52];let _;e[53]!==y?(_=(0,t.jsxs)("button",{className:"flex gap-x-1.5 group cursor-pointer items-baseline",children:[y,B]}),e[53]=y,e[54]=_):_=e[54];let w;e[55]!==s.postsCount?(w=(0,t.jsx)("span",{className:"text-base font-extrabold text-zinc-900 dark:text-white transition-colors",children:s.postsCount}),e[55]=s.postsCount,e[56]=w):w=e[56];let H;e[57]===Symbol.for("react.memo_cache_sentinel")?(H=(0,t.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400 font-medium",children:"Posts"}),e[57]=H):H=e[57];let C;e[58]!==w?(C=(0,t.jsxs)("button",{className:"flex gap-x-1.5 group cursor-pointer items-baseline",children:[w,H]}),e[58]=w,e[59]=C):C=e[59];let M;e[60]!==_||e[61]!==C?(M=(0,t.jsxs)("div",{className:"flex gap-4 sm:gap-6 text-sm pt-2 relative z-10",children:[_,C]}),e[60]=_,e[61]=C,e[62]=M):M=e[62];let S;e[63]!==z||e[64]!==N||e[65]!==k||e[66]!==M?(S=(0,t.jsxs)("div",{className:"space-y-1",children:[z,N,k,M]}),e[63]=z,e[64]=N,e[65]=k,e[66]=M,e[67]=S):S=e[67];let P;e[68]!==g||e[69]!==S?(P=(0,t.jsxs)("div",{className:"px-4 pb-6",children:[g,S]}),e[68]=g,e[69]=S,e[70]=P):P=e[70];let $;e[71]!==h||e[72]!==P?($=(0,t.jsxs)("div",{className:"relative",children:[h,P]}),e[71]=h,e[72]=P,e[73]=$):$=e[73];let E;e[74]!==ie||e[75]!==s.id||e[76]!==s.name||e[77]!==U||e[78]!==se||e[79]!==Z||e[80]!==q||e[81]!==te||e[82]!==Y||e[83]!==l?(E=(0,t.jsx)("div",{className:"border-t border-zinc-100 dark:border-zinc-800",children:Y?(0,t.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,t.jsx)(Q,{className:"animate-spin text-violet-500",size:32})}):U.length>0?(0,t.jsxs)(t.Fragment,{children:[U.map(i=>(0,t.jsx)(Se,{currentUser:se,showToast:ie,...i,onClick:()=>l(`/post/${i.id}`),onUserClick:L=>l(`/u/${L}`)},i.feed_id||i.id)),Z&&(0,t.jsx)("div",{className:"p-6 flex justify-center",children:(0,t.jsxs)(fe,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>te(s.id,!0),disabled:q,children:[q&&(0,t.jsx)(Q,{size:18,className:"animate-spin mr-2"}),"Load more"]})})]}):(0,t.jsxs)("div",{className:"p-20 text-center text-zinc-500 flex flex-col items-center gap-4",children:[(0,t.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full mb-2",children:(0,t.jsx)(xe,{size:40,className:"text-zinc-300"})}),(0,t.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"No posts here yet"}),(0,t.jsxs)("p",{className:"text-sm max-w-[250px]",children:["Be the first to share something in ",s.name,"!"]})]})}),e[74]=ie,e[75]=s.id,e[76]=s.name,e[77]=U,e[78]=se,e[79]=Z,e[80]=q,e[81]=te,e[82]=Y,e[83]=l,e[84]=E):E=e[84];let O;e[85]!==f||e[86]!==$||e[87]!==E?(O=(0,t.jsxs)("div",{className:"relative",children:[f,$,E]}),e[85]=f,e[86]=$,e[87]=E,e[88]=O):O=e[88];let F;e[89]!==le||e[90]!==s||e[91]!==V?(F=le&&(0,t.jsx)("button",{onClick:()=>V(s),className:"fixed bottom-20 right-5 md:hidden z-50 bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 size-12 rounded-full flex items-center justify-center shadow-2xl hover:scale-110 active:scale-90 transition-all cursor-pointer group",title:`Post to ${s.name}`,children:(0,t.jsx)(_e,{size:28,className:"group-hover:rotate-90 transition-transform duration-300"})}),e[89]=le,e[90]=s,e[91]=V,e[92]=F):F=e[92];let D;e[93]===Symbol.for("react.memo_cache_sentinel")?(D=()=>de(!1),e[93]=D):D=e[93];let J;e[94]!==s||e[95]!==W?(J=(0,t.jsx)(Ce,{isOpen:W,onClose:D,community:s,onUpdate:Oe}),e[94]=s,e[95]=W,e[96]=J):J=e[96];let G;e[97]===Symbol.for("react.memo_cache_sentinel")?(G=()=>me(!1),e[97]=G):G=e[97];let T;e[98]!==s||e[99]!==X?(T=(0,t.jsx)(Me,{isOpen:X,onClose:G,community:s}),e[98]=s,e[99]=X,e[100]=T):T=e[100];let R;return e[101]!==r||e[102]!==O||e[103]!==F||e[104]!==J||e[105]!==T?(R=(0,t.jsxs)("div",{className:"border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen pb-20",children:[r,O,F,J,T]}),e[101]=r,e[102]=O,e[103]=F,e[104]=J,e[105]=T,e[106]=R):R=e[106],R},Be=Ee;function Oe(){window.location.reload()}export{Be as default};
