import{n as U}from"./rolldown-runtime-2JzG8er9.js";import{E as F,f as L,l as q}from"./framework-BpvJHMsq.js";import"./database-Bte7TL-V.js";import{Gt as B,jt as I}from"./ui-libs-ydju28Yg.js";import{$ as M,Q as O,Z as T,b as A,d as G,f as J,y as $}from"./index-B0P19RxL.js";import{r as Q,t as P}from"./SEOHead-C-zRWQJc.js";import"./linkify-CvGdyZEF.js";import{o as W}from"./hooks-DfWcb2bF.js";var Y=q(),ae=U(F(),1),s=U(L(),1),Z=S=>{const e=(0,Y.c)(24),{user:t,onClick:g,isAddStory:i,isSeen:d}=S,x=i===void 0?!1:i,w=`relative p-0.5 rounded-full ${x?"bg-transparent":d!==void 0&&d?"bg-zinc-200 dark:bg-zinc-800":"bg-gradient-to-tr from-yellow-400 via-pink-500 to-violet-600"}`;let b;e[0]!==t.avatar||e[1]!==t.handle?(b=(0,s.jsx)(M,{src:t.avatar,alt:t.handle,className:"object-cover"}),e[0]=t.avatar,e[1]=t.handle,e[2]=b):b=e[2];let n;e[3]!==t.handle?.[0]?(n=t.handle?.[0]?.toUpperCase(),e[3]=t.handle?.[0],e[4]=n):n=e[4];let o;e[5]!==n?(o=(0,s.jsx)(O,{children:n}),e[5]=n,e[6]=o):o=e[6];let c;e[7]!==b||e[8]!==o?(c=(0,s.jsxs)(T,{className:"size-14 sm:size-16 border border-zinc-100 dark:border-zinc-800",children:[b,o]}),e[7]=b,e[8]=o,e[9]=c):c=e[9];let m;e[10]!==x?(m=x&&(0,s.jsx)("div",{className:"absolute bottom-0 right-0 bg-violet-600 border-2 border-white dark:border-black rounded-full p-1 text-white shadow-lg",children:(0,s.jsx)(I,{size:14,strokeWidth:3})}),e[10]=x,e[11]=m):m=e[11];let h;e[12]!==c||e[13]!==m?(h=(0,s.jsx)("div",{className:"bg-white dark:bg-black rounded-full p-0.5",children:(0,s.jsxs)("div",{className:"relative",children:[c,m]})}),e[12]=c,e[13]=m,e[14]=h):h=e[14];let f;e[15]!==w||e[16]!==h?(f=(0,s.jsx)("div",{className:w,children:h}),e[15]=w,e[16]=h,e[17]=f):f=e[17];const p=x?"Add Story":t.handle;let l;e[18]!==p?(l=(0,s.jsx)("span",{className:"text-[11px] font-semibold text-zinc-600 dark:text-zinc-400 truncate w-16 text-center leading-tight",children:p}),e[18]=p,e[19]=l):l=e[19];let a;return e[20]!==g||e[21]!==f||e[22]!==l?(a=(0,s.jsxs)("button",{onClick:g,className:"flex flex-col items-center gap-2 group shrink-0",children:[f,l]}),e[20]=g,e[21]=f,e[22]=l,e[23]=a):a=e[23],a},H=Z,D=q(),K=S=>{const e=(0,D.c)(37),{onStoryClick:t,onAddStory:g}=S,{currentUser:i,homePosts:d,groupedStories:x,isPostsLoading:w,isStoriesLoading:b,hasMore:n,isFetchingNextPage:o,addToast:c,ref:m,handlePostClick:h,handleUserClick:f}=W();if(w||b){let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsx)(P,{title:"Home"}),e[0]=r):r=e[0];let u;return e[1]===Symbol.for("react.memo_cache_sentinel")?(u=(0,s.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:[r,(0,s.jsxs)($,{className:"w-full whitespace-nowrap border-b border-zinc-100 dark:border-zinc-800",children:[(0,s.jsxs)("div",{className:"flex w-max gap-3 py-4 px-4",children:[(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"}),(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"}),(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"})]}),(0,s.jsx)(A,{orientation:"horizontal",className:"hidden"})]}),[1,2,3].map(R)]}),e[1]=u):u=e[1],u}let p;e[2]===Symbol.for("react.memo_cache_sentinel")?(p=(0,s.jsx)(P,{title:"Home Feed",description:"See what's happening in your world right now."}),e[2]=p):p=e[2];let l;e[3]!==i||e[4]!==g?(l=i&&(0,s.jsx)(H,{user:i,isAddStory:!0,onClick:g}),e[3]=i,e[4]=g,e[5]=l):l=e[5];let a;if(e[6]!==x||e[7]!==t){let r;e[9]!==t?(r=u=>{const E=JSON.parse(localStorage.getItem("seenStories")||"[]").includes(u.user.id);return(0,s.jsx)(H,{user:u.user,isSeen:E,onClick:()=>t(u)},u.user.id)},e[9]=t,e[10]=r):r=e[10],a=x.map(r),e[6]=x,e[7]=t,e[8]=a}else a=e[8];let v;e[11]!==l||e[12]!==a?(v=(0,s.jsxs)("div",{className:"flex w-max gap-4 py-4 px-4",children:[l,a]}),e[11]=l,e[12]=a,e[13]=v):v=e[13];let y;e[14]===Symbol.for("react.memo_cache_sentinel")?(y=(0,s.jsx)(A,{orientation:"horizontal",className:"hidden"}),e[14]=y):y=e[14];let j;e[15]!==v?(j=(0,s.jsxs)($,{className:"w-full border-b border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black",children:[v,y]}),e[15]=v,e[16]=j):j=e[16];let k;e[17]!==i?(k=!i&&(0,s.jsx)("div",{className:"px-4 py-2 md:hidden",children:(0,s.jsx)(J,{className:"p-6"})}),e[17]=i,e[18]=k):k=e[18];let z;e[19]!==c||e[20]!==i||e[21]!==h||e[22]!==f||e[23]!==d?(z=d.length>0?d.map(r=>(0,s.jsx)(Q,{...r,currentUser:i,showToast:c,onClick:()=>h(r.id),onUserClick:f},r.feed_id||r.id)):(0,s.jsxs)("div",{className:"p-20 text-center text-zinc-500",children:[(0,s.jsx)("p",{className:"text-lg font-medium",children:"No posts yet."}),(0,s.jsx)("p",{className:"text-sm",children:"Be the first to share something amazing!"})]}),e[19]=c,e[20]=i,e[21]=h,e[22]=f,e[23]=d,e[24]=z):z=e[24];let N;e[25]!==n||e[26]!==d.length||e[27]!==o||e[28]!==m?(N=d.length>0&&(0,s.jsx)("div",{ref:m,className:"py-8 flex justify-center",children:o?(0,s.jsx)(B,{className:"animate-spin text-violet-500",size:24}):n?(0,s.jsx)("div",{className:"h-4"}):(0,s.jsx)("p",{className:"text-sm text-zinc-500 font-medium",children:"You've reached the end of the feed."})}),e[25]=n,e[26]=d.length,e[27]=o,e[28]=m,e[29]=N):N=e[29];let _;e[30]!==z||e[31]!==N?(_=(0,s.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen pb-20 shadow-sm",children:[z,N]}),e[30]=z,e[31]=N,e[32]=_):_=e[32];let C;return e[33]!==_||e[34]!==j||e[35]!==k?(C=(0,s.jsxs)("div",{className:"w-full max-w-full overflow-hidden",children:[p,j,k,_]}),e[33]=_,e[34]=j,e[35]=k,e[36]=C):C=e[36],C},de=K;function R(S){return(0,s.jsx)(G,{},S)}export{de as default};
