import{n as p}from"./rolldown-runtime-2JzG8er9.js";import{b as k,u as w,w as y,y as _}from"./framework-pMVb9Z5_.js";import"./database-ApDMvJcm.js";import{Gt as u,Qt as b,Sn as P}from"./ui-libs-Dldhg1Ot.js";import{H as F,Ot as g,it as H,st as M}from"./index-DSsZQQp_.js";import{n as S}from"./post-DfzmbMRZ.js";import"./linkify-BesW0poa.js";import"./hooks-rNBoARhk.js";var r=p(y(),1),e=p(w(),1),C=()=>{const{tag:t}=k(),l=_(),{currentUser:j}=M(),{addToast:o}=H(),[i,c]=(0,r.useState)([]),[v,d]=(0,r.useState)(!0),[n,m]=(0,r.useState)(!1),[x,h]=(0,r.useState)(!0);(0,r.useEffect)(()=>{t&&(async()=>{d(!0);try{const a=await g(`#${t}`,null,10);c(a),h(a.length>=10)}catch(a){console.error("Failed to load hashtag posts:",a),o("Failed to load posts","error")}finally{d(!1)}})()},[t,o]);const N=async()=>{if(!(n||!x)){m(!0);try{const s=i[i.length-1],a=s?s.sortTimestamp:null,f=await g(`#${t}`,a,10);f.length<10&&h(!1),c(z=>[...z,...f])}catch(s){console.error("Failed to load more posts:",s)}finally{m(!1)}}};return(0,e.jsx)("div",{className:"border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen pb-20",children:(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3",children:(0,e.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,e.jsx)("button",{onClick:()=>l(-1),className:"p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:(0,e.jsx)(P,{size:22})}),(0,e.jsxs)("div",{className:"flex flex-col",children:[(0,e.jsxs)("h5",{className:"text-lg font-bold dark:text-white leading-none",children:["#",t]}),(0,e.jsx)("span",{className:"text-xs text-zinc-500 mt-0.5",children:"Hashtag"})]})]})}),(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("div",{className:"h-32 sm:h-40 bg-gradient-to-r from-violet-500/10 to-fuchsia-500/10 overflow-hidden relative",children:(0,e.jsx)("div",{className:"absolute inset-0 bg-grid-white/[0.02] bg-[size:20px_20px]"})}),(0,e.jsxs)("div",{className:"px-4 pb-6",children:[(0,e.jsx)("div",{className:"flex justify-between items-end -mt-10 mb-4 relative z-10",children:(0,e.jsx)("div",{className:"size-20 sm:size-24 rounded-2xl border-4 border-white dark:border-black bg-zinc-100 dark:bg-zinc-800 flex items-center justify-center shadow-xl",children:(0,e.jsx)(b,{size:40,className:"text-zinc-400"})})}),(0,e.jsxs)("div",{className:"space-y-1",children:[(0,e.jsxs)("h1",{className:"text-2xl sm:text-3xl font-black dark:text-white tracking-tight leading-tight",children:["#",t]}),(0,e.jsxs)("p",{className:"text-zinc-500 text-sm sm:text-base",children:["Posts tagged with #",t]})]})]})]}),(0,e.jsx)("div",{className:"border-t border-zinc-100 dark:border-zinc-800",children:v?(0,e.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,e.jsx)(u,{className:"animate-spin text-violet-500",size:32})}):i.length>0?(0,e.jsxs)(e.Fragment,{children:[i.map(s=>(0,e.jsx)(S,{currentUser:j,showToast:o,...s,onClick:()=>l(`/post/${s.id}`),onUserClick:a=>l(`/u/${a}`)},s.feed_id||s.id)),x&&(0,e.jsx)("div",{className:"p-6 flex justify-center",children:(0,e.jsxs)(F,{variant:"secondary",className:"w-full max-w-xs",onClick:N,disabled:n,children:[n&&(0,e.jsx)(u,{size:18,className:"animate-spin mr-2"}),"Load more"]})})]}):(0,e.jsxs)("div",{className:"p-20 text-center text-zinc-500 flex flex-col items-center gap-4",children:[(0,e.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full mb-2",children:(0,e.jsx)(b,{size:40,className:"text-zinc-300"})}),(0,e.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"No posts found"}),(0,e.jsxs)("p",{className:"text-sm max-w-[250px]",children:["Be the first to post with #",t,"!"]})]})})]})})},G=C;export{G as default};
