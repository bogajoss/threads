import{a as P}from"./rolldown-runtime-BaZ8gS7u.js";import{c as A,s as L}from"./animations-DZuN0xpW.js";import{_ as S}from"./framework-YRQI4BOE.js";import"./database-Bh-Nv8Zy.js";import{Ft as I,In as T,Vn as E,ar as B,lr as k,tn as D,xn as M}from"./ui-libs-dHBs5Tk6.js";import"./media-libs-CqtNZWFg.js";import{$t as O,An as y,Qt as q,Zt as G,a as $,an as Q,sn as V,tn as C,vt as f}from"./index-CELpo5IH.js";import{t as Y}from"./useAutoResizeTextArea-n5XCjvX4.js";import{t as Z}from"./CircularProgress-D3aWv6b6.js";var r=P(A(),1),e=P(L(),1),H=()=>{const d=S(),{currentUser:l,updateProfile:_}=V(),{addToast:p}=Q(),[R,v]=(0,r.useState)(!1),[s,n]=(0,r.useState)(l||{}),[x,g]=(0,r.useState)(null),[o,b]=(0,r.useState)(null),j=(0,r.useRef)(null),N=(0,r.useRef)(null),F=Y(s?.bio||"",80,300);(0,r.useEffect)(()=>{l&&n(l)},[l]);const z=(a,i)=>{const t=a.target.files?.[0];if(t){if(t.type==="image/gif"&&!l?.isPro){p("GIF profile pictures are only available for PRO users!","error");return}i==="avatar"?g(t):b(t)}},U=async()=>{v(!0);try{let a=s.avatar,i=s.cover;x&&(a=(await y(x)).url),o&&(i=(await y(o)).url);const m=(u=>{if(!u)return u;const c=u.trim();if(!c)return c;try{const h=new URL(/^https?:\/\//i.test(c)?c:`https://${c}`);return h.hostname.replace(/^www\./i,"")+(h.pathname==="/"?"":h.pathname)}catch{return c.replace(/^https?:\/\//i,"").replace(/^www\./i,"")}})(s?.website);await _({...s,avatar:a,cover:i,website:m}),g(null),b(null),p("Profile updated!"),d(-1)}catch(a){console.error("Failed to update profile:",a),p("Failed to update profile.","error")}finally{v(!1)}},w=(a=>(a||"").trim().split(/\s+/).filter(Boolean).length)(s?.bio),W=w>=50;return l?(0,e.jsx)($,{children:(0,e.jsxs)("div",{className:"flex min-h-screen flex-col border-zinc-100 bg-white dark:border-zinc-800 dark:bg-black md:rounded-xl md:border",children:[(0,e.jsx)("div",{className:"sticky top-0 z-10 border-b border-zinc-100 bg-white/80 p-4 backdrop-blur-md dark:border-zinc-800 dark:bg-black/80",children:(0,e.jsxs)("div",{className:"flex items-center gap-4",children:[(0,e.jsx)("button",{onClick:()=>d(-1),className:"rounded-full p-2 transition-colors hover:bg-zinc-100 dark:hover:bg-zinc-800",children:(0,e.jsx)(B,{size:24})}),(0,e.jsx)("h2",{className:"text-xl font-bold dark:text-white",children:"Edit Profile"})]})}),(0,e.jsxs)("div",{className:"mx-auto mt-4 w-full max-w-2xl space-y-8 p-4 pb-24",children:[(0,e.jsx)("input",{type:"file",ref:N,className:"hidden",accept:"image/*",onChange:a=>z(a,"cover")}),(0,e.jsx)("input",{type:"file",ref:j,className:"hidden",accept:"image/*",onChange:a=>z(a,"avatar")}),(0,e.jsxs)("section",{className:"space-y-4",children:[(0,e.jsx)("h3",{className:"px-2 text-sm font-bold uppercase tracking-wider text-zinc-500",children:"Media"}),(0,e.jsxs)("div",{className:"overflow-hidden rounded-2xl bg-zinc-50 dark:bg-zinc-900",children:[(0,e.jsxs)("div",{className:"group relative h-40 cursor-pointer overflow-hidden bg-zinc-100 dark:bg-zinc-800",onClick:()=>N.current?.click(),children:[(o||s?.cover)&&(0,e.jsx)("img",{src:o?URL.createObjectURL(o):s.cover,className:"h-full w-full object-cover opacity-80 transition-opacity group-hover:opacity-60",alt:""}),(0,e.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/20 opacity-0 transition-opacity group-hover:opacity-100",children:(0,e.jsxs)("div",{className:"flex flex-col items-center gap-1 text-white",children:[(0,e.jsx)(k,{size:24}),(0,e.jsx)("span",{className:"text-xs font-bold uppercase",children:"Change Cover"})]})})]}),(0,e.jsxs)("div",{className:"flex items-center gap-6 p-4",children:[(0,e.jsxs)("div",{className:"group relative size-24 cursor-pointer overflow-hidden rounded-full ring-4 ring-white shadow-lg dark:ring-zinc-800",onClick:()=>j.current?.click(),children:[(0,e.jsxs)(G,{className:"size-full rounded-none",children:[(0,e.jsx)(O,{src:x?URL.createObjectURL(x):s.avatar,className:"object-cover transition-opacity group-hover:opacity-60"}),(0,e.jsx)(q,{children:s?.handle?.[0]?.toUpperCase()})]}),(0,e.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/20 opacity-0 transition-opacity group-hover:opacity-100",children:(0,e.jsx)(k,{size:20,className:"text-white"})})]}),(0,e.jsxs)("div",{className:"flex-1",children:[(0,e.jsx)("p",{className:"text-sm font-bold dark:text-zinc-200",children:"Profile Picture"}),(0,e.jsx)("p",{className:"text-xs text-zinc-500",children:"Recommended size: 400x400px"})]})]})]})]}),(0,e.jsxs)("section",{className:"space-y-4",children:[(0,e.jsx)("h3",{className:"px-2 text-sm font-bold uppercase tracking-wider text-zinc-500",children:"Basic Info"}),(0,e.jsxs)("div",{className:"divide-y divide-zinc-200 overflow-hidden rounded-2xl bg-zinc-50 dark:divide-zinc-800 dark:bg-zinc-900",children:[(0,e.jsxs)("div",{className:"flex flex-col gap-2 p-4",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2 text-zinc-500",children:[(0,e.jsx)(I,{size:16}),(0,e.jsx)("label",{className:"text-xs font-bold uppercase tracking-tight",children:"Display Name"})]}),(0,e.jsx)(f,{value:s?.name||"",className:"h-auto bg-transparent p-0 text-base font-medium placeholder:text-zinc-400 focus-visible:ring-0 dark:text-zinc-100 shadow-none",onChange:a=>n({...s,name:a.target.value})})]}),(0,e.jsxs)("div",{className:"flex flex-col gap-2 p-4",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2 text-zinc-500",children:[(0,e.jsx)(E,{size:16}),(0,e.jsx)("label",{className:"text-xs font-bold uppercase tracking-tight",children:"Bio"})]}),(0,e.jsx)(Z,{current:w,max:60,size:20,strokeWidth:3,isWarning:W})]}),(0,e.jsx)("textarea",{ref:F,value:s?.bio||"",className:"min-h-[80px] max-h-[400px] w-full bg-transparent p-0 text-base font-medium resize-none placeholder:text-zinc-400 focus-visible:ring-0 dark:text-zinc-100 shadow-none outline-none",placeholder:"Tell others about yourself...",onChange:a=>{const i=a.target.value,t=i.trim().split(/\s+/).filter(Boolean);if(t.length>60){const m=t.slice(0,60).join(" ");n({...s,bio:m})}else n({...s,bio:i})}})]})]})]}),(0,e.jsxs)("section",{className:"space-y-4",children:[(0,e.jsx)("h3",{className:"px-2 text-sm font-bold uppercase tracking-wider text-zinc-500",children:"Public Details"}),(0,e.jsxs)("div",{className:"divide-y divide-zinc-200 overflow-hidden rounded-2xl bg-zinc-50 dark:divide-zinc-800 dark:bg-zinc-900",children:[(0,e.jsxs)("div",{className:"flex flex-col gap-2 p-4",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2 text-zinc-500",children:[(0,e.jsx)(M,{size:16}),(0,e.jsx)("label",{className:"text-xs font-bold uppercase tracking-tight",children:"Location"})]}),(0,e.jsx)(f,{placeholder:"Where are you based?",value:s?.location||"",className:"h-auto bg-transparent p-0 text-base font-medium placeholder:text-zinc-400 focus-visible:ring-0 dark:text-zinc-100 shadow-none",onChange:a=>n({...s,location:a.target.value})})]}),(0,e.jsxs)("div",{className:"flex flex-col gap-2 p-4",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2 text-zinc-500",children:[(0,e.jsx)(T,{size:16}),(0,e.jsx)("label",{className:"text-xs font-bold uppercase tracking-tight",children:"Website"})]}),(0,e.jsx)(f,{placeholder:"yoursite.com",value:s?.website||"",className:"h-auto bg-transparent p-0 text-base font-medium placeholder:text-zinc-400 focus-visible:ring-0 dark:text-zinc-100 shadow-none",onChange:a=>n({...s,website:a.target.value})})]})]})]}),(0,e.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,e.jsx)(C,{variant:"secondary",className:"flex-1 rounded-2xl p-4 font-bold",onClick:()=>d(-1),children:"Cancel"}),(0,e.jsxs)(C,{className:"flex-1 rounded-2xl p-4 font-bold bg-violet-600 hover:bg-violet-700 text-white",onClick:U,loading:R,children:[(0,e.jsx)(D,{size:18,className:"mr-2"}),"Save Changes"]})]}),(0,e.jsx)("div",{className:"py-10 text-center text-xs text-zinc-400",children:"Your profile changes will be visible to everyone on MySys."})]})]})}):(d("/login"),null)},ne=H;export{ne as default};
