const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/VideoPlayer-Lq0yvnfv.js","assets/framework-CsA6nn9m.js","assets/rolldown-runtime-BaZ8gS7u.js","assets/framework-sg0yWRLc.css","assets/media-libs-Btb8RX-I.js","assets/media-libs-CqCaMccn.css","assets/VideoPlayer-DTJWeURB.js","assets/index-DLHi3adu.js","assets/ui-libs-ChWz9FXZ.js","assets/database-BiY55TQY.js","assets/query-QyXblnmD.js","assets/animations-T0TOZv2c.js","assets/index-gH1AfVaq.css","assets/dist-CYPYLHr8.js"])))=>i.map(i=>d[i]);
import{a as dt}from"./rolldown-runtime-BaZ8gS7u.js";import{C as mt,E as _t,b as ne,c as W,d as St,n as Ft,p as Pt}from"./framework-CsA6nn9m.js";import{r as Tt}from"./query-QyXblnmD.js";import{Dn as fe,In as Mt,It,Jn as Rt,Ln as Et,Lt as Dt,Nn as At,Pn as Ue,Rn as Lt,Vn as Ut,Wn as Wt,Xt as Ot,Zt as Bt,_n as Vt,an as qt,bn as X,en as ze,er as Ht,hn as xt,kn as We,kt as ae,ln as Gt,nn as Qt,pn as Jt,rn as Xt,sn as Kt,tn as Zt,xn as Yt,zn as ke,zt as es}from"./ui-libs-ChWz9FXZ.js";import{Ct as ts,It as Oe,J as ss,Kt as is,Q as ls,Qt as as,S as ns,St as ht,U as ft,Ut as rs,Vt as os,Wt as cs,X as le,Y as Be,Z as ds,_t as ms,at as Y,ct as Ve,dn as Ne,dt as qe,en as He,f as xs,fn as q,ft as Ge,g as hs,gt as fs,hn as Qe,in as us,it as ee,l as ut,lt as Je,mt as Xe,nn as ps,ot as te,p as gs,pn as he,pt as Ke,q as vs,qt as bs,rn as js,st as Ze,u as zs,un as ks,ut as Ye,v as ue,vt as Ns,y as ws,yt as ye,zt as ys}from"./index-DLHi3adu.js";import{t as Ce}from"./text-processing-DFvQvkgt.js";import{t as $e}from"./linkify-BIniK2-v.js";import{p as Cs,u as et}from"./hooks-DH62Qw3n.js";var $s=W(),N=dt(_t(),1),t=dt(St(),1),_s=i=>{const e=(0,$s.c)(37),{isComment:s,liked:r,reposted:l,handleLike:a,handleRepost:n,handleCommentClick:d,handleShareClick:o,isDetail:g}=i;if(g!==void 0&&g){let j;e[0]!==a||e[1]!==r?(j=(0,t.jsx)(H,{icon:fe,label:"Like",type:"like",onClick:a,active:r}),e[0]=a,e[1]=r,e[2]=j):j=e[2];let z;e[3]!==n||e[4]!==s||e[5]!==l?(z=!s&&(0,t.jsx)(H,{icon:ze,label:"Repost",type:"repost",onClick:n,active:l}),e[3]=n,e[4]=s,e[5]=l,e[6]=z):z=e[6];let k;e[7]!==d?(k=(0,t.jsx)(H,{icon:ut,label:"Comment",type:"comment",onClick:d}),e[7]=d,e[8]=k):k=e[8];let c;e[9]!==o||e[10]!==s?(c=!s&&(0,t.jsx)(H,{icon:ue,label:"Share",type:"share",onClick:o}),e[9]=o,e[10]=s,e[11]=c):c=e[11];let C;return e[12]!==j||e[13]!==z||e[14]!==k||e[15]!==c?(C=(0,t.jsxs)("div",{className:"mt-4 flex w-full items-center justify-around py-1",children:[j,z,k,c]}),e[12]=j,e[13]=z,e[14]=k,e[15]=c,e[16]=C):C=e[16],C}const p=`flex items-center gap-x-1 ${s?"mt-1.5":"mt-3"}`,h=s?16:18;let u;e[17]!==a||e[18]!==r||e[19]!==h?(u=(0,t.jsx)(H,{icon:fe,size:h,type:"like",onClick:a,active:r}),e[17]=a,e[18]=r,e[19]=h,e[20]=u):u=e[20];const v=s?16:18;let f;e[21]!==d||e[22]!==v?(f=(0,t.jsx)(H,{icon:xt,size:v,type:"comment",onClick:d}),e[21]=d,e[22]=v,e[23]=f):f=e[23];const x=s?16:18;let b;e[24]!==n||e[25]!==l||e[26]!==x?(b=(0,t.jsx)(H,{icon:ze,size:x,type:"repost",onClick:n,active:l}),e[24]=n,e[25]=l,e[26]=x,e[27]=b):b=e[27];let m;e[28]!==o||e[29]!==s?(m=!s&&o&&(0,t.jsx)(H,{icon:ue,type:"share",onClick:o}),e[28]=o,e[29]=s,e[30]=m):m=e[30];let w;return e[31]!==p||e[32]!==u||e[33]!==f||e[34]!==b||e[35]!==m?(w=(0,t.jsxs)("div",{className:p,children:[u,f,b,m]}),e[31]=p,e[32]=u,e[33]=f,e[34]=b,e[35]=m,e[36]=w):w=e[36],w},tt=_s,Ss=W(),Fs=i=>{const e=(0,Ss.c)(38),{views:s,likes:r,comments:l,isDetail:a,isComment:n,onRepliesClick:d}=i,o=a===void 0?!1:a,g=n===void 0?!1:n;if(o){const b=s||0;let m;e[0]!==b?(m=(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:b}),e[0]=b,e[1]=m):m=e[1];let w;e[2]===Symbol.for("react.memo_cache_sentinel")?(w=(0,t.jsx)("span",{className:"opacity-70",children:"Views"}),e[2]=w):w=e[2];let j;e[3]!==m?(j=(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[m," ",w]}),e[3]=m,e[4]=j):j=e[4];const z=r||0;let k;e[5]!==z?(k=(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:z}),e[5]=z,e[6]=k):k=e[6];let c;e[7]===Symbol.for("react.memo_cache_sentinel")?(c=(0,t.jsx)("span",{className:"opacity-70",children:"Likes"}),e[7]=c):c=e[7];let C;e[8]!==k?(C=(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[k," ",c]}),e[8]=k,e[9]=C):C=e[9];const _=l||0;let I;e[10]!==_?(I=(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:_}),e[10]=_,e[11]=I):I=e[11];let P;e[12]===Symbol.for("react.memo_cache_sentinel")?(P=(0,t.jsx)("span",{className:"opacity-70",children:"Comments"}),e[12]=P):P=e[12];let y;e[13]!==I?(y=(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[I," ",P]}),e[13]=I,e[14]=y):y=e[14];let M;return e[15]!==C||e[16]!==y||e[17]!==j?(M=(0,t.jsxs)("div",{className:"mt-4 flex items-center gap-x-6 border-b border-zinc-100 pb-4 text-sm text-zinc-500 dark:border-zinc-800 dark:text-zinc-400",children:[j,C,y]}),e[15]=C,e[16]=y,e[17]=j,e[18]=M):M=e[18],M}if(l===0&&r===0&&(s===0||g))return null;const p=`mt-1 flex items-center gap-x-1.5 px-0.5 ${g?"text-[12px]":"text-[14px]"} font-medium text-zinc-500 dark:text-zinc-400`;let h;e[19]!==l||e[20]!==g||e[21]!==r||e[22]!==s?(h=s>0&&!g&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{className:"hover:underline",children:[s," ",s===1?"view":"views"]}),(l>0||r>0)&&(0,t.jsx)("span",{className:"opacity-50",children:"·"})]}),e[19]=l,e[20]=g,e[21]=r,e[22]=s,e[23]=h):h=e[23];let u;e[24]!==l||e[25]!==d?(u=l>0&&(0,t.jsxs)("button",{className:"hover:underline",onClick:b=>{b.stopPropagation(),d&&d(b)},children:[l," ",l===1?"reply":"replies"]}),e[24]=l,e[25]=d,e[26]=u):u=e[26];let v;e[27]!==l||e[28]!==r?(v=l>0&&r>0&&(0,t.jsx)("span",{className:"opacity-50",children:"·"}),e[27]=l,e[28]=r,e[29]=v):v=e[29];let f;e[30]!==r?(f=r>0&&(0,t.jsxs)("button",{className:"hover:underline",children:[r," ",r===1?"like":"likes"]}),e[30]=r,e[31]=f):f=e[31];let x;return e[32]!==p||e[33]!==h||e[34]!==u||e[35]!==v||e[36]!==f?(x=(0,t.jsxs)("div",{className:p,children:[h,u,v,f]}),e[32]=p,e[33]=h,e[34]=u,e[35]=v,e[36]=f,e[37]=x):x=e[37],x},st=Fs,Ps=W(),Ts=i=>{const e=(0,Ps.c)(43),{user:s,timeAgo:r,community:l,onUserClick:a,actionsMenu:n,isComment:d,isDetail:o,showAvatar:g}=i,p=g===void 0?!1:g,h=ne();let u;e[0]!==a||e[1]!==s.handle?(u=R=>{R.stopPropagation(),a&&a(s.handle)},e[0]=a,e[1]=s.handle,e[2]=u):u=e[2];const v=u;let f;e[3]!==l||e[4]!==h?(f=R=>{R.stopPropagation(),l&&h(`/c/${l.handle}`)},e[3]=l,e[4]=h,e[5]=f):f=e[5];const x=f,b=`flex items-center justify-between ${o?"pb-4":"min-h-[40px] mb-1"}`;let m;e[6]!==v||e[7]!==d||e[8]!==o||e[9]!==p||e[10]!==s.avatar||e[11]!==s.handle?(m=p&&(0,t.jsx)("button",{className:"shrink-0",onClick:v,children:(0,t.jsxs)(ee,{className:`${o?"size-12":d?"size-8":"size-10"} border-0 shadow-sm`,children:[(0,t.jsx)(te,{src:s.avatar,alt:s.handle,className:"object-cover"}),(0,t.jsx)(Y,{className:"text-xs",children:s.handle[0]?.toUpperCase()})]})}),e[6]=v,e[7]=d,e[8]=o,e[9]=p,e[10]=s.avatar,e[11]=s.handle,e[12]=m):m=e[12];const w=`flex shrink-0 items-center gap-1 font-bold text-zinc-900 hover:underline dark:text-white ${o?"text-base sm:text-lg":d?"text-[14px]":"text-[15px]"}`;let j;e[13]!==s.handle?(j=(0,t.jsx)("span",{className:"max-w-[150px] truncate sm:max-w-none",children:s.handle}),e[13]=s.handle,e[14]=j):j=e[14];let z;e[15]!==d||e[16]!==o||e[17]!==s.verified?(z=s.verified&&(0,t.jsx)(ws,{size:o?16:d?12:14,className:"text-blue-500"}),e[15]=d,e[16]=o,e[17]=s.verified,e[18]=z):z=e[18];let k;e[19]!==v||e[20]!==w||e[21]!==j||e[22]!==z?(k=(0,t.jsxs)("button",{className:w,onClick:v,children:[j,z]}),e[19]=v,e[20]=w,e[21]=j,e[22]=z,e[23]=k):k=e[23];let c;e[24]!==l||e[25]!==x||e[26]!==o?(c=l&&(0,t.jsxs)("div",{className:"flex min-w-0 items-center gap-1 text-zinc-500",children:[(0,t.jsx)(zs,{size:o?14:12,className:"shrink-0 text-zinc-400"}),(0,t.jsxs)("button",{className:`flex items-center gap-1 font-bold text-zinc-900 hover:underline dark:text-zinc-100 ${o?"text-[14px] sm:text-[15px]":"text-[13px]"}`,onClick:x,children:[(0,t.jsxs)(ee,{className:"size-3.5 shrink-0 border border-zinc-200 bg-zinc-100 dark:border-zinc-700 dark:bg-zinc-800",children:[(0,t.jsx)(te,{src:l.avatar,alt:l.name,className:"object-cover"}),(0,t.jsx)(Y,{className:"text-[6px] font-bold text-zinc-500",children:l.name?.[0]?.toUpperCase()})]}),(0,t.jsx)("span",{className:"max-w-[150px] truncate sm:max-w-none",children:l.name})]})]}),e[24]=l,e[25]=x,e[26]=o,e[27]=c):c=e[27];let C;e[28]!==c||e[29]!==k?(C=(0,t.jsx)("div",{className:"flex min-w-0 flex-1 flex-col",children:(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-x-1.5 leading-none",children:(0,t.jsxs)("div",{className:"flex min-w-0 max-w-full items-center gap-1.5",children:[k,c]})})}),e[28]=c,e[29]=k,e[30]=C):C=e[30];let _;e[31]!==C||e[32]!==m?(_=(0,t.jsxs)("div",{className:"flex items-center gap-x-3 flex-1 min-w-0",children:[m,C]}),e[31]=C,e[32]=m,e[33]=_):_=e[33];const I=r||"Recent";let P;e[34]!==I?(P=(0,t.jsx)("span",{className:"whitespace-nowrap text-[12px] text-zinc-500 dark:text-zinc-400",children:I}),e[34]=I,e[35]=P):P=e[35];let y;e[36]!==n||e[37]!==P?(y=(0,t.jsxs)("div",{className:"-mt-1 flex items-center gap-2",children:[P,n]}),e[36]=n,e[37]=P,e[38]=y):y=e[38];let M;return e[39]!==_||e[40]!==y||e[41]!==b?(M=(0,t.jsxs)("div",{className:b,children:[_,y]}),e[39]=_,e[40]=y,e[41]=b,e[42]=M):M=e[42],M},it=Ts,Ms=W(),Is=i=>{const e=(0,Ms.c)(45),{content:s,isDetail:r,isEditing:l,editedContent:a,setEditedContent:n,onCancelEdit:d,onSaveEdit:o,isUpdating:g,contentClass:p}=i,h=ne(),[u,v]=(0,N.useState)(!1),f=typeof s=="string"&&Qe(s);if(l&&n){let y;e[0]!==n?(y=O=>n(O.target.value),e[0]=n,e[1]=y):y=e[1];const M=`min-h-[100px] w-full rounded-xl border-zinc-200 bg-zinc-50 focus:ring-violet-500 dark:border-zinc-800 dark:bg-zinc-900 ${Qe(a||"")?"font-bangla text-lg":"font-english"}`;let R;e[2]!==a||e[3]!==y||e[4]!==M?(R=(0,t.jsx)(ns,{value:a,onChange:y,className:M,autoFocus:!0}),e[2]=a,e[3]=y,e[4]=M,e[5]=R):R=e[5];let E;e[6]!==d?(E=(0,t.jsx)("button",{onClick:d,className:"px-4 py-1.5 text-sm font-bold text-zinc-500 transition-colors hover:text-zinc-700 dark:hover:text-zinc-300",children:"Cancel"}),e[6]=d,e[7]=E):E=e[7];let D;e[8]!==s||e[9]!==a||e[10]!==g?(D=g||!a?.trim()||a===s,e[8]=s,e[9]=a,e[10]=g,e[11]=D):D=e[11];const S=g?"Saving...":"Save";let $;e[12]!==o||e[13]!==D||e[14]!==S?($=(0,t.jsx)("button",{onClick:o,disabled:D,className:"rounded-full bg-violet-600 px-4 py-1.5 text-sm font-bold text-white transition-all hover:bg-violet-700 disabled:opacity-50 active:scale-95",children:S}),e[12]=o,e[13]=D,e[14]=S,e[15]=$):$=e[15];let T;e[16]!==E||e[17]!==$?(T=(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[E,$]}),e[16]=E,e[17]=$,e[18]=T):T=e[18];let L;return e[19]!==R||e[20]!==T?(L=(0,t.jsxs)("div",{className:"mt-2 flex flex-col gap-2",onClick:Rs,children:[R,T]}),e[19]=R,e[20]=T,e[21]=L):L=e[21],L}const x=!r&&s.length>280;let b;e[22]!==s||e[23]!==u||e[24]!==x?(b=x&&!u?s.substring(0,280):s,e[22]=s,e[23]=u,e[24]=x,e[25]=b):b=e[25];const m=b,w=r?"text-lg leading-relaxed sm:text-xl sm:leading-8":"text-[15px] leading-relaxed",j=f?"font-bangla text-[1.15em]":"font-english";let z;e[26]!==p||e[27]!==w||e[28]!==j?(z=q("whitespace-pre-line break-words",w,j,p),e[26]=p,e[27]=w,e[28]=j,e[29]=z):z=e[29];let k;e[30]!==h?(k={...$e,render:y=>{const{attributes:M,content:R}=y,{href:E,...D}=M,S=window.location.origin;if(E.includes("internal.tag/")){const T=decodeURIComponent(E.split("internal.tag/")[1]);return(0,t.jsxs)("span",{...D,className:q("cursor-pointer font-bold text-rose-600 hover:underline dark:text-rose-400 font-bangla",D.className),onClick:L=>{L.stopPropagation(),h(`/tags/${T}`)},children:["#",T]},R)}let $=null;return E.startsWith("/")?$=E:E.startsWith(S)&&($=E.replace(S,"")),$?(0,t.jsx)("span",{...D,className:q("cursor-pointer font-medium text-violet-600 hover:underline dark:text-violet-400",D.className),onClick:T=>{T.stopPropagation(),h($)},children:R},R):(0,t.jsx)("a",{href:E,...D,target:"_blank",rel:"noopener noreferrer",className:q("text-violet-600 hover:underline dark:text-violet-400",D.className),onClick:Es,children:R},R)}},e[30]=h,e[31]=k):k=e[31];let c;e[32]!==m?(c=typeof m=="string"?m.replace(/#([\u0980-\u09FF\w]+)/g,"https://internal.tag/$1"):m,e[32]=m,e[33]=c):c=e[33];let C;e[34]!==k||e[35]!==c?(C=(0,t.jsx)(Ce,{options:k,children:c}),e[34]=k,e[35]=c,e[36]=C):C=e[36];const _=x&&!u&&"...";let I;e[37]!==u||e[38]!==x?(I=x&&(0,t.jsx)("button",{onClick:y=>{y.stopPropagation(),v(!u)},className:"ml-1 cursor-pointer font-bold text-rose-600 hover:underline dark:text-rose-400",children:u?"Show less":"See more"}),e[37]=u,e[38]=x,e[39]=I):I=e[39];let P;return e[40]!==z||e[41]!==C||e[42]!==_||e[43]!==I?(P=(0,t.jsxs)("div",{className:z,children:[C,_,I]}),e[40]=z,e[41]=C,e[42]=_,e[43]=I,e[44]=P):P=e[44],P},lt=Is;function Rs(i){return i.stopPropagation()}function Es(i){return i.stopPropagation()}var Ds=W(),As=i=>{const e=(0,Ds.c)(28),{media:s,isEditing:r,editedMedia:l,setEditedMedia:a,newFiles:n,setNewFiles:d}=i;let o;e[0]!==l?(o=l===void 0?[]:l,e[0]=l,e[1]=o):o=e[1];const g=o;let p;e[2]!==n?(p=n===void 0?[]:n,e[2]=n,e[3]=p):p=e[3];const h=p,u=(0,N.useRef)(null);if(r&&a&&d){let f;if(e[4]!==g||e[5]!==a){let z;e[7]!==a?(z=(k,c)=>(0,t.jsxs)("div",{className:"group relative aspect-square overflow-hidden rounded-xl border border-zinc-200 dark:border-zinc-800",children:[k.type==="video"?(0,t.jsx)("div",{className:"flex size-full items-center justify-center bg-zinc-100 dark:bg-zinc-900",children:(0,t.jsx)(Ue,{size:24,className:"text-zinc-400"})}):(0,t.jsx)("img",{src:k.url||k.src,className:"size-full object-cover",alt:""}),(0,t.jsx)("button",{onClick:C=>{C.stopPropagation(),a(_=>_.filter((I,P)=>P!==c))},className:"absolute right-1.5 top-1.5 flex size-7 items-center justify-center rounded-full bg-black/60 text-white transition-colors hover:bg-black",children:(0,t.jsx)(ae,{size:16})})]},`old-${c}`),e[7]=a,e[8]=z):z=e[8],f=g.map(z),e[4]=g,e[5]=a,e[6]=f}else f=e[6];let x;if(e[9]!==h||e[10]!==d){let z;e[12]!==d?(z=(k,c)=>(0,t.jsxs)("div",{className:"group relative aspect-square overflow-hidden rounded-xl border-2 border-dashed border-violet-500 bg-violet-50/10",children:[k.type.startsWith("image/")?(0,t.jsx)("img",{src:URL.createObjectURL(k),className:"size-full object-cover",alt:""}):(0,t.jsx)("div",{className:"flex size-full items-center justify-center",children:(0,t.jsx)(Ue,{size:24,className:"animate-pulse text-violet-500"})}),(0,t.jsx)("button",{onClick:C=>{C.stopPropagation(),d(_=>_.filter((I,P)=>P!==c))},className:"absolute right-1.5 top-1.5 flex size-7 items-center justify-center rounded-full bg-black/60 text-white transition-colors hover:bg-black",children:(0,t.jsx)(ae,{size:16})}),(0,t.jsx)("div",{className:"absolute bottom-1 left-1 rounded bg-violet-600 px-1 text-[8px] font-bold text-white",children:"NEW"})]},`new-${c}`),e[12]=d,e[13]=z):z=e[13],x=h.map(z),e[9]=h,e[10]=d,e[11]=x}else x=e[11];let b;e[14]!==g.length||e[15]!==h.length?(b=g.length+h.length<4&&(0,t.jsxs)("button",{onClick:z=>{z.stopPropagation(),u.current?.click()},className:"relative flex aspect-square flex-col items-center justify-center gap-1 rounded-xl border-2 border-dashed border-zinc-200 text-zinc-400 transition-all hover:border-violet-500 hover:bg-violet-50/5 hover:text-violet-500 dark:border-zinc-800",children:[(0,t.jsx)(Zt,{size:20}),(0,t.jsx)("span",{className:"text-[10px] font-bold",children:"Add Media"})]}),e[14]=g.length,e[15]=h.length,e[16]=b):b=e[16];let m;e[17]!==f||e[18]!==x||e[19]!==b?(m=(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:[f,x,b]}),e[17]=f,e[18]=x,e[19]=b,e[20]=m):m=e[20];let w;e[21]!==d?(w=(0,t.jsx)("input",{type:"file",ref:u,onChange:z=>{if(z.target.files){const k=Array.from(z.target.files);d(c=>[...c,...k])}},multiple:!0,className:"hidden",accept:"image/*,video/*"}),e[21]=d,e[22]=w):w=e[22];let j;return e[23]!==m||e[24]!==w?(j=(0,t.jsxs)("div",{className:"mt-3 space-y-3",children:[m,w]}),e[23]=m,e[24]=w,e[25]=j):j=e[25],j}if(!s||s.length===0)return null;let v;return e[26]!==s?(v=(0,t.jsx)(ri,{items:s}),e[26]=s,e[27]=v):v=e[27],v},at=As,Ls=W(),Us=i=>{const e=(0,Ls.c)(35),{icon:s,count:r,label:l,onClick:a,active:n,activeColorClass:d,size:o,type:g}=i,p=o===void 0?18:o,h=g===void 0?"default":g;let u,v,f,x,b;if(e[0]!==n||e[1]!==d||e[2]!==r||e[3]!==l||e[4]!==a||e[5]!==h){const I={like:{hoverBg:"group-hover:bg-rose-500/10",hoverText:"group-hover:text-rose-500",activeText:"text-rose-500",activeFill:"fill-rose-500"},repost:{hoverBg:"group-hover:bg-emerald-500/10",hoverText:"group-hover:text-emerald-500",activeText:"text-emerald-500",activeFill:"fill-emerald-500"},comment:{hoverBg:"group-hover:bg-sky-500/10",hoverText:"group-hover:text-sky-500",activeText:"text-sky-500",activeFill:"fill-sky-500"},share:{hoverBg:"group-hover:bg-violet-500/10",hoverText:"group-hover:text-violet-500",activeText:"text-violet-500",activeFill:"fill-violet-500"},default:{hoverBg:"group-hover:bg-zinc-500/10",hoverText:"group-hover:text-zinc-500",activeText:"text-zinc-900 dark:text-white",activeFill:"fill-current"}};u=I[h]||I.default;const P=d||u.activeText;e[11]!==a?(f=y=>{y.stopPropagation(),a&&a(y)},e[11]=a,e[12]=f):f=e[12],x=`${l} ${r!==void 0?`(${r})`:""}`,b=q("group -ml-2 flex items-center gap-x-0.5 rounded-xl px-2 py-1.5 text-[12px] font-bold transition-all sm:gap-x-1 sm:text-[13px]",n?P:"text-zinc-500",!n&&u.hoverText),v=q("rounded-full p-2 transition-all duration-200",!n&&u.hoverBg),e[0]=n,e[1]=d,e[2]=r,e[3]=l,e[4]=a,e[5]=h,e[6]=u,e[7]=v,e[8]=f,e[9]=x,e[10]=b}else u=e[6],v=e[7],f=e[8],x=e[9],b=e[10];const m=n?2.5:2,w=n&&u.activeFill;let j;e[13]!==w?(j=q("transition-colors duration-200",w),e[13]=w,e[14]=j):j=e[14];let z;e[15]!==s||e[16]!==p||e[17]!==m||e[18]!==j?(z=(0,t.jsx)(s,{size:p,strokeWidth:m,className:j}),e[15]=s,e[16]=p,e[17]=m,e[18]=j,e[19]=z):z=e[19];let k;e[20]!==z||e[21]!==v?(k=(0,t.jsx)("div",{className:v,children:z}),e[20]=z,e[21]=v,e[22]=k):k=e[22];let c;e[23]!==l?(c=l&&(0,t.jsx)("span",{className:"hidden xs:inline",children:l}),e[23]=l,e[24]=c):c=e[24];let C;e[25]!==n||e[26]!==r?(C=r!=null&&(0,t.jsx)("span",{className:q("transition-all",n?"font-black":"font-bold"),children:r||0}),e[25]=n,e[26]=r,e[27]=C):C=e[27];let _;return e[28]!==k||e[29]!==c||e[30]!==C||e[31]!==f||e[32]!==x||e[33]!==b?(_=(0,t.jsxs)("button",{onClick:f,"aria-label":x,className:b,children:[k,c,C]}),e[28]=k,e[29]=c,e[30]=C,e[31]=f,e[32]=x,e[33]=b,e[34]=_):_=e[34],_},H=Us,Ws=W(),Os=i=>{const e=(0,Ws.c)(18),{poll:s,onVote:r}=i,l=s.options.reduce(Bs,0),[a,n]=(0,N.useState)(null);let d;e[0]!==r||e[1]!==a?(d=f=>{a||(n(f),r&&r(f))},e[0]=r,e[1]=a,e[2]=d):d=e[2];const o=d;let g;if(e[3]!==o||e[4]!==s.options||e[5]!==l||e[6]!==a){let f;e[8]!==o||e[9]!==l||e[10]!==a?(f=(x,b)=>{const m=l>0?Math.round((x.votes+(a===x.id?1:0))/(l+(a?1:0))*100):0,w=a===x.id;return(0,t.jsxs)("div",{onClick:()=>o(x.id),className:`relative h-10 w-full overflow-hidden rounded-xl border cursor-pointer ${w?"border-violet-500 dark:border-violet-500":"border-zinc-200 dark:border-zinc-700"}`,children:[a&&(0,t.jsx)("div",{className:"absolute left-0 top-0 h-full bg-zinc-200 transition-all duration-500 dark:bg-zinc-800",style:{width:`${m}%`}}),(0,t.jsxs)("div",{className:"absolute inset-0 z-10 flex items-center justify-between px-4",children:[(0,t.jsxs)("span",{className:`text-sm font-medium ${w?"font-bold text-violet-600":"text-zinc-700 dark:text-zinc-200"}`,children:[x.text," ",w&&(0,t.jsx)(Rt,{size:14,className:"mb-0.5 inline ml-1"})]}),a&&(0,t.jsxs)("span",{className:"text-sm font-bold text-zinc-900 dark:text-white",children:[m,"%"]})]})]},x.id||b)},e[8]=o,e[9]=l,e[10]=a,e[11]=f):f=e[11],g=s.options.map(f),e[3]=o,e[4]=s.options,e[5]=l,e[6]=a,e[7]=g}else g=e[7];const p=l+(a?1:0),h=a?"6 days left":"Click to vote";let u;e[12]!==p||e[13]!==h?(u=(0,t.jsxs)("div",{className:"pl-1 text-xs text-zinc-500 dark:text-zinc-400",children:[p," votes •"," ",h]}),e[12]=p,e[13]=h,e[14]=u):u=e[14];let v;return e[15]!==g||e[16]!==u?(v=(0,t.jsxs)("div",{className:"mt-3 space-y-2",children:[g,u]}),e[15]=g,e[16]=u,e[17]=v):v=e[17],v},nt=Os;function Bs(i,e){return i+e.votes}var Vs=W(),qs=i=>{const e=(0,Vs.c)(30),{user:s,time:r,content:l}=i,a=ne();let n;e[0]!==s.avatar||e[1]!==s.handle?(n=(0,t.jsx)(te,{src:s.avatar,alt:s.handle}),e[0]=s.avatar,e[1]=s.handle,e[2]=n):n=e[2];let d;e[3]!==s.handle[0]?(d=s.handle[0]?.toUpperCase(),e[3]=s.handle[0],e[4]=d):d=e[4];let o;e[5]!==d?(o=(0,t.jsx)(Y,{children:d}),e[5]=d,e[6]=o):o=e[6];let g;e[7]!==n||e[8]!==o?(g=(0,t.jsxs)(ee,{className:"size-6",children:[n,o]}),e[7]=n,e[8]=o,e[9]=g):g=e[9];let p;e[10]!==s.handle?(p=(0,t.jsx)("span",{className:"text-sm font-semibold",children:s.handle}),e[10]=s.handle,e[11]=p):p=e[11];let h;e[12]!==g||e[13]!==p?(h=(0,t.jsxs)("div",{className:"flex items-center gap-x-2",children:[g,p]}),e[12]=g,e[13]=p,e[14]=h):h=e[14];let u;e[15]!==r?(u=(0,t.jsx)("span",{className:"text-xs text-zinc-500 sm:text-sm",children:r}),e[15]=r,e[16]=u):u=e[16];let v;e[17]!==h||e[18]!==u?(v=(0,t.jsxs)("div",{className:"mb-2 flex items-center justify-between gap-x-2",children:[h,u]}),e[17]=h,e[18]=u,e[19]=v):v=e[19];let f;e[20]!==a?(f={...$e,render:w=>{const{attributes:j,content:z}=w,{href:k,...c}=j,C=window.location.origin;let _=null;return k.startsWith("/")?_=k:k.startsWith(C)&&(_=k.replace(C,"")),_?(0,t.jsx)("span",{...c,className:q("cursor-pointer font-medium text-violet-600 hover:underline dark:text-violet-400",c.className),onClick:I=>{I.stopPropagation(),a(_)},children:z},z):(0,t.jsx)("a",{href:k,...c,target:"_blank",rel:"noopener noreferrer",className:q("text-violet-600 hover:underline dark:text-violet-400",c.className),onClick:Hs,children:z},z)}},e[20]=a,e[21]=f):f=e[21];let x;e[22]!==l?(x=(0,t.jsx)("p",{className:"whitespace-pre-line text-sm text-zinc-800 dark:text-zinc-300",children:l}),e[22]=l,e[23]=x):x=e[23];let b;e[24]!==x||e[25]!==f?(b=(0,t.jsx)(Ce,{options:f,children:x}),e[24]=x,e[25]=f,e[26]=b):b=e[26];let m;return e[27]!==b||e[28]!==v?(m=(0,t.jsxs)("div",{className:"p-4",children:[v,b]}),e[27]=b,e[28]=v,e[29]=m):m=e[29],m},rt=qs;function Hs(i){return i.stopPropagation()}var Gs=W(),Qs=i=>{const e=(0,Gs.c)(54),{currentUser:s,newComment:r,setNewComment:l,handleSubmitComment:a,loading:n,selectedFiles:d,setSelectedFiles:o,isUploading:g}=i;let p;e[0]!==d?(p=d===void 0?[]:d,e[0]=d,e[1]=p):p=e[1];const h=p,u=(0,N.useRef)(null);let v;e[2]!==o?(v=A=>{if(A.target.files){const B=Array.from(A.target.files);o&&o(G=>[...G,...B])}},e[2]=o,e[3]=v):v=e[3];const f=v;let x;e[4]!==o?(x=A=>{o&&o(B=>B.filter((G,Q)=>Q!==A))},e[4]=o,e[5]=x):x=e[5];const b=x;let m;e[6]!==o?(m=A=>{const B=A.clipboardData.files;if(B&&B.length>0){const G=Array.from(B).filter(Js);G.length>0&&(A.preventDefault(),o&&o(Q=>[...Q,...G]))}},e[6]=o,e[7]=m):m=e[7];const w=m;if(!s){let A;return e[8]===Symbol.for("react.memo_cache_sentinel")?(A=(0,t.jsx)("div",{className:"border-y border-zinc-100 bg-zinc-50/30 p-6 text-center dark:border-zinc-800 dark:bg-zinc-900/10",children:(0,t.jsx)("p",{className:"text-sm text-zinc-500",children:"Please login to join the conversation."})}),e[8]=A):A=e[8],A}let j;e[9]!==s.avatar||e[10]!==s.handle?(j=(0,t.jsx)(te,{src:s.avatar,alt:s.handle,className:"object-cover"}),e[9]=s.avatar,e[10]=s.handle,e[11]=j):j=e[11];let z;e[12]!==s.handle?.[0]?(z=s.handle?.[0]?.toUpperCase(),e[12]=s.handle?.[0],e[13]=z):z=e[13];let k;e[14]!==z?(k=(0,t.jsx)(Y,{children:z}),e[14]=z,e[15]=k):k=e[15];let c;e[16]!==j||e[17]!==k?(c=(0,t.jsxs)(ee,{className:"size-9 border border-zinc-200 dark:border-zinc-700",children:[j,k]}),e[16]=j,e[17]=k,e[18]=c):c=e[18];let C;e[19]!==l?(C=A=>l(A.target.value),e[19]=l,e[20]=C):C=e[20];let _;e[21]!==w||e[22]!==r||e[23]!==C?(_=(0,t.jsx)("textarea",{id:"comment-input",className:"min-h-[60px] w-full resize-none bg-transparent text-base outline-none placeholder:text-zinc-500 dark:text-white",placeholder:"Post your reply...",value:r,onChange:C,onPaste:w}),e[21]=w,e[22]=r,e[23]=C,e[24]=_):_=e[24];let I;e[25]!==b||e[26]!==h?(I=h.length>0&&(0,t.jsx)("div",{className:"mt-2 mb-2 flex flex-wrap gap-2",children:h.map((A,B)=>(0,t.jsxs)("div",{className:"relative size-20 overflow-hidden rounded-xl border border-zinc-200 dark:border-zinc-800",children:[A.type.startsWith("image/")?(0,t.jsx)("img",{src:URL.createObjectURL(A),className:"size-full object-cover",alt:""}):(0,t.jsx)("div",{className:"flex size-full items-center justify-center bg-zinc-100 dark:bg-zinc-800",children:(0,t.jsx)(Kt,{size:20,className:"text-zinc-500"})}),(0,t.jsx)("button",{onClick:()=>b(B),className:"absolute right-1 top-1 rounded-full bg-black/60 p-1 text-white transition-colors hover:bg-black",children:(0,t.jsx)(ae,{size:12})})]},B))}),e[25]=b,e[26]=h,e[27]=I):I=e[27];let P;e[28]===Symbol.for("react.memo_cache_sentinel")?(P=()=>u.current?.click(),e[28]=P):P=e[28];let y;e[29]===Symbol.for("react.memo_cache_sentinel")?(y=(0,t.jsx)("button",{type:"button",onClick:P,className:"rounded-full p-2 text-violet-600 transition-colors hover:bg-violet-50 dark:hover:bg-zinc-800",title:"Attach media",children:(0,t.jsx)(hs,{size:20})}),e[29]=y):y=e[29];let M;e[30]!==f?(M=(0,t.jsxs)("div",{className:"flex gap-1 text-violet-600",children:[y,(0,t.jsx)("input",{type:"file",ref:u,onChange:f,multiple:!0,className:"hidden",accept:"image/*,video/*,application/pdf"})]}),e[30]=f,e[31]=M):M=e[31];const R=n||g?"primary":"animated";let E;e[32]!==g||e[33]!==n?(E=!(n||g)&&(0,t.jsx)(ue,{size:20}),e[32]=g,e[33]=n,e[34]=E):E=e[34];const D=n||g;let S;e[35]!==r||e[36]!==h.length?(S=!r.trim()&&h.length===0,e[35]=r,e[36]=h.length,e[37]=S):S=e[37];let $;e[38]!==a||e[39]!==R||e[40]!==E||e[41]!==D||e[42]!==S?($=(0,t.jsx)(fs,{variant:R,icon:E,className:"min-w-[70px] !w-auto",onClick:a,loading:D,disabled:S,children:"Reply"}),e[38]=a,e[39]=R,e[40]=E,e[41]=D,e[42]=S,e[43]=$):$=e[43];let T;e[44]!==M||e[45]!==$?(T=(0,t.jsxs)("div",{className:"mt-2 flex items-center justify-between border-t border-zinc-100 pt-3 dark:border-zinc-800",children:[M,$]}),e[44]=M,e[45]=$,e[46]=T):T=e[46];let L;e[47]!==_||e[48]!==I||e[49]!==T?(L=(0,t.jsxs)("div",{className:"flex-1",children:[_,I,T]}),e[47]=_,e[48]=I,e[49]=T,e[50]=L):L=e[50];let O;return e[51]!==L||e[52]!==c?(O=(0,t.jsx)("div",{className:"border-y border-zinc-100 bg-zinc-50/30 p-4 dark:border-zinc-800 dark:bg-zinc-900/10",children:(0,t.jsxs)("div",{className:"flex gap-3",children:[c,L]})}),e[51]=L,e[52]=c,e[53]=O):O=e[53],O},pt=N.memo(Qs);function Js(i){return i.type.startsWith("image/")}var Xs=W(),Ks=i=>{const e=(0,Xs.c)(30),{url:s}=i;let r,l;e[0]!==s?(r=["link-preview",s],l=()=>ts(s),e[0]=s,e[1]=r,e[2]=l):(r=e[1],l=e[2]);const a=!!s;let n;e[3]!==r||e[4]!==l||e[5]!==a?(n={queryKey:r,queryFn:l,staleTime:864e5,enabled:a},e[3]=r,e[4]=l,e[5]=a,e[6]=n):n=e[6];const{data:d,isLoading:o,isError:g}=Tt(n);if(o){let j;return e[7]===Symbol.for("react.memo_cache_sentinel")?(j=(0,t.jsx)("div",{className:"mt-3 flex h-24 animate-pulse items-center justify-center overflow-hidden rounded-2xl border border-zinc-100 bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-900/50",children:(0,t.jsx)(We,{className:"animate-spin text-zinc-300 dark:text-zinc-700",size:24})}),e[7]=j):j=e[7],j}if(g||!d||!d.title&&!d.image)return null;let p;e[8]!==d.image||e[9]!==d.title?(p=d.image&&(0,t.jsx)("div",{className:"aspect-[1.91/1] w-full overflow-hidden border-b border-zinc-100 bg-zinc-100 dark:border-zinc-800 dark:bg-zinc-900",children:(0,t.jsx)("img",{src:d.image,alt:d.title??void 0,className:"h-full w-full object-cover transition-transform duration-500 group-hover:scale-[1.02]",onError:Ys})}),e[8]=d.image,e[9]=d.title,e[10]=p):p=e[10];let h;e[11]===Symbol.for("react.memo_cache_sentinel")?(h=(0,t.jsx)(We,{size:12}),e[11]=h):h=e[11];let u;e[12]!==d.siteName?(u=(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs font-bold uppercase tracking-wider text-zinc-600",children:[h,(0,t.jsx)("span",{children:d.siteName})]}),e[12]=d.siteName,e[13]=u):u=e[13];let v;e[14]!==d.title?(v=(0,t.jsx)("div",{className:"line-clamp-2 text-[15px] font-bold leading-snug transition-colors group-hover:text-violet-700 dark:text-white",children:d.title}),e[14]=d.title,e[15]=v):v=e[15];let f;e[16]!==d.description?(f=d.description&&(0,t.jsx)("p",{className:"line-clamp-2 text-xs leading-relaxed text-zinc-600 dark:text-zinc-400",children:d.description}),e[16]=d.description,e[17]=f):f=e[17];let x;e[18]===Symbol.for("react.memo_cache_sentinel")?(x=(0,t.jsx)(Lt,{size:10}),e[18]=x):x=e[18];let b;e[19]!==s?(b=(0,t.jsxs)("div",{className:"flex items-center gap-1 pt-1 text-[11px] font-medium text-zinc-500",children:[x,(0,t.jsx)("span",{className:"truncate",children:s})]}),e[19]=s,e[20]=b):b=e[20];let m;e[21]!==b||e[22]!==u||e[23]!==v||e[24]!==f?(m=(0,t.jsxs)("div",{className:"space-y-1 p-3.5",children:[u,v,f,b]}),e[21]=b,e[22]=u,e[23]=v,e[24]=f,e[25]=m):m=e[25];let w;return e[26]!==m||e[27]!==p||e[28]!==s?(w=(0,t.jsxs)("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"group mt-3 flex flex-col overflow-hidden rounded-2xl border border-zinc-100 bg-white shadow-sm transition-all hover:bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-950 dark:hover:bg-zinc-900",onClick:Zs,children:[p,m]}),e[26]=m,e[27]=p,e[28]=s,e[29]=w):w=e[29],w},ot=Ks;function Zs(i){return i.stopPropagation()}function Ys(i){return i.target.style.display="none"}var ei=W(),ti=i=>{const e=(0,ei.c)(15),{file:s}=i;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=(0,t.jsx)("div",{className:"flex size-10 items-center justify-center rounded-xl bg-violet-100 text-violet-600 dark:bg-violet-900/30",children:(0,t.jsx)(Mt,{size:20})}),e[0]=r):r=e[0];let l;e[1]!==s.name?(l=(0,t.jsx)("div",{className:"truncate text-sm font-bold dark:text-white",children:s.name}),e[1]=s.name,e[2]=l):l=e[2];let a;e[3]!==s.size?(a=s.size!==void 0&&(0,t.jsxs)("div",{className:"text-xs uppercase text-zinc-500",children:[(s.size/1024/1024).toFixed(2)," MB"]}),e[3]=s.size,e[4]=a):a=e[4];let n;e[5]!==l||e[6]!==a?(n=(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[l,a]}),e[5]=l,e[6]=a,e[7]=n):n=e[7];let d;e[8]===Symbol.for("react.memo_cache_sentinel")?(d=(0,t.jsx)(Ut,{size:18}),e[8]=d):d=e[8];let o;e[9]!==s.name||e[10]!==s.url?(o=(0,t.jsx)("a",{href:s.url,download:s.name,className:"p-2 text-zinc-400 transition-colors hover:text-violet-600",onClick:ii,children:d}),e[9]=s.name,e[10]=s.url,e[11]=o):o=e[11];let g;return e[12]!==n||e[13]!==o?(g=(0,t.jsxs)("div",{className:"group mt-3 flex items-center gap-3 rounded-2xl border border-zinc-100 bg-zinc-50/50 p-3 transition-colors hover:border-violet-500/30 dark:border-zinc-800 dark:bg-zinc-900/10",children:[r,n,o]}),e[12]=n,e[13]=o,e[14]=g):g=e[14],g},si=ti;function ii(i){return i.stopPropagation()}var gt=W(),li=N.lazy(()=>mt(()=>import("./VideoPlayer-Lq0yvnfv.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),ai=i=>{const e=(0,gt.c)(10),{item:s,onClick:r}=i,[l,a]=(0,N.useState)(!1);let n;e[0]!==l?(n=!l&&(0,t.jsx)("div",{className:"absolute inset-0 animate-pulse bg-zinc-200 dark:bg-zinc-800"}),e[0]=l,e[1]=n):n=e[1];const d=s.url||s.src,o=`size-full object-cover transition-all duration-500 hover:scale-[1.02] ${l?"opacity-100":"opacity-0"}`;let g;e[2]===Symbol.for("react.memo_cache_sentinel")?(g=()=>a(!0),e[2]=g):g=e[2];let p;e[3]!==d||e[4]!==o?(p=(0,t.jsx)("img",{src:d,className:o,alt:"",loading:"lazy",onLoad:g}),e[3]=d,e[4]=o,e[5]=p):p=e[5];let h;return e[6]!==r||e[7]!==n||e[8]!==p?(h=(0,t.jsxs)("div",{className:"relative size-full overflow-hidden",onClick:r,children:[n,p]}),e[6]=r,e[7]=n,e[8]=p,e[9]=h):h=e[9],h},ni=i=>{const e=(0,gt.c)(3),{items:s}=i,r=s===void 0?[]:s,{openLightbox:l}=ms();if(!r||Array.isArray(r)&&r.length===0)return null;const a=Array.isArray(r)?r:[r],n=a.filter(oi),d=a.filter(ci),o=v=>{const f=n.filter(di).map(mi),x=n[v];l(f,f.indexOf(x.url||x.src))},g="mt-2 space-y-2",p=n.length>0&&(0,t.jsx)("div",{className:`grid gap-2 overflow-hidden rounded-2xl border border-zinc-100 dark:border-zinc-800 ${n.length===1?"grid-cols-1":n.length===2?"aspect-[16/9] grid-cols-2":(n.length===3,"aspect-[16/9] grid-cols-2 grid-rows-2")}`,children:n.map((v,f)=>(0,t.jsx)("div",{className:`relative cursor-pointer overflow-hidden bg-zinc-100 dark:bg-zinc-900 ${n.length===3&&f===0?"row-span-2":""}
                                `,children:v.type==="video"?(0,t.jsx)(N.Suspense,{fallback:(0,t.jsx)("div",{className:"flex aspect-video w-full items-center justify-center bg-zinc-100 dark:bg-zinc-900",children:(0,t.jsx)("div",{className:"size-8 animate-spin rounded-full border-2 border-violet-500 border-t-transparent"})}),children:(0,t.jsx)(li,{src:v.url,poster:v.poster||void 0})}):(0,t.jsx)(ai,{item:v,onClick:x=>{x.stopPropagation(),o(f)}})},f))}),h=d.map(xi);let u;return e[0]!==p||e[1]!==h?(u=(0,t.jsxs)("div",{className:g,children:[p,h]}),e[0]=p,e[1]=h,e[2]=u):u=e[2],u},ri=ni;function oi(i){return i.type==="image"||i.type==="video"}function ci(i){return i.type==="file"}function di(i){return i.type==="image"}function mi(i){return i.url||i.src}function xi(i,e){return(0,t.jsx)(si,{file:i},e)}var vt=W(),hi=i=>{const e=(0,vt.c)(6),{avatars:s}=i;if(!s||s.length===0)return null;let r,l;if(e[0]!==s){const n=s.slice(0,3);r="relative mt-2 h-7 w-7",l=n.map((d,o)=>{let g,p;return n.length===1?(g="top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",p="size-5"):n.length===2?(p="size-4",g=o===0?"top-0 right-0":"bottom-0 left-0"):(p=o===0?"size-3.5":"size-3",o===0?g="top-0 right-0":o===1?g="bottom-0 right-0":g="top-1/2 left-0 -translate-y-1/2"),(0,t.jsx)("div",{className:`absolute rounded-full border border-white bg-zinc-100 dark:border-black dark:bg-zinc-800 overflow-hidden shadow-sm ${g} ${p}`,style:{zIndex:10-o},children:(0,t.jsx)("img",{src:d,alt:"",className:"h-full w-full object-cover"})},o)}),e[0]=s,e[1]=r,e[2]=l}else r=e[1],l=e[2];let a;return e[3]!==r||e[4]!==l?(a=(0,t.jsx)("div",{className:r,children:l}),e[3]=r,e[4]=l,e[5]=a):a=e[5],a},ct=i=>{const e=(0,vt.c)(32),{id:s,user:r,isCurrentUser:l,isComment:a,onEdit:n,onDelete:d,addToast:o,trigger:g}=i;let p;e[0]!==g?(p=(0,t.jsx)(ls,{asChild:!0,onClick:pi,children:g}),e[0]=g,e[1]=p):p=e[1];let h;e[2]!==o||e[3]!==s||e[4]!==a?(h=!a&&(0,t.jsxs)(le,{className:"cursor-pointer gap-2 py-2.5",onClick:j=>{j.stopPropagation(),navigator.clipboard.writeText(`${window.location.origin}/p/${s}`),o("Link copied")},children:[(0,t.jsx)(Ot,{size:16}),(0,t.jsx)("span",{children:"Copy link"})]}),e[2]=o,e[3]=s,e[4]=a,e[5]=h):h=e[5];let u;e[6]!==o||e[7]!==a?(u=!a&&(0,t.jsxs)(le,{className:"cursor-pointer gap-2 py-2.5",onClick:j=>{j.stopPropagation(),o("Post reported")},children:[(0,t.jsx)(At,{size:16}),(0,t.jsx)("span",{children:"Report post"})]}),e[6]=o,e[7]=a,e[8]=u):u=e[8];let v;e[9]!==o||e[10]!==l||e[11]!==r?(v=!l&&(0,t.jsxs)(le,{className:"cursor-pointer gap-2 py-2.5",onClick:j=>{j.stopPropagation(),o("User blocked")},children:[(0,t.jsx)(It,{size:16}),(0,t.jsxs)("span",{children:["Block @",r.handle]})]}),e[9]=o,e[10]=l,e[11]=r,e[12]=v):v=e[12];let f;e[13]!==a||e[14]!==l||e[15]!==n?(f=l&&(0,t.jsxs)(le,{onClick:j=>{j.stopPropagation(),n()},className:"cursor-pointer gap-2 py-2.5",children:[(0,t.jsx)(Xt,{size:16}),"Edit ",a?"Comment":"Post"]}),e[13]=a,e[14]=l,e[15]=n,e[16]=f):f=e[16];let x;e[17]!==h||e[18]!==u||e[19]!==v||e[20]!==f?(x=(0,t.jsxs)(Be,{children:[h,u,v,f]}),e[17]=h,e[18]=u,e[19]=v,e[20]=f,e[21]=x):x=e[21];let b;e[22]!==a||e[23]!==l||e[24]!==d?(b=l&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ds,{}),(0,t.jsx)(Be,{children:(0,t.jsxs)(le,{variant:"destructive",className:"cursor-pointer gap-2 py-2.5",onClick:j=>{j.stopPropagation(),d()},children:[(0,t.jsx)(es,{size:16}),(0,t.jsxs)("span",{children:["Delete ",a?"comment":"post"]})]})})]}),e[22]=a,e[23]=l,e[24]=d,e[25]=b):b=e[25];let m;e[26]!==x||e[27]!==b?(m=(0,t.jsxs)(ss,{align:"end",className:"w-48 rounded-xl border-zinc-100 bg-white dark:border-zinc-800 dark:bg-zinc-900",children:[x,b]}),e[26]=x,e[27]=b,e[28]=m):m=e[28];let w;return e[29]!==p||e[30]!==m?(w=(0,t.jsxs)(vs,{children:[p,m]}),e[29]=p,e[30]=m,e[31]=w):w=e[31],w},we=({id:i,user:e,timeAgo:s,content:r,contentClass:l,media:a,quotedPost:n,stats:d,onClick:o,repostedBy:g,onUserClick:p,currentUser:h,poll:u,isDetail:v,initialComments:f,onDelete:x,onUpdate:b,isComment:m,onReply:w,community:j,parent_id:z,post_id:k,commenterAvatars:c=[]})=>{const C=ne(),{addToast:_}=ye(),{liked:I,reposted:P,localStats:y,setLocalStats:M,handleLike:R,handleRepost:E}=Cs(i,d,h),{deletePost:D,updatePost:S}=Ns(),{comments:$,fetchNextPage:T,hasNextPage:L,isFetchingNextPage:O,isLoading:A,addComment:B,isSubmitting:G}=et(i,f),[Q,pe]=(0,N.useState)(""),[ge,_e]=(0,N.useState)([]),[jt,Se]=(0,N.useState)(!1),[Fe,se]=(0,N.useState)(!1),[re,K]=(0,N.useState)(!1),[J,oe]=(0,N.useState)(r),[ce,de]=(0,N.useState)(a||[]),[me,ie]=(0,N.useState)([]),[Pe,Te]=(0,N.useState)(!1),[zt,ve]=(0,N.useState)(!1),[be,xe]=(0,N.useState)(null),[je,Me]=(0,N.useState)(!1),{comments:kt,isLoading:Nt,refetch:Ie}=et(k||i,[],je?i:void 0),{ref:Re,inView:Ee}=Ft({threshold:.5,triggerOnce:!0});(0,N.useEffect)(()=>{if(Ee&&!m){const F=setTimeout(()=>{as(i).catch(console.error)},1500);return()=>clearTimeout(F)}},[Ee,i,m]);const wt=(0,N.useCallback)(async()=>{!i||!k&&!i||y.comments===0||(Me(!0),Ie())},[i,k,y.comments,Ie]),De=async()=>{const F=JSON.stringify(ce)!==JSON.stringify(a||[])||me.length>0;if(!J.trim()||J===r&&!F){K(!1);return}Te(!0);try{const U=[];for(const Z of me){const $t=await Ne(Z);U.push($t)}const V=[...ce,...U];m?await ps(i,{content:J,media:V}):await S(i,{content:J,media:V}),ie([]),K(!1),_(`${m?"Comment":"Post"} updated`),b&&b(i,J,V)}catch(U){console.error(`Failed to update ${m?"comment":"post"}:`,U),_(`Failed to update ${m?"comment":"post"}`)}finally{Te(!1)}},Ae=async F=>{F&&F.stopPropagation();try{m?await is(i):await D(i),_(`${m?"Comment":"Post"} deleted successfully`),x&&x(i)}catch(U){console.error(`Failed to delete ${m?"comment":"post"}:`,U),_(`Failed to delete ${m?"comment":"post"}`)}finally{se(!1)}},yt=async F=>{if(F.preventDefault(),!(!Q.trim()&&ge.length===0||!h)){Se(!0);try{const U=[];for(const V of ge){const Z=await Ne(V);U.push(Z)}await B({userId:h.id,content:Q,media:U,replyToId:be?.id}),pe(""),_e([]),xe(null),M(V=>({...V,comments:(V.comments||0)+1})),_("Reply posted!")}catch(U){console.error("Failed to post comment:",U),_("Failed to post reply.")}finally{Se(!1)}}},Le=h?.handle===e.handle,Ct=(F,U)=>{xe(U?{handle:F,id:m?z||i:U}:null),pe(V=>{const Z=`@${F} `;return V.includes(Z)?V:Z+V}),document.getElementById("comment-input")?.focus()};return v?(0,t.jsxs)("div",{className:"flex flex-col",ref:Re,children:[(0,t.jsxs)("article",{className:"p-5 dark:bg-black",children:[(0,t.jsx)(it,{user:e,timeAgo:s,community:j,onUserClick:p,isDetail:!0,showAvatar:!0,actionsMenu:(0,t.jsx)(ct,{id:i,user:e,isCurrentUser:Le,isComment:m,onEdit:()=>K(!0),onDelete:()=>se(!0),addToast:_,trigger:(0,t.jsx)("button",{"aria-label":"More options",className:"rounded-full p-2 text-zinc-500 transition-colors hover:bg-zinc-100 dark:hover:bg-zinc-800",children:(0,t.jsx)(ke,{size:20})})})}),(0,t.jsx)(lt,{content:r,isDetail:!0,isEditing:re,editedContent:J,setEditedContent:oe,onCancelEdit:()=>{K(!1),oe(r),de(a||[]),ie([])},onSaveEdit:De,isUpdating:Pe,contentClass:l}),he(r)&&(0,t.jsx)(ot,{url:he(r)}),(0,t.jsx)(at,{media:a,isEditing:re,editedMedia:ce,setEditedMedia:de,newFiles:me,setNewFiles:ie}),u&&(0,t.jsx)(nt,{poll:u,onVote:F=>js(i,F,h.id)}),n&&(0,t.jsx)("div",{className:"mt-4 overflow-hidden rounded-2xl border border-zinc-200 shadow-sm dark:border-zinc-700",children:(0,t.jsx)(rt,{...n})}),(0,t.jsx)(st,{views:y.views||0,likes:y.likes||0,comments:y.comments||0,isDetail:!0}),(0,t.jsx)(tt,{liked:I,reposted:P,handleLike:R,handleRepost:E,handleCommentClick:()=>document.getElementById("comment-input")?.focus(),handleShareClick:()=>ve(!0),isDetail:!0,isComment:m})]}),be&&(0,t.jsxs)("div",{className:"flex items-center justify-between bg-zinc-50 px-5 py-2 dark:bg-zinc-900/50",children:[(0,t.jsxs)("span",{className:"text-sm text-zinc-500",children:["Replying to"," ",(0,t.jsxs)("span",{className:"font-bold text-violet-600",children:["@",be.handle]})]}),(0,t.jsx)("button",{onClick:()=>xe(null),className:"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200",children:(0,t.jsx)(ae,{size:16})})]}),(0,t.jsx)(pt,{currentUser:h,newComment:Q,setNewComment:pe,handleSubmitComment:yt,loading:G,selectedFiles:ge,setSelectedFiles:_e,isUploading:jt}),(0,t.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:A?(0,t.jsx)("div",{className:"flex justify-center p-8",children:(0,t.jsx)(X,{className:"animate-spin text-violet-500"})}):(0,t.jsxs)(t.Fragment,{children:[L&&$.length>0&&(0,t.jsxs)("button",{onClick:()=>T(),disabled:O,className:"flex w-full items-center justify-center gap-2 py-3 text-sm font-bold text-violet-600 transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[O&&(0,t.jsx)(X,{size:14,className:"animate-spin"}),"View more replies"]}),$.map(F=>(0,t.jsx)(we,{...F,isComment:!0,post_id:i,onReply:Ct,onUserClick:p,currentUser:h,stats:{likes:F.stats?.likes||0,comments:F.stats?.comments||0,reposts:F.stats?.reposts||0},timeAgo:F.timeAgo||F.created_at},F.id))]})}),(0,t.jsx)(Ze,{open:Fe,onOpenChange:se,children:(0,t.jsxs)(Ye,{onClick:F=>F.stopPropagation(),children:[(0,t.jsxs)(Ke,{children:[(0,t.jsx)(Xe,{children:"Are you absolutely sure?"}),(0,t.jsx)(qe,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,t.jsxs)(Ge,{children:[(0,t.jsx)(Je,{onClick:F=>F.stopPropagation(),children:"Cancel"}),(0,t.jsx)(Ve,{onClick:Ae,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]}):(0,t.jsxs)("article",{ref:Re,onClick:o,className:`px-4 transition-all ${m?"py-2 bg-transparent hover:bg-zinc-50/30 dark:hover:bg-zinc-800/20":"py-4 bg-white hover:bg-zinc-50/30 dark:bg-black dark:hover:bg-white/[0.02]"} ${o?"cursor-pointer":""}`,children:[g&&(0,t.jsxs)("div",{className:"mb-2 ml-1 flex items-center space-x-1.5 text-[13px] font-semibold text-zinc-600",children:[(0,t.jsx)(ze,{size:14,className:"text-zinc-500"}),(0,t.jsxs)("span",{className:"flex cursor-pointer items-center text-zinc-700 hover:underline dark:text-zinc-300",onClick:F=>{F.stopPropagation(),p&&p(g.handle)},children:[g.handle," Reposted"]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-x-3",children:[(0,t.jsxs)("div",{className:"flex shrink-0 flex-col items-center self-stretch pt-0.5",children:[(0,t.jsx)("div",{className:"cursor-pointer",onClick:F=>{F.stopPropagation(),p&&p(e.handle)},children:(0,t.jsxs)(ee,{className:`${m?"size-8":"size-10"} border-0 shadow-sm`,children:[(0,t.jsx)(te,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,t.jsx)(Y,{className:"text-xs",children:e.handle[0]?.toUpperCase()})]})}),(!m&&y.comments>0||m&&!z&&y.comments>0)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"mt-2 w-0.5 flex-1 rounded-full bg-zinc-100 dark:bg-zinc-800"}),!m&&(0,t.jsx)(hi,{avatars:c.length>0?c:($||[]).slice(0,3).map(F=>F.user.avatar)})]})]}),(0,t.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col",children:[(0,t.jsx)(it,{user:e,timeAgo:s,community:j,onUserClick:p,isComment:m,actionsMenu:(0,t.jsx)(ct,{id:i,user:e,isCurrentUser:Le,isComment:m,onEdit:()=>K(!0),onDelete:()=>se(!0),addToast:_,trigger:(0,t.jsx)("button",{"aria-label":"More options",className:"rounded-full p-2 text-zinc-500 transition-colors hover:bg-zinc-100 group-hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:group-hover:bg-zinc-800/50",children:(0,t.jsx)(ke,{size:18})})})}),(0,t.jsx)(lt,{content:r,isEditing:re,editedContent:J,setEditedContent:oe,onCancelEdit:()=>{K(!1),oe(r),de(a||[]),ie([])},onSaveEdit:De,isUpdating:Pe,contentClass:l}),he(r)&&(0,t.jsx)(ot,{url:he(r)}),(0,t.jsx)(at,{media:a,isEditing:re,editedMedia:ce,setEditedMedia:de,newFiles:me,setNewFiles:ie}),u&&(0,t.jsx)(nt,{poll:u}),n&&(0,t.jsx)("div",{className:"mt-3 overflow-hidden rounded-2xl border border-zinc-200 shadow-sm transition-all hover:bg-zinc-50 dark:border-zinc-800 dark:hover:bg-zinc-900",onClick:F=>{F.stopPropagation(),C(`/p/${n.id}`)},children:(0,t.jsx)(rt,{...n})}),(0,t.jsx)(tt,{liked:I,reposted:P,handleLike:R,handleRepost:E,handleCommentClick:F=>{F?.stopPropagation(),w?w(e.handle,i):o&&o()},handleShareClick:F=>{F?.stopPropagation(),ve(!0)},isComment:m}),(0,t.jsx)(st,{views:y.views||0,likes:y.likes||0,comments:y.comments||0,isComment:m,onRepliesClick:()=>{je?Me(!1):wt()}}),je&&(0,t.jsxs)("div",{className:"relative mt-2 space-y-0",children:[(0,t.jsx)("div",{className:"absolute left-[19px] top-0 bottom-4 w-0.5 bg-zinc-100 dark:bg-zinc-800"}),Nt?(0,t.jsx)("div",{className:"flex py-4 pl-12",children:(0,t.jsx)(X,{size:18,className:"animate-spin text-violet-500"})}):(0,t.jsx)("div",{className:"flex flex-col",children:kt.map(F=>(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute left-[19px] top-5 h-0.5 w-4 bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsx)("div",{className:"pl-6",children:(0,t.jsx)(we,{...F,isComment:!0,post_id:k||i,onReply:w,onUserClick:p,currentUser:h,stats:{likes:F.stats?.likes||0,comments:F.stats?.comments||0,reposts:F.stats?.reposts||0},timeAgo:F.timeAgo||F.created_at})})]},F.id))})]})]})]}),(0,t.jsx)(bt,{isOpen:zt,onClose:()=>ve(!1),url:`${window.location.origin}/p/${i}`,title:"Share Post"}),(0,t.jsx)(Ze,{open:Fe,onOpenChange:se,children:(0,t.jsxs)(Ye,{onClick:F=>F.stopPropagation(),children:[(0,t.jsxs)(Ke,{children:[(0,t.jsx)(Xe,{children:"Are you absolutely sure?"}),(0,t.jsx)(qe,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,t.jsxs)(Ge,{children:[(0,t.jsx)(Je,{onClick:F=>F.stopPropagation(),children:"Cancel"}),(0,t.jsx)(Ve,{onClick:Ae,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]})};function fi(i,e){const s=!i.media&&!e.media||i.media?.length===e.media?.length&&i.media?.every((l,a)=>l.url===e.media?.[a].url),r=i.repostedBy?.handle===e.repostedBy?.handle;return i.id===e.id&&i.content===e.content&&i.timeAgo===e.timeAgo&&i.user.id===e.user.id&&i.user.avatar===e.user.avatar&&i.stats.likes===e.stats.likes&&i.stats.comments===e.stats.comments&&i.stats.reposts===e.stats.reposts&&i.currentUser?.id===e.currentUser?.id&&!!s&&!!r}var ui=N.memo(we,fi);function pi(i){return i.stopPropagation()}var gi=({isOpen:i,onClose:e,url:s,title:r="Share"})=>{const[l,a]=(0,N.useState)(!1),[n,d]=(0,N.useState)(""),[o,g]=(0,N.useState)([]),[p,h]=(0,N.useState)(!1),[u,v]=(0,N.useState)(null),{addToast:f}=ye(),{currentUser:x}=ht(),b=(0,N.useCallback)(async()=>{if(x){h(!0);try{g((await Oe(x.id)).map(c=>c.user).filter(c=>c!==null).slice(0,5))}catch(c){console.error("Failed to fetch conversations:",c)}finally{h(!1)}}},[x]);(0,N.useEffect)(()=>{i&&x?b():(d(""),g([]))},[i,x,b]);const m=(0,N.useCallback)(async()=>{if(x){h(!0);try{g((await Oe(x.id)).map(c=>c.user).filter(c=>c!==null&&(c.name?.toLowerCase().includes(n.toLowerCase())||c.handle.toLowerCase().includes(n.toLowerCase()))))}catch(c){console.error("Search failed:",c)}finally{h(!1)}}},[n,x]);(0,N.useEffect)(()=>{const c=setTimeout(()=>{n.trim()&&i?m():!n.trim()&&i&&b()},300);return()=>clearTimeout(c)},[n,i,m,b]);const w=async c=>{c&&c.stopPropagation();try{await navigator.clipboard.writeText(s),a(!0),f("Link copied to clipboard!","success"),setTimeout(()=>a(!1),2e3)}catch(C){console.error("Failed to copy:",C),f("Failed to copy link","error")}},j=async c=>{if(x){v(c.id);try{await os(await ys(x.id,c.id),x.id,s,"text"),f(`Sent to ${c.name||c.handle}!`,"success")}catch(C){console.error("Failed to send message:",C),f("Failed to send message","error")}finally{v(null)}}},z=[{name:"X",icon:Dt,color:"bg-black text-white",href:`https://twitter.com/intent/tweet?url=${encodeURIComponent(s)}`},{name:"Facebook",icon:Et,color:"bg-[#1877F2] text-white",href:`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(s)}`},{name:"LinkedIn",icon:Yt,color:"bg-[#0A66C2] text-white",href:`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(s)}`},{name:"WhatsApp",icon:Jt,color:"bg-[#25D366] text-white",href:`https://wa.me/?text=${encodeURIComponent(s)}`},{name:"Email",icon:Vt,color:"bg-zinc-600 text-white",href:`mailto:?body=${encodeURIComponent(s)}`}],k=async()=>{if(navigator.share)try{await navigator.share({title:r,url:s})}catch(c){c.name!=="AbortError"&&console.error("Native share failed:",c)}else w()};return(0,t.jsx)(ft,{isOpen:i,onClose:e,title:r,className:"max-w-[420px] !p-0 overflow-hidden",children:(0,t.jsxs)("div",{className:"flex h-full flex-col bg-white dark:bg-zinc-900",children:[(0,t.jsx)("div",{className:"px-5 pb-2 pt-4",children:(0,t.jsxs)("div",{className:"group relative",children:[(0,t.jsx)(Bt,{className:"absolute left-3 top-1/2 size-4 -translate-y-1/2 text-zinc-400 transition-colors group-focus-within:text-violet-500"}),(0,t.jsx)("input",{type:"text",placeholder:"Search people...",value:n,onChange:c=>d(c.target.value),className:"w-full rounded-xl border-none bg-zinc-100 py-2.5 pl-10 pr-4 text-sm transition-all focus:ring-2 focus:ring-violet-500/20 outline-none dark:bg-zinc-800/50"})]})}),(0,t.jsx)("div",{className:"no-scrollbar flex min-h-[100px] items-center gap-4 overflow-x-auto px-5 py-4",children:p?(0,t.jsx)("div",{className:"flex flex-1 justify-center",children:(0,t.jsx)(X,{size:24,className:"animate-spin text-zinc-400"})}):o.length>0?o.map(c=>(0,t.jsxs)("button",{onClick:()=>j(c),disabled:u!==null,className:"group flex shrink-0 flex-col items-center gap-1.5 disabled:opacity-50",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"size-14 overflow-hidden rounded-full border-2 border-white shadow-sm transition-transform group-hover:scale-105 bg-zinc-100 dark:bg-zinc-800 dark:border-zinc-900",children:(0,t.jsx)("img",{src:c.avatar||`https://i.pravatar.cc/150?u=${c.id}`,alt:c.handle,className:"size-full object-cover"})}),u===c.id&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center rounded-full bg-black/40",children:(0,t.jsx)(X,{size:16,className:"animate-spin text-white"})})]}),(0,t.jsx)("span",{className:"max-w-[60px] truncate text-[10px] font-medium text-zinc-500 dark:text-zinc-400",children:c.name?.split(" ")[0]||c.handle})]},c.id)):(0,t.jsx)("div",{className:"flex-1 py-2 text-center",children:(0,t.jsx)("span",{className:"text-xs text-zinc-400",children:"No people found"})})}),(0,t.jsx)("div",{className:"mx-5 h-px bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsxs)("div",{className:"grid grid-cols-5 gap-2 px-5 py-6",children:[z.map(c=>(0,t.jsxs)("a",{href:c.href,target:"_blank",rel:"noopener noreferrer",className:"group flex flex-col items-center gap-2",children:[(0,t.jsx)("div",{className:`size-12 ${c.color} flex items-center justify-center rounded-2xl shadow-md transition-all group-hover:-translate-y-1 group-hover:scale-110 group-hover:shadow-lg`,children:(0,t.jsx)(c.icon,{size:20,strokeWidth:2.5})}),(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-tighter text-zinc-500 dark:text-zinc-400",children:c.name})]},c.name)),(0,t.jsxs)("button",{onClick:k,className:"group flex flex-col items-center gap-2",children:[(0,t.jsx)("div",{className:"flex size-12 items-center justify-center rounded-2xl border border-zinc-200 bg-zinc-100 text-zinc-600 shadow-sm transition-all group-hover:-translate-y-1 group-hover:scale-110 dark:border-zinc-700 dark:bg-zinc-800 dark:text-zinc-300",children:(0,t.jsx)(ke,{size:20,strokeWidth:2.5})}),(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-tighter text-zinc-500 dark:text-zinc-400",children:"More"})]})]}),(0,t.jsx)("div",{className:"px-5 pb-6",children:(0,t.jsxs)("div",{className:"group relative",children:[(0,t.jsx)("input",{type:"text",readOnly:!0,value:s,className:"w-full rounded-2xl border border-zinc-200 bg-zinc-50 py-3.5 pl-4 pr-14 text-sm font-medium transition-colors focus:outline-none group-hover:border-zinc-300 dark:border-zinc-800 dark:bg-zinc-950 dark:group-hover:border-zinc-700"}),(0,t.jsx)("button",{onClick:w,className:`absolute right-1.5 top-1/2 flex -translate-y-1/2 items-center gap-2 rounded-xl h-10 px-4 text-xs font-bold shadow-sm transition-all active:scale-95 ${l?"bg-emerald-500 text-white":"bg-zinc-900 text-white hover:opacity-90 dark:bg-white dark:text-zinc-900"}`,children:l?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Ht,{size:14,strokeWidth:3}),(0,t.jsx)("span",{children:"Copied"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Wt,{size:14,strokeWidth:3}),(0,t.jsx)("span",{children:"Copy"})]})})]})}),(0,t.jsx)("div",{className:"px-5 pb-5",children:(0,t.jsxs)("button",{onClick:e,className:"group relative flex w-full items-center justify-center overflow-hidden rounded-2xl bg-zinc-900 py-4 font-bold text-white transition-all hover:shadow-xl hover:shadow-zinc-900/10 active:scale-[0.98] dark:bg-white dark:text-zinc-900 dark:hover:shadow-white/10",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-zinc-500 to-zinc-600 opacity-0 transition-opacity duration-300 group-hover:opacity-100"}),(0,t.jsx)("div",{className:"relative flex items-center gap-2",children:(0,t.jsx)("span",{children:"Close"})})]})})]})})},bt=gi,vi=N.lazy(()=>mt(()=>import("./dist-CYPYLHr8.js"),__vite__mapDeps([13,1,2,3,4,5])).then(i=>({default:i.Plyr}))),bi=N.memo(({reel:i,isActive:e,isMuted:s})=>{const r=ne(),{currentUser:l}=ht(),{addToast:a}=ye(),n=(0,N.useRef)(null),[d,o]=(0,N.useState)(!1),[g,p]=(0,N.useState)(!1),[h,u]=(0,N.useState)(!1),[v,f]=(0,N.useState)(null),[x,b]=(0,N.useState)(!1),[m,w]=(0,N.useState)(i.stats?.likes||0),[j,z]=(0,N.useState)(!1),[k,c]=(0,N.useState)(0),C=(0,N.useRef)(null),_=(0,N.useMemo)(()=>Array.isArray(i.media)?i.media[0]?.src||i.media[0]?.url:i.media?.src||i.media?.url||i.url,[i.media,i.url]);(0,N.useEffect)(()=>{let S;const $=n.current?.plyr;return $&&(e?S=setTimeout(()=>{typeof $.play=="function"&&$.play().catch(()=>{$&&($.muted=!0,$.play().catch(()=>{}))})},100):typeof $.pause=="function"&&$.pause()),()=>{S&&clearTimeout(S)}},[e]),(0,N.useEffect)(()=>{if(!l?.id||!e)return;(async()=>{try{const[$,T]=await Promise.all([cs(i.id,l.id),us(l.id,i.user?.id)]);b($),z(T)}catch($){console.error("Failed to check interaction status:",$)}})()},[i.id,l?.id,e,i.user?.id]),(0,N.useEffect)(()=>{n.current?.plyr&&(n.current.plyr.muted=s)},[s]),(0,N.useEffect)(()=>{const S=n.current?.plyr;if(!S||!e)return;const $=()=>{const T=S.currentTime,L=S.duration;L>0&&c(T/L*100)};if(typeof S.on=="function")return S.on("timeupdate",$),()=>{typeof S.off=="function"&&S.off("timeupdate",$)}},[e]),(0,N.useEffect)(()=>()=>{C.current&&clearTimeout(C.current)},[]);const I=S=>{const $=S.target;$.closest("button")||$.closest("a")||$.closest(".plyr__controls")||(C.current?(clearTimeout(C.current),C.current=null,y()):C.current=setTimeout(()=>{C.current=null,P()},250))},P=()=>{const S=n.current?.plyr;S&&(S.paused?(S.play().catch(()=>{}),f("play")):(S.pause(),f("pause")),setTimeout(()=>f(null),800))},y=async()=>{if(l&&(o(!0),setTimeout(()=>o(!1),1e3),!x)){b(!0),w(S=>S+1);try{await He(i.id,l.id)}catch{b(!1),w(S=>S-1)}}},M=async S=>{if(S.stopPropagation(),!l)return;const $=!x;b($),w(T=>$?T+1:T-1);try{await He(i.id,l.id)}catch{b(!$),w(T=>$?T-1:T+1)}},R=async S=>{if(S.stopPropagation(),!l)return;const $=!j;z($);try{await ks(l.id,i.user?.id)}catch{z(!$)}},E=S=>{S.stopPropagation(),u(!0)},D=(0,N.useMemo)(()=>({source:{type:"video",sources:[{src:_,type:"video/mp4"}]},options:{controls:[],loop:{active:!0},clickToPlay:!1,ratio:"9:16"}}),[_]);return(0,t.jsxs)("div",{"data-id":i.id,className:"reel-item relative flex h-[100dvh] w-full snap-start items-center justify-center overflow-hidden bg-black cursor-pointer",onClick:I,children:[(0,t.jsxs)("div",{className:"relative flex h-full w-full max-w-[450px] items-center justify-center",children:[(0,t.jsx)("div",{className:"w-full",children:(0,t.jsx)(N.Suspense,{fallback:(0,t.jsx)("div",{className:"aspect-[9/16] w-full bg-zinc-900 animate-pulse"}),children:(0,t.jsx)(vi,{ref:n,...D})})}),d&&(0,t.jsx)("div",{className:"pointer-events-none absolute inset-0 z-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-in zoom-in-50 fade-out fill-mode-forwards duration-500",children:(0,t.jsx)(fe,{size:120,fill:"white",className:"scale-125 text-white drop-shadow-[0_0_30px_rgba(255,255,255,0.4)]"})})}),v&&(0,t.jsx)("div",{className:"pointer-events-none absolute inset-0 z-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-in fade-in zoom-in-90 scale-100 animate-out zoom-out-110 fade-out fill-mode-forwards duration-500",children:(0,t.jsx)("div",{className:"rounded-full border border-white/20 bg-white/10 p-8 shadow-2xl backdrop-blur-md",children:v==="play"?(0,t.jsx)(Qt,{size:50,fill:"white",className:"ml-1.5 text-white"}):(0,t.jsx)(qt,{size:50,fill:"white",className:"text-white"})})})}),(0,t.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-black/60"}),(0,t.jsxs)("div",{className:"pointer-events-none absolute bottom-6 left-4 right-16 text-white",children:[(0,t.jsxs)("div",{className:"pointer-events-auto mb-3 flex items-center gap-2",children:[(0,t.jsxs)(Pt,{to:`/u/${i.user?.handle}`,className:"flex items-center gap-2 transition-opacity hover:opacity-80",onClick:S=>S.stopPropagation(),children:[(0,t.jsxs)(ee,{className:"size-10 border-2 border-white",children:[(0,t.jsx)(te,{src:i.user?.avatar,alt:i.user?.handle,className:"object-cover"}),(0,t.jsx)(Y,{children:i.user?.handle?.[0]?.toUpperCase()})]}),(0,t.jsxs)("span",{className:"font-bold",children:["@",i.user?.handle]})]}),l?.id!==i.user?.id&&(0,t.jsx)("button",{className:`ml-2 flex items-center gap-1.5 rounded-full px-3 py-1.5 text-xs font-bold transition-all active:scale-95 ${j?"border border-white/50 bg-transparent text-white":"bg-white text-black hover:bg-zinc-200"}`,onClick:R,children:j?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(gs,{size:14}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Following"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(xs,{size:14}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Follow"})]})})]}),(0,t.jsx)(Ce,{options:{...$e,render:({attributes:S,content:$})=>{const{href:T,...L}=S,O=!T.startsWith("/")&&(T.startsWith("http")||T.startsWith("www"));return T.startsWith("/u/")||T.startsWith("/tags/")||T.startsWith("/c/")||T.startsWith("/explore")?(0,t.jsx)("span",{...L,className:"cursor-pointer font-bold text-white hover:underline",onClick:A=>{A.stopPropagation(),r(T)},children:$},$):(0,t.jsx)("a",{href:T,...L,className:"text-white hover:underline",target:O?"_blank":void 0,rel:O?"noopener noreferrer":void 0,onClick:A=>A.stopPropagation(),children:$},$)}},children:(0,t.jsx)("p",{className:"mb-3 line-clamp-2 text-sm",children:i.content})}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs opacity-90",children:[(0,t.jsx)(Gt,{size:14,className:"animate-spin-slow"}),(0,t.jsxs)("span",{children:["Original Audio - ",i.user?.handle]})]})]}),(0,t.jsxs)("div",{className:"absolute bottom-6 right-2 z-10 flex flex-col items-center gap-6",children:[(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)("button",{className:`rounded-full p-3 backdrop-blur-md transition-all active:scale-90 ${x?"bg-rose-500/20 text-rose-500":"bg-zinc-800/50 text-white hover:bg-zinc-700"}`,onClick:M,children:(0,t.jsx)(fe,{size:28,fill:x?"currentColor":"none"})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:m})]}),(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)("button",{className:"rounded-full bg-zinc-800/50 p-3 text-white backdrop-blur-md transition-colors hover:bg-zinc-700 active:scale-90",onClick:S=>{S.stopPropagation(),p(!0)},children:(0,t.jsx)(ut,{size:28})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:i.stats?.comments||0})]}),(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)("button",{className:"rounded-full bg-zinc-800/50 p-3 text-white backdrop-blur-md transition-colors hover:bg-zinc-700 active:scale-90",onClick:E,children:(0,t.jsx)(ue,{size:28})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:i.stats?.shares||0})]})]}),(0,t.jsx)("div",{className:"absolute bottom-0 left-0 z-50 h-[3px] w-full bg-white/20",children:(0,t.jsx)("div",{className:"h-full bg-white shadow-[0_0_8px_rgba(255,255,255,0.8)] transition-all duration-100 ease-linear",style:{width:`${k}%`}})})]}),(0,t.jsx)(zi,{isOpen:g,onClose:()=>p(!1),reelId:i.id,currentUser:l,showToast:a}),(0,t.jsx)(bt,{isOpen:h,onClose:()=>u(!1),url:`${window.location.origin}/r/${i.id}`,title:"Share Reel"})]})},(i,e)=>i.isActive===e.isActive&&i.reel.id===e.reel.id&&i.isMuted===e.isMuted),Fi=bi,ji=({isOpen:i,onClose:e,reelId:s,currentUser:r,showToast:l})=>{const[a,n]=(0,N.useState)([]),[d,o]=(0,N.useState)(!1),[g,p]=(0,N.useState)(!1),[h,u]=(0,N.useState)(""),[v,f]=(0,N.useState)([]),[x,b]=(0,N.useState)(!1),[m,w]=(0,N.useState)(!0),[j,z]=(0,N.useState)(!1),[k,c]=(0,N.useState)(null),C=(0,N.useRef)(a);(0,N.useEffect)(()=>{C.current=a},[a]);const _=(0,N.useCallback)(async(P=!1)=>{if(s){P?z(!0):o(!0);try{const y=C.current,M=await bs(s,P&&y.length>0?y[y.length-1].created_at:null,10);M.length<10?w(!1):w(!0),n(P?R=>[...R,...M]:M)}catch(y){console.error("Failed to load comments:",y),l&&l("Failed to load comments","error")}finally{o(!1),z(!1)}}},[s,l]);(0,N.useEffect)(()=>{i&&s?_():(n([]),w(!0))},[i,s,_]);const I=async P=>{if(P.preventDefault(),!(!h.trim()&&v.length===0||!r)){p(!0),b(!0);try{const y=[];for(const M of v){const R=await Ne(M);y.push(R)}await rs(s,r.id,h,y,k?.id),u(""),f([]),c(null),l&&l("Reply posted!"),_()}catch(y){console.error("Failed to post comment:",y),l&&l("Failed to post reply.","error")}finally{p(!1),b(!1)}}};return(0,t.jsx)(ft,{isOpen:i,onClose:e,title:"Comments",className:"max-sm:h-[95dvh] h-[85vh] overflow-hidden !p-0 sm:max-w-xl",children:(0,t.jsxs)("div",{className:"flex h-full flex-col overflow-hidden bg-white dark:bg-zinc-900",children:[(0,t.jsx)("div",{className:"mx-auto my-3 h-1.5 w-12 shrink-0 rounded-full bg-zinc-200 dark:bg-zinc-800 sm:hidden"}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto scroll-smooth scrollbar-thin scrollbar-thumb-zinc-200 dark:scrollbar-thumb-zinc-800",children:d?(0,t.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,t.jsx)(X,{className:"animate-spin text-violet-500",size:32})}):a.length>0?(0,t.jsxs)("div",{className:"flex flex-col",children:[a.map(P=>(0,t.jsx)(ui,{...P,isComment:!0,post_id:s,currentUser:r,showToast:l,onReply:(y,M)=>{c(M?{handle:y,id:M}:null),u(R=>R.includes(`@${y}`)?R:R+`@${y} `)},onDelete:y=>n(M=>M.filter(R=>R.id!==y)),onUpdate:(y,M,R)=>n(E=>E.map(D=>D.id===y?{...D,content:M,media:R}:D))},P.id)),m&&(0,t.jsxs)("button",{onClick:()=>_(!0),disabled:j,className:"flex w-full items-center justify-center gap-2 py-6 text-sm font-bold text-violet-600 transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[j&&(0,t.jsx)(X,{size:16,className:"animate-spin"}),"View more replies"]})]}):(0,t.jsxs)("div",{className:"flex h-full min-h-[300px] flex-col items-center justify-center p-8 text-center text-zinc-500",children:[(0,t.jsx)("div",{className:"mb-4 flex size-16 items-center justify-center rounded-full bg-zinc-100 dark:bg-zinc-900",children:(0,t.jsx)(xt,{size:32,className:"text-zinc-400"})}),(0,t.jsx)("p",{className:"text-lg font-bold dark:text-zinc-300",children:"No comments yet"}),(0,t.jsx)("p",{className:"text-sm dark:text-zinc-500",children:"Be the first to share what you think!"})]})}),(0,t.jsxs)("div",{className:"shrink-0 border-t border-zinc-100 bg-white pb-safe dark:border-zinc-800 dark:bg-zinc-900",children:[k&&(0,t.jsxs)("div",{className:"flex items-center justify-between border-b border-zinc-50 bg-zinc-50/50 px-4 py-2 dark:border-zinc-800/50 dark:bg-zinc-900/50",children:[(0,t.jsxs)("span",{className:"text-xs text-zinc-500",children:["Replying to"," ",(0,t.jsxs)("span",{className:"font-bold text-violet-600",children:["@",k.handle]})]}),(0,t.jsx)("button",{onClick:()=>c(null),className:"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200",children:(0,t.jsx)(ae,{size:14})})]}),(0,t.jsx)(pt,{currentUser:r,newComment:h,setNewComment:u,handleSubmitComment:I,loading:g,selectedFiles:v,setSelectedFiles:f,isUploading:x})]})]})})},zi=ji,Pi=W();export{ui as n,Fi as t};
