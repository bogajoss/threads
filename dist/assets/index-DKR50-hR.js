import{n as Zt}from"./rolldown-runtime-2JzG8er9.js";import{$ as Js,$t as Xs,A as Ys,An as Gs,At as Zs,B as ea,Bn as ta,Bt as Nt,C as sa,Ct as aa,D as na,Dt as dt,E as ia,Et as es,F as la,Fn as ra,Ft as Tt,G as oa,Gt as ts,H as ca,Ht as ss,I as da,In as mt,It as ma,J as ua,Jt as as,K as fa,Kt as ns,L as xa,Ln as je,Lt as rt,M as ha,Mn as qt,Mt as is,N as pa,Nn as ba,Nt as _t,O as ga,Ot as oe,P as va,Pn as ye,Pt as st,Q as ja,Qt as Ct,R as ya,Rn as ut,Rt as wa,S as ls,St as Na,T as za,Tt as zt,U as ka,Ut as _a,V as Ca,Vt as Sa,W as $a,Wt as Pa,X as Ma,Xt as Fa,Y as Ra,Yt as La,Z as Ia,Zt as Ea,_ as Ta,_t as gt,a as Qe,an as rs,at as os,b as qa,bt as cs,c as Aa,cn as ft,ct as Oa,d as Da,dt as ds,en as vt,et as Ba,f as Wa,ft as Ha,g as Qa,gt as Ua,h as Va,ht as Ka,i as Ja,in as K,it as Xa,j as Ya,jn as ms,jt as Ga,k as Za,kn as en,kt as us,l as tn,ln as sn,lt as fs,m as an,mt as xs,n as nn,nn as ln,nt as Ke,o as rn,on as Oe,ot as on,p as cn,pt as dn,q as mn,qt as hs,r as un,rn as jt,rt as fn,s as xn,sn as hn,st as pn,t as bn,tn as Ye,tt as we,u as gn,ut as vn,v as jn,vt as De,w as yn,wt as wn,x as Nn,xt as zn,y as kn,yt as ps,z as _n,zn as Cn,zt as bs}from"./framework-Bt6-NzyK.js";import{t as Sn}from"./query-CzoKTCcU.js";import{t as $n}from"./database-DCcU4ujN.js";import{n as Pn,r as Mn,t as Fn}from"./vendor-DyYlx6SC.js";/* empty css                 */(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const r of l.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function a(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(i){if(i.ep)return;i.ep=!0;const l=a(i);fetch(i.href,l)}})();var Rn=Cn(),b=Zt(ta(),1),Ln="https://dbkcedktqhueqnulnosq.supabase.co",In="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRia2NlZGt0cWh1ZXFudWxub3NxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg5NzE1NTQsImV4cCI6MjA4NDU0NzU1NH0.m_Tv-H7o5mL1Nac6TH-S1JkS1x7ZN1AK_4Mt1hZlkvU";const O=$n(Ln,In),Be=s=>s?{id:s.id,handle:s.username,name:s.display_name,avatar:s.avatar_url||"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm",cover:s.cover_url||"https://systemadminbd.com/uploads/675346dd55e0c7.43939630.png",verified:s.is_verified,bio:s.bio,location:s.location,website:s.website,follower_count:s.follower_count||0,following_count:s.following_count||0,lastSeen:s.last_seen_at}:null,at=s=>{if(!s)return null;const e=s.reposter_id||s.reposter_data?.id||s.reposted_by?.id,a=s.feed_id||(e?`${s.id}-${e}`:`${s.id}-orig`);return{...s,feed_id:a,stats:{comments:s.comments_count||0,likes:s.likes_count||0,mirrors:s.mirrors_count||0},user:Be(s.author_data||s.user),community:s.community_data||s.communities,repostedBy:s.reposter_data?{handle:s.reposter_data.username,name:s.reposter_data.display_name,id:s.reposter_data.id}:s.reposted_by?{handle:s.reposted_by.username,name:s.reposted_by.display_name,id:s.reposted_by.id}:null,timeAgo:new Date(s.created_at).toLocaleDateString()}},St=s=>s?{...s,stats:{likes:s.likes_count||0},user:Be(s.user),timeAgo:new Date(s.created_at).toLocaleDateString()}:null,En=s=>s?{...s,user:s.actor?.username,avatar:s.actor?.avatar_url||"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm"}:null,gs=s=>s?{...s,media:s.media_url,user:Be(s.user)}:null,Tn=async(s,e=10)=>{const{data:a,error:n}=await O.from("users").select("*").or(`username.ilike.%${s}%,display_name.ilike.%${s}%`).limit(e);if(n)throw n;return a.map(Be)},vs=async(s,e="id")=>{const{data:a,error:n}=await O.from("users").select("*").eq(e==="id"?"id":"username",s).maybeSingle();if(n)throw n;return a?Be(a):null},qn=s=>vs(s,"username"),Ue=async s=>{if(!s)return;const{error:e}=await O.from("users").update({last_seen_at:new Date().toISOString()}).eq("id",s);e&&console.error("Error updating last seen:",e)},An=async(s,e)=>{const a={display_name:e.name,username:e.handle,avatar_url:e.avatar,bio:e.bio,cover_url:e.cover,website:e.website,location:e.location};Object.keys(a).forEach(i=>a[i]===void 0&&delete a[i]);const{error:n}=await O.from("users").update(a).eq("id",s);if(n)throw n},On=async(s,e)=>{const{data:a}=await O.from("follows").select("*").eq("follower_id",s).eq("following_id",e).maybeSingle();return a?(await O.from("follows").delete().eq("follower_id",s).eq("following_id",e),!1):(await O.from("follows").insert([{follower_id:s,following_id:e}]),!0)},Dn=async(s,e)=>{if(!s)return!1;const{data:a}=await O.from("follows").select("*").eq("follower_id",s).eq("following_id",e).maybeSingle();return!!a},Bn=async(s,e=null,a=10)=>{let n=O.from("follows").select(`
      created_at,
      user:users!follower_id (
        id,
        username,
        display_name,
        avatar_url,
        is_verified,
        bio
      )
    `).eq("following_id",s).order("created_at",{ascending:!1}).limit(a);e&&(n=n.lt("created_at",e));const{data:i,error:l}=await n;if(l)throw l;return i.map(r=>({...Be(r.user),followed_at:r.created_at}))},Wn=async(s,e=null,a=10)=>{let n=O.from("follows").select(`
      created_at,
      user:users!following_id (
        id,
        username,
        display_name,
        avatar_url,
        is_verified,
        bio
      )
    `).eq("follower_id",s).order("created_at",{ascending:!1}).limit(a);e&&(n=n.lt("created_at",e));const{data:i,error:l}=await n;if(l)throw l;return i.map(r=>({...Be(r.user),followed_at:r.created_at}))},Hn=async s=>{const{data:e,error:a}=await O.from("users").select("follower_count, following_count").eq("id",s).maybeSingle();return a||!e?{followers:0,following:0}:{followers:e.follower_count||0,following:e.following_count||0}},Qn=async(s=null,e=10)=>{let a=O.from("unified_posts").select("*").order("sort_timestamp",{ascending:!1}).limit(e);s&&(a=a.lt("sort_timestamp",s));const{data:n,error:i}=await a;if(i)throw i;return n.map(at)},Un=async s=>{const{data:e,error:a}=await O.from("posts").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified,
                bio,
                location,
                website,
                follower_count,
                following_count
            ),
            communities (
                id,
                handle,
                name
            ),
            quoted_post:posts!quoted_post_id (
                *,
                user:users!user_id (
                    id,
                    username,
                    display_name,
                    avatar_url,
                    is_verified
                )
            )
        `).eq("id",s).single();if(a)throw a;return at(e)},Vn=async(s,e=null,a=10)=>{let n=O.from("unified_posts").select("*").or(`user_id.eq.${s},reposter_id.eq.${s}`).order("sort_timestamp",{ascending:!1}).limit(a);e&&(n=n.lt("sort_timestamp",e));const{data:i,error:l}=await n;if(l)throw l;return i.map(at)},Kn=async(s,e=null,a=10)=>{let n=O.from("comments").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `).eq("user_id",s).order("created_at",{ascending:!1}).limit(a);e&&(n=n.lt("created_at",e));const{data:i,error:l}=await n;if(l)throw l;return i.map(St)},Jn=async({content:s,media:e=[],type:a="text",userId:n,poll:i=null,parentId:l=null})=>{const{data:r,error:o}=await O.from("posts").insert([{user_id:n,content:s,media:e,type:a,poll:i,parent_id:l}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `);if(o)throw o;return at(r[0])},Xn=async s=>{const{error:e}=await O.from("posts").delete().eq("id",s);if(e)throw e},Yn=async(s,e)=>{const{error:a}=await O.from("posts").update(e).eq("id",s);if(a)throw a},Gn=async(s,e=null,a=10)=>{let n=O.from("comments").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `).eq("post_id",s).order("created_at",{ascending:!0}).limit(a);e&&(n=n.gt("created_at",e));const{data:i,error:l}=await n;if(l)throw l;return i.map(St)},Zn=async(s,e,a,n=[])=>{const{data:i,error:l}=await O.from("comments").insert([{post_id:s,user_id:e,content:a,media:n}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `);if(l)throw l;return St(i[0])},ei=async(s,e)=>{const{data:a}=await O.from("likes").select("*").eq("post_id",s).eq("user_id",e).maybeSingle();return a?(await O.from("likes").delete().eq("post_id",s).eq("user_id",e),!1):(await O.from("likes").insert([{post_id:s,user_id:e}]),!0)},ti=async(s,e)=>{if(!e)return!1;const{data:a}=await O.from("likes").select("*").eq("post_id",s).eq("user_id",e).maybeSingle();return!!a},si=async(s,e)=>{const{data:a}=await O.from("reposts").select("*").eq("post_id",s).eq("user_id",e).maybeSingle();return a?(await O.from("reposts").delete().eq("post_id",s).eq("user_id",e),!1):(await O.from("reposts").insert([{post_id:s,user_id:e}]),!0)},ai=async(s,e)=>{if(!e)return!1;const{data:a}=await O.from("reposts").select("*").eq("post_id",s).eq("user_id",e).maybeSingle();return!!a},js=async(s,e)=>{const{data:a}=await O.from("conversation_participants").select("conversation_id").eq("user_id",s),n=a.map(o=>o.conversation_id),{data:i}=await O.from("conversation_participants").select("conversation_id").eq("user_id",e).in("conversation_id",n).maybeSingle();if(i)return i.conversation_id;const{data:l,error:r}=await O.from("conversations").insert([{}]).select().single();if(r)throw r;return await O.from("conversation_participants").insert([{conversation_id:l.id,user_id:s},{conversation_id:l.id,user_id:e}]),l.id},ni=async s=>{if(!s)return 0;const{data:e}=await O.from("conversation_participants").select("conversation_id").eq("user_id",s),a=e?.map(l=>l.conversation_id)||[];if(a.length===0)return 0;const{count:n,error:i}=await O.from("messages").select("*",{count:"exact",head:!0}).eq("is_read",!1).neq("sender_id",s).in("conversation_id",a);if(i)throw i;return n||0},ii=async(s,e)=>{if(!s||!e)return;const{error:a}=await O.from("messages").update({is_read:!0}).eq("conversation_id",s).neq("sender_id",e).eq("is_read",!1);if(a)throw a},li=async s=>{if(!s)return[];const{data:e,error:a}=await O.from("conversation_participants").select(`
            conversation:conversations (
                id,
                last_message_at,
                last_message_content,
                participants:conversation_participants (
                    user:users (
                        id,
                        username,
                        display_name,
                        avatar_url
                    )
                ),
                messages (
                    id,
                    is_read,
                    sender_id
                )
            )
        `).eq("user_id",s);if(a)throw a;return e.map(n=>{const i=n.conversation,l=i.participants.find(o=>o.user?.id!==s)||i.participants[0],r=i.messages?.filter(o=>!o.is_read&&o.sender_id!==s).length||0;return{id:i.id,user:Be(l?.user),lastMessage:i.last_message_content||"No messages yet",time:i.last_message_at?new Date(i.last_message_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",unread:r}})},ri=async s=>{const{data:e,error:a}=await O.from("messages").select("*").eq("conversation_id",s).order("created_at",{ascending:!0});if(a)throw a;return e},oi=async()=>{const{data:s,error:e}=await O.from("message_reactions").select("*");if(e)throw e;return s||[]},ci=async(s,e,a)=>{const{data:n}=await O.from("message_reactions").select("*").eq("message_id",s).eq("user_id",e).maybeSingle();return n?n.emoji===a?(await O.from("message_reactions").delete().eq("id",n.id),{action:"removed",emoji:a}):(await O.from("message_reactions").update({emoji:a}).eq("id",n.id),{action:"updated",emoji:a}):(await O.from("message_reactions").insert([{message_id:s,user_id:e,emoji:a}]),{action:"added",emoji:a})},di=async(s,e,a,n="text",i=[],l=null)=>{const{data:r,error:o}=await O.from("messages").insert([{conversation_id:s,sender_id:e,content:a,type:n,media:i,reply_to_id:l}]).select();if(o)throw o;return r[0]},mi=async s=>{const{error:e}=await O.from("messages").delete().eq("id",s);if(e)throw e},ui=async(s,e=null,a=10)=>{if(!s)return[];let n=O.from("notifications").select(`
            *,
            actor:users!actor_id (
                username,
                avatar_url
            )
        `).eq("recipient_id",s).order("created_at",{ascending:!1}).limit(a);e&&(n=n.lt("created_at",e));const{data:i,error:l}=await n;if(l)throw l;return i.map(En)},fi=async s=>{const{error:e}=await O.from("notifications").update({is_read:!0}).eq("recipient_id",s).eq("is_read",!1);if(e)throw e},xi=async s=>{if(!s)return 0;const{count:e,error:a}=await O.from("notifications").select("*",{count:"exact",head:!0}).eq("recipient_id",s).eq("is_read",!1);if(a)throw a;return e||0},hi=async()=>{const{data:s,error:e}=await O.from("stories").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `).gt("expires_at",new Date().toISOString()).order("created_at",{ascending:!1});if(e)throw e;return s.map(gs)},pi=async(s,e,a="image")=>{const{data:n,error:i}=await O.from("stories").insert([{user_id:s,media_url:e,type:a}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `);if(i)throw i;return gs(n[0])},xt=s=>s?{id:s.id,handle:s.handle,name:s.name,description:s.description,avatar:s.avatar_url||"https://api.dicebear.com/7.x/identicon/svg?seed=community",cover:s.cover_url||"https://systemadminbd.com/uploads/675346dd55e0c7.43939630.png",membersCount:s.members_count||0,postsCount:s.posts_count||0,isPrivate:s.is_private,createdAt:s.created_at,type:"community"}:null,bi=async(s=null,e=10)=>{let a=O.from("communities").select("*").order("created_at",{ascending:!1}).limit(e);s&&(a=a.lt("created_at",s));const{data:n,error:i}=await a;if(i)throw i;return n.map(xt)},gi=async s=>{const{data:e,error:a}=await O.from("communities").select("*").eq("handle",s).single();if(a)throw a;return xt(e)},vi=async(s,e=null,a=10)=>{let n=O.from("unified_posts").select("*").eq("community_id",s).order("sort_timestamp",{ascending:!1}).limit(a);e&&(n=n.lt("sort_timestamp",e));const{data:i,error:l}=await n;if(l)throw l;return i.map(at)},ys=async(s,e)=>{const{data:a}=await O.from("community_members").select("*").eq("community_id",s).eq("user_id",e).maybeSingle();if(a){const{error:n}=await O.from("community_members").delete().eq("community_id",s).eq("user_id",e);if(n)throw n;return!1}else{const{error:n}=await O.from("community_members").insert([{community_id:s,user_id:e}]);if(n)throw n;return!0}},ji=async(s,e)=>{if(!e)return!1;const{data:a}=await O.from("community_members").select("*").eq("community_id",s).eq("user_id",e).maybeSingle();return!!a},yi=async s=>{if(!s)return[];const{data:e,error:a}=await O.from("community_members").select(`
      communities (*)
    `).eq("user_id",s);if(a)throw a;return e.map(n=>xt(n.communities))},wi=async s=>{const{data:e,error:a}=await O.from("communities").insert([s]).select().single();if(a)throw a;return xt(e)},Ni=async(s,e={})=>{if(!s.type.startsWith("image/"))return s;const a={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0,initialQuality:.8,fileType:"image/webp",...e};try{const n=await Mn(s,a);return console.log(`Original size: ${(s.size/1024/1024).toFixed(2)} MB`),console.log(`Compressed size: ${(n.size/1024/1024).toFixed(2)} MB`),n}catch(n){return console.error("Image compression failed:",n),s}},zi=(s,e=1)=>new Promise((a,n)=>{const i=document.createElement("video");i.preload="metadata",i.src=URL.createObjectURL(s),i.muted=!0,i.playsInline=!0,i.onloadedmetadata=()=>{i.currentTime=e},i.onseeked=()=>{const l=document.createElement("canvas");l.width=i.videoWidth,l.height=i.videoHeight,l.getContext("2d").drawImage(i,0,0,l.width,l.height),l.toBlob(r=>{const o=new File([r],"thumbnail.webp",{type:"image/webp"});URL.revokeObjectURL(i.src),a(o)},"image/webp",.7)},i.onerror=l=>n(l)}),Ie=async(s,e="media",a=null)=>{let n=s,i=s.name.split(".").pop(),l=null;if(s.type.startsWith("image/")&&(n=await Ni(s),i="webp"),s.type.startsWith("video/"))try{a?l=(await Ie(a,e)).url:l=(await Ie(await zi(s),e)).url}catch(m){console.error("Failed to handle video poster:",m)}const r=`${`${crypto.randomUUID()}.${i}`}`,{data:o,error:c}=await O.storage.from(e).upload(r,n);if(c)throw c;const{data:{publicUrl:d}}=O.storage.from(e).getPublicUrl(o.path);return{url:d,poster:l,name:s.name,type:s.type.startsWith("image/")?"image":s.type.startsWith("video/")?"video":"file",size:n.size}},ki=[{tag:"Lens",posts:"0"},{tag:"Web3",posts:"0"},{tag:"Art",posts:"0"}];var t=Zt(sn(),1),ws=(0,b.createContext)();const _i=({children:s})=>{const[e,a]=(0,b.useState)(null),[n,i]=(0,b.useState)(null),[l,r]=(0,b.useState)({}),[o,c]=(0,b.useState)(!0),d=async x=>{try{const g=await vs(x.id);g?(a(g),r(v=>({...v,[g.handle]:g}))):a({id:x.id,email:x.email,name:x.email.split("@")[0],handle:x.email.split("@")[0],avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm",verified:!1})}catch(g){console.error("Error fetching user profile:",g)}finally{c(!1)}};(0,b.useEffect)(()=>{if(!e?.id)return;Ue(e.id);const x=setInterval(()=>Ue(e.id),3e4),g=()=>{document.visibilityState==="visible"&&Ue(e.id)};return window.addEventListener("visibilitychange",g),window.addEventListener("beforeunload",()=>Ue(e.id)),()=>{clearInterval(x),window.removeEventListener("visibilitychange",g),window.removeEventListener("beforeunload",()=>Ue(e.id))}},[e?.id]),(0,b.useEffect)(()=>{O.auth.getSession().then(({data:{session:g}})=>{g?d(g.user):c(!1)});const{data:{subscription:x}}=O.auth.onAuthStateChange((g,v)=>{v?d(v.user):(a(null),c(!1))});return()=>x.unsubscribe()},[]);const m=async({email:x,password:g})=>{const{data:v,error:j}=await O.auth.signInWithPassword({email:x,password:g});if(j)throw j;return i(null),v},u=async({email:x,password:g,username:v,name:j})=>{const{data:{user:N},error:y}=await O.auth.signUp({email:x,password:g,options:{data:{username:v.toLowerCase(),name:j}}});if(y)throw y;return i(null),N},f=async()=>{await O.auth.signOut(),a(null),i(null)},h=async x=>{e&&(await An(e.id,x),await d(e))},p=async x=>{if(l[x])return l[x];const g=await qn(x);return g?(r(v=>({...v,[x]:g})),g):null};return(0,t.jsx)(ws.Provider,{value:{currentUser:e,authMode:n,setAuthMode:i,profiles:l,login:m,signup:u,logout:f,updateProfile:h,getProfileByHandle:p,loading:o},children:!o&&s})},fe=()=>{const s=(0,b.useContext)(ws);if(!s)throw new Error("useAuth must be used within an AuthProvider");return s};var Ci=K(),Ns=(0,b.createContext)();const Si=s=>{const e=(0,Ci.c)(10),{children:a}=s,{currentUser:n}=fe();let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=new Set,e[0]=i):i=e[0];const[l,r]=(0,b.useState)(i);let o;e[1]!==n?(o=()=>{if(!n?.id)return;const f=O.channel("global_presence",{config:{presence:{key:n.id}}});return f.on("presence",{event:"sync"},()=>{const h=f.presenceState(),p=new Set;Object.keys(h).forEach(x=>p.add(x)),r(p)}).subscribe(async h=>{h==="SUBSCRIBED"&&(await f.track({userId:n.id,online_at:new Date().toISOString()}),Ue(n.id))}),()=>{n?.id&&Ue(n.id),O.removeChannel(f),r(new Set)}},e[1]=n,e[2]=o):o=e[2];const c=n?.id;let d;e[3]!==c?(d=[c],e[3]=c,e[4]=d):d=e[4],(0,b.useEffect)(o,d);let m;e[5]!==l?(m={onlineUsers:l},e[5]=l,e[6]=m):m=e[6];let u;return e[7]!==a||e[8]!==m?(u=(0,t.jsx)(Ns.Provider,{value:m,children:a}),e[7]=a,e[8]=m,e[9]=u):u=e[9],u},zs=()=>{const s=(0,b.useContext)(Ns);if(!s)throw new Error("usePresence must be used within a PresenceProvider");return s};var $i=K(),ks=(0,b.createContext)();const Pi=s=>{const e=(0,$i.c)(11),{children:a}=s,[n,i]=(0,b.useState)(Mi);let l,r;e[0]!==n?(l=()=>{localStorage.setItem("theme",n?"dark":"light"),n?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},r=[n],e[0]=n,e[1]=l,e[2]=r):(l=e[1],r=e[2]),(0,b.useEffect)(l,r);let o;e[3]!==n?(o=()=>i(!n),e[3]=n,e[4]=o):o=e[4];const c=o;let d;e[5]!==n||e[6]!==c?(d={darkMode:n,setDarkMode:i,toggleDarkMode:c},e[5]=n,e[6]=c,e[7]=d):d=e[7];let m;return e[8]!==a||e[9]!==d?(m=(0,t.jsx)(ks.Provider,{value:d,children:a}),e[8]=a,e[9]=d,e[10]=m):m=e[10],m},$t=()=>{const s=(0,b.useContext)(ks);if(!s)throw new Error("useTheme must be used within a ThemeProvider");return s};function Mi(){const s=localStorage.getItem("theme");return s==="dark"||!s&&window.matchMedia("(prefers-color-scheme: dark)").matches}var Fi=K(),Ri=s=>{const e=(0,Fi.c)(7);let a;e[0]!==s?({...a}=s,e[0]=s,e[1]=a):a=e[1];const{theme:n}=Ia(),i=n===void 0?"system":n;let l,r;e[2]===Symbol.for("react.memo_cache_sentinel")?(l={success:(0,t.jsx)(ts,{className:"size-4"}),info:(0,t.jsx)(Ga,{className:"size-4"}),warning:(0,t.jsx)(pn,{className:"size-4"}),error:(0,t.jsx)(zn,{className:"size-4"}),loading:(0,t.jsx)(oe,{className:"size-4 animate-spin"})},r={"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)","--border-radius":"var(--radius)"},e[2]=l,e[3]=r):(l=e[2],r=e[3]);let o;return e[4]!==a||e[5]!==i?(o=(0,t.jsx)(ln,{theme:i,className:"toaster group",icons:l,style:r,...a}),e[4]=a,e[5]=i,e[6]=o):o=e[6],o},Li=K(),_s=(0,b.createContext)();const Ii=s=>{const e=(0,Li.c)(4),{children:a}=s,n=Ei;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i={addToast:n},e[0]=i):i=e[0];let l;e[1]===Symbol.for("react.memo_cache_sentinel")?(l=(0,t.jsx)(Ri,{position:"bottom-center",toastOptions:{className:"rounded-full font-bold"}}),e[1]=l):l=e[1];let r;return e[2]!==a?(r=(0,t.jsxs)(_s.Provider,{value:i,children:[a,l]}),e[2]=a,e[3]=r):r=e[3],r},Ce=()=>{const s=(0,b.useContext)(_s);if(!s)throw new Error("useToast must be used within a ToastProvider");return s};function Ei(s,e){const a=e===void 0?"success":e;a==="error"?jt.error(s):a==="info"?jt.info(s):jt.success(s)}var Cs=(0,b.createContext)();const Ti=({children:s})=>{const[e,a]=(0,b.useState)([]),[n,i]=(0,b.useState)(!0),[l,r]=(0,b.useState)(!0),[o,c]=(0,b.useState)(!1),d=(0,b.useRef)(e);(0,b.useEffect)(()=>{d.current=e},[e]);const m=(0,b.useCallback)(async(v=!1)=>{v?c(!0):i(!0);try{const j=d.current,N=await Qn(v&&j.length>0?j[j.length-1].created_at:null,10);N.length<10?r(!1):r(!0),a(v?y=>[...y,...N]:N)}catch(j){console.error("Failed to load posts:",j)}finally{i(!1),c(!1)}},[]),u=()=>{!l||o||m(!0)};(0,b.useEffect)(()=>{m()},[m]);const f=async v=>{const j=await Jn(v);return m(),j},h=async v=>{await Xn(v),a(j=>j.filter(N=>N.id!==v))},p=async(v,j)=>{await Yn(v,j),a(N=>N.map(y=>y.id===v?{...y,...j}:y))},x=v=>e.find(j=>j.id===v),g=(v,j="feed")=>{let N=e.filter(y=>!!(y.user?.handle===v||y.repostedBy&&y.repostedBy.handle===v));return j==="feed"?N.filter(y=>y.parent_id===null):j==="media"?N.filter(y=>y.parent_id===null&&(y.type==="video"||y.type==="image"||y.media?.length>0)):N};return(0,t.jsx)(Cs.Provider,{value:{posts:e,setPosts:a,addPost:f,deletePost:h,updatePost:p,getPostById:x,getUserPosts:g,loading:n,hasMore:l,isFetchingNextPage:o,fetchNextPage:u,refreshPosts:()=>m(!1)},children:s})},ht=()=>{const s=(0,b.useContext)(Cs);if(!s)throw new Error("usePosts must be used within a PostProvider");return s};var qi=K(),Ss=(0,b.createContext)();const Ai=s=>{const e=(0,qi.c)(9),{children:a}=s;let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n={isOpen:!1,images:[],currentIndex:0},e[0]=n):n=e[0];const[i,l]=(0,b.useState)(n);let r;e[1]===Symbol.for("react.memo_cache_sentinel")?(r=(p,x)=>{const g=x===void 0?0:x;l({isOpen:!0,images:Array.isArray(p)?p:[p],currentIndex:g})},e[1]=r):r=e[1];const o=r;let c;e[2]===Symbol.for("react.memo_cache_sentinel")?(c=()=>{l(Oi)},e[2]=c):c=e[2];const d=c;let m;e[3]===Symbol.for("react.memo_cache_sentinel")?(m=p=>{l(x=>({...x,currentIndex:p}))},e[3]=m):m=e[3];const u=m;let f;e[4]!==i?(f={...i,openLightbox:o,closeLightbox:d,setIndex:u},e[4]=i,e[5]=f):f=e[5];let h;return e[6]!==a||e[7]!==f?(h=(0,t.jsx)(Ss.Provider,{value:f,children:a}),e[6]=a,e[7]=f,e[8]=h):h=e[8],h},Pt=()=>{const s=(0,b.useContext)(Ss);if(!s)throw new Error("useLightbox must be used within a LightboxProvider");return s};function Oi(s){return{...s,isOpen:!1}}var Di=K();const $s=s=>{const e=(0,Di.c)(16),a=ft(),n=s?.id;let i;e[0]!==n?(i=["unread_notifications_count",n],e[0]=n,e[1]=i):i=e[1];let l;e[2]!==s?.id?(l=()=>xi(s?.id),e[2]=s?.id,e[3]=l):l=e[3];const r=!!s?.id;let o;e[4]!==i||e[5]!==l||e[6]!==r?(o={queryKey:i,queryFn:l,enabled:r},e[4]=i,e[5]=l,e[6]=r,e[7]=o):o=e[7];const{data:c}=Oe(o),d=c===void 0?0:c;let m;e[8]!==s||e[9]!==a?(m=()=>{if(!s?.id)return;const p=O.channel(`unread_count:${s.id}`).on("postgres_changes",{event:"*",schema:"public",table:"notifications",filter:`recipient_id=eq.${s.id}`},()=>{a.invalidateQueries({queryKey:["unread_notifications_count",s.id]}),a.invalidateQueries({queryKey:["notifications",s.id]})}).subscribe();return()=>O.removeChannel(p)},e[8]=s,e[9]=a,e[10]=m):m=e[10];const u=s?.id;let f;e[11]!==a||e[12]!==u?(f=[u,a],e[11]=a,e[12]=u,e[13]=f):f=e[13],(0,b.useEffect)(m,f);let h;return e[14]!==d?(h={unreadCount:d},e[14]=d,e[15]=h):h=e[15],h};var Bi=K();const Mt=s=>{const e=(0,Bi.c)(65),a=ft();let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n={},e[0]=n):n=e[0];const[i,l]=(0,b.useState)(n),r=(0,b.useRef)(null),o=s?.id;let c;e[1]!==o?(c=["conversations",o],e[1]=o,e[2]=c):c=e[2];let d;e[3]!==s?.id?(d=()=>li(s?.id),e[3]=s?.id,e[4]=d):d=e[4];const m=!!s?.id;let u;e[5]!==c||e[6]!==d||e[7]!==m?(u={queryKey:c,queryFn:d,enabled:m},e[5]=c,e[6]=d,e[7]=m,e[8]=u):u=e[8];const{data:f,isLoading:h}=Oe(u);let p;e[9]!==f?(p=f===void 0?[]:f,e[9]=f,e[10]=p):p=e[10];const x=p,g=s?.id;let v;e[11]!==g?(v=["unread_messages_count",g],e[11]=g,e[12]=v):v=e[12];let j;e[13]!==s?.id?(j=()=>ni(s?.id),e[13]=s?.id,e[14]=j):j=e[14];const N=!!s?.id;let y;e[15]!==j||e[16]!==N||e[17]!==v?(y={queryKey:v,queryFn:j,enabled:N},e[15]=j,e[16]=N,e[17]=v,e[18]=y):y=e[18];const{data:w}=Oe(y),k=w===void 0?0:w;let _;e[19]===Symbol.for("react.memo_cache_sentinel")?(_=["reactions"],e[19]=_):_=e[19];const C=!!s?.id;let F;e[20]!==C?(F={queryKey:_,queryFn:oi,enabled:C},e[20]=C,e[21]=F):F=e[21];const{data:P}=Oe(F);let T;e[22]!==P?(T=P===void 0?[]:P,e[22]=P,e[23]=T):T=e[23];const R=T;let M;e[24]!==s||e[25]!==a?(M=()=>{if(!s?.id)return;const ee=O.channel(`user_messages:${s.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},H=>{const V=H.new;a.setQueryData(["messages",V.conversation_id],Q=>Q?Q.find(ae=>ae.id===V.id)?Q:[...Q,V]:[V]),V.sender_id!==s.id&&a.invalidateQueries({queryKey:["unread_messages_count",s.id]}),a.invalidateQueries(["conversations",s.id]),l(Q=>({...Q,[V.conversation_id]:!1}))}).on("postgres_changes",{event:"DELETE",schema:"public",table:"messages"},H=>{a.invalidateQueries({queryKey:["messages"]}),a.invalidateQueries({queryKey:["conversations",s.id]})}).on("postgres_changes",{event:"*",schema:"public",table:"message_reactions"},()=>{a.invalidateQueries({queryKey:["reactions"]})}).subscribe(),te=O.channel("chat_typing_shared").on("broadcast",{event:"typing"},H=>{const{payload:V}=H,{conversationId:Q,isTyping:ae,userId:G}=V;G!==s.id&&l(ce=>({...ce,[Q]:ae}))}).subscribe();return r.current=te,()=>{O.removeChannel(ee),O.removeChannel(te)}},e[24]=s,e[25]=a,e[26]=M):M=e[26];const E=s?.id;let B;e[27]!==a||e[28]!==E?(B=[E,a],e[27]=a,e[28]=E,e[29]=B):B=e[29],(0,b.useEffect)(M,B);let A;e[30]!==s?(A=ee=>{const{convId:te,text:H,type:V,media:Q,replyToId:ae}=ee,G=V===void 0?"text":V,ce=Q===void 0?[]:Q,be=ae===void 0?null:ae;return di(te,s.id,H,G,ce,be)},e[30]=s,e[31]=A):A=e[31];let L;e[32]!==s||e[33]!==a?(L=ee=>{a.setQueryData(["messages",ee.conversation_id],te=>te?te.find(H=>H.id===ee.id)?te:[...te,ee]:[ee]),a.invalidateQueries(["conversations",s.id])},e[32]=s,e[33]=a,e[34]=L):L=e[34];let z;e[35]!==A||e[36]!==L?(z={mutationFn:A,onSuccess:L},e[35]=A,e[36]=L,e[37]=z):z=e[37];const I=rs(z);let W;e[38]!==s?(W=(ee,te)=>{r.current&&r.current.send({type:"broadcast",event:"typing",payload:{conversationId:ee,isTyping:te,userId:s.id}})},e[38]=s,e[39]=W):W=e[39];const S=W;let q;e[40]!==s||e[41]!==a?(q=async ee=>{!s?.id||!ee||(await ii(ee,s.id),a.invalidateQueries({queryKey:["unread_messages_count",s.id]}),a.invalidateQueries({queryKey:["conversations",s.id]}))},e[40]=s,e[41]=a,e[42]=q):q=e[42];const $=q;let J;e[43]!==s||e[44]!==a?(J=async(ee,te)=>{if(s?.id)try{await ci(ee,s.id,te),a.invalidateQueries({queryKey:["reactions"]})}catch(H){console.error("Failed to toggle reaction:",H)}},e[43]=s,e[44]=a,e[45]=J):J=e[45];const X=J;let se;e[46]!==a?(se=async ee=>{try{await mi(ee),a.invalidateQueries({queryKey:["messages"]})}catch(te){console.error("Failed to delete message:",te)}},e[46]=a,e[47]=se):se=e[47];const ie=se;let le;e[48]!==s?.id?(le=(ee,te)=>{const H=ee===void 0?[]:ee,V=te===void 0?[]:te;return H.map(Q=>({id:Q.id,sender:Q.sender_id===s?.id?"me":"them",text:Q.content,type:Q.type||"text",media:Q.media||[],isRead:Q.is_read,replyToId:Q.reply_to_id,reactions:V.filter(ae=>ae.message_id===Q.id),time:new Date(Q.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}))},e[48]=s?.id,e[49]=le):le=e[49];const re=le;let de;e[50]!==I?(de=(ee,te,H,V,Q)=>I.mutate({convId:ee,text:te,type:H,media:V,replyToId:Q}),e[50]=I,e[51]=de):de=e[51];let me;return e[52]!==R||e[53]!==x||e[54]!==re||e[55]!==h||e[56]!==$||e[57]!==ie||e[58]!==X||e[59]!==I.isPending||e[60]!==S||e[61]!==de||e[62]!==i||e[63]!==k?(me={conversations:x,unreadCount:k,isConvLoading:h,sendMessage:de,sendTypingStatus:S,typingStatus:i,markAsRead:$,formatMessages:re,onToggleReaction:X,onDeleteMessage:ie,allReactions:R,isSending:I.isPending},e[52]=R,e[53]=x,e[54]=re,e[55]=h,e[56]=$,e[57]=ie,e[58]=X,e[59]=I.isPending,e[60]=S,e[61]=de,e[62]=i,e[63]=k,e[64]=me):me=e[64],me};var Wi=K(),Hi=s=>{const e=(0,Wi.c)(18),{onPostClick:a}=s,{currentUser:n}=fe(),{unreadCount:i}=$s(n),{unreadCount:l}=Mt(n);let r,o,c,d,m;e[0]===Symbol.for("react.memo_cache_sentinel")?(r={id:"home",icon:_t,path:"/"},o={id:"community",icon:Ke,path:"/community"},c={id:"reels",icon:rt,path:"/reels"},d={id:"messages",icon:dt,path:"/messages"},m={id:"notifications",icon:Ct,path:"/notifications"},e[0]=r,e[1]=o,e[2]=c,e[3]=d,e[4]=m):(r=e[0],o=e[1],c=e[2],d=e[3],m=e[4]);const u=n?`/u/${n.handle}`:"/community";let f;e[5]!==u?(f=[r,o,c,d,m,{id:"profile",icon:fn,path:u}],e[5]=u,e[6]=f):f=e[6];const h=f;let p;e[7]===Symbol.for("react.memo_cache_sentinel")?(p=(0,t.jsx)(Gs,{to:"/",className:"mb-8 hover:scale-110 transition-transform",children:(0,t.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",alt:"Logo",className:"size-8 rounded-lg"})}),e[7]=p):p=e[7];let x;e[8]!==l||e[9]!==h||e[10]!==i?(x=h.map(j=>(0,t.jsxs)(ms,{to:j.path,className:Ui,children:[(0,t.jsx)(j.icon,{size:26,strokeWidth:2.5}),j.id==="notifications"&&i>0&&(0,t.jsx)("span",{className:"absolute top-2 right-2 size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"}),j.id==="messages"&&l>0&&(0,t.jsx)("span",{className:"absolute top-2 right-2 size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"})]},j.id)),e[8]=l,e[9]=h,e[10]=i,e[11]=x):x=e[11];let g;e[12]!==n||e[13]!==a?(g=n&&(0,t.jsx)("button",{onClick:a,className:"p-2.5 mt-2 rounded-xl text-white bg-zinc-950 dark:bg-white dark:text-zinc-950 hover:scale-110 active:scale-95 transition-all duration-200 shadow-lg cursor-pointer",title:"Create Post",children:(0,t.jsx)(De,{size:26,strokeWidth:2.5})}),e[12]=n,e[13]=a,e[14]=g):g=e[14];let v;return e[15]!==g||e[16]!==x?(v=(0,t.jsxs)("aside",{className:"sticky top-0 hidden md:flex h-screen w-[68px] flex-col items-center py-5 border-r border-zinc-100 dark:border-zinc-800 shrink-0 bg-white dark:bg-black transition-colors duration-200",children:[p,(0,t.jsxs)("nav",{className:"flex flex-col gap-y-4 w-full items-center",children:[x,g]})]}),e[15]=g,e[16]=x,e[17]=v):v=e[17],v},Qi=Hi;function Ui(s){const{isActive:e}=s;return`p-2.5 rounded-xl transition-all duration-200 border border-transparent relative ${e?"text-black dark:text-white bg-zinc-100 dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800":"text-zinc-500 hover:bg-zinc-50 dark:hover:bg-zinc-900"}`}var Vi=K(),Ki=s=>{const e=(0,Vi.c)(13),{value:a,onChange:n,onClear:i,placeholder:l}=s,r=l===void 0?"Search...":l;let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=(0,t.jsx)(xs,{size:18,className:"absolute left-4 top-1/2 -translate-y-1/2 text-zinc-400 group-focus-within:text-violet-500 transition-colors"}),e[0]=o):o=e[0];let c;e[1]!==n?(c=f=>n(f.target.value),e[1]=n,e[2]=c):c=e[2];let d;e[3]!==r||e[4]!==c||e[5]!==a?(d=(0,t.jsx)("input",{className:"w-full rounded-full border border-zinc-100 dark:border-zinc-800 bg-zinc-50 dark:bg-zinc-900/50 text-zinc-900 dark:text-white px-11 py-2.5 text-sm outline-none focus:border-violet-500 focus:ring-1 focus:ring-violet-500 transition-all",placeholder:r,value:a,onChange:c}),e[3]=r,e[4]=c,e[5]=a,e[6]=d):d=e[6];let m;e[7]!==i||e[8]!==a?(m=a&&(0,t.jsx)("button",{onClick:i,className:"absolute right-4 top-1/2 -translate-y-1/2 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 transition-colors",children:(0,t.jsx)(we,{size:16})}),e[7]=i,e[8]=a,e[9]=m):m=e[9];let u;return e[10]!==d||e[11]!==m?(u=(0,t.jsxs)("div",{className:"relative group w-full",children:[o,d,m]}),e[10]=d,e[11]=m,e[12]=u):u=e[12],u},ot=Ki,Ji=K();function ne(...s){return Fn(Pn(s))}const Xi=()=>{const s=(0,Ji.c)(2),{pathname:e}=mt();let a;return s[0]!==e?(a=[e],s[0]=e,s[1]=a):a=s[1],(0,b.useEffect)(Zi,a),null},ze=s=>typeof s!="string"?!1:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(s),Yi=(s,e)=>{const a=document.createElement("canvas"),n=s.naturalWidth/s.width,i=s.naturalHeight/s.height;a.width=e.width*n,a.height=e.height*i;const l=a.getContext("2d");return l.imageSmoothingEnabled=!0,l.imageSmoothingQuality="high",l.drawImage(s,e.x*n,e.y*i,e.width*n,e.height*i,0,0,e.width*n,e.height*i),new Promise((r,o)=>{a.toBlob(c=>{if(!c){o(new Error("Canvas is empty"));return}r(c)},"image/jpeg",.95)})},lt=s=>{if(!s)return"";const e=new Date-new Date(s),a=Math.floor(e/1e3),n=Math.floor(a/60),i=Math.floor(n/60),l=Math.floor(i/24);return a<60?"Just now":n<60?`${n}m ago`:i<24?`${i}h ago`:l<7?`${l}d ago`:new Date(s).toLocaleDateString()},Gi=s=>typeof s!="string"?!1:/[\u0980-\u09FF]/.test(s);function Zi(){window.scrollTo(0,0)}var el=K(),tl=s=>{const e=(0,el.c)(9),{className:a}=s,{setAuthMode:n}=fe();let i;e[0]!==a?(i=ne("border border-[--border] rounded-2xl p-8 flex flex-col items-center text-center gap-4 bg-[--card] shadow-sm",a),e[0]=a,e[1]=i):i=e[1];let l,r;e[2]===Symbol.for("react.memo_cache_sentinel")?(l=(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"size-16 rounded-full border-4 border-amber-400 border-t-transparent animate-spin duration-[3000ms]"}),(0,t.jsx)("span",{className:"absolute inset-0 flex items-center justify-center text-2xl",children:"ðŸ’«"})]}),r=(0,t.jsx)("h3",{className:"font-extrabold text-lg text-[--foreground] mt-2 leading-tight",children:"Get your Sysm account now!"}),e[2]=l,e[3]=r):(l=e[2],r=e[3]);let o;e[4]!==n?(o=(0,t.jsx)("button",{onClick:()=>n("signup"),className:"w-full bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 py-2.5 rounded-full font-black text-sm uppercase tracking-wider hover:opacity-90 active:scale-95 transition-all shadow-lg cursor-pointer",children:"Signup now"}),e[4]=n,e[5]=o):o=e[5];let c;return e[6]!==i||e[7]!==o?(c=(0,t.jsxs)("div",{className:i,children:[l,r,o]}),e[6]=i,e[7]=o,e[8]=c):c=e[8],c},Ps=tl,sl=K(),al=s=>{const e=(0,sl.c)(41),{trendingTopics:a}=s;let n;e[0]!==a?(n=a===void 0?[]:a,e[0]=a,e[1]=n):n=e[1];const i=n,{currentUser:l,setAuthMode:r}=fe(),{darkMode:o,toggleDarkMode:c}=$t(),[d,m]=(0,b.useState)("");let u;e[2]===Symbol.for("react.memo_cache_sentinel")?(u=["Â© 2026 Sysm","Terms","Privacy","Guidelines","Discord","Sysm","GitHub","Support","Status"],e[2]=u):u=e[2];const f=u;let h;e[3]!==o?(h=o?(0,t.jsx)(vn,{size:20}):(0,t.jsx)(aa,{size:20}),e[3]=o,e[4]=h):h=e[4];let p;e[5]!==h||e[6]!==c?(p=(0,t.jsx)("button",{onClick:c,className:"p-3 rounded-full bg-zinc-50 dark:bg-zinc-900 text-zinc-500 dark:text-zinc-400 border border-zinc-100 dark:border-zinc-800 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-all cursor-pointer",title:"Toggle Theme",children:h}),e[5]=h,e[6]=c,e[7]=p):p=e[7];const x=p;if(l){let P;e[8]===Symbol.for("react.memo_cache_sentinel")?(P=()=>m(""),e[8]=P):P=e[8];let T;e[9]!==d?(T=(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)(ot,{value:d,onChange:m,onClear:P})}),e[9]=d,e[10]=T):T=e[10];let R;e[11]!==T||e[12]!==x?(R=(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[T,x]}),e[11]=T,e[12]=x,e[13]=R):R=e[13];let M;e[14]===Symbol.for("react.memo_cache_sentinel")?(M=(0,t.jsx)("h3",{className:"font-extrabold text-xl mb-4 px-2 text-[--foreground]",children:"What's happening"}),e[14]=M):M=e[14];let E;e[15]!==i?(E=i.map(il),e[15]=i,e[16]=E):E=e[16];let B;e[17]!==E?(B=(0,t.jsxs)("div",{className:"bg-zinc-50 dark:bg-zinc-900 rounded-2xl p-4 border border-[--border]",children:[M,(0,t.jsx)("div",{className:"flex flex-col gap-1",children:E})]}),e[17]=E,e[18]=B):B=e[18];let A;e[19]===Symbol.for("react.memo_cache_sentinel")?(A=(0,t.jsx)("div",{className:"flex flex-wrap gap-x-4 gap-y-2 px-2 text-[13px] text-zinc-500 font-medium pb-5",children:f.map(ll)}),e[19]=A):A=e[19];let L;return e[20]!==B||e[21]!==R?(L=(0,t.jsxs)("aside",{className:"sticky top-5 hidden w-[320px] shrink-0 flex-col gap-y-6 lg:flex overflow-y-auto max-h-screen",children:[R,B,A]}),e[20]=B,e[21]=R,e[22]=L):L=e[22],L}let g,v;e[23]!==r?(g=(0,t.jsx)("button",{onClick:()=>r("signup"),className:"flex-1 bg-[--card] border border-[--border] py-2.5 rounded-full font-bold text-[--foreground] hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors shadow-sm cursor-pointer",children:"Signup"}),v=()=>r("login"),e[23]=r,e[24]=g,e[25]=v):(g=e[24],v=e[25]);let j;e[26]===Symbol.for("react.memo_cache_sentinel")?(j=(0,t.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",alt:"",className:"size-4 rounded-sm"}),e[26]=j):j=e[26];let N;e[27]!==v?(N=(0,t.jsxs)("button",{onClick:v,className:"flex-1 bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 py-2.5 rounded-full font-bold flex items-center justify-center gap-2 hover:opacity-90 transition-opacity cursor-pointer",children:[j,"Login"]}),e[27]=v,e[28]=N):N=e[28];let y;e[29]!==g||e[30]!==N||e[31]!==x?(y=(0,t.jsxs)("div",{className:"flex gap-3",children:[g,N,x]}),e[29]=g,e[30]=N,e[31]=x,e[32]=y):y=e[32];let w;e[33]===Symbol.for("react.memo_cache_sentinel")?(w=()=>m(""),e[33]=w):w=e[33];let k;e[34]!==d?(k=(0,t.jsx)(ot,{value:d,onChange:m,onClear:w}),e[34]=d,e[35]=k):k=e[35];let _;e[36]===Symbol.for("react.memo_cache_sentinel")?(_=(0,t.jsx)(Ps,{}),e[36]=_):_=e[36];let C;e[37]===Symbol.for("react.memo_cache_sentinel")?(C=(0,t.jsx)("div",{className:"flex flex-wrap gap-x-4 gap-y-2 px-2 text-[13px] text-zinc-500 font-medium pb-5",children:f.map(rl)}),e[37]=C):C=e[37];let F;return e[38]!==y||e[39]!==k?(F=(0,t.jsxs)("aside",{className:"sticky top-5 hidden w-[350px] shrink-0 flex-col gap-y-6 lg:flex pr-4",children:[y,k,_,C]}),e[38]=y,e[39]=k,e[40]=F):F=e[40],F},nl=al;function il(s){return(0,t.jsxs)("div",{className:"px-3 py-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-xl cursor-pointer transition-colors group",children:[(0,t.jsx)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400 font-medium",children:"Trending"}),(0,t.jsxs)("div",{className:"font-bold text-[--foreground]",children:["#",s.tag]}),(0,t.jsxs)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:[s.posts," posts"]})]},s.tag)}function ll(s){return(0,t.jsx)("a",{href:"#",className:"hover:underline",children:s},s)}function rl(s){return(0,t.jsx)("a",{href:"#",className:"hover:underline",children:s},s)}var Ft=K();function xe(s){const e=(0,Ft.c)(8);let a,n;e[0]!==s?({className:a,...n}=s,e[0]=s,e[1]=a,e[2]=n):(a=e[1],n=e[2]);let i;e[3]!==a?(i=ne("relative flex size-8 shrink-0 overflow-hidden rounded-full",a),e[3]=a,e[4]=i):i=e[4];let l;return e[5]!==n||e[6]!==i?(l=(0,t.jsx)(Ma,{"data-slot":"avatar",className:i,...n}),e[5]=n,e[6]=i,e[7]=l):l=e[7],l}function he(s){const e=(0,Ft.c)(8);let a,n;e[0]!==s?({className:a,...n}=s,e[0]=s,e[1]=a,e[2]=n):(a=e[1],n=e[2]);let i;e[3]!==a?(i=ne("aspect-square size-full",a),e[3]=a,e[4]=i):i=e[4];let l;return e[5]!==n||e[6]!==i?(l=(0,t.jsx)(Ra,{"data-slot":"avatar-image",className:i,...n}),e[5]=n,e[6]=i,e[7]=l):l=e[7],l}function pe(s){const e=(0,Ft.c)(8);let a,n;e[0]!==s?({className:a,...n}=s,e[0]=s,e[1]=a,e[2]=n):(a=e[1],n=e[2]);let i;e[3]!==a?(i=ne("bg-muted flex size-full items-center justify-center rounded-full",a),e[3]=a,e[4]=i):i=e[4];let l;return e[5]!==n||e[6]!==i?(l=(0,t.jsx)(ua,{"data-slot":"avatar-fallback",className:i,...n}),e[5]=n,e[6]=i,e[7]=l):l=e[7],l}var ol=K(),cl=s=>{const e=(0,ol.c)(23),{handleProfileClick:a}=s,{currentUser:n}=fe(),{unreadCount:i}=$s(n),{unreadCount:l}=Mt(n),r=mt();let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=[{id:"home",icon:_t,path:"/"},{id:"community",icon:Ke,path:"/community"},{id:"reels",icon:rt,path:"/reels"},{id:"messages",icon:dt,path:"/messages"},{id:"notifications",icon:Ct,path:"/notifications"}],e[0]=o):o=e[0];const c=o;let d;e[1]!==l||e[2]!==i?(d=c.map(N=>(0,t.jsx)(ms,{to:N.path,className:ml,children:y=>{const{isActive:w}=y;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(N.icon,{size:26,strokeWidth:w?2.5:2}),N.id==="notifications"&&i>0&&(0,t.jsx)("span",{className:"absolute top-3 right-[30%] size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"}),N.id==="messages"&&l>0&&(0,t.jsx)("span",{className:"absolute top-3 right-[30%] size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"})]})}},N.id)),e[1]=l,e[2]=i,e[3]=d):d=e[3];let m;e[4]!==n||e[5]!==a?(m=()=>{n&&a(n.handle)},e[4]=n,e[5]=a,e[6]=m):m=e[6];const u=`size-7 border-2 ${r.pathname.startsWith("/u/")?"border-black dark:border-white":"border-transparent opacity-70"}`,f=n?.avatar||"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm";let h;e[7]!==f?(h=(0,t.jsx)(he,{src:f,alt:"Profile",className:"object-cover"}),e[7]=f,e[8]=h):h=e[8];let p;e[9]!==n?.handle?.[0]?(p=n?.handle?.[0]?.toUpperCase(),e[9]=n?.handle?.[0],e[10]=p):p=e[10];let x;e[11]!==p?(x=(0,t.jsx)(pe,{children:p}),e[11]=p,e[12]=x):x=e[12];let g;e[13]!==u||e[14]!==h||e[15]!==x?(g=(0,t.jsxs)(xe,{className:u,children:[h,x]}),e[13]=u,e[14]=h,e[15]=x,e[16]=g):g=e[16];let v;e[17]!==m||e[18]!==g?(v=(0,t.jsx)("button",{onClick:m,className:"flex-1 flex flex-col items-center justify-center h-full",children:g}),e[17]=m,e[18]=g,e[19]=v):v=e[19];let j;return e[20]!==v||e[21]!==d?(j=(0,t.jsxs)("nav",{className:"fixed bottom-0 left-0 right-0 z-[40] flex h-16 items-center border-t border-zinc-100 bg-white/90 pb-safe backdrop-blur-md dark:border-zinc-800 dark:bg-black/90 md:hidden",children:[d,v]}),e[20]=v,e[21]=d,e[22]=j):j=e[22],j},dl=cl;function ml(s){const{isActive:e}=s;return`flex flex-1 flex-col items-center justify-center h-full transition-all duration-200 relative ${e?"text-black dark:text-white":"text-zinc-400 opacity-70"}`}var ul=K(),fl=()=>{const s=(0,ul.c)(5);let e,a;s[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,t.jsx)("img",{src:"https://systemadminbd.com/uploads/675346dd55e0c7.43939630.png",alt:"Welcome Banner",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-700"}),a=(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"}),s[0]=e,s[1]=a):(e=s[0],a=s[1]);let n;s[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,t.jsx)("h1",{className:"text-3xl sm:text-4xl font-black mb-1 drop-shadow-lg",children:"Welcome to Sysm"}),s[2]=n):n=s[2];let i;s[3]===Symbol.for("react.memo_cache_sentinel")?(i=(0,t.jsxs)("div",{className:"absolute bottom-6 left-8 text-white",children:[n,(0,t.jsxs)("p",{className:"text-sm sm:text-base font-medium opacity-90 tracking-wide drop-shadow-md",children:["a social network built by"," ",(0,t.jsx)("a",{href:"https://t.me/systemadminbd",target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:"@Systemadminbd"})]})]}),s[3]=i):i=s[3];let l;return s[4]===Symbol.for("react.memo_cache_sentinel")?(l=(0,t.jsxs)("div",{className:"relative w-full aspect-[21/9] sm:aspect-[2.5/1] rounded-3xl overflow-hidden mb-6 group cursor-pointer",children:[e,a,i,(0,t.jsx)("div",{className:"absolute bottom-4 right-8",children:(0,t.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",className:"size-12 animate-pulse opacity-80 rounded-xl",alt:""})})]}),s[4]=l):l=s[4],l},xl=fl,hl=K(),pl=s=>{const e=(0,hl.c)(27),{onPostClick:a}=s,n=mt(),i=je(),{darkMode:l}=$t(),r=n.pathname==="/";let o;e[0]!==n.pathname?(o=n.pathname.startsWith("/reels")||n.pathname.startsWith("/messages")&&n.pathname.split("/").length>2,e[0]=n.pathname,e[1]=o):o=e[1];const c=o;let d;e[2]!==i?(d=_=>{i(`/u/${_}`)},e[2]=i,e[3]=d):d=e[3];const m=d,u=`min-h-screen bg-[--background] text-[--foreground] font-sans selection:bg-violet-500 selection:text-white transition-colors duration-200 ${l?"dark":""}`;let f;e[4]!==a?(f=(0,t.jsx)(Qi,{onPostClick:a}),e[4]=a,e[5]=f):f=e[5];const h=!c&&"pb-24 md:pb-0";let p;e[6]!==h?(p=ne("flex-1 flex justify-center gap-x-2 md:gap-x-8 py-0 md:py-5 px-0 md:px-4",h),e[6]=h,e[7]=p):p=e[7];let x;e[8]!==r?(x=r&&(0,t.jsx)("div",{className:"w-full max-w-full overflow-hidden",children:(0,t.jsx)(xl,{})}),e[8]=r,e[9]=x):x=e[9];let g;e[10]===Symbol.for("react.memo_cache_sentinel")?(g=(0,t.jsx)("div",{className:"w-full",children:(0,t.jsx)(ba,{})}),e[10]=g):g=e[10];let v;e[11]!==x?(v=(0,t.jsxs)("div",{className:"flex flex-col flex-1 w-0 overflow-x-hidden",children:[x,g]}),e[11]=x,e[12]=v):v=e[12];let j;e[13]===Symbol.for("react.memo_cache_sentinel")?(j=(0,t.jsx)(nl,{trendingTopics:ki}),e[13]=j):j=e[13];let N;e[14]!==p||e[15]!==v?(N=(0,t.jsxs)("div",{className:p,children:[v,j]}),e[14]=p,e[15]=v,e[16]=N):N=e[16];let y;e[17]!==N||e[18]!==f?(y=(0,t.jsxs)("div",{className:"flex justify-center w-full max-w-[1300px] mx-auto min-h-screen px-0 sm:px-0",children:[f,N]}),e[17]=N,e[18]=f,e[19]=y):y=e[19];let w;e[20]!==m||e[21]!==c?(w=!c&&(0,t.jsx)(dl,{handleProfileClick:m}),e[20]=m,e[21]=c,e[22]=w):w=e[22];let k;return e[23]!==y||e[24]!==w||e[25]!==u?(k=(0,t.jsxs)("div",{className:u,children:[y,w]}),e[23]=y,e[24]=w,e[25]=u,e[26]=k):k=e[26],k},bl=pl,We=K();function Ms(s){const e=(0,We.c)(4);let a;e[0]!==s?({...a}=s,e[0]=s,e[1]=a):a=e[1];let n;return e[2]!==a?(n=(0,t.jsx)(fa,{"data-slot":"dialog",...a}),e[2]=a,e[3]=n):n=e[3],n}function gl(s){const e=(0,We.c)(4);let a;e[0]!==s?({...a}=s,e[0]=s,e[1]=a):a=e[1];let n;return e[2]!==a?(n=(0,t.jsx)(oa,{"data-slot":"dialog-portal",...a}),e[2]=a,e[3]=n):n=e[3],n}function vl(s){const e=(0,We.c)(8);let a,n;e[0]!==s?({className:a,...n}=s,e[0]=s,e[1]=a,e[2]=n):(a=e[1],n=e[2]);let i;e[3]!==a?(i=ne("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),e[3]=a,e[4]=i):i=e[4];let l;return e[5]!==n||e[6]!==i?(l=(0,t.jsx)($a,{"data-slot":"dialog-overlay",className:i,...n}),e[5]=n,e[6]=i,e[7]=l):l=e[7],l}function Fs(s){const e=(0,We.c)(15);let a,n,i,l;e[0]!==s?({className:n,children:a,showCloseButton:l,...i}=s,e[0]=s,e[1]=a,e[2]=n,e[3]=i,e[4]=l):(a=e[1],n=e[2],i=e[3],l=e[4]);const r=l===void 0?!0:l;let o;e[5]===Symbol.for("react.memo_cache_sentinel")?(o=(0,t.jsx)(vl,{}),e[5]=o):o=e[5];let c;e[6]!==n?(c=ne("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg p-6 shadow-lg duration-200 outline-none sm:max-w-lg",n),e[6]=n,e[7]=c):c=e[7];let d;e[8]!==r?(d=r&&(0,t.jsxs)(Ca,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,t.jsx)(we,{}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]}),e[8]=r,e[9]=d):d=e[9];let m;return e[10]!==a||e[11]!==i||e[12]!==c||e[13]!==d?(m=(0,t.jsxs)(gl,{"data-slot":"dialog-portal",children:[o,(0,t.jsxs)(ca,{"data-slot":"dialog-content",className:c,...i,children:[a,d]})]}),e[10]=a,e[11]=i,e[12]=c,e[13]=d,e[14]=m):m=e[14],m}function Rs(s){const e=(0,We.c)(8);let a,n;e[0]!==s?({className:a,...n}=s,e[0]=s,e[1]=a,e[2]=n):(a=e[1],n=e[2]);let i;e[3]!==a?(i=ne("flex flex-col gap-2 text-center sm:text-left",a),e[3]=a,e[4]=i):i=e[4];let l;return e[5]!==n||e[6]!==i?(l=(0,t.jsx)("div",{"data-slot":"dialog-header",className:i,...n}),e[5]=n,e[6]=i,e[7]=l):l=e[7],l}function Ls(s){const e=(0,We.c)(8);let a,n;e[0]!==s?({className:a,...n}=s,e[0]=s,e[1]=a,e[2]=n):(a=e[1],n=e[2]);let i;e[3]!==a?(i=ne("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),e[3]=a,e[4]=i):i=e[4];let l;return e[5]!==n||e[6]!==i?(l=(0,t.jsx)("div",{"data-slot":"dialog-footer",className:i,...n}),e[5]=n,e[6]=i,e[7]=l):l=e[7],l}function Is(s){const e=(0,We.c)(8);let a,n;e[0]!==s?({className:a,...n}=s,e[0]=s,e[1]=a,e[2]=n):(a=e[1],n=e[2]);let i;e[3]!==a?(i=ne("text-lg leading-none font-semibold",a),e[3]=a,e[4]=i):i=e[4];let l;return e[5]!==n||e[6]!==i?(l=(0,t.jsx)(mn,{"data-slot":"dialog-title",className:i,...n}),e[5]=n,e[6]=i,e[7]=l):l=e[7],l}function jl(s){const e=(0,We.c)(8);let a,n;e[0]!==s?({className:a,...n}=s,e[0]=s,e[1]=a,e[2]=n):(a=e[1],n=e[2]);let i;e[3]!==a?(i=ne("text-muted-foreground text-sm",a),e[3]=a,e[4]=i):i=e[4];let l;return e[5]!==n||e[6]!==i?(l=(0,t.jsx)(ka,{"data-slot":"dialog-description",className:i,...n}),e[5]=n,e[6]=i,e[7]=l):l=e[7],l}var yl=K(),wl=s=>{const e=(0,yl.c)(20),{isOpen:a,onClose:n,title:i,children:l,footer:r,description:o,className:c}=s;let d;e[0]!==n?(d=v=>{v||n()},e[0]=n,e[1]=d):d=e[1];const m=d;let u;e[2]!==c?(u=ne("sm:max-w-md max-h-[calc(100dvh-2rem)] flex flex-col p-0 gap-0 overflow-hidden bg-white dark:bg-zinc-900",c),e[2]=c,e[3]=u):u=e[3];let f;e[4]!==o||e[5]!==i?(f=i&&(0,t.jsxs)(Rs,{className:"px-5 py-4 shrink-0",children:[(0,t.jsx)(Is,{className:"text-xl font-bold",children:i}),o&&(0,t.jsx)(jl,{children:o})]}),e[4]=o,e[5]=i,e[6]=f):f=e[6];let h;e[7]!==l?(h=(0,t.jsx)("div",{className:"flex-1 overflow-y-auto p-5 min-h-0",children:l}),e[7]=l,e[8]=h):h=e[8];let p;e[9]!==r?(p=r&&(0,t.jsx)(Ls,{className:"px-5 py-4 shrink-0 bg-white dark:bg-zinc-900",children:r}),e[9]=r,e[10]=p):p=e[10];let x;e[11]!==u||e[12]!==f||e[13]!==h||e[14]!==p?(x=(0,t.jsxs)(Fs,{className:u,children:[f,h,p]}),e[11]=u,e[12]=f,e[13]=h,e[14]=p,e[15]=x):x=e[15];let g;return e[16]!==m||e[17]!==a||e[18]!==x?(g=(0,t.jsx)(Ms,{open:a,onOpenChange:m,children:x}),e[16]=m,e[17]=a,e[18]=x,e[19]=g):g=e[19],g},nt=wl,Nl=K(),zl=s=>{const e=(0,Nl.c)(12);let a,n,i,l;e[0]!==s?({children:a,variant:i,className:l,...n}=s,e[0]=s,e[1]=a,e[2]=n,e[3]=i,e[4]=l):(a=e[1],n=e[2],i=e[3],l=e[4]);const r=i===void 0?"primary":i,o=l===void 0?"":l;let c;e[5]===Symbol.for("react.memo_cache_sentinel")?(c={primary:"text-white hover:text-white bg-zinc-900 hover:bg-zinc-800 border border-zinc-900 dark:bg-white dark:text-black dark:border-white dark:hover:bg-zinc-200",secondary:"text-zinc-900 border border-zinc-300 hover:border-zinc-400 bg-transparent hover:bg-zinc-50 dark:text-white dark:border-zinc-700 dark:hover:border-zinc-600 dark:hover:bg-zinc-900",outline:"text-zinc-900 border border-zinc-300 hover:border-zinc-400 bg-white dark:bg-transparent dark:text-white dark:border-zinc-700 dark:hover:bg-zinc-900",danger:"text-white bg-red-500 hover:bg-red-600 border border-red-500",ghost:"text-zinc-500 hover:bg-zinc-100 dark:text-zinc-400 dark:hover:bg-zinc-800 border-transparent"},e[5]=c):c=e[5];const d=`rounded-full font-bold inline-flex items-center justify-center relative overflow-hidden px-4 py-1.5 transition-all duration-200 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:active:scale-100 touch-manipulation ${c[r]} ${o}`;let m;e[6]!==a?(m=(0,t.jsx)("div",{className:"flex items-center gap-x-1.5",children:a}),e[6]=a,e[7]=m):m=e[7];let u;return e[8]!==n||e[9]!==d||e[10]!==m?(u=(0,t.jsx)("button",{className:d,...n,children:m}),e[8]=n,e[9]=d,e[10]=m,e[11]=u):u=e[11],u},ue=zl,kl=K(),_l=s=>{const e=(0,kl.c)(33),{src:a,isOpen:n,onClose:i,onCropComplete:l,aspect:r,circular:o}=s,[c,d]=(0,b.useState)(),[m,u]=(0,b.useState)(null),f=(0,b.useRef)(null);let h;e[0]!==r?(h=R=>{const{width:M,height:E}=R.currentTarget;d(r?_n(ya({unit:"%",width:100},r,M,E),M,E):{unit:"%",width:100,height:100,x:0,y:0})},e[0]=r,e[1]=h):h=e[1];const p=h;let x;e[2]!==m||e[3]!==i||e[4]!==l?(x=async()=>{if(m&&f.current)try{l(await Yi(f.current,m)),i()}catch(R){console.error("Error cropping image:",R)}},e[2]=m,e[3]=i,e[4]=l,e[5]=x):x=e[5];const g=x;let v;e[6]!==i?(v=R=>!R&&i(),e[6]=i,e[7]=v):v=e[7];let j;e[8]===Symbol.for("react.memo_cache_sentinel")?(j=(0,t.jsx)(Rs,{className:"p-4 shrink-0",children:(0,t.jsx)(Is,{children:"Crop Image"})}),e[8]=j):j=e[8];let N,y;e[9]===Symbol.for("react.memo_cache_sentinel")?(N=R=>d(R),y=(R,M)=>u(M),e[9]=N,e[10]=y):(N=e[9],y=e[10]);let w;e[11]!==p||e[12]!==a?(w=(0,t.jsx)("img",{ref:f,src:a,alt:"Crop preview",onLoad:p,className:"max-h-[60vh] w-auto block"}),e[11]=p,e[12]=a,e[13]=w):w=e[13];let k;e[14]!==r||e[15]!==o||e[16]!==c||e[17]!==w?(k=(0,t.jsx)("div",{className:"p-6 flex items-center justify-center bg-zinc-100/50 dark:bg-zinc-950/50 min-h-[300px] max-h-[65vh] overflow-auto",children:(0,t.jsx)(ea,{crop:c,onChange:N,onComplete:y,aspect:r,circularCrop:o,className:"max-w-full shadow-2xl",children:w})}),e[14]=r,e[15]=o,e[16]=c,e[17]=w,e[18]=k):k=e[18];let _;e[19]!==i?(_=(0,t.jsx)(ue,{variant:"outline",onClick:i,className:"!w-auto px-6",children:"Cancel"}),e[19]=i,e[20]=_):_=e[20];let C;e[21]!==g?(C=(0,t.jsx)(ue,{onClick:g,className:"!w-auto px-6",children:"Apply Crop"}),e[21]=g,e[22]=C):C=e[22];let F;e[23]!==C||e[24]!==_?(F=(0,t.jsxs)(Ls,{className:"p-4 bg-white dark:bg-zinc-900 shrink-0 flex flex-row justify-end gap-2",children:[_,C]}),e[23]=C,e[24]=_,e[25]=F):F=e[25];let P;e[26]!==F||e[27]!==k?(P=(0,t.jsxs)(Fs,{className:"sm:max-w-2xl bg-white dark:bg-zinc-900 p-0 overflow-hidden",children:[j,k,F]}),e[26]=F,e[27]=k,e[28]=P):P=e[28];let T;return e[29]!==n||e[30]!==P||e[31]!==v?(T=(0,t.jsx)(Ms,{open:n,onOpenChange:v,children:P}),e[29]=n,e[30]=P,e[31]=v,e[32]=T):T=e[32],T},Rt=_l,it=K();function Es(s){const e=(0,it.c)(4);let a;e[0]!==s?({...a}=s,e[0]=s,e[1]=a):a=e[1];let n;return e[2]!==a?(n=(0,t.jsx)(la,{"data-slot":"dropdown-menu",...a}),e[2]=a,e[3]=n):n=e[3],n}function Ts(s){const e=(0,it.c)(4);let a;e[0]!==s?({...a}=s,e[0]=s,e[1]=a):a=e[1];let n;return e[2]!==a?(n=(0,t.jsx)(xa,{"data-slot":"dropdown-menu-trigger",...a}),e[2]=a,e[3]=n):n=e[3],n}function qs(s){const e=(0,it.c)(10);let a,n,i;e[0]!==s?({className:a,sideOffset:i,...n}=s,e[0]=s,e[1]=a,e[2]=n,e[3]=i):(a=e[1],n=e[2],i=e[3]);const l=i===void 0?4:i;let r;e[4]!==a?(r=ne("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",a),e[4]=a,e[5]=r):r=e[5];let o;return e[6]!==n||e[7]!==l||e[8]!==r?(o=(0,t.jsx)(va,{children:(0,t.jsx)(ha,{"data-slot":"dropdown-menu-content",sideOffset:l,className:r,...n})}),e[6]=n,e[7]=l,e[8]=r,e[9]=o):o=e[9],o}function Ve(s){const e=(0,it.c)(12);let a,n,i,l;e[0]!==s?({className:a,inset:n,variant:l,...i}=s,e[0]=s,e[1]=a,e[2]=n,e[3]=i,e[4]=l):(a=e[1],n=e[2],i=e[3],l=e[4]);const r=l===void 0?"default":l;let o;e[5]!==a?(o=ne("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),e[5]=a,e[6]=o):o=e[6];let c;return e[7]!==n||e[8]!==i||e[9]!==o||e[10]!==r?(c=(0,t.jsx)(pa,{"data-slot":"dropdown-menu-item","data-inset":n,"data-variant":r,className:o,...i}),e[7]=n,e[8]=i,e[9]=o,e[10]=r,e[11]=c):c=e[11],c}function Cl(s){const e=(0,it.c)(8);let a,n;e[0]!==s?({className:a,...n}=s,e[0]=s,e[1]=a,e[2]=n):(a=e[1],n=e[2]);let i;e[3]!==a?(i=ne("bg-border -mx-1 my-1 h-px",a),e[3]=a,e[4]=i):i=e[4];let l;return e[5]!==n||e[6]!==i?(l=(0,t.jsx)(da,{"data-slot":"dropdown-menu-separator",className:i,...n}),e[5]=n,e[6]=i,e[7]=l):l=e[7],l}var Sl=({isOpen:s,onClose:e})=>{const{currentUser:a}=fe(),{addPost:n}=ht(),{addToast:i}=Ce(),[l,r]=(0,b.useState)(""),[o,c]=(0,b.useState)([]),[d,m]=(0,b.useState)({}),[u,f]=(0,b.useState)(!1),[h,p]=(0,b.useState)({options:["",""],duration:"1 day"}),[x,g]=(0,b.useState)(!1),[v,j]=(0,b.useState)(null),{data:N=[]}=Oe({queryKey:["user-communities",a?.id],queryFn:()=>yi(a?.id),enabled:!!a?.id}),[y,w]=(0,b.useState)(null),[k,_]=(0,b.useState)(null),C=(0,b.useRef)(null),F=(0,b.useRef)(null),[P,T]=(0,b.useState)(null),R=S=>{const q=Array.from(S.target.files);c($=>[...$,...q])},M=S=>{const q=S.target.files[0];q&&P!==null&&m($=>({...$,[P]:q})),T(null)},E=S=>{c($=>$.filter((J,X)=>X!==S));const q={...d};delete q[S],m(q)},B=S=>{const q=o[S],$=new FileReader;$.onload=()=>{w($.result),_(S)},$.readAsDataURL(q)},A=S=>{const q=new File([S],`cropped-${Date.now()}.jpg`,{type:"image/jpeg"}),$=[...o];$[k]=q,c($),w(null),_(null)},L=()=>{h.options.length<4&&p(S=>({...S,options:[...S.options,""]}))},z=S=>{p(q=>({...q,options:q.options.filter(($,J)=>J!==S)}))},I=(S,q)=>{const $=[...h.options];$[S]=q,p(J=>({...J,options:$}))},W=async S=>{if(S.preventDefault(),!(!l.trim()&&o.length===0||!a)){g(!0);try{const q=[];for(let J=0;J<o.length;J++){const X=o[J],se=await Ie(X,"media",d[J]||null);q.push(se)}let $=null;u&&h.options.some(J=>J.trim())&&($={options:h.options.filter(J=>J.trim()).map((J,X)=>({id:X+1,text:J,votes:0})),ends_at:new Date(Date.now()+1440*60*1e3).toISOString()}),await n({content:l,media:q,poll:$,type:q.length>0?q[0].type==="video"?"video":"image":$?"poll":"text",userId:a.id,communityId:v?.id||null}),r(""),c([]),f(!1),p({options:["",""],duration:"1 day"}),j(null),e(),i("Post published!")}catch(q){console.error("Failed to create post:",q),i("Failed to publish post.")}finally{g(!1)}}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(nt,{isOpen:s,onClose:()=>!x&&e(),title:"Create Post",className:"sm:max-w-xl",footer:(0,t.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,t.jsxs)("div",{className:"flex text-violet-600 gap-1",children:[(0,t.jsx)("button",{type:"button",onClick:()=>C.current?.click(),className:"p-2.5 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full transition-colors",title:"Attach media",children:(0,t.jsx)(is,{size:22})}),(0,t.jsx)("button",{type:"button",onClick:()=>f(!0),className:"p-2.5 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full transition-colors",title:"Add poll",children:(0,t.jsx)(Ea,{size:22})}),(0,t.jsx)("button",{type:"button",className:"p-2.5 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full transition-colors",children:(0,t.jsx)(es,{size:22})}),(0,t.jsx)("input",{type:"file",ref:C,onChange:R,multiple:!0,className:"hidden",accept:"image/*,video/*,application/pdf"}),(0,t.jsx)("input",{type:"file",ref:F,onChange:M,className:"hidden",accept:"image/*"})]}),(0,t.jsx)(ue,{onClick:W,disabled:!l.trim()&&o.length===0||x,className:"px-8 py-2.5 min-w-[100px] text-base",children:x?(0,t.jsx)(oe,{size:18,className:"animate-spin"}):"Post"})]}),children:(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsxs)(xe,{className:"size-12 border border-zinc-200 dark:border-zinc-800",children:[(0,t.jsx)(he,{src:a?.avatar,className:"object-cover"}),(0,t.jsx)(pe,{children:a?.handle?.[0]?.toUpperCase()})]}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"mb-2",children:(0,t.jsxs)(Es,{children:[(0,t.jsx)(Ts,{asChild:!0,children:(0,t.jsx)("button",{className:"flex items-center gap-1.5 px-3 py-1 rounded-full border border-zinc-200 dark:border-zinc-800 text-xs font-bold text-violet-600 dark:text-violet-400 hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors",children:v?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Ke,{size:14}),(0,t.jsx)("span",{children:v.name})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Tt,{size:14}),(0,t.jsx)("span",{children:"Everyone"})]})})}),(0,t.jsxs)(qs,{align:"start",className:"w-56 rounded-xl",children:[(0,t.jsxs)(Ve,{onClick:()=>j(null),className:"gap-2 py-2.5 cursor-pointer",children:[(0,t.jsx)(Tt,{size:16,className:"text-zinc-500"}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"font-bold text-sm",children:"Everyone"}),(0,t.jsx)("span",{className:"text-[10px] text-zinc-500",children:"Post to your public feed"})]})]}),N.map(S=>(0,t.jsxs)(Ve,{onClick:()=>j(S),className:"gap-2 py-2.5 cursor-pointer",children:[(0,t.jsxs)(xe,{className:"size-6",children:[(0,t.jsx)(he,{src:S.avatar}),(0,t.jsx)(pe,{children:S.name[0]})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"font-bold text-sm",children:S.name}),(0,t.jsx)("span",{className:"text-[10px] text-zinc-500",children:"Post to community"})]})]},S.id))]})]})}),(0,t.jsx)("textarea",{className:"w-full bg-transparent border-none outline-none text-lg min-h-[120px] resize-none dark:text-white",placeholder:"What's happening?",autoFocus:!0,value:l,onChange:S=>r(S.target.value)}),u&&(0,t.jsxs)("div",{className:"mt-4 p-4 rounded-2xl space-y-3 bg-zinc-50/50 dark:bg-zinc-900/50",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,t.jsx)("span",{className:"text-sm font-bold opacity-60",children:"Poll"}),(0,t.jsx)("button",{type:"button",onClick:()=>f(!1),className:"text-zinc-500 hover:text-rose-500",children:(0,t.jsx)(we,{size:18})})]}),h.options.map((S,q)=>(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{className:"flex-1 bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-xl px-4 py-2 text-sm outline-none focus:border-violet-500",placeholder:`Option ${q+1}`,value:S,onChange:$=>I(q,$.target.value)}),h.options.length>2&&(0,t.jsx)("button",{type:"button",onClick:()=>z(q),className:"p-2 text-rose-500 hover:bg-rose-50 dark:hover:bg-rose-900/20 rounded-lg transition-colors",children:(0,t.jsx)(fs,{size:16})})]},q)),h.options.length<4&&(0,t.jsx)("button",{type:"button",onClick:L,className:"text-sm font-bold text-violet-600 hover:bg-violet-50 dark:hover:bg-violet-900/20 px-3 py-1.5 rounded-lg transition-colors",children:"+ Add option"})]}),o.length>0&&(0,t.jsx)("div",{className:"mt-4 flex flex-wrap gap-2",children:o.map((S,q)=>(0,t.jsxs)("div",{className:"relative group size-24 rounded-xl overflow-hidden bg-zinc-100 dark:bg-zinc-800 shadow-sm",children:[S.type.startsWith("image/")?(0,t.jsx)("img",{src:URL.createObjectURL(S),className:"size-full object-cover",alt:""}):(0,t.jsx)("div",{className:"size-full flex flex-col items-center justify-center text-zinc-500 bg-zinc-100 dark:bg-zinc-800",children:S.type.startsWith("video/")?(0,t.jsxs)(t.Fragment,{children:[d[q]?(0,t.jsx)("img",{src:URL.createObjectURL(d[q]),className:"size-full object-cover",alt:"Custom thumbnail"}):(0,t.jsx)(De,{size:24,className:"animate-pulse"}),(0,t.jsx)("button",{type:"button",onClick:()=>{T(q),F.current?.click()},className:"absolute inset-x-0 bottom-0 bg-black/60 text-white text-[10px] font-bold py-1 backdrop-blur-sm hover:bg-black transition-colors",children:d[q]?"Change Thumbnail":"Add Thumbnail"})]}):(0,t.jsx)(bs,{size:24})}),(0,t.jsx)("button",{type:"button",onClick:()=>E(q),className:"absolute top-1 right-1 size-6 rounded-full bg-black/60 text-white flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,t.jsx)(we,{size:14,strokeWidth:3})}),S.type.startsWith("image/")&&(0,t.jsx)("button",{type:"button",onClick:()=>B(q),className:"absolute bottom-1 right-1 size-6 rounded-full bg-black/60 text-white flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",title:"Crop image",children:(0,t.jsx)(_a,{size:14,strokeWidth:3})})]},q))})]})]})})}),y&&(0,t.jsx)(Rt,{src:y,isOpen:!!y,onClose:()=>{w(null),_(null)},onCropComplete:A,aspect:void 0})]})},$l=Sl,Pl=K(),As=b.forwardRef((s,e)=>{const a=(0,Pl.c)(20);let n,i,l,r,o;a[0]!==s?({className:n,label:i,type:o,textarea:r,...l}=s,a[0]=s,a[1]=n,a[2]=i,a[3]=l,a[4]=r,a[5]=o):(n=a[1],i=a[2],l=a[3],r=a[4],o=a[5]);const c=r?"textarea":"input";let d;a[6]!==i?(d=i&&(0,t.jsx)("label",{className:"text-sm font-bold text-zinc-500 dark:text-zinc-400 ml-1",children:i}),a[6]=i,a[7]=d):d=a[7];const m=r&&"min-h-[100px] resize-none";let u;a[8]!==n||a[9]!==m?(u=ne("flex w-full rounded-xl border border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900 px-4 py-2.5 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-zinc-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:ring-offset-zinc-950 dark:text-white transition-all",m,n),a[8]=n,a[9]=m,a[10]=u):u=a[10];let f;a[11]!==c||a[12]!==l||a[13]!==e||a[14]!==u||a[15]!==o?(f=(0,t.jsx)(c,{type:o,className:u,ref:e,...l}),a[11]=c,a[12]=l,a[13]=e,a[14]=u,a[15]=o,a[16]=f):f=a[16];let h;return a[17]!==d||a[18]!==f?(h=(0,t.jsxs)("div",{className:"w-full space-y-1.5",children:[d,f]}),a[17]=d,a[18]=f,a[19]=h):h=a[19],h});As.displayName="Input";var Ae=As,Ml=({isOpen:s,onClose:e,editProfileData:a,setEditProfileData:n})=>{const{updateProfile:i}=fe(),{addToast:l}=Ce(),[r,o]=(0,b.useState)(!1),[c,d]=(0,b.useState)(null),[m,u]=(0,b.useState)(null),[f,h]=(0,b.useState)(null),[p,x]=(0,b.useState)(null),g=(0,b.useRef)(null),v=(0,b.useRef)(null),j=(w,k)=>{const _=w.target.files[0];if(_){const C=new FileReader;C.onload=()=>{h(C.result),x(k)},C.readAsDataURL(_)}},N=w=>{const k=new File([w],`cropped-${Date.now()}.jpg`,{type:"image/jpeg"});p==="avatar"?d(k):u(k),h(null),x(null)},y=async()=>{o(!0);try{let w=a.avatar,k=a.cover;c&&(w=(await Ie(c)).url),m&&(k=(await Ie(m)).url),await i({...a,avatar:w,cover:k}),d(null),u(null),e(),l("Profile updated!")}catch(w){console.error("Failed to update profile:",w),l("Failed to update profile.","error")}finally{o(!1)}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(nt,{isOpen:s,onClose:()=>!r&&e(),title:"Edit Profile",children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("input",{type:"file",ref:v,className:"hidden",accept:"image/*",onChange:w=>j(w,"cover")}),(0,t.jsx)("input",{type:"file",ref:g,className:"hidden",accept:"image/*",onChange:w=>j(w,"avatar")}),(0,t.jsxs)("div",{className:"relative h-32 bg-zinc-100 dark:bg-zinc-800 rounded-xl overflow-hidden group cursor-pointer",onClick:()=>v.current?.click(),children:[(m||a?.cover)&&(0,t.jsx)("img",{src:m?URL.createObjectURL(m):a.cover,className:"w-full h-full object-cover opacity-60",alt:""}),(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsx)("div",{className:"bg-black/50 p-2 rounded-full text-white group-hover:scale-110 transition-transform",children:(0,t.jsx)(De,{size:20})})})]}),(0,t.jsx)("div",{className:"relative -mt-16 ml-4",children:(0,t.jsxs)("div",{className:"relative size-24 rounded-full border-4 border-white dark:border-black overflow-hidden group cursor-pointer shadow-lg bg-white dark:bg-black",onClick:()=>g.current?.click(),children:[(c||a?.avatar)&&(0,t.jsxs)(xe,{className:"size-full opacity-60 rounded-none",children:[(0,t.jsx)(he,{src:c?URL.createObjectURL(c):a.avatar,className:"object-cover"}),(0,t.jsx)(pe,{children:a?.handle?.[0]?.toUpperCase()})]}),(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsx)("div",{className:"bg-black/50 p-2 rounded-full text-white group-hover:scale-110 transition-transform",children:(0,t.jsx)(De,{size:16})})})]})}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(Ae,{label:"Name",value:a?.name||"",onChange:w=>n({...a,name:w.target.value})}),(0,t.jsx)(Ae,{label:"Bio",textarea:!0,value:a?.bio||"",onChange:w=>n({...a,bio:w.target.value})}),(0,t.jsx)(Ae,{label:"Location",value:a?.location||"",onChange:w=>n({...a,location:w.target.value})}),(0,t.jsx)(Ae,{label:"Website",value:a?.website||"",onChange:w=>n({...a,website:w.target.value})})]}),(0,t.jsx)(ue,{className:"w-full py-3",disabled:r,onClick:y,children:r?(0,t.jsx)(oe,{size:24,className:"animate-spin text-white mx-auto"}):"Save changes"})]})}),f&&(0,t.jsx)(Rt,{src:f,isOpen:!!f,onClose:()=>{h(null),x(null)},onCropComplete:N,aspect:p==="avatar"?1:p==="cover"?3/1:void 0,circular:p==="avatar"})]})},Fl=Ml,Rl=({isOpen:s,onClose:e})=>{const{currentUser:a}=fe(),{addToast:n}=Ce(),i=ft(),[l,r]=(0,b.useState)(null),[o,c]=(0,b.useState)(!1),[d,m]=(0,b.useState)(null),u=(0,b.useRef)(null),f=g=>{const v=g.target.files[0];v&&r(v)},h=()=>{if(!l)return;const g=new FileReader;g.onload=()=>{m(g.result)},g.readAsDataURL(l)},p=g=>{r(new File([g],`story-cropped-${Date.now()}.jpg`,{type:"image/jpeg"})),m(null)},x=async()=>{if(!(!l||!a)){c(!0);try{const g=await Ie(l);await pi(a.id,g.url,g.type),r(null),e(),n("Story shared!"),i.invalidateQueries(["stories"])}catch(g){console.error("Failed to create story:",g),n("Failed to share story.")}finally{c(!1)}}};return(0,t.jsxs)(nt,{isOpen:s,onClose:()=>!o&&e(),title:"Add Story",children:[(0,t.jsxs)("div",{className:"space-y-6",children:[l?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"relative aspect-[9/16] w-full max-w-[280px] mx-auto rounded-3xl overflow-hidden shadow-2xl",children:[(0,t.jsx)("img",{src:URL.createObjectURL(l),className:"w-full h-full object-cover",alt:"Preview"}),(0,t.jsx)("button",{onClick:()=>r(null),className:"absolute top-4 right-4 p-2 bg-black/50 text-white rounded-full hover:bg-rose-500 transition-colors",title:"Remove",children:(0,t.jsx)(we,{size:20})})]}),(0,t.jsxs)("div",{className:"flex items-center justify-center gap-4 py-2 bg-zinc-50/50 dark:bg-zinc-900/50 rounded-2xl",children:[(0,t.jsxs)("button",{onClick:h,className:"flex flex-col items-center gap-1.5 p-3 rounded-xl hover:bg-white dark:hover:bg-zinc-800 transition-all text-zinc-600 dark:text-zinc-400 hover:text-violet-600 dark:hover:text-violet-400 group",children:[(0,t.jsx)("div",{className:"p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm group-hover:shadow-md transition-all",children:(0,t.jsx)(ps,{size:20})}),(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Crop / Edit"})]}),(0,t.jsxs)("button",{className:"flex flex-col items-center gap-1.5 p-3 rounded-xl opacity-40 cursor-not-allowed text-zinc-600 dark:text-zinc-400",children:[(0,t.jsx)("div",{className:"p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm",children:(0,t.jsx)("svg",{size:20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:(0,t.jsx)("path",{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 21 3 22l1-4.5L17 3z"})})}),(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Text"})]}),(0,t.jsxs)("button",{className:"flex flex-col items-center gap-1.5 p-3 rounded-xl opacity-40 cursor-not-allowed text-zinc-600 dark:text-zinc-400",children:[(0,t.jsx)("div",{className:"p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm",children:(0,t.jsxs)("svg",{size:20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[(0,t.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,t.jsx)("path",{d:"M8 14s1.5 2 4 2 4-2 4-2"}),(0,t.jsx)("line",{x1:"9",y1:"9",x2:"9.01",y2:"9"}),(0,t.jsx)("line",{x1:"15",y1:"9",x2:"15.01",y2:"9"})]})}),(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Stickers"})]})]})]}):(0,t.jsxs)("div",{className:"py-10",children:[(0,t.jsxs)("div",{className:"relative w-full group",onClick:()=>u.current?.click(),children:[(0,t.jsx)("div",{className:"relative z-40 cursor-pointer group-hover:translate-x-8 group-hover:shadow-2xl group-hover:-translate-y-8 transition-all duration-500 bg-zinc-900 dark:bg-white flex items-center justify-center h-32 w-32 mx-auto rounded-xl border-4 border-white dark:border-zinc-900",children:(0,t.jsxs)("svg",{className:"h-8 w-8 text-white/60 dark:text-zinc-950/60",strokeLinejoin:"round",strokeLinecap:"round",strokeWidth:"2",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,t.jsx)("path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2"}),(0,t.jsx)("path",{d:"M7 9l5 -5l5 5"}),(0,t.jsx)("path",{d:"M12 4l0 12"})]})}),(0,t.jsx)("div",{className:"absolute border-2 opacity-0 group-hover:opacity-80 transition-all duration-300 border-dashed border-violet-500 inset-0 z-30 bg-transparent flex items-center justify-center h-32 w-32 mx-auto rounded-xl"})]}),(0,t.jsxs)("div",{className:"text-center mt-8",children:[(0,t.jsx)("p",{className:"font-bold dark:text-white",children:"Choose a photo"}),(0,t.jsx)("p",{className:"text-sm text-zinc-500",children:"Stories last for 24 hours"})]})]}),(0,t.jsx)("input",{type:"file",ref:u,onChange:f,className:"hidden",accept:"image/*"}),(0,t.jsx)(ue,{className:"w-full py-3 text-lg",disabled:!l||o,onClick:x,children:o?(0,t.jsx)(oe,{size:24,className:"animate-spin mx-auto"}):"Share story"})]}),d&&(0,t.jsx)(Rt,{src:d,isOpen:!!d,onClose:()=>m(null),onCropComplete:p,aspect:9/16})]})},Ll=Rl,Il=K(),El=s=>{const e=(0,Il.c)(21),{isPostModalOpen:a,setIsPostModalOpen:n,isEditProfileOpen:i,setIsEditProfileOpen:l,isStoryModalOpen:r,setIsStoryModalOpen:o,editProfileData:c,setEditProfileData:d}=s;let m;e[0]!==n?(m=()=>n(!1),e[0]=n,e[1]=m):m=e[1];let u;e[2]!==a||e[3]!==m?(u=(0,t.jsx)($l,{isOpen:a,onClose:m}),e[2]=a,e[3]=m,e[4]=u):u=e[4];let f;e[5]!==l?(f=()=>l(!1),e[5]=l,e[6]=f):f=e[6];let h;e[7]!==c||e[8]!==i||e[9]!==d||e[10]!==f?(h=(0,t.jsx)(Fl,{isOpen:i,onClose:f,editProfileData:c,setEditProfileData:d}),e[7]=c,e[8]=i,e[9]=d,e[10]=f,e[11]=h):h=e[11];let p;e[12]!==o?(p=()=>o(!1),e[12]=o,e[13]=p):p=e[13];let x;e[14]!==r||e[15]!==p?(x=(0,t.jsx)(Ll,{isOpen:r,onClose:p}),e[14]=r,e[15]=p,e[16]=x):x=e[16];let g;return e[17]!==u||e[18]!==h||e[19]!==x?(g=(0,t.jsxs)(t.Fragment,{children:[u,h,x]}),e[17]=u,e[18]=h,e[19]=x,e[20]=g):g=e[20],g},Tl=El,ql=K(),Al=s=>{const e=(0,ql.c)(77),{story:a,onClose:n}=s,[i,l]=(0,b.useState)(0),[r,o]=(0,b.useState)(0),c=a.stories,d=c[i];let m;e[0]!==i||e[1]!==n||e[2]!==c.length?(m=()=>{i<c.length-1?(l(Dl),o(0)):n()},e[0]=i,e[1]=n,e[2]=c.length,e[3]=m):m=e[3];const u=m;let f;e[4]!==i?(f=()=>{i>0&&(l(Bl),o(0))},e[4]=i,e[5]=f):f=e[5];const h=f;let p;e[6]!==u?(p=()=>{const X=setInterval(()=>{o(se=>se>=100?(u(),100):se+1)},50);return()=>clearInterval(X)},e[6]=u,e[7]=p):p=e[7];let x;e[8]!==i||e[9]!==u?(x=[u,i],e[8]=i,e[9]=u,e[10]=x):x=e[10],(0,b.useEffect)(p,x);let g;if(e[11]!==i||e[12]!==r||e[13]!==c){let X;e[15]!==i||e[16]!==r?(X=(se,ie)=>(0,t.jsx)("div",{className:"flex-1 h-full bg-white/30 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-white transition-all duration-100",style:{width:ie<i?"100%":ie===i?`${r}%`:"0%"}})},ie),e[15]=i,e[16]=r,e[17]=X):X=e[17],g=c.map(X),e[11]=i,e[12]=r,e[13]=c,e[14]=g}else g=e[14];let v;e[18]!==g?(v=(0,t.jsx)("div",{className:"flex gap-1.5 h-0.5 w-full bg-transparent",children:g}),e[18]=g,e[19]=v):v=e[19];let j;e[20]!==a.user.avatar||e[21]!==a.user.handle?(j=(0,t.jsx)(he,{src:a.user.avatar,alt:a.user.handle,className:"object-cover"}),e[20]=a.user.avatar,e[21]=a.user.handle,e[22]=j):j=e[22];let N;e[23]!==a.user.handle?.[0]?(N=a.user.handle?.[0]?.toUpperCase(),e[23]=a.user.handle?.[0],e[24]=N):N=e[24];let y;e[25]!==N?(y=(0,t.jsx)(pe,{children:N}),e[25]=N,e[26]=y):y=e[26];let w;e[27]!==j||e[28]!==y?(w=(0,t.jsxs)(xe,{className:"size-10 border border-white/20 shadow-sm",children:[j,y]}),e[27]=j,e[28]=y,e[29]=w):w=e[29];let k;e[30]!==a.user.handle?(k=(0,t.jsx)("span",{className:"text-white text-sm font-bold shadow-black drop-shadow-md",children:a.user.handle}),e[30]=a.user.handle,e[31]=k):k=e[31];let _;e[32]!==d.created_at?(_=new Date(d.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),e[32]=d.created_at,e[33]=_):_=e[33];let C;e[34]!==_?(C=(0,t.jsx)("span",{className:"text-white/60 text-[10px] shadow-black drop-shadow-md",children:_}),e[34]=_,e[35]=C):C=e[35];let F;e[36]!==k||e[37]!==C?(F=(0,t.jsxs)("div",{className:"flex flex-col",children:[k,C]}),e[36]=k,e[37]=C,e[38]=F):F=e[38];let P;e[39]!==w||e[40]!==F?(P=(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[w,F]}),e[39]=w,e[40]=F,e[41]=P):P=e[41];let T;e[42]===Symbol.for("react.memo_cache_sentinel")?(T=(0,t.jsx)(we,{size:24}),e[42]=T):T=e[42];let R;e[43]!==n?(R=(0,t.jsx)("button",{onClick:n,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors",children:T}),e[43]=n,e[44]=R):R=e[44];let M;e[45]!==P||e[46]!==R?(M=(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[P,R]}),e[45]=P,e[46]=R,e[47]=M):M=e[47];let E;e[48]!==M||e[49]!==v?(E=(0,t.jsxs)("div",{className:"absolute top-0 left-0 right-0 p-4 z-20 flex flex-col gap-4",children:[v,M]}),e[48]=M,e[49]=v,e[50]=E):E=e[50];let B;e[51]!==i||e[52]!==h?(B=i>0&&(0,t.jsx)("button",{onClick:X=>{X.stopPropagation(),h()},className:"absolute left-4 z-30 p-2 bg-black/20 hover:bg-black/40 rounded-full text-white backdrop-blur-md transition-all active:scale-90",children:(0,t.jsx)(as,{size:32})}),e[51]=i,e[52]=h,e[53]=B):B=e[53];let A;e[54]!==d.id||e[55]!==d.media?(A=(0,t.jsx)("div",{className:"relative w-full h-full flex items-center justify-center",children:(0,t.jsx)("img",{src:d.media,className:"max-w-full max-h-full object-contain rounded-xl shadow-2xl animate-in fade-in zoom-in-95 duration-300",alt:""},d.id)}),e[54]=d.id,e[55]=d.media,e[56]=A):A=e[56];let L;e[57]!==u?(L=X=>{X.stopPropagation(),u()},e[57]=u,e[58]=L):L=e[58];let z;e[59]===Symbol.for("react.memo_cache_sentinel")?(z=(0,t.jsx)(hs,{size:32}),e[59]=z):z=e[59];let I;e[60]!==L?(I=(0,t.jsx)("button",{onClick:L,className:"absolute right-4 z-30 p-2 bg-black/20 hover:bg-black/40 rounded-full text-white backdrop-blur-md transition-all active:scale-90",children:z}),e[60]=L,e[61]=I):I=e[61];let W;e[62]!==h?(W=(0,t.jsx)("div",{className:"flex-1 cursor-w-resize",onClick:h}),e[62]=h,e[63]=W):W=e[63];let S;e[64]!==u?(S=(0,t.jsx)("div",{className:"flex-1 cursor-e-resize",onClick:u}),e[64]=u,e[65]=S):S=e[65];let q;e[66]!==W||e[67]!==S?(q=(0,t.jsxs)("div",{className:"absolute inset-0 flex z-20",children:[W,S]}),e[66]=W,e[67]=S,e[68]=q):q=e[68];let $;e[69]!==B||e[70]!==A||e[71]!==I||e[72]!==q?($=(0,t.jsxs)("div",{className:"w-full h-full max-w-xl relative flex items-center justify-center p-2",children:[B,A,I,q]}),e[69]=B,e[70]=A,e[71]=I,e[72]=q,e[73]=$):$=e[73];let J;return e[74]!==E||e[75]!==$?(J=(0,t.jsxs)("div",{className:"fixed inset-0 z-[100] bg-black flex flex-col items-center justify-center animate-in fade-in duration-300",children:[E,$]}),e[74]=E,e[75]=$,e[76]=J):J=e[76],J},Ol=Al;function Dl(s){return s+1}function Bl(s){return s-1}var Wl=K(),Hl=s=>{const e=(0,Wl.c)(105),{images:a,currentIndex:n,onClose:i,onNavigate:l}=s,r=n===void 0?0:n,[o,c]=(0,b.useState)(1);let d;e[0]===Symbol.for("react.memo_cache_sentinel")?(d={x:0,y:0},e[0]=d):d=e[0];const[m,u]=(0,b.useState)(d),[f,h]=(0,b.useState)(!1);let p;e[1]===Symbol.for("react.memo_cache_sentinel")?(p={x:0,y:0},e[1]=p):p=e[1];const[x,g]=(0,b.useState)(p),[v,j]=(0,b.useState)(null),[N,y]=(0,b.useState)(null),w=(0,b.useRef)(null),k=(0,b.useRef)(null);let _;e[2]===Symbol.for("react.memo_cache_sentinel")?(_=()=>c(Ul),e[2]=_):_=e[2];const C=_;let F;e[3]===Symbol.for("react.memo_cache_sentinel")?(F=()=>{c(D=>{const Z=Math.max(D-.5,1);return Z===1&&u({x:0,y:0}),Z})},e[3]=F):F=e[3];const P=F;let T;e[4]===Symbol.for("react.memo_cache_sentinel")?(T=()=>{c(1),u({x:0,y:0})},e[4]=T):T=e[4];const R=T;let M;e[5]!==r||e[6]!==l?(M=()=>{r>0&&(R(),l(r-1))},e[5]=r,e[6]=l,e[7]=M):M=e[7];const E=M;let B;e[8]!==r||e[9]!==a?.length||e[10]!==l?(B=()=>{r<(a?.length||0)-1&&(R(),l(r+1))},e[8]=r,e[9]=a?.length,e[10]=l,e[11]=B):B=e[11],a?.length;const A=B;let L;e[12]!==A||e[13]!==E||e[14]!==i?(L=()=>{const D=Z=>{Z.key==="Escape"&&i(),Z.key==="ArrowLeft"&&E(),Z.key==="ArrowRight"&&A()};return window.addEventListener("keydown",D),()=>window.removeEventListener("keydown",D)},e[12]=A,e[13]=E,e[14]=i,e[15]=L):L=e[15];let z;if(e[16]!==r||e[17]!==A||e[18]!==E||e[19]!==i?(z=[r,i,E,A],e[16]=r,e[17]=A,e[18]=E,e[19]=i,e[20]=z):z=e[20],(0,b.useEffect)(L,z),!a||a.length===0)return null;const I=a[r],W=a.length>1;let S;e[21]!==m.x||e[22]!==m.y||e[23]!==o?(S=D=>{o>1&&(h(!0),g({x:D.clientX-m.x,y:D.clientY-m.y}))},e[21]=m.x,e[22]=m.y,e[23]=o,e[24]=S):S=e[24];const q=S;let $;e[25]!==x||e[26]!==f||e[27]!==o?($=D=>{f&&o>1&&u({x:D.clientX-x.x,y:D.clientY-x.y})},e[25]=x,e[26]=f,e[27]=o,e[28]=$):$=e[28];const J=$;let X;e[29]===Symbol.for("react.memo_cache_sentinel")?(X=()=>h(!1),e[29]=X):X=e[29];const se=X;let ie;e[30]!==m.x||e[31]!==m.y||e[32]!==o?(ie=D=>{D.touches.length===1?(j({x:D.touches[0].clientX,y:D.touches[0].clientY,time:Date.now()}),o>1&&(h(!0),g({x:D.touches[0].clientX-m.x,y:D.touches[0].clientY-m.y}))):D.touches.length===2&&y(Math.hypot(D.touches[0].clientX-D.touches[1].clientX,D.touches[0].clientY-D.touches[1].clientY))},e[30]=m.x,e[31]=m.y,e[32]=o,e[33]=ie):ie=e[33];const le=ie;let re;e[34]!==x||e[35]!==N||e[36]!==f||e[37]!==o?(re=D=>{if(D.touches.length===1)f&&o>1&&u({x:D.touches[0].clientX-x.x,y:D.touches[0].clientY-x.y});else if(D.touches.length===2&&N){const Z=Math.hypot(D.touches[0].clientX-D.touches[1].clientX,D.touches[0].clientY-D.touches[1].clientY);c(Math.min(Math.max(o*(Z/N),1),4)),y(Z)}},e[34]=x,e[35]=N,e[36]=f,e[37]=o,e[38]=re):re=e[38];const de=re;let me;e[39]!==A||e[40]!==E||e[41]!==o||e[42]!==v?(me=D=>{if(D.touches.length<2&&y(null),h(!1),v&&o===1){const Z={x:D.changedTouches[0].clientX,y:D.changedTouches[0].clientY},ke=Z.x-v.x,ve=Z.y-v.y,et=Date.now()-v.time;Math.abs(ke)>50&&Math.abs(ve)<50&&et<300&&(ke>0?E():A())}j(null)},e[39]=A,e[40]=E,e[41]=o,e[42]=v,e[43]=me):me=e[43];const ee=me;let te;e[44]!==I?(te=D=>{D.stopPropagation();const Z=document.createElement("a");Z.href=I,Z.download=`sysm-${Date.now()}.jpg`,document.body.appendChild(Z),Z.click(),document.body.removeChild(Z)},e[44]=I,e[45]=te):te=e[45];const H=te,V=W?`${r+1} / ${a.length}`:"Image View";let Q;e[46]!==V?(Q=(0,t.jsx)("div",{className:"flex flex-col",children:(0,t.jsx)("span",{className:"text-white font-bold text-lg drop-shadow-md",children:V})}),e[46]=V,e[47]=Q):Q=e[47];let ae;e[48]===Symbol.for("react.memo_cache_sentinel")?(ae=(0,t.jsx)("button",{onClick:P,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors hidden sm:block",children:(0,t.jsx)(ja,{size:20})}),e[48]=ae):ae=e[48];let G;e[49]===Symbol.for("react.memo_cache_sentinel")?(G=(0,t.jsx)("button",{onClick:C,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors hidden sm:block",children:(0,t.jsx)(Js,{size:20})}),e[49]=G):G=e[49];let ce;e[50]===Symbol.for("react.memo_cache_sentinel")?(ce=(0,t.jsx)("button",{onClick:R,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors",children:(0,t.jsx)(Ka,{size:20})}),e[50]=ce):ce=e[50];let be;e[51]===Symbol.for("react.memo_cache_sentinel")?(be=(0,t.jsx)(ss,{size:20}),e[51]=be):be=e[51];let ge;e[52]!==H?(ge=(0,t.jsx)("button",{onClick:H,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors",children:be}),e[52]=H,e[53]=ge):ge=e[53];let Je;e[54]===Symbol.for("react.memo_cache_sentinel")?(Je=(0,t.jsx)("div",{className:"w-px h-6 bg-white/20 mx-1 hidden sm:block"}),e[54]=Je):Je=e[54];let He;e[55]===Symbol.for("react.memo_cache_sentinel")?(He=(0,t.jsx)(we,{size:24}),e[55]=He):He=e[55];let $e;e[56]!==i?($e=(0,t.jsx)("button",{onClick:i,className:"text-white p-2 bg-white/10 hover:bg-white/20 rounded-full transition-all",children:He}),e[56]=i,e[57]=$e):$e=e[57];let Ee;e[58]!==ge||e[59]!==$e?(Ee=(0,t.jsxs)("div",{className:"flex items-center gap-1 sm:gap-3",onClick:Vl,children:[ae,G,ce,ge,Je,$e]}),e[58]=ge,e[59]=$e,e[60]=Ee):Ee=e[60];let Pe;e[61]!==Q||e[62]!==Ee?(Pe=(0,t.jsxs)("div",{className:"absolute top-0 left-0 right-0 p-4 z-20 flex items-center justify-between bg-gradient-to-b from-black/60 to-transparent",children:[Q,Ee]}),e[61]=Q,e[62]=Ee,e[63]=Pe):Pe=e[63];let Ne;e[64]!==r||e[65]!==E||e[66]!==W||e[67]!==o?(Ne=W&&r>0&&o===1&&(0,t.jsx)("button",{onClick:D=>{D.stopPropagation(),E()},className:"absolute left-6 z-10 p-4 bg-white/5 hover:bg-white/10 rounded-full text-white backdrop-blur-sm transition-all active:scale-90 hidden md:flex",children:(0,t.jsx)(as,{size:32})}),e[64]=r,e[65]=E,e[66]=W,e[67]=o,e[68]=Ne):Ne=e[68];const Ze=`translate(${m.x}px, ${m.y}px) scale(${o})`;let Te;e[69]!==Ze?(Te={transform:Ze},e[69]=Ze,e[70]=Te):Te=e[70];let Me;e[71]!==I?(Me=(0,t.jsx)("img",{ref:k,src:I,className:"max-w-[95vw] max-h-[85vh] object-contain select-none shadow-2xl rounded-sm",alt:"",draggable:!1}),e[71]=I,e[72]=Me):Me=e[72];let Fe;e[73]!==q||e[74]!==Te||e[75]!==Me?(Fe=(0,t.jsx)("div",{className:"relative transition-transform duration-200 ease-out cursor-grab active:cursor-grabbing",style:Te,onMouseDown:q,onClick:Kl,children:Me}),e[73]=q,e[74]=Te,e[75]=Me,e[76]=Fe):Fe=e[76];let Re;e[77]!==r||e[78]!==A||e[79]!==W||e[80]!==a.length||e[81]!==o?(Re=W&&r<a.length-1&&o===1&&(0,t.jsx)("button",{onClick:D=>{D.stopPropagation(),A()},className:"absolute right-6 z-10 p-4 bg-white/5 hover:bg-white/10 rounded-full text-white backdrop-blur-sm transition-all active:scale-90 hidden md:flex",children:(0,t.jsx)(hs,{size:32})}),e[77]=r,e[78]=A,e[79]=W,e[80]=a.length,e[81]=o,e[82]=Re):Re=e[82];let Le;e[83]!==Ne||e[84]!==Fe||e[85]!==Re?(Le=(0,t.jsxs)("div",{className:"w-full h-full relative flex items-center justify-center",children:[Ne,Fe,Re]}),e[83]=Ne,e[84]=Fe,e[85]=Re,e[86]=Le):Le=e[86];let qe;e[87]!==r||e[88]!==W||e[89]!==a||e[90]!==l?(qe=W&&(0,t.jsx)("div",{className:"absolute bottom-8 flex gap-3 p-3 bg-black/40 backdrop-blur-xl rounded-2xl border border-white/10 overflow-x-auto max-w-[90%] hide-scrollbar",onClick:Jl,children:a.map((D,Z)=>(0,t.jsx)("button",{onClick:()=>{R(),l(Z)},className:`size-14 rounded-xl overflow-hidden border-2 transition-all shrink-0 ${Z===r?"border-violet-500 scale-110 shadow-lg shadow-violet-500/20":"border-transparent opacity-40 hover:opacity-100"}`,children:(0,t.jsx)("img",{src:D,className:"size-full object-cover",alt:""})},Z))}),e[87]=r,e[88]=W,e[89]=a,e[90]=l,e[91]=qe):qe=e[91];let U;e[92]!==W||e[93]!==o?(U=o===1&&W&&(0,t.jsx)("div",{className:"absolute bottom-4 text-white/30 text-[10px] uppercase tracking-widest font-bold md:hidden",children:"Swipe to navigate"}),e[92]=W,e[93]=o,e[94]=U):U=e[94];let Y;return e[95]!==J||e[96]!==ee||e[97]!==de||e[98]!==le||e[99]!==i||e[100]!==Pe||e[101]!==Le||e[102]!==qe||e[103]!==U?(Y=(0,t.jsxs)("div",{ref:w,className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-md flex flex-col items-center justify-center overflow-hidden touch-none",onMouseMove:J,onMouseUp:se,onMouseLeave:se,onTouchStart:le,onTouchMove:de,onTouchEnd:ee,onClick:i,children:[Pe,Le,qe,U]}),e[95]=J,e[96]=ee,e[97]=de,e[98]=le,e[99]=i,e[100]=Pe,e[101]=Le,e[102]=qe,e[103]=U,e[104]=Y):Y=e[104],Y},Ql=Hl;function Ul(s){return Math.min(s+.5,4)}function Vl(s){return s.stopPropagation()}function Kl(s){return s.stopPropagation()}function Jl(s){return s.stopPropagation()}var Xl=({type:s,onComplete:e,onSwitch:a})=>{const{login:n,signup:i}=fe(),{addToast:l}=Ce(),[r,o]=(0,b.useState)({name:"",email:"",username:"",password:""}),[c,d]=(0,b.useState)(!1),[m,u]=(0,b.useState)(null),f=async h=>{h.preventDefault(),d(!0),u(null);try{s==="login"?(await n({email:r.email,password:r.password}),l("Welcome back!")):(await i({email:r.email,password:r.password,username:r.username,name:r.name}),l("Account created successfully!")),e()}catch(p){console.error("Auth error:",p),u(p.message||"Authentication failed. Please check your credentials."),l("Authentication failed!")}finally{d(!1)}};return(0,t.jsxs)("div",{className:"max-w-md mx-auto p-8 w-full animate-in fade-in slide-in-from-bottom-5 duration-300",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsx)("div",{className:"flex justify-center mb-4",children:(0,t.jsx)("div",{className:"bg-black dark:bg-white dark:text-black text-white p-3 rounded-2xl shadow-lg",children:(0,t.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",alt:"Logo",className:"w-10 h-10 rounded-xl"})})}),(0,t.jsx)("h2",{className:"text-3xl font-extrabold mb-2 dark:text-white tracking-tight",children:s==="login"?"Welcome back!":"Join Sysm today"}),(0,t.jsx)("p",{className:"text-zinc-500 font-medium",children:"The decentralized social network"})]}),m&&(0,t.jsxs)("div",{className:"mb-6 p-4 bg-rose-50 dark:bg-rose-900/20 border border-rose-100 dark:border-rose-800 rounded-xl flex items-center gap-3 text-rose-600 dark:text-rose-400 text-sm",children:[(0,t.jsx)(ns,{size:18}),(0,t.jsx)("span",{children:m})]}),(0,t.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,t.jsx)(Ae,{label:"Email",type:"email",placeholder:"john@example.com",value:r.email,onChange:h=>o({...r,email:h.target.value}),required:!0}),s==="signup"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Ae,{label:"Name",placeholder:"John Doe",value:r.name,onChange:h=>o({...r,name:h.target.value}),required:!0}),(0,t.jsx)(Ae,{label:"Username",placeholder:"johndoe",value:r.username,onChange:h=>o({...r,username:h.target.value}),required:!0})]}),(0,t.jsx)(Ae,{label:"Password",type:"password",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",value:r.password,onChange:h=>o({...r,password:h.target.value}),required:!0}),(0,t.jsx)(ue,{type:"submit",className:"w-full justify-center py-3 mt-6 text-lg",disabled:c,children:c?(0,t.jsx)(oe,{size:24,className:"animate-spin"}):s==="login"?"Log in":"Sign up"})]}),(0,t.jsxs)("div",{className:"mt-8 text-center text-sm",children:[(0,t.jsx)("span",{className:"text-zinc-500",children:s==="login"?"Don't have an account?":"Already have an account?"}),(0,t.jsx)("button",{onClick:a,className:"font-bold ml-1 hover:underline dark:text-white",children:s==="login"?"Sign up":"Log in"})]})]})},Yl=Xl,Gl=K(),Zl=s=>{const e=(0,Gl.c)(2),{children:a}=s;let n;return e[0]!==a?(n=(0,t.jsx)("div",{className:"w-full animate-in fade-in slide-in-from-bottom-2 duration-300 ease-out",children:a}),e[0]=a,e[1]=n):n=e[1],n},_e=Zl,er=K(),tr=s=>{const e=(0,er.c)(24),{user:a,onClick:n,isAddStory:i}=s,l=i===void 0?!1:i,r=`relative p-0.5 rounded-full ${l?"bg-transparent":"bg-gradient-to-tr from-yellow-400 via-pink-500 to-violet-600"}`;let o;e[0]!==a.avatar||e[1]!==a.handle?(o=(0,t.jsx)(he,{src:a.avatar,alt:a.handle,className:"object-cover"}),e[0]=a.avatar,e[1]=a.handle,e[2]=o):o=e[2];let c;e[3]!==a.handle?.[0]?(c=a.handle?.[0]?.toUpperCase(),e[3]=a.handle?.[0],e[4]=c):c=e[4];let d;e[5]!==c?(d=(0,t.jsx)(pe,{children:c}),e[5]=c,e[6]=d):d=e[6];let m;e[7]!==o||e[8]!==d?(m=(0,t.jsxs)(xe,{className:"size-14 sm:size-16 border border-zinc-100 dark:border-zinc-800",children:[o,d]}),e[7]=o,e[8]=d,e[9]=m):m=e[9];let u;e[10]!==l?(u=l&&(0,t.jsx)("div",{className:"absolute bottom-0 right-0 bg-violet-600 border-2 border-white dark:border-black rounded-full p-1 text-white shadow-lg",children:(0,t.jsx)(De,{size:14,strokeWidth:3})}),e[10]=l,e[11]=u):u=e[11];let f;e[12]!==m||e[13]!==u?(f=(0,t.jsx)("div",{className:"bg-white dark:bg-black rounded-full p-0.5",children:(0,t.jsxs)("div",{className:"relative",children:[m,u]})}),e[12]=m,e[13]=u,e[14]=f):f=e[14];let h;e[15]!==r||e[16]!==f?(h=(0,t.jsx)("div",{className:r,children:f}),e[15]=r,e[16]=f,e[17]=h):h=e[17];const p=l?"Add Story":a.handle;let x;e[18]!==p?(x=(0,t.jsx)("span",{className:"text-[11px] font-semibold text-zinc-600 dark:text-zinc-400 truncate w-16 text-center leading-tight",children:p}),e[18]=p,e[19]=x):x=e[19];let g;return e[20]!==n||e[21]!==x||e[22]!==h?(g=(0,t.jsxs)("button",{onClick:n,className:"flex flex-col items-center gap-2 group shrink-0",children:[h,x]}),e[20]=n,e[21]=x,e[22]=h,e[23]=g):g=e[23],g},At=tr,Se=K();function Ot(s){const e=(0,Se.c)(4);let a;e[0]!==s?({...a}=s,e[0]=s,e[1]=a):a=e[1];let n;return e[2]!==a?(n=(0,t.jsx)(Za,{"data-slot":"alert-dialog",...a}),e[2]=a,e[3]=n):n=e[3],n}function sr(s){const e=(0,Se.c)(4);let a;e[0]!==s?({...a}=s,e[0]=s,e[1]=a):a=e[1];let n;return e[2]!==a?(n=(0,t.jsx)(ga,{"data-slot":"alert-dialog-portal",...a}),e[2]=a,e[3]=n):n=e[3],n}function ar(s){const e=(0,Se.c)(8);let a,n;e[0]!==s?({className:a,...n}=s,e[0]=s,e[1]=a,e[2]=n):(a=e[1],n=e[2]);let i;e[3]!==a?(i=ne("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),e[3]=a,e[4]=i):i=e[4];let l;return e[5]!==n||e[6]!==i?(l=(0,t.jsx)(na,{"data-slot":"alert-dialog-overlay",className:i,...n}),e[5]=n,e[6]=i,e[7]=l):l=e[7],l}function Dt(s){const e=(0,Se.c)(9);let a,n;e[0]!==s?({className:a,...n}=s,e[0]=s,e[1]=a,e[2]=n):(a=e[1],n=e[2]);let i;e[3]===Symbol.for("react.memo_cache_sentinel")?(i=(0,t.jsx)(ar,{}),e[3]=i):i=e[3];let l;e[4]!==a?(l=ne("bg-white dark:bg-zinc-950 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-2xl border border-zinc-100 dark:border-zinc-800 p-6 shadow-xl duration-200 sm:max-w-md",a),e[4]=a,e[5]=l):l=e[5];let r;return e[6]!==n||e[7]!==l?(r=(0,t.jsxs)(sr,{children:[i,(0,t.jsx)(za,{"data-slot":"alert-dialog-content",className:l,...n})]}),e[6]=n,e[7]=l,e[8]=r):r=e[8],r}function Bt(s){const e=(0,Se.c)(8);let a,n;e[0]!==s?({className:a,...n}=s,e[0]=s,e[1]=a,e[2]=n):(a=e[1],n=e[2]);let i;e[3]!==a?(i=ne("flex flex-col gap-2 text-center sm:text-left",a),e[3]=a,e[4]=i):i=e[4];let l;return e[5]!==n||e[6]!==i?(l=(0,t.jsx)("div",{"data-slot":"alert-dialog-header",className:i,...n}),e[5]=n,e[6]=i,e[7]=l):l=e[7],l}function Wt(s){const e=(0,Se.c)(8);let a,n;e[0]!==s?({className:a,...n}=s,e[0]=s,e[1]=a,e[2]=n):(a=e[1],n=e[2]);let i;e[3]!==a?(i=ne("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),e[3]=a,e[4]=i):i=e[4];let l;return e[5]!==n||e[6]!==i?(l=(0,t.jsx)("div",{"data-slot":"alert-dialog-footer",className:i,...n}),e[5]=n,e[6]=i,e[7]=l):l=e[7],l}function Ht(s){const e=(0,Se.c)(8);let a,n;e[0]!==s?({className:a,...n}=s,e[0]=s,e[1]=a,e[2]=n):(a=e[1],n=e[2]);let i;e[3]!==a?(i=ne("text-lg font-semibold",a),e[3]=a,e[4]=i):i=e[4];let l;return e[5]!==n||e[6]!==i?(l=(0,t.jsx)(Ys,{"data-slot":"alert-dialog-title",className:i,...n}),e[5]=n,e[6]=i,e[7]=l):l=e[7],l}function Qt(s){const e=(0,Se.c)(8);let a,n;e[0]!==s?({className:a,...n}=s,e[0]=s,e[1]=a,e[2]=n):(a=e[1],n=e[2]);let i;e[3]!==a?(i=ne("text-muted-foreground text-sm",a),e[3]=a,e[4]=i):i=e[4];let l;return e[5]!==n||e[6]!==i?(l=(0,t.jsx)(ia,{"data-slot":"alert-dialog-description",className:i,...n}),e[5]=n,e[6]=i,e[7]=l):l=e[7],l}function Ut(s){const e=(0,Se.c)(8);let a,n;e[0]!==s?({className:a,...n}=s,e[0]=s,e[1]=a,e[2]=n):(a=e[1],n=e[2]);let i;e[3]!==a?(i=ne("inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-bold transition-all active:scale-95 bg-zinc-900 text-white hover:bg-zinc-800 dark:bg-white dark:text-black dark:hover:bg-zinc-200",a),e[3]=a,e[4]=i):i=e[4];let l;return e[5]!==n||e[6]!==i?(l=(0,t.jsx)(sa,{className:i,...n}),e[5]=n,e[6]=i,e[7]=l):l=e[7],l}function Vt(s){const e=(0,Se.c)(8);let a,n;e[0]!==s?({className:a,...n}=s,e[0]=s,e[1]=a,e[2]=n):(a=e[1],n=e[2]);let i;e[3]!==a?(i=ne("inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-bold border border-zinc-200 bg-white text-zinc-900 hover:bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-950 dark:text-zinc-50 dark:hover:bg-zinc-900",a),e[3]=a,e[4]=i):i=e[4];let l;return e[5]!==n||e[6]!==i?(l=(0,t.jsx)(yn,{className:i,...n}),e[5]=n,e[6]=i,e[7]=l):l=e[7],l}var nr=K();function ir(s){const e=(0,nr.c)(8);let a,n;e[0]!==s?({className:a,...n}=s,e[0]=s,e[1]=a,e[2]=n):(a=e[1],n=e[2]);let i;e[3]!==a?(i=ne("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),e[3]=a,e[4]=i):i=e[4];let l;return e[5]!==n||e[6]!==i?(l=(0,t.jsx)("textarea",{"data-slot":"textarea",className:i,...n}),e[5]=n,e[6]=i,e[7]=l):l=e[7],l}var lr=K(),rr=()=>{const s=(0,lr.c)(1);let e;return s[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,t.jsx)(Xs,{size:16,className:"fill-blue-500 text-white ml-1 inline-block shrink-0"}),s[0]=e):e=s[0],e},ct=rr,or=K(),cr=s=>{const e=(0,or.c)(18),{poll:a,onVote:n}=s,i=a.options.reduce(dr,0),[l,r]=(0,b.useState)(null);let o;e[0]!==n||e[1]!==l?(o=p=>{l||(r(p),n&&n(p))},e[0]=n,e[1]=l,e[2]=o):o=e[2];const c=o;let d;if(e[3]!==c||e[4]!==a.options||e[5]!==i||e[6]!==l){let p;e[8]!==c||e[9]!==i||e[10]!==l?(p=(x,g)=>{const v=i>0?Math.round((x.votes+(l===x.id?1:0))/(i+(l?1:0))*100):0,j=l===x.id;return(0,t.jsxs)("div",{onClick:N=>{N.stopPropagation(),c(x.id)},className:`relative h-10 w-full rounded-xl overflow-hidden cursor-pointer border ${j?"border-violet-500 dark:border-violet-500":"border-zinc-200 dark:border-zinc-700"}`,children:[l&&(0,t.jsx)("div",{className:"absolute top-0 left-0 h-full bg-zinc-200 dark:bg-zinc-800 transition-all duration-500",style:{width:`${v}%`}}),(0,t.jsxs)("div",{className:"absolute inset-0 flex items-center justify-between px-4 z-10",children:[(0,t.jsxs)("span",{className:`font-medium text-sm ${j?"text-violet-600 font-bold":"text-zinc-700 dark:text-zinc-200"}`,children:[x.text," ",j&&(0,t.jsx)(ts,{size:14,className:"inline ml-1 mb-0.5"})]}),l&&(0,t.jsxs)("span",{className:"text-sm font-bold text-zinc-900 dark:text-white",children:[v,"%"]})]})]},x.id||g)},e[8]=c,e[9]=i,e[10]=l,e[11]=p):p=e[11],d=a.options.map(p),e[3]=c,e[4]=a.options,e[5]=i,e[6]=l,e[7]=d}else d=e[7];const m=i+(l?1:0),u=l?"6 days left":"Click to vote";let f;e[12]!==m||e[13]!==u?(f=(0,t.jsxs)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400 pl-1",children:[m," votes â€¢"," ",u]}),e[12]=m,e[13]=u,e[14]=f):f=e[14];let h;return e[15]!==d||e[16]!==f?(h=(0,t.jsxs)("div",{className:"mt-3 space-y-2",children:[d,f]}),e[15]=d,e[16]=f,e[17]=h):h=e[17],h},Kt=cr;function dr(s,e){return s+e.votes}var mr=K(),ur=s=>{const e=(0,mr.c)(23),{user:a,time:n,content:i}=s;let l;e[0]!==a.avatar||e[1]!==a.handle?(l=(0,t.jsx)(he,{src:a.avatar,alt:a.handle}),e[0]=a.avatar,e[1]=a.handle,e[2]=l):l=e[2];let r;e[3]!==a.handle[0]?(r=a.handle[0]?.toUpperCase(),e[3]=a.handle[0],e[4]=r):r=e[4];let o;e[5]!==r?(o=(0,t.jsx)(pe,{children:r}),e[5]=r,e[6]=o):o=e[6];let c;e[7]!==l||e[8]!==o?(c=(0,t.jsxs)(xe,{className:"size-6",children:[l,o]}),e[7]=l,e[8]=o,e[9]=c):c=e[9];let d;e[10]!==a.handle?(d=(0,t.jsx)("span",{className:"font-semibold text-sm",children:a.handle}),e[10]=a.handle,e[11]=d):d=e[11];let m;e[12]!==n?(m=(0,t.jsxs)("span",{className:"text-zinc-500 text-sm",children:["â€¢ ",n]}),e[12]=n,e[13]=m):m=e[13];let u;e[14]!==c||e[15]!==d||e[16]!==m?(u=(0,t.jsxs)("div",{className:"flex items-center gap-x-2 mb-2",children:[c,d,m]}),e[14]=c,e[15]=d,e[16]=m,e[17]=u):u=e[17];let f;e[18]!==i?(f=(0,t.jsx)("p",{className:"text-sm text-zinc-800 dark:text-zinc-300 whitespace-pre-line",children:i}),e[18]=i,e[19]=f):f=e[19];let h;return e[20]!==u||e[21]!==f?(h=(0,t.jsxs)("div",{className:"p-4",children:[u,f]}),e[20]=u,e[21]=f,e[22]=h):h=e[22],h},Jt=ur,fr=K(),xr=s=>{const e=(0,fr.c)(17),{icon:a,count:n,onClick:i,active:l,activeColorClass:r}=s,o=r===void 0?"text-violet-600":r,c=a;let d;e[0]!==i?(d=j=>{j.stopPropagation(),i&&i(j)},e[0]=i,e[1]=d):d=e[1];const m=`group flex items-center gap-x-2 text-[13px] font-medium transition-all ${l?o:"text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-300"}`,u=`rounded-full p-2 transition-colors ${l?"":"group-hover:bg-zinc-100 dark:group-hover:bg-zinc-800"}`,f=l?2.5:2,h=l?"fill-current":"";let p;e[2]!==c||e[3]!==f||e[4]!==h?(p=(0,t.jsx)(c,{size:18,strokeWidth:f,className:h}),e[2]=c,e[3]=f,e[4]=h,e[5]=p):p=e[5];let x;e[6]!==u||e[7]!==p?(x=(0,t.jsx)("div",{className:u,children:p}),e[6]=u,e[7]=p,e[8]=x):x=e[8];let g;e[9]!==l||e[10]!==n?(g=n!=null&&(0,t.jsx)("span",{className:l?"font-bold":"",children:n||0}),e[9]=l,e[10]=n,e[11]=g):g=e[11];let v;return e[12]!==d||e[13]!==m||e[14]!==x||e[15]!==g?(v=(0,t.jsxs)("button",{onClick:d,className:m,children:[x,g]}),e[12]=d,e[13]=m,e[14]=x,e[15]=g,e[16]=v):v=e[16],v},Xe=xr,hr=K(),pr=s=>{const e=(0,hr.c)(12),{src:a,poster:n}=s,i=(0,b.useRef)(null);let l,r;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=()=>{const h=new IntersectionObserver(x=>{const[g]=x;i.current?.plyr&&(g.isIntersecting?i.current.plyr.play().catch(()=>{i.current.plyr.muted=!0,i.current.plyr.play()}):i.current.plyr.pause())},{threshold:.6}),p=i.current?.elements?.container;return p&&h.observe(p),()=>{p&&h.unobserve(p)}},r=[],e[0]=l,e[1]=r):(l=e[0],r=e[1]),(0,b.useEffect)(l,r);let o;e[2]!==a?(o=[{src:a,type:"video/mp4"}],e[2]=a,e[3]=o):o=e[3];let c;e[4]!==n||e[5]!==o?(c={type:"video",sources:o,poster:n},e[4]=n,e[5]=o,e[6]=c):c=e[6];let d;e[7]===Symbol.for("react.memo_cache_sentinel")?(d={controls:["play-large","play","progress","current-time","mute","volume","fullscreen"],settings:["quality","speed"],ratio:"16:9",clickToPlay:!0,hideControls:!0,resetOnEnd:!0},e[7]=d):d=e[7];let m;e[8]!==c?(m={source:c,options:d},e[8]=c,e[9]=m):m=e[9];const u=m;let f;return e[10]!==u?(f=(0,t.jsx)("div",{className:"mt-3 overflow-hidden rounded-2xl shadow-sm border border-zinc-100 dark:border-zinc-800 bg-black",onClick:gr,children:(0,t.jsx)(ls,{ref:i,...u})}),e[10]=u,e[11]=f):f=e[11],f},br=pr;function gr(s){return s.stopPropagation()}var vr=K(),jr=s=>{const e=(0,vr.c)(17),{file:a}=s;let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,t.jsx)("div",{className:"size-10 rounded-xl bg-violet-100 dark:bg-violet-900/30 flex items-center justify-center text-violet-600",children:(0,t.jsx)(bs,{size:20})}),e[0]=n):n=e[0];let i;e[1]!==a.name?(i=(0,t.jsx)("div",{className:"text-sm font-bold truncate dark:text-white",children:a.name}),e[1]=a.name,e[2]=i):i=e[2];const l=a.size/1024/1024;let r;e[3]!==l?(r=l.toFixed(2),e[3]=l,e[4]=r):r=e[4];let o;e[5]!==r?(o=(0,t.jsxs)("div",{className:"text-xs text-zinc-500 uppercase",children:[r," MB"]}),e[5]=r,e[6]=o):o=e[6];let c;e[7]!==i||e[8]!==o?(c=(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[i,o]}),e[7]=i,e[8]=o,e[9]=c):c=e[9];let d;e[10]===Symbol.for("react.memo_cache_sentinel")?(d=(0,t.jsx)(ss,{size:18}),e[10]=d):d=e[10];let m;e[11]!==a.name||e[12]!==a.url?(m=(0,t.jsx)("a",{href:a.url,download:a.name,className:"p-2 text-zinc-400 hover:text-violet-600 transition-colors",onClick:wr,children:d}),e[11]=a.name,e[12]=a.url,e[13]=m):m=e[13];let u;return e[14]!==c||e[15]!==m?(u=(0,t.jsxs)("div",{className:"mt-3 flex items-center gap-3 p-3 rounded-2xl border border-zinc-100 dark:border-zinc-800 bg-zinc-50/50 dark:bg-zinc-900/10 group hover:border-violet-500/30 transition-colors",children:[n,c,m]}),e[14]=c,e[15]=m,e[16]=u):u=e[16],u},yr=jr;function wr(s){return s.stopPropagation()}var Nr=K(),zr=s=>{const e=(0,Nr.c)(3),{items:a}=s,n=a===void 0?[]:a,{openLightbox:i}=Pt();if(!n||n.length===0)return null;const l=Array.isArray(n)?n:[n],r=l.filter(_r),o=l.filter(Cr),c=h=>{const p=r.filter(Sr).map($r),x=r[h];i(p,p.indexOf(x.url||x.src))},d="mt-3 space-y-2",m=r.length>0&&(0,t.jsx)("div",{className:`grid gap-2 rounded-2xl overflow-hidden border border-zinc-100 dark:border-zinc-800 ${r.length===1?"grid-cols-1":r.length===2?"grid-cols-2 aspect-[16/9]":(r.length===3,"grid-cols-2 grid-rows-2 aspect-[16/9]")}`,children:r.map((h,p)=>(0,t.jsx)("div",{className:`relative overflow-hidden bg-zinc-100 dark:bg-zinc-900 cursor-pointer ${r.length===3&&p===0?"row-span-2":""}`,onClick:x=>{h.type==="image"&&(x.stopPropagation(),c(p))},children:h.type==="video"?(0,t.jsx)(br,{src:h.url,poster:h.poster}):(0,t.jsx)("img",{src:h.url||h.src,className:"size-full object-cover hover:scale-[1.02] transition-transform duration-500",alt:"",loading:"lazy"})},p))}),u=o.map(Pr);let f;return e[0]!==m||e[1]!==u?(f=(0,t.jsxs)("div",{className:d,children:[m,u]}),e[0]=m,e[1]=u,e[2]=f):f=e[2],f},kr=zr;function _r(s){return s.type==="image"||s.type==="video"}function Cr(s){return s.type==="file"}function Sr(s){return s.type==="image"}function $r(s){return s.url||s.src}function Pr(s,e){return(0,t.jsx)(yr,{file:s},e)}var Mr=K(),Fr=s=>{const e=(0,Mr.c)(51),{currentUser:a,newComment:n,setNewComment:i,handleSubmitComment:l,loading:r,selectedFiles:o,setSelectedFiles:c,isUploading:d}=s;let m;e[0]!==o?(m=o===void 0?[]:o,e[0]=o,e[1]=m):m=e[1];const u=m,f=(0,b.useRef)(null);let h;e[2]!==c?(h=L=>{const z=Array.from(L.target.files);c&&c(I=>[...I,...z])},e[2]=c,e[3]=h):h=e[3];const p=h;let x;e[4]!==c?(x=L=>{c&&c(z=>z.filter((I,W)=>W!==L))},e[4]=c,e[5]=x):x=e[5];const g=x;if(!a){let L;return e[6]===Symbol.for("react.memo_cache_sentinel")?(L=(0,t.jsx)("div",{className:"p-6 text-center border-y border-zinc-100 dark:border-zinc-800 bg-zinc-50/30 dark:bg-zinc-900/10",children:(0,t.jsx)("p",{className:"text-zinc-500 text-sm",children:"Please login to join the conversation."})}),e[6]=L):L=e[6],L}let v;e[7]!==a.avatar||e[8]!==a.handle?(v=(0,t.jsx)(he,{src:a.avatar,alt:a.handle,className:"object-cover"}),e[7]=a.avatar,e[8]=a.handle,e[9]=v):v=e[9];let j;e[10]!==a.handle?.[0]?(j=a.handle?.[0]?.toUpperCase(),e[10]=a.handle?.[0],e[11]=j):j=e[11];let N;e[12]!==j?(N=(0,t.jsx)(pe,{children:j}),e[12]=j,e[13]=N):N=e[13];let y;e[14]!==v||e[15]!==N?(y=(0,t.jsxs)(xe,{className:"size-9 border border-zinc-200 dark:border-zinc-700",children:[v,N]}),e[14]=v,e[15]=N,e[16]=y):y=e[16];let w;e[17]!==i?(w=L=>i(L.target.value),e[17]=i,e[18]=w):w=e[18];let k;e[19]!==n||e[20]!==w?(k=(0,t.jsx)("textarea",{id:"comment-input",className:"w-full bg-transparent outline-none text-base min-h-[60px] resize-none dark:text-white placeholder:text-zinc-500",placeholder:"Post your reply...",value:n,onChange:w}),e[19]=n,e[20]=w,e[21]=k):k=e[21];let _;e[22]!==g||e[23]!==u?(_=u.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mt-2 mb-2",children:u.map((L,z)=>(0,t.jsxs)("div",{className:"relative size-20 rounded-xl overflow-hidden border border-zinc-200 dark:border-zinc-800",children:[L.type.startsWith("image/")?(0,t.jsx)("img",{src:URL.createObjectURL(L),className:"size-full object-cover",alt:""}):(0,t.jsx)("div",{className:"size-full flex items-center justify-center bg-zinc-100 dark:bg-zinc-800",children:(0,t.jsx)(cs,{size:20,className:"text-zinc-500"})}),(0,t.jsx)("button",{onClick:()=>g(z),className:"absolute top-1 right-1 bg-black/60 text-white rounded-full p-1 hover:bg-black transition-colors",children:(0,t.jsx)(we,{size:12})})]},z))}),e[22]=g,e[23]=u,e[24]=_):_=e[24];let C;e[25]===Symbol.for("react.memo_cache_sentinel")?(C=()=>f.current?.click(),e[25]=C):C=e[25];let F;e[26]===Symbol.for("react.memo_cache_sentinel")?(F=(0,t.jsx)("button",{type:"button",onClick:C,className:"text-violet-600 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full p-2 transition-colors",title:"Attach media",children:(0,t.jsx)(is,{size:20})}),e[26]=F):F=e[26];let P;e[27]!==p?(P=(0,t.jsxs)("div",{className:"flex text-violet-600 gap-1",children:[F,(0,t.jsx)("input",{type:"file",ref:f,onChange:p,multiple:!0,className:"hidden",accept:"image/*,video/*,application/pdf"})]}),e[27]=p,e[28]=P):P=e[28];let T;e[29]!==d||e[30]!==r||e[31]!==n||e[32]!==u.length?(T=!n.trim()&&u.length===0||r||d,e[29]=d,e[30]=r,e[31]=n,e[32]=u.length,e[33]=T):T=e[33];let R;e[34]!==d||e[35]!==r?(R=r||d?(0,t.jsx)(oe,{size:16,className:"animate-spin text-white mx-auto"}):"Reply",e[34]=d,e[35]=r,e[36]=R):R=e[36];let M;e[37]!==l||e[38]!==T||e[39]!==R?(M=(0,t.jsx)(ue,{className:"!w-auto px-5 py-1.5 text-sm font-bold min-w-[70px]",onClick:l,disabled:T,children:R}),e[37]=l,e[38]=T,e[39]=R,e[40]=M):M=e[40];let E;e[41]!==P||e[42]!==M?(E=(0,t.jsxs)("div",{className:"flex justify-between items-center mt-2 pt-3 border-t border-zinc-100 dark:border-zinc-800",children:[P,M]}),e[41]=P,e[42]=M,e[43]=E):E=e[43];let B;e[44]!==k||e[45]!==_||e[46]!==E?(B=(0,t.jsxs)("div",{className:"flex-1",children:[k,_,E]}),e[44]=k,e[45]=_,e[46]=E,e[47]=B):B=e[47];let A;return e[48]!==B||e[49]!==y?(A=(0,t.jsx)("div",{className:"p-4 border-y border-zinc-100 dark:border-zinc-800 bg-zinc-50/30 dark:bg-zinc-900/10",children:(0,t.jsxs)("div",{className:"flex gap-3",children:[y,B]})}),e[48]=B,e[49]=y,e[50]=A):A=e[50],A},Rr=Fr;const Lr=(s,e,a,n)=>{const[i,l]=(0,b.useState)(!1),[r,o]=(0,b.useState)(!1),[c,d]=(0,b.useState)(e||{comments:0,likes:0,mirrors:0});return(0,b.useEffect)(()=>{a&&s&&ze(s)&&ze(a.id)&&(ti(s,a.id).then(l).catch(()=>l(!1)),ai(s,a.id).then(o).catch(()=>o(!1)))},[s,a]),{liked:i,reposted:r,localStats:c,setLocalStats:d,handleLike:async f=>{if(f&&f.stopPropagation(),!a)return n("Please login to like!","error");if(!ze(s)||!ze(a.id)){const h=!i;l(h),d(p=>({...p,likes:h?(p.likes||0)+1:(p.likes||0)-1}));return}try{const h=await ei(s,a.id);l(h),d(p=>({...p,likes:h?(p.likes||0)+1:(p.likes||0)-1}))}catch(h){console.error("Failed to toggle like:",h)}},handleRepost:async f=>{if(f&&f.stopPropagation(),!a)return n("Please login to repost!","error");if(!ze(s)||!ze(a.id)){const h=!r;o(h),d(p=>({...p,mirrors:h?(p.mirrors||0)+1:(p.mirrors||0)-1}));return}try{const h=await si(s,a.id);o(h),d(p=>({...p,mirrors:h?(p.mirrors||0)+1:(p.mirrors||0)-1})),n(h?"Reposted!":"Removed repost")}catch(h){console.error("Failed to toggle repost:",h),n("Failed to update repost","error")}}}};var Os=({id:s,user:e,timeAgo:a,content:n,contentClass:i,media:l,quotedPost:r,stats:o,onClick:c,repostedBy:d,onUserClick:m,currentUser:u,showToast:f,poll:h,isDetail:p,initialComments:x,onDelete:g,isComment:v,onReply:j,community:N})=>{const y=je(),{liked:w,reposted:k,localStats:_,setLocalStats:C,handleLike:F,handleRepost:P}=Lr(s,o,u,f),{deletePost:T,updatePost:R}=ht(),[M,E]=(0,b.useState)(x||[]),[B,A]=(0,b.useState)(""),[L,z]=(0,b.useState)(!1),[I,W]=(0,b.useState)(!1),[S,q]=(0,b.useState)(!1),[$,J]=(0,b.useState)(!0),[X,se]=(0,b.useState)([]),[ie,le]=(0,b.useState)(!1),[re,de]=(0,b.useState)(!1),[me,ee]=(0,b.useState)(!1),[te,H]=(0,b.useState)(n),[V,Q]=(0,b.useState)(l||[]),[ae,G]=(0,b.useState)([]),[ce,be]=(0,b.useState)(!1),[ge,Je]=(0,b.useState)(!1),He=(0,b.useRef)(null),$e=(0,b.useRef)(M);(0,b.useEffect)(()=>{$e.current=M},[M]);const Ee=async()=>{const U=JSON.stringify(V)!==JSON.stringify(l||[])||ae.length>0;if(!te.trim()||te===n&&!U){ee(!1);return}be(!0);try{const Y=[];for(const D of ae){const Z=await Ie(D);Y.push(Z)}await R(s,{content:te,media:[...V,...Y]}),G([]),ee(!1),f&&f("Post updated")}catch(Y){console.error("Failed to update post:",Y),f&&f("Failed to update post")}finally{be(!1)}},Pe=async U=>{U&&U.stopPropagation();try{await T(s),f&&f("Post deleted successfully"),g&&g(s)}catch(Y){console.error("Failed to delete post:",Y),f&&f("Failed to delete post")}finally{de(!1)}},Ne=(0,b.useCallback)(async(U=!1)=>{if(s){U?q(!0):z(!0);try{const Y=$e.current,D=await Gn(s,U&&Y.length>0?Y[Y.length-1].created_at:null,10);D.length<10?J(!1):J(!0),E(U?Z=>[...Z,...D]:D)}catch(Y){console.error("Failed to load comments:",Y)}finally{z(!1),q(!1)}}},[s]);(0,b.useEffect)(()=>{p&&s&&Ne()},[p,s,Ne]);const Ze=async U=>{if(U.preventDefault(),!(!B.trim()&&X.length===0||!u)){W(!0),le(!0);try{const Y=[];for(const D of X){const Z=await Ie(D);Y.push(Z)}await Zn(s,u.id,B,Y),A(""),se([]),C(D=>({...D,comments:(D.comments||0)+1})),f&&f("Reply posted!"),Ne()}catch(Y){console.error("Failed to post comment:",Y),f&&f("Failed to post reply.")}finally{W(!1),le(!1)}}},Te=U=>{U.stopPropagation();const Y=`${window.location.origin}/post/${s}`;navigator.clipboard.writeText(Y),f&&f("Link copied to clipboard!")},Me=({trigger:U})=>(0,t.jsxs)(Es,{children:[(0,t.jsx)(Ts,{asChild:!0,onClick:Y=>Y.stopPropagation(),children:U}),(0,t.jsxs)(qs,{align:"end",className:"w-48 rounded-xl bg-white dark:bg-zinc-900 border-zinc-100 dark:border-zinc-800",children:[(0,t.jsxs)(Ve,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5",onClick:Te,children:[(0,t.jsx)(us,{size:16}),(0,t.jsx)("span",{children:"Copy link to post"})]}),!v&&(0,t.jsxs)(Ve,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5",onClick:Y=>{Y.stopPropagation(),f&&f("Post reported")},children:[(0,t.jsx)(ma,{size:16}),(0,t.jsx)("span",{children:"Report post"})]}),!Fe&&(0,t.jsxs)(Ve,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5 text-rose-500 focus:text-rose-500",onClick:Y=>{Y.stopPropagation(),f&&f("User blocked")},children:[(0,t.jsx)(on,{size:16}),(0,t.jsxs)("span",{children:["Block @",e.handle]})]}),Fe&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Cl,{className:"bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsxs)(Ve,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-900 py-2.5",onClick:Y=>{Y.stopPropagation(),ee(!0)},children:[(0,t.jsx)(ps,{size:16}),(0,t.jsx)("span",{children:"Edit post"})]}),(0,t.jsxs)(Ve,{className:"gap-2 cursor-pointer focus:bg-rose-50 dark:focus:bg-rose-900/20 py-2.5 text-rose-500 focus:text-rose-500",onClick:Y=>{Y.stopPropagation(),de(!0)},children:[(0,t.jsx)(fs,{size:16}),(0,t.jsx)("span",{children:"Delete post"})]})]})]})]}),Fe=u?.handle===e.handle,Re=U=>{if(!U)return null;const Y=me?V:U;return!Y||Array.isArray(Y)&&Y.length===0?null:me?(0,t.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,t.jsxs)("div",{className:"grid gap-2 grid-cols-2 sm:grid-cols-3",children:[V.map((D,Z)=>(0,t.jsxs)("div",{className:"relative aspect-square rounded-xl overflow-hidden border border-zinc-200 dark:border-zinc-800 group",children:[D.type==="video"?(0,t.jsx)("div",{className:"size-full bg-zinc-100 dark:bg-zinc-900 flex items-center justify-center",children:(0,t.jsx)(rt,{size:24,className:"text-zinc-400"})}):(0,t.jsx)("img",{src:D.url||D.src,className:"size-full object-cover",alt:""}),(0,t.jsx)("button",{onClick:ke=>{ke.stopPropagation(),Q(ve=>ve.filter((et,tt)=>tt!==Z))},className:"absolute top-1.5 right-1.5 size-7 rounded-full bg-black/60 text-white flex items-center justify-center hover:bg-black transition-colors",children:(0,t.jsx)(we,{size:16})})]},`old-${Z}`)),ae.map((D,Z)=>(0,t.jsxs)("div",{className:"relative aspect-square rounded-xl overflow-hidden border-2 border-dashed border-violet-500 bg-violet-50/10 group",children:[D.type.startsWith("image/")?(0,t.jsx)("img",{src:URL.createObjectURL(D),className:"size-full object-cover",alt:""}):(0,t.jsx)("div",{className:"size-full flex items-center justify-center",children:(0,t.jsx)(rt,{size:24,className:"text-violet-500 animate-pulse"})}),(0,t.jsx)("button",{onClick:ke=>{ke.stopPropagation(),G(ve=>ve.filter((et,tt)=>tt!==Z))},className:"absolute top-1.5 right-1.5 size-7 rounded-full bg-black/60 text-white flex items-center justify-center hover:bg-black transition-colors",children:(0,t.jsx)(we,{size:16})}),(0,t.jsx)("div",{className:"absolute bottom-1 left-1 bg-violet-600 text-white text-[8px] font-bold px-1 rounded",children:"NEW"})]},`new-${Z}`)),V.length+ae.length<4&&(0,t.jsxs)("button",{onClick:D=>{D.stopPropagation(),He.current?.click()},className:"relative aspect-square rounded-xl border-2 border-dashed border-zinc-200 dark:border-zinc-800 flex flex-col items-center justify-center gap-1 text-zinc-400 hover:text-violet-500 hover:border-violet-500 hover:bg-violet-50/5 transition-all",children:[(0,t.jsx)(De,{size:20}),(0,t.jsx)("span",{className:"text-[10px] font-bold",children:"Add Media"})]})]}),(0,t.jsx)("input",{type:"file",ref:He,onChange:D=>{const Z=Array.from(D.target.files);G(ke=>[...ke,...Z])},multiple:!0,className:"hidden",accept:"image/*,video/*"})]}):b.isValidElement(Y)?Y:(0,t.jsx)(kr,{items:Y})},Le=(U,Y)=>{const D=typeof U=="string"&&Gi(U);if(me)return(0,t.jsxs)("div",{className:"flex flex-col gap-2 mt-2",onClick:Z=>Z.stopPropagation(),children:[(0,t.jsx)(ir,{value:te,onChange:Z=>H(Z.target.value),className:`min-h-[100px] w-full bg-zinc-50 dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800 rounded-xl focus:ring-violet-500 ${D?"font-bangla text-lg":"font-english"}`,autoFocus:!0}),(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>{ee(!1),H(n),Q(l||[]),G([])},className:"px-4 py-1.5 text-sm font-bold text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-300 transition-colors",children:"Cancel"}),(0,t.jsx)("button",{onClick:Ee,disabled:ce||!te.trim()||te===n,className:"px-4 py-1.5 text-sm font-bold bg-violet-600 text-white rounded-full hover:bg-violet-700 disabled:opacity-50 transition-all active:scale-95",children:ce?"Saving...":"Save"})]})]});if(typeof U=="string"){const Z=!p&&U.length>280,ke=(Z&&!ge?U.substring(0,280):U).split(/(@[a-zA-Z0-9_]+)/g).map((ve,et)=>{if(ve.startsWith("@")&&ve.length>1){const tt=ve.substring(1);return(0,t.jsx)("span",{onClick:Ks=>{Ks.stopPropagation(),m&&m(tt)},className:"text-violet-600 dark:text-violet-400 font-bold hover:underline cursor-pointer",children:ve},et)}return ve});return(0,t.jsxs)("p",{className:`whitespace-pre-line ${Y||""} ${D?"font-bangla text-[1.15em] leading-relaxed":"font-english text-[1.05em]"}`,children:[ke,Z&&!ge&&"...",Z&&(0,t.jsx)("button",{onClick:ve=>{ve.stopPropagation(),Je(!ge)},className:"ml-1 text-violet-600 dark:text-violet-400 font-bold hover:underline cursor-pointer",children:ge?"Show less":"See more"})]})}return U},qe=U=>{A(Y=>{const D=`@${U} `;return Y.includes(D)?Y:Y+D}),document.getElementById("comment-input")?.focus()};return p?(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsxs)("article",{className:"p-5 dark:bg-black",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-start gap-x-3",children:[(0,t.jsx)("button",{className:"shrink-0",onClick:()=>m&&m(e.handle),children:(0,t.jsxs)(xe,{className:"size-12 border border-zinc-200 dark:border-zinc-700",children:[(0,t.jsx)(he,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,t.jsx)(pe,{children:e.handle[0]?.toUpperCase()})]})}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-x-1",children:(0,t.jsxs)("button",{className:"font-bold hover:underline text-zinc-900 dark:text-white flex items-center gap-1 text-base",onClick:()=>m&&m(e.handle),children:[e.handle,e.verified&&(0,t.jsx)(ct,{})]})}),(0,t.jsxs)("span",{className:"text-sm text-zinc-500 dark:text-zinc-400",children:["@",e.handle]})]})]}),(0,t.jsx)(Me,{trigger:(0,t.jsx)("button",{className:"text-zinc-500 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full p-2 transition-colors",children:(0,t.jsx)(Nt,{size:20})})})]}),(0,t.jsx)("div",{className:"break-words text-zinc-900 dark:text-zinc-100 mt-4 text-lg sm:text-xl leading-relaxed sm:leading-8 whitespace-pre-line",children:Le(n,i)}),Re(l),h&&(0,t.jsx)(Kt,{poll:h}),r&&(0,t.jsx)("div",{className:"mt-4 border border-zinc-200 dark:border-zinc-700 rounded-2xl overflow-hidden shadow-sm",children:(0,t.jsx)(Jt,{...r})}),(0,t.jsx)("div",{className:"my-4 flex items-center text-zinc-500 dark:text-zinc-400 text-sm border-b border-zinc-100 dark:border-zinc-800 pb-4",children:a||"Recent"}),(0,t.jsxs)("div",{className:"border-b border-zinc-100 dark:border-zinc-800 pb-4 flex items-center gap-x-6 text-zinc-500 dark:text-zinc-400 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:_.likes||0})," ",(0,t.jsx)("span",{className:"opacity-70",children:"Likes"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:_.comments||0})," ",(0,t.jsx)("span",{className:"opacity-70",children:"Comments"})]})]}),(0,t.jsxs)("div",{className:"mt-4 flex w-full items-center justify-around py-1",children:[(0,t.jsx)(Xe,{icon:st,onClick:F,active:w,activeColorClass:"text-rose-500"}),!v&&(0,t.jsx)(Xe,{icon:gt,onClick:P,active:k,activeColorClass:"text-emerald-500"}),(0,t.jsx)(Xe,{icon:zt,onClick:()=>document.getElementById("comment-input")?.focus()})]})]}),(0,t.jsx)(Rr,{currentUser:u,newComment:B,setNewComment:A,handleSubmitComment:Ze,loading:I,selectedFiles:X,setSelectedFiles:se,isUploading:ie}),(0,t.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:L?(0,t.jsx)("div",{className:"p-8 flex justify-center",children:(0,t.jsx)(oe,{className:"animate-spin text-violet-500"})}):(0,t.jsxs)(t.Fragment,{children:[$&&M.length>0&&(0,t.jsxs)("button",{onClick:()=>Ne(!0),disabled:S,className:"w-full py-3 text-sm font-bold text-violet-600 hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors flex items-center justify-center gap-2",children:[S&&(0,t.jsx)(oe,{size:14,className:"animate-spin"}),"View more replies"]}),M.map(U=>(0,t.jsx)(Os,{...U,isComment:!0,onReply:qe,onUserClick:m,currentUser:u,showToast:f,onDelete:Y=>E(D=>D.filter(Z=>Z.id!==Y))},U.id))]})}),(0,t.jsx)(Ot,{open:re,onOpenChange:de,children:(0,t.jsxs)(Dt,{onClick:U=>U.stopPropagation(),children:[(0,t.jsxs)(Bt,{children:[(0,t.jsx)(Ht,{children:"Are you absolutely sure?"}),(0,t.jsx)(Qt,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,t.jsxs)(Wt,{children:[(0,t.jsx)(Vt,{onClick:U=>U.stopPropagation(),children:"Cancel"}),(0,t.jsx)(Ut,{onClick:Pe,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]}):(0,t.jsxs)("article",{onClick:c,className:`px-5 pt-4 pb-3 hover:bg-zinc-50/80 dark:hover:bg-zinc-900/40 transition-colors border-b border-zinc-100 dark:border-zinc-800 last:border-0 ${c?"cursor-pointer":""}`,children:[d&&(0,t.jsxs)("div",{className:"mb-2 flex items-center space-x-1.5 text-[13px] text-zinc-500 font-semibold ml-1",children:[(0,t.jsx)(gt,{size:14,className:"text-zinc-400"}),(0,t.jsx)("span",{className:"hover:underline cursor-pointer flex items-center text-zinc-600 dark:text-zinc-400",onClick:U=>{U.stopPropagation(),m&&m(d.handle)},children:(0,t.jsx)("span",{className:"truncate max-w-[150px]",children:typeof d=="object"?d.name:d})}),(0,t.jsx)("span",{className:"text-zinc-400",children:"reposted"})]}),(0,t.jsxs)("div",{className:"flex items-start gap-x-3",children:[(0,t.jsx)("button",{className:"shrink-0 group",onClick:U=>{U.stopPropagation(),m&&m(e.handle)},children:(0,t.jsxs)(xe,{className:"size-11 border border-zinc-200 dark:border-zinc-700 group-hover:brightness-95 transition-all",children:[(0,t.jsx)(he,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,t.jsx)(pe,{children:e.handle[0]?.toUpperCase()})]})}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsxs)("div",{className:"flex w-full items-start justify-between",children:[(0,t.jsx)("div",{className:"flex flex-col min-w-0",children:(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-x-1",children:[(0,t.jsxs)("button",{className:"font-bold hover:underline text-zinc-900 dark:text-white flex items-center gap-1 truncate text-[15px]",onClick:U=>{U.stopPropagation(),m&&m(e.handle)},children:[(0,t.jsx)("span",{className:"truncate",children:e.handle}),e.verified&&(0,t.jsx)(ct,{})]}),(0,t.jsxs)("span",{className:"text-zinc-400 text-sm ml-1 whitespace-nowrap",children:["â€¢ ",a||"Recent"]}),N&&(0,t.jsxs)("span",{className:"text-violet-600 dark:text-violet-400 text-[13px] ml-1 font-bold hover:underline cursor-pointer flex items-center gap-1",onClick:U=>{U.stopPropagation(),y(`/c/${N.handle}`)},children:["â€¢ ",(0,t.jsx)(Ke,{size:12})," ",N.name]})]})}),(0,t.jsx)(Me,{trigger:(0,t.jsx)("button",{className:"text-zinc-400 hover:bg-zinc-100 hover:text-zinc-700 dark:hover:bg-zinc-800 dark:hover:text-zinc-200 rounded-full p-2 -mr-2 transition-colors",children:(0,t.jsx)(Nt,{size:18})})})]}),(0,t.jsxs)("div",{className:"break-words text-zinc-900 dark:text-zinc-100 mt-1 whitespace-pre-line text-sm sm:text-[15px] leading-relaxed",children:[Le(n,i),Re(l),h&&(0,t.jsx)(Kt,{poll:h,onVote:()=>f&&f("Voted!")}),r&&(0,t.jsx)("div",{className:"mt-3 border border-zinc-200 dark:border-zinc-700 rounded-2xl overflow-hidden bg-white dark:bg-zinc-900 hover:bg-zinc-50 dark:hover:bg-zinc-800 transition-colors cursor-pointer",onClick:U=>U.stopPropagation(),children:(0,t.jsx)(Jt,{...r})})]}),(0,t.jsx)("div",{className:"mt-3 flex w-full flex-wrap items-center justify-between gap-3 pr-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-x-6",children:[(0,t.jsx)(Xe,{icon:st,count:_.likes,active:w,onClick:F,activeColorClass:"text-rose-500"}),!v&&(0,t.jsx)(Xe,{icon:gt,count:_.mirrors,active:k,onClick:P,activeColorClass:"text-emerald-500"}),(0,t.jsx)(Xe,{icon:zt,count:_.comments,onClick:U=>{v&&j?(U.stopPropagation(),j(e.handle)):c&&c(U)}})]})})]})]}),(0,t.jsx)(Ot,{open:re,onOpenChange:de,children:(0,t.jsxs)(Dt,{onClick:U=>U.stopPropagation(),children:[(0,t.jsxs)(Bt,{children:[(0,t.jsx)(Ht,{children:"Are you absolutely sure?"}),(0,t.jsx)(Qt,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,t.jsxs)(Wt,{children:[(0,t.jsx)(Vt,{onClick:U=>U.stopPropagation(),children:"Cancel"}),(0,t.jsx)(Ut,{onClick:Pe,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]})},pt=Os,Ir=K(),Er=()=>{const s=(0,Ir.c)(3);let e;s[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,t.jsx)("div",{className:"size-11 rounded-full bg-zinc-200 dark:bg-zinc-800 shrink-0"}),s[0]=e):e=s[0];let a;s[1]===Symbol.for("react.memo_cache_sentinel")?(a=(0,t.jsx)("div",{className:"h-4 bg-zinc-200 dark:bg-zinc-800 rounded w-1/3"}),s[1]=a):a=s[1];let n;return s[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,t.jsx)("div",{className:"px-5 pt-4 pb-3 border-b border-zinc-100 dark:border-zinc-800 animate-pulse",children:(0,t.jsxs)("div",{className:"flex items-start gap-x-3",children:[e,(0,t.jsxs)("div",{className:"flex-1 space-y-3",children:[a,(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"h-3 bg-zinc-200 dark:bg-zinc-800 rounded w-full"}),(0,t.jsx)("div",{className:"h-3 bg-zinc-200 dark:bg-zinc-800 rounded w-5/6"})]}),(0,t.jsx)("div",{className:"h-48 bg-zinc-200 dark:bg-zinc-800 rounded-xl w-full"})]})]})}),s[2]=n):n=s[2],n},Lt=Er,Ds=K();function Xt(s){const e=(0,Ds.c)(14);let a,n,i;e[0]!==s?({className:n,children:a,...i}=s,e[0]=s,e[1]=a,e[2]=n,e[3]=i):(a=e[1],n=e[2],i=e[3]);let l;e[4]!==n?(l=ne("relative",n),e[4]=n,e[5]=l):l=e[5];let r;e[6]!==a?(r=(0,t.jsx)(Nn,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:a}),e[6]=a,e[7]=r):r=e[7];let o,c;e[8]===Symbol.for("react.memo_cache_sentinel")?(o=(0,t.jsx)(kt,{}),c=(0,t.jsx)(Ta,{}),e[8]=o,e[9]=c):(o=e[8],c=e[9]);let d;return e[10]!==i||e[11]!==l||e[12]!==r?(d=(0,t.jsxs)(jn,{"data-slot":"scroll-area",className:l,...i,children:[r,o,c]}),e[10]=i,e[11]=l,e[12]=r,e[13]=d):d=e[13],d}function kt(s){const e=(0,Ds.c)(13);let a,n,i;e[0]!==s?({className:a,orientation:i,...n}=s,e[0]=s,e[1]=a,e[2]=n,e[3]=i):(a=e[1],n=e[2],i=e[3]);const l=i===void 0?"vertical":i,r=l==="vertical"&&"h-full w-2.5 border-l border-l-transparent",o=l==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent";let c;e[4]!==a||e[5]!==r||e[6]!==o?(c=ne("flex touch-none p-px transition-colors select-none",r,o,a),e[4]=a,e[5]=r,e[6]=o,e[7]=c):c=e[7];let d;e[8]===Symbol.for("react.memo_cache_sentinel")?(d=(0,t.jsx)(qa,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"}),e[8]=d):d=e[8];let m;return e[9]!==l||e[10]!==n||e[11]!==c?(m=(0,t.jsx)(kn,{"data-slot":"scroll-area-scrollbar",orientation:l,className:c,...n,children:d}),e[9]=l,e[10]=n,e[11]=c,e[12]=m):m=e[12],m}var Tr=K(),qr=s=>{const e=(0,Tr.c)(49),{onStoryClick:a,onAddStory:n}=s,{currentUser:i}=fe(),{posts:l,loading:r,hasMore:o,isFetchingNextPage:c,fetchNextPage:d}=ht(),{addToast:m}=Ce(),u=je();let f;e[0]===Symbol.for("react.memo_cache_sentinel")?(f={threshold:.1},e[0]=f):f=e[0];const{ref:h,inView:p}=Ya(f);let x,g;e[1]!==d||e[2]!==o||e[3]!==p||e[4]!==c?(x=()=>{p&&o&&!c&&d()},g=[p,o,c,d],e[1]=d,e[2]=o,e[3]=p,e[4]=c,e[5]=x,e[6]=g):(x=e[5],g=e[6]),(0,b.useEffect)(x,g);let v;e[7]===Symbol.for("react.memo_cache_sentinel")?(v={queryKey:["stories"],queryFn:hi},e[7]=v):v=e[7];const{data:j,isLoading:N}=Oe(v);let y;e[8]!==j?(y=j===void 0?[]:j,e[8]=j,e[9]=y):y=e[9];const w=y;let k;if(e[10]!==w){const $={};w.forEach(J=>{if(!J.user)return;const X=J.user.id;$[X]||($[X]={user:J.user,stories:[]}),$[X].stories.push(J)}),k=Object.values($),e[10]=w,e[11]=k}else k=e[11];const _=k,C=l;let F;e[12]!==u?(F=$=>{u(`/post/${$}`)},e[12]=u,e[13]=F):F=e[13];const P=F;let T;e[14]!==u?(T=$=>{u(`/u/${$}`)},e[14]=u,e[15]=T):T=e[15];const R=T;if(r||N){let $;return e[16]===Symbol.for("react.memo_cache_sentinel")?($=(0,t.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:[(0,t.jsxs)(Xt,{className:"w-full whitespace-nowrap border-b border-zinc-100 dark:border-zinc-800",children:[(0,t.jsxs)("div",{className:"flex w-max gap-3 py-4 px-4",children:[(0,t.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"}),(0,t.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"}),(0,t.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"})]}),(0,t.jsx)(kt,{orientation:"horizontal",className:"hidden"})]}),[1,2,3].map(Or)]}),e[16]=$):$=e[16],$}let M;e[17]!==i||e[18]!==n?(M=i&&(0,t.jsx)(At,{user:i,isAddStory:!0,onClick:n}),e[17]=i,e[18]=n,e[19]=M):M=e[19];let E;e[20]!==_||e[21]!==a?(E=_.map($=>(0,t.jsx)(At,{user:$.user,onClick:()=>a($)},$.user.id)),e[20]=_,e[21]=a,e[22]=E):E=e[22];let B;e[23]!==M||e[24]!==E?(B=(0,t.jsxs)("div",{className:"flex w-max gap-4 py-4 px-4",children:[M,E]}),e[23]=M,e[24]=E,e[25]=B):B=e[25];let A;e[26]===Symbol.for("react.memo_cache_sentinel")?(A=(0,t.jsx)(kt,{orientation:"horizontal",className:"hidden"}),e[26]=A):A=e[26];let L;e[27]!==B?(L=(0,t.jsxs)(Xt,{className:"w-full border-b border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black",children:[B,A]}),e[27]=B,e[28]=L):L=e[28];let z;e[29]!==i?(z=!i&&(0,t.jsx)("div",{className:"px-4 py-2 md:hidden",children:(0,t.jsx)(Ps,{className:"p-6"})}),e[29]=i,e[30]=z):z=e[30];let I;e[31]!==m||e[32]!==i||e[33]!==P||e[34]!==R||e[35]!==C?(I=C.length>0?C.map($=>(0,t.jsx)(pt,{...$,currentUser:i,showToast:m,onClick:()=>P($.id),onUserClick:R},$.feed_id||$.id)):(0,t.jsxs)("div",{className:"p-20 text-center text-zinc-500",children:[(0,t.jsx)("p",{className:"text-lg font-medium",children:"No posts yet."}),(0,t.jsx)("p",{className:"text-sm",children:"Be the first to share something amazing!"})]}),e[31]=m,e[32]=i,e[33]=P,e[34]=R,e[35]=C,e[36]=I):I=e[36];let W;e[37]!==o||e[38]!==C.length||e[39]!==c||e[40]!==h?(W=C.length>0&&(0,t.jsx)("div",{ref:h,className:"py-8 flex justify-center",children:c?(0,t.jsx)(oe,{className:"animate-spin text-violet-500",size:24}):o?(0,t.jsx)("div",{className:"h-4"}):(0,t.jsx)("p",{className:"text-sm text-zinc-500 font-medium",children:"You've reached the end of the feed."})}),e[37]=o,e[38]=C.length,e[39]=c,e[40]=h,e[41]=W):W=e[41];let S;e[42]!==I||e[43]!==W?(S=(0,t.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm",children:[I,W]}),e[42]=I,e[43]=W,e[44]=S):S=e[44];let q;return e[45]!==L||e[46]!==z||e[47]!==S?(q=(0,t.jsxs)("div",{className:"w-full max-w-full overflow-hidden",children:[L,z,S]}),e[45]=L,e[46]=z,e[47]=S,e[48]=q):q=e[48],q},Ar=qr;function Or(s){return(0,t.jsx)(Lt,{},s)}const Bs=(s,e,a)=>{const n=s?.id,[i,l]=(0,b.useState)(!1),[r,o]=(0,b.useState)({followers:s?.followers||s?.follower_count||0,following:s?.following||s?.following_count||0}),[c,d]=(0,b.useState)(!1);return(0,b.useEffect)(()=>{s&&(o({followers:s.followers||s.follower_count||0,following:s.following||s.following_count||0}),n&&ze(n)&&(Hn(n).then(u=>{u&&o({followers:u.followers,following:u.following})}).catch(()=>{}),e&&ze(e)&&Dn(e,n).then(l).catch(()=>l(!1))))},[s,n,e]),{isFollowing:i,stats:r,loading:c,handleFollow:async()=>{if(!e)return a("Please login to follow!","error");if(e===n)return a("You cannot follow yourself!","error");if(!n||!ze(n)||!ze(e)){const u=!i;l(u),o(f=>{const h=typeof f.followers=="string"?parseInt(f.followers.replace(/,/g,"")):f.followers||0;return{...f,followers:u?h+1:Math.max(0,h-1)}}),a(u?"Followed":"Unfollowed");return}d(!0);try{const u=await On(e,n);l(u),o(f=>({...f,followers:u?(f.followers||0)+1:Math.max(0,(f.followers||0)-1)})),a(u?"Followed":"Unfollowed")}catch(u){console.error("Failed to toggle follow:",u),a("Failed to update follow status","error")}finally{d(!1)}},setStats:o}};var Dr=K(),Br=s=>{const e=(0,Dr.c)(57),{profile:a,onUserClick:n,isCommunity:i}=s,l=i===void 0?!1:i,{onlineUsers:r}=zs(),{currentUser:o}=fe(),{addToast:c}=Ce();let d;e[0]!==r||e[1]!==a.id?(d=r.has(a.id),e[0]=r,e[1]=a.id,e[2]=d):d=e[2];const m=d,{isFollowing:u,loading:f,handleFollow:h}=Bs(a,o?.id,c),p=o?.id===a.id;let x;e[3]!==n||e[4]!==a.handle?(x=()=>n(a.handle),e[3]=n,e[4]=a.handle,e[5]=x):x=e[5];const g=`size-12 border border-zinc-200 dark:border-zinc-800 shadow-sm ${l?"rounded-2xl":""}`;let v;e[6]!==a.avatar||e[7]!==a.handle?(v=(0,t.jsx)(he,{src:a.avatar,alt:a.handle,className:"object-cover"}),e[6]=a.avatar,e[7]=a.handle,e[8]=v):v=e[8];const j=l?"rounded-2xl":"";let N;e[9]!==a.handle?.[0]?(N=a.handle?.[0]?.toUpperCase(),e[9]=a.handle?.[0],e[10]=N):N=e[10];let y;e[11]!==j||e[12]!==N?(y=(0,t.jsx)(pe,{className:j,children:N}),e[11]=j,e[12]=N,e[13]=y):y=e[13];let w;e[14]!==g||e[15]!==v||e[16]!==y?(w=(0,t.jsxs)(xe,{className:g,children:[v,y]}),e[14]=g,e[15]=v,e[16]=y,e[17]=w):w=e[17];let k;e[18]!==l||e[19]!==m?(k=m&&!l&&(0,t.jsx)("span",{className:"absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full shadow-sm"}),e[18]=l,e[19]=m,e[20]=k):k=e[20];let _;e[21]!==k||e[22]!==w?(_=(0,t.jsxs)("div",{className:"relative",children:[w,k]}),e[21]=k,e[22]=w,e[23]=_):_=e[23];let C;e[24]!==a.name?(C=(0,t.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white leading-none",children:a.name}),e[24]=a.name,e[25]=C):C=e[25];let F;e[26]!==a.verified?(F=a.verified&&(0,t.jsx)(ct,{}),e[26]=a.verified,e[27]=F):F=e[27];let P;e[28]!==C||e[29]!==F?(P=(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[C,F]}),e[28]=C,e[29]=F,e[30]=P):P=e[30];let T;e[31]!==a.handle?(T=(0,t.jsxs)("span",{className:"text-sm text-zinc-500 mt-0.5",children:["@",a.handle]}),e[31]=a.handle,e[32]=T):T=e[32];let R;e[33]!==l||e[34]!==a.members?(R=l&&a.members&&(0,t.jsxs)("span",{className:"text-xs text-zinc-400 mt-1",children:[a.members," members"]}),e[33]=l,e[34]=a.members,e[35]=R):R=e[35];let M;e[36]!==l||e[37]!==a.followers?(M=!l&&a.followers&&(0,t.jsxs)("span",{className:"text-xs text-zinc-400 mt-1",children:[a.followers," followers"]}),e[36]=l,e[37]=a.followers,e[38]=M):M=e[38];let E;e[39]!==P||e[40]!==T||e[41]!==R||e[42]!==M?(E=(0,t.jsxs)("div",{className:"flex flex-col",children:[P,T,R,M]}),e[39]=P,e[40]=T,e[41]=R,e[42]=M,e[43]=E):E=e[43];let B;e[44]!==_||e[45]!==E?(B=(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[_,E]}),e[44]=_,e[45]=E,e[46]=B):B=e[46];let A;e[47]!==h||e[48]!==l||e[49]!==u||e[50]!==p||e[51]!==f?(A=!p&&(0,t.jsx)(ue,{variant:u?"secondary":"outline",className:"!w-auto !py-1.5 !px-4 text-sm font-bold rounded-full border-zinc-200 dark:border-zinc-700 hover:bg-zinc-100 dark:hover:bg-zinc-800",onClick:z=>{z.stopPropagation(),h()},disabled:f,children:f?(0,t.jsx)(oe,{size:14,className:"animate-spin"}):u?"Following":l?"Join":"Follow"}),e[47]=h,e[48]=l,e[49]=u,e[50]=p,e[51]=f,e[52]=A):A=e[52];let L;return e[53]!==B||e[54]!==A||e[55]!==x?(L=(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-zinc-100 dark:border-zinc-800 hover:bg-zinc-50 dark:hover:bg-zinc-900/40 transition-colors group cursor-pointer",onClick:x,children:[B,A]}),e[53]=B,e[54]=A,e[55]=x,e[56]=L):L=e[56],L},Ws=Br,Wr=({isOpen:s,onClose:e})=>{const{currentUser:a}=fe(),{addToast:n}=Ce(),i=je(),[l,r]=(0,b.useState)({name:"",handle:"",description:""}),[o,c]=(0,b.useState)(!1),d=async m=>{if(m.preventDefault(),!(!l.name||!l.handle||!a)){c(!0);try{const u=await wi({...l,handle:l.handle.toLowerCase().replace(/\s+/g,"-"),creator_id:a.id});await ys(u.id,a.id),n(`Community "${u.name}" created!`),e(),i(`/c/${u.handle}`)}catch(u){console.error(u),n(u.message||"Failed to create community","error")}finally{c(!1)}}};return(0,t.jsx)(nt,{isOpen:s,onClose:()=>!o&&e(),title:"Create Community",className:"sm:max-w-md",children:(0,t.jsxs)("form",{onSubmit:d,className:"space-y-5",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center p-6 bg-zinc-50 dark:bg-zinc-900 rounded-2xl border-2 border-dashed border-zinc-200 dark:border-zinc-800",children:[(0,t.jsx)("div",{className:"size-20 rounded-2xl bg-white dark:bg-black flex items-center justify-center shadow-sm mb-3",children:(0,t.jsx)(Ke,{size:32,className:"text-violet-600"})}),(0,t.jsx)("p",{className:"text-xs font-medium text-zinc-500 text-center max-w-[200px]",children:"Communities are where people with shared interests connect."})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)("label",{className:"text-sm font-bold ml-1",children:"Community Name"}),(0,t.jsx)("input",{type:"text",required:!0,className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all",placeholder:"e.g. Photography Enthusiasts",value:l.name,onChange:m=>r({...l,name:m.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)("label",{className:"text-sm font-bold ml-1",children:"Handle"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-zinc-500 font-medium",children:"c/"}),(0,t.jsx)("input",{type:"text",required:!0,className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl pl-8 pr-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all",placeholder:"photography",value:l.handle,onChange:m=>r({...l,handle:m.target.value.toLowerCase().replace(/[^a-z0-9-]/g,"")})})]})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)("label",{className:"text-sm font-bold ml-1",children:"Description (Optional)"}),(0,t.jsx)("textarea",{className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all min-h-[100px] resize-none",placeholder:"What is this community about?",value:l.description,onChange:m=>r({...l,description:m.target.value})})]})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,t.jsx)(ue,{type:"button",variant:"outline",className:"flex-1",onClick:e,disabled:o,children:"Cancel"}),(0,t.jsx)(ue,{type:"submit",className:"flex-1",disabled:o||!l.name||!l.handle,children:o?(0,t.jsx)(oe,{size:18,className:"animate-spin"}):"Create"})]})]})})},Hr=Wr,Qr=()=>{const{currentUser:s}=fe(),e=je(),[a,n]=(0,b.useState)(""),[i,l]=(0,b.useState)(!1),[r,o]=(0,b.useState)([]),[c,d]=(0,b.useState)(!0),[m,u]=(0,b.useState)(!1),[f,h]=(0,b.useState)(!0),p=(0,b.useRef)(r);(0,b.useEffect)(()=>{p.current=r},[r]);const x=(0,b.useCallback)(async(j=!1)=>{j?u(!0):d(!0);try{const N=p.current,y=await bi(j&&N.length>0?N[N.length-1].createdAt:null,10);y.length<10?h(!1):h(!0),o(j?w=>[...w,...y]:y)}catch(N){console.error("Failed to fetch communities:",N)}finally{d(!1),u(!1)}},[]);(0,b.useEffect)(()=>{x()},[x]);const g=(0,b.useMemo)(()=>{let j=r;return a&&(j=j.filter(N=>N.name?.toLowerCase().includes(a.toLowerCase())||N.handle?.toLowerCase().includes(a.toLowerCase()))),j},[r,a]),v=j=>{e(`/c/${j}`)};return c&&!r.length?(0,t.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:[1,2,3].map(j=>(0,t.jsx)(Lt,{},j))}):(0,t.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm",children:[(0,t.jsxs)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-10 border-b border-zinc-100 dark:border-zinc-800",children:[(0,t.jsxs)("div",{className:"p-4 flex gap-2",children:[(0,t.jsx)(ot,{value:a,onChange:n,onClear:()=>n(""),placeholder:"Search communities...",className:"flex-1"}),s&&(0,t.jsx)("button",{onClick:()=>l(!0),className:"size-11 rounded-xl bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 flex items-center justify-center hover:scale-105 active:scale-95 transition-all shadow-sm shrink-0",title:"Create Community",children:(0,t.jsx)(De,{size:22,strokeWidth:3})})]}),(0,t.jsxs)("div",{className:"px-5 py-2 border-t border-zinc-100 dark:border-zinc-800",children:[(0,t.jsx)("h2",{className:"text-lg font-bold dark:text-white",children:"Communities"}),(0,t.jsx)("p",{className:"text-xs text-zinc-500",children:"Discover and join interest-based groups"})]})]}),(0,t.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:[g.length>0?g.map(j=>(0,t.jsx)(Ws,{profile:j,onUserClick:v,isCommunity:!0},j.handle)):(0,t.jsx)("div",{className:"p-20 text-center text-zinc-500",children:(0,t.jsx)("p",{className:"font-bold",children:"No communities found"})}),f&&g.length>0&&(0,t.jsx)("div",{className:"p-6 flex justify-center border-t border-zinc-100 dark:border-zinc-800",children:(0,t.jsxs)(ue,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>x(!0),disabled:m,children:[m&&(0,t.jsx)(oe,{size:18,className:"animate-spin mr-2"}),"Load more"]})})]}),(0,t.jsx)(Hr,{isOpen:i,onClose:()=>l(!1)})]})},Ur=Qr,Vr=K(),Kr=s=>{const e=(0,Vr.c)(56),{reel:a}=s,n=(0,b.useRef)(null),[i,l]=(0,b.useState)(!1),r=(0,b.useRef)(0),o=Array.isArray(a.media)?a.media[0]?.src||a.media[0]?.url:a.media?.src||a.media?.url||a.url;let c,d;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=()=>{const re=new IntersectionObserver(me=>{const[ee]=me;n.current?.plyr&&(ee.isIntersecting?n.current.plyr.play().catch(()=>{n.current.plyr.muted=!0,n.current.plyr.play()}):n.current.plyr.pause())},{threshold:.8}),de=n.current?.elements?.container;return de&&re.observe(de),()=>{de&&re.unobserve(de)}},d=[],e[0]=c,e[1]=d):(c=e[0],d=e[1]),(0,b.useEffect)(c,d);let m;e[2]===Symbol.for("react.memo_cache_sentinel")?(m=()=>{const re=Date.now();re-r.current<300&&(l(!0),setTimeout(()=>l(!1),800)),r.current=re},e[2]=m):m=e[2];const u=m;let f;e[3]!==o?(f={type:"video",sources:[{src:o,type:"video/mp4"}]},e[3]=o,e[4]=f):f=e[4];let h;e[5]===Symbol.for("react.memo_cache_sentinel")?(h={controls:[],loop:{active:!0},clickToPlay:!0,ratio:"9:16"},e[5]=h):h=e[5];let p;e[6]!==f?(p={source:f,options:h},e[6]=f,e[7]=p):p=e[7];const x=p;let g;e[8]!==x?(g=(0,t.jsx)("div",{className:"w-full h-full max-w-[450px]",children:(0,t.jsx)(ls,{ref:n,...x})}),e[8]=x,e[9]=g):g=e[9];let v;e[10]!==i?(v=i&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-50 animate-in zoom-in-50 fade-in duration-300",children:(0,t.jsx)(st,{size:100,fill:"white",className:"text-white drop-shadow-2xl scale-125"})}),e[10]=i,e[11]=v):v=e[11];let j;e[12]===Symbol.for("react.memo_cache_sentinel")?(j=(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-black/60 pointer-events-none"}),e[12]=j):j=e[12];const N=a.user?.avatar,y=a.user?.handle;let w;e[13]!==N||e[14]!==y?(w=(0,t.jsx)(he,{src:N,alt:y,className:"object-cover"}),e[13]=N,e[14]=y,e[15]=w):w=e[15];let k;e[16]!==a.user?.handle?.[0]?(k=a.user?.handle?.[0]?.toUpperCase(),e[16]=a.user?.handle?.[0],e[17]=k):k=e[17];let _;e[18]!==k?(_=(0,t.jsx)(pe,{children:k}),e[18]=k,e[19]=_):_=e[19];let C;e[20]!==w||e[21]!==_?(C=(0,t.jsxs)(xe,{className:"size-10 border-2 border-white",children:[w,_]}),e[20]=w,e[21]=_,e[22]=C):C=e[22];const F=a.user?.handle;let P;e[23]!==F?(P=(0,t.jsxs)("span",{className:"font-bold",children:["@",F]}),e[23]=F,e[24]=P):P=e[24];let T;e[25]===Symbol.for("react.memo_cache_sentinel")?(T=(0,t.jsx)("button",{className:"bg-white text-black text-xs font-bold px-3 py-1 rounded-full ml-2 hover:scale-105 active:scale-95 transition-all",children:"Follow"}),e[25]=T):T=e[25];let R;e[26]!==C||e[27]!==P?(R=(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3 pointer-events-auto",children:[C,P,T]}),e[26]=C,e[27]=P,e[28]=R):R=e[28];let M;e[29]!==a.content?(M=(0,t.jsx)("p",{className:"text-sm mb-3 line-clamp-2",children:a.content}),e[29]=a.content,e[30]=M):M=e[30];let E;e[31]===Symbol.for("react.memo_cache_sentinel")?(E=(0,t.jsx)(Na,{size:14,className:"animate-spin-slow"}),e[31]=E):E=e[31];const B=a.user?.handle;let A;e[32]!==B?(A=(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs opacity-90",children:[E,(0,t.jsxs)("span",{children:["Original Audio - ",B]})]}),e[32]=B,e[33]=A):A=e[33];let L;e[34]!==R||e[35]!==M||e[36]!==A?(L=(0,t.jsxs)("div",{className:"absolute bottom-20 left-4 right-16 text-white pointer-events-none",children:[R,M,A]}),e[34]=R,e[35]=M,e[36]=A,e[37]=L):L=e[37];let z;e[38]===Symbol.for("react.memo_cache_sentinel")?(z=(0,t.jsx)("button",{className:"p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90",children:(0,t.jsx)(st,{size:28})}),e[38]=z):z=e[38];const I=a.stats?.likes||0;let W;e[39]!==I?(W=(0,t.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[z,(0,t.jsx)("span",{className:"text-white text-xs font-bold",children:I})]}),e[39]=I,e[40]=W):W=e[40];let S;e[41]===Symbol.for("react.memo_cache_sentinel")?(S=(0,t.jsx)("button",{className:"p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90",children:(0,t.jsx)(zt,{size:28})}),e[41]=S):S=e[41];const q=a.stats?.comments||0;let $;e[42]!==q?($=(0,t.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[S,(0,t.jsx)("span",{className:"text-white text-xs font-bold",children:q})]}),e[42]=q,e[43]=$):$=e[43];let J;e[44]===Symbol.for("react.memo_cache_sentinel")?(J=(0,t.jsx)("button",{className:"p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90",children:(0,t.jsx)(Ha,{size:28})}),e[44]=J):J=e[44];const X=a.stats?.shares||0;let se;e[45]!==X?(se=(0,t.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[J,(0,t.jsx)("span",{className:"text-white text-xs font-bold",children:X})]}),e[45]=X,e[46]=se):se=e[46];let ie;e[47]!==W||e[48]!==$||e[49]!==se?(ie=(0,t.jsxs)("div",{className:"absolute bottom-20 right-2 flex flex-col items-center gap-6 z-10",children:[W,$,se]}),e[47]=W,e[48]=$,e[49]=se,e[50]=ie):ie=e[50];let le;return e[51]!==L||e[52]!==ie||e[53]!==g||e[54]!==v?(le=(0,t.jsxs)("div",{className:"relative h-screen w-full bg-black snap-start flex items-center justify-center overflow-hidden",onClick:u,children:[g,v,j,L,ie]}),e[51]=L,e[52]=ie,e[53]=g,e[54]=v,e[55]=le):le=e[55],le},Jr=Kr,Xr=K(),Yr=()=>{const s=(0,Xr.c)(12),{posts:e,loading:a}=ht(),n=je();let i,l;if(s[0]!==a||s[1]!==n||s[2]!==e){l=Symbol.for("react.early_return_sentinel");e:{const r=e.filter(Zr);if(a){let m;s[5]===Symbol.for("react.memo_cache_sentinel")?(m=(0,t.jsx)("div",{className:"h-[100dvh] w-full flex items-center justify-center bg-black",children:(0,t.jsx)(oe,{size:40,className:"animate-spin text-white"})}),s[5]=m):m=s[5],l=m;break e}if(r.length===0){let m;s[6]===Symbol.for("react.memo_cache_sentinel")?(m=(0,t.jsx)("div",{className:"h-[100dvh] w-full flex flex-col items-center justify-center bg-black text-white gap-4",children:(0,t.jsx)("p",{className:"text-zinc-500",children:"No reels found."})}),s[6]=m):m=s[6],l=m;break e}let o;s[7]!==n?(o=()=>n(-1),s[7]=n,s[8]=o):o=s[8];let c;s[9]===Symbol.for("react.memo_cache_sentinel")?(c=(0,t.jsx)(Ye,{size:24,strokeWidth:2.5}),s[9]=c):c=s[9];let d;s[10]!==o?(d=(0,t.jsx)("button",{onClick:o,className:"absolute top-6 left-6 z-50 p-2.5 bg-black/20 hover:bg-black/40 text-white backdrop-blur-md rounded-full transition-all active:scale-90 border border-white/10 shadow-xl",title:"Back",children:c}),s[10]=o,s[11]=d):d=s[11],i=(0,t.jsxs)("div",{className:"h-[100dvh] w-full snap-y snap-mandatory overflow-y-auto no-scrollbar bg-black md:rounded-xl relative",children:[d,r.map(eo)]})}s[0]=a,s[1]=n,s[2]=e,s[3]=i,s[4]=l}else i=s[3],l=s[4];return l!==Symbol.for("react.early_return_sentinel")?l:i},Gr=Yr;function Zr(s){return s.type==="video"||s.category==="video"}function eo(s){return(0,t.jsx)(Jr,{reel:s},s.id)}var to=K();const Hs=s=>{const e=(0,to.c)(5);let a;e[0]!==s?(a=()=>lt(s),e[0]=s,e[1]=a):a=e[1];const[n,i]=(0,b.useState)(a);let l,r;return e[2]!==s?(l=()=>{if(!s)return;const o=setTimeout(()=>{i(lt(s))},0),c=setInterval(()=>{i(lt(s))},6e4);return()=>{clearTimeout(o),clearInterval(c)}},r=[s],e[2]=s,e[3]=l,e[4]=r):(l=e[3],r=e[4]),(0,b.useEffect)(l,r),n};var so=K(),ao=s=>{const e=(0,so.c)(50),{conv:a,selectedId:n,onSelect:i,onlineUsers:l}=s,r=Hs(a.user?.lastSeen);let o;e[0]!==a.user?.id||e[1]!==l?(o=l.has(a.user?.id),e[0]=a.user?.id,e[1]=l,e[2]=o):o=e[2];const c=o;let d;e[3]!==a||e[4]!==i?(d=()=>i(a),e[3]=a,e[4]=i,e[5]=d):d=e[5];const m=`flex items-center gap-3 p-4 cursor-pointer transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900 ${n===a.id?"bg-zinc-50 dark:bg-zinc-900 border-r-2 border-violet-500":""}`,u=a.user?.avatar,f=a.user?.name;let h;e[6]!==u||e[7]!==f?(h=(0,t.jsx)(he,{src:u,alt:f,className:"object-cover"}),e[6]=u,e[7]=f,e[8]=h):h=e[8];let p;e[9]!==a.user?.name?.[0]?(p=a.user?.name?.[0]?.toUpperCase(),e[9]=a.user?.name?.[0],e[10]=p):p=e[10];let x;e[11]!==p?(x=(0,t.jsx)(pe,{children:p}),e[11]=p,e[12]=x):x=e[12];let g;e[13]!==h||e[14]!==x?(g=(0,t.jsxs)(xe,{className:"size-12",children:[h,x]}),e[13]=h,e[14]=x,e[15]=g):g=e[15];let v;e[16]!==c?(v=c&&(0,t.jsx)("span",{className:"absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full"}),e[16]=c,e[17]=v):v=e[17];let j;e[18]!==v||e[19]!==g?(j=(0,t.jsxs)("div",{className:"relative",children:[g,v]}),e[18]=v,e[19]=g,e[20]=j):j=e[20];const N=a.user?.name;let y;e[21]!==N?(y=(0,t.jsx)("span",{className:"font-bold dark:text-white truncate",children:N}),e[21]=N,e[22]=y):y=e[22];let w;e[23]!==a.user?.lastSeen||e[24]!==c||e[25]!==r?(w=c?(0,t.jsx)("span",{className:"text-[10px] text-emerald-500 font-medium leading-none mb-1",children:"Online"}):a.user?.lastSeen&&(0,t.jsx)("span",{className:"text-[10px] text-zinc-500 font-medium leading-none mb-1",children:r}),e[23]=a.user?.lastSeen,e[24]=c,e[25]=r,e[26]=w):w=e[26];let k;e[27]!==y||e[28]!==w?(k=(0,t.jsxs)("div",{className:"flex flex-col min-w-0",children:[y,w]}),e[27]=y,e[28]=w,e[29]=k):k=e[29];let _;e[30]!==a.time?(_=(0,t.jsx)("span",{className:"text-xs text-zinc-500 whitespace-nowrap ml-2",children:a.time}),e[30]=a.time,e[31]=_):_=e[31];let C;e[32]!==k||e[33]!==_?(C=(0,t.jsxs)("div",{className:"flex justify-between items-center mb-0.5",children:[k,_]}),e[32]=k,e[33]=_,e[34]=C):C=e[34];let F;e[35]!==a.lastMessage?(F=(0,t.jsx)("p",{className:"text-zinc-500 text-sm truncate pr-2",children:a.lastMessage}),e[35]=a.lastMessage,e[36]=F):F=e[36];let P;e[37]!==a.unread?(P=a.unread>0&&(0,t.jsx)("span",{className:"bg-violet-600 text-white text-[10px] font-bold size-5 rounded-full flex items-center justify-center shrink-0",children:a.unread}),e[37]=a.unread,e[38]=P):P=e[38];let T;e[39]!==F||e[40]!==P?(T=(0,t.jsxs)("div",{className:"flex-1 flex justify-between items-center",children:[F,P]}),e[39]=F,e[40]=P,e[41]=T):T=e[41];let R;e[42]!==C||e[43]!==T?(R=(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[C,T]}),e[42]=C,e[43]=T,e[44]=R):R=e[44];let M;return e[45]!==j||e[46]!==d||e[47]!==R||e[48]!==m?(M=(0,t.jsxs)("div",{onClick:d,className:m,children:[j,R]}),e[45]=j,e[46]=d,e[47]=R,e[48]=m,e[49]=M):M=e[49],M},no=({conversations:s,userResults:e=[],onSelect:a,onStartNew:n,selectedId:i,searchQuery:l,onSearchChange:r,onlineUsers:o=new Set})=>(0,t.jsxs)("div",{className:"flex-1 flex flex-col min-w-0 bg-white dark:bg-black",children:[(0,t.jsx)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800",children:(0,t.jsx)(ot,{value:l,onChange:r,onClear:()=>r(""),placeholder:"Search people or messages..."})}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[s.length>0&&(0,t.jsx)("div",{className:"py-2",children:s.map(c=>(0,t.jsx)(ao,{conv:c,selectedId:i,onSelect:a,onlineUsers:o},c.id))}),e.length>0&&(0,t.jsxs)("div",{className:"border-t border-zinc-100 dark:border-zinc-800",children:[(0,t.jsx)("div",{className:"px-4 py-3 text-xs font-bold text-zinc-500 uppercase tracking-wider",children:"People"}),e.map(c=>(0,t.jsxs)("div",{onClick:()=>n(c),className:"flex items-center gap-3 p-4 cursor-pointer transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[(0,t.jsxs)(xe,{className:"size-12",children:[(0,t.jsx)(he,{src:c.avatar,alt:c.name,className:"object-cover"}),(0,t.jsx)(pe,{children:c.name?.[0]?.toUpperCase()})]}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("div",{className:"font-bold dark:text-white truncate",children:c.name}),(0,t.jsxs)("div",{className:"text-zinc-500 text-sm truncate",children:["@",c.handle]})]}),(0,t.jsx)(os,{size:18,className:"text-violet-500"})]},c.id))]}),s.length===0&&e.length===0&&l&&(0,t.jsx)("div",{className:"p-8 text-center",children:(0,t.jsxs)("p",{className:"text-zinc-500 text-sm",children:['No conversations or people found for "',l,'"']})}),s.length===0&&!l&&(0,t.jsx)("div",{className:"p-8 text-center",children:(0,t.jsx)("p",{className:"text-zinc-500 text-sm",children:"No messages yet. Search for people to start a chat!"})})]})]}),io=no,lo=K(),ro=s=>{const e=(0,lo.c)(7),{className:a}=s;let n;e[0]!==a?(n=ne("flex items-center gap-1 px-1 py-1.5",a),e[0]=a,e[1]=n):n=e[1];let i,l,r;e[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,t.jsx)("div",{className:"size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse"}),l=(0,t.jsx)("div",{className:"size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse [animation-delay:0.2s]"}),r=(0,t.jsx)("div",{className:"size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse [animation-delay:0.4s]"}),e[2]=i,e[3]=l,e[4]=r):(i=e[2],l=e[3],r=e[4]);let o;return e[5]!==n?(o=(0,t.jsxs)("div",{className:n,children:[i,l,r]}),e[5]=n,e[6]=o):o=e[6],o},oo=ro,It=K();function Qs(s){const e=(0,It.c)(4);let a;e[0]!==s?({...a}=s,e[0]=s,e[1]=a):a=e[1];let n;return e[2]!==a?(n=(0,t.jsx)(Va,{"data-slot":"popover",...a}),e[2]=a,e[3]=n):n=e[3],n}function Us(s){const e=(0,It.c)(4);let a;e[0]!==s?({...a}=s,e[0]=s,e[1]=a):a=e[1];let n;return e[2]!==a?(n=(0,t.jsx)(Qa,{"data-slot":"popover-trigger",...a}),e[2]=a,e[3]=n):n=e[3],n}function Vs(s){const e=(0,It.c)(12);let a,n,i,l;e[0]!==s?({className:a,align:i,sideOffset:l,...n}=s,e[0]=s,e[1]=a,e[2]=n,e[3]=i,e[4]=l):(a=e[1],n=e[2],i=e[3],l=e[4]);const r=i===void 0?"center":i,o=l===void 0?4:l;let c;e[5]!==a?(c=ne("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 rounded-md border p-4 shadow-md outline-hidden",a),e[5]=a,e[6]=c):c=e[6];let d;return e[7]!==r||e[8]!==n||e[9]!==o||e[10]!==c?(d=(0,t.jsx)(an,{children:(0,t.jsx)(cn,{"data-slot":"popover-content",align:r,sideOffset:o,className:c,...n})}),e[7]=r,e[8]=n,e[9]=o,e[10]=c,e[11]=d):d=e[11],d}var Ge=K();function co(s){const e=(0,Ge.c)(4);let a;e[0]!==s?({...a}=s,e[0]=s,e[1]=a):a=e[1];let n;return e[2]!==a?(n=(0,t.jsx)(gn,{"data-slot":"context-menu",...a}),e[2]=a,e[3]=n):n=e[3],n}function mo(s){const e=(0,Ge.c)(4);let a;e[0]!==s?({...a}=s,e[0]=s,e[1]=a):a=e[1];let n;return e[2]!==a?(n=(0,t.jsx)(Wa,{"data-slot":"context-menu-trigger",...a}),e[2]=a,e[3]=n):n=e[3],n}function uo(s){const e=(0,Ge.c)(8);let a,n;e[0]!==s?({className:a,...n}=s,e[0]=s,e[1]=a,e[2]=n):(a=e[1],n=e[2]);let i;e[3]!==a?(i=ne("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",a),e[3]=a,e[4]=i):i=e[4];let l;return e[5]!==n||e[6]!==i?(l=(0,t.jsx)(tn,{children:(0,t.jsx)(rn,{"data-slot":"context-menu-content",className:i,...n})}),e[5]=n,e[6]=i,e[7]=l):l=e[7],l}function yt(s){const e=(0,Ge.c)(12);let a,n,i,l;e[0]!==s?({className:a,inset:n,variant:l,...i}=s,e[0]=s,e[1]=a,e[2]=n,e[3]=i,e[4]=l):(a=e[1],n=e[2],i=e[3],l=e[4]);const r=l===void 0?"default":l;let o;e[5]!==a?(o=ne("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),e[5]=a,e[6]=o):o=e[6];let c;return e[7]!==n||e[8]!==i||e[9]!==o||e[10]!==r?(c=(0,t.jsx)(xn,{"data-slot":"context-menu-item","data-inset":n,"data-variant":r,className:o,...i}),e[7]=n,e[8]=i,e[9]=o,e[10]=r,e[11]=c):c=e[11],c}function fo(s){const e=(0,Ge.c)(10);let a,n,i;e[0]!==s?({className:a,inset:n,...i}=s,e[0]=s,e[1]=a,e[2]=n,e[3]=i):(a=e[1],n=e[2],i=e[3]);let l;e[4]!==a?(l=ne("text-foreground px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",a),e[4]=a,e[5]=l):l=e[5];let r;return e[6]!==n||e[7]!==i||e[8]!==l?(r=(0,t.jsx)(Aa,{"data-slot":"context-menu-label","data-inset":n,className:l,...i}),e[6]=n,e[7]=i,e[8]=l,e[9]=r):r=e[9],r}function Yt(s){const e=(0,Ge.c)(8);let a,n;e[0]!==s?({className:a,...n}=s,e[0]=s,e[1]=a,e[2]=n):(a=e[1],n=e[2]);let i;e[3]!==a?(i=ne("bg-border -mx-1 my-1 h-px",a),e[3]=a,e[4]=i):i=e[4];let l;return e[5]!==n||e[6]!==i?(l=(0,t.jsx)(Da,{"data-slot":"context-menu-separator",className:i,...n}),e[5]=n,e[6]=i,e[7]=l):l=e[7],l}var xo=K(),ho=s=>{const e=(0,xo.c)(10),{onEmojiSelect:a,className:n}=s;let i;e[0]!==n?(i=ne("isolate flex h-[350px] w-[320px] flex-col overflow-hidden rounded-xl border border-zinc-200 bg-white shadow-xl dark:border-zinc-800 dark:bg-zinc-950",n),e[0]=n,e[1]=i):i=e[1];let l;e[2]===Symbol.for("react.memo_cache_sentinel")?(l=(0,t.jsx)(Qe.Search,{className:"z-10 mx-3 mt-3 appearance-none rounded-lg border-none bg-zinc-100 px-3 py-2 text-sm outline-none placeholder:text-zinc-500 focus:ring-1 focus:ring-violet-500 dark:bg-zinc-900 dark:text-white",placeholder:"Search emojis..."}),e[2]=l):l=e[2];let r,o;e[3]===Symbol.for("react.memo_cache_sentinel")?(r=(0,t.jsx)(Qe.Loading,{className:"absolute inset-0 flex items-center justify-center text-zinc-400 text-sm dark:text-zinc-500",children:"Loadingâ€¦"}),o=(0,t.jsx)(Qe.Empty,{className:"absolute inset-0 flex items-center justify-center text-zinc-400 text-sm dark:text-zinc-500",children:"No emoji found."}),e[3]=r,e[4]=o):(r=e[3],o=e[4]);let c,d;e[5]===Symbol.for("react.memo_cache_sentinel")?(c=(0,t.jsxs)(Qe.Viewport,{className:"relative flex-1 outline-none no-scrollbar",children:[r,o,(0,t.jsx)(Qe.List,{className:"select-none pb-2",components:{CategoryHeader:bo,Row:go,Emoji:vo}})]}),d=(0,t.jsx)(Qe.ActiveEmoji,{children:jo}),e[5]=c,e[6]=d):(c=e[5],d=e[6]);let m;return e[7]!==a||e[8]!==i?(m=(0,t.jsxs)(Qe.Root,{onEmojiSelect:a,className:i,children:[l,c,d]}),e[7]=a,e[8]=i,e[9]=m):m=e[9],m},po=ho;function bo(s){const{category:e,...a}=s;return(0,t.jsx)("div",{className:"bg-white/80 px-4 pt-4 pb-1.5 font-bold text-zinc-500 text-[11px] uppercase tracking-wider backdrop-blur-sm dark:bg-zinc-950/80 dark:text-zinc-400",...a,children:e.label})}function go(s){const{children:e,...a}=s;return(0,t.jsx)("div",{className:"scroll-my-1 px-2",...a,children:e})}function vo(s){const{emoji:e,...a}=s;return(0,t.jsx)("button",{className:"flex aspect-square size-9 items-center justify-center rounded-lg text-xl transition-colors hover:bg-zinc-100 data-[active]:bg-violet-500/10 data-[active]:text-violet-500 dark:hover:bg-zinc-900 dark:data-[active]:bg-violet-500/20",...a,children:e.emoji})}function jo(s){const{emoji:e}=s;return(0,t.jsx)("div",{className:"flex items-center gap-3 border-t border-zinc-100 p-3 dark:border-zinc-800",children:e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"text-2xl",children:e.emoji}),(0,t.jsx)("span",{className:"text-xs font-bold text-zinc-600 dark:text-zinc-400 truncate",children:e.label.replace(/:/g,"").replace(/_/g," ")})]}):(0,t.jsx)("span",{className:"text-xs font-medium text-zinc-400",children:"Select an emoji..."})})}var yo=K(),wo=["â¤ï¸","ðŸ˜‚","ðŸ˜®","ðŸ˜¢","ðŸ™","ðŸ‘"],No=s=>{const e=(0,yo.c)(6),{onSelect:a,currentReaction:n}=s;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=(0,t.jsx)(Us,{asChild:!0,children:(0,t.jsx)("button",{className:"p-1.5 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-300 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full transition-all active:scale-90",onClick:ko,children:(0,t.jsx)(ds,{size:16})})}),e[0]=i):i=e[0];let l;e[1]!==n||e[2]!==a?(l=wo.map(o=>(0,t.jsx)("button",{onClick:()=>a(o),className:`text-xl p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full transition-all active:scale-125 ${n===o?"bg-zinc-100 dark:bg-zinc-800":""}`,children:o},o)),e[1]=n,e[2]=a,e[3]=l):l=e[3];let r;return e[4]!==l?(r=(0,t.jsxs)(Qs,{children:[i,(0,t.jsx)(Vs,{side:"top",align:"center",className:"w-fit p-1 rounded-full bg-white dark:bg-zinc-900 border border-zinc-100 dark:border-zinc-800 shadow-xl",onClick:_o,children:(0,t.jsx)("div",{className:"flex items-center gap-1",children:l})})]}),e[4]=l,e[5]=r):r=e[5],r},zo=No;function ko(s){return s.stopPropagation()}function _o(s){return s.stopPropagation()}var Co=K(),So=s=>{const e=(0,Co.c)(10),{reactions:a,currentUser:n,onToggle:i}=s;let l;e[0]!==a?(l=a===void 0?[]:a,e[0]=a,e[1]=l):l=e[1];const r=l;let o;e[2]!==n?.id||e[3]!==r?(o={},r.forEach(u=>{o[u.emoji]||(o[u.emoji]={count:0,me:!1}),o[u.emoji].count=o[u.emoji].count+1,u.user_id===n?.id&&(o[u.emoji].me=!0)}),e[2]=n?.id,e[3]=r,e[4]=o):o=e[4];const c=o;if(r.length===0)return null;let d;e[5]!==c?(d=Object.entries(c),e[5]=c,e[6]=d):d=e[6];let m;return e[7]!==i||e[8]!==d?(m=(0,t.jsx)("div",{className:"flex flex-wrap gap-1 mt-1 px-2",children:d.map(u=>{const[f,h]=u;return(0,t.jsxs)("button",{onClick:p=>{p.stopPropagation(),i(f)},className:`flex items-center gap-1.5 px-2 py-0.5 rounded-full text-xs font-medium border transition-all active:scale-90 ${h.me?"bg-violet-50 border-violet-200 text-violet-600 dark:bg-violet-900/30 dark:border-violet-800 dark:text-violet-400":"bg-white border-zinc-100 text-zinc-600 dark:bg-zinc-900 dark:border-zinc-800 dark:text-zinc-400"}`,children:[(0,t.jsx)("span",{children:f}),h.count>1&&(0,t.jsx)("span",{children:h.count})]},f)})}),e[7]=i,e[8]=d,e[9]=m):m=e[9],m},$o=So,Po=["â¤ï¸","ðŸ˜‚","ðŸ˜®","ðŸ˜¢","ðŸ™","ðŸ‘"],Mo=({conversation:s,messages:e,onBack:a,onSendMessage:n,onToggleReaction:i,onDeleteMessage:l,currentUser:r,onTyping:o,isLoading:c,isTyping:d,isOnline:m})=>{const{openLightbox:u}=Pt(),[f,h]=(0,b.useState)(""),[p,x]=(0,b.useState)(!1),[g,v]=(0,b.useState)([]),[j,N]=(0,b.useState)(!1),[y,w]=(0,b.useState)(null),k=(0,b.useRef)(null),_=(0,b.useRef)(null),C=(0,b.useRef)(null),F=Hs(s.user?.lastSeen);(0,b.useEffect)(()=>{_.current&&(_.current.scrollTop=_.current.scrollHeight)},[e,d]);const P=z=>{const I=z.target.value;h(I),o&&(o(!0),C.current&&clearTimeout(C.current),C.current=setTimeout(()=>{o(!1)},2e3))},T=z=>{h(I=>I+z.emoji)},R=z=>{z.preventDefault(),!(!f.trim()&&g.length===0)&&(o&&(clearTimeout(C.current),o(!1)),n(s.id,f,g.length>0?"image":"text",g,y?.id),h(""),v([]),w(null))},M=async z=>{const I=Array.from(z.target.files);if(I.length!==0){x(!0);try{const W=await Promise.all(I.map(S=>Ie(S)));v(S=>[...S,...W])}catch(W){console.error("Upload failed:",W)}finally{x(!1)}}},E=z=>{v(I=>I.filter(W=>W.url!==z))},B=z=>{!z.media||z.media.length===0||u(z.media.map(I=>I.url),0)},A=(0,b.useMemo)(()=>{const z=e.filter(I=>I.sender==="me");return z.length>0?z[z.length-1].id:null},[e]),L=z=>e.find(I=>I.id===z);return(0,t.jsxs)("div",{className:"flex-1 flex flex-col h-full min-w-0 bg-white dark:bg-black md:border-l md:border-zinc-100 dark:md:border-zinc-800",children:[(0,t.jsxs)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800 flex items-center justify-between shrink-0 bg-white/80 dark:bg-black/80 backdrop-blur-md sticky top-0 z-10",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("button",{onClick:a,className:"md:hidden p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:(0,t.jsx)(Ye,{size:20})}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)(xe,{className:"size-10 border border-zinc-200 dark:border-zinc-700",children:[(0,t.jsx)(he,{src:s.user.avatar,alt:s.user.name,className:"object-cover"}),(0,t.jsx)(pe,{children:s.user.name?.[0]?.toUpperCase()})]}),m&&(0,t.jsx)("span",{className:"absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-bold dark:text-white",children:s.user.name}),m?(0,t.jsxs)("div",{className:"text-xs text-emerald-500 font-medium flex items-center gap-1",children:[(0,t.jsx)("span",{className:"size-1.5 bg-emerald-500 rounded-full animate-pulse"}),"Online"]}):(0,t.jsx)("div",{className:"text-xs text-zinc-500 font-medium",children:s.user.lastSeen?`Last seen ${F}`:"Offline"})]})]}),(0,t.jsx)("button",{className:"p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full dark:text-zinc-400",children:(0,t.jsx)(Sa,{size:20})})]}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",ref:_,children:[(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsxs)("div",{className:"relative w-fit mx-auto",children:[(0,t.jsxs)(xe,{className:"size-20 mx-auto mb-3 border-4 border-zinc-50 dark:border-zinc-900 shadow-sm",children:[(0,t.jsx)(he,{src:s.user.avatar,alt:s.user.name,className:"object-cover"}),(0,t.jsx)(pe,{className:"text-2xl font-bold",children:s.user.name?.[0]?.toUpperCase()})]}),m&&(0,t.jsx)("span",{className:"absolute bottom-4 right-1 size-5 bg-emerald-500 border-4 border-white dark:border-black rounded-full animate-in zoom-in duration-300"})]}),(0,t.jsx)("h4",{className:"font-bold dark:text-white text-lg",children:s.user.name}),(0,t.jsxs)("p",{className:"text-sm text-zinc-500",children:["@",s.user.handle]}),(0,t.jsxs)("p",{className:"text-xs text-zinc-400 mt-4 max-w-xs mx-auto",children:["This is the beginning of your direct message history with"," ",(0,t.jsxs)("span",{className:"font-bold",children:["@",s.user.handle]})]})]}),c&&e.length===0?(0,t.jsx)("div",{className:"flex justify-center p-8",children:(0,t.jsx)(oe,{className:"animate-spin text-violet-500",size:32})}):e.map(z=>(0,t.jsxs)(co,{children:[(0,t.jsx)(mo,{asChild:!0,children:(0,t.jsxs)("div",{id:`msg-${z.id}`,className:`flex items-end gap-2 group ${z.sender==="me"?"flex-row-reverse":"flex-row"}`,children:[(0,t.jsxs)("div",{className:`max-w-[75%] p-1 rounded-2xl text-[15px] shadow-sm relative ${z.sender==="me"?"bg-violet-600 text-white rounded-tr-none":"bg-zinc-100 dark:bg-zinc-800 dark:text-white rounded-tl-none"}`,children:[z.replyToId&&(0,t.jsxs)("div",{className:`mb-2 p-2 rounded-lg border-l-4 text-xs truncate cursor-pointer ${z.sender==="me"?"bg-violet-500/50 border-violet-300 text-violet-100":"bg-zinc-200/50 dark:bg-zinc-700/50 border-zinc-400 dark:border-zinc-500 text-zinc-600 dark:text-zinc-300"}`,onClick:I=>{I.stopPropagation(),document.getElementById(`msg-${z.replyToId}`)?.scrollIntoView({behavior:"smooth",block:"center"})},children:[(0,t.jsx)("span",{className:"font-bold block mb-0.5",children:L(z.replyToId)?.sender==="me"?"You":s.user.name}),L(z.replyToId)?.text||"Media"]}),z.media?.length>0&&(0,t.jsx)("div",{className:"mb-2 grid gap-1 grid-cols-1 overflow-hidden rounded-lg cursor-pointer",onClick:()=>B(z),children:z.media.map((I,W)=>(0,t.jsx)("img",{src:I.url,alt:"",className:"max-h-60 w-full object-cover rounded-md hover:brightness-90 transition-all"},W))}),z.text&&(0,t.jsx)("p",{className:"m-0 leading-tight px-3 py-1",children:z.text}),z.reactions?.length>0&&(0,t.jsx)($o,{reactions:z.reactions,currentUser:r,onToggle:I=>i(z.id,I)}),(0,t.jsxs)("div",{className:`text-[10px] flex items-center justify-end gap-1 px-3 pb-1 ${z.sender==="me"?"text-violet-200":"text-zinc-400"}`,children:[z.time,z.sender==="me"&&z.id===A&&(0,t.jsx)("span",{className:"ml-0.5",children:z.isRead?(0,t.jsx)(Fa,{size:14,className:"text-white"}):(0,t.jsx)(La,{size:14,className:"text-violet-200"})})]})]}),(0,t.jsx)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:(0,t.jsx)(zo,{onSelect:I=>i(z.id,I),currentReaction:z.reactions?.find(I=>I.user_id===r?.id)?.emoji})})]})}),(0,t.jsxs)(uo,{className:"w-64 rounded-xl bg-white dark:bg-zinc-950 border-zinc-100 dark:border-zinc-800 shadow-xl",children:[(0,t.jsx)(fo,{className:"text-xs text-zinc-500 font-bold px-3 py-2",children:"QUICK REACTION"}),(0,t.jsx)("div",{className:"flex items-center justify-between px-2 pb-2",children:Po.map(I=>(0,t.jsx)("button",{onClick:()=>i(z.id,I),className:"text-xl p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full transition-all active:scale-125",children:I},I))}),(0,t.jsx)(Yt,{className:"bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsxs)(yt,{className:"gap-3 px-3 py-2.5 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-900",onClick:()=>{navigator.clipboard.writeText(z.text)},children:[(0,t.jsx)(Pa,{size:16,className:"text-zinc-500"}),(0,t.jsx)("span",{className:"font-medium",children:"Copy Text"})]}),(0,t.jsxs)(yt,{className:"gap-3 px-3 py-2.5 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-900",onClick:()=>w(z),children:[(0,t.jsx)(Ua,{size:16,className:"text-zinc-500"}),(0,t.jsx)("span",{className:"font-medium",children:"Reply"})]}),(0,t.jsx)(Yt,{className:"bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsxs)(yt,{className:"gap-3 px-3 py-2.5 cursor-pointer text-rose-500 focus:text-rose-500 focus:bg-rose-50 dark:focus:bg-rose-900/20",onClick:()=>l(z.id),children:[(0,t.jsx)(Oa,{size:16}),(0,t.jsx)("span",{className:"font-medium",children:"Delete message"})]})]})]},z.id)),d&&(0,t.jsx)("div",{className:"flex justify-start animate-in fade-in slide-in-from-bottom-2 duration-300",children:(0,t.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-800/50 px-3 py-2 rounded-2xl rounded-tl-none border border-zinc-200/50 dark:border-zinc-700/30 shadow-sm",children:(0,t.jsx)(oo,{})})})]}),(0,t.jsxs)("div",{className:"p-4 border-t border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black shrink-0",children:[y&&(0,t.jsxs)("div",{className:"mb-3 p-3 bg-zinc-50 dark:bg-zinc-900 border border-zinc-100 dark:border-zinc-800 rounded-xl flex items-center justify-between animate-in slide-in-from-bottom-2 duration-200",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("span",{className:"text-xs font-bold text-violet-600 dark:text-violet-400 block mb-1",children:["Replying to"," ",y.sender==="me"?"yourself":s.user.name]}),(0,t.jsx)("p",{className:"text-sm text-zinc-500 truncate",children:y.text||"Media"})]}),(0,t.jsx)("button",{onClick:()=>w(null),className:"p-1 hover:bg-zinc-200 dark:hover:bg-zinc-800 rounded-full text-zinc-400 transition-colors",children:(0,t.jsx)(we,{size:18})})]}),g.length>0&&(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 mb-3",children:[g.map(z=>(0,t.jsxs)("div",{className:"relative size-16 rounded-xl overflow-hidden border border-zinc-200 dark:border-zinc-800",children:[(0,t.jsx)("img",{src:z.url,className:"size-full object-cover",alt:""}),(0,t.jsx)("button",{type:"button",onClick:()=>E(z.url),className:"absolute top-1 right-1 bg-black/50 text-white rounded-full p-0.5 hover:bg-black transition-colors",children:(0,t.jsx)(we,{size:12})})]},z.url)),p&&(0,t.jsx)("div",{className:"size-16 rounded-xl bg-zinc-100 dark:bg-zinc-900 flex items-center justify-center",children:(0,t.jsx)(oe,{className:"animate-spin text-violet-500",size:20})})]}),(0,t.jsxs)("form",{onSubmit:R,className:"flex items-center gap-2 bg-zinc-100 dark:bg-zinc-900 p-2 rounded-2xl border border-transparent focus-within:border-violet-500 transition-all",children:[(0,t.jsxs)(Qs,{open:j,onOpenChange:N,children:[(0,t.jsx)(Us,{asChild:!0,children:(0,t.jsx)("button",{type:"button",className:"p-2 text-zinc-500 hover:text-violet-600 transition-colors",children:(0,t.jsx)(ds,{size:20})})}),(0,t.jsx)(Vs,{className:"w-fit p-0 border-none bg-transparent shadow-none",side:"top",align:"start",sideOffset:10,children:(0,t.jsx)(po,{onEmojiSelect:z=>{T(z)}})})]}),(0,t.jsx)("input",{type:"text",className:"flex-1 min-w-0 bg-transparent border-none outline-none dark:text-white py-1 px-1",placeholder:"Start a new message",value:f,onChange:P}),(0,t.jsx)("input",{type:"file",ref:k,onChange:M,className:"hidden",multiple:!0,accept:"image/*"}),(0,t.jsx)("button",{type:"button",onClick:()=>k.current?.click(),className:"p-2 text-zinc-500 hover:text-violet-600 transition-colors",disabled:p,children:(0,t.jsx)(cs,{size:20})}),(0,t.jsx)(ue,{type:"submit",className:"size-10 !p-0 rounded-xl",disabled:!f.trim()&&g.length===0||p,children:(0,t.jsx)(dn,{size:18})})]})]})]})},Fo=Mo,Ro=K(),Lo=()=>{const s=(0,Ro.c)(73),{id:e}=ut(),a=je(),{currentUser:n}=fe(),{onlineUsers:i}=zs(),l=ft(),[r,o]=(0,b.useState)("");let c;s[0]===Symbol.for("react.memo_cache_sentinel")?(c=[],s[0]=c):c=s[0];const[d,m]=(0,b.useState)(c),{conversations:u,isConvLoading:f,sendMessage:h,sendTypingStatus:p,typingStatus:x,markAsRead:g,formatMessages:v,onToggleReaction:j,allReactions:N}=Mt(n);let y;e:{if(!e||u.length===0){y=null;break e}let G;s[1]!==u||s[2]!==e?(G=u.find(ce=>ce.id===e)||null,s[1]=u,s[2]=e,s[3]=G):G=s[3],y=G}const w=y;let k,_;s[4]!==e||s[5]!==g?(k=()=>{e&&g(e)},_=[e,g],s[4]=e,s[5]=g,s[6]=k,s[7]=_):(k=s[6],_=s[7]),(0,b.useEffect)(k,_);let C;s[8]!==u||s[9]!==n?.id||s[10]!==r?(C=()=>{const G=setTimeout(async()=>{if(r.length>1){const ce=await Tn(r),be=u.map(Io);m(ce.filter(ge=>ge.id!==n?.id&&!be.includes(ge.id)))}else m([])},300);return()=>clearTimeout(G)},s[8]=u,s[9]=n?.id,s[10]=r,s[11]=C):C=s[11];const F=n?.id;let P;s[12]!==u||s[13]!==r||s[14]!==F?(P=[r,u,F],s[12]=u,s[13]=r,s[14]=F,s[15]=P):P=s[15],(0,b.useEffect)(C,P);let T;s[16]!==n||s[17]!==a||s[18]!==l?(T=async G=>{try{const ce=await js(n.id,G.id);l.invalidateQueries({queryKey:["conversations",n.id]}),o(""),a(`/messages/${ce}`)}catch(ce){console.error("Failed to start conversation:",ce)}},s[16]=n,s[17]=a,s[18]=l,s[19]=T):T=s[19];const R=T;let M;s[20]!==a?(M=G=>{a(`/messages/${G.id}`)},s[20]=a,s[21]=M):M=s[21];const E=M,B=w?.id;let A;s[22]!==B?(A=["messages",B],s[22]=B,s[23]=A):A=s[23];let L;s[24]!==w?.id?(L=()=>ri(w?.id),s[24]=w?.id,s[25]=L):L=s[25];const z=!!w?.id;let I;s[26]!==A||s[27]!==L||s[28]!==z?(I={queryKey:A,queryFn:L,enabled:z},s[26]=A,s[27]=L,s[28]=z,s[29]=I):I=s[29];const{data:W,isLoading:S}=Oe(I);let q;s[30]!==W?(q=W===void 0?[]:W,s[30]=W,s[31]=q):q=s[31];const $=q;let J;s[32]!==N||s[33]!==$||s[34]!==v?(J=v($,N),s[32]=N,s[33]=$,s[34]=v,s[35]=J):J=s[35];const X=J;if(!n){let G;return s[36]===Symbol.for("react.memo_cache_sentinel")?(G=(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-screen gap-4 p-8 text-center bg-white dark:bg-black md:rounded-xl md:border border-zinc-100 dark:border-zinc-800",children:[(0,t.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-900 p-4 rounded-full",children:(0,t.jsx)(Ba,{size:40,className:"text-zinc-400"})}),(0,t.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"Sign in to message others"}),(0,t.jsx)("p",{className:"text-zinc-500 max-w-xs",children:"Start decentralized conversations with anyone on the network."})]}),s[36]=G):G=s[36],G}if(f){let G;return s[37]===Symbol.for("react.memo_cache_sentinel")?(G=(0,t.jsx)("div",{className:"flex h-screen items-center justify-center bg-white dark:bg-black md:rounded-xl md:border border-zinc-100 dark:border-zinc-800",children:(0,t.jsx)(oe,{className:"animate-spin text-violet-500",size:32})}),s[37]=G):G=s[37],G}let se;if(s[38]!==u||s[39]!==r){let G;s[41]!==r?(G=ce=>ce.user?.name?.toLowerCase().includes(r.toLowerCase())||ce.user?.handle?.toLowerCase().includes(r.toLowerCase())||ce.lastMessage?.toLowerCase().includes(r.toLowerCase()),s[41]=r,s[42]=G):G=s[42],se=u.filter(G),s[38]=u,s[39]=r,s[40]=se}else se=s[40];const ie=se,le=w&&x[w.id];let re;s[43]!==i||s[44]!==w?(re=w&&i.has(w.user?.id),s[43]=i,s[44]=w,s[45]=re):re=s[45];const de=re,me=`flex ${e?"h-[100dvh]":"h-[calc(100dvh-4rem)]"} md:h-[calc(100vh-2rem)] bg-white dark:bg-black overflow-hidden md:rounded-xl md:border border-zinc-100 dark:border-zinc-800`,ee=`w-full md:w-80 flex flex-col border-r border-zinc-100 dark:border-zinc-800 ${w?"hidden md:flex":"flex"}`;let te;s[46]===Symbol.for("react.memo_cache_sentinel")?(te=(0,t.jsx)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800",children:(0,t.jsx)("h2",{className:"text-xl font-bold dark:text-white",children:"Messages"})}),s[46]=te):te=s[46];let H;s[47]!==ie||s[48]!==E||s[49]!==R||s[50]!==e||s[51]!==r||s[52]!==i||s[53]!==d?(H=(0,t.jsx)(io,{conversations:ie,userResults:d,onSelect:E,onStartNew:R,selectedId:e,searchQuery:r,onSearchChange:o,onlineUsers:i}),s[47]=ie,s[48]=E,s[49]=R,s[50]=e,s[51]=r,s[52]=i,s[53]=d,s[54]=H):H=s[54];let V;s[55]!==ee||s[56]!==H?(V=(0,t.jsxs)("div",{className:ee,children:[te,H]}),s[55]=ee,s[56]=H,s[57]=V):V=s[57];let Q;s[58]!==le||s[59]!==n||s[60]!==S||s[61]!==X||s[62]!==a||s[63]!==j||s[64]!==de||s[65]!==w||s[66]!==h||s[67]!==p?(Q=w?(0,t.jsx)(Fo,{conversation:w,messages:X,onBack:()=>a("/messages"),onSendMessage:h,onToggleReaction:j,currentUser:n,onTyping:G=>p(w.id,G),isLoading:S,isTyping:le,isOnline:de}):(0,t.jsxs)("div",{className:"hidden md:flex flex-1 items-center justify-center text-zinc-500 flex-col gap-4",children:[(0,t.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full",children:(0,t.jsx)(dt,{size:48,className:"text-zinc-300"})}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-zinc-900 dark:text-white",children:"Select a message"}),(0,t.jsx)("p",{children:"Choose from your existing conversations or start a new one."})]})]}),s[58]=le,s[59]=n,s[60]=S,s[61]=X,s[62]=a,s[63]=j,s[64]=de,s[65]=w,s[66]=h,s[67]=p,s[68]=Q):Q=s[68];let ae;return s[69]!==me||s[70]!==V||s[71]!==Q?(ae=(0,t.jsxs)("div",{className:me,children:[V,Q]}),s[69]=me,s[70]=V,s[71]=Q,s[72]=ae):ae=s[72],ae},Gt=Lo;function Io(s){return s.user?.id}var Eo=()=>{const{currentUser:s}=fe(),e=je(),[a,n]=(0,b.useState)([]),[i,l]=(0,b.useState)(!0),[r,o]=(0,b.useState)(!1),[c,d]=(0,b.useState)(!0),m=(0,b.useRef)(a);(0,b.useEffect)(()=>{m.current=a},[a]);const u=(0,b.useCallback)(async(x=!1)=>{if(s?.id){x?o(!0):l(!0);try{const g=m.current,v=x&&g.length>0?g[g.length-1].created_at:null,j=await ui(s.id,v,10);j.length<10?d(!1):d(!0),n(x?N=>[...N,...j]:j)}catch(g){console.error("Failed to fetch notifications:",g)}finally{l(!1),o(!1)}}},[s?.id]);(0,b.useEffect)(()=>{u()},[u]),(0,b.useEffect)(()=>{if(!s?.id)return;const x=O.channel(`user_notifications:${s.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`recipient_id=eq.${s.id}`},()=>{u()}).subscribe();return()=>O.removeChannel(x)},[s?.id,u]);const f=rs({mutationFn:()=>fi(s.id),onSuccess:()=>{n(x=>x.map(g=>({...g,is_read:!0})))}}),h=x=>{x.type==="follow"?e(`/u/${x.user}`):x.post_id&&e(`/post/${x.post_id}`)};if((0,b.useEffect)(()=>{s?.id&&a.some(x=>!x.is_read)&&f.mutate()},[s?.id,a,f]),i)return(0,t.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,t.jsx)(oe,{size:32,className:"animate-spin text-violet-500"})});if(!s)return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[400px] gap-4 p-8 text-center",children:[(0,t.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-900 p-4 rounded-full",children:(0,t.jsx)(vt,{size:40,className:"text-zinc-400"})}),(0,t.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"Sign in to see notifications"}),(0,t.jsx)("p",{className:"text-zinc-500 max-w-xs",children:"Join the conversation and keep track of who's engaging with your content."})]});const p=x=>{switch(x){case"like":return(0,t.jsx)(st,{size:20,className:"text-rose-500 fill-rose-500"});case"follow":return(0,t.jsx)(os,{size:20,className:"text-blue-500"});case"mention":return(0,t.jsx)(vt,{size:20,className:"text-emerald-500"});case"comment":return(0,t.jsx)(wn,{size:20,className:"text-violet-500"});case"repost":return(0,t.jsx)(Zs,{size:20,className:"text-amber-500"});default:return(0,t.jsx)(vt,{size:20,className:"text-zinc-500"})}};return(0,t.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm",children:[(0,t.jsx)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800 sticky top-0 bg-white/80 dark:bg-black/80 backdrop-blur-md z-10",children:(0,t.jsx)("h2",{className:"text-xl font-bold dark:text-white",children:"Notifications"})}),a.length>0?a.map(x=>(0,t.jsxs)("div",{onClick:()=>h(x),className:`p-4 border-b border-zinc-100 dark:border-zinc-800 flex items-start gap-4 hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors cursor-pointer ${x.is_read?"":"bg-violet-50/30 dark:bg-violet-500/5"}`,children:[(0,t.jsx)("div",{className:"shrink-0 pt-1",children:p(x.type)}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-1",children:[(0,t.jsxs)(xe,{className:"size-8",children:[(0,t.jsx)(he,{src:x.avatar}),(0,t.jsx)(pe,{children:x.user?.[0]?.toUpperCase()})]}),(0,t.jsxs)("div",{className:"flex-1 flex justify-between items-center",children:[(0,t.jsxs)("span",{className:"font-bold text-sm dark:text-white truncate",children:["@",x.user]}),(0,t.jsx)("span",{className:"text-zinc-500 text-xs whitespace-nowrap",children:lt(x.created_at)})]})]}),(0,t.jsxs)("p",{className:"text-zinc-600 dark:text-zinc-400 text-[15px] ml-11",children:[x.type==="like"&&"liked your post",x.type==="follow"&&"followed you",x.type==="mention"&&"mentioned you in a post",x.type==="comment"&&"commented on your post",x.type==="repost"&&"reposted your post"]})]}),!x.is_read&&(0,t.jsx)("div",{className:"size-2 rounded-full bg-violet-500 mt-2 shrink-0 shadow-[0_0_8px_rgba(139,92,246,0.5)]"})]},x.id)):(0,t.jsx)("div",{className:"p-16 text-center text-zinc-500",children:(0,t.jsx)("p",{className:"font-medium",children:"No notifications yet."})}),a.length>0&&c&&(0,t.jsx)("div",{className:"p-6 flex justify-center border-t border-zinc-100 dark:border-zinc-800",children:(0,t.jsxs)(ue,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>u(!0),disabled:r,children:[r?(0,t.jsx)(oe,{size:18,className:"animate-spin mr-2"}):null,"Load more"]})}),a.length>0&&!c&&(0,t.jsx)("div",{className:"p-8 text-center text-zinc-500 text-sm",children:"You've caught up with everything!"})]})},To=Eo,qo=({profile:s,currentUser:e,isCurrentUser:a,onEditProfile:n,showToast:i,isCommunity:l,onShowFollowers:r,onShowFollowing:o})=>{const{isFollowing:c,stats:d,loading:m,handleFollow:u}=Bs(s,e?.id,i),f=je(),[h,p]=(0,b.useState)(!1),x=async()=>{if(!e){i("Please sign in to message users");return}p(!0);try{f(`/messages/${await js(e.id,s.id)}`)}catch(g){console.error("Failed to start conversation:",g),i("Failed to open chat")}finally{p(!1)}};return(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsxs)("div",{className:"relative h-32 sm:h-48 w-full bg-zinc-200 dark:bg-zinc-800",children:[s.cover&&(0,t.jsx)("img",{src:s.cover,className:"h-full w-full object-cover transition-opacity duration-500",alt:"Cover"}),(0,t.jsx)("div",{className:"absolute -bottom-12 sm:-bottom-16 left-4 sm:left-6",children:(0,t.jsx)("div",{className:"p-1 bg-white dark:bg-black rounded-full overflow-hidden shadow-xl ring-4 ring-white dark:ring-black relative",children:(0,t.jsxs)(xe,{className:"size-24 sm:size-32",children:[(0,t.jsx)(he,{src:s.avatar,alt:s.handle,className:"object-cover"}),(0,t.jsx)(pe,{className:"text-4xl font-bold",children:s.handle?.[0]?.toUpperCase()})]})})})]}),(0,t.jsxs)("div",{className:"flex flex-col p-4 sm:p-6 pt-16 sm:pt-20 space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsx)("div",{className:"flex-1 min-w-0 pr-4"}),(0,t.jsx)("div",{className:"flex gap-2 shrink-0",children:a?(0,t.jsx)(ue,{variant:"secondary",onClick:()=>n(s),className:"text-sm px-5",children:"Edit profile"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:x,disabled:h,className:"rounded-full p-2 border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 dark:border-zinc-800 transition-colors disabled:opacity-50",children:h?(0,t.jsx)(oe,{size:20,className:"animate-spin"}):(0,t.jsx)(dt,{size:20})}),(0,t.jsx)("button",{className:"rounded-full p-2 border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 dark:border-zinc-800 transition-colors",children:(0,t.jsx)(Ct,{size:20})}),(0,t.jsx)(ue,{variant:c?"secondary":"primary",onClick:u,className:"text-sm px-6 min-w-[100px]",disabled:m,children:m?(0,t.jsx)(oe,{size:16,className:"animate-spin mx-auto"}):c?"Following":"Follow"}),(0,t.jsx)("button",{className:"rounded-full p-2 hover:bg-zinc-100 text-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-800 transition-colors",children:(0,t.jsx)(Nt,{size:20})})]})})]}),(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)("div",{className:"flex items-center gap-1.5",children:(0,t.jsxs)("h3",{className:"text-xl sm:text-2xl font-extrabold truncate dark:text-white flex items-center gap-1",children:[s.name,s.verified&&(0,t.jsx)(ct,{})]})}),!l&&(0,t.jsx)("div",{className:"flex items-center space-x-3",children:(0,t.jsxs)("span",{className:"text-zinc-500 font-medium text-sm px-1.5 py-0.5 -ml-1.5 rounded-md dark:text-zinc-400",children:["@",s.handle]})})]}),(0,t.jsx)("div",{className:"whitespace-pre-line text-zinc-900 dark:text-zinc-100 leading-relaxed text-sm sm:text-[15px]",children:s.bio}),(s.website||s.location)&&(0,t.jsxs)("div",{className:"flex flex-wrap gap-x-5 gap-y-2 text-sm pt-1",children:[s.location&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-zinc-600 dark:text-zinc-400",children:[(0,t.jsx)(es,{size:14}),(0,t.jsx)("span",{children:s.location})]}),s.website&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-zinc-600 dark:text-zinc-400",children:[(0,t.jsx)(us,{size:14}),(0,t.jsx)("a",{href:`https://${s.website}`,target:"_blank",rel:"noreferrer",className:"text-violet-600 hover:underline font-semibold text-black dark:text-white",children:s.website})]})]}),(0,t.jsx)("div",{className:"flex gap-4 sm:gap-6 text-sm pt-2 relative z-10",children:l?(0,t.jsxs)("button",{className:"flex gap-x-1 hover:underline group cursor-pointer",children:[(0,t.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white group-hover:text-violet-600",children:s.members}),(0,t.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Members"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{onClick:g=>{g.preventDefault(),g.stopPropagation(),o()},className:"flex gap-x-1 hover:underline group cursor-pointer",children:[(0,t.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white group-hover:text-violet-600",children:d.following}),(0,t.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Following"})]}),(0,t.jsxs)("button",{onClick:g=>{g.preventDefault(),g.stopPropagation(),r()},className:"flex gap-x-1 hover:underline group cursor-pointer",children:[(0,t.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white group-hover:text-violet-600",children:d.followers}),(0,t.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Followers"})]})]})})]})]})},Ao=qo,Oo=K(),Do=s=>{const e=(0,Oo.c)(20),{title:a,message:n,icon:i,showHome:l,showBack:r}=s,o=a===void 0?"Not Found":a,c=n===void 0?"The content you are looking for doesn't exist or has been removed.":n,d=i===void 0?ns:i,m=l===void 0?!0:l,u=r===void 0?!0:r,f=je(),h=d;let p;e[0]!==h?(p=(0,t.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-900 p-6 rounded-full mb-6",children:(0,t.jsx)(h,{size:48,className:"text-zinc-400 dark:text-zinc-600"})}),e[0]=h,e[1]=p):p=e[1];let x;e[2]!==o?(x=(0,t.jsx)("h2",{className:"text-2xl font-black mb-2 dark:text-white",children:o}),e[2]=o,e[3]=x):x=e[3];let g;e[4]!==c?(g=(0,t.jsx)("p",{className:"text-zinc-500 dark:text-zinc-400 max-w-xs mb-8 leading-relaxed",children:c}),e[4]=c,e[5]=g):g=e[5];let v;e[6]!==f||e[7]!==u?(v=u&&(0,t.jsxs)(ue,{variant:"secondary",onClick:()=>f(-1),className:"rounded-full px-6",children:[(0,t.jsx)(Ye,{size:18,className:"mr-2"}),"Go Back"]}),e[6]=f,e[7]=u,e[8]=v):v=e[8];let j;e[9]!==f||e[10]!==m?(j=m&&(0,t.jsxs)(ue,{onClick:()=>f("/"),className:"bg-zinc-900 dark:bg-white text-white dark:text-zinc-900 rounded-full px-6",children:[(0,t.jsx)(_t,{size:18,className:"mr-2"}),"Home"]}),e[9]=f,e[10]=m,e[11]=j):j=e[11];let N;e[12]!==j||e[13]!==v?(N=(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-center gap-3",children:[v,j]}),e[12]=j,e[13]=v,e[14]=N):N=e[14];let y;return e[15]!==N||e[16]!==p||e[17]!==x||e[18]!==g?(y=(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[400px] p-8 text-center animate-in fade-in zoom-in-95 duration-300",children:[p,x,g,N]}),e[15]=N,e[16]=p,e[17]=x,e[18]=g,e[19]=y):y=e[19],y},Et=Do,bt=K();function Bo(s){const e=(0,bt.c)(8);let a,n;e[0]!==s?({className:a,...n}=s,e[0]=s,e[1]=a,e[2]=n):(a=e[1],n=e[2]);let i;e[3]!==a?(i=ne("flex flex-col gap-2",a),e[3]=a,e[4]=i):i=e[4];let l;return e[5]!==n||e[6]!==i?(l=(0,t.jsx)(un,{"data-slot":"tabs",className:i,...n}),e[5]=n,e[6]=i,e[7]=l):l=e[7],l}function Wo(s){const e=(0,bt.c)(8);let a,n;e[0]!==s?({className:a,...n}=s,e[0]=s,e[1]=a,e[2]=n):(a=e[1],n=e[2]);let i;e[3]!==a?(i=ne("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",a),e[3]=a,e[4]=i):i=e[4];let l;return e[5]!==n||e[6]!==i?(l=(0,t.jsx)(nn,{"data-slot":"tabs-list",className:i,...n}),e[5]=n,e[6]=i,e[7]=l):l=e[7],l}function Ho(s){const e=(0,bt.c)(8);let a,n;e[0]!==s?({className:a,...n}=s,e[0]=s,e[1]=a,e[2]=n):(a=e[1],n=e[2]);let i;e[3]!==a?(i=ne("inline-flex items-center justify-center gap-1.5 px-2 py-1 text-sm font-medium whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 outline-none focus:outline-none focus-visible:outline-none ring-0 focus:ring-0 focus-visible:ring-0 shadow-none data-[state=active]:shadow-none",a),e[3]=a,e[4]=i):i=e[4];let l;return e[5]!==n||e[6]!==i?(l=(0,t.jsx)(Ja,{"data-slot":"tabs-trigger",className:i,...n}),e[5]=n,e[6]=i,e[7]=l):l=e[7],l}function wt(s){const e=(0,bt.c)(8);let a,n;e[0]!==s?({className:a,...n}=s,e[0]=s,e[1]=a,e[2]=n):(a=e[1],n=e[2]);let i;e[3]!==a?(i=ne("flex-1 outline-none",a),e[3]=a,e[4]=i):i=e[4];let l;return e[5]!==n||e[6]!==i?(l=(0,t.jsx)(bn,{"data-slot":"tabs-content",className:i,...n}),e[5]=n,e[6]=i,e[7]=l):l=e[7],l}var Qo=({onEditProfile:s})=>{const{handle:e}=ut(),a=je(),{profiles:n,currentUser:i,getProfileByHandle:l}=fe(),{addToast:r}=Ce(),[o,c]=(0,b.useState)(n[e]),[d,m]=(0,b.useState)(!o),[u,f]=(0,b.useState)([]),[h,p]=(0,b.useState)([]),[x,g]=(0,b.useState)("feed"),[v,j]=(0,b.useState)(!0),[N,y]=(0,b.useState)(!1),[w,k]=(0,b.useState)(!0),[_,C]=(0,b.useState)(!1),[F,P]=(0,b.useState)(!0),T=(0,b.useRef)(u),R=(0,b.useRef)(h);(0,b.useEffect)(()=>{T.current=u,R.current=h},[u,h]);const[M,E]=(0,b.useState)(!1),[B,A]=(0,b.useState)("Followers"),[L,z]=(0,b.useState)([]),[I,W]=(0,b.useState)(!1),[S,q]=(0,b.useState)(!1),[$,J]=(0,b.useState)(!0),X=(0,b.useRef)(L);(0,b.useEffect)(()=>{X.current=L},[L]);const se=(0,b.useCallback)(async(H,V=!1)=>{if(H){V?y(!0):j(!0);try{const Q=T.current,ae=await Vn(H,V&&Q.length>0?Q[Q.length-1].created_at:null,10);ae.length<10?k(!1):k(!0),f(V?G=>[...G,...ae]:ae)}catch(Q){console.error("Failed to fetch user posts:",Q)}finally{j(!1),y(!1)}}},[]),ie=(0,b.useCallback)(async(H,V=!1)=>{if(H){V?C(!0):j(!0);try{const Q=R.current,ae=await Kn(H,V&&Q.length>0?Q[Q.length-1].created_at:null,10);ae.length<10?P(!1):P(!0),p(V?G=>[...G,...ae]:ae)}catch(Q){console.error("Failed to fetch user replies:",Q)}finally{j(!1),C(!1)}}},[]),le=async(H,V=!1)=>{const Q=o?.id||ee?.id;if(Q){V?q(!0):(A(H),E(!0),W(!0),z([]));try{const ae=X.current,G=V&&ae.length>0?ae[ae.length-1].followed_at:null,ce=H==="Followers"?await Bn(Q,G,10):await Wn(Q,G,10);ce.length<10?J(!1):J(!0),z(V?be=>[...be,...ce]:ce)}catch(ae){console.error(`Failed to fetch ${H}:`,ae),r(`Failed to load ${H}`)}finally{W(!1),q(!1)}}};(0,b.useEffect)(()=>{(async()=>{let V=n[e];V?c(V):(m(!0),V=await l(e),c(V),m(!1)),V?.id&&(se(V.id),ie(V.id))})()},[e,n,l,se,ie]);const re=(0,b.useMemo)(()=>x==="feed"?u.filter(H=>H.parent_id===null):x==="media"?u.filter(H=>H.parent_id===null&&(H.type==="video"||H.type==="image"||H.media&&H.media.length>0)):x==="replies"?h:u,[u,h,x]),de=H=>{a(`/post/${H}`)},me=H=>{H!==e&&a(`/u/${H}`)};if(d)return(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)(oe,{size:40,className:"animate-spin text-violet-500"})});if(!o)return(0,t.jsx)("div",{className:"bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-[600px] flex items-center justify-center",children:(0,t.jsx)(Et,{title:"Account doesn't exist",message:`Try searching for another. The user @${e} could not be found.`,icon:Xa})});const ee=o,te=()=>v?(0,t.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,t.jsx)(oe,{className:"animate-spin text-violet-500",size:32})}):re.length>0?(0,t.jsxs)(t.Fragment,{children:[re.map(H=>(0,t.jsx)(pt,{currentUser:i,showToast:r,...H,onClick:()=>de(H.id),onUserClick:me,onDelete:V=>f(Q=>Q.filter(ae=>ae.id!==V))},H.feed_id||H.id)),(x==="replies"?F:w)&&(0,t.jsx)("div",{className:"p-6 flex justify-center",children:(0,t.jsxs)(Button,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>x==="replies"?ie(o.id,!0):se(o.id,!0),disabled:x==="replies"?_:N,children:[(x==="replies"?_:N)&&(0,t.jsx)(oe,{size:18,className:"animate-spin mr-2"}),"Load more ",x==="replies"?"replies":"posts"]})})]}):(0,t.jsxs)("div",{className:"p-20 text-center text-zinc-500 flex flex-col items-center gap-4 animate-in fade-in duration-500",children:[(0,t.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full mb-2 ring-1 ring-zinc-100 dark:ring-zinc-800",children:(0,t.jsx)(xs,{size:40,className:"text-zinc-300 dark:text-zinc-700"})}),(0,t.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"No posts yet"}),(0,t.jsxs)("p",{className:"text-sm text-zinc-500 dark:text-zinc-400 max-w-[250px]",children:["When @",ee.handle," shares posts, they will appear here."]})]});return(0,t.jsxs)("div",{className:"border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:[(0,t.jsxs)("div",{className:"border-y md:border-b-0 border-zinc-100 dark:border-zinc-800",children:[(0,t.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3 md:hidden",children:(0,t.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,t.jsx)("button",{onClick:()=>a(-1),className:"p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:(0,t.jsx)(Ye,{size:22})}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("h5",{className:"text-lg font-bold dark:text-white leading-none",children:ee.name}),(0,t.jsxs)("span",{className:"text-xs text-zinc-500 mt-0.5",children:[u.length," Posts"]})]})]})}),(0,t.jsx)(Ao,{profile:ee,currentUser:i,isCurrentUser:i?.handle===ee.handle,onEditProfile:s,showToast:r,onShowFollowers:()=>le("Followers"),onShowFollowing:()=>le("Following")}),(0,t.jsxs)(Bo,{value:x,onValueChange:g,className:"w-full",children:[(0,t.jsx)("div",{className:"sticky top-[60px] md:top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-10 border-b border-zinc-100 dark:border-zinc-800",children:(0,t.jsx)(Wo,{className:"w-full h-auto bg-transparent p-0 rounded-none justify-start px-2",children:["feed","replies","media"].map(H=>(0,t.jsx)(Ho,{value:H,className:"flex-1 py-4 text-sm font-bold capitalize rounded-none border-b-2 data-[state=active]:border-black dark:data-[state=active]:border-white data-[state=active]:text-black dark:data-[state=active]:text-white text-zinc-500 transition-all hover:bg-zinc-50 dark:hover:bg-zinc-900",children:H==="feed"?"Posts":H},H))})}),(0,t.jsx)(wt,{value:"feed",className:"m-0 border-none",children:te()}),(0,t.jsx)(wt,{value:"replies",className:"m-0 border-none",children:te()}),(0,t.jsx)(wt,{value:"media",className:"m-0 border-none",children:te()})]})]}),(0,t.jsx)(nt,{isOpen:M,onClose:()=>E(!1),title:B,className:"sm:max-w-md",children:(0,t.jsx)("div",{className:"min-h-[300px]",children:I?(0,t.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,t.jsx)(oe,{className:"animate-spin text-violet-500",size:32})}):L.length>0?(0,t.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800 -mx-6",children:[L.map(H=>(0,t.jsx)(Ws,{profile:H,onUserClick:V=>{E(!1),a(`/u/${V}`)}},H.id)),$&&(0,t.jsx)("div",{className:"p-4 flex justify-center",children:(0,t.jsxs)(Button,{variant:"secondary",className:"w-full text-xs",onClick:()=>le(B,!0),disabled:S,children:[S?(0,t.jsx)(oe,{size:14,className:"animate-spin mr-2"}):null,"Load more"]})})]}):(0,t.jsx)("div",{className:"flex flex-col items-center justify-center py-20 text-zinc-500",children:(0,t.jsxs)("p",{className:"font-medium",children:["No ",B.toLowerCase()," yet."]})})})})]})},Uo=Qo,Vo=()=>{const{handle:s}=ut(),e=je(),{currentUser:a}=fe(),{addToast:n}=Ce(),[i,l]=(0,b.useState)(null),[r,o]=(0,b.useState)(!0),[c,d]=(0,b.useState)(!1),[m,u]=(0,b.useState)(!1),[f,h]=(0,b.useState)([]),[p,x]=(0,b.useState)(!0),[g,v]=(0,b.useState)(!1),[j,N]=(0,b.useState)(!0),y=(0,b.useRef)(f);(0,b.useEffect)(()=>{y.current=f},[f]);const w=(0,b.useCallback)(async(_,C=!1)=>{if(_){C?v(!0):x(!0);try{const F=y.current,P=await vi(_,C&&F.length>0?F[F.length-1].sort_timestamp:null,10);P.length<10?N(!1):N(!0),h(C?T=>[...T,...P]:P)}catch(F){console.error("Failed to fetch community posts:",F)}finally{x(!1),v(!1)}}},[]);(0,b.useEffect)(()=>{(async()=>{o(!0);try{const C=await gi(s);l(C),C?.id&&(w(C.id),a&&d(await ji(C.id,a.id)))}catch{}finally{o(!1)}})()},[s,a,w]);const k=async()=>{if(!a)return n("Please login to join communities","error");u(!0);try{const _=await ys(i.id,a.id);d(_),l(C=>({...C,membersCount:_?C.membersCount+1:C.membersCount-1})),n(_?`Joined ${i.name}`:`Left ${i.name}`)}catch{n("Failed to update membership","error")}finally{u(!1)}};return r?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)(oe,{size:40,className:"animate-spin text-violet-500"})}):i?(0,t.jsx)("div",{className:"border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,t.jsx)("button",{onClick:()=>e(-1),className:"p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:(0,t.jsx)(Ye,{size:22})}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("h5",{className:"text-lg font-bold dark:text-white leading-none",children:i.name}),(0,t.jsxs)("span",{className:"text-xs text-zinc-500 mt-0.5",children:[i.membersCount," Members"]})]})]})}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"h-32 sm:h-48 bg-zinc-100 dark:bg-zinc-900 overflow-hidden",children:i.cover&&(0,t.jsx)("img",{src:i.cover,className:"w-full h-full object-cover",alt:""})}),(0,t.jsxs)("div",{className:"px-4 pb-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-end -mt-12 mb-4",children:[(0,t.jsx)("div",{className:"size-24 sm:size-32 rounded-2xl border-4 border-white dark:border-black bg-zinc-100 dark:bg-zinc-800 overflow-hidden shadow-sm",children:(0,t.jsx)("img",{src:i.avatar,className:"w-full h-full object-cover",alt:""})}),(0,t.jsx)(ue,{variant:c?"outline":"default",onClick:k,disabled:m,className:"rounded-full font-bold px-6",children:m?(0,t.jsx)(oe,{size:18,className:"animate-spin"}):c?"Joined":"Join"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl sm:text-2xl font-black dark:text-white",children:i.name}),(0,t.jsxs)("p",{className:"text-zinc-500 font-medium",children:["@",i.handle]}),i.description&&(0,t.jsx)("p",{className:"mt-3 text-[15px] dark:text-zinc-300 leading-relaxed",children:i.description}),(0,t.jsxs)("div",{className:"flex gap-4 mt-4 text-sm text-zinc-500 font-medium",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"text-black dark:text-white font-bold",children:i.membersCount})," Members"]}),(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"text-black dark:text-white font-bold",children:i.postsCount})," Posts"]})]})]})]})]}),(0,t.jsx)("div",{className:"border-t border-zinc-100 dark:border-zinc-800",children:p?(0,t.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,t.jsx)(oe,{className:"animate-spin text-violet-500",size:32})}):f.length>0?(0,t.jsxs)(t.Fragment,{children:[f.map(_=>(0,t.jsx)(pt,{currentUser:a,showToast:n,..._,onClick:()=>e(`/post/${_.id}`),onUserClick:C=>e(`/u/${C}`)},_.feed_id||_.id)),j&&(0,t.jsx)("div",{className:"p-6 flex justify-center",children:(0,t.jsxs)(ue,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>w(i.id,!0),disabled:g,children:[g&&(0,t.jsx)(oe,{size:18,className:"animate-spin mr-2"}),"Load more"]})})]}):(0,t.jsxs)("div",{className:"p-20 text-center text-zinc-500 flex flex-col items-center gap-4",children:[(0,t.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full mb-2",children:(0,t.jsx)(Ke,{size:40,className:"text-zinc-300"})}),(0,t.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"No posts here yet"}),(0,t.jsxs)("p",{className:"text-sm max-w-[250px]",children:["Be the first to share something in ",i.name,"!"]})]})})]})}):(0,t.jsx)("div",{className:"bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-[600px] flex items-center justify-center",children:(0,t.jsx)(Et,{title:"Community doesn't exist",message:`The community @${s} could not be found.`,icon:Ke})})},Ko=Vo,Jo=K(),Xo=()=>{const s=(0,Jo.c)(32),{id:e}=ut(),a=je(),{currentUser:n}=fe(),{addToast:i}=Ce();let l,r;s[0]!==e?(l=["post",e],r=async()=>{if(!ze(e))throw new Error("Invalid post ID");return Un(e)},s[0]=e,s[1]=l,s[2]=r):(l=s[1],r=s[2]);const o=!!e;let c;s[3]!==l||s[4]!==r||s[5]!==o?(c={queryKey:l,queryFn:r,enabled:o,retry:!1},s[3]=l,s[4]=r,s[5]=o,s[6]=c):c=s[6];const{data:d,isLoading:m,isError:u}=Oe(c);if(m){let k;return s[7]===Symbol.for("react.memo_cache_sentinel")?(k=(0,t.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:(0,t.jsx)(Lt,{})}),s[7]=k):k=s[7],k}if(u||!d){let k;return s[8]===Symbol.for("react.memo_cache_sentinel")?(k=(0,t.jsx)("div",{className:"bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-[600px] flex items-center justify-center",children:(0,t.jsx)(Et,{title:"Post not found",message:"The post you are looking for doesn't exist. It may have been deleted by the author.",icon:wa})}),s[8]=k):k=s[8],k}let f;s[9]!==a?(f=()=>a(-1),s[9]=a,s[10]=f):f=s[10];let h;s[11]===Symbol.for("react.memo_cache_sentinel")?(h=(0,t.jsx)(Ye,{size:20,strokeWidth:2.5}),s[11]=h):h=s[11];let p;s[12]!==f?(p=(0,t.jsx)("button",{onClick:f,className:"p-2 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:h}),s[12]=f,s[13]=p):p=s[13];let x;s[14]===Symbol.for("react.memo_cache_sentinel")?(x=(0,t.jsx)("h5",{className:"text-xl font-bold dark:text-white",children:"Post"}),s[14]=x):x=s[14];let g;s[15]!==p?(g=(0,t.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-x-4",children:[p,x]})}),s[15]=p,s[16]=g):g=s[16];let v;s[17]!==d.comments?(v=d.comments||[],s[17]=d.comments,s[18]=v):v=s[18];let j,N;s[19]!==a?(j=k=>a(`/u/${k}`),N=()=>a(-1),s[19]=a,s[20]=j,s[21]=N):(j=s[20],N=s[21]);let y;s[22]!==i||s[23]!==n||s[24]!==d||s[25]!==j||s[26]!==N||s[27]!==v?(y=(0,t.jsx)(pt,{...d,isDetail:!0,currentUser:n,initialComments:v,showToast:i,onUserClick:j,onDelete:N}),s[22]=i,s[23]=n,s[24]=d,s[25]=j,s[26]=N,s[27]=v,s[28]=y):y=s[28];let w;return s[29]!==y||s[30]!==g?(w=(0,t.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm mb-20 animate-in slide-in-from-right-5 duration-300",children:(0,t.jsxs)("div",{className:"border-b border-zinc-100 dark:border-zinc-800",children:[g,y]})}),s[29]=y,s[30]=g,s[31]=w):w=s[31],w},Yo=Xo,Go=K();function Zo(){const s=(0,Go.c)(50),e=mt(),{currentUser:a,authMode:n,setAuthMode:i}=fe(),{darkMode:l}=$t(),{isOpen:r,images:o,currentIndex:c,closeLightbox:d,setIndex:m}=Pt(),[u,f]=(0,b.useState)(!1),[h,p]=(0,b.useState)(!1),[x,g]=(0,b.useState)(!1);let v;s[0]===Symbol.for("react.memo_cache_sentinel")?(v={},s[0]=v):v=s[0];const[j,N]=(0,b.useState)(v),[y,w]=(0,b.useState)(null);if(n){const X=l?"dark":"";let se;s[1]!==i?(se=()=>i(null),s[1]=i,s[2]=se):se=s[2];let ie;s[3]!==n||s[4]!==i?(ie=()=>i(n==="login"?"signup":"login"),s[3]=n,s[4]=i,s[5]=ie):ie=s[5];let le;s[6]!==n||s[7]!==se||s[8]!==ie?(le=(0,t.jsx)("div",{className:"min-h-screen bg-white dark:bg-black flex items-center justify-center p-4",children:(0,t.jsx)(_e,{children:(0,t.jsx)(Yl,{type:n,onComplete:se,onSwitch:ie})})}),s[6]=n,s[7]=se,s[8]=ie,s[9]=le):le=s[9];let re;return s[10]!==X||s[11]!==le?(re=(0,t.jsx)("div",{className:X,children:le}),s[10]=X,s[11]=le,s[12]=re):re=s[12],re}let k;s[13]===Symbol.for("react.memo_cache_sentinel")?(k=(0,t.jsx)(Xi,{}),s[13]=k):k=s[13];let _;s[14]===Symbol.for("react.memo_cache_sentinel")?(_=(0,t.jsx)(bl,{onPostClick:()=>f(!0)}),s[14]=_):_=s[14];let C;s[15]===Symbol.for("react.memo_cache_sentinel")?(C=(0,t.jsx)(ye,{path:"/",element:(0,t.jsx)(_e,{children:(0,t.jsx)(Ar,{onStoryClick:w,onAddStory:()=>g(!0)})})}),s[15]=C):C=s[15];let F;s[16]===Symbol.for("react.memo_cache_sentinel")?(F=(0,t.jsx)(ye,{path:"/home",element:(0,t.jsx)(qt,{to:"/",replace:!0})}),s[16]=F):F=s[16];let P;s[17]===Symbol.for("react.memo_cache_sentinel")?(P=(0,t.jsx)(ye,{path:"/community",element:(0,t.jsx)(_e,{children:(0,t.jsx)(Ur,{})})}),s[17]=P):P=s[17];let T;s[18]===Symbol.for("react.memo_cache_sentinel")?(T=(0,t.jsx)(ye,{path:"/reels",element:(0,t.jsx)(_e,{children:(0,t.jsx)(Gr,{})})}),s[18]=T):T=s[18];let R;s[19]===Symbol.for("react.memo_cache_sentinel")?(R=(0,t.jsx)(ye,{path:"/messages",element:(0,t.jsx)(_e,{children:(0,t.jsx)(Gt,{})})}),s[19]=R):R=s[19];let M;s[20]===Symbol.for("react.memo_cache_sentinel")?(M=(0,t.jsx)(ye,{path:"/messages/:id",element:(0,t.jsx)(_e,{children:(0,t.jsx)(Gt,{})})}),s[20]=M):M=s[20];let E;s[21]===Symbol.for("react.memo_cache_sentinel")?(E=(0,t.jsx)(ye,{path:"/notifications",element:(0,t.jsx)(_e,{children:(0,t.jsx)(To,{})})}),s[21]=E):E=s[21];let B;s[22]===Symbol.for("react.memo_cache_sentinel")?(B=(0,t.jsx)(ye,{path:"/post/:id",element:(0,t.jsx)(_e,{children:(0,t.jsx)(Yo,{})})}),s[22]=B):B=s[22];let A;s[23]===Symbol.for("react.memo_cache_sentinel")?(A=(0,t.jsx)(ye,{path:"/c/:handle",element:(0,t.jsx)(_e,{children:(0,t.jsx)(Ko,{})})}),s[23]=A):A=s[23];let L;s[24]===Symbol.for("react.memo_cache_sentinel")?(L=(0,t.jsx)(ye,{path:"/u/:handle",element:(0,t.jsx)(_e,{children:(0,t.jsx)(Uo,{onEditProfile:X=>{N(X),p(!0)}})})}),s[24]=L):L=s[24];let z;s[25]===Symbol.for("react.memo_cache_sentinel")?(z=(0,t.jsxs)(ye,{element:_,children:[C,F,P,T,R,M,E,B,A,L,(0,t.jsx)(ye,{path:"*",element:(0,t.jsx)(qt,{to:"/community"})})]}),s[25]=z):z=s[25];let I;s[26]!==e?(I=(0,t.jsx)(ra,{location:e,children:z},e.pathname),s[26]=e,s[27]=I):I=s[27];let W;s[28]!==j||s[29]!==h||s[30]!==u||s[31]!==x?(W=(0,t.jsx)(Tl,{isPostModalOpen:u,setIsPostModalOpen:f,isEditProfileOpen:h,setIsEditProfileOpen:p,isStoryModalOpen:x,setIsStoryModalOpen:g,editProfileData:j,setEditProfileData:N}),s[28]=j,s[29]=h,s[30]=u,s[31]=x,s[32]=W):W=s[32];let S;s[33]!==y?(S=y&&(0,t.jsx)(Ol,{story:y,onClose:()=>w(null)}),s[33]=y,s[34]=S):S=s[34];let q;s[35]!==d||s[36]!==c||s[37]!==o||s[38]!==r||s[39]!==m?(q=r&&(0,t.jsx)(Ql,{images:o,currentIndex:c,onClose:d,onNavigate:m}),s[35]=d,s[36]=c,s[37]=o,s[38]=r,s[39]=m,s[40]=q):q=s[40];let $;s[41]!==a||s[42]!==e.pathname?($=a&&e.pathname==="/"&&(0,t.jsx)("button",{onClick:()=>f(!0),className:"fixed bottom-20 right-5 md:hidden z-50 bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 size-12 rounded-full flex items-center justify-center shadow-2xl hover:scale-110 active:scale-90 transition-all cursor-pointer group",title:"Create Post",children:(0,t.jsx)(De,{size:28,className:"group-hover:rotate-90 transition-transform duration-300"})}),s[41]=a,s[42]=e.pathname,s[43]=$):$=s[43];let J;return s[44]!==I||s[45]!==W||s[46]!==S||s[47]!==q||s[48]!==$?(J=(0,t.jsxs)(t.Fragment,{children:[k,I,W,S,q,$]}),s[44]=I,s[45]=W,s[46]=S,s[47]=q,s[48]=$,s[49]=J):J=s[49],J}var ec=new Sn;(0,Rn.createRoot)(document.getElementById("root")).render((0,t.jsx)(b.StrictMode,{children:(0,t.jsx)(hn,{client:ec,children:(0,t.jsx)(en,{children:(0,t.jsx)(Pi,{children:(0,t.jsx)(_i,{children:(0,t.jsx)(Si,{children:(0,t.jsx)(Ti,{children:(0,t.jsx)(Ii,{children:(0,t.jsx)(Ai,{children:(0,t.jsx)(Zo,{})})})})})})})})})}));
