import{a as g}from"./rolldown-runtime-BaZ8gS7u.js";import{l as w,w as N}from"./framework-PdDqecC3.js";import{Qn as k,Xn as S,er as _,wn as y}from"./ui-libs--SjcKxLB.js";import{An as A,Wt as z,fn as C,un as q,yt as d}from"./index-BBa71TRu.js";var t=g(N(),1),e=g(w(),1),L=({type:r,onComplete:u,onSwitch:b})=>{const{login:f,signup:p}=C(),{addToast:n}=q(),[a,i]=(0,t.useState)({name:"",email:"",username:"",password:""}),[v,m]=(0,t.useState)(!1),[h,x]=(0,t.useState)(null),[l,o]=(0,t.useState)({loading:!1,available:null});(0,t.useEffect)(()=>{if(r==="signup"&&a.username.length>=5){const s=setTimeout(async()=>{o({loading:!0,available:null});try{o({loading:!1,available:await A(a.username)})}catch{o({loading:!1,available:null})}},500);return()=>clearTimeout(s)}else o({loading:!1,available:null})},[a.username,r]);const j=async s=>{if(s.preventDefault(),r==="signup"&&(l.available===!1||a.username.length<5)){n(a.username.length<5?"Username must be at least 5 characters":"Please choose a different username","error");return}m(!0),x(null);try{r==="login"?(await f({email:a.email,password:a.password}),n("Welcome back!"),u()):(await p({email:a.email,password:a.password,username:a.username,name:a.name}),n("Account created successfully!"),u())}catch(c){console.error("Auth error:",c),x(c.message||"Authentication failed. Please check your credentials."),n("Authentication failed!","error")}finally{m(!1)}};return(0,e.jsxs)("div",{className:"mx-auto w-full max-w-md animate-in fade-in slide-in-from-bottom-5 duration-300 p-8 bg-card border border-border rounded-3xl shadow-xl",children:[(0,e.jsxs)("div",{className:"mb-8 text-center",children:[(0,e.jsx)("div",{className:"mb-4 flex justify-center",children:(0,e.jsx)("div",{className:"rounded-2xl bg-black p-3 shadow-lg text-white dark:bg-white dark:text-black",children:(0,e.jsx)("img",{src:"/logo.webp",alt:"Logo",className:"size-16 rounded-2xl shadow-xl"})})}),(0,e.jsx)("h2",{className:"mb-2 text-3xl font-extrabold tracking-tight dark:text-white",children:r==="login"?"Welcome back!":"Join MySys today"}),(0,e.jsx)("p",{className:"font-medium text-zinc-500",children:"The decentralized social network"})]}),h&&(0,e.jsxs)("div",{className:"mb-6 flex items-center gap-3 rounded-xl border border-rose-100 bg-rose-50 p-4 text-sm text-rose-600 dark:border-rose-800 dark:bg-rose-900/20 dark:text-rose-400",children:[(0,e.jsx)(_,{size:18}),(0,e.jsx)("span",{children:h})]}),(0,e.jsxs)("form",{onSubmit:j,className:"space-y-4",children:[(0,e.jsx)(d,{label:"Email",type:"email",placeholder:"john@example.com",value:a.email,onChange:s=>i({...a,email:s.target.value}),required:!0}),r==="signup"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(d,{label:"Name",placeholder:"John Doe",value:a.name,onChange:s=>i({...a,name:s.target.value}),required:!0}),(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)(d,{label:"Username",placeholder:"johndoe",value:a.username,onChange:s=>{const c=s.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"");i({...a,username:c})},required:!0}),(0,e.jsx)("div",{className:"absolute right-3 top-[38px]",children:l.loading?(0,e.jsx)(y,{size:18,className:"animate-spin text-zinc-400"}):l.available===!0?(0,e.jsx)(k,{size:18,className:"text-emerald-500"}):l.available===!1?(0,e.jsx)(S,{size:18,className:"text-rose-500"}):null})]})]}),(0,e.jsx)(d,{label:"Password",type:"password",placeholder:"••••••••",value:a.password,onChange:s=>i({...a,password:s.target.value}),required:!0}),(0,e.jsx)(z,{type:"submit",className:"mt-6 w-full justify-center py-3 text-lg",loading:v,disabled:r==="signup"&&(l.available===!1||a.username.length<5),children:r==="login"?"Log in":"Sign up"})]}),(0,e.jsxs)("div",{className:"mt-8 text-center text-sm",children:[(0,e.jsx)("span",{className:"text-zinc-500",children:r==="login"?"Don't have an account?":"Already have an account?"}),(0,e.jsx)("button",{onClick:b,className:"ml-1 font-bold hover:underline dark:text-white",children:r==="login"?"Sign up":"Log in"})]})]})},U=L;export{U as t};
