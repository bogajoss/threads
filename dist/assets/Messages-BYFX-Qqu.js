import{a as ee}from"./rolldown-runtime-BaZ8gS7u.js";import{T as re,s as te,u as ie,y as ae}from"./framework-DIDnLsp9.js";import"./database-DlIwwAmc.js";import{$n as le,Ft as V,Ht as W,Kn as ne,Kt as ce,Pt as de,Rn as oe,Rt as xe,Tn as me,X as he,Xt as ue,Y as Z,Yt as pe,en as fe,gn as be,mn as ge,qn as je,rn as G,sn as ve,tn as Q,un as ze,wn as Ne,xn as se}from"./ui-libs-x7JJBDE0.js";import{$ as F,A as ke,B as we,F as ye,I as Ce,J as Se,Jt as $,P as Me,Q as _,X as Ie,Y as J,Z as Te,_t as Pe,dt as $e,et as B,h as Ae,q as Re,ut as Ue}from"./index-Du4T0o99.js";import{n as Le,t as qe}from"./linkify-DBRQwEj8.js";import{a as Ee,u as Oe}from"./hooks-DMqzwblS.js";var Ye=te(),P=ee(re(),1),e=ee(ie(),1),Fe=s=>{const t=(0,Ye.c)(59),{conv:a,selectedId:A,onSelect:j,onlineUsers:d}=s;let k;t[0]!==a.user?.id||t[1]!==d?(k=d.has(a.user?.id),t[0]=a.user?.id,t[1]=d,t[2]=k):k=t[2];const v=k,u=A===a.id,i=a.unread>0;let I;t[3]!==a||t[4]!==j?(I=()=>j(a),t[3]=a,t[4]=j,t[5]=I):I=t[5];const w=u?"bg-violet-500/10 dark:bg-violet-500/20":"hover:bg-zinc-100 dark:hover:bg-zinc-800/50";let b;t[6]!==w?(b=$("group relative flex cursor-pointer items-center gap-4 p-3 mx-2 rounded-2xl transition-all duration-200",w),t[6]=w,t[7]=b):b=t[7];const U=u?"border-violet-500/30":"border-transparent group-hover:border-zinc-200 dark:group-hover:border-zinc-700";let z;t[8]!==U?(z=$("size-[52px] border-2 transition-all",U),t[8]=U,t[9]=z):z=t[9];const p=a.user?.avatar,S=a.user?.name;let y;t[10]!==p||t[11]!==S?(y=(0,e.jsx)(B,{src:p,alt:S,className:"object-cover"}),t[10]=p,t[11]=S,t[12]=y):y=t[12];let C;t[13]!==a.user?.name?.[0]?(C=a.user?.name?.[0]?.toUpperCase(),t[13]=a.user?.name?.[0],t[14]=C):C=t[14];let x;t[15]!==C?(x=(0,e.jsx)(F,{className:"bg-zinc-100 text-zinc-500 font-bold text-lg dark:bg-zinc-800 dark:text-zinc-400",children:C}),t[15]=C,t[16]=x):x=t[16];let g;t[17]!==x||t[18]!==z||t[19]!==y?(g=(0,e.jsxs)(_,{className:z,children:[y,x]}),t[17]=x,t[18]=z,t[19]=y,t[20]=g):g=t[20];let N;t[21]!==v?(N=v&&(0,e.jsx)("span",{className:"absolute bottom-0.5 right-0.5 size-3.5 rounded-full border-[2.5px] border-white bg-emerald-500 ring-0 dark:border-black"}),t[21]=v,t[22]=N):N=t[22];let o;t[23]!==g||t[24]!==N?(o=(0,e.jsxs)("div",{className:"relative",children:[g,N]}),t[23]=g,t[24]=N,t[25]=o):o=t[25];const m=i?"text-zinc-900 dark:text-white":"text-zinc-700 dark:text-zinc-200";let f;t[26]!==m?(f=$("truncate text-[15px] font-semibold",m),t[26]=m,t[27]=f):f=t[27];const T=a.user?.name;let c;t[28]!==f||t[29]!==T?(c=(0,e.jsx)("span",{className:f,children:T}),t[28]=f,t[29]=T,t[30]=c):c=t[30];const M=i?"text-violet-600 dark:text-violet-400":"text-zinc-400";let L;t[31]!==M?(L=$("ml-2 whitespace-nowrap text-[11px] font-medium",M),t[31]=M,t[32]=L):L=t[32];let q;t[33]!==a.time||t[34]!==L?(q=(0,e.jsx)("span",{className:L,children:a.time}),t[33]=a.time,t[34]=L,t[35]=q):q=t[35];let E;t[36]!==c||t[37]!==q?(E=(0,e.jsxs)("div",{className:"flex items-center justify-between mb-0.5",children:[c,q]}),t[36]=c,t[37]=q,t[38]=E):E=t[38];const D=i?"font-semibold text-zinc-900 dark:text-zinc-100":"text-zinc-500 dark:text-zinc-400 group-hover:text-zinc-600 dark:group-hover:text-zinc-300";let O;t[39]!==D?(O=$("truncate text-[13px] leading-relaxed",D),t[39]=D,t[40]=O):O=t[40];const K=a.currentUserSent?"You: ":"";let Y;t[41]!==a.lastMessage||t[42]!==O||t[43]!==K?(Y=(0,e.jsxs)("p",{className:O,children:[K,a.lastMessage]}),t[41]=a.lastMessage,t[42]=O,t[43]=K,t[44]=Y):Y=t[44];let r;t[45]!==a.unread||t[46]!==i?(r=i&&(0,e.jsx)("span",{className:"flex size-5 shrink-0 items-center justify-center rounded-full bg-violet-600 text-[10px] font-bold text-white shadow-sm shadow-violet-500/30",children:a.unread}),t[45]=a.unread,t[46]=i,t[47]=r):r=t[47];let l;t[48]!==Y||t[49]!==r?(l=(0,e.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[Y,r]}),t[48]=Y,t[49]=r,t[50]=l):l=t[50];let n;t[51]!==E||t[52]!==l?(n=(0,e.jsxs)("div",{className:"min-w-0 flex-1 py-1",children:[E,l]}),t[51]=E,t[52]=l,t[53]=n):n=t[53];let h;return t[54]!==o||t[55]!==I||t[56]!==n||t[57]!==b?(h=(0,e.jsxs)("div",{onClick:I,className:b,children:[o,n]}),t[54]=o,t[55]=I,t[56]=n,t[57]=b,t[58]=h):h=t[58],h},_e=({conversations:s,userResults:t=[],onSelect:a,onStartNew:A,selectedId:j,searchQuery:d,onSearchChange:k,onlineUsers:v=new Set})=>{const u=s.filter(i=>v.has(i.user?.id));return(0,e.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col bg-white dark:bg-black h-full",children:[(0,e.jsxs)("div",{className:"px-5 pt-5 pb-2",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between mb-5",children:[(0,e.jsx)("h2",{className:"text-2xl font-black tracking-tight text-zinc-900 dark:text-white",children:"Chats"}),(0,e.jsx)("button",{className:"rounded-full bg-zinc-100 p-2.5 text-zinc-600 transition-colors hover:bg-zinc-200 dark:bg-zinc-900 dark:text-zinc-400 dark:hover:bg-zinc-800",children:(0,e.jsx)(pe,{size:20})})]}),(0,e.jsxs)("div",{className:"relative group",children:[(0,e.jsx)(Q,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-zinc-400 group-focus-within:text-violet-500 transition-colors",size:18}),(0,e.jsx)("input",{type:"text",value:d,onChange:i=>k(i.target.value),placeholder:"Search Messenger",className:"w-full rounded-full border-none bg-zinc-100 py-2.5 pl-10 pr-4 text-sm font-medium text-zinc-900 placeholder:text-zinc-500 transition-all focus:bg-white focus:ring-2 focus:ring-violet-500/20 focus:shadow-sm dark:bg-zinc-900 dark:text-white dark:focus:bg-black"})]})]}),(0,e.jsx)(ke,{className:"flex-1",children:(0,e.jsxs)("div",{className:"flex flex-col pb-4",children:[!d&&u.length>0&&(0,e.jsx)("div",{className:"mb-4 mt-2",children:(0,e.jsxs)("div",{className:"flex gap-4 overflow-x-auto px-5 pb-4 pt-2 no-scrollbar",children:[(0,e.jsxs)("div",{className:"flex flex-col items-center gap-2 min-w-[64px] cursor-pointer group",children:[(0,e.jsxs)("div",{className:"relative flex size-[60px] items-center justify-center rounded-full bg-zinc-50 border border-zinc-200 dark:bg-zinc-900 dark:border-zinc-800 group-hover:bg-zinc-100 dark:group-hover:bg-zinc-800 transition-colors",children:[(0,e.jsx)(W,{size:24,className:"text-zinc-400"}),(0,e.jsx)("div",{className:"absolute bottom-0 right-0 size-5 bg-white dark:bg-black rounded-full flex items-center justify-center",children:(0,e.jsx)("div",{className:"size-4 bg-zinc-200 dark:bg-zinc-700 rounded-full flex items-center justify-center",children:(0,e.jsx)("span",{className:"text-[10px] text-zinc-500 font-bold",children:"+"})})})]}),(0,e.jsx)("span",{className:"text-[11px] font-medium text-zinc-500",children:"Your Story"})]}),u.map(i=>(0,e.jsxs)("div",{onClick:()=>a(i),className:"flex flex-col items-center gap-2 cursor-pointer group min-w-[64px] transition-transform active:scale-95",children:[(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("div",{className:"absolute -inset-[3px] rounded-full bg-gradient-to-tr from-violet-500 via-fuchsia-500 to-orange-500 opacity-90 p-[2px]"}),(0,e.jsx)("div",{className:"relative rounded-full border-[3px] border-white dark:border-black p-[2px] bg-white dark:bg-black",children:(0,e.jsxs)(_,{className:"size-[50px]",children:[(0,e.jsx)(B,{src:i.user?.avatar,className:"object-cover"}),(0,e.jsx)(F,{children:i.user?.name?.[0]})]})}),(0,e.jsx)("span",{className:"absolute bottom-1 right-1 size-3.5 rounded-full border-[2.5px] border-white bg-emerald-500 dark:border-black"})]}),(0,e.jsx)("span",{className:"w-full truncate text-center text-[11px] font-medium text-zinc-600 dark:text-zinc-400 group-hover:text-zinc-900 dark:group-hover:text-white transition-colors",children:i.user?.name.split(" ")[0]})]},i.id))]})}),(0,e.jsx)("div",{className:"px-2 space-y-1",children:s.length>0&&s.filter(i=>i.lastMessage!=="No messages yet"||i.id===j||d).map(i=>(0,e.jsx)(Fe,{conv:i,selectedId:j,onSelect:a,onlineUsers:v},i.id))}),t.length>0&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"px-6 py-3 mt-2 text-xs font-bold uppercase tracking-wider text-zinc-400",children:"More People"}),(0,e.jsx)("div",{className:"px-2 space-y-1",children:t.map(i=>(0,e.jsxs)("div",{onClick:()=>A(i),className:"flex cursor-pointer items-center gap-4 px-3 py-2 rounded-2xl transition-colors hover:bg-zinc-100 dark:hover:bg-zinc-800/50",children:[(0,e.jsxs)(_,{className:"size-10",children:[(0,e.jsx)(B,{src:i.avatar,className:"object-cover"}),(0,e.jsx)(F,{children:i.name?.[0]?.toUpperCase()})]}),(0,e.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,e.jsx)("div",{className:"truncate text-sm font-bold text-zinc-900 dark:text-white",children:i.name}),(0,e.jsxs)("div",{className:"truncate text-xs text-zinc-500",children:["@",i.handle]})]}),(0,e.jsx)("button",{className:"flex size-8 items-center justify-center rounded-full bg-violet-50 text-violet-600 dark:bg-violet-900/20 dark:text-violet-400",children:(0,e.jsx)(W,{size:16})})]},i.id))})]}),s.length===0&&t.length===0&&d&&(0,e.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center px-6",children:[(0,e.jsx)("div",{className:"mb-4 rounded-full bg-zinc-100 p-4 dark:bg-zinc-900",children:(0,e.jsx)(Q,{className:"text-zinc-400",size:24})}),(0,e.jsxs)("p",{className:"text-zinc-500",children:['No results found for "',d,'"']})]})]})})]})},Be=_e,De=({conversation:s,messages:t,onBack:a,onSendMessage:A,onDeleteMessage:j,onTyping:d,isLoading:k,isTyping:v,isOnline:u})=>{const i=ae(),{openLightbox:I}=$e(),[w,b]=(0,P.useState)(""),[U,z]=(0,P.useState)(!1),[p,S]=(0,P.useState)([]),[y,C]=(0,P.useState)(!1),[x,g]=(0,P.useState)(null),N=(0,P.useRef)(null),o=(0,P.useRef)(null),m=(0,P.useRef)(null),f=Oe(s.user?.lastSeen);(0,P.useEffect)(()=>{o.current&&(o.current.scrollTop=o.current.scrollHeight)},[t,v,p,x]);const T=r=>{const l=r.target.value;b(l),r.target.style.height="auto",r.target.style.height=`${Math.min(r.target.scrollHeight,120)}px`,d&&(d(!0),m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{d(!1)},2e3))},c=r=>{b(l=>l+r.emoji)},M=r=>{if(r&&r.preventDefault(),!w.trim()&&p.length===0)return;d&&(m.current&&clearTimeout(m.current),d(!1)),A(s.id,w,p.length>0?"image":"text",p,x?.id),b(""),S([]),g(null);const l=document.querySelector('textarea[name="chat-input"]');l&&(l.style.height="auto")},L=async r=>{if(!r.target.files)return;const l=Array.from(r.target.files);if(l.length!==0){z(!0);try{const n=await Promise.all(l.map(h=>Pe(h)));S(h=>[...h,...n])}catch(n){console.error("Upload failed:",n)}finally{z(!1)}}},q=r=>{S(l=>l.filter(n=>n.url!==r))},E=r=>{!r.media||r.media.length===0||I(r.media.map(l=>l.url),0)},D=(0,P.useMemo)(()=>{const r=t.filter(l=>l.sender==="me");return r.length>0?r[r.length-1].id:null},[t]),O=r=>t.find(l=>l.id===r),K=(r,l)=>r===0?!1:t[r-1].sender===l.sender,Y=(r,l)=>r===t.length-1?!1:t[r+1].sender===l.sender;return(0,e.jsxs)("div",{className:"relative flex h-full w-full flex-col overflow-hidden bg-white/50 dark:bg-black/50 md:border-l md:border-zinc-200/50 dark:md:border-zinc-800/50",children:[(0,e.jsxs)("div",{className:"sticky top-0 z-30 flex shrink-0 items-center justify-between border-b border-zinc-100 bg-white/75 px-4 py-3 backdrop-blur-xl dark:border-zinc-800 dark:bg-black/75",children:[(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsx)("button",{onClick:a,className:"mr-1 -ml-2 rounded-full p-2 text-zinc-600 transition-colors hover:bg-zinc-100 dark:text-zinc-300 dark:hover:bg-zinc-800 md:hidden",children:(0,e.jsx)(le,{size:24})}),(0,e.jsxs)("div",{className:"relative cursor-pointer",onClick:()=>i(`/u/${s.user.handle}`),children:[(0,e.jsxs)(_,{className:"size-10 border-2 border-white shadow-sm dark:border-zinc-800",children:[(0,e.jsx)(B,{src:s.user.avatar,alt:s.user.name,className:"object-cover"}),(0,e.jsx)(F,{children:s.user.name?.[0]?.toUpperCase()})]}),u&&(0,e.jsx)("span",{className:"absolute bottom-0 right-0 size-3 rounded-full border-2 border-white bg-emerald-500 dark:border-black"})]}),(0,e.jsxs)("div",{className:"flex flex-col cursor-pointer",onClick:()=>i(`/u/${s.user.handle}`),children:[(0,e.jsx)("h3",{className:"text-sm font-bold text-zinc-900 dark:text-white",children:s.user.name}),(0,e.jsx)("span",{className:"text-[11px] font-medium text-zinc-500",children:u?(0,e.jsx)("span",{className:"text-emerald-500",children:"Active now"}):s.user.lastSeen?`Last seen ${f}`:"Offline"})]})]}),(0,e.jsxs)("div",{className:"flex items-center gap-1",children:[(0,e.jsx)("button",{className:"hidden sm:flex rounded-full p-2.5 text-violet-500 hover:bg-violet-50 dark:hover:bg-violet-900/20 transition-colors",children:(0,e.jsx)(ve,{size:20})}),(0,e.jsx)("button",{className:"hidden sm:flex rounded-full p-2.5 text-violet-500 hover:bg-violet-50 dark:hover:bg-violet-900/20 transition-colors",children:(0,e.jsx)(xe,{size:20})}),(0,e.jsx)("button",{className:"rounded-full p-2.5 text-zinc-400 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors",children:(0,e.jsx)(Ne,{size:20})})]})]}),(0,e.jsx)("div",{className:"flex-1 min-h-0 overflow-y-auto px-4 py-4",ref:o,children:(0,e.jsxs)("div",{className:"flex flex-col min-h-full justify-end",children:[t.length<5&&(0,e.jsxs)("div",{className:"py-12 flex flex-col items-center justify-center opacity-80 mb-auto",children:[(0,e.jsxs)(_,{className:"size-24 border-4 border-zinc-100 dark:border-zinc-800 mb-4 bg-zinc-50 dark:bg-zinc-900",children:[(0,e.jsx)(B,{src:s.user.avatar,className:"object-cover"}),(0,e.jsx)(F,{className:"text-4xl",children:s.user.name?.[0]})]}),(0,e.jsx)("h2",{className:"text-xl font-bold dark:text-white",children:s.user.name}),(0,e.jsx)("p",{className:"text-zinc-500 text-sm mb-4",children:"You're friends on AntiGravity"}),(0,e.jsx)(Ue,{variant:"outline",className:"rounded-full h-8 text-xs",children:"View Profile"})]}),k&&t.length===0?(0,e.jsx)("div",{className:"flex justify-center p-8",children:(0,e.jsx)(se,{className:"animate-spin text-violet-500",size:32})}):(0,e.jsx)("div",{className:"space-y-[2px]",children:t.map((r,l)=>{const n=r.sender==="me",h=K(l,r),R=Y(l,r);return(0,e.jsx)(Z.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},className:$("flex w-full",n?"justify-end":"justify-start",!R&&"mb-4"),children:(0,e.jsxs)("div",{className:$("flex max-w-[75%] md:max-w-[65%] items-end gap-2 group",n?"flex-row-reverse":"flex-row"),children:[!n&&(0,e.jsx)("div",{className:"w-7 shrink-0",children:R?null:(0,e.jsxs)(_,{className:"size-7 border border-zinc-100 shadow-sm dark:border-zinc-800",children:[(0,e.jsx)(B,{src:s.user.avatar}),(0,e.jsx)(F,{children:s.user.name?.[0]})]})}),(0,e.jsxs)(Re,{children:[(0,e.jsx)(Te,{children:(0,e.jsxs)("div",{className:$("relative px-4 py-2.5 shadow-sm text-[15px] leading-[1.4]",n?"bg-gradient-to-br from-violet-600 to-indigo-600 text-white":"bg-white text-zinc-900 dark:bg-zinc-800 dark:text-white border border-zinc-200/50 dark:border-zinc-700/50",!R&&!h&&"rounded-[22px]",n&&!R&&h&&"rounded-[22px] rounded-tr-md",n&&R&&!h&&"rounded-[22px] rounded-br-md",n&&R&&h&&"rounded-[22px] rounded-r-md",!n&&!R&&h&&"rounded-[22px] rounded-tl-md",!n&&R&&!h&&"rounded-[22px] rounded-bl-md",!n&&R&&h&&"rounded-[22px] rounded-l-md"),children:[r.replyToId&&(0,e.jsxs)("div",{className:$("mb-1.5 -mx-1 px-3 py-1.5 rounded-xl text-xs border-l-2 cursor-pointer",n?"bg-black/10 border-white/40 text-white/90":"bg-zinc-100 border-zinc-300 text-zinc-600 dark:bg-zinc-700 dark:border-zinc-500 dark:text-zinc-300"),onClick:H=>{H.stopPropagation();const X=document.getElementById(`msg-${r.replyToId}`);X&&X.scrollIntoView({behavior:"smooth",block:"center"})},children:[(0,e.jsxs)("div",{className:"flex items-center gap-1.5 mb-0.5 opacity-75",children:[(0,e.jsx)(G,{size:10}),(0,e.jsx)("span",{className:"font-bold",children:"Reply"})]}),(0,e.jsx)("div",{className:"truncate opacity-90",children:O(r.replyToId)?.text||"Attachment"})]}),r.media?.length>0&&(0,e.jsx)("div",{className:"grid gap-1 mb-1 overflow-hidden rounded-lg",children:r.media.map((H,X)=>(0,e.jsx)("img",{src:H.url,className:"max-h-64 object-cover w-full rounded-md cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>E(r)},X))}),(0,e.jsx)("div",{className:"whitespace-pre-wrap break-words",children:(0,e.jsx)(Le,{options:{...qe,className:n?"text-white underline":"text-violet-600 dark:text-violet-400 underline"},children:r.text})}),(0,e.jsxs)("div",{className:$("flex justify-end items-center gap-1 mt-0.5 select-none",n?"text-white/70":"text-zinc-400"),children:[(0,e.jsx)("span",{className:"text-[9px] font-medium",children:r.time}),n&&r.id===D&&(r.isRead?(0,e.jsx)(je,{size:12,className:"text-white"}):(0,e.jsx)(ne,{size:12,className:"text-white/60"}))]})]})}),(0,e.jsxs)(Se,{className:"w-48",children:[(0,e.jsxs)(J,{onClick:()=>{navigator.clipboard.writeText(r.text)},children:[(0,e.jsx)(oe,{size:14,className:"mr-2"})," Copy"]}),(0,e.jsxs)(J,{onClick:()=>g(r),children:[(0,e.jsx)(G,{size:14,className:"mr-2"})," Reply"]}),(0,e.jsx)(Ie,{}),(0,e.jsxs)(J,{className:"text-red-500",onClick:()=>j&&j(r.id),children:[(0,e.jsx)(ce,{size:14,className:"mr-2"})," Delete"]})]})]})]})},r.id)})}),v&&(0,e.jsx)("div",{className:"flex items-center gap-2 mt-2 ml-9",children:(0,e.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-800 px-4 py-2.5 rounded-[22px] rounded-tl-md",children:(0,e.jsx)(Ae,{})})})]})}),(0,e.jsxs)("div",{className:"shrink-0 p-3 md:p-4 bg-white dark:bg-black border-t border-zinc-100 dark:border-zinc-800",children:[(0,e.jsx)(he,{children:x&&(0,e.jsxs)(Z.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"flex items-center justify-between mb-2 px-4 py-2 bg-zinc-50 dark:bg-zinc-900 rounded-xl border border-zinc-100 dark:border-zinc-800",children:[(0,e.jsxs)("div",{className:"text-sm",children:[(0,e.jsxs)("span",{className:"text-xs font-bold text-violet-500 block mb-0.5",children:["Replying to ",x.sender==="me"?"yourself":s.user.name]}),(0,e.jsx)("p",{className:"line-clamp-1 text-zinc-500",children:x.text})]}),(0,e.jsx)("button",{onClick:()=>g(null),children:(0,e.jsx)(V,{size:16,className:"text-zinc-400"})})]})}),p.length>0&&(0,e.jsx)("div",{className:"flex gap-2 mb-2 px-1",children:p.map(r=>(0,e.jsxs)("div",{className:"relative size-16 rounded-lg overflow-hidden border border-zinc-200",children:[(0,e.jsx)("img",{src:r.url,className:"size-full object-cover"}),(0,e.jsx)("button",{onClick:()=>q(r.url),className:"absolute top-0 right-0 bg-black/50 text-white p-0.5",children:(0,e.jsx)(V,{size:12})})]},r.url))}),(0,e.jsxs)("div",{className:"flex items-end gap-2",children:[(0,e.jsxs)("div",{className:"flex items-center gap-1 mb-1",children:[(0,e.jsx)("button",{className:"p-2 text-zinc-400 hover:text-violet-600 transition-colors rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800",onClick:()=>N.current?.click(),children:(0,e.jsx)(me,{size:24})}),(0,e.jsx)("button",{className:"hidden sm:block p-2 text-zinc-400 hover:text-violet-600 transition-colors rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800",children:(0,e.jsx)(ze,{size:22})})]}),(0,e.jsxs)("form",{className:"flex-1 flex items-center gap-2 bg-zinc-100 dark:bg-zinc-900 rounded-[24px] px-2 py-1.5 transition-all focus-within:ring-2 focus-within:ring-violet-500/20 focus-within:bg-white dark:focus-within:bg-zinc-900 overflow-hidden border border-transparent focus-within:border-violet-200 dark:focus-within:border-violet-900",onSubmit:M,children:[(0,e.jsxs)(Me,{open:y,onOpenChange:C,children:[(0,e.jsx)(Ce,{asChild:!0,children:(0,e.jsx)("button",{type:"button",className:"p-2 text-zinc-400 hover:text-yellow-500 transition-colors",children:(0,e.jsx)(ue,{size:24})})}),(0,e.jsx)(ye,{className:"w-full p-0 border-none bg-transparent shadow-none",side:"top",align:"start",children:(0,e.jsx)(we,{onEmojiSelect:c})})]}),(0,e.jsx)("textarea",{name:"chat-input",value:w,onChange:T,onKeyDown:r=>{r.key==="Enter"&&!r.shiftKey&&(r.preventDefault(),M())},placeholder:"Message...",className:"flex-1 bg-transparent border-none outline-none text-[15px] resize-none max-h-32 py-2.5 min-h-[40px] text-zinc-900 dark:text-white placeholder:text-zinc-500",rows:1}),w.trim()||p.length>0?(0,e.jsx)("button",{type:"submit",className:"p-2 mr-1 rounded-full bg-violet-600 text-white hover:bg-violet-700 hover:scale-105 transition-all shadow-sm",children:(0,e.jsx)(fe,{size:18,className:"translate-x-0.5 translate-y-0.5"})}):(0,e.jsx)("button",{type:"button",className:"p-2 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200",children:(0,e.jsx)(ge,{size:22})})]}),(0,e.jsx)("input",{type:"file",ref:N,onChange:L,className:"hidden",multiple:!0,accept:"image/*"})]})]})]})},Ke=De,Xe=te(),He=()=>{const s=(0,Xe.c)(28),{id:t,currentUser:a,onlineUsers:A,msgSearchQuery:j,setMsgSearchQuery:d,userSearchResults:k,filteredConversations:v,selectedConversation:u,localMessages:i,isConvLoading:I,isMsgLoading:w,currentIsTyping:b,otherUserIsOnline:U,handleStartConversation:z,handleSelectConversation:p,sendMessage:S,sendTypingStatus:y,navigate:C}=Ee();if(!a){let c;s[0]===Symbol.for("react.memo_cache_sentinel")?(c=(0,e.jsx)("div",{className:"rounded-3xl bg-zinc-50 p-6 dark:bg-zinc-900",children:(0,e.jsx)(de,{size:48,className:"text-zinc-300 dark:text-zinc-600"})}),s[0]=c):c=s[0];let M;return s[1]===Symbol.for("react.memo_cache_sentinel")?(M=(0,e.jsxs)("div",{className:"flex h-screen flex-col items-center justify-center gap-6 border-zinc-100 bg-white p-8 text-center dark:border-zinc-800 dark:bg-black md:rounded-2xl md:border",children:[c,(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)("h3",{className:"text-2xl font-black tracking-tight dark:text-white",children:"Sign in to message"}),(0,e.jsx)("p",{className:"max-w-xs text-zinc-500 font-medium",children:"Join the conversation. Sign up or log in to start chatting."})]})]}),s[1]=M):M=s[1],M}if(I){let c;return s[2]===Symbol.for("react.memo_cache_sentinel")?(c=(0,e.jsx)("div",{className:"flex h-screen items-center justify-center border-zinc-100 bg-white dark:border-zinc-800 dark:bg-black md:rounded-2xl md:border",children:(0,e.jsx)(se,{className:"animate-spin text-violet-500",size:32})}),s[2]=c):c=s[2],c}const x=`flex ${t?"h-[100dvh]":"h-[calc(100dvh-4rem)]"} overflow-hidden bg-white shadow-2xl shadow-zinc-200/50 dark:border-zinc-800 dark:bg-black dark:shadow-none md:h-[calc(100vh-1.5rem)] md:rounded-3xl md:border md:border-zinc-200/50`,g=`flex-col md:flex md:w-[400px] ${u?"hidden":"flex"} h-full min-h-0 shrink-0 w-full bg-white dark:bg-black border-r border-zinc-100 dark:border-zinc-800 z-10`,N=t??null;let o;s[3]!==v||s[4]!==p||s[5]!==z||s[6]!==j||s[7]!==A||s[8]!==d||s[9]!==N||s[10]!==k?(o=(0,e.jsx)("div",{className:"flex-1 min-h-0 flex flex-col overflow-y-auto",children:(0,e.jsx)(Be,{conversations:v,userResults:k,onSelect:p,onStartNew:z,selectedId:N,searchQuery:j,onSearchChange:d,onlineUsers:A})}),s[3]=v,s[4]=p,s[5]=z,s[6]=j,s[7]=A,s[8]=d,s[9]=N,s[10]=k,s[11]=o):o=s[11];let m;s[12]!==g||s[13]!==o?(m=(0,e.jsx)("div",{className:g,children:o}),s[12]=g,s[13]=o,s[14]=m):m=s[14];let f;s[15]!==b||s[16]!==w||s[17]!==i||s[18]!==C||s[19]!==U||s[20]!==u||s[21]!==S||s[22]!==y?(f=u?(0,e.jsx)(Ke,{conversation:u,messages:i,onBack:()=>C("/messages"),onSendMessage:S,onTyping:c=>y(u.id,c),isLoading:w,isTyping:!!b,isOnline:!!U}):(0,e.jsxs)("div",{className:"hidden flex-1 flex-col items-center justify-center gap-6 text-zinc-500 md:flex bg-zinc-50/30 dark:bg-zinc-900/10",children:[(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("div",{className:"absolute -inset-10 rounded-full bg-violet-500/5 blur-3xl dark:bg-violet-500/10"}),(0,e.jsx)("div",{className:"relative rounded-[2.5rem] bg-white p-10 shadow-xl shadow-zinc-200/50 dark:bg-zinc-900/50 dark:shadow-none ring-1 ring-zinc-100 dark:ring-zinc-800",children:(0,e.jsx)(be,{size:80,className:"text-violet-500 stroke-[1.5]"})})]}),(0,e.jsxs)("div",{className:"text-center max-w-sm px-4 space-y-3",children:[(0,e.jsx)("h3",{className:"text-3xl font-black tracking-tighter text-zinc-900 dark:text-white",children:"Your Messages"}),(0,e.jsx)("p",{className:"text-zinc-500 font-medium text-lg",children:"Send private photos and messages to a friend or group."})]})]}),s[15]=b,s[16]=w,s[17]=i,s[18]=C,s[19]=U,s[20]=u,s[21]=S,s[22]=y,s[23]=f):f=s[23];let T;return s[24]!==x||s[25]!==m||s[26]!==f?(T=(0,e.jsxs)("div",{className:x,children:[m,f]}),s[24]=x,s[25]=m,s[26]=f,s[27]=T):T=s[27],T},tt=He;export{tt as default};
