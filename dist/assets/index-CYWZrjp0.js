import{n as js}from"./rolldown-runtime-2JzG8er9.js";import{$ as Da,$n as Oa,$t as ws,A as qa,An as Wa,Ar as Ua,At as Ba,B as ys,Bn as zs,Bt as Va,Cn as Ja,Ct as Qa,D as Ha,Dn as ct,Dr as Wt,Dt as Ka,En as Ut,Er as Ya,Et as Xa,F as Za,Fn as Rt,Fr as ut,Ft as Ga,G as ei,Gn as Ns,Gt as ks,H as _s,Hn as Xe,Ht as et,I as ti,In as si,Ir as ai,It as ii,J as ni,Jn as ss,Jt as It,K as ri,Kn as li,Kt as oi,L as Cs,Ln as Ss,Lr as ci,Lt as di,M as qd,Mn as mi,Mr as ui,Mt as fi,N as xi,Nn as Ps,Nr as ft,Nt as hi,O as pi,On as wt,Or as $s,Ot as bi,P as As,Pn as gi,Pr as je,Pt as vi,Q as ji,Qn as tt,Qt as wi,R as yi,Rn as zi,Rt as Ms,Sn as Fs,St as Ni,Tn as Es,Tt as ki,U as Rs,Un as Is,Ut as Lt,V as Ls,Vn as _i,Vt as Ci,W as Si,Wn as Ts,Wt as Pi,X as $i,Xn as Ai,Xt as Ds,Y as Mi,Yn as _t,Yt as Os,Z as Fi,Zn as At,Zt as qs,_n as Ei,_t as Ri,an as Ii,ar as Ct,at as Li,b as Ti,bn as Di,bt as Oi,cn as qi,ct as Wi,d as Ui,dn as Ws,dt as Bi,en as Vi,er as Mt,et as Ji,fn as Qi,ft as Hi,gn as yt,gt as Ki,hn as Yi,ht as Xi,in as Zi,ir as Gi,it as Ye,j as Us,jn as zt,jr as ke,jt as en,k as tn,kn as Nt,kr as as,kt as sn,l as an,ln as St,lt as nn,mn as Bs,mt as rn,n as xt,nn as ln,nr as Vs,nt as on,o as Js,on as Ft,or as cn,ot as dn,pn as mn,pt as un,q as fn,qn as xn,qt as hn,rn as Bt,rr as Ee,rt as pn,s as bn,sn as We,st as gn,t as vn,tn as Qs,tr as Q,tt as jn,u as wn,un as yn,ut as zn,vn as Pt,vt as Nn,wn as Tt,wt as kn,x as _n,xn as ce,xt as Cn,y as is,yn as Sn,yt as Pn,z as $n,zn as Hs,zt as $e}from"./framework-DJsIZbk5.js";import{t as An}from"./query-b3nIRdL9.js";import{t as Mn}from"./database-DCcU4ujN.js";import{a as Fn,c as En,i as Rn,n as In,o as Ln,r as Tn,s as Dn,t as On}from"./vendor-CkwRcpqI.js";/* empty css                 */(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function a(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=a(n);fetch(n.href,r)}})();var qn=ai(),g=js(ci(),1),Wn="https://dbkcedktqhueqnulnosq.supabase.co",Un="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRia2NlZGt0cWh1ZXFudWxub3NxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg5NzE1NTQsImV4cCI6MjA4NDU0NzU1NH0.m_Tv-H7o5mL1Nac6TH-S1JkS1x7ZN1AK_4Mt1hZlkvU";const q=Mn(Wn,Un);var Bn=Q();function le(...s){return Dn(En(s))}const Vn=()=>{const s=(0,Bn.c)(2),{pathname:e}=ft();let a;return s[0]!==e?(a=[e],s[0]=e,s[1]=a):a=s[1],(0,g.useEffect)(Hn,a),null},Pe=s=>typeof s!="string"?!1:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(s),Jn=(s,e)=>{const a=document.createElement("canvas"),i=s.naturalWidth/s.width,n=s.naturalHeight/s.height;a.width=e.width*i,a.height=e.height*n;const r=a.getContext("2d");return r.imageSmoothingEnabled=!0,r.imageSmoothingQuality="high",r.drawImage(s,e.x*i,e.y*n,e.width*i,e.height*n,0,0,e.width*i,e.height*n),new Promise((l,o)=>{a.toBlob(c=>{if(!c){o(new Error("Canvas is empty"));return}l(c)},"image/jpeg",.95)})},nt=s=>{if(!s)return"";const e=new Date-new Date(s),a=Math.floor(e/1e3),i=Math.floor(a/60),n=Math.floor(i/60),r=Math.floor(n/24);return a<60?"Just now":i<60?`${i}m ago`:n<24?`${n}h ago`:r<7?`${r}d ago`:new Date(s).toLocaleDateString(void 0,{day:"2-digit",month:"2-digit",year:"2-digit"})},Qn=s=>typeof s!="string"?!1:/[\u0980-\u09FF]/.test(s),vt=s=>{if(!s)return null;const e=s.match(/(https?:\/\/[^\s]+)/g);return e?e[0]:null};function Hn(){window.scrollTo(0,0)}const Je=s=>s?{id:s.id,handle:s.username,name:s.display_name,avatar:s.avatar_url||"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm",cover:s.cover_url||"https://systemadminbd.com/uploads/675346dd55e0c7.43939630.png",verified:s.is_verified,bio:s.bio,location:s.location,website:s.website,follower_count:s.follower_count||0,following_count:s.following_count||0,lastSeen:s.last_seen_at}:null,Qe=s=>{if(!s)return null;const e=s.reposter_id||s.reposter_data?.id||s.reposted_by?.id,a=Math.random().toString(36).substring(2,9),i=`${s.feed_id||(e?`${s.id}-${e}`:`${s.id}-orig`)}-${a}`;return{...s,feed_id:i,stats:{comments:s.comments_count||0,likes:s.likes_count||0,mirrors:s.mirrors_count||0},user:Je(s.author_data||s.user),community:s.community_data||s.communities?{...s.community_data||s.communities,avatar:(s.community_data||s.communities).avatar_url||(s.community_data||s.communities).avatar}:null,repostedBy:s.reposter_data?{handle:s.reposter_data.username,name:s.reposter_data.display_name,id:s.reposter_data.id}:s.reposted_by?{handle:s.reposted_by.username,name:s.reposted_by.display_name,id:s.reposted_by.id}:null,timeAgo:nt(s.created_at)}},Ks=s=>s?{...s,stats:{likes:s.likes_count||0},user:Je(s.user),timeAgo:nt(s.created_at)}:null,Kn=s=>s?{...s,user:s.actor?.username,avatar:s.actor?.avatar_url||"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm"}:null,Ys=s=>s?{...s,media:s.media_url,user:Je(s.user)}:null,Yn=async(s,e=10)=>{const{data:a,error:i}=await q.from("users").select("*").or(`username.ilike.%${s}%,display_name.ilike.%${s}%`).limit(e);if(i)throw i;return a.map(Je)},Xs=async(s,e="id")=>{let a=q.from("users").select("*");e==="id"?a=a.eq("id",s):a=a.ilike("username",s);const{data:i,error:n}=await a.maybeSingle();if(n)throw n;return i?Je(i):null},Xn=s=>Xs(s,"username"),Ze=async s=>{if(!s)return;const{error:e}=await q.from("users").update({last_seen_at:new Date().toISOString()}).eq("id",s);e&&console.error("Error updating last seen:",e)},Zn=async(s,e)=>{const a={display_name:e.name,username:e.handle,avatar_url:e.avatar,bio:e.bio,cover_url:e.cover,website:e.website,location:e.location};Object.keys(a).forEach(n=>a[n]===void 0&&delete a[n]);const{error:i}=await q.from("users").update(a).eq("id",s);if(i)throw i},Zs=async(s,e)=>{const{data:a}=await q.from("follows").select("*").eq("follower_id",s).eq("following_id",e).maybeSingle();return a?(await q.from("follows").delete().eq("follower_id",s).eq("following_id",e),!1):(await q.from("follows").insert([{follower_id:s,following_id:e}]),!0)},Gs=async(s,e)=>{if(!s)return!1;const{data:a}=await q.from("follows").select("*").eq("follower_id",s).eq("following_id",e).maybeSingle();return!!a},Gn=async(s,e=null,a=10)=>{let i=q.from("follows").select(`
      created_at,
      user:users!follower_id (
        id,
        username,
        display_name,
        avatar_url,
        is_verified,
        bio
      )
    `).eq("following_id",s).order("created_at",{ascending:!1}).limit(a);e&&(i=i.lt("created_at",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(l=>({...Je(l.user),followed_at:l.created_at}))},er=async(s,e=null,a=10)=>{let i=q.from("follows").select(`
      created_at,
      user:users!following_id (
        id,
        username,
        display_name,
        avatar_url,
        is_verified,
        bio
      )
    `).eq("follower_id",s).order("created_at",{ascending:!1}).limit(a);e&&(i=i.lt("created_at",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(l=>({...Je(l.user),followed_at:l.created_at}))},tr=async s=>{const{data:e,error:a}=await q.from("users").select("follower_count, following_count").eq("id",s).maybeSingle();return a||!e?{followers:0,following:0}:{followers:e.follower_count||0,following:e.following_count||0}},sr=async(s=null,e=10)=>{let a=q.from("unified_posts").select("*").order("sort_timestamp",{ascending:!1}).limit(e);s&&(a=a.lt("sort_timestamp",s));const{data:i,error:n}=await a;if(n)throw n;return i.map(Qe)},ar=async s=>{const{data:e,error:a}=await q.from("posts").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified,
                bio,
                location,
                website,
                follower_count,
                following_count
            ),
            communities (
                id,
                handle,
                name,
                avatar_url
            ),
            quoted_post:posts!quoted_post_id (
                *,
                user:users!user_id (
                    id,
                    username,
                    display_name,
                    avatar_url,
                    is_verified
                )
            )
        `).eq("id",s).single();if(a)throw a;return Qe(e)},ir=async(s,e=null,a=10)=>{let i=q.from("unified_posts").select("*").or(`user_id.eq.${s},reposter_id.eq.${s}`).order("sort_timestamp",{ascending:!1}).limit(a);e&&(i=i.lt("sort_timestamp",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(Qe)},nr=async({content:s,media:e=[],type:a="text",userId:i,poll:n=null,parentId:r=null,communityId:l=null})=>{const{data:o,error:c}=await q.from("posts").insert([{user_id:i,content:s,media:e,type:a,poll:n,parent_id:r,community_id:l}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            ),
            communities:community_id (
                id,
                handle,
                name,
                avatar_url
            )
        `);if(c)throw c;return Qe(o[0])},rr=async s=>{const{error:e}=await q.from("posts").delete().eq("id",s);if(e)throw e},lr=async(s,e)=>{const{error:a}=await q.from("posts").update(e).eq("id",s);if(a)throw a},ea=async(s,e=null,a=10)=>{let i=q.from("comments").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `).eq("post_id",s).order("created_at",{ascending:!0}).limit(a);e&&(i=i.gt("created_at",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(Ks)},ta=async(s,e,a,i=[])=>{const{data:n,error:r}=await q.from("comments").insert([{post_id:s,user_id:e,content:a,media:i}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `);if(r)throw r;return Ks(n[0])},Dt=async(s,e)=>{const{data:a}=await q.from("likes").select("*").eq("post_id",s).eq("user_id",e).maybeSingle();return a?(await q.from("likes").delete().eq("post_id",s).eq("user_id",e),!1):(await q.from("likes").insert([{post_id:s,user_id:e}]),!0)},sa=async(s,e)=>{if(!e)return!1;const{data:a}=await q.from("likes").select("*").eq("post_id",s).eq("user_id",e).maybeSingle();return!!a},or=async(s,e)=>{const{data:a}=await q.from("reposts").select("*").eq("post_id",s).eq("user_id",e).maybeSingle();return a?(await q.from("reposts").delete().eq("post_id",s).eq("user_id",e),!1):(await q.from("reposts").insert([{post_id:s,user_id:e}]),!0)},cr=async(s,e)=>{if(!e)return!1;const{data:a}=await q.from("reposts").select("*").eq("post_id",s).eq("user_id",e).maybeSingle();return!!a},Ot=async(s,e=null,a=10,i=!1)=>{let n=q.from("unified_posts").select("*").ilike("content",`%${s}%`);i&&(n=n.not("community_id","is",null).is("reposter_id",null)),n=n.order("sort_timestamp",{ascending:!1}).limit(a),e&&(n=n.lt("sort_timestamp",e));const{data:r,error:l}=await n;if(l)throw l;return r.map(Qe)},dr=async(s=null,e=10)=>{let a=q.from("unified_posts").select("*").not("community_id","is",null).is("reposter_id",null).order("sort_timestamp",{ascending:!1}).limit(e);s&&(a=a.lt("sort_timestamp",s));const{data:i,error:n}=await a;if(n)throw n;return i.map(Qe)},mr=async(s=null,e=10)=>{let a=q.from("unified_posts").select("*").eq("type","video").order("sort_timestamp",{ascending:!1}).limit(e);s&&(a=a.lt("sort_timestamp",s));const{data:i,error:n}=await a;if(n)throw n;return i.map(Qe)},aa=async(s,e)=>{const{data:a}=await q.from("conversation_participants").select("conversation_id").eq("user_id",s),i=a.map(o=>o.conversation_id),{data:n}=await q.from("conversation_participants").select("conversation_id").eq("user_id",e).in("conversation_id",i).maybeSingle();if(n)return n.conversation_id;const{data:r,error:l}=await q.from("conversations").insert([{}]).select().single();if(l)throw l;return await q.from("conversation_participants").insert([{conversation_id:r.id,user_id:s},{conversation_id:r.id,user_id:e}]),r.id},ur=async s=>{if(!s)return 0;const{data:e}=await q.from("conversation_participants").select("conversation_id").eq("user_id",s),a=e?.map(r=>r.conversation_id)||[];if(a.length===0)return 0;const{count:i,error:n}=await q.from("messages").select("*",{count:"exact",head:!0}).eq("is_read",!1).neq("sender_id",s).in("conversation_id",a);if(n)throw n;return i||0},fr=async(s,e)=>{if(!s||!e)return;const{error:a}=await q.from("messages").update({is_read:!0}).eq("conversation_id",s).neq("sender_id",e).eq("is_read",!1);if(a)throw a},xr=async s=>{if(!s)return[];const{data:e,error:a}=await q.from("conversation_participants").select(`
            conversation:conversations (
                id,
                last_message_at,
                last_message_content,
                participants:conversation_participants (
                    user:users (
                        id,
                        username,
                        display_name,
                        avatar_url,
                        last_seen_at
                    )
                ),
                messages (
                    id,
                    is_read,
                    sender_id
                )
            )
        `).eq("user_id",s);if(a)throw a;return e.map(i=>{const n=i.conversation,r=n.participants.find(o=>o.user?.id!==s)||n.participants[0],l=n.messages?.filter(o=>!o.is_read&&o.sender_id!==s).length||0;return{id:n.id,user:Je(r?.user),lastMessage:n.last_message_content||"No messages yet",lastMessageAt:n.last_message_at,time:n.last_message_at?new Date(n.last_message_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",unread:l}}).sort((i,n)=>i.lastMessageAt?n.lastMessageAt?new Date(n.lastMessageAt)-new Date(i.lastMessageAt):-1:1)},hr=async s=>{const{data:e,error:a}=await q.from("messages").select("*").eq("conversation_id",s).order("created_at",{ascending:!0});if(a)throw a;return e},pr=async()=>{const{data:s,error:e}=await q.from("message_reactions").select("*");if(e)throw e;return s||[]},br=async(s,e,a)=>{const{data:i}=await q.from("message_reactions").select("*").eq("message_id",s).eq("user_id",e).maybeSingle();return i?i.emoji===a?(await q.from("message_reactions").delete().eq("id",i.id),{action:"removed",emoji:a}):(await q.from("message_reactions").update({emoji:a}).eq("id",i.id),{action:"updated",emoji:a}):(await q.from("message_reactions").insert([{message_id:s,user_id:e,emoji:a}]),{action:"added",emoji:a})},gr=async(s,e,a,i="text",n=[],r=null)=>{const{data:l,error:o}=await q.from("messages").insert([{conversation_id:s,sender_id:e,content:a,type:i,media:n,reply_to_id:r}]).select();if(o)throw o;return await q.from("conversations").update({last_message_at:new Date,last_message_content:i==="image"||n&&n.length>0?"Sent an image":a}).eq("id",s),l[0]},vr=async s=>{const{error:e}=await q.from("messages").delete().eq("id",s);if(e)throw e},jr=async(s,e=null,a=10)=>{if(!s)return[];let i=q.from("notifications").select(`
            *,
            actor:users!actor_id (
                username,
                avatar_url
            )
        `).eq("recipient_id",s).order("created_at",{ascending:!1}).limit(a);e&&(i=i.lt("created_at",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(Kn)},wr=async s=>{const{error:e}=await q.from("notifications").update({is_read:!0}).eq("recipient_id",s).eq("is_read",!1);if(e)throw e},yr=async s=>{if(!s)return 0;const{count:e,error:a}=await q.from("notifications").select("*",{count:"exact",head:!0}).eq("recipient_id",s).eq("is_read",!1);if(a)throw a;return e||0},zr=async()=>{const{data:s,error:e}=await q.from("stories").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `).gt("expires_at",new Date().toISOString()).order("created_at",{ascending:!1});if(e)throw e;return s.map(Ys)},Nr=async(s,e,a="image")=>{const{data:i,error:n}=await q.from("stories").insert([{user_id:s,media_url:e,type:a}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `);if(n)throw n;return Ys(i[0])},ht=s=>s?{id:s.id,handle:s.handle,name:s.name,description:s.description,avatar:s.avatar_url||"https://api.dicebear.com/7.x/identicon/svg?seed=community",cover:s.cover_url||"https://systemadminbd.com/uploads/675346dd55e0c7.43939630.png",membersCount:s.members_count||0,postsCount:s.posts_count||0,isPrivate:s.is_private,createdAt:s.created_at,type:"community",creatorId:s.creator_id}:null,kr=async(s=null,e=10)=>{let a=q.from("communities").select("*").order("created_at",{ascending:!1}).limit(e);s&&(a=a.lt("created_at",s));const{data:i,error:n}=await a;if(n)throw n;return i.map(ht)},_r=async s=>{const{data:e,error:a}=await q.from("communities").select("*").eq("handle",s).single();if(a)throw a;return ht(e)},Cr=async(s,e=null,a=10)=>{let i=q.from("unified_posts").select("*").eq("community_id",s).is("reposter_id",null).order("sort_timestamp",{ascending:!1}).limit(a);e&&(i=i.lt("sort_timestamp",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(Qe)},ia=async(s,e)=>{const{data:a}=await q.from("community_members").select("*").eq("community_id",s).eq("user_id",e).maybeSingle();if(a){const{error:i}=await q.from("community_members").delete().eq("community_id",s).eq("user_id",e);if(i)throw i;return!1}else{const{error:i}=await q.from("community_members").insert([{community_id:s,user_id:e}]);if(i)throw i;return!0}},na=async(s,e)=>{if(!e)return null;const{data:a}=await q.from("community_members").select("*").eq("community_id",s).eq("user_id",e).maybeSingle();return a},Sr=async s=>{if(!s)return[];const{data:e,error:a}=await q.from("community_members").select(`
      role,
      communities (*)
    `).eq("user_id",s);if(a)throw a;return e.map(i=>({...ht(i.communities),myRole:i.role}))},Pr=async s=>{const{data:e,error:a}=await q.from("communities").insert([s]).select().single();if(a)throw a;return ht(e)},$r=async(s,e)=>{const{data:a,error:i}=await q.from("communities").update(e).eq("id",s).select().single();if(i)throw i;return ht(a)},Ar=async(s,e="")=>{let a=q.from("community_members").select(`
      role,
      user_id,
      users:user_id!inner (
        id,
        username,
        display_name,
        avatar_url,
        is_verified
      )
    `).eq("community_id",s);e&&(a=a.or(`username.ilike.%${e}%,display_name.ilike.%${e}%`,{foreignTable:"users"}));const{data:i,error:n}=await a.limit(20);if(n)throw n;return i.map(r=>({role:r.role,userId:r.user_id,user:r.users}))},Mr=async(s,e,a)=>{const{data:i,error:n}=await q.from("community_members").update({role:a}).eq("community_id",s).eq("user_id",e).select().single();if(n)throw n;return i},Fr=async(s=5)=>{const{data:e,error:a}=await q.from("hashtags").select("*").order("usage_count",{ascending:!1}).limit(s);if(a)throw a;return e},Er=async s=>{try{const e=`https://api.allorigins.win/raw?url=${encodeURIComponent(s)}`,a=await fetch(e);if(!a.ok)throw new Error("Failed to fetch preview");const i=await a.text(),n=new DOMParser().parseFromString(i,"text/html"),r=l=>n.querySelector(`meta[property="${l}"]`)?.getAttribute("content")||n.querySelector(`meta[name="${l}"]`)?.getAttribute("content");return{title:r("og:title")||n.title||s,description:r("og:description")||r("description")||"",image:r("og:image")||r("twitter:image")||"",siteName:r("og:site_name")||new URL(s).hostname,url:s}}catch(e){return console.error("Link preview error:",e),null}},Rr=async s=>{if(!s)return null;try{const{data:e}=await q.from("link_previews").select("*").eq("url",s).maybeSingle();if(e)return q.from("link_previews").update({last_used_at:new Date().toISOString()}).eq("url",s).then(()=>{}),{title:e.title,description:e.description,image:e.image,siteName:e.site_name,url:e.url};const a=await Er(s);return a?(q.from("link_previews").insert([{url:a.url,title:a.title,description:a.description,image:a.image,site_name:a.siteName}]).then(({error:i})=>{i&&console.error("Cache save error:",i)}),a):null}catch(e){return console.error("Link preview cache error:",e),null}},Ir=async(s,e={})=>{if(!s.type.startsWith("image/"))return s;const a={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0,initialQuality:.8,fileType:"image/webp",...e};try{const i=await Ln(s,a);return console.log(`Original size: ${(s.size/1024/1024).toFixed(2)} MB`),console.log(`Compressed size: ${(i.size/1024/1024).toFixed(2)} MB`),i}catch(i){return console.error("Image compression failed:",i),s}},Lr=(s,e=1)=>new Promise((a,i)=>{const n=document.createElement("video");n.preload="metadata",n.src=URL.createObjectURL(s),n.muted=!0,n.playsInline=!0,n.onloadedmetadata=()=>{n.currentTime=e},n.onseeked=()=>{const r=document.createElement("canvas");r.width=n.videoWidth,r.height=n.videoHeight,r.getContext("2d").drawImage(n,0,0,r.width,r.height),r.toBlob(l=>{const o=new File([l],"thumbnail.webp",{type:"image/webp"});URL.revokeObjectURL(n.src),a(o)},"image/webp",.7)},n.onerror=r=>i(r)}),Ae=async(s,e="media",a=null)=>{let i=s,n=s.name.split(".").pop(),r=null;if(s.type.startsWith("image/")&&(i=await Ir(s),n="webp"),s.type.startsWith("video/"))try{a?r=(await Ae(a,e)).url:r=(await Ae(await Lr(s),e)).url}catch(d){console.error("Failed to handle video poster:",d)}const l=`${`${crypto.randomUUID()}.${n}`}`,{data:o,error:c}=await q.storage.from(e).upload(l,i);if(c)throw c;const{data:{publicUrl:u}}=q.storage.from(e).getPublicUrl(o.path);return{url:u,poster:r,name:s.name,type:s.type.startsWith("image/")?"image":s.type.startsWith("video/")?"video":"file",size:i.size}};var t=js(cn(),1),ra=(0,g.createContext)();const Tr=({children:s})=>{const[e,a]=(0,g.useState)(null),[i,n]=(0,g.useState)(null),[r,l]=(0,g.useState)({}),[o,c]=(0,g.useState)(!0),u=async h=>{try{const b=await Xs(h.id);b?(a(b),l(v=>({...v,[b.handle.toLowerCase()]:b}))):a({id:h.id,email:h.email,name:h.email.split("@")[0],handle:h.email.split("@")[0],avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm",verified:!1})}catch(b){console.error("Error fetching user profile:",b)}finally{c(!1)}};(0,g.useEffect)(()=>{if(!e?.id)return;Ze(e.id);const h=setInterval(()=>Ze(e.id),3e4),b=()=>{document.visibilityState==="visible"&&Ze(e.id)};return window.addEventListener("visibilitychange",b),window.addEventListener("beforeunload",()=>Ze(e.id)),()=>{clearInterval(h),window.removeEventListener("visibilitychange",b),window.removeEventListener("beforeunload",()=>Ze(e.id))}},[e?.id]),(0,g.useEffect)(()=>{q.auth.getSession().then(({data:{session:b}})=>{b?u(b.user):c(!1)});const{data:{subscription:h}}=q.auth.onAuthStateChange((b,v)=>{v?u(v.user):(a(null),c(!1))});return()=>h.unsubscribe()},[]);const d=async({email:h,password:b})=>{const{data:v,error:j}=await q.auth.signInWithPassword({email:h,password:b});if(j)throw j;return n(null),v},m=async({email:h,password:b,username:v,name:j})=>{const{data:{user:y},error:z}=await q.auth.signUp({email:h,password:b,options:{data:{username:v.toLowerCase(),name:j}}});if(z)throw z;return n(null),y},f=async()=>{await q.auth.signOut(),a(null),n(null)},p=async h=>{e&&(await Zn(e.id,h),await u(e))},x=async h=>{const b=h.toLowerCase();if(r[b])return r[b];const v=await Xn(h);return v?(l(j=>({...j,[b]:v})),v):null};return(0,t.jsx)(ra.Provider,{value:{currentUser:e,authMode:i,setAuthMode:n,profiles:r,login:d,signup:m,logout:f,updateProfile:p,getProfileByHandle:x,loading:o},children:!o&&s})},pe=()=>{const s=(0,g.useContext)(ra);if(!s)throw new Error("useAuth must be used within an AuthProvider");return s};var Dr=Q(),la=(0,g.createContext)();const Or=s=>{const e=(0,Dr.c)(10),{children:a}=s,{currentUser:i}=pe();let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=new Set,e[0]=n):n=e[0];const[r,l]=(0,g.useState)(n);let o;e[1]!==i?(o=()=>{if(!i?.id)return;const f=q.channel("global_presence",{config:{presence:{key:i.id}}});return f.on("presence",{event:"sync"},()=>{const p=f.presenceState(),x=new Set;Object.keys(p).forEach(h=>x.add(h)),l(x)}).subscribe(async p=>{p==="SUBSCRIBED"&&(await f.track({userId:i.id,online_at:new Date().toISOString()}),Ze(i.id))}),()=>{i?.id&&Ze(i.id),q.removeChannel(f),l(new Set)}},e[1]=i,e[2]=o):o=e[2];const c=i?.id;let u;e[3]!==c?(u=[c],e[3]=c,e[4]=u):u=e[4],(0,g.useEffect)(o,u);let d;e[5]!==r?(d={onlineUsers:r},e[5]=r,e[6]=d):d=e[6];let m;return e[7]!==a||e[8]!==d?(m=(0,t.jsx)(la.Provider,{value:d,children:a}),e[7]=a,e[8]=d,e[9]=m):m=e[9],m},oa=()=>{const s=(0,g.useContext)(la);if(!s)throw new Error("usePresence must be used within a PresenceProvider");return s};var qr=Q(),ca=(0,g.createContext)();const Wr=s=>{const e=(0,qr.c)(19),{children:a}=s,[i,n]=(0,g.useState)(Ur),[r,l]=(0,g.useState)(Br),[o,c]=(0,g.useState)(Vr);let u,d;e[0]!==i?(u=()=>{localStorage.setItem("theme",i?"dark":"light"),i?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},d=[i],e[0]=i,e[1]=u,e[2]=d):(u=e[1],d=e[2]),(0,g.useEffect)(u,d);let m,f;e[3]!==r?(m=()=>{localStorage.setItem("font-size",r),document.documentElement.style.setProperty("--app-font-size",{small:"14px",base:"16px",large:"18px"}[r])},f=[r],e[3]=r,e[4]=m,e[5]=f):(m=e[4],f=e[5]),(0,g.useEffect)(m,f);let p,x;e[6]!==o?(p=()=>{localStorage.setItem("data-saver",o)},x=[o],e[6]=o,e[7]=p,e[8]=x):(p=e[7],x=e[8]),(0,g.useEffect)(p,x);let h;e[9]!==i?(h=()=>n(!i),e[9]=i,e[10]=h):h=e[10];const b=h;let v;e[11]!==i||e[12]!==o||e[13]!==r||e[14]!==b?(v={darkMode:i,setDarkMode:n,toggleDarkMode:b,fontSize:r,setFontSize:l,dataSaver:o,setDataSaver:c},e[11]=i,e[12]=o,e[13]=r,e[14]=b,e[15]=v):v=e[15];let j;return e[16]!==a||e[17]!==v?(j=(0,t.jsx)(ca.Provider,{value:v,children:a}),e[16]=a,e[17]=v,e[18]=j):j=e[18],j},pt=()=>{const s=(0,g.useContext)(ca);if(!s)throw new Error("useTheme must be used within a ThemeProvider");return s};function Ur(){const s=localStorage.getItem("theme");return s==="dark"||!s&&window.matchMedia("(prefers-color-scheme: dark)").matches}function Br(){return localStorage.getItem("font-size")||"base"}function Vr(){return localStorage.getItem("data-saver")==="true"}var Jr=Q(),Qr=s=>{const e=(0,Jr.c)(7);let a;e[0]!==s?({...a}=s,e[0]=s,e[1]=a):a=e[1];const{theme:i}=Ga(),n=i===void 0?"system":i;let r,l;e[2]===Symbol.for("react.memo_cache_sentinel")?(r={success:(0,t.jsx)(Hs,{className:"size-4"}),info:(0,t.jsx)(Tt,{className:"size-4"}),warning:(0,t.jsx)(hn,{className:"size-4"}),error:(0,t.jsx)(Qi,{className:"size-4"}),loading:(0,t.jsx)(ce,{className:"size-4 animate-spin"})},l={"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)","--border-radius":"var(--radius)"},e[2]=r,e[3]=l):(r=e[2],l=e[3]);let o;return e[4]!==a||e[5]!==n?(o=(0,t.jsx)(Oa,{theme:n,className:"toaster group",icons:r,style:l,...a}),e[4]=a,e[5]=n,e[6]=o):o=e[6],o},Hr=Q(),da=(0,g.createContext)();const Kr=s=>{const e=(0,Hr.c)(4),{children:a}=s,i=Yr;let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n={addToast:i},e[0]=n):n=e[0];let r;e[1]===Symbol.for("react.memo_cache_sentinel")?(r=(0,t.jsx)(Qr,{position:"bottom-center",toastOptions:{className:"rounded-full font-bold"}}),e[1]=r):r=e[1];let l;return e[2]!==a?(l=(0,t.jsxs)(da.Provider,{value:n,children:[a,r]}),e[2]=a,e[3]=l):l=e[3],l},ze=()=>{const s=(0,g.useContext)(da);if(!s)throw new Error("useToast must be used within a ToastProvider");return s};function Yr(s,e){const a=e===void 0?"success":e;a==="error"?Mt.error(s):a==="info"?Mt.info(s):Mt.success(s)}var ma=(0,g.createContext)();const Xr=({children:s})=>{const[e,a]=(0,g.useState)([]),[i,n]=(0,g.useState)(!0),[r,l]=(0,g.useState)(!0),[o,c]=(0,g.useState)(!1),u=(0,g.useRef)(e);(0,g.useEffect)(()=>{u.current=e},[e]);const d=(0,g.useCallback)(async(v=!1)=>{v?c(!0):n(!0);try{const j=u.current,y=await sr(v&&j.length>0?j[j.length-1].created_at:null,10);y.length<10?l(!1):l(!0),a(v?z=>[...z,...y]:y)}catch(j){console.error("Failed to load posts:",j)}finally{n(!1),c(!1)}},[]),m=()=>{!r||o||d(!0)};(0,g.useEffect)(()=>{d()},[d]);const f=async v=>{const j=await nr(v);return d(),j},p=async v=>{await rr(v),a(j=>j.filter(y=>y.id!==v))},x=async(v,j)=>{await lr(v,j),a(y=>y.map(z=>z.id===v?{...z,...j}:z))},h=v=>e.find(j=>j.id===v),b=(v,j="feed")=>{let y=e.filter(z=>!!(z.user?.handle===v||z.repostedBy&&z.repostedBy.handle===v));return j==="feed"?y.filter(z=>z.parent_id===null):j==="media"?y.filter(z=>z.parent_id===null&&(z.type==="video"||z.type==="image"||z.media?.length>0)):y};return(0,t.jsx)(ma.Provider,{value:{posts:e,setPosts:a,addPost:f,deletePost:p,updatePost:x,getPostById:h,getUserPosts:b,loading:i,hasMore:r,isFetchingNextPage:o,fetchNextPage:m,refreshPosts:()=>d(!1)},children:s})},Vt=()=>{const s=(0,g.useContext)(ma);if(!s)throw new Error("usePosts must be used within a PostProvider");return s};var Zr=Q(),ua=(0,g.createContext)();const Gr=s=>{const e=(0,Zr.c)(9),{children:a}=s;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i={isOpen:!1,images:[],currentIndex:0},e[0]=i):i=e[0];const[n,r]=(0,g.useState)(i);let l;e[1]===Symbol.for("react.memo_cache_sentinel")?(l=(x,h)=>{const b=h===void 0?0:h;r({isOpen:!0,images:Array.isArray(x)?x:[x],currentIndex:b})},e[1]=l):l=e[1];const o=l;let c;e[2]===Symbol.for("react.memo_cache_sentinel")?(c=()=>{r(el)},e[2]=c):c=e[2];const u=c;let d;e[3]===Symbol.for("react.memo_cache_sentinel")?(d=x=>{r(h=>({...h,currentIndex:x}))},e[3]=d):d=e[3];const m=d;let f;e[4]!==n?(f={...n,openLightbox:o,closeLightbox:u,setIndex:m},e[4]=n,e[5]=f):f=e[5];let p;return e[6]!==a||e[7]!==f?(p=(0,t.jsx)(ua.Provider,{value:f,children:a}),e[6]=a,e[7]=f,e[8]=p):p=e[8],p},Jt=()=>{const s=(0,g.useContext)(ua);if(!s)throw new Error("useLightbox must be used within a LightboxProvider");return s};function el(s){return{...s,isOpen:!1}}var tl=Q(),fa=(0,g.createContext)();const sl=s=>{const e=(0,tl.c)(15),{children:a}=s,[i,n]=(0,g.useState)(null);let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=new Map,e[0]=r):r=e[0];const l=(0,g.useRef)(r);let o;e[1]!==i?(o=(h,b,v)=>{b===0?l.current.has(h)&&l.current.delete(h):l.current.set(h,{ratio:b,...v});let j=null,y=.5;for(const[z,k]of l.current.entries())k.ratio>y&&(y=k.ratio,j=z);j!==i&&n(j)},e[1]=i,e[2]=o):o=e[2];const c=o;let u,d;e[3]!==i?(u=()=>{l.current.forEach((h,b)=>{b===i?h.play():h.pause()})},d=[i],e[3]=i,e[4]=u,e[5]=d):(u=e[4],d=e[5]),(0,g.useEffect)(u,d);let m;e[6]!==i?(m=h=>{l.current.delete(h),i===h&&n(null)},e[6]=i,e[7]=m):m=e[7];const f=m;let p;e[8]!==i||e[9]!==c||e[10]!==f?(p={reportVisibility:c,unregister:f,activeVideoId:i},e[8]=i,e[9]=c,e[10]=f,e[11]=p):p=e[11];let x;return e[12]!==a||e[13]!==p?(x=(0,t.jsx)(fa.Provider,{value:p,children:a}),e[12]=a,e[13]=p,e[14]=x):x=e[14],x},al=()=>{const s=(0,g.useContext)(fa);if(!s)throw new Error("useVideoPlayback must be used within a VideoPlaybackProvider");return s};var il=Q();const xa=s=>{const e=(0,il.c)(16),a=Ct(),i=s?.id;let n;e[0]!==i?(n=["unread_notifications_count",i],e[0]=i,e[1]=n):n=e[1];let r;e[2]!==s?.id?(r=()=>yr(s?.id),e[2]=s?.id,e[3]=r):r=e[3];const l=!!s?.id;let o;e[4]!==n||e[5]!==r||e[6]!==l?(o={queryKey:n,queryFn:r,enabled:l},e[4]=n,e[5]=r,e[6]=l,e[7]=o):o=e[7];const{data:c}=Ee(o),u=c===void 0?0:c;let d;e[8]!==s||e[9]!==a?(d=()=>{if(!s?.id)return;const x=q.channel(`unread_count:${s.id}`).on("postgres_changes",{event:"*",schema:"public",table:"notifications",filter:`recipient_id=eq.${s.id}`},()=>{a.invalidateQueries({queryKey:["unread_notifications_count",s.id]}),a.invalidateQueries({queryKey:["notifications",s.id]})}).subscribe();return()=>q.removeChannel(x)},e[8]=s,e[9]=a,e[10]=d):d=e[10];const m=s?.id;let f;e[11]!==a||e[12]!==m?(f=[m,a],e[11]=a,e[12]=m,e[13]=f):f=e[13],(0,g.useEffect)(d,f);let p;return e[14]!==u?(p={unreadCount:u},e[14]=u,e[15]=p):p=e[15],p};var nl=Q();const Qt=s=>{const e=(0,nl.c)(65),a=Ct();let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i={},e[0]=i):i=e[0];const[n,r]=(0,g.useState)(i),l=(0,g.useRef)(null),o=s?.id;let c;e[1]!==o?(c=["conversations",o],e[1]=o,e[2]=c):c=e[2];let u;e[3]!==s?.id?(u=()=>xr(s?.id),e[3]=s?.id,e[4]=u):u=e[4];const d=!!s?.id;let m;e[5]!==c||e[6]!==u||e[7]!==d?(m={queryKey:c,queryFn:u,enabled:d},e[5]=c,e[6]=u,e[7]=d,e[8]=m):m=e[8];const{data:f,isLoading:p}=Ee(m);let x;e[9]!==f?(x=f===void 0?[]:f,e[9]=f,e[10]=x):x=e[10];const h=x,b=s?.id;let v;e[11]!==b?(v=["unread_messages_count",b],e[11]=b,e[12]=v):v=e[12];let j;e[13]!==s?.id?(j=()=>ur(s?.id),e[13]=s?.id,e[14]=j):j=e[14];const y=!!s?.id;let z;e[15]!==j||e[16]!==y||e[17]!==v?(z={queryKey:v,queryFn:j,enabled:y},e[15]=j,e[16]=y,e[17]=v,e[18]=z):z=e[18];const{data:k}=Ee(z),_=k===void 0?0:k;let $;e[19]===Symbol.for("react.memo_cache_sentinel")?($=["reactions"],e[19]=$):$=e[19];const A=!!s?.id;let S;e[20]!==A?(S={queryKey:$,queryFn:pr,enabled:A},e[20]=A,e[21]=S):S=e[21];const{data:F}=Ee(S);let M;e[22]!==F?(M=F===void 0?[]:F,e[22]=F,e[23]=M):M=e[23];const R=M;let E;e[24]!==s||e[25]!==a?(E=()=>{if(!s?.id)return;const V=q.channel(`user_messages:${s.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},K=>{const ee=K.new;a.setQueryData(["messages",ee.conversation_id],X=>X?X.find(de=>de.id===ee.id)?X:[...X,ee]:[ee]),ee.sender_id!==s.id&&a.invalidateQueries({queryKey:["unread_messages_count",s.id]}),a.invalidateQueries(["conversations",s.id]),r(X=>({...X,[ee.conversation_id]:!1}))}).on("postgres_changes",{event:"DELETE",schema:"public",table:"messages"},K=>{a.invalidateQueries({queryKey:["messages"]}),a.invalidateQueries({queryKey:["conversations",s.id]})}).on("postgres_changes",{event:"*",schema:"public",table:"message_reactions"},()=>{a.invalidateQueries({queryKey:["reactions"]})}).subscribe(),J=q.channel("chat_typing_shared").on("broadcast",{event:"typing"},K=>{const{payload:ee}=K,{conversationId:X,isTyping:de,userId:Z}=ee;Z!==s.id&&r(ue=>({...ue,[X]:de}))}).subscribe();return l.current=J,()=>{q.removeChannel(V),q.removeChannel(J)}},e[24]=s,e[25]=a,e[26]=E):E=e[26];const I=s?.id;let O;e[27]!==a||e[28]!==I?(O=[I,a],e[27]=a,e[28]=I,e[29]=O):O=e[29],(0,g.useEffect)(E,O);let D;e[30]!==s?(D=V=>{const{convId:J,text:K,type:ee,media:X,replyToId:de}=V,Z=ee===void 0?"text":ee,ue=X===void 0?[]:X,me=de===void 0?null:de;return gr(J,s.id,K,Z,ue,me)},e[30]=s,e[31]=D):D=e[31];let P;e[32]!==s||e[33]!==a?(P=V=>{a.setQueryData(["messages",V.conversation_id],J=>J?J.find(K=>K.id===V.id)?J:[...J,V]:[V]),a.invalidateQueries(["conversations",s.id])},e[32]=s,e[33]=a,e[34]=P):P=e[34];let C;e[35]!==D||e[36]!==P?(C={mutationFn:D,onSuccess:P},e[35]=D,e[36]=P,e[37]=C):C=e[37];const w=Vs(C);let N;e[38]!==s?(N=(V,J)=>{l.current&&l.current.send({type:"broadcast",event:"typing",payload:{conversationId:V,isTyping:J,userId:s.id}})},e[38]=s,e[39]=N):N=e[39];const L=N;let W;e[40]!==s||e[41]!==a?(W=async V=>{!s?.id||!V||(await fr(V,s.id),a.invalidateQueries({queryKey:["unread_messages_count",s.id]}),a.invalidateQueries({queryKey:["conversations",s.id]}))},e[40]=s,e[41]=a,e[42]=W):W=e[42];const T=W;let B;e[43]!==s||e[44]!==a?(B=async(V,J)=>{if(s?.id)try{await br(V,s.id,J),a.invalidateQueries({queryKey:["reactions"]})}catch(K){console.error("Failed to toggle reaction:",K)}},e[43]=s,e[44]=a,e[45]=B):B=e[45];const H=B;let te;e[46]!==a?(te=async V=>{try{await vr(V),a.invalidateQueries({queryKey:["messages"]})}catch(J){console.error("Failed to delete message:",J)}},e[46]=a,e[47]=te):te=e[47];const re=te;let ie;e[48]!==s?.id?(ie=(V,J)=>{const K=V===void 0?[]:V,ee=J===void 0?[]:J;return K.map(X=>({id:X.id,sender:X.sender_id===s?.id?"me":"them",text:X.content,type:X.type||"text",media:X.media||[],isRead:X.is_read,replyToId:X.reply_to_id,reactions:ee.filter(de=>de.message_id===X.id),time:new Date(X.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}))},e[48]=s?.id,e[49]=ie):ie=e[49];const oe=ie;let G;e[50]!==w?(G=(V,J,K,ee,X)=>w.mutate({convId:V,text:J,type:K,media:ee,replyToId:X}),e[50]=w,e[51]=G):G=e[51];let ae;return e[52]!==R||e[53]!==h||e[54]!==oe||e[55]!==p||e[56]!==T||e[57]!==re||e[58]!==H||e[59]!==w.isPending||e[60]!==L||e[61]!==G||e[62]!==n||e[63]!==_?(ae={conversations:h,unreadCount:_,isConvLoading:p,sendMessage:G,sendTypingStatus:L,typingStatus:n,markAsRead:T,formatMessages:oe,onToggleReaction:H,onDeleteMessage:re,allReactions:R,isSending:w.isPending},e[52]=R,e[53]=h,e[54]=oe,e[55]=p,e[56]=T,e[57]=re,e[58]=H,e[59]=w.isPending,e[60]=L,e[61]=G,e[62]=n,e[63]=_,e[64]=ae):ae=e[64],ae};var Ht=Q();function be(s){const e=(0,Ht.c)(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=le("relative flex size-8 shrink-0 overflow-hidden rounded-full",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,t.jsx)(vi,{"data-slot":"avatar",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function ge(s){const e=(0,Ht.c)(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=le("aspect-square size-full",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,t.jsx)(hi,{"data-slot":"avatar-image",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function ve(s){const e=(0,Ht.c)(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=le("bg-muted flex size-full items-center justify-center rounded-full",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,t.jsx)(fi,{"data-slot":"avatar-fallback",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var rl=Q(),ll=s=>{const e=(0,rl.c)(23),{handleProfileClick:a}=s,{currentUser:i}=pe(),{unreadCount:n}=xa(i),{unreadCount:r}=Qt(i),l=ft();let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=[{id:"home",icon:Ut,path:"/"},{id:"community",icon:et,path:"/community"},{id:"reels",icon:zt,path:"/reels"},{id:"messages",icon:Pt,path:"/messages"},{id:"notifications",icon:_t,path:"/notifications"}],e[0]=o):o=e[0];const c=o;let u;e[1]!==r||e[2]!==n?(u=c.map(y=>(0,t.jsx)($s,{to:y.path,className:cl,children:z=>{const{isActive:k}=z;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.icon,{size:26,strokeWidth:k?2.5:2}),y.id==="notifications"&&n>0&&(0,t.jsx)("span",{className:"absolute top-3 right-[30%] size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"}),y.id==="messages"&&r>0&&(0,t.jsx)("span",{className:"absolute top-3 right-[30%] size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"})]})}},y.id)),e[1]=r,e[2]=n,e[3]=u):u=e[3];let d;e[4]!==i||e[5]!==a?(d=()=>{i&&a(i.handle)},e[4]=i,e[5]=a,e[6]=d):d=e[6];const m=`size-7 border-2 ${l.pathname.startsWith("/u/")?"border-black dark:border-white":"border-transparent opacity-70"}`,f=i?.avatar||"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm";let p;e[7]!==f?(p=(0,t.jsx)(ge,{src:f,alt:"Profile",className:"object-cover"}),e[7]=f,e[8]=p):p=e[8];let x;e[9]!==i?.handle?.[0]?(x=i?.handle?.[0]?.toUpperCase(),e[9]=i?.handle?.[0],e[10]=x):x=e[10];let h;e[11]!==x?(h=(0,t.jsx)(ve,{children:x}),e[11]=x,e[12]=h):h=e[12];let b;e[13]!==m||e[14]!==p||e[15]!==h?(b=(0,t.jsxs)(be,{className:m,children:[p,h]}),e[13]=m,e[14]=p,e[15]=h,e[16]=b):b=e[16];let v;e[17]!==d||e[18]!==b?(v=(0,t.jsx)("button",{onClick:d,className:"flex-1 flex flex-col items-center justify-center h-full",children:b}),e[17]=d,e[18]=b,e[19]=v):v=e[19];let j;return e[20]!==v||e[21]!==u?(j=(0,t.jsxs)("nav",{className:"fixed bottom-0 left-0 right-0 z-[40] flex h-16 items-center border-t border-zinc-100 bg-white/90 pb-safe backdrop-blur-md dark:border-zinc-800 dark:bg-black/90 md:hidden",children:[u,v]}),e[20]=v,e[21]=u,e[22]=j):j=e[22],j},ol=ll;function cl(s){const{isActive:e}=s;return`flex flex-1 flex-col items-center justify-center h-full transition-all duration-200 relative ${e?"text-black dark:text-white":"text-zinc-400 opacity-70"}`}var dl=Q(),ml=()=>{const s=(0,dl.c)(5);let e,a;s[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,t.jsx)("img",{src:"https://systemadminbd.com/uploads/675346dd55e0c7.43939630.png",alt:"Welcome Banner",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-700"}),a=(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"}),s[0]=e,s[1]=a):(e=s[0],a=s[1]);let i;s[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,t.jsx)("h1",{className:"text-3xl sm:text-4xl font-black mb-1 drop-shadow-lg",children:"Welcome to Sysm"}),s[2]=i):i=s[2];let n;s[3]===Symbol.for("react.memo_cache_sentinel")?(n=(0,t.jsxs)("div",{className:"absolute bottom-6 left-8 text-white",children:[i,(0,t.jsxs)("p",{className:"text-sm sm:text-base font-medium opacity-90 tracking-wide drop-shadow-md",children:["a social network built by"," ",(0,t.jsx)("a",{href:"https://t.me/systemadminbd",target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:"@Systemadminbd"})]})]}),s[3]=n):n=s[3];let r;return s[4]===Symbol.for("react.memo_cache_sentinel")?(r=(0,t.jsxs)("div",{className:"relative w-full aspect-[21/9] sm:aspect-[2.5/1] rounded-3xl overflow-hidden mb-6 group cursor-pointer",children:[e,a,n,(0,t.jsx)("div",{className:"absolute bottom-4 right-8",children:(0,t.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",className:"size-12 animate-pulse opacity-80 rounded-xl",alt:""})})]}),s[4]=r):r=s[4],r},ul=ml,fl=Q(),xl=s=>{const e=(0,fl.c)(26),{onPostClick:a}=s,i=ft(),n=je(),{darkMode:r}=pt(),l=i.pathname==="/";let o;e[0]!==i.pathname?(o=i.pathname.startsWith("/reels")||i.pathname.startsWith("/messages")&&i.pathname.split("/").length>2,e[0]=i.pathname,e[1]=o):o=e[1];const c=o;let u;e[2]!==n?(u=k=>{n(`/u/${k}`)},e[2]=n,e[3]=u):u=e[3];const d=u,m=`min-h-screen bg-[--background] text-[--foreground] font-sans selection:bg-violet-500 selection:text-white transition-colors duration-200 ${r?"dark":""}`;let f;e[4]!==a?(f=(0,t.jsx)(jl,{onPostClick:a}),e[4]=a,e[5]=f):f=e[5];let p;e[6]!==l?(p=l&&(0,t.jsx)("div",{className:"w-full max-w-full overflow-hidden",children:(0,t.jsx)(ul,{})}),e[6]=l,e[7]=p):p=e[7];let x;e[8]===Symbol.for("react.memo_cache_sentinel")?(x=(0,t.jsx)("div",{className:"w-full",children:(0,t.jsx)(Ua,{})}),e[8]=x):x=e[8];let h;e[9]!==p?(h=(0,t.jsxs)("div",{className:"flex flex-col flex-1 w-0 overflow-x-hidden",children:[p,x]}),e[9]=p,e[10]=h):h=e[10];let b;e[11]!==i.pathname?(b=!i.pathname.startsWith("/messages")&&(0,t.jsx)(_o,{}),e[11]=i.pathname,e[12]=b):b=e[12];let v;e[13]!==h||e[14]!==b?(v=(0,t.jsxs)("div",{className:"flex-1 flex justify-center gap-x-2 md:gap-x-8 py-0 md:py-5 px-0 md:px-4",children:[h,b]}),e[13]=h,e[14]=b,e[15]=v):v=e[15];let j;e[16]!==f||e[17]!==v?(j=(0,t.jsxs)("div",{className:"flex justify-center w-full max-w-[1300px] mx-auto min-h-screen px-0 sm:px-0",children:[f,v]}),e[16]=f,e[17]=v,e[18]=j):j=e[18];let y;e[19]!==d||e[20]!==c?(y=!c&&(0,t.jsx)(ol,{handleProfileClick:d}),e[19]=d,e[20]=c,e[21]=y):y=e[21];let z;return e[22]!==j||e[23]!==y||e[24]!==m?(z=(0,t.jsxs)("div",{className:m,children:[j,y]}),e[22]=j,e[23]=y,e[24]=m,e[25]=z):z=e[25],z},hl=xl,pl=Q(),bl=s=>{const e=(0,pl.c)(2),{children:a}=s;let i;return e[0]!==a?(i=(0,t.jsx)("div",{className:"w-full animate-in fade-in slide-in-from-bottom-2 duration-300 ease-out",children:a}),e[0]=a,e[1]=i):i=e[1],i},Ce=bl,gl=Q(),vl=s=>{const e=(0,gl.c)(18),{onPostClick:a}=s,{currentUser:i}=pe(),{unreadCount:n}=xa(i),{unreadCount:r}=Qt(i);let l,o,c,u,d;e[0]===Symbol.for("react.memo_cache_sentinel")?(l={id:"home",icon:Ut,path:"/"},o={id:"community",icon:et,path:"/community"},c={id:"reels",icon:zt,path:"/reels"},u={id:"messages",icon:Pt,path:"/messages"},d={id:"notifications",icon:_t,path:"/notifications"},e[0]=l,e[1]=o,e[2]=c,e[3]=u,e[4]=d):(l=e[0],o=e[1],c=e[2],u=e[3],d=e[4]);const m=i?`/u/${i.handle}`:"/community";let f;e[5]!==m?(f=[l,o,c,u,d,{id:"profile",icon:Lt,path:m}],e[5]=m,e[6]=f):f=e[6];const p=f;let x;e[7]===Symbol.for("react.memo_cache_sentinel")?(x=(0,t.jsx)(Wt,{to:"/",className:"mb-8 hover:scale-110 transition-transform",children:(0,t.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",alt:"Logo",className:"size-8 rounded-lg"})}),e[7]=x):x=e[7];let h;e[8]!==r||e[9]!==p||e[10]!==n?(h=p.map(j=>(0,t.jsxs)($s,{to:j.path,className:wl,children:[(0,t.jsx)(j.icon,{size:26,strokeWidth:2.5}),j.id==="notifications"&&n>0&&(0,t.jsx)("span",{className:"absolute top-2 right-2 size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"}),j.id==="messages"&&r>0&&(0,t.jsx)("span",{className:"absolute top-2 right-2 size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"})]},j.id)),e[8]=r,e[9]=p,e[10]=n,e[11]=h):h=e[11];let b;e[12]!==i||e[13]!==a?(b=i&&(0,t.jsx)("button",{onClick:a,className:"p-2.5 mt-2 rounded-xl text-white bg-zinc-950 dark:bg-white dark:text-zinc-950 hover:scale-110 active:scale-95 transition-all duration-200 shadow-lg cursor-pointer",title:"Create Post",children:(0,t.jsx)(We,{size:26,strokeWidth:2.5})}),e[12]=i,e[13]=a,e[14]=b):b=e[14];let v;return e[15]!==b||e[16]!==h?(v=(0,t.jsxs)("aside",{className:"sticky top-0 hidden md:flex h-screen w-[68px] flex-col items-center py-5 border-r border-zinc-100 dark:border-zinc-800 shrink-0 bg-white dark:bg-black transition-colors duration-200",children:[x,(0,t.jsxs)("nav",{className:"flex flex-col gap-y-4 w-full items-center",children:[h,b]})]}),e[15]=b,e[16]=h,e[17]=v):v=e[17],v},jl=vl;function wl(s){const{isActive:e}=s;return`p-2.5 rounded-xl transition-all duration-200 border border-transparent relative ${e?"text-black dark:text-white bg-zinc-100 dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800":"text-zinc-500 hover:bg-zinc-50 dark:hover:bg-zinc-900"}`}var Re=Q();function ns(s){const e=(0,Re.c)(4);let a;e[0]!==s?({...a}=s,e[0]=s,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,t.jsx)(kn,{"data-slot":"alert-dialog",...a}),e[2]=a,e[3]=i):i=e[3],i}function yl(s){const e=(0,Re.c)(4);let a;e[0]!==s?({...a}=s,e[0]=s,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,t.jsx)(Qa,{"data-slot":"alert-dialog-portal",...a}),e[2]=a,e[3]=i):i=e[3],i}function zl(s){const e=(0,Re.c)(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=le("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,t.jsx)(Ni,{"data-slot":"alert-dialog-overlay",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function rs(s){const e=(0,Re.c)(9);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]===Symbol.for("react.memo_cache_sentinel")?(n=(0,t.jsx)(zl,{}),e[3]=n):n=e[3];let r;e[4]!==a?(r=le("bg-white dark:bg-zinc-950 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-2xl border border-zinc-100 dark:border-zinc-800 p-6 shadow-xl duration-200 sm:max-w-md",a),e[4]=a,e[5]=r):r=e[5];let l;return e[6]!==i||e[7]!==r?(l=(0,t.jsxs)(yl,{children:[n,(0,t.jsx)(Oi,{"data-slot":"alert-dialog-content","aria-describedby":void 0,className:r,...i})]}),e[6]=i,e[7]=r,e[8]=l):l=e[8],l}function ls(s){const e=(0,Re.c)(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=le("flex flex-col gap-2 text-center sm:text-left",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,t.jsx)("div",{"data-slot":"alert-dialog-header",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function os(s){const e=(0,Re.c)(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=le("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,t.jsx)("div",{"data-slot":"alert-dialog-footer",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function cs(s){const e=(0,Re.c)(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=le("text-lg font-semibold",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,t.jsx)(ki,{"data-slot":"alert-dialog-title",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function ds(s){const e=(0,Re.c)(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=le("text-muted-foreground text-sm",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,t.jsx)(Cn,{"data-slot":"alert-dialog-description",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function ms(s){const e=(0,Re.c)(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=le("inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-bold transition-all active:scale-95 bg-zinc-900 text-white hover:bg-zinc-800 dark:bg-white dark:text-black dark:hover:bg-zinc-200",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,t.jsx)(Nn,{className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function us(s){const e=(0,Re.c)(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=le("inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-bold border border-zinc-200 bg-white text-zinc-900 hover:bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-950 dark:text-zinc-50 dark:hover:bg-zinc-900",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,t.jsx)(Pn,{className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var Nl=Q(),kl=s=>{const e=(0,Nl.c)(12);let a,i,n,r;e[0]!==s?({children:a,variant:n,className:r,...i}=s,e[0]=s,e[1]=a,e[2]=i,e[3]=n,e[4]=r):(a=e[1],i=e[2],n=e[3],r=e[4]);const l=n===void 0?"primary":n,o=r===void 0?"":r;let c;e[5]===Symbol.for("react.memo_cache_sentinel")?(c={primary:"text-white hover:text-white bg-zinc-900 hover:bg-zinc-800 border border-zinc-900 dark:bg-white dark:text-black dark:border-white dark:hover:bg-zinc-200",secondary:"text-zinc-900 border border-zinc-300 hover:border-zinc-400 bg-transparent hover:bg-zinc-50 dark:text-white dark:border-zinc-700 dark:hover:border-zinc-600 dark:hover:bg-zinc-900",outline:"text-zinc-900 border border-zinc-300 hover:border-zinc-400 bg-white dark:bg-transparent dark:text-white dark:border-zinc-700 dark:hover:bg-zinc-900",danger:"text-white bg-red-500 hover:bg-red-600 border border-red-500",ghost:"text-zinc-500 hover:bg-zinc-100 dark:text-zinc-400 dark:hover:bg-zinc-800 border-transparent"},e[5]=c):c=e[5];const u=`rounded-full font-bold inline-flex items-center justify-center relative overflow-hidden px-4 py-1.5 transition-all duration-200 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:active:scale-100 touch-manipulation ${c[l]} ${o}`;let d;e[6]!==a?(d=(0,t.jsx)("div",{className:"flex items-center gap-x-1.5",children:a}),e[6]=a,e[7]=d):d=e[7];let m;return e[8]!==i||e[9]!==u||e[10]!==d?(m=(0,t.jsx)("button",{className:u,...i,children:d}),e[8]=i,e[9]=u,e[10]=d,e[11]=m):m=e[11],m},xe=kl,rt=Q();function _l(s){const e=(0,rt.c)(4);let a;e[0]!==s?({...a}=s,e[0]=s,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,t.jsx)(Xi,{"data-slot":"context-menu",...a}),e[2]=a,e[3]=i):i=e[3],i}function Cl(s){const e=(0,rt.c)(4);let a;e[0]!==s?({...a}=s,e[0]=s,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,t.jsx)(Ri,{"data-slot":"context-menu-trigger",...a}),e[2]=a,e[3]=i):i=e[3],i}function Sl(s){const e=(0,rt.c)(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=le("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,t.jsx)(rn,{children:(0,t.jsx)(Bi,{"data-slot":"context-menu-content",className:n,...i})}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function Et(s){const e=(0,rt.c)(12);let a,i,n,r;e[0]!==s?({className:a,inset:i,variant:r,...n}=s,e[0]=s,e[1]=a,e[2]=i,e[3]=n,e[4]=r):(a=e[1],i=e[2],n=e[3],r=e[4]);const l=r===void 0?"default":r;let o;e[5]!==a?(o=le("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),e[5]=a,e[6]=o):o=e[6];let c;return e[7]!==i||e[8]!==n||e[9]!==o||e[10]!==l?(c=(0,t.jsx)(Hi,{"data-slot":"context-menu-item","data-inset":i,"data-variant":l,className:o,...n}),e[7]=i,e[8]=n,e[9]=o,e[10]=l,e[11]=c):c=e[11],c}function Pl(s){const e=(0,rt.c)(10);let a,i,n;e[0]!==s?({className:a,inset:i,...n}=s,e[0]=s,e[1]=a,e[2]=i,e[3]=n):(a=e[1],i=e[2],n=e[3]);let r;e[4]!==a?(r=le("text-foreground px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",a),e[4]=a,e[5]=r):r=e[5];let l;return e[6]!==i||e[7]!==n||e[8]!==r?(l=(0,t.jsx)(un,{"data-slot":"context-menu-label","data-inset":i,className:r,...n}),e[6]=i,e[7]=n,e[8]=r,e[9]=l):l=e[9],l}function fs(s){const e=(0,rt.c)(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=le("bg-border -mx-1 my-1 h-px",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,t.jsx)(Ki,{"data-slot":"context-menu-separator",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var He=Q();function ha(s){const e=(0,He.c)(4);let a;e[0]!==s?({...a}=s,e[0]=s,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,t.jsx)(Ba,{"data-slot":"dialog",...a}),e[2]=a,e[3]=i):i=e[3],i}function $l(s){const e=(0,He.c)(4);let a;e[0]!==s?({...a}=s,e[0]=s,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,t.jsx)(sn,{"data-slot":"dialog-portal",...a}),e[2]=a,e[3]=i):i=e[3],i}function Al(s){const e=(0,He.c)(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=le("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,t.jsx)(bi,{"data-slot":"dialog-overlay",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function pa(s){const e=(0,He.c)(11);let a,i,n;e[0]!==s?({className:i,children:a,...n}=s,e[0]=s,e[1]=a,e[2]=i,e[3]=n):(a=e[1],i=e[2],n=e[3]);let r;e[4]===Symbol.for("react.memo_cache_sentinel")?(r=(0,t.jsx)(Al,{}),e[4]=r):r=e[4];let l;e[5]!==i?(l=le("bg-white dark:bg-zinc-950 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-2xl border border-zinc-100 dark:border-zinc-800 p-6 shadow-xl duration-200 sm:max-w-md",i),e[5]=i,e[6]=l):l=e[6];let o;return e[7]!==a||e[8]!==n||e[9]!==l?(o=(0,t.jsxs)($l,{children:[r,(0,t.jsx)(Xa,{"data-slot":"alert-dialog-content","aria-describedby":void 0,className:l,...n,children:a})]}),e[7]=a,e[8]=n,e[9]=l,e[10]=o):o=e[10],o}function ba(s){const e=(0,He.c)(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=le("flex flex-col gap-2 text-center sm:text-left",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,t.jsx)("div",{"data-slot":"dialog-header",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function ga(s){const e=(0,He.c)(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=le("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,t.jsx)("div",{"data-slot":"dialog-footer",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function va(s){const e=(0,He.c)(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=le("text-lg leading-none font-semibold",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,t.jsx)(en,{"data-slot":"dialog-title",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function Ml(s){const e=(0,He.c)(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=le("text-muted-foreground text-sm",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,t.jsx)(Ka,{"data-slot":"dialog-description",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var bt=Q();function ja(s){const e=(0,bt.c)(4);let a;e[0]!==s?({...a}=s,e[0]=s,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,t.jsx)(Wi,{"data-slot":"dropdown-menu",...a}),e[2]=a,e[3]=i):i=e[3],i}function wa(s){const e=(0,bt.c)(4);let a;e[0]!==s?({...a}=s,e[0]=s,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,t.jsx)(zn,{"data-slot":"dropdown-menu-trigger",...a}),e[2]=a,e[3]=i):i=e[3],i}function ya(s){const e=(0,bt.c)(10);let a,i,n;e[0]!==s?({className:a,sideOffset:n,...i}=s,e[0]=s,e[1]=a,e[2]=i,e[3]=n):(a=e[1],i=e[2],n=e[3]);const r=n===void 0?4:n;let l;e[4]!==a?(l=le("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",a),e[4]=a,e[5]=l):l=e[5];let o;return e[6]!==i||e[7]!==r||e[8]!==l?(o=(0,t.jsx)(gn,{children:(0,t.jsx)(Li,{"data-slot":"dropdown-menu-content",sideOffset:r,className:l,...i})}),e[6]=i,e[7]=r,e[8]=l,e[9]=o):o=e[9],o}function Ge(s){const e=(0,bt.c)(12);let a,i,n,r;e[0]!==s?({className:a,inset:i,variant:r,...n}=s,e[0]=s,e[1]=a,e[2]=i,e[3]=n,e[4]=r):(a=e[1],i=e[2],n=e[3],r=e[4]);const l=r===void 0?"default":r;let o;e[5]!==a?(o=le("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),e[5]=a,e[6]=o):o=e[6];let c;return e[7]!==i||e[8]!==n||e[9]!==o||e[10]!==l?(c=(0,t.jsx)(dn,{"data-slot":"dropdown-menu-item","data-inset":i,"data-variant":l,className:o,...n}),e[7]=i,e[8]=n,e[9]=o,e[10]=l,e[11]=c):c=e[11],c}function Fl(s){const e=(0,bt.c)(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=le("bg-border -mx-1 my-1 h-px",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,t.jsx)(nn,{"data-slot":"dropdown-menu-separator",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var El=Q(),Rl=s=>{const e=(0,El.c)(10),{onEmojiSelect:a,className:i}=s;let n;e[0]!==i?(n=le("isolate flex h-[350px] w-[320px] flex-col overflow-hidden rounded-xl border border-zinc-200 bg-white shadow-xl dark:border-zinc-800 dark:bg-zinc-950",i),e[0]=i,e[1]=n):n=e[1];let r;e[2]===Symbol.for("react.memo_cache_sentinel")?(r=(0,t.jsx)(Ye.Search,{className:"z-10 mx-3 mt-3 appearance-none rounded-lg border-none bg-zinc-100 px-3 py-2 text-sm outline-none placeholder:text-zinc-500 focus:ring-1 focus:ring-violet-500 dark:bg-zinc-900 dark:text-white",placeholder:"Search emojis..."}),e[2]=r):r=e[2];let l,o;e[3]===Symbol.for("react.memo_cache_sentinel")?(l=(0,t.jsx)(Ye.Loading,{className:"absolute inset-0 flex items-center justify-center text-zinc-400 text-sm dark:text-zinc-500",children:"Loading"}),o=(0,t.jsx)(Ye.Empty,{className:"absolute inset-0 flex items-center justify-center text-zinc-400 text-sm dark:text-zinc-500",children:"No emoji found."}),e[3]=l,e[4]=o):(l=e[3],o=e[4]);let c,u;e[5]===Symbol.for("react.memo_cache_sentinel")?(c=(0,t.jsxs)(Ye.Viewport,{className:"relative flex-1 outline-none no-scrollbar",children:[l,o,(0,t.jsx)(Ye.List,{className:"select-none pb-2",components:{CategoryHeader:Ll,Row:Tl,Emoji:Dl}})]}),u=(0,t.jsx)(Ye.ActiveEmoji,{children:Ol}),e[5]=c,e[6]=u):(c=e[5],u=e[6]);let d;return e[7]!==a||e[8]!==n?(d=(0,t.jsxs)(Ye.Root,{onEmojiSelect:a,className:n,children:[r,c,u]}),e[7]=a,e[8]=n,e[9]=d):d=e[9],d},Il=Rl;function Ll(s){const{category:e,...a}=s;return(0,t.jsx)("div",{className:"bg-white/80 px-4 pt-4 pb-1.5 font-bold text-zinc-500 text-[11px] uppercase tracking-wider backdrop-blur-sm dark:bg-zinc-950/80 dark:text-zinc-400",...a,children:e.label})}function Tl(s){const{children:e,...a}=s;return(0,t.jsx)("div",{className:"scroll-my-1 px-2",...a,children:e})}function Dl(s){const{emoji:e,...a}=s;return(0,t.jsx)("button",{className:"flex aspect-square size-9 items-center justify-center rounded-lg text-xl transition-colors hover:bg-zinc-100 data-[active]:bg-violet-500/10 data-[active]:text-violet-500 dark:hover:bg-zinc-900 dark:data-[active]:bg-violet-500/20",...a,children:e.emoji})}function Ol(s){const{emoji:e}=s;return(0,t.jsx)("div",{className:"flex items-center gap-3 border-t border-zinc-100 p-3 dark:border-zinc-800",children:e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"text-2xl",children:e.emoji}),(0,t.jsx)("span",{className:"text-xs font-bold text-zinc-600 dark:text-zinc-400 truncate",children:e.label.replace(/:/g,"").replace(/_/g," ")})]}):(0,t.jsx)("span",{className:"text-xs font-medium text-zinc-400",children:"Select an emoji..."})})}var ql=Q(),Wl=s=>{const e=(0,ql.c)(33),{src:a,isOpen:i,onClose:n,onCropComplete:r,aspect:l,circular:o}=s,[c,u]=(0,g.useState)(),[d,m]=(0,g.useState)(null),f=(0,g.useRef)(null);let p;e[0]!==l?(p=R=>{const{width:E,height:I}=R.currentTarget;u(l?on(jn({unit:"%",width:100},l,E,I),E,I):{unit:"%",width:100,height:100,x:0,y:0})},e[0]=l,e[1]=p):p=e[1];const x=p;let h;e[2]!==d||e[3]!==n||e[4]!==r?(h=async()=>{if(d&&f.current)try{r(await Jn(f.current,d)),n()}catch(R){console.error("Error cropping image:",R)}},e[2]=d,e[3]=n,e[4]=r,e[5]=h):h=e[5];const b=h;let v;e[6]!==n?(v=R=>!R&&n(),e[6]=n,e[7]=v):v=e[7];let j;e[8]===Symbol.for("react.memo_cache_sentinel")?(j=(0,t.jsx)(ba,{className:"p-4 shrink-0",children:(0,t.jsx)(va,{children:"Crop Image"})}),e[8]=j):j=e[8];let y,z;e[9]===Symbol.for("react.memo_cache_sentinel")?(y=R=>u(R),z=(R,E)=>m(E),e[9]=y,e[10]=z):(y=e[9],z=e[10]);let k;e[11]!==x||e[12]!==a?(k=(0,t.jsx)("img",{ref:f,src:a,alt:"Crop preview",onLoad:x,className:"max-h-[60vh] w-auto block"}),e[11]=x,e[12]=a,e[13]=k):k=e[13];let _;e[14]!==l||e[15]!==o||e[16]!==c||e[17]!==k?(_=(0,t.jsx)("div",{className:"p-6 flex items-center justify-center bg-zinc-100/50 dark:bg-zinc-950/50 min-h-[300px] max-h-[65vh] overflow-auto",children:(0,t.jsx)(pn,{crop:c,onChange:y,onComplete:z,aspect:l,circularCrop:o,className:"max-w-full shadow-2xl",children:k})}),e[14]=l,e[15]=o,e[16]=c,e[17]=k,e[18]=_):_=e[18];let $;e[19]!==n?($=(0,t.jsx)(xe,{variant:"outline",onClick:n,className:"!w-auto px-6",children:"Cancel"}),e[19]=n,e[20]=$):$=e[20];let A;e[21]!==b?(A=(0,t.jsx)(xe,{onClick:b,className:"!w-auto px-6",children:"Apply Crop"}),e[21]=b,e[22]=A):A=e[22];let S;e[23]!==A||e[24]!==$?(S=(0,t.jsxs)(ga,{className:"p-4 bg-white dark:bg-zinc-900 shrink-0 flex flex-row justify-end gap-2",children:[$,A]}),e[23]=A,e[24]=$,e[25]=S):S=e[25];let F;e[26]!==S||e[27]!==_?(F=(0,t.jsxs)(pa,{className:"sm:max-w-2xl bg-white dark:bg-zinc-900 p-0 overflow-hidden",children:[j,_,S]}),e[26]=S,e[27]=_,e[28]=F):F=e[28];let M;return e[29]!==i||e[30]!==F||e[31]!==v?(M=(0,t.jsx)(ha,{open:i,onOpenChange:v,children:F}),e[29]=i,e[30]=F,e[31]=v,e[32]=M):M=e[32],M},Ul=Wl,Bl=Q(),Vl=s=>{const e=(0,Bl.c)(105),{images:a,currentIndex:i,onClose:n,onNavigate:r}=s,l=i===void 0?0:i,[o,c]=(0,g.useState)(1);let u;e[0]===Symbol.for("react.memo_cache_sentinel")?(u={x:0,y:0},e[0]=u):u=e[0];const[d,m]=(0,g.useState)(u),[f,p]=(0,g.useState)(!1);let x;e[1]===Symbol.for("react.memo_cache_sentinel")?(x={x:0,y:0},e[1]=x):x=e[1];const[h,b]=(0,g.useState)(x),[v,j]=(0,g.useState)(null),[y,z]=(0,g.useState)(null),k=(0,g.useRef)(null),_=(0,g.useRef)(null);let $;e[2]===Symbol.for("react.memo_cache_sentinel")?($=()=>c(Ql),e[2]=$):$=e[2];const A=$;let S;e[3]===Symbol.for("react.memo_cache_sentinel")?(S=()=>{c(U=>{const ne=Math.max(U-.5,1);return ne===1&&m({x:0,y:0}),ne})},e[3]=S):S=e[3];const F=S;let M;e[4]===Symbol.for("react.memo_cache_sentinel")?(M=()=>{c(1),m({x:0,y:0})},e[4]=M):M=e[4];const R=M;let E;e[5]!==l||e[6]!==r?(E=()=>{l>0&&(R(),r(l-1))},e[5]=l,e[6]=r,e[7]=E):E=e[7];const I=E;let O;e[8]!==l||e[9]!==a?.length||e[10]!==r?(O=()=>{l<(a?.length||0)-1&&(R(),r(l+1))},e[8]=l,e[9]=a?.length,e[10]=r,e[11]=O):O=e[11],a?.length;const D=O;let P;e[12]!==D||e[13]!==I||e[14]!==n?(P=()=>{const U=ne=>{ne.key==="Escape"&&n(),ne.key==="ArrowLeft"&&I(),ne.key==="ArrowRight"&&D()};return window.addEventListener("keydown",U),()=>window.removeEventListener("keydown",U)},e[12]=D,e[13]=I,e[14]=n,e[15]=P):P=e[15];let C;if(e[16]!==l||e[17]!==D||e[18]!==I||e[19]!==n?(C=[l,n,I,D],e[16]=l,e[17]=D,e[18]=I,e[19]=n,e[20]=C):C=e[20],(0,g.useEffect)(P,C),!a||a.length===0)return null;const w=a[l],N=a.length>1;let L;e[21]!==d.x||e[22]!==d.y||e[23]!==o?(L=U=>{o>1&&(p(!0),b({x:U.clientX-d.x,y:U.clientY-d.y}))},e[21]=d.x,e[22]=d.y,e[23]=o,e[24]=L):L=e[24];const W=L;let T;e[25]!==h||e[26]!==f||e[27]!==o?(T=U=>{f&&o>1&&m({x:U.clientX-h.x,y:U.clientY-h.y})},e[25]=h,e[26]=f,e[27]=o,e[28]=T):T=e[28];const B=T;let H;e[29]===Symbol.for("react.memo_cache_sentinel")?(H=()=>p(!1),e[29]=H):H=e[29];const te=H;let re;e[30]!==d.x||e[31]!==d.y||e[32]!==o?(re=U=>{U.touches.length===1?(j({x:U.touches[0].clientX,y:U.touches[0].clientY,time:Date.now()}),o>1&&(p(!0),b({x:U.touches[0].clientX-d.x,y:U.touches[0].clientY-d.y}))):U.touches.length===2&&z(Math.hypot(U.touches[0].clientX-U.touches[1].clientX,U.touches[0].clientY-U.touches[1].clientY))},e[30]=d.x,e[31]=d.y,e[32]=o,e[33]=re):re=e[33];const ie=re;let oe;e[34]!==h||e[35]!==y||e[36]!==f||e[37]!==o?(oe=U=>{if(U.touches.length===1)f&&o>1&&m({x:U.touches[0].clientX-h.x,y:U.touches[0].clientY-h.y});else if(U.touches.length===2&&y){const ne=Math.hypot(U.touches[0].clientX-U.touches[1].clientX,U.touches[0].clientY-U.touches[1].clientY);c(Math.min(Math.max(o*(ne/y),1),4)),z(ne)}},e[34]=h,e[35]=y,e[36]=f,e[37]=o,e[38]=oe):oe=e[38];const G=oe;let ae;e[39]!==D||e[40]!==I||e[41]!==o||e[42]!==v?(ae=U=>{if(U.touches.length<2&&z(null),p(!1),v&&o===1){const ne={x:U.changedTouches[0].clientX,y:U.changedTouches[0].clientY},Me=ne.x-v.x,qe=ne.y-v.y,Ve=Date.now()-v.time;Math.abs(Me)>50&&Math.abs(qe)<50&&Ve<300&&(Me>0?I():D())}j(null)},e[39]=D,e[40]=I,e[41]=o,e[42]=v,e[43]=ae):ae=e[43];const V=ae;let J;e[44]!==w?(J=U=>{U.stopPropagation();const ne=document.createElement("a");ne.href=w,ne.download=`sysm-${Date.now()}.jpg`,document.body.appendChild(ne),ne.click(),document.body.removeChild(ne)},e[44]=w,e[45]=J):J=e[45];const K=J,ee=N?`${l+1} / ${a.length}`:"Image View";let X;e[46]!==ee?(X=(0,t.jsx)("div",{className:"flex flex-col",children:(0,t.jsx)("span",{className:"text-white font-bold text-lg drop-shadow-md",children:ee})}),e[46]=ee,e[47]=X):X=e[47];let de;e[48]===Symbol.for("react.memo_cache_sentinel")?(de=(0,t.jsx)("button",{onClick:F,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors hidden sm:block",children:(0,t.jsx)(ii,{size:20})}),e[48]=de):de=e[48];let Z;e[49]===Symbol.for("react.memo_cache_sentinel")?(Z=(0,t.jsx)("button",{onClick:A,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors hidden sm:block",children:(0,t.jsx)(di,{size:20})}),e[49]=Z):Z=e[49];let ue;e[50]===Symbol.for("react.memo_cache_sentinel")?(ue=(0,t.jsx)("button",{onClick:R,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors",children:(0,t.jsx)(Zi,{size:20})}),e[50]=ue):ue=e[50];let me;e[51]===Symbol.for("react.memo_cache_sentinel")?(me=(0,t.jsx)(Ss,{size:20}),e[51]=me):me=e[51];let fe;e[52]!==K?(fe=(0,t.jsx)("button",{onClick:K,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors",children:me}),e[52]=K,e[53]=fe):fe=e[53];let we;e[54]===Symbol.for("react.memo_cache_sentinel")?(we=(0,t.jsx)("div",{className:"w-px h-6 bg-white/20 mx-1 hidden sm:block"}),e[54]=we):we=e[54];let Ne;e[55]===Symbol.for("react.memo_cache_sentinel")?(Ne=(0,t.jsx)($e,{size:24}),e[55]=Ne):Ne=e[55];let he;e[56]!==n?(he=(0,t.jsx)("button",{onClick:n,className:"text-white p-2 bg-white/10 hover:bg-white/20 rounded-full transition-all",children:Ne}),e[56]=n,e[57]=he):he=e[57];let ye;e[58]!==fe||e[59]!==he?(ye=(0,t.jsxs)("div",{className:"flex items-center gap-1 sm:gap-3",onClick:Hl,children:[de,Z,ue,fe,we,he]}),e[58]=fe,e[59]=he,e[60]=ye):ye=e[60];let Ie;e[61]!==X||e[62]!==ye?(Ie=(0,t.jsxs)("div",{className:"absolute top-0 left-0 right-0 p-4 z-20 flex items-center justify-between bg-gradient-to-b from-black/60 to-transparent",children:[X,ye]}),e[61]=X,e[62]=ye,e[63]=Ie):Ie=e[63];let Se;e[64]!==l||e[65]!==I||e[66]!==N||e[67]!==o?(Se=N&&l>0&&o===1&&(0,t.jsx)("button",{onClick:U=>{U.stopPropagation(),I()},className:"absolute left-6 z-10 p-4 bg-white/5 hover:bg-white/10 rounded-full text-white backdrop-blur-sm transition-all active:scale-90 hidden md:flex",children:(0,t.jsx)(Is,{size:32})}),e[64]=l,e[65]=I,e[66]=N,e[67]=o,e[68]=Se):Se=e[68];const lt=`translate(${d.x}px, ${d.y}px) scale(${o})`;let Ue;e[69]!==lt?(Ue={transform:lt},e[69]=lt,e[70]=Ue):Ue=e[70];let Le;e[71]!==w?(Le=(0,t.jsx)("img",{ref:_,src:w,className:"max-w-[95vw] max-h-[85vh] object-contain select-none shadow-2xl rounded-sm",alt:"",draggable:!1}),e[71]=w,e[72]=Le):Le=e[72];let Te;e[73]!==W||e[74]!==Ue||e[75]!==Le?(Te=(0,t.jsx)("div",{className:"relative transition-transform duration-200 ease-out cursor-grab active:cursor-grabbing",style:Ue,onMouseDown:W,onClick:Kl,children:Le}),e[73]=W,e[74]=Ue,e[75]=Le,e[76]=Te):Te=e[76];let De;e[77]!==l||e[78]!==D||e[79]!==N||e[80]!==a.length||e[81]!==o?(De=N&&l<a.length-1&&o===1&&(0,t.jsx)("button",{onClick:U=>{U.stopPropagation(),D()},className:"absolute right-6 z-10 p-4 bg-white/5 hover:bg-white/10 rounded-full text-white backdrop-blur-sm transition-all active:scale-90 hidden md:flex",children:(0,t.jsx)(Xe,{size:32})}),e[77]=l,e[78]=D,e[79]=N,e[80]=a.length,e[81]=o,e[82]=De):De=e[82];let Oe;e[83]!==Se||e[84]!==Te||e[85]!==De?(Oe=(0,t.jsxs)("div",{className:"w-full h-full relative flex items-center justify-center",children:[Se,Te,De]}),e[83]=Se,e[84]=Te,e[85]=De,e[86]=Oe):Oe=e[86];let Be;e[87]!==l||e[88]!==N||e[89]!==a||e[90]!==r?(Be=N&&(0,t.jsx)("div",{className:"absolute bottom-8 flex gap-3 p-3 bg-black/40 backdrop-blur-xl rounded-2xl border border-white/10 overflow-x-auto max-w-[90%] hide-scrollbar",onClick:Yl,children:a.map((U,ne)=>(0,t.jsx)("button",{onClick:()=>{R(),r(ne)},className:`size-14 rounded-xl overflow-hidden border-2 transition-all shrink-0 ${ne===l?"border-violet-500 scale-110 shadow-lg shadow-violet-500/20":"border-transparent opacity-40 hover:opacity-100"}`,children:(0,t.jsx)("img",{src:U,className:"size-full object-cover",alt:""})},ne))}),e[87]=l,e[88]=N,e[89]=a,e[90]=r,e[91]=Be):Be=e[91];let Y;e[92]!==N||e[93]!==o?(Y=o===1&&N&&(0,t.jsx)("div",{className:"absolute bottom-4 text-white/30 text-[10px] uppercase tracking-widest font-bold md:hidden",children:"Swipe to navigate"}),e[92]=N,e[93]=o,e[94]=Y):Y=e[94];let se;return e[95]!==B||e[96]!==V||e[97]!==G||e[98]!==ie||e[99]!==n||e[100]!==Ie||e[101]!==Oe||e[102]!==Be||e[103]!==Y?(se=(0,t.jsxs)("div",{ref:k,className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-md flex flex-col items-center justify-center overflow-hidden touch-none",onMouseMove:B,onMouseUp:te,onMouseLeave:te,onTouchStart:ie,onTouchMove:G,onTouchEnd:V,onClick:n,children:[Ie,Oe,Be,Y]}),e[95]=B,e[96]=V,e[97]=G,e[98]=ie,e[99]=n,e[100]=Ie,e[101]=Oe,e[102]=Be,e[103]=Y,e[104]=se):se=e[104],se},Jl=Vl;function Ql(s){return Math.min(s+.5,4)}function Hl(s){return s.stopPropagation()}function Kl(s){return s.stopPropagation()}function Yl(s){return s.stopPropagation()}var Xl=Q(),za=g.forwardRef((s,e)=>{const a=(0,Xl.c)(20);let i,n,r,l,o;a[0]!==s?({className:i,label:n,type:o,textarea:l,...r}=s,a[0]=s,a[1]=i,a[2]=n,a[3]=r,a[4]=l,a[5]=o):(i=a[1],n=a[2],r=a[3],l=a[4],o=a[5]);const c=l?"textarea":"input";let u;a[6]!==n?(u=n&&(0,t.jsx)("label",{className:"text-sm font-bold text-zinc-500 dark:text-zinc-400 ml-1",children:n}),a[6]=n,a[7]=u):u=a[7];const d=l&&"min-h-[100px] resize-none";let m;a[8]!==i||a[9]!==d?(m=le("flex w-full rounded-xl border border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900 px-4 py-2.5 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-zinc-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:ring-offset-zinc-950 dark:text-white transition-all",d,i),a[8]=i,a[9]=d,a[10]=m):m=a[10];let f;a[11]!==c||a[12]!==r||a[13]!==e||a[14]!==m||a[15]!==o?(f=(0,t.jsx)(c,{type:o,className:m,ref:e,...r}),a[11]=c,a[12]=r,a[13]=e,a[14]=m,a[15]=o,a[16]=f):f=a[16];let p;return a[17]!==u||a[18]!==f?(p=(0,t.jsxs)("div",{className:"w-full space-y-1.5",children:[u,f]}),a[17]=u,a[18]=f,a[19]=p):p=a[19],p});za.displayName="Input";var Fe=za,Zl=Q(),Gl=s=>{const e=(0,Zl.c)(20),{isOpen:a,onClose:i,title:n,children:r,footer:l,description:o,className:c}=s;let u;e[0]!==i?(u=v=>{v||i()},e[0]=i,e[1]=u):u=e[1];const d=u;let m;e[2]!==c?(m=le("sm:max-w-md max-h-[calc(100dvh-2rem)] flex flex-col p-0 gap-0 overflow-hidden bg-white dark:bg-zinc-900",c),e[2]=c,e[3]=m):m=e[3];let f;e[4]!==o||e[5]!==n?(f=n&&(0,t.jsxs)(ba,{className:"px-5 py-4 shrink-0",children:[(0,t.jsx)(va,{className:"text-xl font-bold",children:n}),o&&(0,t.jsx)(Ml,{children:o})]}),e[4]=o,e[5]=n,e[6]=f):f=e[6];let p;e[7]!==r?(p=(0,t.jsx)("div",{className:"flex-1 overflow-y-auto p-5 min-h-0",children:r}),e[7]=r,e[8]=p):p=e[8];let x;e[9]!==l?(x=l&&(0,t.jsx)(ga,{className:"px-5 py-4 shrink-0 bg-white dark:bg-zinc-900",children:l}),e[9]=l,e[10]=x):x=e[10];let h;e[11]!==m||e[12]!==f||e[13]!==p||e[14]!==x?(h=(0,t.jsxs)(pa,{className:m,children:[f,p,x]}),e[11]=m,e[12]=f,e[13]=p,e[14]=x,e[15]=h):h=e[15];let b;return e[16]!==d||e[17]!==a||e[18]!==h?(b=(0,t.jsx)(ha,{open:a,onOpenChange:d,children:h}),e[16]=d,e[17]=a,e[18]=h,e[19]=b):b=e[19],b},Ke=Gl,eo=Q(),to=s=>{const e=(0,eo.c)(20),{title:a,message:i,icon:n,showHome:r,showBack:l}=s,o=a===void 0?"Not Found":a,c=i===void 0?"The content you are looking for doesn't exist or has been removed.":i,u=n===void 0?zs:n,d=r===void 0?!0:r,m=l===void 0?!0:l,f=je(),p=u;let x;e[0]!==p?(x=(0,t.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-900 p-6 rounded-full mb-6",children:(0,t.jsx)(p,{size:48,className:"text-zinc-400 dark:text-zinc-600"})}),e[0]=p,e[1]=x):x=e[1];let h;e[2]!==o?(h=(0,t.jsx)("h2",{className:"text-2xl font-black mb-2 dark:text-white",children:o}),e[2]=o,e[3]=h):h=e[3];let b;e[4]!==c?(b=(0,t.jsx)("p",{className:"text-zinc-500 dark:text-zinc-400 max-w-xs mb-8 leading-relaxed",children:c}),e[4]=c,e[5]=b):b=e[5];let v;e[6]!==f||e[7]!==m?(v=m&&(0,t.jsxs)(xe,{variant:"secondary",onClick:()=>f(-1),className:"rounded-full px-6",children:[(0,t.jsx)(tt,{size:18,className:"mr-2"}),"Go Back"]}),e[6]=f,e[7]=m,e[8]=v):v=e[8];let j;e[9]!==f||e[10]!==d?(j=d&&(0,t.jsxs)(xe,{onClick:()=>f("/"),className:"bg-zinc-900 dark:bg-white text-white dark:text-zinc-900 rounded-full px-6",children:[(0,t.jsx)(Ut,{size:18,className:"mr-2"}),"Home"]}),e[9]=f,e[10]=d,e[11]=j):j=e[11];let y;e[12]!==j||e[13]!==v?(y=(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-center gap-3",children:[v,j]}),e[12]=j,e[13]=v,e[14]=y):y=e[14];let z;return e[15]!==y||e[16]!==x||e[17]!==h||e[18]!==b?(z=(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[400px] p-8 text-center animate-in fade-in zoom-in-95 duration-300",children:[x,h,b,y]}),e[15]=y,e[16]=x,e[17]=h,e[18]=b,e[19]=z):z=e[19],z},Kt=to,Yt=Q();function Na(s){const e=(0,Yt.c)(4);let a;e[0]!==s?({...a}=s,e[0]=s,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,t.jsx)(Da,{"data-slot":"popover",...a}),e[2]=a,e[3]=i):i=e[3],i}function ka(s){const e=(0,Yt.c)(4);let a;e[0]!==s?({...a}=s,e[0]=s,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,t.jsx)(Ji,{"data-slot":"popover-trigger",...a}),e[2]=a,e[3]=i):i=e[3],i}function _a(s){const e=(0,Yt.c)(12);let a,i,n,r;e[0]!==s?({className:a,align:n,sideOffset:r,...i}=s,e[0]=s,e[1]=a,e[2]=i,e[3]=n,e[4]=r):(a=e[1],i=e[2],n=e[3],r=e[4]);const l=n===void 0?"center":n,o=r===void 0?4:r;let c;e[5]!==a?(c=le("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 rounded-md border p-4 shadow-md outline-hidden",a),e[5]=a,e[6]=c):c=e[6];let u;return e[7]!==l||e[8]!==i||e[9]!==o||e[10]!==c?(u=(0,t.jsx)(ji,{children:(0,t.jsx)(Fi,{"data-slot":"popover-content",align:l,sideOffset:o,className:c,...i})}),e[7]=l,e[8]=i,e[9]=o,e[10]=c,e[11]=u):u=e[11],u}var so=Q(),ao=()=>{const s=(0,so.c)(1);let e;return s[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,t.jsx)(Ai,{size:16,className:"fill-blue-500 text-white ml-1 inline-block shrink-0"}),s[0]=e):e=s[0],e},dt=ao;const Ca=(s,e,a)=>{const i=s?.id,[n,r]=(0,g.useState)(!1),[l,o]=(0,g.useState)({followers:s?.followers||s?.follower_count||0,following:s?.following||s?.following_count||0}),[c,u]=(0,g.useState)(!1);return(0,g.useEffect)(()=>{s&&(o({followers:s.followers||s.follower_count||0,following:s.following||s.following_count||0}),i&&Pe(i)&&(tr(i).then(m=>{m&&o({followers:m.followers,following:m.following})}).catch(()=>{}),e&&Pe(e)?Gs(e,i).then(r).catch(()=>r(!1)):r(!1)))},[s,i,e]),{isFollowing:n,stats:l,loading:c,handleFollow:async()=>{if(!e)return a("Please login to follow!","error");if(e===i)return a("You cannot follow yourself!","error");if(!i||!Pe(i)||!Pe(e)){const m=!n;r(m),o(f=>{const p=typeof f.followers=="string"?parseInt(f.followers.replace(/,/g,"")):f.followers||0;return{...f,followers:m?p+1:Math.max(0,p-1)}}),a(m?"Followed":"Unfollowed");return}u(!0);try{const m=await Zs(e,i);r(m),o(f=>({...f,followers:m?(f.followers||0)+1:Math.max(0,(f.followers||0)-1)})),a(m?"Followed":"Unfollowed")}catch(m){console.error("Failed to toggle follow:",m),a("Failed to update follow status","error")}finally{u(!1)}},setStats:o}};var io=({profile:s,onUserClick:e,isCommunity:a=!1})=>{const{onlineUsers:i}=oa(),{currentUser:n}=pe(),{addToast:r}=ze(),l=i.has(s.id),[o,c]=(0,g.useState)(!1),[u,d]=(0,g.useState)(a),{isFollowing:m,loading:f,handleFollow:p}=Ca(a?null:s,n?.id,r);(0,g.useEffect)(()=>{a&&n&&s.id?na(s.id,n.id).then(c).finally(()=>d(!1)):d(!1)},[a,n,s.id]);const x=async v=>{if(v.stopPropagation(),!n)return r("Please login to join communities","error");d(!0);try{const j=await ia(s.id,n.id);c(j),r(j?`Joined ${s.name}`:`Left ${s.name}`)}catch{r("Failed to update membership","error")}finally{d(!1)}},h=n?.id===s.id,b=a?u:f;return(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-zinc-100 dark:border-zinc-800 hover:bg-zinc-50 dark:hover:bg-zinc-900/40 transition-colors group cursor-pointer",onClick:()=>e(s.handle),children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)(be,{className:`size-12 border border-zinc-200 dark:border-zinc-800 shadow-sm ${a?"rounded-2xl":""}`,children:[(0,t.jsx)(ge,{src:s.avatar,alt:s.handle,className:"object-cover"}),(0,t.jsx)(ve,{className:a?"rounded-2xl":"",children:s.handle?.[0]?.toUpperCase()})]}),l&&!a&&(0,t.jsx)("span",{className:"absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full shadow-sm"})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white leading-none",children:s.name}),s.verified&&(0,t.jsx)(dt,{})]}),(0,t.jsxs)("span",{className:"text-sm text-zinc-500 mt-0.5",children:["@",s.handle]}),a&&(0,t.jsxs)("span",{className:"text-xs text-zinc-400 mt-1",children:[s.membersCount||0," members"]}),!a&&s.followers&&(0,t.jsxs)("span",{className:"text-xs text-zinc-400 mt-1",children:[s.followers," followers"]})]})]}),!h&&(0,t.jsx)(xe,{variant:a?o?"secondary":"outline":m?"secondary":"outline",className:"!w-auto !py-1.5 !px-4 text-sm font-bold rounded-full border-zinc-200 dark:border-zinc-700 hover:bg-zinc-100 dark:hover:bg-zinc-800",onClick:a?x:v=>{v.stopPropagation(),p()},disabled:b,children:b?(0,t.jsx)(ce,{size:14,className:"animate-spin"}):a?o?"Joined":"Join":m?"Following":"Follow"})]})},Sa=io,Pa=Q();function xs(s){const e=(0,Pa.c)(14);let a,i,n;e[0]!==s?({className:i,children:a,...n}=s,e[0]=s,e[1]=a,e[2]=i,e[3]=n):(a=e[1],i=e[2],n=e[3]);let r;e[4]!==i?(r=le("relative",i),e[4]=i,e[5]=r):r=e[5];let l;e[6]!==a?(l=(0,t.jsx)($i,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:a}),e[6]=a,e[7]=l):l=e[7];let o,c;e[8]===Symbol.for("react.memo_cache_sentinel")?(o=(0,t.jsx)(qt,{}),c=(0,t.jsx)(ri,{}),e[8]=o,e[9]=c):(o=e[8],c=e[9]);let u;return e[10]!==n||e[11]!==r||e[12]!==l?(u=(0,t.jsxs)(fn,{"data-slot":"scroll-area",className:r,...n,children:[l,o,c]}),e[10]=n,e[11]=r,e[12]=l,e[13]=u):u=e[13],u}function qt(s){const e=(0,Pa.c)(13);let a,i,n;e[0]!==s?({className:a,orientation:n,...i}=s,e[0]=s,e[1]=a,e[2]=i,e[3]=n):(a=e[1],i=e[2],n=e[3]);const r=n===void 0?"vertical":n,l=r==="vertical"&&"h-full w-2.5 border-l border-l-transparent",o=r==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent";let c;e[4]!==a||e[5]!==l||e[6]!==o?(c=le("flex touch-none p-px transition-colors select-none",l,o,a),e[4]=a,e[5]=l,e[6]=o,e[7]=c):c=e[7];let u;e[8]===Symbol.for("react.memo_cache_sentinel")?(u=(0,t.jsx)(Mi,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"}),e[8]=u):u=e[8];let d;return e[9]!==r||e[10]!==i||e[11]!==c?(d=(0,t.jsx)(ni,{"data-slot":"scroll-area-scrollbar",orientation:r,className:c,...i,children:u}),e[9]=r,e[10]=i,e[11]=c,e[12]=d):d=e[12],d}var no=Q(),ro=s=>{const e=(0,no.c)(13),{value:a,onChange:i,onClear:n,placeholder:r}=s,l=r===void 0?"Search...":r;let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=(0,t.jsx)(Bt,{size:18,className:"absolute left-4 top-1/2 -translate-y-1/2 text-zinc-400 group-focus-within:text-violet-500 transition-colors"}),e[0]=o):o=e[0];let c;e[1]!==i?(c=f=>i(f.target.value),e[1]=i,e[2]=c):c=e[2];let u;e[3]!==l||e[4]!==c||e[5]!==a?(u=(0,t.jsx)("input",{className:"w-full rounded-full border border-zinc-100 dark:border-zinc-800 bg-zinc-50 dark:bg-zinc-900/50 text-zinc-900 dark:text-white px-11 py-2.5 text-sm outline-none focus:border-violet-500 focus:ring-1 focus:ring-violet-500 transition-all",placeholder:l,value:a,onChange:c}),e[3]=l,e[4]=c,e[5]=a,e[6]=u):u=e[6];let d;e[7]!==n||e[8]!==a?(d=a&&(0,t.jsx)("button",{onClick:n,className:"absolute right-4 top-1/2 -translate-y-1/2 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 transition-colors",children:(0,t.jsx)($e,{size:16})}),e[7]=n,e[8]=a,e[9]=d):d=e[9];let m;return e[10]!==u||e[11]!==d?(m=(0,t.jsxs)("div",{className:"relative group w-full",children:[o,u,d]}),e[10]=u,e[11]=d,e[12]=m):m=e[12],m},kt=ro,st=Q(),lo=$n;var oo=Si,$a=g.forwardRef((s,e)=>{const a=(0,st.c)(12);let i,n,r;a[0]!==s?({className:n,children:i,...r}=s,a[0]=s,a[1]=i,a[2]=n,a[3]=r):(i=a[1],n=a[2],r=a[3]);let l;a[4]!==n?(l=le("flex h-9 w-full items-center justify-between rounded-md border border-zinc-200 bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-white placeholder:text-zinc-500 focus:outline-none focus:ring-1 focus:ring-zinc-950 disabled:cursor-not-allowed disabled:opacity-50 dark:border-zinc-800 dark:ring-offset-zinc-950 dark:focus:ring-zinc-300 [&>span]:line-clamp-1",n),a[4]=n,a[5]=l):l=a[5];let o;a[6]===Symbol.for("react.memo_cache_sentinel")?(o=(0,t.jsx)(xi,{asChild:!0,children:(0,t.jsx)(Ts,{className:"h-4 w-4 opacity-50"})}),a[6]=o):o=a[6];let c;return a[7]!==i||a[8]!==r||a[9]!==e||a[10]!==l?(c=(0,t.jsxs)(Rs,{ref:e,className:l,...r,children:[i,o]}),a[7]=i,a[8]=r,a[9]=e,a[10]=l,a[11]=c):c=a[11],c});$a.displayName=Rs.displayName;var Aa=g.forwardRef((s,e)=>{const a=(0,st.c)(10);let i,n;a[0]!==s?({className:i,...n}=s,a[0]=s,a[1]=i,a[2]=n):(i=a[1],n=a[2]);let r;a[3]!==i?(r=le("flex cursor-default items-center justify-center py-1",i),a[3]=i,a[4]=r):r=a[4];let l;a[5]===Symbol.for("react.memo_cache_sentinel")?(l=(0,t.jsx)(_i,{className:"h-4 w-4"}),a[5]=l):l=a[5];let o;return a[6]!==n||a[7]!==e||a[8]!==r?(o=(0,t.jsx)(Ls,{ref:e,className:r,...n,children:l}),a[6]=n,a[7]=e,a[8]=r,a[9]=o):o=a[9],o});Aa.displayName=Ls.displayName;var Ma=g.forwardRef((s,e)=>{const a=(0,st.c)(10);let i,n;a[0]!==s?({className:i,...n}=s,a[0]=s,a[1]=i,a[2]=n):(i=a[1],n=a[2]);let r;a[3]!==i?(r=le("flex cursor-default items-center justify-center py-1",i),a[3]=i,a[4]=r):r=a[4];let l;a[5]===Symbol.for("react.memo_cache_sentinel")?(l=(0,t.jsx)(Ts,{className:"h-4 w-4"}),a[5]=l):l=a[5];let o;return a[6]!==n||a[7]!==e||a[8]!==r?(o=(0,t.jsx)(ys,{ref:e,className:r,...n,children:l}),a[6]=n,a[7]=e,a[8]=r,a[9]=o):o=a[9],o});Ma.displayName=ys.displayName;var Fa=g.forwardRef((s,e)=>{const a=(0,st.c)(21);let i,n,r,l;a[0]!==s?({className:n,children:i,position:l,...r}=s,a[0]=s,a[1]=i,a[2]=n,a[3]=r,a[4]=l):(i=a[1],n=a[2],r=a[3],l=a[4]);const o=l===void 0?"popper":l,c=o==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1";let u;a[5]!==n||a[6]!==c?(u=le("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-zinc-200 bg-white text-zinc-950 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-zinc-800 dark:bg-zinc-950 dark:text-zinc-50",c,n),a[5]=n,a[6]=c,a[7]=u):u=a[7];let d;a[8]===Symbol.for("react.memo_cache_sentinel")?(d=(0,t.jsx)(Aa,{}),a[8]=d):d=a[8];const m=o==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]";let f;a[9]!==m?(f=le("p-1",m),a[9]=m,a[10]=f):f=a[10];let p;a[11]!==i||a[12]!==f?(p=(0,t.jsx)(ei,{className:f,children:i}),a[11]=i,a[12]=f,a[13]=p):p=a[13];let x;a[14]===Symbol.for("react.memo_cache_sentinel")?(x=(0,t.jsx)(Ma,{}),a[14]=x):x=a[14];let h;return a[15]!==o||a[16]!==r||a[17]!==e||a[18]!==u||a[19]!==p?(h=(0,t.jsx)(yi,{children:(0,t.jsxs)(Us,{ref:e,className:u,position:o,...r,children:[d,p,x]})}),a[15]=o,a[16]=r,a[17]=e,a[18]=u,a[19]=p,a[20]=h):h=a[20],h});Fa.displayName=Us.displayName;var co=g.forwardRef((s,e)=>{const a=(0,st.c)(9);let i,n;a[0]!==s?({className:i,...n}=s,a[0]=s,a[1]=i,a[2]=n):(i=a[1],n=a[2]);let r;a[3]!==i?(r=le("px-2 py-1.5 text-sm font-semibold",i),a[3]=i,a[4]=r):r=a[4];let l;return a[5]!==n||a[6]!==e||a[7]!==r?(l=(0,t.jsx)(Cs,{ref:e,className:r,...n}),a[5]=n,a[6]=e,a[7]=r,a[8]=l):l=a[8],l});co.displayName=Cs.displayName;var jt=g.forwardRef((s,e)=>{const a=(0,st.c)(14);let i,n,r;a[0]!==s?({className:n,children:i,...r}=s,a[0]=s,a[1]=i,a[2]=n,a[3]=r):(i=a[1],n=a[2],r=a[3]);let l;a[4]!==n?(l=le("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-zinc-100 focus:text-zinc-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-zinc-800 dark:focus:text-zinc-50",n),a[4]=n,a[5]=l):l=a[5];let o;a[6]===Symbol.for("react.memo_cache_sentinel")?(o=(0,t.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(Za,{children:(0,t.jsx)(Ns,{className:"h-4 w-4"})})}),a[6]=o):o=a[6];let c;a[7]!==i?(c=(0,t.jsx)(ti,{children:i}),a[7]=i,a[8]=c):c=a[8];let u;return a[9]!==r||a[10]!==e||a[11]!==l||a[12]!==c?(u=(0,t.jsxs)(As,{ref:e,className:l,...r,children:[o,c]}),a[9]=r,a[10]=e,a[11]=l,a[12]=c,a[13]=u):u=a[13],u});jt.displayName=As.displayName;var mo=g.forwardRef((s,e)=>{const a=(0,st.c)(9);let i,n;a[0]!==s?({className:i,...n}=s,a[0]=s,a[1]=i,a[2]=n):(i=a[1],n=a[2]);let r;a[3]!==i?(r=le("-mx-1 my-1 h-px bg-zinc-100 dark:bg-zinc-800",i),a[3]=i,a[4]=r):r=a[4];let l;return a[5]!==n||a[6]!==e||a[7]!==r?(l=(0,t.jsx)(_s,{ref:e,className:r,...n}),a[5]=n,a[6]=e,a[7]=r,a[8]=l):l=a[8],l});mo.displayName=_s.displayName;var uo=Q(),fo=s=>{const e=(0,uo.c)(9),{className:a}=s,{setAuthMode:i}=pe();let n;e[0]!==a?(n=le("border border-[--border] rounded-2xl p-8 flex flex-col items-center text-center gap-4 bg-[--card] shadow-sm",a),e[0]=a,e[1]=n):n=e[1];let r,l;e[2]===Symbol.for("react.memo_cache_sentinel")?(r=(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"size-16 rounded-full border-4 border-amber-400 border-t-transparent animate-spin duration-[3000ms]"}),(0,t.jsx)("span",{className:"absolute inset-0 flex items-center justify-center text-2xl",children:""})]}),l=(0,t.jsx)("h3",{className:"font-extrabold text-lg text-[--foreground] mt-2 leading-tight",children:"Get your Sysm account now!"}),e[2]=r,e[3]=l):(r=e[2],l=e[3]);let o;e[4]!==i?(o=(0,t.jsx)("button",{onClick:()=>i("signup"),className:"w-full bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 py-2.5 rounded-full font-black text-sm uppercase tracking-wider hover:opacity-90 active:scale-95 transition-all shadow-lg cursor-pointer",children:"Signup now"}),e[4]=i,e[5]=o):o=e[5];let c;return e[6]!==n||e[7]!==o?(c=(0,t.jsxs)("div",{className:n,children:[r,l,o]}),e[6]=n,e[7]=o,e[8]=c):c=e[8],c},Ea=fo,xo=Q(),ho=()=>{const s=(0,xo.c)(3);let e;s[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,t.jsx)("div",{className:"size-11 rounded-full bg-zinc-200 dark:bg-zinc-800 shrink-0"}),s[0]=e):e=s[0];let a;s[1]===Symbol.for("react.memo_cache_sentinel")?(a=(0,t.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,t.jsx)("div",{className:"h-4 bg-zinc-200 dark:bg-zinc-800 rounded w-1/3"}),(0,t.jsx)("div",{className:"h-4 bg-zinc-200 dark:bg-zinc-800 rounded w-16"})]}),s[1]=a):a=s[1];let i;return s[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,t.jsx)("div",{className:"px-5 pt-4 pb-3 border-b border-zinc-100 dark:border-zinc-800 animate-pulse",children:(0,t.jsxs)("div",{className:"flex items-start gap-x-3",children:[e,(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[a,(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"h-3 bg-zinc-200 dark:bg-zinc-800 rounded w-full"}),(0,t.jsx)("div",{className:"h-3 bg-zinc-200 dark:bg-zinc-800 rounded w-5/6"})]}),(0,t.jsx)("div",{className:"h-48 bg-zinc-200 dark:bg-zinc-800 rounded-xl w-full mt-3"})]})]})}),s[2]=i):i=s[2],i},Xt=ho,$t=Q();function Zt(s){const e=(0,$t.c)(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=le("flex flex-col gap-2",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,t.jsx)(tn,{"data-slot":"tabs",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function Gt(s){const e=(0,$t.c)(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=le("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,t.jsx)(pi,{"data-slot":"tabs-list",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function mt(s){const e=(0,$t.c)(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=le("inline-flex items-center justify-center gap-1.5 px-2 py-1 text-sm font-medium whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 outline-none focus:outline-none focus-visible:outline-none ring-0 focus:ring-0 focus-visible:ring-0 shadow-none data-[state=active]:shadow-none",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,t.jsx)(qa,{"data-slot":"tabs-trigger",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function ot(s){const e=(0,$t.c)(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=le("flex-1 outline-none",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,t.jsx)(Ha,{"data-slot":"tabs-content",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var po=Q(),bo=s=>{const e=(0,po.c)(18),{name:a,number:i}=s,n=a===void 0?"BRUCE WAYNE":a,r=i===void 0?"9759 2484 5269 6576":i;let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=(0,t.jsx)("style",{children:`
        .credit-card-container {
          perspective: 1000px;
          width: 240px;
          height: 154px;
        }
        .credit-card-inner {
          position: relative;
          width: 100%;
          height: 100%;
          text-align: center;
          transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
          transform-style: preserve-3d;
          cursor: pointer;
        }
        .credit-card-container:hover .credit-card-inner {
          transform: rotateY(180deg);
        }
        .credit-card-front, .credit-card-back {
          position: absolute;
          width: 100%;
          height: 100%;
          -webkit-backface-visibility: hidden;
          backface-visibility: hidden;
          border-radius: 1rem;
          display: flex;
          flex-direction: column;
          justify-content: center;
          background-color: #171717;
          box-shadow: 0 2px 2px rgba(0,0,0,0.4), 0 7px 13px -3px rgba(0,0,0,0.3), inset 0 -1px 0 rgba(0,0,0,0.2);
          color: white;
          overflow: hidden;
        }
        .credit-card-back {
          transform: rotateY(180deg);
        }
      `}),e[0]=l):l=e[0];let o;e[1]===Symbol.for("react.memo_cache_sentinel")?(o=(0,t.jsx)("p",{className:"absolute text-[0.5em] font-bold tracking-[.2em] top-[2em] left-[18.6em]",children:"VICTIMCARD"}),e[1]=o):o=e[1];let c;e[2]===Symbol.for("react.memo_cache_sentinel")?(c=(0,t.jsxs)("svg",{className:"absolute top-[6.8em] left-[11.7em]",xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 48 48",children:[(0,t.jsx)("path",{fill:"#ff9800",d:"M32 10A14 14 0 1 0 32 38A14 14 0 1 0 32 10Z"}),(0,t.jsx)("path",{fill:"#d50000",d:"M16 10A14 14 0 1 0 16 38A14 14 0 1 0 16 10Z"}),(0,t.jsx)("path",{fill:"#ff3d00",d:"M18,24c0,4.755,2.376,8.95,6,11.48c3.624-2.53,6-6.725,6-11.48s-2.376-8.95-6-11.48 C20.376,15.05,18,19.245,18,24z"})]}),e[2]=c):c=e[2];let u;e[3]===Symbol.for("react.memo_cache_sentinel")?(u=(0,t.jsx)("svg",{version:"1.1",className:"absolute top-[2.3em] left-[1.5em]",width:"30px",height:"30px",viewBox:"0 0 50 50",children:(0,t.jsx)("image",{width:"50",height:"50",x:"0",y:"0",href:`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAABGdBTUEAALGPC/xhBQAAACBjSFJN
                AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAB6VBMVEUAAACNcTiVeUKVeUOY
                fEaafEeUeUSYfEWZfEaykleyklaXe0SWekSZZjOYfEWYe0WXfUWXe0WcgEicfkiXe0SVekSXekSW
                ekKYe0a9nF67m12ZfUWUeEaXfESVekOdgEmVeUWWekSniU+VeUKVeUOrjFKYfEWliE6WeESZe0GS
                e0WYfES7ml2Xe0WXeESUeEOWfEWcf0eWfESXe0SXfEWYekSVeUKXfEWxklawkVaZfEWWekOUekOW
                ekSYfESZe0eXekWYfEWZe0WZe0eVeUSWeETAnmDCoWLJpmbxy4P1zoXwyoLIpWbjvXjivnjgu3bf
                u3beunWvkFWxkle/nmDivXiWekTnwXvkwHrCoWOuj1SXe0TEo2TDo2PlwHratnKZfEbQrWvPrWua
                fUfbt3PJp2agg0v0zYX0zYSfgkvKp2frxX7mwHrlv3rsxn/yzIPgvHfduXWXe0XuyIDzzISsjVO1
                lVm0lFitjVPzzIPqxX7duna0lVncuHTLqGjvyIHeuXXxyYGZfUayk1iyk1e2lln1zYTEomO2llrb
                tnOafkjFpGSbfkfZtXLhvHfkv3nqxH3mwXujhU3KqWizlFilh06khk2fgkqsjlPHpWXJp2erjVOh
                g0yWe0SliE+XekShhEvAn2D///+gx8TWAAAARnRSTlMACVCTtsRl7Pv7+vxkBab7pZv5+ZlL/UnU
                /f3SJCVe+Fx39naA9/75XSMh0/3SSkia+pil/KRj7Pr662JPkrbP7OLQ0JFOijI1MwAAAAFiS0dE
                orDd34wAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfnAg0IDx2lsiuJAAACLElEQVRIx2Ng
                GAXkAUYmZhZWPICFmYkRVQcbOwenmzse4MbFzc6DpIGXj8PD04sA8PbhF+CFaxEU8iWkAQT8hEVg
                OkTF/InR4eUVICYO1SIhCRMLDAoKDvFDVhUaEhwUFAjjSUlDdMiEhcOEItzdI6OiYxA6YqODIt3d
                I2DcuDBZsBY5eVTr4xMSYcyk5BRUOXkFsBZFJTQnp6alQxgZmVloUkrKYC0qqmji2WE5EEZuWB6a
                lKoKdi35YQUQRkFYPpFaCouKIYzi6EDitJSUlsGY5RWVRGjJLyxNy4ZxqtIqqvOxaVELQwZFZdkI
                JVU1RSiSalAt6rUwUBdWG1CP6pT6gNqwOrgCdQyHNYR5YQFhDXj8MiK1IAeyN6aORiyBjByVTc0F
                qBoKWpqwRCVSgilOaY2OaUPw29qjOzqLvTAchpos47u6EZyYnngUSRwpuTe6D+6qaFQdOPNLRzOM
                1dzhRZyW+CZouHk3dWLXglFcFIflQhj9YWjJGlZcaKAVSvjyPrRQ0oQVKDAQHlYFYUwIm4gqExGm
                BSkutaVQJeomwViTJqPK6OhCy2Q9sQBk8cY0DxjTJw0lAQWK6cOKfgNhpKK7ZMpUeF3jPa28BCET
                amiEqJKM+X1gxvWXpoUjVIVPnwErw71nmpgiqiQGBjNzbgs3j1nus+fMndc+Cwm0T52/oNR9lsdC
              S24ra7Tq1cbWjpXV3sHRCb1idXZ0sGdltXNxRateRwHRAACYHutzk/2I5QAAACV0RVh0ZGF0ZTpj
              cmVhdGUAMjAyMy0wMi0xM1QwODoxNToyOSswMDowMEUnN7UAAAAldEVYdGRhdGU6bW9kaWZ5ADIw
              MjMtMDItMTNUMDg6MTU6MjkrMDA6MDA0eo8JAAAAKHRFWHRkYXRlOnRpbWVzdGFtcAAyMDIzLTAy
              LTEzVDA4OjE1OjI5KzAwOjAwY2+u1gAAAABJRU5ErkJggg==`})}),e[3]=u):u=e[3];let d;e[4]===Symbol.for("react.memo_cache_sentinel")?(d=(0,t.jsx)("svg",{version:"1.1",className:"absolute top-[3.5em] left-[12.4em]",width:"20px",height:"20px",viewBox:"0 0 50 50",children:(0,t.jsx)("image",{width:"50",height:"50",x:"0",y:"0",href:`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAQAAAC0NkA6AAAABGdBTUEAALGPC/xhBQAAACBjSFJN
                AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAJcEhZ
                cwAACxMAAAsTAQCanBgAAAAHdElNRQfnAg0IEzgIwaKTAAADDklEQVRYw+1XS0iUURQ+f5qPyjQf
                lGRFEEFK76koKGxRbWyVVLSOgsCgwjZBJJYuKogSIoOonUK4q3U0WVBWFPZYiIE6kuArG3VGzK/F
                fPeMM/MLt99/NuHdfPd888/57jn3nvsQWWj/VcMlvMMd5KRTogqx9iCdIjUUmcGR9ImUYowyP3xN
                GQJoRLVaZ2DaZf8kyjEJALhI28ELioyiwC+Rc3QZwRYyO/DH51hQgWm6DMIh10KmD4u9O16K49it
                VoPOAmcGAWWOepXIRScAoJZ2Frro8oN+EyTT6lWkkg6msZfMSR35QTJmjU0g15tIGSJ08ZZMJkJk
                HpNZgSkyXosS13TkJpZ62mPIJvOSzC1bp8vRhhCakEk7G9/o4gmZdbpsTcKu0m63FbnBP9Qrc15z
                bkbemfgNDtEOI8NO5L5O9VYyRYgmJayZ9nPaxZrSjW4+F6Uw9yQqIiIZwhp2huQTf6OIvCZyGM6g
                DJBZbyXifJXr7FZjGXsdxADxI7HUJFB6iWvsIhFpkoiIiGTJfjJfiCuJg2ZEspq9EHGVpYgzKqwJ
                qSAOEwuJQ/pxPvE3cYltJCLdxBLiSKKIE5HxJKcTRNeadxfhDiuYw44zVs1dxKwRk/uCxIiQkxKB
                sSctRVAge9g1E15EHE6yRUaJecRxcWlukdRIbGFOSZCMWQA/iWauIP3slREHXPyliqBcrrD71Amz
                Z+rD1Mt2Yr8TZc/UR4/YtFnbijnHi3UrN9vKQ9rPaJf867ZiaqDB+czeKYmd3pNa6fuI75MiC0uX
                XSR5aEMf7s7a6r/PudVXkjFb/SsrCRfROk0Fx6+H1i9kkTGn/E1vEmt1m089fh+RKdQ5O+xNJPUi
                cUIjO0Dm7HwvErEr0YxeibL1StSh37STafE4I7zcBdRq1DiOkdmlTJVnkQTBTS7X1FYyvfO4piaI
                nKbDCDaT2anLudYXCRFsQBgAcIF2/Okwgvz5+Z4tsw118dzruvIvjhTB+HOuWy8UvovEH6beitBK
                xDyxm9MmISKCWrzB7bSlaqGlsf0FC0gMjzTg6GgAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDIt
                MTNUMDg6MTk6NTYrMDA6MDCjlq7LAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTAyLTEzVDA4OjE5
              OjU2KzAwOjAw0ssWdwAAACh0RVh0ZGF0ZTp0aW1lc3RhbXAAMjAyMy0wMi0xM1QwODoxOTo1Nisw
              MDowMIXeN6gAAAAASUVORK5CYII=`})}),e[4]=d):d=e[4];let m;e[5]!==r?(m=(0,t.jsx)("p",{className:"absolute text-[.6em] font-bold top-[8.3em] left-[1.6em] uppercase tracking-wider",children:r}),e[5]=r,e[6]=m):m=e[6];let f;e[7]===Symbol.for("react.memo_cache_sentinel")?(f=(0,t.jsx)("p",{className:"absolute text-[0.5em] font-bold top-[13.6em] left-[3.2em]",children:"1 2 / 2 4"}),e[7]=f):f=e[7];let p;e[8]!==n?(p=(0,t.jsx)("p",{className:"absolute text-[0.5em] font-bold top-[16.1em] left-[2em] uppercase tracking-tighter truncate w-[160px] text-left",children:n}),e[8]=n,e[9]=p):p=e[9];let x;e[10]!==p||e[11]!==m?(x=(0,t.jsxs)("div",{className:"credit-card-front",children:[o,c,u,d,m,f,p]}),e[10]=p,e[11]=m,e[12]=x):x=e[12];let h,b;e[13]===Symbol.for("react.memo_cache_sentinel")?(h=(0,t.jsx)("div",{className:"absolute w-full h-[1.5em] top-[2.4em] bg-black bg-[repeating-linear-gradient(45deg,#303030,#303030_10px,#202020_10px,#202020_20px)] left-0"}),b=(0,t.jsx)("div",{className:"absolute w-[8em] h-[0.8em] top-[5em] left-[0.8em] bg-white rounded-[2.5px]"}),e[13]=h,e[14]=b):(h=e[13],b=e[14]);let v;e[15]===Symbol.for("react.memo_cache_sentinel")?(v=(0,t.jsxs)("div",{className:"credit-card-back",children:[h,b,(0,t.jsx)("div",{className:"absolute w-[4.1em] h-[0.8em] top-[5em] left-[10em] bg-white rounded-[2.5px]",children:(0,t.jsx)("p",{className:"text-black font-bold text-center m-[.2em] text-[0.5em]",children:"***"})})]}),e[15]=v):v=e[15];let j;return e[16]!==x?(j=(0,t.jsxs)(t.Fragment,{children:[l,(0,t.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,t.jsx)("div",{className:"credit-card-container",children:(0,t.jsxs)("div",{className:"credit-card-inner",children:[x,v]})})})]}),e[16]=x,e[17]=j):j=e[17],j},go=bo,vo=Q();function jo(s){const e=(0,vo.c)(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=le("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,t.jsx)("textarea",{"data-slot":"textarea",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var wo=Q(),yo=s=>{const e=(0,wo.c)(7),{className:a}=s;let i;e[0]!==a?(i=le("flex items-center gap-1 px-1 py-1.5",a),e[0]=a,e[1]=i):i=e[1];let n,r,l;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,t.jsx)("div",{className:"size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse"}),r=(0,t.jsx)("div",{className:"size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse [animation-delay:0.2s]"}),l=(0,t.jsx)("div",{className:"size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse [animation-delay:0.4s]"}),e[2]=n,e[3]=r,e[4]=l):(n=e[2],r=e[3],l=e[4]);let o;return e[5]!==i?(o=(0,t.jsxs)("div",{className:i,children:[n,r,l]}),e[5]=i,e[6]=o):o=e[6],o},zo=yo,No=Q(),ko=()=>{const s=(0,No.c)(48),{currentUser:e,setAuthMode:a}=pe(),{darkMode:i,toggleDarkMode:n}=pt(),[r,l]=(0,g.useState)(""),o=je();let c;s[0]===Symbol.for("react.memo_cache_sentinel")?(c={queryKey:["trending-hashtags"],queryFn:Co,staleTime:3e5,refetchInterval:6e4},s[0]=c):c=s[0];const{data:u}=Ee(c);let d;s[1]!==u?(d=u===void 0?[]:u,s[1]=u,s[2]=d):d=s[2];const m=d;let f;s[3]===Symbol.for("react.memo_cache_sentinel")?(f=[" 2026 Sysm","Terms","Privacy","Guidelines","Discord","Sysm","GitHub","Support","Status"],s[3]=f):f=s[3];const p=f;let x;s[4]!==i?(x=i?(0,t.jsx)(Ds,{size:20}):(0,t.jsx)(Bs,{size:20}),s[4]=i,s[5]=x):x=s[5];let h;s[6]!==x||s[7]!==n?(h=(0,t.jsx)("button",{onClick:n,className:"p-3 rounded-full bg-zinc-50 dark:bg-zinc-900 text-zinc-500 dark:text-zinc-400 border border-zinc-100 dark:border-zinc-800 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-all cursor-pointer",title:"Toggle Theme",children:x}),s[6]=x,s[7]=n,s[8]=h):h=s[8];const b=h;if(e){let M;s[9]===Symbol.for("react.memo_cache_sentinel")?(M=()=>l(""),s[9]=M):M=s[9];let R;s[10]!==r?(R=(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)(kt,{value:r,onChange:l,onClear:M})}),s[10]=r,s[11]=R):R=s[11];let E;s[12]!==R||s[13]!==b?(E=(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[R,b]}),s[12]=R,s[13]=b,s[14]=E):E=s[14];let I;s[15]===Symbol.for("react.memo_cache_sentinel")?(I=(0,t.jsx)("h3",{className:"font-extrabold text-xl mb-4 px-2 text-[--foreground]",children:"What's happening"}),s[15]=I):I=s[15];let O;if(s[16]!==o||s[17]!==m){let N;s[19]!==o?(N=L=>(0,t.jsxs)("div",{onClick:()=>o(`/tags/${L.name.replace(/^#/,"")}`),className:"px-3 py-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-xl cursor-pointer transition-colors group",children:[(0,t.jsx)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400 font-medium",children:"Trending"}),(0,t.jsxs)("div",{className:"font-bold text-[--foreground]",children:["#",L.name.replace(/^#/,"")]}),(0,t.jsxs)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:[L.usage_count," posts"]})]},L.id),s[19]=o,s[20]=N):N=s[20],O=m.map(N),s[16]=o,s[17]=m,s[18]=O}else O=s[18];let D;s[21]!==m.length?(D=m.length===0&&(0,t.jsx)("p",{className:"text-sm text-zinc-500 px-2",children:"No trends yet"}),s[21]=m.length,s[22]=D):D=s[22];let P;s[23]!==O||s[24]!==D?(P=(0,t.jsxs)("div",{className:"bg-zinc-50 dark:bg-zinc-900 rounded-2xl p-4 border border-[--border]",children:[I,(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[O,D]})]}),s[23]=O,s[24]=D,s[25]=P):P=s[25];let C;s[26]===Symbol.for("react.memo_cache_sentinel")?(C=(0,t.jsx)("div",{className:"flex flex-wrap gap-x-4 gap-y-2 px-2 text-[13px] text-zinc-500 font-medium pb-5",children:p.map(So)}),s[26]=C):C=s[26];let w;return s[27]!==P||s[28]!==E?(w=(0,t.jsxs)("aside",{className:"sticky top-5 hidden w-[320px] shrink-0 flex-col gap-y-6 lg:flex overflow-y-auto max-h-screen",children:[E,P,C]}),s[27]=P,s[28]=E,s[29]=w):w=s[29],w}let v,j;s[30]!==a?(v=(0,t.jsx)("button",{onClick:()=>a("signup"),className:"flex-1 bg-[--card] border border-[--border] py-2.5 rounded-full font-bold text-[--foreground] hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors shadow-sm cursor-pointer",children:"Signup"}),j=()=>a("login"),s[30]=a,s[31]=v,s[32]=j):(v=s[31],j=s[32]);let y;s[33]===Symbol.for("react.memo_cache_sentinel")?(y=(0,t.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",alt:"",className:"size-4 rounded-sm"}),s[33]=y):y=s[33];let z;s[34]!==j?(z=(0,t.jsxs)("button",{onClick:j,className:"flex-1 bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 py-2.5 rounded-full font-bold flex items-center justify-center gap-2 hover:opacity-90 transition-opacity cursor-pointer",children:[y,"Login"]}),s[34]=j,s[35]=z):z=s[35];let k;s[36]!==v||s[37]!==z||s[38]!==b?(k=(0,t.jsxs)("div",{className:"flex gap-3",children:[v,z,b]}),s[36]=v,s[37]=z,s[38]=b,s[39]=k):k=s[39];let _;s[40]===Symbol.for("react.memo_cache_sentinel")?(_=()=>l(""),s[40]=_):_=s[40];let $;s[41]!==r?($=(0,t.jsx)(kt,{value:r,onChange:l,onClear:_}),s[41]=r,s[42]=$):$=s[42];let A;s[43]===Symbol.for("react.memo_cache_sentinel")?(A=(0,t.jsx)(Ea,{}),s[43]=A):A=s[43];let S;s[44]===Symbol.for("react.memo_cache_sentinel")?(S=(0,t.jsx)("div",{className:"flex flex-wrap gap-x-4 gap-y-2 px-2 text-[13px] text-zinc-500 font-medium pb-5",children:p.map(Po)}),s[44]=S):S=s[44];let F;return s[45]!==k||s[46]!==$?(F=(0,t.jsxs)("aside",{className:"sticky top-5 hidden w-[350px] shrink-0 flex-col gap-y-6 lg:flex pr-4",children:[k,$,A,S]}),s[45]=k,s[46]=$,s[47]=F):F=s[47],F},_o=ko;function Co(){return Fr(5)}function So(s){return(0,t.jsx)("a",{href:"#",className:"hover:underline",children:s},s)}function Po(s){return(0,t.jsx)("a",{href:"#",className:"hover:underline",children:s},s)}var Jd=Q(),$o=({isOpen:s,onClose:e})=>{const{currentUser:a}=pe(),{addToast:i}=ze(),n=je(),[r,l]=(0,g.useState)({name:"",handle:"",description:"",isPrivate:!1}),[o,c]=(0,g.useState)(!1),u=async d=>{if(d.preventDefault(),!(!r.name||!r.handle||!a)){c(!0);try{const m=await Pr({name:r.name,handle:r.handle.toLowerCase().replace(/[^a-z0-9_]/g,""),description:r.description,is_private:r.isPrivate,creator_id:a.id}),{error:f}=await q.from("community_members").insert([{community_id:m.id,user_id:a.id,role:"admin"}]);if(f)throw f;i(`Community "${m.name}" created!`),e(),n(`/c/${m.handle}`)}catch(m){console.error(m),i(m.message||"Failed to create community","error")}finally{c(!1)}}};return(0,t.jsx)(Ke,{isOpen:s,onClose:()=>!o&&e(),title:"Create Community",className:"sm:max-w-md",children:(0,t.jsxs)("form",{onSubmit:u,className:"space-y-5",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center p-6 bg-zinc-50 dark:bg-zinc-900 rounded-2xl border-2 border-dashed border-zinc-200 dark:border-zinc-800",children:[(0,t.jsx)("div",{className:"size-20 rounded-2xl bg-white dark:bg-black flex items-center justify-center shadow-sm mb-3",children:(0,t.jsx)(et,{size:32,className:"text-violet-600"})}),(0,t.jsx)("p",{className:"text-xs font-medium text-zinc-500 text-center max-w-[200px]",children:"Communities are where people with shared interests connect."})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)("label",{className:"text-sm font-bold ml-1",children:"Community Name"}),(0,t.jsx)("input",{type:"text",required:!0,className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all",placeholder:"e.g. Photography Enthusiasts",value:r.name,onChange:d=>l({...r,name:d.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)("label",{className:"text-sm font-bold ml-1",children:"Handle"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-zinc-500 font-medium",children:"c/"}),(0,t.jsx)("input",{type:"text",required:!0,className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl pl-8 pr-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all",placeholder:"photography",value:r.handle,onChange:d=>l({...r,handle:d.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"")})})]})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)("label",{className:"text-sm font-bold ml-1",children:"Description (Optional)"}),(0,t.jsx)("textarea",{className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all min-h-[100px] resize-none",placeholder:"What is this community about?",value:r.description,onChange:d=>l({...r,description:d.target.value})})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-zinc-50 dark:bg-zinc-900 rounded-xl border border-zinc-200 dark:border-zinc-800",children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-sm font-bold",children:"Private Community"}),(0,t.jsx)("span",{className:"text-[10px] text-zinc-500",children:"Only Admins can post in private communities"})]}),(0,t.jsx)("input",{type:"checkbox",className:"size-5 rounded-md accent-violet-600 cursor-pointer",checked:r.isPrivate,onChange:d=>l({...r,isPrivate:d.target.checked})})]})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,t.jsx)(xe,{type:"button",variant:"outline",className:"flex-1",onClick:e,disabled:o,children:"Cancel"}),(0,t.jsx)(xe,{type:"submit",className:"flex-1",disabled:o||!r.name||!r.handle,children:o?(0,t.jsx)(ce,{size:18,className:"animate-spin"}):"Create"})]})]})})},Ao=$o,Mo=Q(),Fo=s=>{const e=(0,Mo.c)(33),{id:a,file:i,index:n,total:r,onRemove:l,onAddThumbnail:o,customThumbnail:c}=s;let u;e[0]!==a?(u={id:a},e[0]=a,e[1]=u):u=e[1];const{attributes:d,listeners:m,setNodeRef:f,transform:p,transition:x,isDragging:h}=Fn(u);let b;e[2]!==p?(b=_n.Transform.toString(p),e[2]=p,e[3]=b):b=e[3];const v=h?50:"auto",j=h?.5:1;let y;e[4]!==b||e[5]!==v||e[6]!==j||e[7]!==x?(y={transform:b,transition:x,zIndex:v,opacity:j},e[4]=b,e[5]=v,e[6]=j,e[7]=x,e[8]=y):y=e[8];const z=y,k=`relative group overflow-hidden bg-zinc-100 dark:bg-zinc-800 rounded-2xl border border-zinc-100 dark:border-zinc-800 shadow-sm transition-shadow ${r===3&&n===0?"row-span-2":""} ${h?"shadow-xl ring-2 ring-violet-500":""}`;let _;e[9]!==c||e[10]!==i?(_=i.type.startsWith("image/")?(0,t.jsx)("img",{src:URL.createObjectURL(i),className:"size-full object-cover pointer-events-none",alt:""}):(0,t.jsx)("div",{className:"size-full flex flex-col items-center justify-center text-zinc-500 gap-2 pointer-events-none",children:i.type.startsWith("video/")?(0,t.jsx)(t.Fragment,{children:c?(0,t.jsx)("img",{src:URL.createObjectURL(c),className:"size-full object-cover opacity-60",alt:"Custom thumbnail"}):(0,t.jsx)("div",{className:"size-10 rounded-full bg-black/20 flex items-center justify-center backdrop-blur-sm",children:(0,t.jsx)(We,{size:20,className:"text-zinc-400"})})}):(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,t.jsx)(Ps,{size:24}),(0,t.jsx)("span",{className:"text-[10px] font-bold truncate max-w-[100px] px-2",children:i.name})]})}),e[9]=c,e[10]=i,e[11]=_):_=e[11];let $;e[12]!==d||e[13]!==m||e[14]!==_?($=(0,t.jsx)("div",{...d,...m,className:"size-full cursor-grab active:cursor-grabbing",children:_}),e[12]=d,e[13]=m,e[14]=_,e[15]=$):$=e[15];let A;e[16]!==c||e[17]!==i.type||e[18]!==o?(A=i.type.startsWith("video/")&&(0,t.jsx)("button",{type:"button",onClick:o,className:"absolute inset-x-0 bottom-0 bg-black/60 text-white text-[10px] font-bold py-2 backdrop-blur-md hover:bg-black/80 transition-colors z-10",children:c?"Change Cover":"Add Cover"}),e[16]=c,e[17]=i.type,e[18]=o,e[19]=A):A=e[19];let S;e[20]!==a||e[21]!==l?(S=()=>l(a),e[20]=a,e[21]=l,e[22]=S):S=e[22];let F;e[23]===Symbol.for("react.memo_cache_sentinel")?(F=(0,t.jsx)($e,{size:14,strokeWidth:2.5}),e[23]=F):F=e[23];let M;e[24]!==S?(M=(0,t.jsx)("button",{type:"button",onClick:S,className:"absolute top-2 right-2 p-1.5 rounded-full bg-black/50 text-white hover:bg-rose-500 transition-colors backdrop-blur-md z-20",children:F}),e[24]=S,e[25]=M):M=e[25];let R;return e[26]!==f||e[27]!==z||e[28]!==M||e[29]!==k||e[30]!==$||e[31]!==A?(R=(0,t.jsxs)("div",{ref:f,style:z,className:k,children:[$,A,M]}),e[26]=f,e[27]=z,e[28]=M,e[29]=k,e[30]=$,e[31]=A,e[32]=R):R=e[32],R},Eo=({isOpen:s,onClose:e,initialCommunity:a})=>{const{currentUser:i}=pe(),{addPost:n}=Vt(),{addToast:r}=ze(),[l,o]=(0,g.useState)(""),[c,u]=(0,g.useState)([]),[d,m]=(0,g.useState)({}),[f,p]=(0,g.useState)(!1),[x,h]=(0,g.useState)({options:["",""],duration:"1 day"}),[b,v]=(0,g.useState)(!1),[j,y]=(0,g.useState)(null),z=Ti(is(wn,{activationConstraint:{distance:8}}),is(an,{coordinateGetter:Rn}));(0,g.useEffect)(()=>{y(a||null)},[a,s]);const{data:k=[]}=Ee({queryKey:["user-communities",i?.id],queryFn:()=>Sr(i?.id),enabled:!!i?.id}),_=(0,g.useRef)(null),$=(0,g.useRef)(null),[A,S]=(0,g.useState)(null),F=C=>{const w=Array.from(C.target.files).map(N=>({id:Math.random().toString(36).substring(2,11),file:N}));u(N=>[...N,...w])},M=C=>{const w=C.target.files[0];w&&A!==null&&m(N=>({...N,[A]:w})),S(null)},R=C=>{u(N=>N.filter(L=>L.id!==C));const w={...d};delete w[C],m(w)},E=C=>{const{active:w,over:N}=C;N&&w.id!==N.id&&u(L=>In(L,L.findIndex(W=>W.id===w.id),L.findIndex(W=>W.id===N.id)))},I=()=>{x.options.length<4&&h(C=>({...C,options:[...C.options,""]}))},O=C=>{h(w=>({...w,options:w.options.filter((N,L)=>L!==C)}))},D=(C,w)=>{const N=[...x.options];N[C]=w,h(L=>({...L,options:N}))},P=async C=>{if(C.preventDefault(),!(!l.trim()&&c.length===0||!i)){v(!0);try{const w=[];for(let L=0;L<c.length;L++){const W=c[L],T=d[W.id]||null,B=await Ae(W.file,"media",T);w.push(B)}let N=null;f&&x.options.some(L=>L.trim())&&(N={options:x.options.filter(L=>L.trim()).map((L,W)=>({id:W+1,text:L,votes:0})),ends_at:new Date(Date.now()+1440*60*1e3).toISOString()}),await n({content:l,media:w,poll:N,type:w.length>0?w[0].type==="video"?"video":"image":N?"poll":"text",userId:i.id,communityId:j?.id||null}),o(""),u([]),p(!1),h({options:["",""],duration:"1 day"}),y(null),e(),r("Post published!")}catch(w){console.error("Failed to create post:",w),r("Failed to publish post.","error")}finally{v(!1)}}};return(0,t.jsx)(Ke,{isOpen:s,onClose:()=>!b&&e(),title:"Create Post",className:"sm:max-w-[600px] p-0 overflow-hidden gap-0",footer:(0,t.jsxs)("div",{className:"flex items-center justify-between w-full pt-2",children:[(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)("button",{type:"button",onClick:()=>_.current?.click(),className:"p-2 text-violet-600 hover:bg-violet-50 dark:text-violet-400 dark:hover:bg-violet-900/20 rounded-full transition-all active:scale-95",title:"Attach media",children:(0,t.jsx)(Es,{size:20})}),(0,t.jsx)("button",{type:"button",onClick:()=>p(!f),className:`p-2 rounded-full transition-all active:scale-95 ${f?"bg-violet-50 text-violet-600 dark:bg-violet-900/20 dark:text-violet-400":"text-violet-600 hover:bg-violet-50 dark:text-violet-400 dark:hover:bg-violet-900/20"}`,title:"Add poll",children:(0,t.jsx)(xn,{size:20})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"h-6 w-px bg-zinc-200 dark:bg-zinc-800"}),(0,t.jsx)(xe,{onClick:P,disabled:!l.trim()&&c.length===0||b,className:"rounded-full px-6 h-9 text-sm font-bold bg-zinc-900 dark:bg-white text-white dark:text-zinc-950 hover:opacity-90 disabled:opacity-50 transition-all shadow-md active:scale-95",children:b?(0,t.jsx)(ce,{size:16,className:"animate-spin"}):"Post"})]}),(0,t.jsx)("input",{type:"file",ref:_,onChange:F,multiple:!0,className:"hidden",accept:"image/*,video/*,application/pdf"}),(0,t.jsx)("input",{type:"file",ref:$,onChange:M,className:"hidden",accept:"image/*"})]}),children:(0,t.jsxs)("div",{className:"flex flex-col gap-4 p-1",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsxs)(be,{className:"size-10 border border-zinc-100 dark:border-zinc-800 shadow-sm shrink-0",children:[(0,t.jsx)(ge,{src:i?.avatar,className:"object-cover"}),(0,t.jsx)(ve,{children:i?.handle?.[0]?.toUpperCase()})]}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,t.jsx)("span",{className:"font-bold text-sm text-zinc-900 dark:text-zinc-100 truncate",children:i?.name}),(0,t.jsxs)(ja,{children:[(0,t.jsx)(wa,{asChild:!0,children:(0,t.jsx)("button",{className:"flex items-center gap-1.5 px-2.5 py-1 rounded-full border border-zinc-200 dark:border-zinc-700 bg-white dark:bg-zinc-900 text-xs font-bold text-zinc-600 dark:text-zinc-300 hover:bg-zinc-50 dark:hover:bg-zinc-800 transition-all group",children:j?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(et,{size:12,className:"text-violet-500"}),(0,t.jsx)("span",{className:"max-w-[100px] truncate",children:j.name})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Nt,{size:12,className:"text-zinc-400 group-hover:text-violet-500 transition-colors"}),(0,t.jsx)("span",{children:"Everyone"})]})})}),(0,t.jsxs)(ya,{align:"start",className:"w-60 p-1.5 rounded-xl shadow-xl border-zinc-100 dark:border-zinc-800",children:[(0,t.jsxs)(Ge,{onClick:()=>y(null),className:"gap-3 py-2 px-3 rounded-lg cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800",children:[(0,t.jsx)("div",{className:"size-8 rounded-full bg-zinc-100 dark:bg-zinc-800 flex items-center justify-center shrink-0",children:(0,t.jsx)(Nt,{size:16,className:"text-zinc-500"})}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"font-bold text-sm",children:"Everyone"}),(0,t.jsx)("span",{className:"text-[11px] text-zinc-500",children:"Public feed"})]})]}),k.length>0&&(0,t.jsx)("div",{className:"h-px bg-zinc-100 dark:bg-zinc-800 my-1 mx-2"}),(0,t.jsx)("div",{className:"max-h-[200px] overflow-y-auto",children:k.filter(C=>!C.isPrivate||C.myRole==="admin").map(C=>(0,t.jsxs)(Ge,{onClick:()=>y(C),className:"gap-3 py-2 px-3 rounded-lg cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800",children:[(0,t.jsxs)(be,{className:"size-8 border border-zinc-100 dark:border-zinc-700",children:[(0,t.jsx)(ge,{src:C.avatar}),(0,t.jsx)(ve,{children:C.name[0]})]}),(0,t.jsxs)("div",{className:"flex flex-col min-w-0",children:[(0,t.jsx)("span",{className:"font-bold text-sm truncate",children:C.name}),(0,t.jsx)("span",{className:"text-[11px] text-zinc-500",children:"Community"})]})]},C.id))})]})]})]}),(0,t.jsx)("textarea",{className:"w-full bg-transparent border-none outline-none text-lg min-h-[100px] max-h-[400px] resize-none dark:text-zinc-100 placeholder:text-zinc-400 font-medium leading-relaxed",placeholder:"What's on your mind?",autoFocus:!0,value:l,onChange:C=>{o(C.target.value),C.target.style.height="auto",C.target.style.height=C.target.scrollHeight+"px"}})]})]}),(0,t.jsxs)("div",{className:"pl-[52px]",children:[c.length>0&&(0,t.jsx)("div",{className:"mb-4 animate-in fade-in zoom-in-95 duration-200",children:(0,t.jsx)(bn,{sensors:z,collisionDetection:Ui,onDragEnd:E,children:(0,t.jsx)(On,{items:c.map(C=>C.id),strategy:Tn,children:(0,t.jsx)("div",{className:`grid gap-2 rounded-2xl overflow-hidden border border-zinc-100 dark:border-zinc-800 shadow-sm ${c.length===1?"grid-cols-1":"grid-cols-2 aspect-[16/9]"}`,children:c.map((C,w)=>(0,t.jsx)(Fo,{id:C.id,file:C.file,index:w,total:c.length,onRemove:R,customThumbnail:d[C.id],onAddThumbnail:()=>{S(C.id),$.current?.click()}},C.id))})})})}),f&&(0,t.jsxs)("div",{className:"mb-4 p-4 rounded-xl border border-violet-100 dark:border-violet-900/30 bg-violet-50/30 dark:bg-violet-900/10 space-y-3 animate-in slide-in-from-top-2 duration-200",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center px-1",children:[(0,t.jsx)("span",{className:"text-xs font-bold text-violet-600 dark:text-violet-400 uppercase tracking-wider",children:"Poll Options"}),(0,t.jsx)("button",{type:"button",onClick:()=>p(!1),className:"text-zinc-400 hover:text-rose-500 transition-colors",children:(0,t.jsx)($e,{size:16})})]}),(0,t.jsx)("div",{className:"space-y-2",children:x.options.map((C,w)=>(0,t.jsxs)("div",{className:"flex gap-2 group",children:[(0,t.jsxs)("div",{className:"flex-1 relative",children:[(0,t.jsx)("input",{className:"w-full bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-lg pl-4 pr-10 py-2.5 text-sm outline-none focus:border-violet-500 focus:ring-2 focus:ring-violet-500/10 transition-all font-medium placeholder:font-normal",placeholder:`Option ${w+1}`,value:C,autoFocus:w===x.options.length-1,onChange:N=>D(w,N.target.value)}),(0,t.jsxs)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-[10px] font-bold text-zinc-300 pointer-events-none",children:[C.length,"/25"]})]}),x.options.length>2&&(0,t.jsx)("button",{type:"button",onClick:()=>O(w),className:"p-2.5 text-zinc-400 hover:text-rose-500 hover:bg-rose-50 dark:hover:bg-rose-900/20 rounded-lg transition-colors",children:(0,t.jsx)(Os,{size:18})})]},w))}),x.options.length<4&&(0,t.jsx)("button",{type:"button",onClick:I,className:"w-full py-2.5 text-sm font-bold text-violet-600 dark:text-violet-400 hover:bg-violet-100 dark:hover:bg-violet-900/30 rounded-lg border border-dashed border-violet-200 dark:border-violet-800 transition-all",children:"+ Add option"}),(0,t.jsxs)("div",{className:"flex items-center gap-2 pt-1 px-1",children:[(0,t.jsx)("span",{className:"text-[10px] font-medium text-zinc-500",children:"Poll ends in"}),(0,t.jsxs)("select",{className:"bg-transparent text-[10px] font-bold text-zinc-700 dark:text-zinc-300 outline-none cursor-pointer hover:text-violet-600",value:x.duration,onChange:C=>h({...x,duration:C.target.value}),children:[(0,t.jsx)("option",{value:"1 day",children:"1 day"}),(0,t.jsx)("option",{value:"3 days",children:"3 days"}),(0,t.jsx)("option",{value:"7 days",children:"7 days"})]})]})]})]})]})})},Ro=Eo,Io=({isOpen:s,onClose:e})=>{const{currentUser:a}=pe(),{addToast:i}=ze(),n=Ct(),[r,l]=(0,g.useState)(null),[o,c]=(0,g.useState)(!1),[u,d]=(0,g.useState)(null),m=(0,g.useRef)(null),f=b=>{const v=b.target.files[0];v&&l(v)},p=()=>{if(!r)return;const b=new FileReader;b.onload=()=>{d(b.result)},b.readAsDataURL(r)},x=b=>{l(new File([b],`story-cropped-${Date.now()}.jpg`,{type:"image/jpeg"})),d(null)},h=async()=>{if(!(!r||!a)){c(!0);try{const b=await Ae(r);await Nr(a.id,b.url,b.type),l(null),e(),i("Story shared!"),n.invalidateQueries(["stories"])}catch(b){console.error("Failed to create story:",b),i("Failed to share story.")}finally{c(!1)}}};return(0,t.jsxs)(Ke,{isOpen:s,onClose:()=>!o&&e(),title:"Add Story",children:[(0,t.jsxs)("div",{className:"space-y-6",children:[r?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"relative aspect-[9/16] w-full max-w-[280px] mx-auto rounded-3xl overflow-hidden shadow-2xl",children:[(0,t.jsx)("img",{src:URL.createObjectURL(r),className:"w-full h-full object-cover",alt:"Preview"}),(0,t.jsx)("button",{onClick:()=>l(null),className:"absolute top-4 right-4 p-2 bg-black/50 text-white rounded-full hover:bg-rose-500 transition-colors",title:"Remove",children:(0,t.jsx)($e,{size:20})})]}),(0,t.jsxs)("div",{className:"flex items-center justify-center gap-4 py-2 bg-zinc-50/50 dark:bg-zinc-900/50 rounded-2xl",children:[(0,t.jsxs)("button",{onClick:p,className:"flex flex-col items-center gap-1.5 p-3 rounded-xl hover:bg-white dark:hover:bg-zinc-800 transition-all text-zinc-600 dark:text-zinc-400 hover:text-violet-600 dark:hover:text-violet-400 group",children:[(0,t.jsx)("div",{className:"p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm group-hover:shadow-md transition-all",children:(0,t.jsx)(St,{size:20})}),(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Crop / Edit"})]}),(0,t.jsxs)("button",{className:"flex flex-col items-center gap-1.5 p-3 rounded-xl opacity-40 cursor-not-allowed text-zinc-600 dark:text-zinc-400",children:[(0,t.jsx)("div",{className:"p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm",children:(0,t.jsx)("svg",{size:20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:(0,t.jsx)("path",{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 21 3 22l1-4.5L17 3z"})})}),(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Text"})]}),(0,t.jsxs)("button",{className:"flex flex-col items-center gap-1.5 p-3 rounded-xl opacity-40 cursor-not-allowed text-zinc-600 dark:text-zinc-400",children:[(0,t.jsx)("div",{className:"p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm",children:(0,t.jsxs)("svg",{size:20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[(0,t.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,t.jsx)("path",{d:"M8 14s1.5 2 4 2 4-2 4-2"}),(0,t.jsx)("line",{x1:"9",y1:"9",x2:"9.01",y2:"9"}),(0,t.jsx)("line",{x1:"15",y1:"9",x2:"15.01",y2:"9"})]})}),(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Stickers"})]})]})]}):(0,t.jsxs)("div",{className:"py-10",children:[(0,t.jsxs)("div",{className:"relative w-full group",onClick:()=>m.current?.click(),children:[(0,t.jsx)("div",{className:"relative z-40 cursor-pointer group-hover:translate-x-8 group-hover:shadow-2xl group-hover:-translate-y-8 transition-all duration-500 bg-zinc-900 dark:bg-white flex items-center justify-center h-32 w-32 mx-auto rounded-xl border-4 border-white dark:border-zinc-900",children:(0,t.jsxs)("svg",{className:"h-8 w-8 text-white/60 dark:text-zinc-950/60",strokeLinejoin:"round",strokeLinecap:"round",strokeWidth:"2",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,t.jsx)("path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2"}),(0,t.jsx)("path",{d:"M7 9l5 -5l5 5"}),(0,t.jsx)("path",{d:"M12 4l0 12"})]})}),(0,t.jsx)("div",{className:"absolute border-2 opacity-0 group-hover:opacity-80 transition-all duration-300 border-dashed border-violet-500 inset-0 z-30 bg-transparent flex items-center justify-center h-32 w-32 mx-auto rounded-xl"})]}),(0,t.jsxs)("div",{className:"text-center mt-8",children:[(0,t.jsx)("p",{className:"font-bold dark:text-white",children:"Choose a photo"}),(0,t.jsx)("p",{className:"text-sm text-zinc-500",children:"Stories last for 24 hours"})]})]}),(0,t.jsx)("input",{type:"file",ref:m,onChange:f,className:"hidden",accept:"image/*"}),(0,t.jsx)(xe,{className:"w-full py-3 text-lg",disabled:!r||o,onClick:h,children:o?(0,t.jsx)(ce,{size:24,className:"animate-spin mx-auto"}):"Share story"})]}),u&&(0,t.jsx)(Ul,{src:u,isOpen:!!u,onClose:()=>d(null),onCropComplete:x,aspect:9/16})]})},Lo=Io;function To({isOpen:s,onClose:e,community:a,onUpdate:i}){const{addToast:n}=ze(),[r,l]=(0,g.useState)({name:"",handle:"",description:"",avatar:"",cover:"",isPrivate:!1}),[o,c]=(0,g.useState)(!1),u=(0,g.useRef)(null),d=(0,g.useRef)(null);(0,g.useEffect)(()=>{a&&s&&l({name:a.name||"",handle:a.handle||"",description:a.description||"",avatar:a.avatar||"",cover:a.cover||"",isPrivate:a.isPrivate||!1})},[a,s]);const m=(x,h)=>{const b=x.target.files[0];b&&f(b,h)},f=async(x,h)=>{c(!0);try{const b=await Ae(x);l(v=>({...v,[h]:b.url})),n(`${h.charAt(0).toUpperCase()+h.slice(1)} uploaded!`)}catch{n(`Failed to upload ${h}`,"error")}finally{c(!1)}},p=async x=>{if(x.preventDefault(),!(!r.name||!r.handle||!a)){c(!0);try{const h=await $r(a.id,{name:r.name,handle:r.handle.toLowerCase().replace(/[^a-z0-9_]/g,""),description:r.description,avatar_url:r.avatar,cover_url:r.cover,is_private:r.isPrivate});n("Community updated successfully!"),i&&i(h),e()}catch(h){console.error(h),n(h.message||"Failed to update community","error")}finally{c(!1)}}};return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(Ke,{isOpen:s,onClose:()=>!o&&e(),title:"Edit Community",className:"sm:max-w-xl",children:[(0,t.jsxs)("div",{className:"space-y-6 max-h-[85vh] overflow-y-auto px-1",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("div",{className:"h-32 sm:h-40 bg-zinc-100 dark:bg-zinc-900 rounded-xl overflow-hidden relative group",children:[r.cover&&(0,t.jsx)("img",{src:r.cover,className:"w-full h-full object-cover",alt:""}),(0,t.jsx)("div",{className:"absolute inset-0 bg-black/20 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,t.jsx)("button",{onClick:()=>d.current?.click(),className:"p-3 bg-black/60 text-white rounded-full hover:bg-black transition-all",children:(0,t.jsx)(ss,{size:20})})})]}),(0,t.jsx)("div",{className:"absolute -bottom-8 left-6",children:(0,t.jsxs)("div",{className:"relative group size-20 sm:size-24 rounded-2xl border-4 border-white dark:border-black bg-zinc-100 dark:bg-zinc-800 overflow-hidden shadow-lg",children:[(0,t.jsx)("img",{src:r.avatar,className:"size-full object-cover",alt:""}),(0,t.jsx)("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,t.jsx)("button",{onClick:()=>u.current?.click(),className:"text-white p-2",children:(0,t.jsx)(ss,{size:18})})})]})})]}),(0,t.jsx)("div",{className:"pt-6",children:(0,t.jsxs)("form",{onSubmit:p,className:"space-y-5",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)("label",{className:"text-sm font-bold ml-1",children:"Community Name"}),(0,t.jsx)("input",{type:"text",required:!0,className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all font-medium",value:r.name,onChange:x=>l({...r,name:x.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)("label",{className:"text-sm font-bold ml-1",children:"Handle"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-zinc-500 font-medium text-sm",children:"c/"}),(0,t.jsx)("input",{type:"text",required:!0,className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl pl-8 pr-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all font-medium text-sm",value:r.handle,onChange:x=>l({...r,handle:x.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"")})})]})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)("label",{className:"text-sm font-bold ml-1",children:"Description"}),(0,t.jsx)("textarea",{className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all min-h-[100px] resize-none font-medium",placeholder:"What is this community about?",value:r.description,onChange:x=>l({...r,description:x.target.value})})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-zinc-50 dark:bg-zinc-900 rounded-xl border border-zinc-200 dark:border-zinc-800",children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-sm font-bold",children:"Private Community"}),(0,t.jsx)("span",{className:"text-[10px] text-zinc-500",children:"Only Admins can post in private communities"})]}),(0,t.jsx)("input",{type:"checkbox",className:"size-5 rounded-md accent-violet-600 cursor-pointer",checked:r.isPrivate,onChange:x=>l({...r,isPrivate:x.target.checked})})]})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-6 py-2",children:[(0,t.jsx)(xe,{type:"button",variant:"outline",className:"flex-1 rounded-xl h-11 font-bold",onClick:e,disabled:o,children:"Cancel"}),(0,t.jsx)(xe,{type:"submit",className:"flex-1 rounded-xl h-11 font-bold bg-zinc-900 dark:bg-white text-white dark:text-black hover:bg-zinc-800 dark:hover:bg-zinc-200 transition-all active:scale-95",disabled:o||!r.name,children:o?(0,t.jsx)(ce,{size:18,className:"animate-spin"}):"Save Changes"})]})]})})]}),(0,t.jsx)("input",{type:"file",ref:u,className:"hidden",accept:"image/*",onChange:x=>m(x,"avatar")}),(0,t.jsx)("input",{type:"file",ref:d,className:"hidden",accept:"image/*",onChange:x=>m(x,"cover")})]})})}var Do=({isOpen:s,onClose:e,editProfileData:a,setEditProfileData:i})=>{const{updateProfile:n}=pe(),{addToast:r}=ze(),[l,o]=(0,g.useState)(!1),[c,u]=(0,g.useState)(null),[d,m]=(0,g.useState)(null),f=(0,g.useRef)(null),p=(0,g.useRef)(null),x=(b,v)=>{const j=b.target.files[0];j&&(v==="avatar"?u(j):m(j))},h=async()=>{o(!0);try{let b=a.avatar,v=a.cover;c&&(b=(await Ae(c)).url),d&&(v=(await Ae(d)).url),await n({...a,avatar:b,cover:v}),u(null),m(null),e(),r("Profile updated!")}catch(b){console.error("Failed to update profile:",b),r("Failed to update profile.","error")}finally{o(!1)}};return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(Ke,{isOpen:s,onClose:()=>!l&&e(),title:"Edit Profile",children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("input",{type:"file",ref:p,className:"hidden",accept:"image/*",onChange:b=>x(b,"cover")}),(0,t.jsx)("input",{type:"file",ref:f,className:"hidden",accept:"image/*",onChange:b=>x(b,"avatar")}),(0,t.jsxs)("div",{className:"relative h-32 bg-zinc-100 dark:bg-zinc-800 rounded-xl overflow-hidden group cursor-pointer",onClick:()=>p.current?.click(),children:[(d||a?.cover)&&(0,t.jsx)("img",{src:d?URL.createObjectURL(d):a.cover,className:"w-full h-full object-cover opacity-60",alt:""}),(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsx)("div",{className:"bg-black/50 p-2 rounded-full text-white group-hover:scale-110 transition-transform",children:(0,t.jsx)(We,{size:20})})})]}),(0,t.jsx)("div",{className:"relative -mt-16 ml-4",children:(0,t.jsxs)("div",{className:"relative size-24 rounded-full border-4 border-white dark:border-black overflow-hidden group cursor-pointer shadow-lg bg-white dark:bg-black",onClick:()=>f.current?.click(),children:[(c||a?.avatar)&&(0,t.jsxs)(be,{className:"size-full opacity-60 rounded-none",children:[(0,t.jsx)(ge,{src:c?URL.createObjectURL(c):a.avatar,className:"object-cover"}),(0,t.jsx)(ve,{children:a?.handle?.[0]?.toUpperCase()})]}),(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsx)("div",{className:"bg-black/50 p-2 rounded-full text-white group-hover:scale-110 transition-transform",children:(0,t.jsx)(We,{size:16})})})]})}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(Fe,{label:"Name",value:a?.name||"",onChange:b=>i({...a,name:b.target.value})}),(0,t.jsx)(Fe,{label:"Bio",textarea:!0,value:a?.bio||"",onChange:b=>i({...a,bio:b.target.value})}),(0,t.jsx)(Fe,{label:"Location",value:a?.location||"",onChange:b=>i({...a,location:b.target.value})}),(0,t.jsx)(Fe,{label:"Website",value:a?.website||"",onChange:b=>i({...a,website:b.target.value})})]}),(0,t.jsx)(xe,{className:"w-full py-3",disabled:l,onClick:h,children:l?(0,t.jsx)(ce,{size:24,className:"animate-spin text-white mx-auto"}):"Save changes"})]})})})},Oo=Do;function qo({isOpen:s,onClose:e,community:a}){const{addToast:i}=ze(),{currentUser:n}=pe(),[r,l]=(0,g.useState)([]),[o,c]=(0,g.useState)(!1),[u,d]=(0,g.useState)(""),[m,f]=(0,g.useState)("members"),[p,x]=(0,g.useState)(!1),h=n?.id===a?.creatorId,b=(0,g.useCallback)(async(k="")=>{if(a?.id){c(!0),x(!0);try{l(await Ar(a.id,k))}catch(_){console.error("Failed to load members:",_),i("Failed to load members","error")}finally{c(!1)}}},[a?.id,i]);(0,g.useEffect)(()=>{s&&a?.id?b(""):(d(""),l([]),x(!1))},[s,a?.id,b]),(0,g.useEffect)(()=>{if(u.length>=2){const k=setTimeout(()=>{b(u)},500);return()=>clearTimeout(k)}else u.length===0&&p&&b("")},[u,b,p]);const v=async(k,_)=>{try{const $=_==="admin"?"member":"admin";await Mr(a.id,k,$),l(A=>A.map(S=>S.userId===k?{...S,role:$}:S)),i(`Role updated to ${$}`)}catch{i("Failed to update role","error")}},j=(0,g.useMemo)(()=>r.filter(k=>k.role==="admin"||k.userId===a.creatorId),[r,a.creatorId]),y=(0,g.useMemo)(()=>r.filter(k=>k.role!=="admin"&&k.userId!==a.creatorId),[r,a.creatorId]),z=k=>o?(0,t.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,t.jsx)(ce,{className:"animate-spin text-violet-500",size:32})}):k.length>0?(0,t.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800/50",children:k.map(_=>(0,t.jsxs)("div",{className:"p-4 flex items-center justify-between hover:bg-white dark:hover:bg-zinc-800/50 transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)(be,{className:"size-10 border border-zinc-200 dark:border-zinc-700 shadow-sm",children:[(0,t.jsx)(ge,{src:_.user.avatar_url}),(0,t.jsx)(ve,{children:_.user.username?.[0]?.toUpperCase()})]}),(0,t.jsxs)("div",{className:"flex flex-col min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"text-sm font-bold truncate max-w-[140px] dark:text-white",children:_.user.display_name}),_.user.is_verified&&(0,t.jsx)(dt,{})]}),(0,t.jsxs)("span",{className:"text-xs text-zinc-500 font-medium",children:["@",_.user.username]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[_.userId===a.creatorId?(0,t.jsx)("span",{className:"text-[10px] font-black px-3 py-1 bg-zinc-200 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 rounded-full tracking-wider",children:"OWNER"}):h&&(0,t.jsx)("button",{onClick:()=>v(_.userId,_.role),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-full text-[11px] font-bold transition-all ${_.role==="admin"?"bg-rose-50 text-rose-600 hover:bg-rose-100 dark:bg-rose-950/20 dark:text-rose-400":"bg-zinc-100 text-zinc-600 hover:bg-zinc-200 dark:bg-zinc-800 dark:text-zinc-400 dark:hover:bg-zinc-700"}`,children:_.role==="admin"?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ws,{size:14}),"Admin"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Lt,{size:14}),"Make Admin"]})}),!h&&_.role==="admin"&&_.userId!==a.creatorId&&(0,t.jsx)("span",{className:"text-[10px] font-black px-3 py-1 bg-violet-50 dark:bg-violet-900/20 text-violet-600 dark:text-violet-400 rounded-full tracking-wider",children:"ADMIN"})]})]},_.userId))}):(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-center px-6",children:[(0,t.jsx)("div",{className:"size-12 rounded-full bg-zinc-100 dark:bg-zinc-800 flex items-center justify-center mb-3",children:(0,t.jsx)(Lt,{size:24,className:"text-zinc-400"})}),(0,t.jsxs)("p",{className:"text-sm font-bold dark:text-white",children:["No ",m," found"]}),(0,t.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"Try a different search term"})]});return(0,t.jsx)(Ke,{isOpen:s,onClose:e,title:"Manage Members",className:"sm:max-w-md",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(Bt,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-zinc-400",size:18}),(0,t.jsx)("input",{type:"text",placeholder:"Search members...",className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl pl-10 pr-4 py-2.5 text-sm outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all font-medium",value:u,onChange:k=>d(k.target.value)})]}),(0,t.jsxs)(Zt,{value:m,onValueChange:f,className:"w-full",children:[(0,t.jsxs)(Gt,{className:"w-full bg-zinc-100 dark:bg-zinc-900 p-1 rounded-xl h-11",children:[(0,t.jsxs)(mt,{value:"members",className:"flex-1 rounded-lg font-bold data-[state=active]:bg-white dark:data-[state=active]:bg-zinc-800 dark:text-zinc-400 dark:data-[state=active]:text-white",children:["Members (",y.length,")"]}),(0,t.jsxs)(mt,{value:"admins",className:"flex-1 rounded-lg font-bold data-[state=active]:bg-white dark:data-[state=active]:bg-zinc-800 dark:text-zinc-400 dark:data-[state=active]:text-white",children:["Admins (",j.length,")"]})]}),(0,t.jsxs)("div",{className:"mt-4 bg-zinc-50 dark:bg-zinc-900 rounded-2xl border border-zinc-100 dark:border-zinc-800 overflow-hidden min-h-[300px] max-h-[400px] overflow-y-auto",children:[(0,t.jsx)(ot,{value:"members",className:"m-0",children:z(y)}),(0,t.jsx)(ot,{value:"admins",className:"m-0",children:z(j)})]})]})]})})}var Wo=Q(),Uo=s=>{const e=(0,Wo.c)(22),{isPostModalOpen:a,setIsPostModalOpen:i,isEditProfileOpen:n,setIsEditProfileOpen:r,isStoryModalOpen:l,setIsStoryModalOpen:o,editProfileData:c,setEditProfileData:u,postCommunity:d}=s;let m;e[0]!==i?(m=()=>i(!1),e[0]=i,e[1]=m):m=e[1];let f;e[2]!==a||e[3]!==d||e[4]!==m?(f=(0,t.jsx)(Ro,{isOpen:a,onClose:m,initialCommunity:d}),e[2]=a,e[3]=d,e[4]=m,e[5]=f):f=e[5];let p;e[6]!==r?(p=()=>r(!1),e[6]=r,e[7]=p):p=e[7];let x;e[8]!==c||e[9]!==n||e[10]!==u||e[11]!==p?(x=(0,t.jsx)(Oo,{isOpen:n,onClose:p,editProfileData:c,setEditProfileData:u}),e[8]=c,e[9]=n,e[10]=u,e[11]=p,e[12]=x):x=e[12];let h;e[13]!==o?(h=()=>o(!1),e[13]=o,e[14]=h):h=e[14];let b;e[15]!==l||e[16]!==h?(b=(0,t.jsx)(Lo,{isOpen:l,onClose:h}),e[15]=l,e[16]=h,e[17]=b):b=e[17];let v;return e[18]!==f||e[19]!==x||e[20]!==b?(v=(0,t.jsxs)(t.Fragment,{children:[f,x,b]}),e[18]=f,e[19]=x,e[20]=b,e[21]=v):v=e[21],v},Bo=Uo,Vo=Q(),Jo=s=>{const e=(0,Vo.c)(91),{story:a,onClose:i}=s,[n,r]=(0,g.useState)(0),[l,o]=(0,g.useState)(0),[c,u]=(0,g.useState)(!1),d=a.stories,m=d[n];let f;e[0]!==n||e[1]!==i||e[2]!==d.length||e[3]!==a.user.id?(f=()=>{n<d.length-1?(r(Ho),o(0)):i(a.user.id)},e[0]=n,e[1]=i,e[2]=d.length,e[3]=a.user.id,e[4]=f):f=e[4];const p=f;let x;e[5]!==n?(x=()=>{n>0&&(r(Ko),o(0))},e[5]=n,e[6]=x):x=e[6];const h=x;let b;e[7]===Symbol.for("react.memo_cache_sentinel")?(b=K=>{K.stopPropagation(),u(Yo)},e[7]=b):b=e[7];const v=b;let j;e[8]!==p||e[9]!==c?(j=()=>{if(c)return;const K=setInterval(()=>{o(ee=>ee>=100?(p(),100):ee+1)},50);return()=>clearInterval(K)},e[8]=p,e[9]=c,e[10]=j):j=e[10];let y;e[11]!==n||e[12]!==p||e[13]!==c?(y=[p,n,c],e[11]=n,e[12]=p,e[13]=c,e[14]=y):y=e[14],(0,g.useEffect)(j,y);let z;if(e[15]!==n||e[16]!==l||e[17]!==d){let K;e[19]!==n||e[20]!==l?(K=(ee,X)=>(0,t.jsx)("div",{className:"flex-1 h-full bg-white/30 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-white transition-all duration-100",style:{width:X<n?"100%":X===n?`${l}%`:"0%"}})},X),e[19]=n,e[20]=l,e[21]=K):K=e[21],z=d.map(K),e[15]=n,e[16]=l,e[17]=d,e[18]=z}else z=e[18];let k;e[22]!==z?(k=(0,t.jsx)("div",{className:"flex gap-1.5 h-0.5 w-full bg-transparent",children:z}),e[22]=z,e[23]=k):k=e[23];const _=`/u/${a.user.handle}`;let $;e[24]!==a.user.avatar||e[25]!==a.user.handle?($=(0,t.jsx)(ge,{src:a.user.avatar,alt:a.user.handle,className:"object-cover"}),e[24]=a.user.avatar,e[25]=a.user.handle,e[26]=$):$=e[26];let A;e[27]!==a.user.handle?.[0]?(A=a.user.handle?.[0]?.toUpperCase(),e[27]=a.user.handle?.[0],e[28]=A):A=e[28];let S;e[29]!==A?(S=(0,t.jsx)(ve,{children:A}),e[29]=A,e[30]=S):S=e[30];let F;e[31]!==S||e[32]!==$?(F=(0,t.jsxs)(be,{className:"size-10 border border-white/20 shadow-sm",children:[$,S]}),e[31]=S,e[32]=$,e[33]=F):F=e[33];let M;e[34]!==a.user.handle?(M=(0,t.jsx)("span",{className:"text-white text-sm font-bold shadow-black drop-shadow-md",children:a.user.handle}),e[34]=a.user.handle,e[35]=M):M=e[35];let R;e[36]!==m.created_at?(R=new Date(m.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),e[36]=m.created_at,e[37]=R):R=e[37];let E;e[38]!==R?(E=(0,t.jsx)("span",{className:"text-white/60 text-[10px] shadow-black drop-shadow-md",children:R}),e[38]=R,e[39]=E):E=e[39];let I;e[40]!==M||e[41]!==E?(I=(0,t.jsxs)("div",{className:"flex flex-col",children:[M,E]}),e[40]=M,e[41]=E,e[42]=I):I=e[42];let O;e[43]!==F||e[44]!==I||e[45]!==_?(O=(0,t.jsxs)(Wt,{to:_,className:"flex items-center gap-3 hover:opacity-80 transition-opacity",onClick:Xo,children:[F,I]}),e[43]=F,e[44]=I,e[45]=_,e[46]=O):O=e[46];let D;e[47]!==i||e[48]!==a.user.id?(D=()=>i(a.user.id),e[47]=i,e[48]=a.user.id,e[49]=D):D=e[49];let P;e[50]===Symbol.for("react.memo_cache_sentinel")?(P=(0,t.jsx)($e,{size:24}),e[50]=P):P=e[50];let C;e[51]!==D?(C=(0,t.jsx)("button",{onClick:D,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors",children:P}),e[51]=D,e[52]=C):C=e[52];let w;e[53]!==O||e[54]!==C?(w=(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[O,C]}),e[53]=O,e[54]=C,e[55]=w):w=e[55];let N;e[56]!==w||e[57]!==k?(N=(0,t.jsxs)("div",{className:"absolute top-0 left-0 right-0 p-4 z-20 flex flex-col gap-4",children:[k,w]}),e[56]=w,e[57]=k,e[58]=N):N=e[58];let L;e[59]!==n||e[60]!==h?(L=n>0&&(0,t.jsx)("button",{onClick:K=>{K.stopPropagation(),h()},className:"absolute left-4 z-30 p-2 bg-black/20 hover:bg-black/40 rounded-full text-white backdrop-blur-md transition-all active:scale-90",children:(0,t.jsx)(Is,{size:32})}),e[59]=n,e[60]=h,e[61]=L):L=e[61];let W;e[62]!==m.id||e[63]!==m.media?(W=(0,t.jsx)("img",{src:m.media,className:"max-w-full max-h-full object-contain rounded-xl shadow-2xl animate-in fade-in zoom-in-95 duration-300",alt:""},m.id),e[62]=m.id,e[63]=m.media,e[64]=W):W=e[64];let T;e[65]!==c?(T=c&&(0,t.jsx)("div",{className:"absolute inset-0 z-10 flex items-center justify-center pointer-events-none",children:(0,t.jsx)("div",{className:"px-4 py-2 bg-black/40 rounded-full text-white text-xs font-bold backdrop-blur-md border border-white/10 animate-in fade-in zoom-in duration-200",children:"PAUSED"})}),e[65]=c,e[66]=T):T=e[66];let B;e[67]!==W||e[68]!==T?(B=(0,t.jsxs)("div",{className:"relative w-full h-full flex items-center justify-center",children:[W,T]}),e[67]=W,e[68]=T,e[69]=B):B=e[69];let H;e[70]!==p?(H=K=>{K.stopPropagation(),p()},e[70]=p,e[71]=H):H=e[71];let te;e[72]===Symbol.for("react.memo_cache_sentinel")?(te=(0,t.jsx)(Xe,{size:32}),e[72]=te):te=e[72];let re;e[73]!==H?(re=(0,t.jsx)("button",{onClick:H,className:"absolute right-4 z-30 p-2 bg-black/20 hover:bg-black/40 rounded-full text-white backdrop-blur-md transition-all active:scale-90",children:te}),e[73]=H,e[74]=re):re=e[74];let ie;e[75]!==h?(ie=(0,t.jsx)("div",{className:"w-[30%] cursor-w-resize",onClick:h}),e[75]=h,e[76]=ie):ie=e[76];let oe;e[77]===Symbol.for("react.memo_cache_sentinel")?(oe=(0,t.jsx)("div",{className:"w-[40%] cursor-pointer flex items-center justify-center",onClick:v}),e[77]=oe):oe=e[77];let G;e[78]!==p?(G=(0,t.jsx)("div",{className:"w-[30%] cursor-e-resize",onClick:p}),e[78]=p,e[79]=G):G=e[79];let ae;e[80]!==ie||e[81]!==G?(ae=(0,t.jsxs)("div",{className:"absolute inset-0 flex z-20",children:[ie,oe,G]}),e[80]=ie,e[81]=G,e[82]=ae):ae=e[82];let V;e[83]!==L||e[84]!==B||e[85]!==re||e[86]!==ae?(V=(0,t.jsxs)("div",{className:"w-full h-full max-w-xl relative flex items-center justify-center p-2",children:[L,B,re,ae]}),e[83]=L,e[84]=B,e[85]=re,e[86]=ae,e[87]=V):V=e[87];let J;return e[88]!==N||e[89]!==V?(J=(0,t.jsxs)("div",{className:"fixed inset-0 z-[100] bg-black flex flex-col items-center justify-center animate-in fade-in duration-300",children:[N,V]}),e[88]=N,e[89]=V,e[90]=J):J=e[90],J},Qo=Jo;function Ho(s){return s+1}function Ko(s){return s-1}function Yo(s){return!s}function Xo(s){return s.stopPropagation()}var Zo=({type:s,onComplete:e,onSwitch:a})=>{const{login:i,signup:n}=pe(),{addToast:r}=ze(),[l,o]=(0,g.useState)({name:"",email:"",username:"",password:""}),[c,u]=(0,g.useState)(!1),[d,m]=(0,g.useState)(null),f=async p=>{p.preventDefault(),u(!0),m(null);try{s==="login"?(await i({email:l.email,password:l.password}),r("Welcome back!"),e()):(await n({email:l.email,password:l.password,username:l.username,name:l.name}),r("Confirm Your Email","info"),a())}catch(x){console.error("Auth error:",x),m(x.message||"Authentication failed. Please check your credentials."),r("Authentication failed!")}finally{u(!1)}};return(0,t.jsxs)("div",{className:"max-w-md mx-auto p-8 w-full animate-in fade-in slide-in-from-bottom-5 duration-300",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsx)("div",{className:"flex justify-center mb-4",children:(0,t.jsx)("div",{className:"bg-black dark:bg-white dark:text-black text-white p-3 rounded-2xl shadow-lg",children:(0,t.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",alt:"Logo",className:"w-10 h-10 rounded-xl"})})}),(0,t.jsx)("h2",{className:"text-3xl font-extrabold mb-2 dark:text-white tracking-tight",children:s==="login"?"Welcome back!":"Join Sysm today"}),(0,t.jsx)("p",{className:"text-zinc-500 font-medium",children:"The decentralized social network"})]}),d&&(0,t.jsxs)("div",{className:"mb-6 p-4 bg-rose-50 dark:bg-rose-900/20 border border-rose-100 dark:border-rose-800 rounded-xl flex items-center gap-3 text-rose-600 dark:text-rose-400 text-sm",children:[(0,t.jsx)(zs,{size:18}),(0,t.jsx)("span",{children:d})]}),(0,t.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,t.jsx)(Fe,{label:"Email",type:"email",placeholder:"john@example.com",value:l.email,onChange:p=>o({...l,email:p.target.value}),required:!0}),s==="signup"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Fe,{label:"Name",placeholder:"John Doe",value:l.name,onChange:p=>o({...l,name:p.target.value}),required:!0}),(0,t.jsx)(Fe,{label:"Username",placeholder:"johndoe",value:l.username,onChange:p=>{const x=p.target.value.replace(/[^a-zA-Z0-9_]/g,"");o({...l,username:x})},required:!0})]}),(0,t.jsx)(Fe,{label:"Password",type:"password",placeholder:"",value:l.password,onChange:p=>o({...l,password:p.target.value}),required:!0}),(0,t.jsx)(xe,{type:"submit",className:"w-full justify-center py-3 mt-6 text-lg",disabled:c,children:c?(0,t.jsx)(ce,{size:24,className:"animate-spin"}):s==="login"?"Log in":"Sign up"})]}),(0,t.jsxs)("div",{className:"mt-8 text-center text-sm",children:[(0,t.jsx)("span",{className:"text-zinc-500",children:s==="login"?"Don't have an account?":"Already have an account?"}),(0,t.jsx)("button",{onClick:a,className:"font-bold ml-1 hover:underline dark:text-white",children:s==="login"?"Sign up":"Log in"})]})]})},Go=Zo,ec=Q(),tc=s=>{const e=(0,ec.c)(20),{icon:a,count:i,label:n,onClick:r,active:l,activeColorClass:o}=s,c=o===void 0?"text-violet-600":o,u=a;let d;e[0]!==r?(d=z=>{z.stopPropagation(),r&&r(z)},e[0]=r,e[1]=d):d=e[1];const m=`group flex items-center gap-x-1 sm:gap-x-1.5 text-[12px] sm:text-[13px] font-bold transition-all py-1.5 px-2 -ml-2 rounded-xl active:scale-95 ${l?c:"text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-300"}`,f=`rounded-full p-2 transition-colors ${l?"":"group-hover:bg-zinc-100 dark:group-hover:bg-zinc-800"}`,p=l?2.5:2,x=l?"fill-current":"";let h;e[2]!==u||e[3]!==p||e[4]!==x?(h=(0,t.jsx)(u,{size:18,strokeWidth:p,className:x}),e[2]=u,e[3]=p,e[4]=x,e[5]=h):h=e[5];let b;e[6]!==f||e[7]!==h?(b=(0,t.jsx)("div",{className:f,children:h}),e[6]=f,e[7]=h,e[8]=b):b=e[8];let v;e[9]!==n?(v=n&&(0,t.jsx)("span",{className:"hidden xs:inline",children:n}),e[9]=n,e[10]=v):v=e[10];let j;e[11]!==l||e[12]!==i?(j=i!=null&&(0,t.jsx)("span",{className:l?"font-bold":"",children:i||0}),e[11]=l,e[12]=i,e[13]=j):j=e[13];let y;return e[14]!==j||e[15]!==d||e[16]!==m||e[17]!==b||e[18]!==v?(y=(0,t.jsxs)("button",{onClick:d,className:m,children:[b,v,j]}),e[14]=j,e[15]=d,e[16]=m,e[17]=b,e[18]=v,e[19]=y):y=e[19],y},it=tc,sc=Q(),ac=s=>{const e=(0,sc.c)(51),{currentUser:a,newComment:i,setNewComment:n,handleSubmitComment:r,loading:l,selectedFiles:o,setSelectedFiles:c,isUploading:u}=s;let d;e[0]!==o?(d=o===void 0?[]:o,e[0]=o,e[1]=d):d=e[1];const m=d,f=(0,g.useRef)(null);let p;e[2]!==c?(p=P=>{const C=Array.from(P.target.files);c&&c(w=>[...w,...C])},e[2]=c,e[3]=p):p=e[3];const x=p;let h;e[4]!==c?(h=P=>{c&&c(C=>C.filter((w,N)=>N!==P))},e[4]=c,e[5]=h):h=e[5];const b=h;if(!a){let P;return e[6]===Symbol.for("react.memo_cache_sentinel")?(P=(0,t.jsx)("div",{className:"p-6 text-center border-y border-zinc-100 dark:border-zinc-800 bg-zinc-50/30 dark:bg-zinc-900/10",children:(0,t.jsx)("p",{className:"text-zinc-500 text-sm",children:"Please login to join the conversation."})}),e[6]=P):P=e[6],P}let v;e[7]!==a.avatar||e[8]!==a.handle?(v=(0,t.jsx)(ge,{src:a.avatar,alt:a.handle,className:"object-cover"}),e[7]=a.avatar,e[8]=a.handle,e[9]=v):v=e[9];let j;e[10]!==a.handle?.[0]?(j=a.handle?.[0]?.toUpperCase(),e[10]=a.handle?.[0],e[11]=j):j=e[11];let y;e[12]!==j?(y=(0,t.jsx)(ve,{children:j}),e[12]=j,e[13]=y):y=e[13];let z;e[14]!==v||e[15]!==y?(z=(0,t.jsxs)(be,{className:"size-9 border border-zinc-200 dark:border-zinc-700",children:[v,y]}),e[14]=v,e[15]=y,e[16]=z):z=e[16];let k;e[17]!==n?(k=P=>n(P.target.value),e[17]=n,e[18]=k):k=e[18];let _;e[19]!==i||e[20]!==k?(_=(0,t.jsx)("textarea",{id:"comment-input",className:"w-full bg-transparent outline-none text-base min-h-[60px] resize-none dark:text-white placeholder:text-zinc-500",placeholder:"Post your reply...",value:i,onChange:k}),e[19]=i,e[20]=k,e[21]=_):_=e[21];let $;e[22]!==b||e[23]!==m?($=m.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mt-2 mb-2",children:m.map((P,C)=>(0,t.jsxs)("div",{className:"relative size-20 rounded-xl overflow-hidden border border-zinc-200 dark:border-zinc-800",children:[P.type.startsWith("image/")?(0,t.jsx)("img",{src:URL.createObjectURL(P),className:"size-full object-cover",alt:""}):(0,t.jsx)("div",{className:"size-full flex items-center justify-center bg-zinc-100 dark:bg-zinc-800",children:(0,t.jsx)(Ws,{size:20,className:"text-zinc-500"})}),(0,t.jsx)("button",{onClick:()=>b(C),className:"absolute top-1 right-1 bg-black/60 text-white rounded-full p-1 hover:bg-black transition-colors",children:(0,t.jsx)($e,{size:12})})]},C))}),e[22]=b,e[23]=m,e[24]=$):$=e[24];let A;e[25]===Symbol.for("react.memo_cache_sentinel")?(A=()=>f.current?.click(),e[25]=A):A=e[25];let S;e[26]===Symbol.for("react.memo_cache_sentinel")?(S=(0,t.jsx)("button",{type:"button",onClick:A,className:"text-violet-600 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full p-2 transition-colors",title:"Attach media",children:(0,t.jsx)(Es,{size:20})}),e[26]=S):S=e[26];let F;e[27]!==x?(F=(0,t.jsxs)("div",{className:"flex text-violet-600 gap-1",children:[S,(0,t.jsx)("input",{type:"file",ref:f,onChange:x,multiple:!0,className:"hidden",accept:"image/*,video/*,application/pdf"})]}),e[27]=x,e[28]=F):F=e[28];let M;e[29]!==u||e[30]!==l||e[31]!==i||e[32]!==m.length?(M=!i.trim()&&m.length===0||l||u,e[29]=u,e[30]=l,e[31]=i,e[32]=m.length,e[33]=M):M=e[33];let R;e[34]!==u||e[35]!==l?(R=l||u?(0,t.jsx)(ce,{size:16,className:"animate-spin text-white mx-auto"}):"Reply",e[34]=u,e[35]=l,e[36]=R):R=e[36];let E;e[37]!==r||e[38]!==M||e[39]!==R?(E=(0,t.jsx)(xe,{className:"!w-auto px-5 py-1.5 text-sm font-bold min-w-[70px]",onClick:r,disabled:M,children:R}),e[37]=r,e[38]=M,e[39]=R,e[40]=E):E=e[40];let I;e[41]!==F||e[42]!==E?(I=(0,t.jsxs)("div",{className:"flex justify-between items-center mt-2 pt-3 border-t border-zinc-100 dark:border-zinc-800",children:[F,E]}),e[41]=F,e[42]=E,e[43]=I):I=e[43];let O;e[44]!==_||e[45]!==$||e[46]!==I?(O=(0,t.jsxs)("div",{className:"flex-1",children:[_,$,I]}),e[44]=_,e[45]=$,e[46]=I,e[47]=O):O=e[47];let D;return e[48]!==O||e[49]!==z?(D=(0,t.jsx)("div",{className:"p-4 border-y border-zinc-100 dark:border-zinc-800 bg-zinc-50/30 dark:bg-zinc-900/10",children:(0,t.jsxs)("div",{className:"flex gap-3",children:[z,O]})}),e[48]=O,e[49]=z,e[50]=D):D=e[50],D},Ra=ac,ic=Q(),nc=s=>{const e=(0,ic.c)(17),{file:a}=s;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=(0,t.jsx)("div",{className:"size-10 rounded-xl bg-violet-100 dark:bg-violet-900/30 flex items-center justify-center text-violet-600",children:(0,t.jsx)(Ps,{size:20})}),e[0]=i):i=e[0];let n;e[1]!==a.name?(n=(0,t.jsx)("div",{className:"text-sm font-bold truncate dark:text-white",children:a.name}),e[1]=a.name,e[2]=n):n=e[2];const r=a.size/1024/1024;let l;e[3]!==r?(l=r.toFixed(2),e[3]=r,e[4]=l):l=e[4];let o;e[5]!==l?(o=(0,t.jsxs)("div",{className:"text-xs text-zinc-500 uppercase",children:[l," MB"]}),e[5]=l,e[6]=o):o=e[6];let c;e[7]!==n||e[8]!==o?(c=(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[n,o]}),e[7]=n,e[8]=o,e[9]=c):c=e[9];let u;e[10]===Symbol.for("react.memo_cache_sentinel")?(u=(0,t.jsx)(Ss,{size:18}),e[10]=u):u=e[10];let d;e[11]!==a.name||e[12]!==a.url?(d=(0,t.jsx)("a",{href:a.url,download:a.name,className:"p-2 text-zinc-400 hover:text-violet-600 transition-colors",onClick:lc,children:u}),e[11]=a.name,e[12]=a.url,e[13]=d):d=e[13];let m;return e[14]!==c||e[15]!==d?(m=(0,t.jsxs)("div",{className:"mt-3 flex items-center gap-3 p-3 rounded-2xl border border-zinc-100 dark:border-zinc-800 bg-zinc-50/50 dark:bg-zinc-900/10 group hover:border-violet-500/30 transition-colors",children:[i,c,d]}),e[14]=c,e[15]=d,e[16]=m):m=e[16],m},rc=nc;function lc(s){return s.stopPropagation()}var Qd=Q(),oc=Q(),cc=s=>{const e=(0,oc.c)(30),{url:a}=s;let i,n;e[0]!==a?(i=["link-preview",a],n=()=>Rr(a),e[0]=a,e[1]=i,e[2]=n):(i=e[1],n=e[2]);const r=!!a;let l;e[3]!==i||e[4]!==n||e[5]!==r?(l={queryKey:i,queryFn:n,staleTime:864e5,enabled:r},e[3]=i,e[4]=n,e[5]=r,e[6]=l):l=e[6];const{data:o,isLoading:c,isError:u}=Ee(l);if(c){let y;return e[7]===Symbol.for("react.memo_cache_sentinel")?(y=(0,t.jsx)("div",{className:"mt-3 rounded-2xl border border-zinc-100 dark:border-zinc-800 overflow-hidden animate-pulse bg-zinc-50 dark:bg-zinc-900/50 h-24 flex items-center justify-center",children:(0,t.jsx)(Nt,{className:"text-zinc-300 dark:text-zinc-700 animate-spin",size:24})}),e[7]=y):y=e[7],y}if(u||!o||!o.title&&!o.image)return null;let d;e[8]!==o.image||e[9]!==o.title?(d=o.image&&(0,t.jsx)("div",{className:"w-full aspect-[1.91/1] overflow-hidden bg-zinc-100 dark:bg-zinc-900 border-b border-zinc-100 dark:border-zinc-800",children:(0,t.jsx)("img",{src:o.image,alt:o.title,className:"w-full h-full object-cover group-hover:scale-[1.02] transition-transform duration-500",onError:mc})}),e[8]=o.image,e[9]=o.title,e[10]=d):d=e[10];let m;e[11]===Symbol.for("react.memo_cache_sentinel")?(m=(0,t.jsx)(Nt,{size:12}),e[11]=m):m=e[11];let f;e[12]!==o.siteName?(f=(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-zinc-500 font-bold uppercase tracking-wider",children:[m,(0,t.jsx)("span",{children:o.siteName})]}),e[12]=o.siteName,e[13]=f):f=e[13];let p;e[14]!==o.title?(p=(0,t.jsx)("h4",{className:"font-bold text-[15px] line-clamp-2 dark:text-white leading-snug group-hover:text-violet-600 transition-colors",children:o.title}),e[14]=o.title,e[15]=p):p=e[15];let x;e[16]!==o.description?(x=o.description&&(0,t.jsx)("p",{className:"text-xs text-zinc-500 dark:text-zinc-400 line-clamp-2 leading-relaxed",children:o.description}),e[16]=o.description,e[17]=x):x=e[17];let h;e[18]===Symbol.for("react.memo_cache_sentinel")?(h=(0,t.jsx)(gi,{size:10}),e[18]=h):h=e[18];let b;e[19]!==a?(b=(0,t.jsxs)("div",{className:"pt-1 flex items-center gap-1 text-[11px] text-zinc-400 font-medium",children:[h,(0,t.jsx)("span",{className:"truncate",children:a})]}),e[19]=a,e[20]=b):b=e[20];let v;e[21]!==b||e[22]!==f||e[23]!==p||e[24]!==x?(v=(0,t.jsxs)("div",{className:"p-3.5 space-y-1",children:[f,p,x,b]}),e[21]=b,e[22]=f,e[23]=p,e[24]=x,e[25]=v):v=e[25];let j;return e[26]!==v||e[27]!==d||e[28]!==a?(j=(0,t.jsxs)("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"mt-3 flex flex-col rounded-2xl border border-zinc-100 dark:border-zinc-800 overflow-hidden bg-white dark:bg-zinc-950 hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-all group shadow-sm",onClick:dc,children:[d,v]}),e[26]=v,e[27]=d,e[28]=a,e[29]=j):j=e[29],j},hs=cc;function dc(s){return s.stopPropagation()}function mc(s){return s.target.style.display="none"}var uc=Q(),fc=s=>{const e=(0,uc.c)(17),{src:a,poster:i}=s,n=(0,g.useRef)(null),{reportVisibility:r,unregister:l}=al(),{dataSaver:o}=pt(),c=(0,g.useId)();let u;e[0]===Symbol.for("react.memo_cache_sentinel")?(u={play:()=>{const y=n.current?.plyr;y&&(y.muted=!0,y.play().catch(hc))},pause:()=>{n.current?.plyr?.pause()}},e[0]=u):u=e[0];const d=u;let m,f;e[1]!==o||e[2]!==c||e[3]!==r||e[4]!==l?(m=()=>{const y=new IntersectionObserver(k=>{const[_]=k;r(c,o?0:_.intersectionRatio,d)},{threshold:[0,.6]}),z=n.current?.elements?.container;return z&&y.observe(z),()=>{l(c),z&&y.unobserve(z)}},f=[c,r,l,d,o],e[1]=o,e[2]=c,e[3]=r,e[4]=l,e[5]=m,e[6]=f):(m=e[5],f=e[6]),(0,g.useEffect)(m,f);let p;e[7]!==a?(p=[{src:a,type:"video/mp4"}],e[7]=a,e[8]=p):p=e[8];let x;e[9]!==i||e[10]!==p?(x={type:"video",sources:p,poster:i},e[9]=i,e[10]=p,e[11]=x):x=e[11];let h;e[12]===Symbol.for("react.memo_cache_sentinel")?(h={controls:["play-large","play","progress","current-time","mute","volume","fullscreen"],settings:["quality","speed"],ratio:"16:9",clickToPlay:!0,hideControls:!0,resetOnEnd:!0},e[12]=h):h=e[12];let b;e[13]!==x?(b={source:x,options:h},e[13]=x,e[14]=b):b=e[14];const v=b;let j;return e[15]!==v?(j=(0,t.jsx)("div",{className:"mt-3 overflow-hidden rounded-2xl shadow-sm border border-zinc-100 dark:border-zinc-800 bg-black",onClick:pc,children:(0,t.jsx)(Js,{ref:n,...v})}),e[15]=v,e[16]=j):j=e[16],j},xc=fc;function hc(){}function pc(s){return s.stopPropagation()}var bc=Q(),gc=s=>{const e=(0,bc.c)(3),{items:a}=s,i=a===void 0?[]:a,{openLightbox:n}=Jt();if(!i||i.length===0)return null;const r=Array.isArray(i)?i:[i],l=r.filter(jc),o=r.filter(wc),c=p=>{const x=l.filter(yc).map(zc),h=l[p];n(x,x.indexOf(h.url||h.src))},u="mt-3 space-y-2",d=l.length>0&&(0,t.jsx)("div",{className:`grid gap-2 rounded-2xl overflow-hidden border border-zinc-100 dark:border-zinc-800 ${l.length===1?"grid-cols-1":l.length===2?"grid-cols-2 aspect-[16/9]":(l.length===3,"grid-cols-2 grid-rows-2 aspect-[16/9]")}`,children:l.map((p,x)=>(0,t.jsx)("div",{className:`relative overflow-hidden bg-zinc-100 dark:bg-zinc-900 cursor-pointer ${l.length===3&&x===0?"row-span-2":""}`,onClick:h=>{p.type==="image"&&(h.stopPropagation(),c(x))},children:p.type==="video"?(0,t.jsx)(xc,{src:p.url,poster:p.poster}):(0,t.jsx)("img",{src:p.url||p.src,className:"size-full object-cover hover:scale-[1.02] transition-transform duration-500",alt:"",loading:"lazy"})},x))}),m=o.map(Nc);let f;return e[0]!==d||e[1]!==m?(f=(0,t.jsxs)("div",{className:u,children:[d,m]}),e[0]=d,e[1]=m,e[2]=f):f=e[2],f},vc=gc;function jc(s){return s.type==="image"||s.type==="video"}function wc(s){return s.type==="file"}function yc(s){return s.type==="image"}function zc(s){return s.url||s.src}function Nc(s,e){return(0,t.jsx)(rc,{file:s},e)}var kc=Q(),_c=s=>{const e=(0,kc.c)(18),{poll:a,onVote:i}=s,n=a.options.reduce(Cc,0),[r,l]=(0,g.useState)(null);let o;e[0]!==i||e[1]!==r?(o=x=>{r||(l(x),i&&i(x))},e[0]=i,e[1]=r,e[2]=o):o=e[2];const c=o;let u;if(e[3]!==c||e[4]!==a.options||e[5]!==n||e[6]!==r){let x;e[8]!==c||e[9]!==n||e[10]!==r?(x=(h,b)=>{const v=n>0?Math.round((h.votes+(r===h.id?1:0))/(n+(r?1:0))*100):0,j=r===h.id;return(0,t.jsxs)("div",{onClick:y=>{y.stopPropagation(),c(h.id)},className:`relative h-10 w-full rounded-xl overflow-hidden cursor-pointer border ${j?"border-violet-500 dark:border-violet-500":"border-zinc-200 dark:border-zinc-700"}`,children:[r&&(0,t.jsx)("div",{className:"absolute top-0 left-0 h-full bg-zinc-200 dark:bg-zinc-800 transition-all duration-500",style:{width:`${v}%`}}),(0,t.jsxs)("div",{className:"absolute inset-0 flex items-center justify-between px-4 z-10",children:[(0,t.jsxs)("span",{className:`font-medium text-sm ${j?"text-violet-600 font-bold":"text-zinc-700 dark:text-zinc-200"}`,children:[h.text," ",j&&(0,t.jsx)(Hs,{size:14,className:"inline ml-1 mb-0.5"})]}),r&&(0,t.jsxs)("span",{className:"text-sm font-bold text-zinc-900 dark:text-white",children:[v,"%"]})]})]},h.id||b)},e[8]=c,e[9]=n,e[10]=r,e[11]=x):x=e[11],u=a.options.map(x),e[3]=c,e[4]=a.options,e[5]=n,e[6]=r,e[7]=u}else u=e[7];const d=n+(r?1:0),m=r?"6 days left":"Click to vote";let f;e[12]!==d||e[13]!==m?(f=(0,t.jsxs)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400 pl-1",children:[d," votes "," ",m]}),e[12]=d,e[13]=m,e[14]=f):f=e[14];let p;return e[15]!==u||e[16]!==f?(p=(0,t.jsxs)("div",{className:"mt-3 space-y-2",children:[u,f]}),e[15]=u,e[16]=f,e[17]=p):p=e[17],p},ps=_c;function Cc(s,e){return s+e.votes}const gt={formatHref:(s,e)=>e==="mention"?`/u/${s.substring(1)}`:e==="hashtag"?`/tags/${s.substring(1)}`:s,attributes:{onClick:s=>s.stopPropagation(),className:"text-rose-500 dark:text-rose-400 font-bold hover:underline cursor-pointer"},target:(s,e)=>e==="url"?"_blank":null,rel:(s,e)=>e==="url"?"noopener noreferrer":null},Sc=(s,e,a,i)=>{const[n,r]=(0,g.useState)(!1),[l,o]=(0,g.useState)(!1),[c,u]=(0,g.useState)(e||{comments:0,likes:0,mirrors:0});return(0,g.useEffect)(()=>{a&&s&&Pe(s)&&Pe(a.id)&&(sa(s,a.id).then(r).catch(()=>r(!1)),cr(s,a.id).then(o).catch(()=>o(!1)))},[s,a]),{liked:n,reposted:l,localStats:c,setLocalStats:u,handleLike:async f=>{if(f&&f.stopPropagation(),!a)return i("Please login to like!","error");if(!Pe(s)||!Pe(a.id)){const p=!n;r(p),u(x=>({...x,likes:p?(x.likes||0)+1:(x.likes||0)-1}));return}try{const p=await Dt(s,a.id);r(p),u(x=>({...x,likes:p?(x.likes||0)+1:(x.likes||0)-1}))}catch(p){console.error("Failed to toggle like:",p)}},handleRepost:async f=>{if(f&&f.stopPropagation(),!a)return i("Please login to repost!","error");if(!Pe(s)||!Pe(a.id)){const p=!l;o(p),u(x=>({...x,mirrors:p?(x.mirrors||0)+1:(x.mirrors||0)-1}));return}try{const p=await or(s,a.id);o(p),u(x=>({...x,mirrors:p?(x.mirrors||0)+1:(x.mirrors||0)-1})),i(p?"Reposted!":"Removed repost")}catch(p){console.error("Failed to toggle repost:",p),i("Failed to update repost","error")}}}};var Pc=Q();const Ia=s=>{const e=(0,Pc.c)(5);let a;e[0]!==s?(a=()=>nt(s),e[0]=s,e[1]=a):a=e[1];const[i,n]=(0,g.useState)(a);let r,l;return e[2]!==s?(r=()=>{if(!s)return;const o=setTimeout(()=>{n(nt(s))},0),c=setInterval(()=>{n(nt(s))},6e4);return()=>{clearTimeout(o),clearInterval(c)}},l=[s],e[2]=s,e[3]=r,e[4]=l):(r=e[3],l=e[4]),(0,g.useEffect)(r,l),i},$c=()=>{const{handle:s}=ut(),e=je(),{profiles:a,currentUser:i,getProfileByHandle:n}=pe(),{addToast:r}=ze(),[l,o]=(0,g.useState)(a[s?.toLowerCase()]),[c,u]=(0,g.useState)(!l),[d,m]=(0,g.useState)([]),[f,p]=(0,g.useState)("feed"),[x,h]=(0,g.useState)(!0),[b,v]=(0,g.useState)(!1),[j,y]=(0,g.useState)(!0),z=(0,g.useRef)(d);(0,g.useEffect)(()=>{z.current=d},[d]);const[k,_]=(0,g.useState)(!1),[$,A]=(0,g.useState)("Followers"),[S,F]=(0,g.useState)([]),[M,R]=(0,g.useState)(!1),[E,I]=(0,g.useState)(!1),[O,D]=(0,g.useState)(!0),P=(0,g.useRef)(S);(0,g.useEffect)(()=>{P.current=S},[S]);const C=(0,g.useCallback)(async(T,B=!1)=>{if(T){B?v(!0):h(!0);try{const H=z.current,te=await ir(T,B&&H.length>0?H[H.length-1].created_at:null,10);te.length<10?y(!1):y(!0),m(B?re=>[...re,...te]:te)}catch(H){console.error("Failed to fetch user posts:",H)}finally{h(!1),v(!1)}}},[]),w=async(T,B=!1)=>{const H=l?.id;if(H){B?I(!0):(A(T),_(!0),R(!0),F([]));try{const te=P.current,re=B&&te.length>0?te[te.length-1].followed_at:null,ie=T==="Followers"?await Gn(H,re,10):await er(H,re,10);ie.length<10?D(!1):D(!0),F(B?oe=>[...oe,...ie]:ie)}catch(te){console.error(`Failed to fetch ${T}:`,te),r(`Failed to load ${T}`)}finally{R(!1),I(!1)}}};(0,g.useEffect)(()=>{(async()=>{let B=a[s?.toLowerCase()];B?o(B):(u(!0),B=await n(s),o(B),u(!1)),B?.id&&C(B.id)})()},[s,a,n,C]);const N=(0,g.useMemo)(()=>f==="feed"?d.filter(T=>T.community_id===null&&T.parent_id===null):f==="media"?d.filter(T=>T.community_id===null&&T.parent_id===null&&(T.type==="video"||T.type==="image"||T.media&&T.media.length>0)):f==="collections"?[]:d,[d,f]);return{handle:s,profile:l,loading:c,userPosts:d,setUserPosts:m,activeProfileTab:f,setActiveProfileTab:p,loadingPosts:x,isFetchingMorePosts:b,hasMorePosts:j,filteredPosts:N,isFollowModalOpen:k,setIsFollowModalOpen:_,followModalType:$,followListData:S,isListLoading:M,isFetchingMoreFollows:E,hasMoreFollows:O,openFollowModal:w,handlePostClick:T=>{e(`/post/${T}`)},handleUserClick:T=>{T!==s&&e(`/u/${T}`)},loadUserPosts:C,currentUser:i,addToast:r,navigate:e}},Ac=()=>{const{handle:s}=ut(),e=je(),{currentUser:a}=pe(),{addToast:i}=ze(),[n,r]=(0,g.useState)(null),[l,o]=(0,g.useState)(!0),[c,u]=(0,g.useState)(!1),[d,m]=(0,g.useState)(null),[f,p]=(0,g.useState)(!1),[x,h]=(0,g.useState)([]),[b,v]=(0,g.useState)(!0),[j,y]=(0,g.useState)(!1),[z,k]=(0,g.useState)(!0),_=(0,g.useRef)(x);(0,g.useEffect)(()=>{_.current=x},[x]);const $=(0,g.useCallback)(async(S,F=!1)=>{if(S){F?y(!0):v(!0);try{const M=_.current,R=await Cr(S,F&&M.length>0?M[M.length-1].sort_timestamp:null,10);R.length<10?k(!1):k(!0),h(F?E=>[...E,...R]:R)}catch(M){console.error("Failed to fetch community posts:",M)}finally{v(!1),y(!1)}}},[]);return(0,g.useEffect)(()=>{(async()=>{o(!0);try{const F=await _r(s);if(r(F),F?.id&&($(F.id),a)){const M=await na(F.id,a.id);u(!!M),m(M?.role||null)}}catch{}finally{o(!1)}})()},[s,a,$]),{community:n,loading:l,isMember:c,userRole:d,isJoining:f,communityPosts:x,loadingPosts:b,isFetchingMorePosts:j,hasMorePosts:z,handleJoinToggle:async()=>{if(!a)return i("Please login to join communities","error");p(!0);try{const S=await ia(n.id,a.id);u(S),m(S?"member":null),r(F=>({...F,membersCount:S?F.membersCount+1:F.membersCount-1})),i(S?`Joined ${n.name}`:`Left ${n.name}`)}catch{i("Failed to update membership","error")}finally{p(!1)}},loadCommunityPosts:$,currentUser:a,addToast:i,navigate:e}},Mc=()=>{const{currentUser:s}=pe(),e=je(),a=ft(),i=new URLSearchParams(a.search),n=i.get("q")||"",r=i.get("tab")||(n?"posts":"communities"),[l,o]=(0,g.useState)(n),[c,u]=(0,g.useState)(r),[d,m]=(0,g.useState)(!1),[f,p]=(0,g.useState)([]),[x,h]=(0,g.useState)(!0),[b,v]=(0,g.useState)(!1),[j,y]=(0,g.useState)(!0),z=(0,g.useRef)(f),[k,_]=(0,g.useState)([]),[$,A]=(0,g.useState)(!1),[S,F]=(0,g.useState)(!1),[M,R]=(0,g.useState)(!0),E=(0,g.useRef)(k);(0,g.useEffect)(()=>{z.current=f},[f]),(0,g.useEffect)(()=>{E.current=k},[k]),(0,g.useEffect)(()=>{n!==l&&(o(n),n&&u("posts"))},[n]);const I=(0,g.useCallback)(async(w=!1)=>{w?v(!0):h(!0);try{const N=z.current,L=await kr(w&&N.length>0?N[N.length-1].createdAt:null,10);L.length<10?y(!1):y(!0),p(w?W=>[...W,...L]:L)}catch(N){console.error("Failed to fetch communities:",N)}finally{h(!1),v(!1)}},[]),O=(0,g.useCallback)(async(w=!1)=>{w?F(!0):A(!0);try{const N=E.current,L=w&&N.length>0?N[N.length-1].sort_timestamp||N[N.length-1].sortTimestamp:null;let W;l?W=await Ot(l,L,10,!0):W=await dr(L,10),W.length<10?R(!1):R(!0),_(w?T=>[...T,...W]:W)}catch(N){console.error("Failed to load posts:",N)}finally{A(!1),F(!1)}},[l]);(0,g.useEffect)(()=>{I()},[I]),(0,g.useEffect)(()=>{O()},[l,O]);const D=(0,g.useMemo)(()=>{let w=f;return l&&(w=w.filter(N=>N.name?.toLowerCase().includes(l.toLowerCase())||N.handle?.toLowerCase().includes(l.toLowerCase()))),w},[f,l]);return{currentUser:s,searchQuery:l,setSearchQuery:w=>{o(w)},activeTab:c,setActiveTab:u,isCreateModalOpen:d,setIsCreateModalOpen:m,communitiesData:f,isCommunitiesLoading:x,isFetchingMoreCommunities:b,hasMoreCommunities:j,postsData:k,isPostsLoading:$,isFetchingMorePosts:S,hasMorePosts:M,filteredCommunities:D,handleCommunityClick:w=>{e(`/c/${w}`)},loadCommunities:I,loadPosts:O,navigate:e}};var La=({id:s,user:e,timeAgo:a,content:i,contentClass:n,media:r,quotedPost:l,stats:o,onClick:c,repostedBy:u,onUserClick:d,currentUser:m,showToast:f,poll:p,isDetail:x,initialComments:h,onDelete:b,isComment:v,onReply:j,community:y})=>{const z=je(),{liked:k,reposted:_,localStats:$,setLocalStats:A,handleLike:S,handleRepost:F}=Sc(s,o,m,f),{deletePost:M,updatePost:R}=Vt(),[E,I]=(0,g.useState)(h||[]),[O,D]=(0,g.useState)(""),[P,C]=(0,g.useState)(!1),[w,N]=(0,g.useState)(!1),[L,W]=(0,g.useState)(!1),[T,B]=(0,g.useState)(!0),[H,te]=(0,g.useState)([]),[re,ie]=(0,g.useState)(!1),[oe,G]=(0,g.useState)(!1),[ae,V]=(0,g.useState)(!1),[J,K]=(0,g.useState)(i),[ee,X]=(0,g.useState)(r||[]),[de,Z]=(0,g.useState)([]),[ue,me]=(0,g.useState)(!1),[fe,we]=(0,g.useState)(!1),Ne=(0,g.useRef)(null),he=(0,g.useRef)(E);(0,g.useEffect)(()=>{he.current=E},[E]);const ye=async()=>{const Y=JSON.stringify(ee)!==JSON.stringify(r||[])||de.length>0;if(!J.trim()||J===i&&!Y){V(!1);return}me(!0);try{const se=[];for(const U of de){const ne=await Ae(U);se.push(ne)}await R(s,{content:J,media:[...ee,...se]}),Z([]),V(!1),f&&f("Post updated")}catch(se){console.error("Failed to update post:",se),f&&f("Failed to update post")}finally{me(!1)}},Ie=async Y=>{Y&&Y.stopPropagation();try{await M(s),f&&f("Post deleted successfully"),b&&b(s)}catch(se){console.error("Failed to delete post:",se),f&&f("Failed to delete post")}finally{G(!1)}},Se=(0,g.useCallback)(async(Y=!1)=>{if(s){Y?W(!0):C(!0);try{const se=he.current,U=await ea(s,Y&&se.length>0?se[se.length-1].created_at:null,10);U.length<10?B(!1):B(!0),I(Y?ne=>[...ne,...U]:U)}catch(se){console.error("Failed to load comments:",se)}finally{C(!1),W(!1)}}},[s]);(0,g.useEffect)(()=>{x&&s&&Se()},[x,s,Se]);const lt=async Y=>{if(Y.preventDefault(),!(!O.trim()&&H.length===0||!m)){N(!0),ie(!0);try{const se=[];for(const U of H){const ne=await Ae(U);se.push(ne)}await ta(s,m.id,O,se),D(""),te([]),A(U=>({...U,comments:(U.comments||0)+1})),f&&f("Reply posted!"),Se()}catch(se){console.error("Failed to post comment:",se),f&&f("Failed to post reply.")}finally{N(!1),ie(!1)}}},Ue=Y=>{Y.stopPropagation();const se=`${window.location.origin}/post/${s}`;navigator.clipboard.writeText(se),f&&f("Link copied to clipboard!")},Le=({trigger:Y})=>(0,t.jsxs)(ja,{children:[(0,t.jsx)(wa,{asChild:!0,onClick:se=>se.stopPropagation(),children:Y}),(0,t.jsxs)(ya,{align:"end",className:"w-48 rounded-xl bg-white dark:bg-zinc-900 border-zinc-100 dark:border-zinc-800",children:[(0,t.jsxs)(Ge,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5",onClick:Ue,children:[(0,t.jsx)(Fs,{size:16}),(0,t.jsx)("span",{children:"Copy link to post"})]}),!v&&(0,t.jsxs)(Ge,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5",onClick:se=>{se.stopPropagation(),f&&f("Post reported")},children:[(0,t.jsx)(Wa,{size:16}),(0,t.jsx)("span",{children:"Report post"})]}),!Te&&(0,t.jsxs)(Ge,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5 text-rose-500 focus:text-rose-500",onClick:se=>{se.stopPropagation(),f&&f("User blocked")},children:[(0,t.jsx)(oi,{size:16}),(0,t.jsxs)("span",{children:["Block @",e.handle]})]}),Te&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Fl,{className:"bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsxs)(Ge,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-900 py-2.5",onClick:se=>{se.stopPropagation(),V(!0)},children:[(0,t.jsx)(St,{size:16}),(0,t.jsx)("span",{children:"Edit post"})]}),(0,t.jsxs)(Ge,{className:"gap-2 cursor-pointer focus:bg-rose-50 dark:focus:bg-rose-900/20 py-2.5 text-rose-500 focus:text-rose-500",onClick:se=>{se.stopPropagation(),G(!0)},children:[(0,t.jsx)(Os,{size:16}),(0,t.jsx)("span",{children:"Delete post"})]})]})]})]}),Te=m?.handle===e.handle,De=Y=>{if(!Y)return null;const se=ae?ee:Y;return!se||Array.isArray(se)&&se.length===0?null:ae?(0,t.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,t.jsxs)("div",{className:"grid gap-2 grid-cols-2 sm:grid-cols-3",children:[ee.map((U,ne)=>(0,t.jsxs)("div",{className:"relative aspect-square rounded-xl overflow-hidden border border-zinc-200 dark:border-zinc-800 group",children:[U.type==="video"?(0,t.jsx)("div",{className:"size-full bg-zinc-100 dark:bg-zinc-900 flex items-center justify-center",children:(0,t.jsx)(zt,{size:24,className:"text-zinc-400"})}):(0,t.jsx)("img",{src:U.url||U.src,className:"size-full object-cover",alt:""}),(0,t.jsx)("button",{onClick:Me=>{Me.stopPropagation(),X(qe=>qe.filter((Ve,_e)=>_e!==ne))},className:"absolute top-1.5 right-1.5 size-7 rounded-full bg-black/60 text-white flex items-center justify-center hover:bg-black transition-colors",children:(0,t.jsx)($e,{size:16})})]},`old-${ne}`)),de.map((U,ne)=>(0,t.jsxs)("div",{className:"relative aspect-square rounded-xl overflow-hidden border-2 border-dashed border-violet-500 bg-violet-50/10 group",children:[U.type.startsWith("image/")?(0,t.jsx)("img",{src:URL.createObjectURL(U),className:"size-full object-cover",alt:""}):(0,t.jsx)("div",{className:"size-full flex items-center justify-center",children:(0,t.jsx)(zt,{size:24,className:"text-violet-500 animate-pulse"})}),(0,t.jsx)("button",{onClick:Me=>{Me.stopPropagation(),Z(qe=>qe.filter((Ve,_e)=>_e!==ne))},className:"absolute top-1.5 right-1.5 size-7 rounded-full bg-black/60 text-white flex items-center justify-center hover:bg-black transition-colors",children:(0,t.jsx)($e,{size:16})}),(0,t.jsx)("div",{className:"absolute bottom-1 left-1 bg-violet-600 text-white text-[8px] font-bold px-1 rounded",children:"NEW"})]},`new-${ne}`)),ee.length+de.length<4&&(0,t.jsxs)("button",{onClick:U=>{U.stopPropagation(),Ne.current?.click()},className:"relative aspect-square rounded-xl border-2 border-dashed border-zinc-200 dark:border-zinc-800 flex flex-col items-center justify-center gap-1 text-zinc-400 hover:text-violet-500 hover:border-violet-500 hover:bg-violet-50/5 transition-all",children:[(0,t.jsx)(We,{size:20}),(0,t.jsx)("span",{className:"text-[10px] font-bold",children:"Add Media"})]})]}),(0,t.jsx)("input",{type:"file",ref:Ne,onChange:U=>{const ne=Array.from(U.target.files);Z(Me=>[...Me,...ne])},multiple:!0,className:"hidden",accept:"image/*,video/*"})]}):g.isValidElement(se)?se:(0,t.jsx)(vc,{items:se})},Oe=(Y,se)=>{const U=typeof Y=="string"&&Qn(Y);if(ae)return(0,t.jsxs)("div",{className:"flex flex-col gap-2 mt-2",onClick:ne=>ne.stopPropagation(),children:[(0,t.jsx)(jo,{value:J,onChange:ne=>K(ne.target.value),className:`min-h-[100px] w-full bg-zinc-50 dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800 rounded-xl focus:ring-violet-500 ${U?"font-bangla text-lg":"font-english"}`,autoFocus:!0}),(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>{V(!1),K(i),X(r||[]),Z([])},className:"px-4 py-1.5 text-sm font-bold text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-300 transition-colors",children:"Cancel"}),(0,t.jsx)("button",{onClick:ye,disabled:ue||!J.trim()||J===i,className:"px-4 py-1.5 text-sm font-bold bg-violet-600 text-white rounded-full hover:bg-violet-700 disabled:opacity-50 transition-all active:scale-95",children:ue?"Saving...":"Save"})]})]});if(typeof Y=="string"){const ne=!x&&Y.length>280,Me=ne&&!fe?Y.substring(0,280):Y;return(0,t.jsxs)("div",{className:`whitespace-pre-line ${se||""} ${U?"font-bangla text-[1.15em] leading-relaxed":"font-english text-[1.05em]"}`,children:[(0,t.jsx)(xt,{options:{...gt,render:({attributes:qe,content:Ve})=>{const{href:_e,...es}=qe,ts=!_e.startsWith("/")&&(_e.startsWith("http")||_e.startsWith("www"));return _e.startsWith("/u/")||_e.startsWith("/tags/")||_e.startsWith("/c/")||_e.startsWith("/explore")?(0,t.jsx)("span",{...es,onClick:Ta=>{Ta.stopPropagation(),z(_e)},children:Ve},Ve):(0,t.jsx)("a",{href:_e,...es,target:ts?"_blank":void 0,rel:ts?"noopener noreferrer":void 0,children:Ve},Ve)}},children:Me}),ne&&!fe&&"...",ne&&(0,t.jsx)("button",{onClick:qe=>{qe.stopPropagation(),we(!fe)},className:"ml-1 text-rose-500 dark:text-rose-400 font-bold hover:underline cursor-pointer",children:fe?"Show less":"See more"})]})}return Y},Be=Y=>{D(se=>{const U=`@${Y} `;return se.includes(U)?se:se+U}),document.getElementById("comment-input")?.focus()};return x?(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsxs)("article",{className:"p-5 dark:bg-black",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-start gap-x-3",children:[(0,t.jsx)("button",{className:"shrink-0",onClick:()=>d&&d(e.handle),children:(0,t.jsxs)(be,{className:"size-12 border border-zinc-200 dark:border-zinc-700",children:[(0,t.jsx)(ge,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,t.jsx)(ve,{children:e.handle[0]?.toUpperCase()})]})}),(0,t.jsxs)("div",{className:"flex flex-col min-w-0 flex-1",children:[(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-x-1.5 leading-none",children:(0,t.jsxs)("div",{className:"flex items-center gap-1.5 min-w-0 max-w-full",children:[(0,t.jsxs)("button",{className:"font-bold text-base sm:text-lg hover:underline text-zinc-900 dark:text-white flex items-center gap-1 shrink-0",onClick:()=>d&&d(e.handle),children:[(0,t.jsx)("span",{className:"max-w-[200px] sm:max-w-none truncate",children:e.handle}),e.verified&&(0,t.jsx)(dt,{})]}),y&&(0,t.jsxs)("div",{className:"flex items-center gap-1 min-w-0 text-zinc-500",children:[(0,t.jsx)("span",{className:"text-zinc-400 font-medium shrink-0 text-xs sm:text-sm",children:">"}),(0,t.jsxs)("button",{className:"flex items-center gap-1 font-bold text-zinc-900 dark:text-zinc-100 hover:underline text-[14px] sm:text-[15px]",onClick:Y=>{Y.stopPropagation(),z(`/c/${y.handle}`)},children:[(0,t.jsxs)(be,{className:"size-4 bg-zinc-100 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 shrink-0",children:[(0,t.jsx)(ge,{src:y.avatar,alt:y.name,className:"object-cover"}),(0,t.jsx)(ve,{className:"text-[8px] font-bold text-zinc-500",children:y.name?.[0]?.toUpperCase()})]}),(0,t.jsx)("span",{className:"truncate max-w-[200px] sm:max-w-none",children:y.name})]})]})]})}),(0,t.jsxs)("span",{className:"text-xs sm:text-sm text-zinc-500 dark:text-zinc-400 font-medium",children:["@",e.handle]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 -mt-1",children:[(0,t.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400 text-[13px] sm:text-sm whitespace-nowrap",children:a||"Recent"}),(0,t.jsx)(Le,{trigger:(0,t.jsx)("button",{className:"text-zinc-500 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full p-2 transition-colors",children:(0,t.jsx)(Rt,{size:20})})})]})]}),(0,t.jsx)("div",{className:"break-words text-zinc-900 dark:text-zinc-100 mt-4 text-lg sm:text-xl leading-relaxed sm:leading-8 whitespace-pre-line",children:Oe(i,n)}),vt(i)&&(0,t.jsx)(hs,{url:vt(i)}),De(r),p&&(0,t.jsx)(ps,{poll:p}),l&&(0,t.jsx)("div",{className:"mt-4 border border-zinc-200 dark:border-zinc-700 rounded-2xl overflow-hidden shadow-sm",children:(0,t.jsx)(bs,{...l})}),(0,t.jsxs)("div",{className:"border-b border-zinc-100 dark:border-zinc-800 pb-4 mt-4 flex items-center gap-x-6 text-zinc-500 dark:text-zinc-400 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:$.likes||0})," ",(0,t.jsx)("span",{className:"opacity-70",children:"Likes"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:$.comments||0})," ",(0,t.jsx)("span",{className:"opacity-70",children:"Comments"})]})]}),(0,t.jsxs)("div",{className:"mt-4 flex w-full items-center justify-around py-1",children:[(0,t.jsx)(it,{icon:ct,label:"Like",onClick:S,active:k,activeColorClass:"text-rose-500"}),!v&&(0,t.jsx)(it,{icon:Ft,label:"Repost",onClick:F,active:_,activeColorClass:"text-emerald-500"}),(0,t.jsx)(it,{icon:yt,label:"Comment",onClick:()=>document.getElementById("comment-input")?.focus()})]})]}),(0,t.jsx)(Ra,{currentUser:m,newComment:O,setNewComment:D,handleSubmitComment:lt,loading:w,selectedFiles:H,setSelectedFiles:te,isUploading:re}),(0,t.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:P?(0,t.jsx)("div",{className:"p-8 flex justify-center",children:(0,t.jsx)(ce,{className:"animate-spin text-violet-500"})}):(0,t.jsxs)(t.Fragment,{children:[T&&E.length>0&&(0,t.jsxs)("button",{onClick:()=>Se(!0),disabled:L,className:"w-full py-3 text-sm font-bold text-violet-600 hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors flex items-center justify-center gap-2",children:[L&&(0,t.jsx)(ce,{size:14,className:"animate-spin"}),"View more replies"]}),E.map(Y=>(0,t.jsx)(La,{...Y,isComment:!0,onReply:Be,onUserClick:d,currentUser:m,showToast:f,onDelete:se=>I(U=>U.filter(ne=>ne.id!==se))},Y.id))]})}),(0,t.jsx)(ns,{open:oe,onOpenChange:G,children:(0,t.jsxs)(rs,{onClick:Y=>Y.stopPropagation(),children:[(0,t.jsxs)(ls,{children:[(0,t.jsx)(cs,{children:"Are you absolutely sure?"}),(0,t.jsx)(ds,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,t.jsxs)(os,{children:[(0,t.jsx)(us,{onClick:Y=>Y.stopPropagation(),children:"Cancel"}),(0,t.jsx)(ms,{onClick:Ie,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]}):(0,t.jsxs)("article",{onClick:c,className:`p-4 transition-all ${v?"bg-transparent border-b border-zinc-100/50 dark:border-zinc-800/50 hover:bg-zinc-50/50 dark:hover:bg-zinc-800/30 last:border-0":"mb-4 bg-white dark:bg-black rounded-xl hover:shadow-md"} ${c?"cursor-pointer":""}`,children:[u&&(0,t.jsxs)("div",{className:"mb-2 flex items-center space-x-1.5 text-[13px] text-zinc-500 font-semibold ml-1",children:[(0,t.jsx)(Ft,{size:14,className:"text-zinc-400"}),(0,t.jsx)("span",{className:"hover:underline cursor-pointer flex items-center text-zinc-600 dark:text-zinc-400",onClick:Y=>{Y.stopPropagation(),d&&d(u.handle)},children:(0,t.jsx)("span",{className:"truncate max-w-[150px]",children:typeof u=="object"?u.name:u})}),(0,t.jsx)("span",{className:"text-zinc-400",children:"reposted"})]}),(0,t.jsxs)("div",{className:"flex items-start gap-x-3",children:[(0,t.jsx)("button",{className:"shrink-0 group",onClick:Y=>{Y.stopPropagation(),d&&d(e.handle)},children:(0,t.jsxs)(be,{className:"size-11 border border-zinc-200 dark:border-zinc-700 group-hover:brightness-95 transition-all",children:[(0,t.jsx)(ge,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,t.jsx)(ve,{children:e.handle[0]?.toUpperCase()})]})}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsxs)("div",{className:"flex w-full items-start justify-between",children:[(0,t.jsx)("div",{className:"flex flex-col min-w-0 flex-1",children:(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-x-1.5 leading-none",children:(0,t.jsxs)("div",{className:"flex items-center gap-1.5 min-w-0 max-w-full",children:[(0,t.jsxs)("button",{className:"font-bold text-[15px] hover:underline text-zinc-900 dark:text-white flex items-center gap-1 shrink-0",onClick:Y=>{Y.stopPropagation(),d&&d(e.handle)},children:[(0,t.jsx)("span",{className:"truncate max-w-[160px] sm:max-w-none",children:e.handle}),e.verified&&(0,t.jsx)(dt,{})]}),y&&(0,t.jsxs)("div",{className:"flex items-center gap-1 min-w-0 text-zinc-500",children:[(0,t.jsx)("span",{className:"text-zinc-400 font-medium shrink-0 text-xs sm:text-sm",children:">"}),(0,t.jsxs)("button",{className:"flex items-center gap-1 font-bold text-zinc-900 dark:text-zinc-100 hover:underline text-[14px] sm:text-[15px] min-w-0",onClick:Y=>{Y.stopPropagation(),z(`/c/${y.handle}`)},children:[(0,t.jsxs)(be,{className:"size-4 bg-zinc-100 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 shrink-0",children:[(0,t.jsx)(ge,{src:y.avatar,alt:y.name,className:"object-cover"}),(0,t.jsx)(ve,{className:"text-[8px] font-bold text-zinc-500",children:y.name?.[0]?.toUpperCase()})]}),(0,t.jsx)("span",{className:"truncate max-w-[160px] md:max-w-none",children:y.name})]})]})]})})}),(0,t.jsxs)("div",{className:"flex items-center gap-2 -mt-1",children:[(0,t.jsx)("span",{className:"text-zinc-400 text-[13px] sm:text-sm whitespace-nowrap",children:a||"Recent"}),(0,t.jsx)(Le,{trigger:(0,t.jsx)("button",{className:"text-zinc-400 hover:bg-zinc-100 hover:text-zinc-700 dark:hover:bg-zinc-800 dark:hover:text-zinc-200 rounded-full p-2 -mr-2 transition-colors",children:(0,t.jsx)(Rt,{size:18})})})]})]}),(0,t.jsxs)("div",{className:"break-words text-zinc-900 dark:text-zinc-100 mt-1 whitespace-pre-line text-sm sm:text-[15px] leading-relaxed",children:[Oe(i,n),vt(i)&&(0,t.jsx)(hs,{url:vt(i)}),De(r),p&&(0,t.jsx)(ps,{poll:p,onVote:()=>f&&f("Voted!")}),l&&(0,t.jsx)("div",{className:"mt-3 border border-zinc-200 dark:border-zinc-700 rounded-2xl overflow-hidden bg-white dark:bg-zinc-900 hover:bg-zinc-50 dark:hover:bg-zinc-800 transition-colors cursor-pointer",onClick:Y=>Y.stopPropagation(),children:(0,t.jsx)(bs,{...l})})]}),(0,t.jsx)("div",{className:"mt-3 flex w-full flex-wrap items-center justify-between gap-3 pr-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-x-6 sm:gap-x-8",children:[(0,t.jsx)(it,{icon:ct,label:"Like",count:$.likes,active:k,onClick:S,activeColorClass:"text-rose-500"}),!v&&(0,t.jsx)(it,{icon:Ft,label:"Repost",count:$.mirrors,active:_,onClick:F,activeColorClass:"text-emerald-500"}),(0,t.jsx)(it,{icon:yt,label:"Comment",count:$.comments,onClick:Y=>{v&&j?(Y.stopPropagation(),j(e.handle)):c&&c(Y)}})]})})]})]}),(0,t.jsx)(ns,{open:oe,onOpenChange:G,children:(0,t.jsxs)(rs,{onClick:Y=>Y.stopPropagation(),children:[(0,t.jsxs)(ls,{children:[(0,t.jsx)(cs,{children:"Are you absolutely sure?"}),(0,t.jsx)(ds,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,t.jsxs)(os,{children:[(0,t.jsx)(us,{onClick:Y=>Y.stopPropagation(),children:"Cancel"}),(0,t.jsx)(ms,{onClick:Ie,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]})},at=La,Fc=Q(),Ec=s=>{const e=(0,Fc.c)(30),{user:a,time:i,content:n}=s,r=je();let l;e[0]!==a.avatar||e[1]!==a.handle?(l=(0,t.jsx)(ge,{src:a.avatar,alt:a.handle}),e[0]=a.avatar,e[1]=a.handle,e[2]=l):l=e[2];let o;e[3]!==a.handle[0]?(o=a.handle[0]?.toUpperCase(),e[3]=a.handle[0],e[4]=o):o=e[4];let c;e[5]!==o?(c=(0,t.jsx)(ve,{children:o}),e[5]=o,e[6]=c):c=e[6];let u;e[7]!==l||e[8]!==c?(u=(0,t.jsxs)(be,{className:"size-6",children:[l,c]}),e[7]=l,e[8]=c,e[9]=u):u=e[9];let d;e[10]!==a.handle?(d=(0,t.jsx)("span",{className:"font-semibold text-sm",children:a.handle}),e[10]=a.handle,e[11]=d):d=e[11];let m;e[12]!==u||e[13]!==d?(m=(0,t.jsxs)("div",{className:"flex items-center gap-x-2",children:[u,d]}),e[12]=u,e[13]=d,e[14]=m):m=e[14];let f;e[15]!==i?(f=(0,t.jsx)("span",{className:"text-zinc-500 text-xs sm:text-sm",children:i}),e[15]=i,e[16]=f):f=e[16];let p;e[17]!==m||e[18]!==f?(p=(0,t.jsxs)("div",{className:"flex items-center justify-between gap-x-2 mb-2",children:[m,f]}),e[17]=m,e[18]=f,e[19]=p):p=e[19];let x;e[20]!==r?(x={...gt,render:j=>{const{attributes:y,content:z}=j,{href:k,..._}=y,$=!k.startsWith("/")&&(k.startsWith("http")||k.startsWith("www"));return k.startsWith("/u/")||k.startsWith("/tags/")||k.startsWith("/c/")||k.startsWith("/explore")?(0,t.jsx)("span",{..._,onClick:A=>{A.stopPropagation(),r(k)},children:z},z):(0,t.jsx)("a",{href:k,..._,target:$?"_blank":void 0,rel:$?"noopener noreferrer":void 0,onClick:Rc,children:z},z)}},e[20]=r,e[21]=x):x=e[21];let h;e[22]!==n?(h=(0,t.jsx)("p",{className:"text-sm text-zinc-800 dark:text-zinc-300 whitespace-pre-line",children:n}),e[22]=n,e[23]=h):h=e[23];let b;e[24]!==h||e[25]!==x?(b=(0,t.jsx)(xt,{options:x,children:h}),e[24]=h,e[25]=x,e[26]=b):b=e[26];let v;return e[27]!==b||e[28]!==p?(v=(0,t.jsxs)("div",{className:"p-4",children:[p,b]}),e[27]=b,e[28]=p,e[29]=v):v=e[29],v},bs=Ec;function Rc(s){return s.stopPropagation()}var Ic=g.memo(({reel:s,isActive:e,isMuted:a,onToggleMute:i})=>{const n=je(),{currentUser:r}=pe(),{addToast:l}=ze(),o=(0,g.useRef)(null),[c,u]=(0,g.useState)(!1),[d,m]=(0,g.useState)(!1),[f,p]=(0,g.useState)(!0),[x,h]=(0,g.useState)(null),[b,v]=(0,g.useState)(!1),[j,y]=(0,g.useState)(s.stats?.likes||0),[z,k]=(0,g.useState)(!1),[_,$]=(0,g.useState)(0),A=(0,g.useRef)(null);(0,g.useRef)(0);const S=(0,g.useMemo)(()=>Array.isArray(s.media)?s.media[0]?.src||s.media[0]?.url:s.media?.src||s.media?.url||s.url,[s.media,s.url]);(0,g.useEffect)(()=>{let P;const C=o.current?.plyr;return C&&(e?P=setTimeout(()=>{typeof C.play=="function"&&C.play().catch(w=>{console.error("Autoplay failed, retrying muted:",w),C.muted=!0,C.play()})},100):typeof C.pause=="function"&&C.pause()),()=>{P&&clearTimeout(P)}},[e]),(0,g.useEffect)(()=>{if(!r||!e)return;(async()=>{try{const[C,w]=await Promise.all([sa(s.id,r.id),Gs(r.id,s.user?.id)]);v(C),k(w)}catch(C){console.error("Failed to check interaction status:",C)}})()},[s.id,r?.id,e,s.user?.id]),(0,g.useEffect)(()=>{const P=o.current?.plyr;P&&(P.muted=a)},[a,e]),(0,g.useEffect)(()=>{const P=o.current?.plyr;if(!P||!e)return;const C=()=>{const w=P.currentTime,N=P.duration;N>0&&$(w/N*100)};if(typeof P.on=="function")return P.on("timeupdate",C),()=>{typeof P.off=="function"&&P.off("timeupdate",C)}},[e]);const F=P=>{P.target.closest("button")||P.target.closest("a")||(A.current?(clearTimeout(A.current),A.current=null,R()):A.current=setTimeout(()=>{A.current=null,M()},200))},M=()=>{const P=o.current?.plyr;P&&(P.paused?(P.play(),p(!0),h("play")):(P.pause(),p(!1),h("pause")),setTimeout(()=>h(null),500))},R=async()=>{if(r&&(u(!0),setTimeout(()=>u(!1),800),!b)){v(!0),y(P=>P+1);try{await Dt(s.id,r.id)}catch{v(!1),y(C=>C-1)}}},E=async P=>{if(P.stopPropagation(),!r)return;const C=!b;v(C),y(w=>C?w+1:w-1);try{await Dt(s.id,r.id)}catch{v(!C),y(N=>C?N-1:N+1)}},I=async P=>{if(P.stopPropagation(),!r)return;const C=!z;k(C);try{await Zs(r.id,s.user?.id)}catch{k(!C)}},O=P=>{P.stopPropagation();const C=`${window.location.origin}/reels?id=${s.id}`;navigator.clipboard.writeText(C),l("Link copied to clipboard!")},D=(0,g.useMemo)(()=>({source:{type:"video",sources:[{src:S,type:"video/mp4"}]},options:{controls:[],loop:{active:!0},clickToPlay:!0,ratio:"9:16"}}),[S]);return(0,t.jsxs)("div",{"data-id":s.id,className:"reel-item relative h-screen w-full bg-black snap-start flex items-center justify-center overflow-hidden cursor-pointer",onClick:F,children:[(0,t.jsx)("div",{className:"w-full h-full max-w-[450px]",children:(0,t.jsx)(Js,{ref:o,...D})}),c&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-50",children:(0,t.jsx)("div",{className:"animate-in zoom-in-50 fade-out fill-mode-forwards duration-500",children:(0,t.jsx)(ct,{size:120,fill:"white",className:"text-white drop-shadow-[0_0_30px_rgba(255,255,255,0.4)] scale-125"})})}),x&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-50",children:(0,t.jsx)("div",{className:"animate-in fade-in zoom-in-90 scale-100 animate-out zoom-out-110 fade-out fill-mode-forwards duration-500",children:(0,t.jsx)("div",{className:"p-8 bg-white/10 backdrop-blur-md rounded-full border border-white/20 shadow-2xl",children:x==="play"?(0,t.jsx)(qi,{size:50,fill:"white",className:"text-white ml-1.5"}):(0,t.jsx)(yn,{size:50,fill:"white",className:"text-white"})})})}),(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-black/60 pointer-events-none"}),(0,t.jsxs)("div",{className:"absolute bottom-20 left-4 right-16 text-white pointer-events-none",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3 pointer-events-auto",children:[(0,t.jsxs)(Wt,{to:`/u/${s.user?.handle}`,className:"flex items-center gap-2 hover:opacity-80 transition-opacity",onClick:P=>P.stopPropagation(),children:[(0,t.jsxs)(be,{className:"size-10 border-2 border-white",children:[(0,t.jsx)(ge,{src:s.user?.avatar,alt:s.user?.handle,className:"object-cover"}),(0,t.jsx)(ve,{children:s.user?.handle?.[0]?.toUpperCase()})]}),(0,t.jsxs)("span",{className:"font-bold",children:["@",s.user?.handle]})]}),r?.id!==s.user?.id&&(0,t.jsx)("button",{className:`text-xs font-bold px-4 py-1.5 rounded-full ml-2 transition-all active:scale-95 ${z?"bg-transparent border border-white/50 text-white":"bg-white text-black hover:bg-zinc-200"}`,onClick:I,children:z?"Following":"Follow"})]}),(0,t.jsx)(xt,{options:{...gt,render:({attributes:P,content:C})=>{const{href:w,...N}=P,L=!w.startsWith("/")&&(w.startsWith("http")||w.startsWith("www"));return w.startsWith("/u/")||w.startsWith("/tags/")||w.startsWith("/c/")||w.startsWith("/explore")?(0,t.jsx)("span",{...N,className:"text-white font-bold hover:underline cursor-pointer",onClick:W=>{W.stopPropagation(),n(w)},children:C},C):(0,t.jsx)("a",{href:w,...N,className:"text-white hover:underline",target:L?"_blank":void 0,rel:L?"noopener noreferrer":void 0,onClick:W=>W.stopPropagation(),children:C},C)}},children:(0,t.jsx)("p",{className:"text-sm mb-3 line-clamp-2",children:s.content})}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs opacity-90",children:[(0,t.jsx)(mn,{size:14,className:"animate-spin-slow"}),(0,t.jsxs)("span",{children:["Original Audio - ",s.user?.handle]})]})]}),(0,t.jsxs)("div",{className:"absolute bottom-20 right-2 flex flex-col items-center gap-6 z-10",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center gap-1 pointer-events-auto",children:[(0,t.jsx)("button",{className:`p-3 rounded-full backdrop-blur-md transition-all active:scale-90 ${b?"bg-rose-500/20 text-rose-500":"bg-zinc-800/50 text-white hover:bg-zinc-700"}`,onClick:E,children:(0,t.jsx)(ct,{size:28,fill:b?"currentColor":"none"})}),(0,t.jsx)("span",{className:"text-white text-xs font-bold",children:j})]}),(0,t.jsxs)("div",{className:"flex flex-col items-center gap-1 pointer-events-auto",children:[(0,t.jsx)("button",{className:"p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90",onClick:P=>{P.stopPropagation(),m(!0)},children:(0,t.jsx)(yt,{size:28})}),(0,t.jsx)("span",{className:"text-white text-xs font-bold",children:s.stats?.comments||0})]}),(0,t.jsxs)("div",{className:"flex flex-col items-center gap-1 pointer-events-auto",children:[(0,t.jsx)("button",{className:"p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90",onClick:O,children:(0,t.jsx)(Vi,{size:28})}),(0,t.jsx)("span",{className:"text-white text-xs font-bold",children:s.stats?.shares||0})]})]}),(0,t.jsx)("div",{className:"absolute bottom-0 left-0 w-full h-[3px] bg-white/20 z-50",children:(0,t.jsx)("div",{className:"h-full bg-white transition-all duration-100 ease-linear shadow-[0_0_8px_rgba(255,255,255,0.8)]",style:{width:`${_}%`}})}),(0,t.jsx)(Dc,{isOpen:d,onClose:()=>m(!1),reelId:s.id,currentUser:r,showToast:l})]})},(s,e)=>s.isActive===e.isActive&&s.reel.id===e.reel.id&&s.isMuted===e.isMuted),Lc=Ic,Tc=({isOpen:s,onClose:e,reelId:a,currentUser:i,showToast:n})=>{const[r,l]=(0,g.useState)([]),[o,c]=(0,g.useState)(!1),[u,d]=(0,g.useState)(!1),[m,f]=(0,g.useState)(""),[p,x]=(0,g.useState)([]),[h,b]=(0,g.useState)(!1),[v,j]=(0,g.useState)(!0),[y,z]=(0,g.useState)(!1),k=(0,g.useRef)(r);(0,g.useEffect)(()=>{k.current=r},[r]);const _=(0,g.useCallback)(async(A=!1)=>{if(a){A?z(!0):c(!0);try{const S=k.current,F=await ea(a,A&&S.length>0?S[S.length-1].created_at:null,10);F.length<10?j(!1):j(!0),l(A?M=>[...M,...F]:F)}catch(S){console.error("Failed to load comments:",S),n&&n("Failed to load comments","error")}finally{c(!1),z(!1)}}},[a,n]);(0,g.useEffect)(()=>{s&&a?_():(l([]),j(!0))},[s,a,_]);const $=async A=>{if(A.preventDefault(),!(!m.trim()&&p.length===0||!i)){d(!0),b(!0);try{const S=[];for(const F of p){const M=await Ae(F);S.push(M)}await ta(a,i.id,m,S),f(""),x([]),n&&n("Reply posted!"),_()}catch(S){console.error("Failed to post comment:",S),n&&n("Failed to post reply.","error")}finally{d(!1),b(!1)}}};return(0,t.jsx)(Ke,{isOpen:s,onClose:e,className:"max-sm:h-[95dvh] sm:max-w-xl h-[85vh] flex flex-col !p-0",children:(0,t.jsxs)("div",{className:"flex flex-col h-full overflow-hidden bg-white dark:bg-zinc-900",children:[(0,t.jsxs)("div",{className:"px-5 py-4 border-b border-zinc-100 dark:border-zinc-800 flex items-center justify-center shrink-0 relative bg-white dark:bg-zinc-900",children:[(0,t.jsx)("h2",{className:"text-base font-bold dark:text-white",children:"Comments"}),(0,t.jsx)("div",{className:"absolute right-5 w-8 h-1 bg-zinc-200 dark:bg-zinc-800 rounded-full sm:hidden top-2 transform -translate-y-1/2 left-1/2 -translate-x-1/2"})]}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-zinc-200 dark:scrollbar-thumb-zinc-800",children:o?(0,t.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,t.jsx)(ce,{className:"animate-spin text-violet-500",size:32})}):r.length>0?(0,t.jsxs)("div",{className:"flex flex-col",children:[r.map(A=>(0,t.jsx)(at,{...A,isComment:!0,currentUser:i,showToast:n,onDelete:S=>l(F=>F.filter(M=>M.id!==S))},A.id)),v&&(0,t.jsxs)("button",{onClick:()=>_(!0),disabled:y,className:"w-full py-6 text-sm font-bold text-violet-600 hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors flex items-center justify-center gap-2",children:[y&&(0,t.jsx)(ce,{size:16,className:"animate-spin"}),"View more replies"]})]}):(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-full min-h-[300px] text-center text-zinc-500 p-8",children:[(0,t.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 flex items-center justify-center mb-4",children:(0,t.jsx)(yt,{size:32,className:"text-zinc-400"})}),(0,t.jsx)("p",{className:"font-bold text-lg dark:text-zinc-300",children:"No comments yet"}),(0,t.jsx)("p",{className:"text-sm dark:text-zinc-500",children:"Be the first to share what you think!"})]})}),(0,t.jsx)("div",{className:"bg-white dark:bg-zinc-900 shrink-0",children:(0,t.jsx)(Ra,{currentUser:i,newComment:m,setNewComment:f,handleSubmitComment:$,loading:u,selectedFiles:p,setSelectedFiles:x,isUploading:h})})]})})},Dc=Tc,Oc=Q(),qc=s=>{const e=(0,Oc.c)(101),{onPostInCommunity:a}=s,[i,n]=g.useState(!1),[r,l]=g.useState(!1),{community:o,loading:c,isMember:u,userRole:d,isJoining:m,communityPosts:f,loadingPosts:p,isFetchingMorePosts:x,hasMorePosts:h,handleJoinToggle:b,loadCommunityPosts:v,currentUser:j,addToast:y,navigate:z}=Ac(),k=d==="admin",_=u&&(!o.isPrivate||k);if(c){let he;return e[0]===Symbol.for("react.memo_cache_sentinel")?(he=(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)(ce,{size:40,className:"animate-spin text-violet-500"})}),e[0]=he):he=e[0],he}if(!o){const he=`The community @${o?.handle||"unknown"} could not be found.`;let ye;return e[1]!==he?(ye=(0,t.jsx)("div",{className:"bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-[600px] flex items-center justify-center",children:(0,t.jsx)(Kt,{title:"Community doesn't exist",message:he,icon:et})}),e[1]=he,e[2]=ye):ye=e[2],ye}let $;e[3]!==z?($=()=>z(-1),e[3]=z,e[4]=$):$=e[4];let A;e[5]===Symbol.for("react.memo_cache_sentinel")?(A=(0,t.jsx)(tt,{size:22}),e[5]=A):A=e[5];let S;e[6]!==$?(S=(0,t.jsx)("button",{onClick:$,className:"p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:A}),e[6]=$,e[7]=S):S=e[7];let F;e[8]!==o.name?(F=(0,t.jsx)("h5",{className:"text-lg font-bold dark:text-white leading-none",children:o.name}),e[8]=o.name,e[9]=F):F=e[9];let M;e[10]!==o.membersCount?(M=(0,t.jsxs)("span",{className:"text-xs text-zinc-500 mt-0.5",children:[o.membersCount," Members"]}),e[10]=o.membersCount,e[11]=M):M=e[11];let R;e[12]!==F||e[13]!==M?(R=(0,t.jsxs)("div",{className:"flex flex-col",children:[F,M]}),e[12]=F,e[13]=M,e[14]=R):R=e[14];let E;e[15]!==S||e[16]!==R?(E=(0,t.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-x-4",children:[S,R]})}),e[15]=S,e[16]=R,e[17]=E):E=e[17];let I;e[18]!==o.cover?(I=(0,t.jsx)("div",{className:"h-32 sm:h-52 bg-zinc-100 dark:bg-zinc-900 overflow-hidden relative",children:o.cover?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("img",{src:o.cover,className:"w-full h-full object-cover",alt:""}),(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 to-transparent"})]}):(0,t.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-violet-500/20 to-fuchsia-500/20"})}),e[18]=o.cover,e[19]=I):I=e[19];let O;e[20]!==o.avatar?(O=(0,t.jsx)("div",{className:"size-24 sm:size-32 rounded-3xl border-4 border-white dark:border-black bg-zinc-100 dark:bg-zinc-800 overflow-hidden shadow-xl",children:(0,t.jsx)("img",{src:o.avatar,className:"size-full object-cover",alt:""})}),e[20]=o.avatar,e[21]=O):O=e[21];let D;e[22]!==k?(D=k&&(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>n(!0),className:"p-2 rounded-full border border-zinc-200 dark:border-zinc-800 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 transition-all active:scale-95 flex items-center justify-center size-10",title:"Edit Community",children:(0,t.jsx)(St,{size:20})}),(0,t.jsx)("button",{onClick:()=>l(!0),className:"p-2 rounded-full border border-zinc-200 dark:border-zinc-800 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 transition-all active:scale-95 flex items-center justify-center size-10",title:"Manage Members",children:(0,t.jsx)(Qs,{size:20})})]}),e[22]=k,e[23]=D):D=e[23];const P=u?"outline":"default",C=`rounded-full font-bold px-8 h-10 transition-all ${u?"border-zinc-200 dark:border-zinc-800 hover:bg-rose-50 hover:text-rose-500 hover:border-rose-100 dark:hover:bg-rose-900/20":"bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 hover:scale-105"}`;let w;e[24]!==m||e[25]!==u?(w=m?(0,t.jsx)(ce,{size:18,className:"animate-spin"}):u?"Joined":"Join",e[24]=m,e[25]=u,e[26]=w):w=e[26];let N;e[27]!==b||e[28]!==m||e[29]!==P||e[30]!==C||e[31]!==w?(N=(0,t.jsx)(xe,{variant:P,onClick:b,disabled:m,className:C,children:w}),e[27]=b,e[28]=m,e[29]=P,e[30]=C,e[31]=w,e[32]=N):N=e[32];let L;e[33]!==D||e[34]!==N?(L=(0,t.jsxs)("div",{className:"pb-1 flex gap-2",children:[D,N]}),e[33]=D,e[34]=N,e[35]=L):L=e[35];let W;e[36]!==L||e[37]!==O?(W=(0,t.jsxs)("div",{className:"flex justify-between items-end -mt-12 sm:-mt-16 mb-4 relative z-10",children:[O,L]}),e[36]=L,e[37]=O,e[38]=W):W=e[38];let T;e[39]!==o.name?(T=(0,t.jsx)("h1",{className:"text-2xl sm:text-3xl font-black dark:text-white tracking-tight leading-tight",children:o.name}),e[39]=o.name,e[40]=T):T=e[40];let B;e[41]!==o.handle?(B=(0,t.jsxs)("p",{className:"text-zinc-500 font-bold text-sm sm:text-base",children:["c/",o.handle]}),e[41]=o.handle,e[42]=B):B=e[42];let H;e[43]!==o.description?(H=o.description&&(0,t.jsx)("p",{className:"mt-4 text-[15px] sm:text-base dark:text-zinc-300 leading-relaxed max-w-2xl",children:o.description}),e[43]=o.description,e[44]=H):H=e[44];let te;e[45]!==o.membersCount?(te=(0,t.jsx)("span",{className:"text-base font-extrabold text-zinc-900 dark:text-white transition-colors",children:o.membersCount}),e[45]=o.membersCount,e[46]=te):te=e[46];let re;e[47]===Symbol.for("react.memo_cache_sentinel")?(re=(0,t.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400 font-medium",children:"Members"}),e[47]=re):re=e[47];let ie;e[48]!==te?(ie=(0,t.jsxs)("button",{className:"flex gap-x-1.5 group cursor-pointer items-baseline",children:[te,re]}),e[48]=te,e[49]=ie):ie=e[49];let oe;e[50]!==o.postsCount?(oe=(0,t.jsx)("span",{className:"text-base font-extrabold text-zinc-900 dark:text-white transition-colors",children:o.postsCount}),e[50]=o.postsCount,e[51]=oe):oe=e[51];let G;e[52]===Symbol.for("react.memo_cache_sentinel")?(G=(0,t.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400 font-medium",children:"Posts"}),e[52]=G):G=e[52];let ae;e[53]!==oe?(ae=(0,t.jsxs)("button",{className:"flex gap-x-1.5 group cursor-pointer items-baseline",children:[oe,G]}),e[53]=oe,e[54]=ae):ae=e[54];let V;e[55]!==ie||e[56]!==ae?(V=(0,t.jsxs)("div",{className:"flex gap-4 sm:gap-6 text-sm pt-2 relative z-10",children:[ie,ae]}),e[55]=ie,e[56]=ae,e[57]=V):V=e[57];let J;e[58]!==T||e[59]!==B||e[60]!==H||e[61]!==V?(J=(0,t.jsxs)("div",{className:"space-y-1",children:[T,B,H,V]}),e[58]=T,e[59]=B,e[60]=H,e[61]=V,e[62]=J):J=e[62];let K;e[63]!==W||e[64]!==J?(K=(0,t.jsxs)("div",{className:"px-4 pb-6",children:[W,J]}),e[63]=W,e[64]=J,e[65]=K):K=e[65];let ee;e[66]!==K||e[67]!==I?(ee=(0,t.jsxs)("div",{className:"relative",children:[I,K]}),e[66]=K,e[67]=I,e[68]=ee):ee=e[68];let X;e[69]!==y||e[70]!==o.id||e[71]!==o.name||e[72]!==f||e[73]!==j||e[74]!==h||e[75]!==x||e[76]!==v||e[77]!==p||e[78]!==z?(X=(0,t.jsx)("div",{className:"border-t border-zinc-100 dark:border-zinc-800",children:p?(0,t.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,t.jsx)(ce,{className:"animate-spin text-violet-500",size:32})}):f.length>0?(0,t.jsxs)(t.Fragment,{children:[f.map(he=>(0,t.jsx)(at,{currentUser:j,showToast:y,...he,onClick:()=>z(`/post/${he.id}`),onUserClick:ye=>z(`/u/${ye}`)},he.feed_id||he.id)),h&&(0,t.jsx)("div",{className:"p-6 flex justify-center",children:(0,t.jsxs)(xe,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>v(o.id,!0),disabled:x,children:[x&&(0,t.jsx)(ce,{size:18,className:"animate-spin mr-2"}),"Load more"]})})]}):(0,t.jsxs)("div",{className:"p-20 text-center text-zinc-500 flex flex-col items-center gap-4",children:[(0,t.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full mb-2",children:(0,t.jsx)(et,{size:40,className:"text-zinc-300"})}),(0,t.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"No posts here yet"}),(0,t.jsxs)("p",{className:"text-sm max-w-[250px]",children:["Be the first to share something in ",o.name,"!"]})]})}),e[69]=y,e[70]=o.id,e[71]=o.name,e[72]=f,e[73]=j,e[74]=h,e[75]=x,e[76]=v,e[77]=p,e[78]=z,e[79]=X):X=e[79];let de;e[80]!==ee||e[81]!==X||e[82]!==E?(de=(0,t.jsxs)("div",{className:"relative",children:[E,ee,X]}),e[80]=ee,e[81]=X,e[82]=E,e[83]=de):de=e[83];let Z;e[84]!==_||e[85]!==o||e[86]!==a?(Z=_&&(0,t.jsx)("button",{onClick:()=>a(o),className:"fixed bottom-20 right-5 md:hidden z-50 bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 size-12 rounded-full flex items-center justify-center shadow-2xl hover:scale-110 active:scale-90 transition-all cursor-pointer group",title:`Post to ${o.name}`,children:(0,t.jsx)(We,{size:28,className:"group-hover:rotate-90 transition-transform duration-300"})}),e[84]=_,e[85]=o,e[86]=a,e[87]=Z):Z=e[87];let ue;e[88]===Symbol.for("react.memo_cache_sentinel")?(ue=()=>n(!1),e[88]=ue):ue=e[88];let me;e[89]!==o||e[90]!==i?(me=(0,t.jsx)(To,{isOpen:i,onClose:ue,community:o,onUpdate:Uc}),e[89]=o,e[90]=i,e[91]=me):me=e[91];let fe;e[92]===Symbol.for("react.memo_cache_sentinel")?(fe=()=>l(!1),e[92]=fe):fe=e[92];let we;e[93]!==o||e[94]!==r?(we=(0,t.jsx)(qo,{isOpen:r,onClose:fe,community:o}),e[93]=o,e[94]=r,e[95]=we):we=e[95];let Ne;return e[96]!==de||e[97]!==Z||e[98]!==me||e[99]!==we?(Ne=(0,t.jsxs)("div",{className:"border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen pb-20",children:[de,Z,me,we]}),e[96]=de,e[97]=Z,e[98]=me,e[99]=we,e[100]=Ne):Ne=e[100],Ne},Wc=qc;function Uc(){window.location.reload()}var Bc=Q(),Vc=()=>{const s=(0,Bc.c)(51),{addToast:e}=ze(),{currentUser:a,searchQuery:i,setSearchQuery:n,activeTab:r,setActiveTab:l,isCreateModalOpen:o,setIsCreateModalOpen:c,communitiesData:u,isCommunitiesLoading:d,isFetchingMoreCommunities:m,hasMoreCommunities:f,postsData:p,isPostsLoading:x,isFetchingMorePosts:h,hasMorePosts:b,filteredCommunities:v,handleCommunityClick:j,loadCommunities:y,loadPosts:z,navigate:k}=Mc();if((d||x)&&!u.length&&!p.length){let N;return s[0]===Symbol.for("react.memo_cache_sentinel")?(N=(0,t.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:[1,2,3].map(Qc)}),s[0]=N):N=s[0],N}let _;s[1]!==n?(_=()=>n(""),s[1]=n,s[2]=_):_=s[2];let $;s[3]!==i||s[4]!==n||s[5]!==_?($=(0,t.jsx)(kt,{value:i,onChange:n,onClear:_,placeholder:"Search communities or posts...",className:"flex-1"}),s[3]=i,s[4]=n,s[5]=_,s[6]=$):$=s[6];let A;s[7]!==a||s[8]!==c?(A=a&&(0,t.jsx)("button",{onClick:()=>c(!0),className:"size-11 rounded-xl bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 flex items-center justify-center hover:scale-105 active:scale-95 transition-all shadow-sm shrink-0",title:"Create Community",children:(0,t.jsx)(We,{size:22,strokeWidth:3})}),s[7]=a,s[8]=c,s[9]=A):A=s[9];let S;s[10]!==$||s[11]!==A?(S=(0,t.jsxs)("div",{className:"p-4 flex gap-2",children:[$,A]}),s[10]=$,s[11]=A,s[12]=S):S=s[12];let F;s[13]===Symbol.for("react.memo_cache_sentinel")?(F=(0,t.jsxs)(mt,{value:"communities",className:"h-full rounded-none border-b-2 border-transparent data-[state=active]:border-violet-600 data-[state=active]:bg-transparent px-2 font-bold text-zinc-500 data-[state=active]:text-zinc-950 dark:data-[state=active]:text-white transition-all gap-2",children:[(0,t.jsx)(et,{size:18}),"Communities"]}),s[13]=F):F=s[13];let M;s[14]===Symbol.for("react.memo_cache_sentinel")?(M=(0,t.jsxs)(Gt,{className:"w-full h-12 bg-transparent p-0 rounded-none border-none gap-8 px-4",children:[F,(0,t.jsxs)(mt,{value:"posts",className:"h-full rounded-none border-b-2 border-transparent data-[state=active]:border-violet-600 data-[state=active]:bg-transparent px-2 font-bold text-zinc-500 data-[state=active]:text-zinc-950 dark:data-[state=active]:text-white transition-all gap-2",children:[(0,t.jsx)(wt,{size:18}),"Posts"]})]}),s[14]=M):M=s[14];let R;s[15]!==r||s[16]!==l?(R=(0,t.jsx)("div",{className:"px-1 border-t border-zinc-100 dark:border-zinc-800",children:(0,t.jsx)(Zt,{value:r,onValueChange:l,className:"w-full",children:M})}),s[15]=r,s[16]=l,s[17]=R):R=s[17];let E;s[18]!==S||s[19]!==R?(E=(0,t.jsxs)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-10 border-b border-zinc-100 dark:border-zinc-800",children:[S,R]}),s[18]=S,s[19]=R,s[20]=E):E=s[20];let I;s[21]!==r||s[22]!==v||s[23]!==j||s[24]!==f||s[25]!==m||s[26]!==y?(I=r==="communities"&&(0,t.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:[v.length>0?v.map(N=>(0,t.jsx)(Sa,{profile:N,onUserClick:j,isCommunity:!0},N.handle)):(0,t.jsx)("div",{className:"p-20 text-center text-zinc-500",children:(0,t.jsx)("p",{className:"font-bold",children:"No communities found"})}),f&&v.length>0&&(0,t.jsx)("div",{className:"p-6 flex justify-center border-t border-zinc-100 dark:border-zinc-800",children:(0,t.jsxs)(xe,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>y(!0),disabled:m,children:[m&&(0,t.jsx)(ce,{size:18,className:"animate-spin mr-2"}),"Load more"]})})]}),s[21]=r,s[22]=v,s[23]=j,s[24]=f,s[25]=m,s[26]=y,s[27]=I):I=s[27];let O;s[28]!==r||s[29]!==e||s[30]!==a||s[31]!==b||s[32]!==h||s[33]!==x||s[34]!==z||s[35]!==k||s[36]!==p||s[37]!==i?(O=r==="posts"&&(0,t.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:p.length>0?(0,t.jsxs)(t.Fragment,{children:[p.map(N=>(0,t.jsx)(at,{currentUser:a,showToast:e,...N,onClick:()=>k(`/post/${N.id}`),onUserClick:L=>k(`/u/${L}`)},N.feed_id||N.id)),b&&(0,t.jsx)("div",{className:"p-6 flex justify-center border-t border-zinc-100 dark:border-zinc-800",children:(0,t.jsxs)(xe,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>z(!0),disabled:h,children:[h&&(0,t.jsx)(ce,{size:18,className:"animate-spin mr-2"}),"Load more"]})})]}):x?(0,t.jsx)("div",{className:"p-20 flex justify-center",children:(0,t.jsx)(ce,{className:"animate-spin text-violet-500",size:32})}):(0,t.jsxs)("div",{className:"p-20 text-center text-zinc-500 flex flex-col items-center gap-3",children:[(0,t.jsx)("div",{className:"p-4 bg-zinc-50 dark:bg-zinc-900 rounded-full",children:(0,t.jsx)(wt,{size:32,className:"text-zinc-300"})}),(0,t.jsx)("p",{className:"font-bold",children:i?`No posts found matching "${i}"`:"No posts found"})]})}),s[28]=r,s[29]=e,s[30]=a,s[31]=b,s[32]=h,s[33]=x,s[34]=z,s[35]=k,s[36]=p,s[37]=i,s[38]=O):O=s[38];let D;s[39]!==I||s[40]!==O?(D=(0,t.jsxs)("div",{className:"min-h-screen",children:[I,O]}),s[39]=I,s[40]=O,s[41]=D):D=s[41];let P;s[42]!==c?(P=()=>c(!1),s[42]=c,s[43]=P):P=s[43];let C;s[44]!==o||s[45]!==P?(C=(0,t.jsx)(Ao,{isOpen:o,onClose:P}),s[44]=o,s[45]=P,s[46]=C):C=s[46];let w;return s[47]!==D||s[48]!==C||s[49]!==E?(w=(0,t.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen pb-20 shadow-sm",children:[E,D,C]}),s[47]=D,s[48]=C,s[49]=E,s[50]=w):w=s[50],w},Jc=Vc;function Qc(s){return(0,t.jsx)(Xt,{},s)}var Hc=Q(),Kc=s=>{const e=(0,Hc.c)(24),{user:a,onClick:i,isAddStory:n,isSeen:r}=s,l=n===void 0?!1:n,o=`relative p-0.5 rounded-full ${l?"bg-transparent":r!==void 0&&r?"bg-zinc-200 dark:bg-zinc-800":"bg-gradient-to-tr from-yellow-400 via-pink-500 to-violet-600"}`;let c;e[0]!==a.avatar||e[1]!==a.handle?(c=(0,t.jsx)(ge,{src:a.avatar,alt:a.handle,className:"object-cover"}),e[0]=a.avatar,e[1]=a.handle,e[2]=c):c=e[2];let u;e[3]!==a.handle?.[0]?(u=a.handle?.[0]?.toUpperCase(),e[3]=a.handle?.[0],e[4]=u):u=e[4];let d;e[5]!==u?(d=(0,t.jsx)(ve,{children:u}),e[5]=u,e[6]=d):d=e[6];let m;e[7]!==c||e[8]!==d?(m=(0,t.jsxs)(be,{className:"size-14 sm:size-16 border border-zinc-100 dark:border-zinc-800",children:[c,d]}),e[7]=c,e[8]=d,e[9]=m):m=e[9];let f;e[10]!==l?(f=l&&(0,t.jsx)("div",{className:"absolute bottom-0 right-0 bg-violet-600 border-2 border-white dark:border-black rounded-full p-1 text-white shadow-lg",children:(0,t.jsx)(We,{size:14,strokeWidth:3})}),e[10]=l,e[11]=f):f=e[11];let p;e[12]!==m||e[13]!==f?(p=(0,t.jsx)("div",{className:"bg-white dark:bg-black rounded-full p-0.5",children:(0,t.jsxs)("div",{className:"relative",children:[m,f]})}),e[12]=m,e[13]=f,e[14]=p):p=e[14];let x;e[15]!==o||e[16]!==p?(x=(0,t.jsx)("div",{className:o,children:p}),e[15]=o,e[16]=p,e[17]=x):x=e[17];const h=l?"Add Story":a.handle;let b;e[18]!==h?(b=(0,t.jsx)("span",{className:"text-[11px] font-semibold text-zinc-600 dark:text-zinc-400 truncate w-16 text-center leading-tight",children:h}),e[18]=h,e[19]=b):b=e[19];let v;return e[20]!==i||e[21]!==x||e[22]!==b?(v=(0,t.jsxs)("button",{onClick:i,className:"flex flex-col items-center gap-2 group shrink-0",children:[x,b]}),e[20]=i,e[21]=x,e[22]=b,e[23]=v):v=e[23],v},gs=Kc,Yc=Q(),Xc=s=>{const e=(0,Yc.c)(49),{onStoryClick:a,onAddStory:i}=s,{currentUser:n}=pe(),{posts:r,loading:l,hasMore:o,isFetchingNextPage:c,fetchNextPage:u}=Vt(),{addToast:d}=ze(),m=je();let f;e[0]===Symbol.for("react.memo_cache_sentinel")?(f={threshold:.1},e[0]=f):f=e[0];const{ref:p,inView:x}=vn(f);let h,b;e[1]!==u||e[2]!==o||e[3]!==x||e[4]!==c?(h=()=>{x&&o&&!c&&u()},b=[x,o,c,u],e[1]=u,e[2]=o,e[3]=x,e[4]=c,e[5]=h,e[6]=b):(h=e[5],b=e[6]),(0,g.useEffect)(h,b);let v;e[7]===Symbol.for("react.memo_cache_sentinel")?(v={queryKey:["stories"],queryFn:zr},e[7]=v):v=e[7];const{data:j,isLoading:y}=Ee(v);let z;e[8]!==j?(z=j===void 0?[]:j,e[8]=j,e[9]=z):z=e[9];const k=z;let _;if(e[10]!==k){const T={};k.forEach(B=>{if(!B.user)return;const H=B.user.id;T[H]||(T[H]={user:B.user,stories:[]}),T[H].stories.push(B)}),_=Object.values(T),e[10]=k,e[11]=_}else _=e[11];const $=_,A=r;let S;e[12]!==m?(S=T=>{m(`/post/${T}`)},e[12]=m,e[13]=S):S=e[13];const F=S;let M;e[14]!==m?(M=T=>{m(`/u/${T}`)},e[14]=m,e[15]=M):M=e[15];const R=M;if(l||y){let T;return e[16]===Symbol.for("react.memo_cache_sentinel")?(T=(0,t.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:[(0,t.jsxs)(xs,{className:"w-full whitespace-nowrap border-b border-zinc-100 dark:border-zinc-800",children:[(0,t.jsxs)("div",{className:"flex w-max gap-3 py-4 px-4",children:[(0,t.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"}),(0,t.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"}),(0,t.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"})]}),(0,t.jsx)(qt,{orientation:"horizontal",className:"hidden"})]}),[1,2,3].map(Gc)]}),e[16]=T):T=e[16],T}let E;e[17]!==n||e[18]!==i?(E=n&&(0,t.jsx)(gs,{user:n,isAddStory:!0,onClick:i}),e[17]=n,e[18]=i,e[19]=E):E=e[19];let I;e[20]!==$||e[21]!==a?(I=$.map(T=>{const B=JSON.parse(localStorage.getItem("seenStories")||"[]").includes(T.user.id);return(0,t.jsx)(gs,{user:T.user,isSeen:B,onClick:()=>a(T)},T.user.id)}),e[20]=$,e[21]=a,e[22]=I):I=e[22];let O;e[23]!==E||e[24]!==I?(O=(0,t.jsxs)("div",{className:"flex w-max gap-4 py-4 px-4",children:[E,I]}),e[23]=E,e[24]=I,e[25]=O):O=e[25];let D;e[26]===Symbol.for("react.memo_cache_sentinel")?(D=(0,t.jsx)(qt,{orientation:"horizontal",className:"hidden"}),e[26]=D):D=e[26];let P;e[27]!==O?(P=(0,t.jsxs)(xs,{className:"w-full border-b border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black",children:[O,D]}),e[27]=O,e[28]=P):P=e[28];let C;e[29]!==n?(C=!n&&(0,t.jsx)("div",{className:"px-4 py-2 md:hidden",children:(0,t.jsx)(Ea,{className:"p-6"})}),e[29]=n,e[30]=C):C=e[30];let w;e[31]!==d||e[32]!==n||e[33]!==F||e[34]!==R||e[35]!==A?(w=A.length>0?A.map(T=>(0,t.jsx)(at,{...T,currentUser:n,showToast:d,onClick:()=>F(T.id),onUserClick:R},T.feed_id||T.id)):(0,t.jsxs)("div",{className:"p-20 text-center text-zinc-500",children:[(0,t.jsx)("p",{className:"text-lg font-medium",children:"No posts yet."}),(0,t.jsx)("p",{className:"text-sm",children:"Be the first to share something amazing!"})]}),e[31]=d,e[32]=n,e[33]=F,e[34]=R,e[35]=A,e[36]=w):w=e[36];let N;e[37]!==o||e[38]!==A.length||e[39]!==c||e[40]!==p?(N=A.length>0&&(0,t.jsx)("div",{ref:p,className:"py-8 flex justify-center",children:c?(0,t.jsx)(ce,{className:"animate-spin text-violet-500",size:24}):o?(0,t.jsx)("div",{className:"h-4"}):(0,t.jsx)("p",{className:"text-sm text-zinc-500 font-medium",children:"You've reached the end of the feed."})}),e[37]=o,e[38]=A.length,e[39]=c,e[40]=p,e[41]=N):N=e[41];let L;e[42]!==w||e[43]!==N?(L=(0,t.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen pb-20 shadow-sm",children:[w,N]}),e[42]=w,e[43]=N,e[44]=L):L=e[44];let W;return e[45]!==P||e[46]!==C||e[47]!==L?(W=(0,t.jsxs)("div",{className:"w-full max-w-full overflow-hidden",children:[P,C,L]}),e[45]=P,e[46]=C,e[47]=L,e[48]=W):W=e[48],W},Zc=Xc;function Gc(s){return(0,t.jsx)(Xt,{},s)}var ed=Q(),td=s=>{const e=(0,ed.c)(55),{conv:a,selectedId:i,onSelect:n,onlineUsers:r}=s,l=je(),o=Ia(a.user?.lastSeen);let c;e[0]!==a.user?.id||e[1]!==r?(c=r.has(a.user?.id),e[0]=a.user?.id,e[1]=r,e[2]=c):c=e[2];const u=c;let d;e[3]!==a.user||e[4]!==l?(d=P=>{P.stopPropagation(),a.user?.handle&&l(`/u/${a.user.handle}`)},e[3]=a.user,e[4]=l,e[5]=d):d=e[5];const m=d;let f;e[6]!==a||e[7]!==n?(f=()=>n(a),e[6]=a,e[7]=n,e[8]=f):f=e[8];const p=`flex items-center gap-3 p-4 cursor-pointer transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900 ${i===a.id?"bg-zinc-50 dark:bg-zinc-900 border-r-2 border-violet-500":""}`,x=a.user?.avatar,h=a.user?.name;let b;e[9]!==x||e[10]!==h?(b=(0,t.jsx)(ge,{src:x,alt:h,className:"object-cover"}),e[9]=x,e[10]=h,e[11]=b):b=e[11];let v;e[12]!==a.user?.name?.[0]?(v=a.user?.name?.[0]?.toUpperCase(),e[12]=a.user?.name?.[0],e[13]=v):v=e[13];let j;e[14]!==v?(j=(0,t.jsx)(ve,{children:v}),e[14]=v,e[15]=j):j=e[15];let y;e[16]!==b||e[17]!==j?(y=(0,t.jsxs)(be,{className:"size-12 group-hover:brightness-90 transition-all",children:[b,j]}),e[16]=b,e[17]=j,e[18]=y):y=e[18];let z;e[19]!==u?(z=u&&(0,t.jsx)("span",{className:"absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full"}),e[19]=u,e[20]=z):z=e[20];let k;e[21]!==m||e[22]!==y||e[23]!==z?(k=(0,t.jsxs)("div",{className:"relative group",onClick:m,children:[y,z]}),e[21]=m,e[22]=y,e[23]=z,e[24]=k):k=e[24];const _=a.user?.name;let $;e[25]!==m||e[26]!==_?($=(0,t.jsx)("span",{onClick:m,className:"font-bold dark:text-white truncate cursor-pointer",children:_}),e[25]=m,e[26]=_,e[27]=$):$=e[27];let A;e[28]!==a.user?.lastSeen||e[29]!==u||e[30]!==o?(A=u?(0,t.jsx)("span",{className:"text-[10px] text-emerald-500 font-medium leading-none mb-1",children:"Online"}):a.user?.lastSeen&&(0,t.jsx)("span",{className:"text-[10px] text-zinc-500 font-medium leading-none mb-1",children:o}),e[28]=a.user?.lastSeen,e[29]=u,e[30]=o,e[31]=A):A=e[31];let S;e[32]!==$||e[33]!==A?(S=(0,t.jsxs)("div",{className:"flex flex-col min-w-0",children:[$,A]}),e[32]=$,e[33]=A,e[34]=S):S=e[34];let F;e[35]!==a.time?(F=(0,t.jsx)("span",{className:"text-xs text-zinc-500 whitespace-nowrap ml-2",children:a.time}),e[35]=a.time,e[36]=F):F=e[36];let M;e[37]!==S||e[38]!==F?(M=(0,t.jsxs)("div",{className:"flex justify-between items-center mb-0.5",children:[S,F]}),e[37]=S,e[38]=F,e[39]=M):M=e[39];let R;e[40]!==a.lastMessage?(R=(0,t.jsx)("p",{className:"text-zinc-500 text-sm truncate pr-2",children:a.lastMessage}),e[40]=a.lastMessage,e[41]=R):R=e[41];let E;e[42]!==a.unread?(E=a.unread>0&&(0,t.jsx)("span",{className:"bg-violet-600 text-white text-[10px] font-bold size-5 rounded-full flex items-center justify-center shrink-0",children:a.unread}),e[42]=a.unread,e[43]=E):E=e[43];let I;e[44]!==R||e[45]!==E?(I=(0,t.jsxs)("div",{className:"flex-1 flex justify-between items-center",children:[R,E]}),e[44]=R,e[45]=E,e[46]=I):I=e[46];let O;e[47]!==M||e[48]!==I?(O=(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[M,I]}),e[47]=M,e[48]=I,e[49]=O):O=e[49];let D;return e[50]!==k||e[51]!==O||e[52]!==f||e[53]!==p?(D=(0,t.jsxs)("div",{onClick:f,className:p,children:[k,O]}),e[50]=k,e[51]=O,e[52]=f,e[53]=p,e[54]=D):D=e[54],D},sd=({conversations:s,userResults:e=[],onSelect:a,onStartNew:i,selectedId:n,searchQuery:r,onSearchChange:l,onlineUsers:o=new Set})=>(0,t.jsxs)("div",{className:"flex-1 flex flex-col min-w-0 bg-white dark:bg-black",children:[(0,t.jsx)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800",children:(0,t.jsx)(kt,{value:r,onChange:l,onClear:()=>l(""),placeholder:"Search people or messages..."})}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[s.length>0&&(0,t.jsx)("div",{className:"py-2",children:s.filter(c=>c.lastMessage!=="No messages yet"||c.id===n).map(c=>(0,t.jsx)(td,{conv:c,selectedId:n,onSelect:a,onlineUsers:o},c.id))}),e.length>0&&(0,t.jsxs)("div",{className:"border-t border-zinc-100 dark:border-zinc-800",children:[(0,t.jsx)("div",{className:"px-4 py-3 text-xs font-bold text-zinc-500 uppercase tracking-wider",children:"People"}),e.map(c=>(0,t.jsxs)("div",{onClick:()=>i(c),className:"flex items-center gap-3 p-4 cursor-pointer transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[(0,t.jsxs)(be,{className:"size-12",children:[(0,t.jsx)(ge,{src:c.avatar,alt:c.name,className:"object-cover"}),(0,t.jsx)(ve,{children:c.name?.[0]?.toUpperCase()})]}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("div",{className:"font-bold dark:text-white truncate",children:c.name}),(0,t.jsxs)("div",{className:"text-zinc-500 text-sm truncate",children:["@",c.handle]})]}),(0,t.jsx)(ks,{size:18,className:"text-violet-500"})]},c.id))]}),s.length===0&&e.length===0&&r&&(0,t.jsx)("div",{className:"p-8 text-center",children:(0,t.jsxs)("p",{className:"text-zinc-500 text-sm",children:['No conversations or people found for "',r,'"']})}),s.length===0&&!r&&(0,t.jsx)("div",{className:"p-8 text-center",children:(0,t.jsx)("p",{className:"text-zinc-500 text-sm",children:"No messages yet. Search for people to start a chat!"})})]})]}),ad=sd,id=Q(),nd=["","","","","",""],rd=s=>{const e=(0,id.c)(6),{onSelect:a,currentReaction:i}=s;let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,t.jsx)(ka,{asChild:!0,children:(0,t.jsx)("button",{className:"p-1.5 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-300 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full transition-all active:scale-90",onClick:od,children:(0,t.jsx)(qs,{size:16})})}),e[0]=n):n=e[0];let r;e[1]!==i||e[2]!==a?(r=nd.map(o=>(0,t.jsx)("button",{onClick:()=>a(o),className:`text-xl p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full transition-all active:scale-125 ${i===o?"bg-zinc-100 dark:bg-zinc-800":""}`,children:o},o)),e[1]=i,e[2]=a,e[3]=r):r=e[3];let l;return e[4]!==r?(l=(0,t.jsxs)(Na,{children:[n,(0,t.jsx)(_a,{side:"top",align:"center",className:"w-fit p-1 rounded-full bg-white dark:bg-zinc-900 border border-zinc-100 dark:border-zinc-800 shadow-xl",onClick:cd,children:(0,t.jsx)("div",{className:"flex items-center gap-1",children:r})})]}),e[4]=r,e[5]=l):l=e[5],l},ld=rd;function od(s){return s.stopPropagation()}function cd(s){return s.stopPropagation()}var dd=Q(),md=s=>{const e=(0,dd.c)(10),{reactions:a,currentUser:i,onToggle:n}=s;let r;e[0]!==a?(r=a===void 0?[]:a,e[0]=a,e[1]=r):r=e[1];const l=r;let o;e[2]!==i?.id||e[3]!==l?(o={},l.forEach(m=>{o[m.emoji]||(o[m.emoji]={count:0,me:!1}),o[m.emoji].count=o[m.emoji].count+1,m.user_id===i?.id&&(o[m.emoji].me=!0)}),e[2]=i?.id,e[3]=l,e[4]=o):o=e[4];const c=o;if(l.length===0)return null;let u;e[5]!==c?(u=Object.entries(c),e[5]=c,e[6]=u):u=e[6];let d;return e[7]!==n||e[8]!==u?(d=(0,t.jsx)("div",{className:"flex flex-wrap gap-1 mt-1 px-2",children:u.map(m=>{const[f,p]=m;return(0,t.jsxs)("button",{onClick:x=>{x.stopPropagation(),n(f)},className:`flex items-center gap-1.5 px-2 py-0.5 rounded-full text-xs font-medium border transition-all active:scale-90 ${p.me?"bg-violet-50 border-violet-200 text-violet-600 dark:bg-violet-900/30 dark:border-violet-800 dark:text-violet-400":"bg-white border-zinc-100 text-zinc-600 dark:bg-zinc-900 dark:border-zinc-800 dark:text-zinc-400"}`,children:[(0,t.jsx)("span",{children:f}),p.count>1&&(0,t.jsx)("span",{children:p.count})]},f)})}),e[7]=n,e[8]=u,e[9]=d):d=e[9],d},ud=md,fd=["","","","","",""],xd=({conversation:s,messages:e,onBack:a,onSendMessage:i,onToggleReaction:n,onDeleteMessage:r,currentUser:l,onTyping:o,isLoading:c,isTyping:u,isOnline:d})=>{const m=je(),{openLightbox:f}=Jt(),[p,x]=(0,g.useState)(""),[h,b]=(0,g.useState)(!1),[v,j]=(0,g.useState)([]),[y,z]=(0,g.useState)(!1),[k,_]=(0,g.useState)(null),$=(0,g.useRef)(null),A=(0,g.useRef)(null),S=(0,g.useRef)(null),F=Ia(s.user?.lastSeen);(0,g.useEffect)(()=>{A.current&&(A.current.scrollTop=A.current.scrollHeight)},[e,u]);const M=w=>{const N=w.target.value;x(N),o&&(o(!0),S.current&&clearTimeout(S.current),S.current=setTimeout(()=>{o(!1)},2e3))},R=w=>{x(N=>N+w.emoji)},E=w=>{w.preventDefault(),!(!p.trim()&&v.length===0)&&(o&&(clearTimeout(S.current),o(!1)),i(s.id,p,v.length>0?"image":"text",v,k?.id),x(""),j([]),_(null))},I=async w=>{const N=Array.from(w.target.files);if(N.length!==0){b(!0);try{const L=await Promise.all(N.map(W=>Ae(W)));j(W=>[...W,...L])}catch(L){console.error("Upload failed:",L)}finally{b(!1)}}},O=w=>{j(N=>N.filter(L=>L.url!==w))},D=w=>{!w.media||w.media.length===0||f(w.media.map(N=>N.url),0)},P=(0,g.useMemo)(()=>{const w=e.filter(N=>N.sender==="me");return w.length>0?w[w.length-1].id:null},[e]),C=w=>e.find(N=>N.id===w);return(0,t.jsxs)("div",{className:"flex-1 flex flex-col h-full min-w-0 bg-white dark:bg-black md:border-l md:border-zinc-100 dark:md:border-zinc-800",children:[(0,t.jsxs)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800 flex items-center justify-between shrink-0 bg-white/80 dark:bg-black/80 backdrop-blur-md sticky top-0 z-10",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("button",{onClick:a,className:"md:hidden p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:(0,t.jsx)(tt,{size:20})}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)(be,{className:"size-10 border border-zinc-200 dark:border-zinc-700",children:[(0,t.jsx)(ge,{src:s.user.avatar,alt:s.user.name,className:"object-cover"}),(0,t.jsx)(ve,{children:s.user.name?.[0]?.toUpperCase()})]}),d&&(0,t.jsx)("span",{className:"absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-bold dark:text-white",children:s.user.name}),d?(0,t.jsxs)("div",{className:"text-xs text-emerald-500 font-medium flex items-center gap-1",children:[(0,t.jsx)("span",{className:"size-1.5 bg-emerald-500 rounded-full animate-pulse"}),"Online"]}):(0,t.jsx)("div",{className:"text-xs text-zinc-500 font-medium",children:s.user.lastSeen?`Last seen ${F}`:"Offline"})]})]}),(0,t.jsx)("button",{className:"p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full dark:text-zinc-400",children:(0,t.jsx)(si,{size:20})})]}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",ref:A,children:[(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsxs)("div",{className:"relative w-fit mx-auto",children:[(0,t.jsxs)(be,{className:"size-20 mx-auto mb-3 border-4 border-zinc-50 dark:border-zinc-900 shadow-sm",children:[(0,t.jsx)(ge,{src:s.user.avatar,alt:s.user.name,className:"object-cover"}),(0,t.jsx)(ve,{className:"text-2xl font-bold",children:s.user.name?.[0]?.toUpperCase()})]}),d&&(0,t.jsx)("span",{className:"absolute bottom-4 right-1 size-5 bg-emerald-500 border-4 border-white dark:border-black rounded-full animate-in zoom-in duration-300"})]}),(0,t.jsx)("h4",{className:"font-bold dark:text-white text-lg",children:s.user.name}),(0,t.jsxs)("p",{className:"text-sm text-zinc-500",children:["@",s.user.handle]}),(0,t.jsxs)("p",{className:"text-xs text-zinc-400 mt-4 max-w-xs mx-auto",children:["This is the beginning of your direct message history with"," ",(0,t.jsxs)("span",{className:"font-bold",children:["@",s.user.handle]})]})]}),c&&e.length===0?(0,t.jsx)("div",{className:"flex justify-center p-8",children:(0,t.jsx)(ce,{className:"animate-spin text-violet-500",size:32})}):e.map(w=>(0,t.jsxs)(_l,{children:[(0,t.jsx)(Cl,{asChild:!0,children:(0,t.jsxs)("div",{id:`msg-${w.id}`,className:`flex items-end gap-2 group ${w.sender==="me"?"flex-row-reverse":"flex-row"}`,children:[(0,t.jsxs)("div",{className:`max-w-[75%] p-1 rounded-2xl text-[15px] shadow-sm relative ${w.sender==="me"?"bg-violet-600 text-white rounded-tr-none":"bg-zinc-100 dark:bg-zinc-800 dark:text-white rounded-tl-none"}`,children:[w.replyToId&&(0,t.jsxs)("div",{className:`mb-2 p-2 rounded-lg border-l-4 text-xs truncate cursor-pointer ${w.sender==="me"?"bg-violet-500/50 border-violet-300 text-violet-100":"bg-zinc-200/50 dark:bg-zinc-700/50 border-zinc-400 dark:border-zinc-500 text-zinc-600 dark:text-zinc-300"}`,onClick:N=>{N.stopPropagation(),document.getElementById(`msg-${w.replyToId}`)?.scrollIntoView({behavior:"smooth",block:"center"})},children:[(0,t.jsx)("span",{className:"font-bold block mb-0.5",children:C(w.replyToId)?.sender==="me"?"You":s.user.name}),C(w.replyToId)?.text||"Media"]}),w.media?.length>0&&(0,t.jsx)("div",{className:"mb-2 grid gap-1 grid-cols-1 overflow-hidden rounded-lg cursor-pointer",onClick:()=>D(w),children:w.media.map((N,L)=>(0,t.jsx)("img",{src:N.url,alt:"",className:"max-h-60 w-full object-cover rounded-md hover:brightness-90 transition-all"},L))}),w.text&&(0,t.jsx)("div",{className:"m-0 leading-tight px-3 py-1 whitespace-pre-line break-words",children:(0,t.jsx)(xt,{options:{...gt,render:({attributes:N,content:L})=>{const{href:W,...T}=N,B=!W.startsWith("/")&&(W.startsWith("http")||W.startsWith("www"));return W.startsWith("/u/")||W.startsWith("/tags/")||W.startsWith("/c/")||W.startsWith("/explore")?(0,t.jsx)("span",{...T,className:`underline decoration-2 underline-offset-2 cursor-pointer transition-opacity break-all ${w.sender==="me"?"text-white":"text-rose-500 dark:text-rose-400"}`,onClick:H=>{H.stopPropagation(),m(W)},children:L},L):(0,t.jsx)("a",{href:W,...T,className:`underline decoration-2 underline-offset-2 hover:opacity-80 transition-opacity break-all ${w.sender==="me"?"text-white":""}`,target:B?"_blank":void 0,rel:B?"noopener noreferrer":void 0,onClick:H=>H.stopPropagation(),children:L},L)}},children:w.text})}),w.reactions?.length>0&&(0,t.jsx)(ud,{reactions:w.reactions,currentUser:l,onToggle:N=>n(w.id,N)}),(0,t.jsxs)("div",{className:`text-[10px] flex items-center justify-end gap-1 px-3 pb-1 ${w.sender==="me"?"text-violet-200":"text-zinc-400"}`,children:[w.time,w.sender==="me"&&w.id===P&&(0,t.jsx)("span",{className:"ml-0.5",children:w.isRead?(0,t.jsx)(li,{size:14,className:"text-white"}):(0,t.jsx)(Ns,{size:14,className:"text-violet-200"})})]})]}),(0,t.jsx)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:(0,t.jsx)(ld,{onSelect:N=>n(w.id,N),currentReaction:w.reactions?.find(N=>N.user_id===l?.id)?.emoji})})]})}),(0,t.jsxs)(Sl,{className:"w-64 rounded-xl bg-white dark:bg-zinc-950 border-zinc-100 dark:border-zinc-800 shadow-xl",children:[(0,t.jsx)(Pl,{className:"text-xs text-zinc-500 font-bold px-3 py-2",children:"QUICK REACTION"}),(0,t.jsx)("div",{className:"flex items-center justify-between px-2 pb-2",children:fd.map(N=>(0,t.jsx)("button",{onClick:()=>n(w.id,N),className:"text-xl p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full transition-all active:scale-125",children:N},N))}),(0,t.jsx)(fs,{className:"bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsxs)(Et,{className:"gap-3 px-3 py-2.5 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-900",onClick:()=>{navigator.clipboard.writeText(w.text)},children:[(0,t.jsx)(zi,{size:16,className:"text-zinc-500"}),(0,t.jsx)("span",{className:"font-medium",children:"Copy Text"})]}),(0,t.jsxs)(Et,{className:"gap-3 px-3 py-2.5 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-900",onClick:()=>_(w),children:[(0,t.jsx)(Ii,{size:16,className:"text-zinc-500"}),(0,t.jsx)("span",{className:"font-medium",children:"Reply"})]}),(0,t.jsx)(fs,{className:"bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsxs)(Et,{className:"gap-3 px-3 py-2.5 cursor-pointer text-rose-500 focus:text-rose-500 focus:bg-rose-50 dark:focus:bg-rose-900/20",onClick:()=>r(w.id),children:[(0,t.jsx)(It,{size:16}),(0,t.jsx)("span",{className:"font-medium",children:"Delete message"})]})]})]},w.id)),u&&(0,t.jsx)("div",{className:"flex justify-start animate-in fade-in slide-in-from-bottom-2 duration-300",children:(0,t.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-800/50 px-3 py-2 rounded-2xl rounded-tl-none border border-zinc-200/50 dark:border-zinc-700/30 shadow-sm",children:(0,t.jsx)(zo,{})})})]}),(0,t.jsxs)("div",{className:"p-4 border-t border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black shrink-0",children:[k&&(0,t.jsxs)("div",{className:"mb-3 p-3 bg-zinc-50 dark:bg-zinc-900 border border-zinc-100 dark:border-zinc-800 rounded-xl flex items-center justify-between animate-in slide-in-from-bottom-2 duration-200",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("span",{className:"text-xs font-bold text-violet-600 dark:text-violet-400 block mb-1",children:["Replying to"," ",k.sender==="me"?"yourself":s.user.name]}),(0,t.jsx)("p",{className:"text-sm text-zinc-500 truncate",children:k.text||"Media"})]}),(0,t.jsx)("button",{onClick:()=>_(null),className:"p-1 hover:bg-zinc-200 dark:hover:bg-zinc-800 rounded-full text-zinc-400 transition-colors",children:(0,t.jsx)($e,{size:18})})]}),v.length>0&&(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 mb-3",children:[v.map(w=>(0,t.jsxs)("div",{className:"relative size-16 rounded-xl overflow-hidden border border-zinc-200 dark:border-zinc-800",children:[(0,t.jsx)("img",{src:w.url,className:"size-full object-cover",alt:""}),(0,t.jsx)("button",{type:"button",onClick:()=>O(w.url),className:"absolute top-1 right-1 bg-black/50 text-white rounded-full p-0.5 hover:bg-black transition-colors",children:(0,t.jsx)($e,{size:12})})]},w.url)),h&&(0,t.jsx)("div",{className:"size-16 rounded-xl bg-zinc-100 dark:bg-zinc-900 flex items-center justify-center",children:(0,t.jsx)(ce,{className:"animate-spin text-violet-500",size:20})})]}),(0,t.jsxs)("form",{onSubmit:E,className:"flex items-center gap-2 bg-zinc-100 dark:bg-zinc-900 p-2 rounded-2xl border border-transparent focus-within:border-violet-500 transition-all",children:[(0,t.jsxs)(Na,{open:y,onOpenChange:z,children:[(0,t.jsx)(ka,{asChild:!0,children:(0,t.jsx)("button",{type:"button",className:"p-2 text-zinc-500 hover:text-violet-600 transition-colors",children:(0,t.jsx)(qs,{size:20})})}),(0,t.jsx)(_a,{className:"w-fit p-0 border-none bg-transparent shadow-none",side:"top",align:"start",sideOffset:10,children:(0,t.jsx)(Il,{onEmojiSelect:w=>{R(w)}})})]}),(0,t.jsx)("input",{type:"text",className:"flex-1 min-w-0 bg-transparent border-none outline-none dark:text-white py-1 px-1",placeholder:"Start a new message",value:p,onChange:M}),(0,t.jsx)("input",{type:"file",ref:$,onChange:I,className:"hidden",multiple:!0,accept:"image/*"}),(0,t.jsx)("button",{type:"button",onClick:()=>$.current?.click(),className:"p-2 text-zinc-500 hover:text-violet-600 transition-colors",disabled:h,children:(0,t.jsx)(Ws,{size:20})}),(0,t.jsx)(xe,{type:"submit",className:"size-10 !p-0 rounded-xl",disabled:!p.trim()&&v.length===0||h,children:(0,t.jsx)(ln,{size:18})})]})]})]})},hd=xd,pd=Q(),bd=()=>{const s=(0,pd.c)(73),{id:e}=ut(),a=je(),{currentUser:i}=pe(),{onlineUsers:n}=oa(),r=Ct(),[l,o]=(0,g.useState)("");let c;s[0]===Symbol.for("react.memo_cache_sentinel")?(c=[],s[0]=c):c=s[0];const[u,d]=(0,g.useState)(c),{conversations:m,isConvLoading:f,sendMessage:p,sendTypingStatus:x,typingStatus:h,markAsRead:b,formatMessages:v,onToggleReaction:j,allReactions:y}=Qt(i);let z;e:{if(!e||m.length===0){z=null;break e}let Z;s[1]!==m||s[2]!==e?(Z=m.find(ue=>ue.id===e)||null,s[1]=m,s[2]=e,s[3]=Z):Z=s[3],z=Z}const k=z;let _,$;s[4]!==e||s[5]!==b?(_=()=>{e&&b(e)},$=[e,b],s[4]=e,s[5]=b,s[6]=_,s[7]=$):(_=s[6],$=s[7]),(0,g.useEffect)(_,$);let A;s[8]!==m||s[9]!==i?.id||s[10]!==l?(A=()=>{const Z=setTimeout(async()=>{if(l.length>1){const ue=await Yn(l),me=m.map(gd);d(ue.filter(fe=>fe.id!==i?.id&&!me.includes(fe.id)))}else d([])},300);return()=>clearTimeout(Z)},s[8]=m,s[9]=i?.id,s[10]=l,s[11]=A):A=s[11];const S=i?.id;let F;s[12]!==m||s[13]!==l||s[14]!==S?(F=[l,m,S],s[12]=m,s[13]=l,s[14]=S,s[15]=F):F=s[15],(0,g.useEffect)(A,F);let M;s[16]!==i||s[17]!==a||s[18]!==r?(M=async Z=>{try{const ue=await aa(i.id,Z.id);r.invalidateQueries({queryKey:["conversations",i.id]}),o(""),a(`/messages/${ue}`)}catch(ue){console.error("Failed to start conversation:",ue)}},s[16]=i,s[17]=a,s[18]=r,s[19]=M):M=s[19];const R=M;let E;s[20]!==a?(E=Z=>{a(`/messages/${Z.id}`)},s[20]=a,s[21]=E):E=s[21];const I=E,O=k?.id;let D;s[22]!==O?(D=["messages",O],s[22]=O,s[23]=D):D=s[23];let P;s[24]!==k?.id?(P=()=>hr(k?.id),s[24]=k?.id,s[25]=P):P=s[25];const C=!!k?.id;let w;s[26]!==D||s[27]!==P||s[28]!==C?(w={queryKey:D,queryFn:P,enabled:C},s[26]=D,s[27]=P,s[28]=C,s[29]=w):w=s[29];const{data:N,isLoading:L}=Ee(w);let W;s[30]!==N?(W=N===void 0?[]:N,s[30]=N,s[31]=W):W=s[31];const T=W;let B;s[32]!==y||s[33]!==T||s[34]!==v?(B=v(T,y),s[32]=y,s[33]=T,s[34]=v,s[35]=B):B=s[35];const H=B;if(!i){let Z;return s[36]===Symbol.for("react.memo_cache_sentinel")?(Z=(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-screen gap-4 p-8 text-center bg-white dark:bg-black md:rounded-xl md:border border-zinc-100 dark:border-zinc-800",children:[(0,t.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-900 p-4 rounded-full",children:(0,t.jsx)(Ms,{size:40,className:"text-zinc-400"})}),(0,t.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"Sign in to message others"}),(0,t.jsx)("p",{className:"text-zinc-500 max-w-xs",children:"Start decentralized conversations with anyone on the network."})]}),s[36]=Z):Z=s[36],Z}if(f){let Z;return s[37]===Symbol.for("react.memo_cache_sentinel")?(Z=(0,t.jsx)("div",{className:"flex h-screen items-center justify-center bg-white dark:bg-black md:rounded-xl md:border border-zinc-100 dark:border-zinc-800",children:(0,t.jsx)(ce,{className:"animate-spin text-violet-500",size:32})}),s[37]=Z):Z=s[37],Z}let te;if(s[38]!==m||s[39]!==l){let Z;s[41]!==l?(Z=ue=>ue.user?.name?.toLowerCase().includes(l.toLowerCase())||ue.user?.handle?.toLowerCase().includes(l.toLowerCase())||ue.lastMessage?.toLowerCase().includes(l.toLowerCase()),s[41]=l,s[42]=Z):Z=s[42],te=m.filter(Z),s[38]=m,s[39]=l,s[40]=te}else te=s[40];const re=te,ie=k&&h[k.id];let oe;s[43]!==n||s[44]!==k?(oe=k&&n.has(k.user?.id),s[43]=n,s[44]=k,s[45]=oe):oe=s[45];const G=oe,ae=`flex ${e?"h-[100dvh]":"h-[calc(100dvh-4rem)]"} md:h-[calc(100vh-2rem)] bg-white dark:bg-black overflow-hidden md:rounded-xl md:border border-zinc-100 dark:border-zinc-800`,V=`w-full md:w-80 flex flex-col border-r border-zinc-100 dark:border-zinc-800 ${k?"hidden md:flex":"flex"}`;let J;s[46]===Symbol.for("react.memo_cache_sentinel")?(J=(0,t.jsx)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800",children:(0,t.jsx)("h2",{className:"text-xl font-bold dark:text-white",children:"Messages"})}),s[46]=J):J=s[46];let K;s[47]!==re||s[48]!==I||s[49]!==R||s[50]!==e||s[51]!==l||s[52]!==n||s[53]!==u?(K=(0,t.jsx)(ad,{conversations:re,userResults:u,onSelect:I,onStartNew:R,selectedId:e,searchQuery:l,onSearchChange:o,onlineUsers:n}),s[47]=re,s[48]=I,s[49]=R,s[50]=e,s[51]=l,s[52]=n,s[53]=u,s[54]=K):K=s[54];let ee;s[55]!==V||s[56]!==K?(ee=(0,t.jsxs)("div",{className:V,children:[J,K]}),s[55]=V,s[56]=K,s[57]=ee):ee=s[57];let X;s[58]!==ie||s[59]!==i||s[60]!==L||s[61]!==H||s[62]!==a||s[63]!==j||s[64]!==G||s[65]!==k||s[66]!==p||s[67]!==x?(X=k?(0,t.jsx)(hd,{conversation:k,messages:H,onBack:()=>a("/messages"),onSendMessage:p,onToggleReaction:j,currentUser:i,onTyping:Z=>x(k.id,Z),isLoading:L,isTyping:ie,isOnline:G}):(0,t.jsxs)("div",{className:"hidden md:flex flex-1 items-center justify-center text-zinc-500 flex-col gap-4",children:[(0,t.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full",children:(0,t.jsx)(Pt,{size:48,className:"text-zinc-300"})}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-zinc-900 dark:text-white",children:"Select a message"}),(0,t.jsx)("p",{children:"Choose from your existing conversations or start a new one."})]})]}),s[58]=ie,s[59]=i,s[60]=L,s[61]=H,s[62]=a,s[63]=j,s[64]=G,s[65]=k,s[66]=p,s[67]=x,s[68]=X):X=s[68];let de;return s[69]!==ae||s[70]!==ee||s[71]!==X?(de=(0,t.jsxs)("div",{className:ae,children:[ee,X]}),s[69]=ae,s[70]=ee,s[71]=X,s[72]=de):de=s[72],de},vs=bd;function gd(s){return s.user?.id}var vd=()=>{const{currentUser:s}=pe(),e=je(),[a,i]=(0,g.useState)([]),[n,r]=(0,g.useState)(!0),[l,o]=(0,g.useState)(!1),[c,u]=(0,g.useState)(!0),d=(0,g.useRef)(a);(0,g.useEffect)(()=>{d.current=a},[a]);const m=(0,g.useCallback)(async(h=!1)=>{if(s?.id){h?o(!0):r(!0);try{const b=d.current,v=h&&b.length>0?b[b.length-1].created_at:null,j=await jr(s.id,v,10);j.length<10?u(!1):u(!0),i(h?y=>[...y,...j]:j)}catch(b){console.error("Failed to fetch notifications:",b)}finally{r(!1),o(!1)}}},[s?.id]);(0,g.useEffect)(()=>{m()},[m]),(0,g.useEffect)(()=>{if(!s?.id)return;const h=q.channel(`user_notifications:${s.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`recipient_id=eq.${s.id}`},()=>{m()}).subscribe();return()=>q.removeChannel(h)},[s?.id,m]);const f=Vs({mutationFn:()=>wr(s.id),onSuccess:()=>{i(h=>h.map(b=>({...b,is_read:!0})))}}),p=h=>{h.type==="follow"?e(`/u/${h.user}`):h.post_id&&e(`/post/${h.post_id}`)};if((0,g.useEffect)(()=>{s?.id&&a.some(h=>!h.is_read)&&f.mutate()},[s?.id,a,f]),n)return(0,t.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,t.jsx)(ce,{size:32,className:"animate-spin text-violet-500"})});if(!s)return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[400px] gap-4 p-8 text-center",children:[(0,t.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-900 p-4 rounded-full",children:(0,t.jsx)(At,{size:40,className:"text-zinc-400"})}),(0,t.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"Sign in to see notifications"}),(0,t.jsx)("p",{className:"text-zinc-500 max-w-xs",children:"Join the conversation and keep track of who's engaging with your content."})]});const x=h=>{switch(h){case"like":return(0,t.jsx)(ct,{size:20,className:"text-rose-500 fill-rose-500"});case"follow":return(0,t.jsx)(ks,{size:20,className:"text-blue-500"});case"mention":return(0,t.jsx)(At,{size:20,className:"text-emerald-500"});case"comment":return(0,t.jsx)(Yi,{size:20,className:"text-violet-500"});case"repost":return(0,t.jsx)(Ja,{size:20,className:"text-amber-500"});default:return(0,t.jsx)(At,{size:20,className:"text-zinc-500"})}};return(0,t.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen pb-20 shadow-sm",children:[(0,t.jsx)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800 sticky top-0 bg-white/80 dark:bg-black/80 backdrop-blur-md z-10",children:(0,t.jsx)("h2",{className:"text-xl font-bold dark:text-white",children:"Notifications"})}),a.length>0?a.map(h=>(0,t.jsxs)("div",{onClick:()=>p(h),className:`p-4 border-b border-zinc-100 dark:border-zinc-800 flex items-start gap-4 hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors cursor-pointer ${h.is_read?"":"bg-violet-50/30 dark:bg-violet-500/5"}`,children:[(0,t.jsx)("div",{className:"shrink-0 pt-1",children:x(h.type)}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-1",children:[(0,t.jsxs)(be,{className:"size-8",children:[(0,t.jsx)(ge,{src:h.avatar}),(0,t.jsx)(ve,{children:h.user?.[0]?.toUpperCase()})]}),(0,t.jsxs)("div",{className:"flex-1 flex justify-between items-center",children:[(0,t.jsxs)("span",{className:"font-bold text-sm dark:text-white truncate",children:["@",h.user]}),(0,t.jsx)("span",{className:"text-zinc-500 text-xs whitespace-nowrap",children:nt(h.created_at)})]})]}),(0,t.jsxs)("p",{className:"text-zinc-600 dark:text-zinc-400 text-[15px] ml-11",children:[h.type==="like"&&"liked your post",h.type==="follow"&&"followed you",h.type==="mention"&&"mentioned you in a post",h.type==="comment"&&"commented on your post",h.type==="repost"&&"reposted your post"]})]}),!h.is_read&&(0,t.jsx)("div",{className:"size-2 rounded-full bg-violet-500 mt-2 shrink-0 shadow-[0_0_8px_rgba(139,92,246,0.5)]"})]},h.id)):(0,t.jsx)("div",{className:"p-16 text-center text-zinc-500",children:(0,t.jsx)("p",{className:"font-medium",children:"No notifications yet."})}),a.length>0&&c&&(0,t.jsx)("div",{className:"p-6 flex justify-center border-t border-zinc-100 dark:border-zinc-800",children:(0,t.jsxs)(xe,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>m(!0),disabled:l,children:[l?(0,t.jsx)(ce,{size:18,className:"animate-spin mr-2"}):null,"Load more"]})}),a.length>0&&!c&&(0,t.jsx)("div",{className:"p-8 text-center text-zinc-500 text-sm",children:"You've caught up with everything!"})]})},jd=vd,wd=Q(),yd=()=>{const s=(0,wd.c)(32),{id:e}=ut(),a=je(),{currentUser:i}=pe(),{addToast:n}=ze();let r,l;s[0]!==e?(r=["post",e],l=async()=>{if(!Pe(e))throw new Error("Invalid post ID");return ar(e)},s[0]=e,s[1]=r,s[2]=l):(r=s[1],l=s[2]);const o=!!e;let c;s[3]!==r||s[4]!==l||s[5]!==o?(c={queryKey:r,queryFn:l,enabled:o,retry:!1},s[3]=r,s[4]=l,s[5]=o,s[6]=c):c=s[6];const{data:u,isLoading:d,isError:m}=Ee(c);if(d){let _;return s[7]===Symbol.for("react.memo_cache_sentinel")?(_=(0,t.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:(0,t.jsx)(Xt,{})}),s[7]=_):_=s[7],_}if(m||!u){let _;return s[8]===Symbol.for("react.memo_cache_sentinel")?(_=(0,t.jsx)("div",{className:"bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-[600px] flex items-center justify-center",children:(0,t.jsx)(Kt,{title:"Post not found",message:"The post you are looking for doesn't exist. It may have been deleted by the author.",icon:mi})}),s[8]=_):_=s[8],_}let f;s[9]!==a?(f=()=>a(-1),s[9]=a,s[10]=f):f=s[10];let p;s[11]===Symbol.for("react.memo_cache_sentinel")?(p=(0,t.jsx)(tt,{size:20,strokeWidth:2.5}),s[11]=p):p=s[11];let x;s[12]!==f?(x=(0,t.jsx)("button",{onClick:f,className:"p-2 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:p}),s[12]=f,s[13]=x):x=s[13];let h;s[14]===Symbol.for("react.memo_cache_sentinel")?(h=(0,t.jsx)("h5",{className:"text-xl font-bold dark:text-white",children:"Post"}),s[14]=h):h=s[14];let b;s[15]!==x?(b=(0,t.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-x-4",children:[x,h]})}),s[15]=x,s[16]=b):b=s[16];let v;s[17]!==u.comments?(v=u.comments||[],s[17]=u.comments,s[18]=v):v=s[18];let j,y;s[19]!==a?(j=_=>a(`/u/${_}`),y=()=>a(-1),s[19]=a,s[20]=j,s[21]=y):(j=s[20],y=s[21]);let z;s[22]!==n||s[23]!==i||s[24]!==u||s[25]!==j||s[26]!==y||s[27]!==v?(z=(0,t.jsx)(at,{...u,isDetail:!0,currentUser:i,initialComments:v,showToast:n,onUserClick:j,onDelete:y}),s[22]=n,s[23]=i,s[24]=u,s[25]=j,s[26]=y,s[27]=v,s[28]=z):z=s[28];let k;return s[29]!==z||s[30]!==b?(k=(0,t.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen pb-16 shadow-sm animate-in slide-in-from-right-5 duration-300",children:(0,t.jsxs)("div",{className:"border-b border-zinc-100 dark:border-zinc-800",children:[b,z]})}),s[29]=z,s[30]=b,s[31]=k):k=s[31],k},zd=yd,Nd=({profile:s,currentUser:e,isCurrentUser:a,onEditProfile:i,showToast:n,isCommunity:r,onShowFollowers:l,onShowFollowing:o})=>{const{isFollowing:c,stats:u,loading:d,handleFollow:m}=Ca(s,e?.id,n),f=je(),[p,x]=(0,g.useState)(!1),h=async()=>{if(!e){n("Please sign in to message users");return}x(!0);try{f(`/messages/${await aa(e.id,s.id)}`)}catch(b){console.error("Failed to start conversation:",b),n("Failed to open chat")}finally{x(!1)}};return(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsxs)("div",{className:"relative h-32 sm:h-48 w-full bg-zinc-200 dark:bg-zinc-800",children:[s.cover&&(0,t.jsx)("img",{src:s.cover,className:"h-full w-full object-cover transition-opacity duration-500",alt:"Cover"}),(0,t.jsx)("div",{className:"absolute -bottom-12 sm:-bottom-16 left-4 sm:left-6",children:(0,t.jsx)("div",{className:"p-1 bg-white dark:bg-black rounded-full overflow-hidden shadow-xl ring-4 ring-white dark:ring-black relative",children:(0,t.jsxs)(be,{className:"size-24 sm:size-32",children:[(0,t.jsx)(ge,{src:s.avatar,alt:s.handle,className:"object-cover"}),(0,t.jsx)(ve,{className:"text-4xl font-bold",children:s.handle?.[0]?.toUpperCase()})]})})})]}),(0,t.jsxs)("div",{className:"flex flex-col p-4 sm:p-6 pt-16 sm:pt-20 space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsx)("div",{className:"flex-1 min-w-0 pr-4"}),(0,t.jsx)("div",{className:"flex gap-2 shrink-0",children:a?(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>i(s),className:"p-2 rounded-full border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 transition-all active:scale-95 flex items-center justify-center size-10",title:"Edit Profile",children:(0,t.jsx)(St,{size:20})}),(0,t.jsx)("button",{onClick:()=>f("/settings"),className:"p-2 rounded-full border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 transition-all active:scale-95",title:"Settings",children:(0,t.jsx)(Qs,{size:20})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:h,disabled:p,className:"rounded-full p-2 border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 dark:border-zinc-800 transition-colors disabled:opacity-50",children:p?(0,t.jsx)(ce,{size:20,className:"animate-spin"}):(0,t.jsx)(Pt,{size:20})}),(0,t.jsx)("button",{className:"rounded-full p-2 border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 dark:border-zinc-800 transition-colors",children:(0,t.jsx)(_t,{size:20})}),(0,t.jsx)(xe,{variant:c?"secondary":"primary",onClick:m,className:"text-sm px-6 min-w-[100px]",disabled:d,children:d?(0,t.jsx)(ce,{size:16,className:"animate-spin mx-auto"}):c?"Following":"Follow"}),(0,t.jsx)("button",{className:"rounded-full p-2 hover:bg-zinc-100 text-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-800 transition-colors",children:(0,t.jsx)(Rt,{size:20})})]})})]}),(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)("div",{className:"flex items-center gap-1.5",children:(0,t.jsxs)("h3",{className:"text-xl sm:text-2xl font-extrabold truncate dark:text-white flex items-center gap-1",children:[s.name,s.verified&&(0,t.jsx)(dt,{})]})}),!r&&(0,t.jsx)("div",{className:"flex items-center space-x-3",children:(0,t.jsxs)("span",{className:"text-zinc-500 font-medium text-sm px-1.5 py-0.5 -ml-1.5 rounded-md dark:text-zinc-400",children:["@",s.handle]})})]}),(0,t.jsx)("div",{className:"whitespace-pre-line text-zinc-900 dark:text-zinc-100 leading-relaxed text-sm sm:text-[15px]",children:(0,t.jsx)(xt,{options:{...gt,render:({attributes:b,content:v})=>{const{href:j,...y}=b,z=!j.startsWith("/")&&(j.startsWith("http")||j.startsWith("www"));return j.startsWith("/u/")||j.startsWith("/tags/")||j.startsWith("/c/")||j.startsWith("/explore")?(0,t.jsx)("span",{...y,className:"text-rose-500 dark:text-rose-400 font-bold hover:underline cursor-pointer",onClick:k=>{k.stopPropagation(),f(j)},children:v},v):(0,t.jsx)("a",{href:j,...y,target:z?"_blank":void 0,rel:z?"noopener noreferrer":void 0,children:v},v)}},children:s.bio})}),(s.website||s.location)&&(0,t.jsxs)("div",{className:"flex flex-wrap gap-x-5 gap-y-2 text-sm pt-1",children:[s.location&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-zinc-600 dark:text-zinc-400",children:[(0,t.jsx)(Ei,{size:14}),(0,t.jsx)("span",{children:s.location})]}),s.website&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-zinc-600 dark:text-zinc-400",children:[(0,t.jsx)(Fs,{size:14}),(0,t.jsx)("a",{href:`https://${s.website}`,target:"_blank",rel:"noreferrer",className:"text-violet-600 hover:underline font-semibold text-black dark:text-white",children:s.website})]})]}),(0,t.jsx)("div",{className:"flex gap-4 sm:gap-6 text-sm pt-2 relative z-10",children:r?(0,t.jsxs)("button",{className:"flex gap-x-1 group cursor-pointer",children:[(0,t.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white",children:s.members}),(0,t.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Members"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{onClick:b=>{b.preventDefault(),b.stopPropagation(),o()},className:"flex gap-x-1 group cursor-pointer",children:[(0,t.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white",children:u.following}),(0,t.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Following"})]}),(0,t.jsxs)("button",{onClick:b=>{b.preventDefault(),b.stopPropagation(),l()},className:"flex gap-x-1 group cursor-pointer",children:[(0,t.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white",children:u.followers}),(0,t.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Followers"})]})]})})]})]})},kd=Nd,_d=Q(),Cd=s=>{const e=(0,_d.c)(89),{onEditProfile:a}=s,{handle:i,profile:n,loading:r,setUserPosts:l,activeProfileTab:o,setActiveProfileTab:c,loadingPosts:u,isFetchingMorePosts:d,hasMorePosts:m,filteredPosts:f,isFollowModalOpen:p,setIsFollowModalOpen:x,followModalType:h,followListData:b,isListLoading:v,isFetchingMoreFollows:j,hasMoreFollows:y,openFollowModal:z,handlePostClick:k,handleUserClick:_,loadUserPosts:$,currentUser:A,addToast:S,navigate:F}=$c();if(r){let me;return e[0]===Symbol.for("react.memo_cache_sentinel")?(me=(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)(ce,{size:40,className:"animate-spin text-violet-500"})}),e[0]=me):me=e[0],me}if(!n){const me=`Try searching for another. The user @${i} could not be found.`;let fe;return e[1]!==me?(fe=(0,t.jsx)("div",{className:"bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-[600px] flex items-center justify-center",children:(0,t.jsx)(Kt,{title:"Account doesn't exist",message:me,icon:Pi})}),e[1]=me,e[2]=fe):fe=e[2],fe}const M=n;let R;e[3]!==o||e[4]!==S||e[5]!==A||e[6]!==M.handle||e[7]!==f||e[8]!==k||e[9]!==_||e[10]!==m||e[11]!==d||e[12]!==$||e[13]!==u||e[14]!==n||e[15]!==l?(R=me=>{const fe=me===void 0?!1:me;return u?(0,t.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,t.jsx)(ce,{className:"animate-spin text-violet-500",size:32})}):f.length>0?(0,t.jsxs)(t.Fragment,{children:[f.map(we=>(0,t.jsx)(at,{currentUser:A,showToast:S,...we,onClick:()=>k(we.id),onUserClick:_,onDelete:Ne=>l(he=>he.filter(ye=>ye.id!==Ne))},we.feed_id||we.id)),m&&(0,t.jsx)("div",{className:"p-6 flex justify-center",children:(0,t.jsxs)(xe,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>$(n.id,!0),disabled:d,children:[d&&(0,t.jsx)(ce,{size:18,className:"animate-spin mr-2"}),"Load more posts"]})})]}):fe?null:(0,t.jsxs)("div",{className:"p-20 text-center text-zinc-500 flex flex-col items-center gap-4 animate-in fade-in duration-500",children:[(0,t.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full mb-2 ring-1 ring-zinc-100 dark:ring-zinc-800",children:(0,t.jsx)(Bt,{size:40,className:"text-zinc-300 dark:text-zinc-700"})}),(0,t.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:o==="collections"?"No collections yet":"No posts yet"}),(0,t.jsx)("p",{className:"text-sm text-zinc-500 dark:text-zinc-400 max-w-[250px]",children:o==="collections"?"Saved posts and curated collections will appear here.":`When @${M.handle} shares posts, they will appear here.`})]})},e[3]=o,e[4]=S,e[5]=A,e[6]=M.handle,e[7]=f,e[8]=k,e[9]=_,e[10]=m,e[11]=d,e[12]=$,e[13]=u,e[14]=n,e[15]=l,e[16]=R):R=e[16];const E=R;let I;e[17]!==F?(I=()=>F(-1),e[17]=F,e[18]=I):I=e[18];let O;e[19]===Symbol.for("react.memo_cache_sentinel")?(O=(0,t.jsx)(tt,{size:22}),e[19]=O):O=e[19];let D;e[20]!==I?(D=(0,t.jsx)("button",{onClick:I,className:"p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:O}),e[20]=I,e[21]=D):D=e[21];let P;e[22]!==M.name?(P=(0,t.jsx)("h5",{className:"text-lg font-bold dark:text-white leading-none",children:M.name}),e[22]=M.name,e[23]=P):P=e[23];const C=M.posts_count||0;let w;e[24]!==C?(w=(0,t.jsxs)("span",{className:"text-xs text-zinc-500 mt-0.5",children:[C," Posts"]}),e[24]=C,e[25]=w):w=e[25];let N;e[26]!==P||e[27]!==w?(N=(0,t.jsxs)("div",{className:"flex flex-col",children:[P,w]}),e[26]=P,e[27]=w,e[28]=N):N=e[28];let L;e[29]!==D||e[30]!==N?(L=(0,t.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3 md:hidden",children:(0,t.jsxs)("div",{className:"flex items-center gap-x-4",children:[D,N]})}),e[29]=D,e[30]=N,e[31]=L):L=e[31];const W=A?.handle===M.handle;let T,B;e[32]!==z?(T=()=>z("Followers"),B=()=>z("Following"),e[32]=z,e[33]=T,e[34]=B):(T=e[33],B=e[34]);let H;e[35]!==S||e[36]!==A||e[37]!==M||e[38]!==a||e[39]!==W||e[40]!==T||e[41]!==B?(H=(0,t.jsx)(kd,{profile:M,currentUser:A,isCurrentUser:W,onEditProfile:a,showToast:S,onShowFollowers:T,onShowFollowing:B}),e[35]=S,e[36]=A,e[37]=M,e[38]=a,e[39]=W,e[40]=T,e[41]=B,e[42]=H):H=e[42];let te;e[43]===Symbol.for("react.memo_cache_sentinel")?(te=(0,t.jsx)("div",{className:"sticky top-[60px] md:top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-10 border-b border-zinc-100 dark:border-zinc-800",children:(0,t.jsx)(Gt,{className:"w-full h-auto bg-transparent p-0 rounded-none justify-start px-2 overflow-x-auto hide-scrollbar",children:["feed","collections","media"].map(Pd)})}),e[43]=te):te=e[43];let re;e[44]!==E?(re=E(),e[44]=E,e[45]=re):re=e[45];let ie;e[46]!==re?(ie=(0,t.jsx)(ot,{value:"feed",className:"m-0 border-none",children:re}),e[46]=re,e[47]=ie):ie=e[47];let oe;e[48]!==M.id||e[49]!==M.name?(oe=(0,t.jsx)(go,{name:M.name,number:M.id}),e[48]=M.id,e[49]=M.name,e[50]=oe):oe=e[50];let G;e[51]!==E?(G=E(!0),e[51]=E,e[52]=G):G=e[52];let ae;e[53]!==oe||e[54]!==G?(ae=(0,t.jsxs)(ot,{value:"collections",className:"m-0 border-none",children:[oe,G]}),e[53]=oe,e[54]=G,e[55]=ae):ae=e[55];let V;e[56]!==E?(V=E(),e[56]=E,e[57]=V):V=e[57];let J;e[58]!==V?(J=(0,t.jsx)(ot,{value:"media",className:"m-0 border-none",children:V}),e[58]=V,e[59]=J):J=e[59];let K;e[60]!==o||e[61]!==c||e[62]!==ie||e[63]!==ae||e[64]!==J?(K=(0,t.jsxs)(Zt,{value:o,onValueChange:c,className:"w-full",children:[te,ie,ae,J]}),e[60]=o,e[61]=c,e[62]=ie,e[63]=ae,e[64]=J,e[65]=K):K=e[65];let ee;e[66]!==H||e[67]!==K||e[68]!==L?(ee=(0,t.jsxs)("div",{className:"border-y md:border-b-0 border-zinc-100 dark:border-zinc-800",children:[L,H,K]}),e[66]=H,e[67]=K,e[68]=L,e[69]=ee):ee=e[69];let X;e[70]!==x?(X=()=>x(!1),e[70]=x,e[71]=X):X=e[71];let de;e[72]!==b||e[73]!==h||e[74]!==y||e[75]!==j||e[76]!==v||e[77]!==F||e[78]!==z||e[79]!==x?(de=(0,t.jsx)("div",{className:"min-h-[300px]",children:v?(0,t.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,t.jsx)(ce,{className:"animate-spin text-violet-500",size:32})}):b.length>0?(0,t.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800 -mx-6",children:[b.map(me=>(0,t.jsx)(Sa,{profile:me,onUserClick:fe=>{x(!1),F(`/u/${fe}`)}},me.id)),y&&(0,t.jsx)("div",{className:"p-4 flex justify-center",children:(0,t.jsxs)(xe,{variant:"secondary",className:"w-full text-xs",onClick:()=>z(h,!0),disabled:j,children:[j?(0,t.jsx)(ce,{size:14,className:"animate-spin mr-2"}):null,"Load more"]})})]}):(0,t.jsx)("div",{className:"flex flex-col items-center justify-center py-20 text-zinc-500",children:(0,t.jsxs)("p",{className:"font-medium",children:["No ",h.toLowerCase()," yet."]})})}),e[72]=b,e[73]=h,e[74]=y,e[75]=j,e[76]=v,e[77]=F,e[78]=z,e[79]=x,e[80]=de):de=e[80];let Z;e[81]!==h||e[82]!==p||e[83]!==X||e[84]!==de?(Z=(0,t.jsx)(Ke,{isOpen:p,onClose:X,title:h,className:"sm:max-w-md",children:de}),e[81]=h,e[82]=p,e[83]=X,e[84]=de,e[85]=Z):Z=e[85];let ue;return e[86]!==ee||e[87]!==Z?(ue=(0,t.jsxs)("div",{className:"border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen pb-20",children:[ee,Z]}),e[86]=ee,e[87]=Z,e[88]=ue):ue=e[88],ue},Sd=Cd;function Pd(s){return(0,t.jsx)(mt,{value:s,className:"flex-1 py-4 text-sm font-bold capitalize rounded-none border-b-2 data-[state=active]:border-black dark:data-[state=active]:border-white data-[state=active]:text-black dark:data-[state=active]:text-white text-zinc-500 transition-all hover:bg-zinc-50 dark:hover:bg-zinc-900 whitespace-nowrap px-4",children:s==="feed"?"Posts":s},s)}var $d=()=>{const s=je(),e=(0,g.useRef)(null),[a,i]=(0,g.useState)([]),[n,r]=(0,g.useState)(!0),[l,o]=(0,g.useState)(!1),[c,u]=(0,g.useState)(null),[d,m]=(0,g.useState)(!0),[f,p]=(0,g.useState)(!0),x=async(b=null)=>{try{const v=await mr(b);v.length<10&&m(!1),b?i(j=>[...j,...v]):(i(v),v.length>0&&!c&&u(v[0].id))}catch(v){console.error("Error fetching reels:",v)}finally{r(!1),o(!1)}};(0,g.useEffect)(()=>{x()},[]);const h=(0,g.useCallback)(()=>{if(!e.current||l||!d)return;const{scrollTop:b,scrollHeight:v,clientHeight:j}=e.current;if(b+j>=v-800){o(!0);const y=a[a.length-1];x(y?.sort_timestamp||y?.created_at)}},[a,l,d]);return(0,g.useEffect)(()=>{const b=e.current;if(b)return b.addEventListener("scroll",h),()=>b.removeEventListener("scroll",h)},[h]),(0,g.useEffect)(()=>{if(a.length===0)return;const b={root:e.current,threshold:.6},v=y=>{y.forEach(z=>{z.isIntersecting&&u(z.target.dataset.id)})},j=new IntersectionObserver(v,b);return document.querySelectorAll(".reel-item").forEach(y=>j.observe(y)),()=>j.disconnect()},[a]),n?(0,t.jsx)("div",{className:"h-[100dvh] w-full flex items-center justify-center bg-black",children:(0,t.jsx)(ce,{size:40,className:"animate-spin text-white"})}):a.length===0?(0,t.jsxs)("div",{className:"h-[100dvh] w-full flex flex-col items-center justify-center bg-black text-white gap-4",children:[(0,t.jsx)("p",{className:"text-zinc-500",children:"No reels found."}),(0,t.jsx)("button",{onClick:()=>s(-1),className:"px-4 py-2 bg-white text-black rounded-full text-sm font-bold",children:"Go Back"})]}):(0,t.jsxs)("div",{className:"h-[100dvh] w-full bg-black md:rounded-xl relative overflow-hidden",children:[(0,t.jsx)("button",{onClick:()=>s(-1),className:"absolute top-6 left-6 z-50 p-2.5 bg-black/20 hover:bg-black/40 text-white backdrop-blur-md rounded-full transition-all active:scale-90 border border-white/10 shadow-xl",title:"Back",children:(0,t.jsx)(tt,{size:24,strokeWidth:2.5})}),(0,t.jsx)("button",{onClick:()=>p(!f),className:"absolute top-6 right-6 z-50 p-2.5 bg-black/20 hover:bg-black/40 text-white backdrop-blur-md rounded-full transition-all active:scale-90 border border-white/10 shadow-xl",title:f?"Unmute":"Mute",children:f?(0,t.jsx)(Va,{size:24,strokeWidth:2.5}):(0,t.jsx)(Ci,{size:24,strokeWidth:2.5})}),(0,t.jsxs)("div",{ref:e,className:"h-full w-full snap-y snap-mandatory overflow-y-auto no-scrollbar scroll-smooth",children:[a.map(b=>(0,t.jsx)(Lc,{reel:b,isActive:c===b.id,isMuted:f,onToggleMute:()=>p(!f)},b.feed_id||b.id)),l&&(0,t.jsx)("div",{className:"h-screen w-full flex items-center justify-center bg-black snap-start",children:(0,t.jsx)(ce,{size:40,className:"animate-spin text-white"})})]})]})},Ad=$d,Md=()=>{const{currentUser:s,logout:e}=pe(),{darkMode:a,toggleDarkMode:i,fontSize:n,setFontSize:r,dataSaver:l,setDataSaver:o}=pt(),{addToast:c}=ze(),[u,d]=(0,g.useState)(!1),[m,f]=(0,g.useState)({newPassword:"",confirmPassword:""}),[p,x]=(0,g.useState)(!1),h=async()=>{try{await e(),c("Logged out successfully")}catch(_){console.error("Logout error:",_),c("Failed to logout")}},b=async _=>{if(_.preventDefault(),m.newPassword!==m.confirmPassword){c("Passwords do not match","error");return}if(m.newPassword.length<6){c("Password must be at least 6 characters","error");return}x(!0);try{const{error:$}=await q.auth.updateUser({password:m.newPassword});if($)throw $;c("Password updated successfully!"),d(!1),f({newPassword:"",confirmPassword:""})}catch($){console.error("Password update error:",$),c($.message||"Failed to update password","error")}finally{x(!1)}},v=async()=>{if(s?.email){x(!0);try{const{error:_}=await q.auth.resetPasswordForEmail(s.email,{redirectTo:`${window.location.origin}/settings?type=recovery`});if(_)throw _;c("Password reset email sent!")}catch(_){console.error("Reset password error:",_),c(_.message||"Failed to send reset email","error")}finally{x(!1)}}},j=()=>{["seenStories","font-size","data-saver","theme"].forEach(_=>localStorage.removeItem(_)),c("Cache cleared! Reloading..."),setTimeout(()=>window.location.reload(),1500)},y=async()=>{x(!0);try{const _={user:{id:s.id,handle:s.handle,name:s.name,email:s.email},exportDate:new Date().toISOString(),note:"This is a mock export of your Sysm data."},$=new Blob([JSON.stringify(_,null,2)],{type:"application/json"}),A=URL.createObjectURL($),S=document.createElement("a");S.href=A,S.download=`sysm-data-${s.handle}.json`,S.click(),URL.revokeObjectURL(A),c("Data export started!")}catch{c("Failed to export data","error")}finally{x(!1)}},z=()=>{window.confirm("Are you absolutely sure? This will permanently delete your account and all associated data. This action is irreversible.")&&(c("Account deletion request submitted. Logging out..."),setTimeout(h,2e3))},k=()=>{window.prompt("Please describe the bug you found:")&&c("Bug reported! Thank you for your feedback.")};return s?(0,t.jsxs)("div",{className:"flex flex-col min-h-screen bg-white dark:bg-black md:rounded-xl md:border border-zinc-100 dark:border-zinc-800",children:[(0,t.jsx)("div",{className:"sticky top-0 z-10 bg-white/80 dark:bg-black/80 backdrop-blur-md p-4 border-b border-zinc-100 dark:border-zinc-800",children:(0,t.jsx)("h2",{className:"text-xl font-bold dark:text-white",children:"Settings"})}),(0,t.jsxs)("div",{className:"p-4 space-y-6 max-w-2xl mx-auto w-full pb-20 mt-4",children:[(0,t.jsxs)("section",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-sm font-bold text-zinc-500 uppercase tracking-wider px-2",children:"Account Security"}),(0,t.jsxs)("div",{className:"bg-zinc-50 dark:bg-zinc-900 rounded-2xl overflow-hidden divide-y divide-zinc-200 dark:divide-zinc-800",children:[(0,t.jsxs)("button",{onClick:()=>d(!u),className:"w-full px-4 py-4 flex items-center gap-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[(0,t.jsx)(Di,{size:20,className:"text-zinc-500"}),(0,t.jsx)("span",{className:"flex-1 font-medium dark:text-zinc-200",children:"Change Password"}),(0,t.jsx)(Xe,{size:16,className:"text-zinc-400"})]}),u&&(0,t.jsxs)("form",{onSubmit:b,className:"p-4 space-y-3 bg-white dark:bg-black animate-in fade-in slide-in-from-top-2",children:[(0,t.jsx)(Fe,{type:"password",placeholder:"New Password",value:m.newPassword,onChange:_=>f({...m,newPassword:_.target.value})}),(0,t.jsx)(Fe,{type:"password",placeholder:"Confirm Password",value:m.confirmPassword,onChange:_=>f({...m,confirmPassword:_.target.value})}),(0,t.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,t.jsx)(xe,{type:"button",variant:"secondary",onClick:()=>d(!1),children:"Cancel"}),(0,t.jsx)(xe,{type:"submit",disabled:p,children:p?"Saving...":"Update Password"})]})]}),(0,t.jsxs)("button",{onClick:v,className:"w-full px-4 py-4 flex items-center gap-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[(0,t.jsx)(ws,{size:20,className:"text-zinc-500"}),(0,t.jsx)("span",{className:"flex-1 font-medium dark:text-zinc-200",children:"Reset via Email"}),(0,t.jsx)(Xe,{size:16,className:"text-zinc-400"})]})]})]}),(0,t.jsxs)("section",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-sm font-bold text-zinc-500 uppercase tracking-wider px-2",children:"Display & Typography"}),(0,t.jsxs)("div",{className:"bg-zinc-50 dark:bg-zinc-900 rounded-2xl overflow-hidden divide-y divide-zinc-200 dark:divide-zinc-800",children:[(0,t.jsxs)("button",{onClick:i,className:"w-full px-4 py-4 flex items-center gap-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[a?(0,t.jsx)(Bs,{size:20,className:"text-violet-500"}):(0,t.jsx)(Ds,{size:20,className:"text-amber-500"}),(0,t.jsx)("span",{className:"flex-1 font-medium dark:text-zinc-200",children:"Dark Mode"}),(0,t.jsx)("div",{className:`w-10 h-6 rounded-full relative transition-colors ${a?"bg-violet-600":"bg-zinc-300"}`,children:(0,t.jsx)("div",{className:`absolute top-1 size-4 bg-white rounded-full transition-all ${a?"left-5":"left-1"}`})})]}),(0,t.jsxs)("div",{className:"px-4 py-4 flex items-center justify-between gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(wi,{size:20,className:"text-zinc-500"}),(0,t.jsx)("span",{className:"font-medium dark:text-zinc-200",children:"Font Size"})]}),(0,t.jsxs)(lo,{value:n,onValueChange:r,children:[(0,t.jsx)($a,{className:"w-[140px] bg-zinc-100 dark:bg-zinc-800 border-none font-bold text-violet-600 dark:text-violet-400 capitalize transition-all hover:bg-zinc-200 dark:hover:bg-zinc-700",children:(0,t.jsx)(oo,{placeholder:"Select"})}),(0,t.jsxs)(Fa,{className:"bg-white dark:bg-zinc-900 border-zinc-100 dark:border-zinc-800 shadow-2xl rounded-xl p-1",children:[(0,t.jsx)(jt,{value:"small",className:"py-2.5 rounded-lg focus:bg-zinc-50 dark:focus:bg-zinc-800 focus:text-violet-600 font-medium cursor-pointer",children:"Small"}),(0,t.jsx)(jt,{value:"base",className:"py-2.5 rounded-lg focus:bg-zinc-50 dark:focus:bg-zinc-800 focus:text-violet-600 font-medium cursor-pointer",children:"Default"}),(0,t.jsx)(jt,{value:"large",className:"py-2.5 rounded-lg focus:bg-zinc-50 dark:focus:bg-zinc-800 focus:text-violet-600 font-medium cursor-pointer",children:"Large"})]})]})]})]})]}),(0,t.jsxs)("section",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-sm font-bold text-zinc-500 uppercase tracking-wider px-2",children:"Data & Storage"}),(0,t.jsxs)("div",{className:"bg-zinc-50 dark:bg-zinc-900 rounded-2xl overflow-hidden divide-y divide-zinc-200 dark:divide-zinc-800",children:[(0,t.jsxs)("button",{onClick:()=>o(!l),className:"w-full px-4 py-4 flex items-center gap-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[(0,t.jsx)(Ms,{size:20,className:"text-zinc-500"}),(0,t.jsx)("span",{className:"flex-1 font-medium dark:text-zinc-200",children:"Data Saver"}),(0,t.jsx)("div",{className:`w-10 h-6 rounded-full relative transition-colors ${l?"bg-emerald-600":"bg-zinc-300"}`,children:(0,t.jsx)("div",{className:`absolute top-1 size-4 bg-white rounded-full transition-all ${l?"left-5":"left-1"}`})})]}),(0,t.jsxs)("button",{onClick:j,className:"w-full px-4 py-4 flex items-center gap-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[(0,t.jsx)(It,{size:20,className:"text-zinc-500"}),(0,t.jsx)("span",{className:"flex-1 font-medium dark:text-zinc-200",children:"Clear Local Cache"}),(0,t.jsx)(Xe,{size:16,className:"text-zinc-400"})]}),(0,t.jsxs)("button",{onClick:y,className:"w-full px-4 py-4 flex items-center gap-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[(0,t.jsx)(Tt,{size:20,className:"text-zinc-500"}),(0,t.jsx)("span",{className:"flex-1 font-medium dark:text-zinc-200",children:"Download My Data (Export)"}),(0,t.jsx)(Xe,{size:16,className:"text-zinc-400"})]})]})]}),(0,t.jsxs)("section",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-sm font-bold text-zinc-500 uppercase tracking-wider px-2",children:"Support"}),(0,t.jsxs)("div",{className:"bg-zinc-50 dark:bg-zinc-900 rounded-2xl overflow-hidden divide-y divide-zinc-200 dark:divide-zinc-800",children:[(0,t.jsxs)("button",{onClick:k,className:"w-full px-4 py-4 flex items-center gap-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[(0,t.jsx)(_t,{size:20,className:"text-zinc-500"}),(0,t.jsx)("span",{className:"flex-1 font-medium dark:text-zinc-200",children:"Report a Bug"}),(0,t.jsx)(Xe,{size:16,className:"text-zinc-400"})]}),(0,t.jsxs)("div",{className:"px-4 py-4 flex items-center gap-3",children:[(0,t.jsx)(Tt,{size:20,className:"text-zinc-500"}),(0,t.jsx)("span",{className:"flex-1 font-medium dark:text-zinc-200",children:"Version"}),(0,t.jsx)("span",{className:"text-zinc-500",children:"1.0.0 (Beta)"})]})]})]}),(0,t.jsx)("section",{className:"space-y-4 pt-4",children:(0,t.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,t.jsxs)("button",{onClick:h,className:"w-full bg-zinc-100 dark:bg-zinc-900 text-zinc-900 dark:text-zinc-100 p-4 rounded-2xl font-bold flex items-center justify-center gap-2 hover:bg-zinc-200 dark:hover:bg-zinc-800 transition-colors shadow-sm",children:[(0,t.jsx)(Sn,{size:20}),"Log Out"]}),(0,t.jsxs)("button",{onClick:z,className:"w-full bg-rose-50 dark:bg-rose-900/10 text-rose-600 dark:text-rose-500 p-4 rounded-2xl font-bold flex items-center justify-center gap-2 border border-rose-100 dark:border-rose-900/20 hover:bg-rose-100 dark:hover:bg-rose-900/40 transition-colors",children:[(0,t.jsx)(It,{size:20}),"Delete Account Permanently"]})]})}),(0,t.jsx)("div",{className:"text-center text-xs text-zinc-400 py-4 pb-10",children:"Sysm  2026. Decentralized & Open Source."})]})]}):(0,t.jsx)("div",{className:"flex flex-col items-center justify-center p-10 text-center",children:(0,t.jsx)("p",{className:"text-zinc-500",children:"Please login to view settings."})})},Fd=Md,Ed=()=>{const{tag:s}=ut(),e=je(),{currentUser:a}=pe(),{addToast:i}=ze(),[n,r]=(0,g.useState)([]),[l,o]=(0,g.useState)(!0),[c,u]=(0,g.useState)(!1),[d,m]=(0,g.useState)(!0);(0,g.useEffect)(()=>{s&&(async()=>{o(!0);try{const x=await Ot(`#${s}`,null,10);r(x),m(x.length>=10)}catch(x){console.error("Failed to load hashtag posts:",x),i("Failed to load posts","error")}finally{o(!1)}})()},[s,i]);const f=async()=>{if(!(c||!d)){u(!0);try{const p=n[n.length-1],x=p?p.sortTimestamp:null,h=await Ot(`#${s}`,x,10);h.length<10&&m(!1),r(b=>[...b,...h])}catch(p){console.error("Failed to load more posts:",p)}finally{u(!1)}}};return(0,t.jsx)("div",{className:"border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen pb-20",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,t.jsx)("button",{onClick:()=>e(-1),className:"p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:(0,t.jsx)(tt,{size:22})}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsxs)("h5",{className:"text-lg font-bold dark:text-white leading-none",children:["#",s]}),(0,t.jsx)("span",{className:"text-xs text-zinc-500 mt-0.5",children:"Hashtag"})]})]})}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"h-32 sm:h-40 bg-gradient-to-r from-violet-500/10 to-fuchsia-500/10 overflow-hidden relative",children:(0,t.jsx)("div",{className:"absolute inset-0 bg-grid-white/[0.02] bg-[size:20px_20px]"})}),(0,t.jsxs)("div",{className:"px-4 pb-6",children:[(0,t.jsx)("div",{className:"flex justify-between items-end -mt-10 mb-4 relative z-10",children:(0,t.jsx)("div",{className:"size-20 sm:size-24 rounded-2xl border-4 border-white dark:border-black bg-zinc-100 dark:bg-zinc-800 flex items-center justify-center shadow-xl",children:(0,t.jsx)(wt,{size:40,className:"text-zinc-400"})})}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("h1",{className:"text-2xl sm:text-3xl font-black dark:text-white tracking-tight leading-tight",children:["#",s]}),(0,t.jsxs)("p",{className:"text-zinc-500 text-sm sm:text-base",children:["Posts tagged with #",s]})]})]})]}),(0,t.jsx)("div",{className:"border-t border-zinc-100 dark:border-zinc-800",children:l?(0,t.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,t.jsx)(ce,{className:"animate-spin text-violet-500",size:32})}):n.length>0?(0,t.jsxs)(t.Fragment,{children:[n.map(p=>(0,t.jsx)(at,{currentUser:a,showToast:i,...p,onClick:()=>e(`/post/${p.id}`),onUserClick:x=>e(`/u/${x}`)},p.feed_id||p.id)),d&&(0,t.jsx)("div",{className:"p-6 flex justify-center",children:(0,t.jsxs)(xe,{variant:"secondary",className:"w-full max-w-xs",onClick:f,disabled:c,children:[c&&(0,t.jsx)(ce,{size:18,className:"animate-spin mr-2"}),"Load more"]})})]}):(0,t.jsxs)("div",{className:"p-20 text-center text-zinc-500 flex flex-col items-center gap-4",children:[(0,t.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full mb-2",children:(0,t.jsx)(wt,{size:40,className:"text-zinc-300"})}),(0,t.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"No posts found"}),(0,t.jsxs)("p",{className:"text-sm max-w-[250px]",children:["Be the first to post with #",s,"!"]})]})})]})})},Rd=Ed,Id=Q();function Ld(){const s=(0,Id.c)(54),e=ft(),{currentUser:a,authMode:i,setAuthMode:n}=pe(),{darkMode:r}=pt(),{isOpen:l,images:o,currentIndex:c,closeLightbox:u,setIndex:d}=Jt(),[m,f]=(0,g.useState)(!1),[p,x]=(0,g.useState)(!1),[h,b]=(0,g.useState)(!1);let v;s[0]===Symbol.for("react.memo_cache_sentinel")?(v={},s[0]=v):v=s[0];const[j,y]=(0,g.useState)(v),[z,k]=(0,g.useState)(null),[_,$]=(0,g.useState)(null);if(i){const G=r?"dark":"";let ae;s[1]!==n?(ae=()=>n(null),s[1]=n,s[2]=ae):ae=s[2];let V;s[3]!==i||s[4]!==n?(V=()=>n(i==="login"?"signup":"login"),s[3]=i,s[4]=n,s[5]=V):V=s[5];let J;s[6]!==i||s[7]!==ae||s[8]!==V?(J=(0,t.jsx)("div",{className:"min-h-screen bg-white dark:bg-black flex items-center justify-center p-4",children:(0,t.jsx)(Ce,{children:(0,t.jsx)(Go,{type:i,onComplete:ae,onSwitch:V})})}),s[6]=i,s[7]=ae,s[8]=V,s[9]=J):J=s[9];let K;return s[10]!==G||s[11]!==J?(K=(0,t.jsx)("div",{className:G,children:J}),s[10]=G,s[11]=J,s[12]=K):K=s[12],K}let A;s[13]===Symbol.for("react.memo_cache_sentinel")?(A=(0,t.jsx)(Vn,{}),s[13]=A):A=s[13];let S;s[14]===Symbol.for("react.memo_cache_sentinel")?(S=(0,t.jsx)(hl,{onPostClick:()=>f(!0)}),s[14]=S):S=s[14];let F;s[15]===Symbol.for("react.memo_cache_sentinel")?(F=(0,t.jsx)(ke,{path:"/",element:(0,t.jsx)(Ce,{children:(0,t.jsx)(Zc,{onStoryClick:$,onAddStory:()=>b(!0)})})}),s[15]=F):F=s[15];let M;s[16]===Symbol.for("react.memo_cache_sentinel")?(M=(0,t.jsx)(ke,{path:"/home",element:(0,t.jsx)(as,{to:"/",replace:!0})}),s[16]=M):M=s[16];let R;s[17]===Symbol.for("react.memo_cache_sentinel")?(R=(0,t.jsx)(ke,{path:"/community",element:(0,t.jsx)(Ce,{children:(0,t.jsx)(Jc,{})})}),s[17]=R):R=s[17];let E;s[18]===Symbol.for("react.memo_cache_sentinel")?(E=(0,t.jsx)(ke,{path:"/reels",element:(0,t.jsx)(Ce,{children:(0,t.jsx)(Ad,{})})}),s[18]=E):E=s[18];let I;s[19]===Symbol.for("react.memo_cache_sentinel")?(I=(0,t.jsx)(ke,{path:"/messages",element:(0,t.jsx)(Ce,{children:(0,t.jsx)(vs,{})})}),s[19]=I):I=s[19];let O;s[20]===Symbol.for("react.memo_cache_sentinel")?(O=(0,t.jsx)(ke,{path:"/settings",element:(0,t.jsx)(Ce,{children:(0,t.jsx)(Fd,{})})}),s[20]=O):O=s[20];let D;s[21]===Symbol.for("react.memo_cache_sentinel")?(D=(0,t.jsx)(ke,{path:"/messages/:id",element:(0,t.jsx)(Ce,{children:(0,t.jsx)(vs,{})})}),s[21]=D):D=s[21];let P;s[22]===Symbol.for("react.memo_cache_sentinel")?(P=(0,t.jsx)(ke,{path:"/notifications",element:(0,t.jsx)(Ce,{children:(0,t.jsx)(jd,{})})}),s[22]=P):P=s[22];let C;s[23]===Symbol.for("react.memo_cache_sentinel")?(C=(0,t.jsx)(ke,{path:"/post/:id",element:(0,t.jsx)(Ce,{children:(0,t.jsx)(zd,{})})}),s[23]=C):C=s[23];let w;s[24]===Symbol.for("react.memo_cache_sentinel")?(w=(0,t.jsx)(ke,{path:"/c/:handle",element:(0,t.jsx)(Ce,{children:(0,t.jsx)(Wc,{onPostInCommunity:G=>{k(G),f(!0)}})})}),s[24]=w):w=s[24];let N;s[25]===Symbol.for("react.memo_cache_sentinel")?(N=(0,t.jsx)(ke,{path:"/tags/:tag",element:(0,t.jsx)(Ce,{children:(0,t.jsx)(Rd,{})})}),s[25]=N):N=s[25];let L;s[26]===Symbol.for("react.memo_cache_sentinel")?(L=(0,t.jsx)(ke,{path:"/u/:handle",element:(0,t.jsx)(Ce,{children:(0,t.jsx)(Sd,{onEditProfile:G=>{y(G),x(!0)}})})}),s[26]=L):L=s[26];let W;s[27]===Symbol.for("react.memo_cache_sentinel")?(W=(0,t.jsxs)(ke,{element:S,children:[F,M,R,E,I,O,D,P,C,w,N,L,(0,t.jsx)(ke,{path:"*",element:(0,t.jsx)(as,{to:"/community"})})]}),s[27]=W):W=s[27];let T;s[28]!==e?(T=(0,t.jsx)(ui,{location:e,children:W},e.pathname),s[28]=e,s[29]=T):T=s[29];let B;s[30]===Symbol.for("react.memo_cache_sentinel")?(B=G=>{f(G),G||k(null)},s[30]=B):B=s[30];let H;s[31]!==j||s[32]!==p||s[33]!==m||s[34]!==h||s[35]!==z?(H=(0,t.jsx)(Bo,{isPostModalOpen:m,setIsPostModalOpen:B,isEditProfileOpen:p,setIsEditProfileOpen:x,isStoryModalOpen:h,setIsStoryModalOpen:b,editProfileData:j,setEditProfileData:y,postCommunity:z}),s[31]=j,s[32]=p,s[33]=m,s[34]=h,s[35]=z,s[36]=H):H=s[36];let te;s[37]!==_?(te=_&&(0,t.jsx)(Qo,{story:_,onClose:G=>{if(G){const ae=JSON.parse(localStorage.getItem("seenStories")||"[]");ae.includes(G)||localStorage.setItem("seenStories",JSON.stringify([...ae,G]))}$(null)}}),s[37]=_,s[38]=te):te=s[38];let re;s[39]!==u||s[40]!==c||s[41]!==o||s[42]!==l||s[43]!==d?(re=l&&(0,t.jsx)(Jl,{images:o,currentIndex:c,onClose:u,onNavigate:d}),s[39]=u,s[40]=c,s[41]=o,s[42]=l,s[43]=d,s[44]=re):re=s[44];let ie;s[45]!==a||s[46]!==e.pathname?(ie=a&&e.pathname==="/"&&(0,t.jsx)("button",{onClick:()=>f(!0),className:"fixed bottom-20 right-5 md:hidden z-50 bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 size-12 rounded-full flex items-center justify-center shadow-2xl hover:scale-110 active:scale-90 transition-all cursor-pointer group",title:"Create Post",children:(0,t.jsx)(We,{size:28,className:"group-hover:rotate-90 transition-transform duration-300"})}),s[45]=a,s[46]=e.pathname,s[47]=ie):ie=s[47];let oe;return s[48]!==T||s[49]!==H||s[50]!==te||s[51]!==re||s[52]!==ie?(oe=(0,t.jsxs)(sl,{children:[A,T,H,te,re,ie]}),s[48]=T,s[49]=H,s[50]=te,s[51]=re,s[52]=ie,s[53]=oe):oe=s[53],oe}var Td=new An;(0,qn.createRoot)(document.getElementById("root")).render((0,t.jsx)(g.StrictMode,{children:(0,t.jsx)(Gi,{client:Td,children:(0,t.jsx)(Ya,{children:(0,t.jsx)(Wr,{children:(0,t.jsx)(Tr,{children:(0,t.jsx)(Or,{children:(0,t.jsx)(Xr,{children:(0,t.jsx)(Kr,{children:(0,t.jsx)(Gr,{children:(0,t.jsx)(Ld,{})})})})})})})})})}));
