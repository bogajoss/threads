import{n as as}from"./rolldown-runtime-2JzG8er9.js";import{$ as sa,$t as At,A as aa,At as is,B as ia,Bn as xt,Bt as ns,C as na,Ct as ra,D as la,Dt as rs,E as oa,Et as kt,F as ca,Fn as da,Ft as at,G as ma,Gt as ua,H as fa,Hn as xa,Ht as _t,I as ha,In as ye,It as mt,J as pa,Jt as ls,K as ba,Kt as os,L as ga,Ln as va,Lt as ja,M as ya,Mn as wa,Mt as Na,N as za,Nn as cs,Nt as ds,O as ka,Ot as ht,P as _a,Pn as Dt,Pt as $t,Q as Ca,Qt as Sa,R as $a,Rn as nt,Rt as ut,S as Pa,St as Ma,T as Fa,Tt as La,U as Ra,Ut as Ia,V as Ea,Vn as qa,Vt as Ta,W as Oa,Wt as ms,X as Aa,Xt as Da,Y as Ba,Yt as us,Z as Wa,Zt as Ua,_ as Ha,_t as Qa,a as Ja,an as jt,at as fs,b as Je,bt as xs,c as Va,cn as Pe,ct as Ka,d as Xa,dn as Ya,dt as hs,en as Pt,et as Ga,f as Za,ft as ei,g as ti,gt as si,h as ai,ht as ps,i as ii,in as ni,it as ri,j as li,jn as oi,jt as ci,k as di,kt as me,l as mi,ln as ui,lt as bs,m as fi,mt as xi,n as gs,nn as yt,nt as Ge,o as hi,on as Q,ot as pi,p as bi,pt as gi,q as vi,qt as vs,r as js,rn as Ze,rt as Ct,s as ji,sn as ys,st as yi,t as wi,tn as Ni,tt as _e,u as zi,un as pt,ut as ki,v as _i,vt as wt,w as Ci,wt as Si,x as $i,xt as ws,y as Pi,yt as Oe,z as Mi,zn as je,zt as Fi}from"./framework-CiY-3HUO.js";import{t as Li}from"./query-cqZeg6lj.js";import{t as Ri}from"./database-DCcU4ujN.js";import{n as Ii,r as Ei,t as qi}from"./vendor-DyYlx6SC.js";/* empty css                 */(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function a(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=a(n);fetch(n.href,r)}})();var Ti=qa(),g=as(xa(),1),Oi="https://dbkcedktqhueqnulnosq.supabase.co",Ai="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRia2NlZGt0cWh1ZXFudWxub3NxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg5NzE1NTQsImV4cCI6MjA4NDU0NzU1NH0.m_Tv-H7o5mL1Nac6TH-S1JkS1x7ZN1AK_4Mt1hZlkvU";const O=Ri(Oi,Ai),Ue=t=>t?{id:t.id,handle:t.username,name:t.display_name,avatar:t.avatar_url||"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm",cover:t.cover_url||"https://systemadminbd.com/uploads/675346dd55e0c7.43939630.png",verified:t.is_verified,bio:t.bio,location:t.location,website:t.website,follower_count:t.follower_count||0,following_count:t.following_count||0,lastSeen:t.last_seen_at}:null,rt=t=>{if(!t)return null;const e=t.reposter_id||t.reposter_data?.id||t.reposted_by?.id,a=t.feed_id||(e?`${t.id}-${e}`:`${t.id}-orig`);return{...t,feed_id:a,stats:{comments:t.comments_count||0,likes:t.likes_count||0,mirrors:t.mirrors_count||0},user:Ue(t.author_data||t.user),community:t.community_data||t.communities?{...t.community_data||t.communities,avatar:(t.community_data||t.communities).avatar_url||(t.community_data||t.communities).avatar}:null,repostedBy:t.reposter_data?{handle:t.reposter_data.username,name:t.reposter_data.display_name,id:t.reposter_data.id}:t.reposted_by?{handle:t.reposted_by.username,name:t.reposted_by.display_name,id:t.reposted_by.id}:null,timeAgo:new Date(t.created_at).toLocaleDateString()}},Ns=t=>t?{...t,stats:{likes:t.likes_count||0},user:Ue(t.user),timeAgo:new Date(t.created_at).toLocaleDateString()}:null,Di=t=>t?{...t,user:t.actor?.username,avatar:t.actor?.avatar_url||"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm"}:null,zs=t=>t?{...t,media:t.media_url,user:Ue(t.user)}:null,Bi=async(t,e=10)=>{const{data:a,error:i}=await O.from("users").select("*").or(`username.ilike.%${t}%,display_name.ilike.%${t}%`).limit(e);if(i)throw i;return a.map(Ue)},ks=async(t,e="id")=>{const{data:a,error:i}=await O.from("users").select("*").eq(e==="id"?"id":"username",t).maybeSingle();if(i)throw i;return a?Ue(a):null},Wi=t=>ks(t,"username"),Ve=async t=>{if(!t)return;const{error:e}=await O.from("users").update({last_seen_at:new Date().toISOString()}).eq("id",t);e&&console.error("Error updating last seen:",e)},Ui=async(t,e)=>{const a={display_name:e.name,username:e.handle,avatar_url:e.avatar,bio:e.bio,cover_url:e.cover,website:e.website,location:e.location};Object.keys(a).forEach(n=>a[n]===void 0&&delete a[n]);const{error:i}=await O.from("users").update(a).eq("id",t);if(i)throw i},Hi=async(t,e)=>{const{data:a}=await O.from("follows").select("*").eq("follower_id",t).eq("following_id",e).maybeSingle();return a?(await O.from("follows").delete().eq("follower_id",t).eq("following_id",e),!1):(await O.from("follows").insert([{follower_id:t,following_id:e}]),!0)},Qi=async(t,e)=>{if(!t)return!1;const{data:a}=await O.from("follows").select("*").eq("follower_id",t).eq("following_id",e).maybeSingle();return!!a},Ji=async(t,e=null,a=10)=>{let i=O.from("follows").select(`
      created_at,
      user:users!follower_id (
        id,
        username,
        display_name,
        avatar_url,
        is_verified,
        bio
      )
    `).eq("following_id",t).order("created_at",{ascending:!1}).limit(a);e&&(i=i.lt("created_at",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(l=>({...Ue(l.user),followed_at:l.created_at}))},Vi=async(t,e=null,a=10)=>{let i=O.from("follows").select(`
      created_at,
      user:users!following_id (
        id,
        username,
        display_name,
        avatar_url,
        is_verified,
        bio
      )
    `).eq("follower_id",t).order("created_at",{ascending:!1}).limit(a);e&&(i=i.lt("created_at",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(l=>({...Ue(l.user),followed_at:l.created_at}))},Ki=async t=>{const{data:e,error:a}=await O.from("users").select("follower_count, following_count").eq("id",t).maybeSingle();return a||!e?{followers:0,following:0}:{followers:e.follower_count||0,following:e.following_count||0}},Xi=async(t=null,e=10)=>{let a=O.from("unified_posts").select("*").order("sort_timestamp",{ascending:!1}).limit(e);t&&(a=a.lt("sort_timestamp",t));const{data:i,error:n}=await a;if(n)throw n;return i.map(rt)},Yi=async t=>{const{data:e,error:a}=await O.from("posts").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified,
                bio,
                location,
                website,
                follower_count,
                following_count
            ),
            communities (
                id,
                handle,
                name,
                avatar_url
            ),
            quoted_post:posts!quoted_post_id (
                *,
                user:users!user_id (
                    id,
                    username,
                    display_name,
                    avatar_url,
                    is_verified
                )
            )
        `).eq("id",t).single();if(a)throw a;return rt(e)},Gi=async(t,e=null,a=10)=>{let i=O.from("unified_posts").select("*").or(`user_id.eq.${t},reposter_id.eq.${t}`).order("sort_timestamp",{ascending:!1}).limit(a);e&&(i=i.lt("sort_timestamp",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(rt)},Zi=async({content:t,media:e=[],type:a="text",userId:i,poll:n=null,parentId:r=null,communityId:l=null})=>{const{data:o,error:c}=await O.from("posts").insert([{user_id:i,content:t,media:e,type:a,poll:n,parent_id:r,community_id:l}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            ),
            communities:community_id (
                id,
                handle,
                name,
                avatar_url
            )
        `);if(c)throw c;return rt(o[0])},en=async t=>{const{error:e}=await O.from("posts").delete().eq("id",t);if(e)throw e},tn=async(t,e)=>{const{error:a}=await O.from("posts").update(e).eq("id",t);if(a)throw a},sn=async(t,e=null,a=10)=>{let i=O.from("comments").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `).eq("post_id",t).order("created_at",{ascending:!0}).limit(a);e&&(i=i.gt("created_at",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(Ns)},an=async(t,e,a,i=[])=>{const{data:n,error:r}=await O.from("comments").insert([{post_id:t,user_id:e,content:a,media:i}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `);if(r)throw r;return Ns(n[0])},nn=async(t,e)=>{const{data:a}=await O.from("likes").select("*").eq("post_id",t).eq("user_id",e).maybeSingle();return a?(await O.from("likes").delete().eq("post_id",t).eq("user_id",e),!1):(await O.from("likes").insert([{post_id:t,user_id:e}]),!0)},rn=async(t,e)=>{if(!e)return!1;const{data:a}=await O.from("likes").select("*").eq("post_id",t).eq("user_id",e).maybeSingle();return!!a},ln=async(t,e)=>{const{data:a}=await O.from("reposts").select("*").eq("post_id",t).eq("user_id",e).maybeSingle();return a?(await O.from("reposts").delete().eq("post_id",t).eq("user_id",e),!1):(await O.from("reposts").insert([{post_id:t,user_id:e}]),!0)},on=async(t,e)=>{if(!e)return!1;const{data:a}=await O.from("reposts").select("*").eq("post_id",t).eq("user_id",e).maybeSingle();return!!a},_s=async(t,e)=>{const{data:a}=await O.from("conversation_participants").select("conversation_id").eq("user_id",t),i=a.map(o=>o.conversation_id),{data:n}=await O.from("conversation_participants").select("conversation_id").eq("user_id",e).in("conversation_id",i).maybeSingle();if(n)return n.conversation_id;const{data:r,error:l}=await O.from("conversations").insert([{}]).select().single();if(l)throw l;return await O.from("conversation_participants").insert([{conversation_id:r.id,user_id:t},{conversation_id:r.id,user_id:e}]),r.id},cn=async t=>{if(!t)return 0;const{data:e}=await O.from("conversation_participants").select("conversation_id").eq("user_id",t),a=e?.map(r=>r.conversation_id)||[];if(a.length===0)return 0;const{count:i,error:n}=await O.from("messages").select("*",{count:"exact",head:!0}).eq("is_read",!1).neq("sender_id",t).in("conversation_id",a);if(n)throw n;return i||0},dn=async(t,e)=>{if(!t||!e)return;const{error:a}=await O.from("messages").update({is_read:!0}).eq("conversation_id",t).neq("sender_id",e).eq("is_read",!1);if(a)throw a},mn=async t=>{if(!t)return[];const{data:e,error:a}=await O.from("conversation_participants").select(`
            conversation:conversations (
                id,
                last_message_at,
                last_message_content,
                participants:conversation_participants (
                    user:users (
                        id,
                        username,
                        display_name,
                        avatar_url
                    )
                ),
                messages (
                    id,
                    is_read,
                    sender_id
                )
            )
        `).eq("user_id",t);if(a)throw a;return e.map(i=>{const n=i.conversation,r=n.participants.find(o=>o.user?.id!==t)||n.participants[0],l=n.messages?.filter(o=>!o.is_read&&o.sender_id!==t).length||0;return{id:n.id,user:Ue(r?.user),lastMessage:n.last_message_content||"No messages yet",time:n.last_message_at?new Date(n.last_message_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",unread:l}})},un=async t=>{const{data:e,error:a}=await O.from("messages").select("*").eq("conversation_id",t).order("created_at",{ascending:!0});if(a)throw a;return e},fn=async()=>{const{data:t,error:e}=await O.from("message_reactions").select("*");if(e)throw e;return t||[]},xn=async(t,e,a)=>{const{data:i}=await O.from("message_reactions").select("*").eq("message_id",t).eq("user_id",e).maybeSingle();return i?i.emoji===a?(await O.from("message_reactions").delete().eq("id",i.id),{action:"removed",emoji:a}):(await O.from("message_reactions").update({emoji:a}).eq("id",i.id),{action:"updated",emoji:a}):(await O.from("message_reactions").insert([{message_id:t,user_id:e,emoji:a}]),{action:"added",emoji:a})},hn=async(t,e,a,i="text",n=[],r=null)=>{const{data:l,error:o}=await O.from("messages").insert([{conversation_id:t,sender_id:e,content:a,type:i,media:n,reply_to_id:r}]).select();if(o)throw o;return l[0]},pn=async t=>{const{error:e}=await O.from("messages").delete().eq("id",t);if(e)throw e},bn=async(t,e=null,a=10)=>{if(!t)return[];let i=O.from("notifications").select(`
            *,
            actor:users!actor_id (
                username,
                avatar_url
            )
        `).eq("recipient_id",t).order("created_at",{ascending:!1}).limit(a);e&&(i=i.lt("created_at",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(Di)},gn=async t=>{const{error:e}=await O.from("notifications").update({is_read:!0}).eq("recipient_id",t).eq("is_read",!1);if(e)throw e},vn=async t=>{if(!t)return 0;const{count:e,error:a}=await O.from("notifications").select("*",{count:"exact",head:!0}).eq("recipient_id",t).eq("is_read",!1);if(a)throw a;return e||0},jn=async()=>{const{data:t,error:e}=await O.from("stories").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `).gt("expires_at",new Date().toISOString()).order("created_at",{ascending:!1});if(e)throw e;return t.map(zs)},yn=async(t,e,a="image")=>{const{data:i,error:n}=await O.from("stories").insert([{user_id:t,media_url:e,type:a}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `);if(n)throw n;return zs(i[0])},lt=t=>t?{id:t.id,handle:t.handle,name:t.name,description:t.description,avatar:t.avatar_url||"https://api.dicebear.com/7.x/identicon/svg?seed=community",cover:t.cover_url||"https://systemadminbd.com/uploads/675346dd55e0c7.43939630.png",membersCount:t.members_count||0,postsCount:t.posts_count||0,isPrivate:t.is_private,createdAt:t.created_at,type:"community",creatorId:t.creator_id}:null,wn=async(t=null,e=10)=>{let a=O.from("communities").select("*").order("created_at",{ascending:!1}).limit(e);t&&(a=a.lt("created_at",t));const{data:i,error:n}=await a;if(n)throw n;return i.map(lt)},Nn=async t=>{const{data:e,error:a}=await O.from("communities").select("*").eq("handle",t).single();if(a)throw a;return lt(e)},zn=async(t,e=null,a=10)=>{let i=O.from("unified_posts").select("*").eq("community_id",t).is("reposter_id",null).order("sort_timestamp",{ascending:!1}).limit(a);e&&(i=i.lt("sort_timestamp",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(rt)},Cs=async(t,e)=>{const{data:a}=await O.from("community_members").select("*").eq("community_id",t).eq("user_id",e).maybeSingle();if(a){const{error:i}=await O.from("community_members").delete().eq("community_id",t).eq("user_id",e);if(i)throw i;return!1}else{const{error:i}=await O.from("community_members").insert([{community_id:t,user_id:e}]);if(i)throw i;return!0}},Ss=async(t,e)=>{if(!e)return null;const{data:a}=await O.from("community_members").select("*").eq("community_id",t).eq("user_id",e).maybeSingle();return a},kn=async t=>{if(!t)return[];const{data:e,error:a}=await O.from("community_members").select(`
      role,
      communities (*)
    `).eq("user_id",t);if(a)throw a;return e.map(i=>({...lt(i.communities),myRole:i.role}))},_n=async t=>{const{data:e,error:a}=await O.from("communities").insert([t]).select().single();if(a)throw a;return lt(e)},Cn=async(t,e)=>{const{data:a,error:i}=await O.from("communities").update(e).eq("id",t).select().single();if(i)throw i;return lt(a)},Sn=async(t,e="")=>{let a=O.from("community_members").select(`
      role,
      user_id,
      users:user_id!inner (
        id,
        username,
        display_name,
        avatar_url,
        is_verified
      )
    `).eq("community_id",t);e&&(a=a.or(`username.ilike.%${e}%,display_name.ilike.%${e}%`,{foreignTable:"users"}));const{data:i,error:n}=await a.limit(20);if(n)throw n;return i.map(r=>({role:r.role,userId:r.user_id,user:r.users}))},$n=async(t,e,a)=>{const{data:i,error:n}=await O.from("community_members").update({role:a}).eq("community_id",t).eq("user_id",e).select().single();if(n)throw n;return i},Pn=async(t=5)=>{const{data:e,error:a}=await O.from("hashtags").select("*").order("usage_count",{ascending:!1}).limit(t);if(a)throw a;return e},Mn=async t=>{try{const e=`https://api.allorigins.win/raw?url=${encodeURIComponent(t)}`,a=await fetch(e);if(!a.ok)throw new Error("Failed to fetch preview");const i=await a.text(),n=new DOMParser().parseFromString(i,"text/html"),r=l=>n.querySelector(`meta[property="${l}"]`)?.getAttribute("content")||n.querySelector(`meta[name="${l}"]`)?.getAttribute("content");return{title:r("og:title")||n.title||t,description:r("og:description")||r("description")||"",image:r("og:image")||r("twitter:image")||"",siteName:r("og:site_name")||new URL(t).hostname,url:t}}catch(e){return console.error("Link preview error:",e),null}},Fn=async t=>{if(!t)return null;try{const{data:e}=await O.from("link_previews").select("*").eq("url",t).maybeSingle();if(e)return O.from("link_previews").update({last_used_at:new Date().toISOString()}).eq("url",t).then(()=>{}),{title:e.title,description:e.description,image:e.image,siteName:e.site_name,url:e.url};const a=await Mn(t);return a?(O.from("link_previews").insert([{url:a.url,title:a.title,description:a.description,image:a.image,site_name:a.siteName}]).then(({error:i})=>{i&&console.error("Cache save error:",i)}),a):null}catch(e){return console.error("Link preview cache error:",e),null}},Ln=async(t,e={})=>{if(!t.type.startsWith("image/"))return t;const a={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0,initialQuality:.8,fileType:"image/webp",...e};try{const i=await Ei(t,a);return console.log(`Original size: ${(t.size/1024/1024).toFixed(2)} MB`),console.log(`Compressed size: ${(i.size/1024/1024).toFixed(2)} MB`),i}catch(i){return console.error("Image compression failed:",i),t}},Rn=(t,e=1)=>new Promise((a,i)=>{const n=document.createElement("video");n.preload="metadata",n.src=URL.createObjectURL(t),n.muted=!0,n.playsInline=!0,n.onloadedmetadata=()=>{n.currentTime=e},n.onseeked=()=>{const r=document.createElement("canvas");r.width=n.videoWidth,r.height=n.videoHeight,r.getContext("2d").drawImage(n,0,0,r.width,r.height),r.toBlob(l=>{const o=new File([l],"thumbnail.webp",{type:"image/webp"});URL.revokeObjectURL(n.src),a(o)},"image/webp",.7)},n.onerror=r=>i(r)}),Me=async(t,e="media",a=null)=>{let i=t,n=t.name.split(".").pop(),r=null;if(t.type.startsWith("image/")&&(i=await Ln(t),n="webp"),t.type.startsWith("video/"))try{a?r=(await Me(a,e)).url:r=(await Me(await Rn(t),e)).url}catch(d){console.error("Failed to handle video poster:",d)}const l=`${`${crypto.randomUUID()}.${n}`}`,{data:o,error:c}=await O.storage.from(e).upload(l,i);if(c)throw c;const{data:{publicUrl:m}}=O.storage.from(e).getPublicUrl(o.path);return{url:m,poster:r,name:t.name,type:t.type.startsWith("image/")?"image":t.type.startsWith("video/")?"video":"file",size:i.size}};var s=as(Ya(),1),$s=(0,g.createContext)();const In=({children:t})=>{const[e,a]=(0,g.useState)(null),[i,n]=(0,g.useState)(null),[r,l]=(0,g.useState)({}),[o,c]=(0,g.useState)(!0),m=async x=>{try{const h=await ks(x.id);h?(a(h),l(v=>({...v,[h.handle]:h}))):a({id:x.id,email:x.email,name:x.email.split("@")[0],handle:x.email.split("@")[0],avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm",verified:!1})}catch(h){console.error("Error fetching user profile:",h)}finally{c(!1)}};(0,g.useEffect)(()=>{if(!e?.id)return;Ve(e.id);const x=setInterval(()=>Ve(e.id),3e4),h=()=>{document.visibilityState==="visible"&&Ve(e.id)};return window.addEventListener("visibilitychange",h),window.addEventListener("beforeunload",()=>Ve(e.id)),()=>{clearInterval(x),window.removeEventListener("visibilitychange",h),window.removeEventListener("beforeunload",()=>Ve(e.id))}},[e?.id]),(0,g.useEffect)(()=>{O.auth.getSession().then(({data:{session:h}})=>{h?m(h.user):c(!1)});const{data:{subscription:x}}=O.auth.onAuthStateChange((h,v)=>{v?m(v.user):(a(null),c(!1))});return()=>x.unsubscribe()},[]);const d=async({email:x,password:h})=>{const{data:v,error:j}=await O.auth.signInWithPassword({email:x,password:h});if(j)throw j;return n(null),v},u=async({email:x,password:h,username:v,name:j})=>{const{data:{user:w},error:y}=await O.auth.signUp({email:x,password:h,options:{data:{username:v.toLowerCase(),name:j}}});if(y)throw y;return n(null),w},f=async()=>{await O.auth.signOut(),a(null),n(null)},p=async x=>{e&&(await Ui(e.id,x),await m(e))},b=async x=>{if(r[x])return r[x];const h=await Wi(x);return h?(l(v=>({...v,[x]:h})),h):null};return(0,s.jsx)($s.Provider,{value:{currentUser:e,authMode:i,setAuthMode:n,profiles:r,login:d,signup:u,logout:f,updateProfile:p,getProfileByHandle:b,loading:o},children:!o&&t})},pe=()=>{const t=(0,g.useContext)($s);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t};var En=Q(),Ps=(0,g.createContext)();const qn=t=>{const e=(0,En.c)(10),{children:a}=t,{currentUser:i}=pe();let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=new Set,e[0]=n):n=e[0];const[r,l]=(0,g.useState)(n);let o;e[1]!==i?(o=()=>{if(!i?.id)return;const f=O.channel("global_presence",{config:{presence:{key:i.id}}});return f.on("presence",{event:"sync"},()=>{const p=f.presenceState(),b=new Set;Object.keys(p).forEach(x=>b.add(x)),l(b)}).subscribe(async p=>{p==="SUBSCRIBED"&&(await f.track({userId:i.id,online_at:new Date().toISOString()}),Ve(i.id))}),()=>{i?.id&&Ve(i.id),O.removeChannel(f),l(new Set)}},e[1]=i,e[2]=o):o=e[2];const c=i?.id;let m;e[3]!==c?(m=[c],e[3]=c,e[4]=m):m=e[4],(0,g.useEffect)(o,m);let d;e[5]!==r?(d={onlineUsers:r},e[5]=r,e[6]=d):d=e[6];let u;return e[7]!==a||e[8]!==d?(u=(0,s.jsx)(Ps.Provider,{value:d,children:a}),e[7]=a,e[8]=d,e[9]=u):u=e[9],u},Ms=()=>{const t=(0,g.useContext)(Ps);if(!t)throw new Error("usePresence must be used within a PresenceProvider");return t};var Tn=Q(),Fs=(0,g.createContext)();const On=t=>{const e=(0,Tn.c)(11),{children:a}=t,[i,n]=(0,g.useState)(An);let r,l;e[0]!==i?(r=()=>{localStorage.setItem("theme",i?"dark":"light"),i?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},l=[i],e[0]=i,e[1]=r,e[2]=l):(r=e[1],l=e[2]),(0,g.useEffect)(r,l);let o;e[3]!==i?(o=()=>n(!i),e[3]=i,e[4]=o):o=e[4];const c=o;let m;e[5]!==i||e[6]!==c?(m={darkMode:i,setDarkMode:n,toggleDarkMode:c},e[5]=i,e[6]=c,e[7]=m):m=e[7];let d;return e[8]!==a||e[9]!==m?(d=(0,s.jsx)(Fs.Provider,{value:m,children:a}),e[8]=a,e[9]=m,e[10]=d):d=e[10],d},Mt=()=>{const t=(0,g.useContext)(Fs);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t};function An(){const t=localStorage.getItem("theme");return t==="dark"||!t&&window.matchMedia("(prefers-color-scheme: dark)").matches}var Dn=Q(),Bn=t=>{const e=(0,Dn.c)(7);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];const{theme:i}=Wa(),n=i===void 0?"system":i;let r,l;e[2]===Symbol.for("react.memo_cache_sentinel")?(r={success:(0,s.jsx)(os,{className:"size-4"}),info:(0,s.jsx)(Na,{className:"size-4"}),warning:(0,s.jsx)(yi,{className:"size-4"}),error:(0,s.jsx)(Ma,{className:"size-4"}),loading:(0,s.jsx)(me,{className:"size-4 animate-spin"})},l={"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)","--border-radius":"var(--radius)"},e[2]=r,e[3]=l):(r=e[2],l=e[3]);let o;return e[4]!==a||e[5]!==n?(o=(0,s.jsx)(ni,{theme:n,className:"toaster group",icons:r,style:l,...a}),e[4]=a,e[5]=n,e[6]=o):o=e[6],o},Wn=Q(),Ls=(0,g.createContext)();const Un=t=>{const e=(0,Wn.c)(4),{children:a}=t,i=Hn;let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n={addToast:i},e[0]=n):n=e[0];let r;e[1]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsx)(Bn,{position:"bottom-center",toastOptions:{className:"rounded-full font-bold"}}),e[1]=r):r=e[1];let l;return e[2]!==a?(l=(0,s.jsxs)(Ls.Provider,{value:n,children:[a,r]}),e[2]=a,e[3]=l):l=e[3],l},Ce=()=>{const t=(0,g.useContext)(Ls);if(!t)throw new Error("useToast must be used within a ToastProvider");return t};function Hn(t,e){const a=e===void 0?"success":e;a==="error"?jt.error(t):a==="info"?jt.info(t):jt.success(t)}var Rs=(0,g.createContext)();const Qn=({children:t})=>{const[e,a]=(0,g.useState)([]),[i,n]=(0,g.useState)(!0),[r,l]=(0,g.useState)(!0),[o,c]=(0,g.useState)(!1),m=(0,g.useRef)(e);(0,g.useEffect)(()=>{m.current=e},[e]);const d=(0,g.useCallback)(async(v=!1)=>{v?c(!0):n(!0);try{const j=m.current,w=await Xi(v&&j.length>0?j[j.length-1].created_at:null,10);w.length<10?l(!1):l(!0),a(v?y=>[...y,...w]:w)}catch(j){console.error("Failed to load posts:",j)}finally{n(!1),c(!1)}},[]),u=()=>{!r||o||d(!0)};(0,g.useEffect)(()=>{d()},[d]);const f=async v=>{const j=await Zi(v);return d(),j},p=async v=>{await en(v),a(j=>j.filter(w=>w.id!==v))},b=async(v,j)=>{await tn(v,j),a(w=>w.map(y=>y.id===v?{...y,...j}:y))},x=v=>e.find(j=>j.id===v),h=(v,j="feed")=>{let w=e.filter(y=>!!(y.user?.handle===v||y.repostedBy&&y.repostedBy.handle===v));return j==="feed"?w.filter(y=>y.parent_id===null):j==="media"?w.filter(y=>y.parent_id===null&&(y.type==="video"||y.type==="image"||y.media?.length>0)):w};return(0,s.jsx)(Rs.Provider,{value:{posts:e,setPosts:a,addPost:f,deletePost:p,updatePost:b,getPostById:x,getUserPosts:h,loading:i,hasMore:r,isFetchingNextPage:o,fetchNextPage:u,refreshPosts:()=>d(!1)},children:t})},bt=()=>{const t=(0,g.useContext)(Rs);if(!t)throw new Error("usePosts must be used within a PostProvider");return t};var Jn=Q(),Is=(0,g.createContext)();const Vn=t=>{const e=(0,Jn.c)(9),{children:a}=t;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i={isOpen:!1,images:[],currentIndex:0},e[0]=i):i=e[0];const[n,r]=(0,g.useState)(i);let l;e[1]===Symbol.for("react.memo_cache_sentinel")?(l=(b,x)=>{const h=x===void 0?0:x;r({isOpen:!0,images:Array.isArray(b)?b:[b],currentIndex:h})},e[1]=l):l=e[1];const o=l;let c;e[2]===Symbol.for("react.memo_cache_sentinel")?(c=()=>{r(Kn)},e[2]=c):c=e[2];const m=c;let d;e[3]===Symbol.for("react.memo_cache_sentinel")?(d=b=>{r(x=>({...x,currentIndex:b}))},e[3]=d):d=e[3];const u=d;let f;e[4]!==n?(f={...n,openLightbox:o,closeLightbox:m,setIndex:u},e[4]=n,e[5]=f):f=e[5];let p;return e[6]!==a||e[7]!==f?(p=(0,s.jsx)(Is.Provider,{value:f,children:a}),e[6]=a,e[7]=f,e[8]=p):p=e[8],p},Ft=()=>{const t=(0,g.useContext)(Is);if(!t)throw new Error("useLightbox must be used within a LightboxProvider");return t};function Kn(t){return{...t,isOpen:!1}}var Xn=Q();const Es=t=>{const e=(0,Xn.c)(16),a=pt(),i=t?.id;let n;e[0]!==i?(n=["unread_notifications_count",i],e[0]=i,e[1]=n):n=e[1];let r;e[2]!==t?.id?(r=()=>vn(t?.id),e[2]=t?.id,e[3]=r):r=e[3];const l=!!t?.id;let o;e[4]!==n||e[5]!==r||e[6]!==l?(o={queryKey:n,queryFn:r,enabled:l},e[4]=n,e[5]=r,e[6]=l,e[7]=o):o=e[7];const{data:c}=Pe(o),m=c===void 0?0:c;let d;e[8]!==t||e[9]!==a?(d=()=>{if(!t?.id)return;const b=O.channel(`unread_count:${t.id}`).on("postgres_changes",{event:"*",schema:"public",table:"notifications",filter:`recipient_id=eq.${t.id}`},()=>{a.invalidateQueries({queryKey:["unread_notifications_count",t.id]}),a.invalidateQueries({queryKey:["notifications",t.id]})}).subscribe();return()=>O.removeChannel(b)},e[8]=t,e[9]=a,e[10]=d):d=e[10];const u=t?.id;let f;e[11]!==a||e[12]!==u?(f=[u,a],e[11]=a,e[12]=u,e[13]=f):f=e[13],(0,g.useEffect)(d,f);let p;return e[14]!==m?(p={unreadCount:m},e[14]=m,e[15]=p):p=e[15],p};var Yn=Q();const Lt=t=>{const e=(0,Yn.c)(65),a=pt();let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i={},e[0]=i):i=e[0];const[n,r]=(0,g.useState)(i),l=(0,g.useRef)(null),o=t?.id;let c;e[1]!==o?(c=["conversations",o],e[1]=o,e[2]=c):c=e[2];let m;e[3]!==t?.id?(m=()=>mn(t?.id),e[3]=t?.id,e[4]=m):m=e[4];const d=!!t?.id;let u;e[5]!==c||e[6]!==m||e[7]!==d?(u={queryKey:c,queryFn:m,enabled:d},e[5]=c,e[6]=m,e[7]=d,e[8]=u):u=e[8];const{data:f,isLoading:p}=Pe(u);let b;e[9]!==f?(b=f===void 0?[]:f,e[9]=f,e[10]=b):b=e[10];const x=b,h=t?.id;let v;e[11]!==h?(v=["unread_messages_count",h],e[11]=h,e[12]=v):v=e[12];let j;e[13]!==t?.id?(j=()=>cn(t?.id),e[13]=t?.id,e[14]=j):j=e[14];const w=!!t?.id;let y;e[15]!==j||e[16]!==w||e[17]!==v?(y={queryKey:v,queryFn:j,enabled:w},e[15]=j,e[16]=w,e[17]=v,e[18]=y):y=e[18];const{data:k}=Pe(y),S=k===void 0?0:k;let M;e[19]===Symbol.for("react.memo_cache_sentinel")?(M=["reactions"],e[19]=M):M=e[19];const E=!!t?.id;let F;e[20]!==E?(F={queryKey:M,queryFn:fn,enabled:E},e[20]=E,e[21]=F):F=e[21];const{data:N}=Pe(F);let P;e[22]!==N?(P=N===void 0?[]:N,e[22]=N,e[23]=P):P=e[23];const R=P;let L;e[24]!==t||e[25]!==a?(L=()=>{if(!t?.id)return;const V=O.channel(`user_messages:${t.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},re=>{const ne=re.new;a.setQueryData(["messages",ne.conversation_id],H=>H?H.find(oe=>oe.id===ne.id)?H:[...H,ne]:[ne]),ne.sender_id!==t.id&&a.invalidateQueries({queryKey:["unread_messages_count",t.id]}),a.invalidateQueries(["conversations",t.id]),r(H=>({...H,[ne.conversation_id]:!1}))}).on("postgres_changes",{event:"DELETE",schema:"public",table:"messages"},re=>{a.invalidateQueries({queryKey:["messages"]}),a.invalidateQueries({queryKey:["conversations",t.id]})}).on("postgres_changes",{event:"*",schema:"public",table:"message_reactions"},()=>{a.invalidateQueries({queryKey:["reactions"]})}).subscribe(),X=O.channel("chat_typing_shared").on("broadcast",{event:"typing"},re=>{const{payload:ne}=re,{conversationId:H,isTyping:oe,userId:ee}=ne;ee!==t.id&&r(ce=>({...ce,[H]:oe}))}).subscribe();return l.current=X,()=>{O.removeChannel(V),O.removeChannel(X)}},e[24]=t,e[25]=a,e[26]=L):L=e[26];const T=t?.id;let D;e[27]!==a||e[28]!==T?(D=[T,a],e[27]=a,e[28]=T,e[29]=D):D=e[29],(0,g.useEffect)(L,D);let C;e[30]!==t?(C=V=>{const{convId:X,text:re,type:ne,media:H,replyToId:oe}=V,ee=ne===void 0?"text":ne,ce=H===void 0?[]:H,be=oe===void 0?null:oe;return hn(X,t.id,re,ee,ce,be)},e[30]=t,e[31]=C):C=e[31];let _;e[32]!==t||e[33]!==a?(_=V=>{a.setQueryData(["messages",V.conversation_id],X=>X?X.find(re=>re.id===V.id)?X:[...X,V]:[V]),a.invalidateQueries(["conversations",t.id])},e[32]=t,e[33]=a,e[34]=_):_=e[34];let z;e[35]!==C||e[36]!==_?(z={mutationFn:C,onSuccess:_},e[35]=C,e[36]=_,e[37]=z):z=e[37];const $=ys(z);let q;e[38]!==t?(q=(V,X)=>{l.current&&l.current.send({type:"broadcast",event:"typing",payload:{conversationId:V,isTyping:X,userId:t.id}})},e[38]=t,e[39]=q):q=e[39];const B=q;let Y;e[40]!==t||e[41]!==a?(Y=async V=>{!t?.id||!V||(await dn(V,t.id),a.invalidateQueries({queryKey:["unread_messages_count",t.id]}),a.invalidateQueries({queryKey:["conversations",t.id]}))},e[40]=t,e[41]=a,e[42]=Y):Y=e[42];const I=Y;let U;e[43]!==t||e[44]!==a?(U=async(V,X)=>{if(t?.id)try{await xn(V,t.id,X),a.invalidateQueries({queryKey:["reactions"]})}catch(re){console.error("Failed to toggle reaction:",re)}},e[43]=t,e[44]=a,e[45]=U):U=e[45];const W=U;let K;e[46]!==a?(K=async V=>{try{await pn(V),a.invalidateQueries({queryKey:["messages"]})}catch(X){console.error("Failed to delete message:",X)}},e[46]=a,e[47]=K):K=e[47];const te=K;let G;e[48]!==t?.id?(G=(V,X)=>{const re=V===void 0?[]:V,ne=X===void 0?[]:X;return re.map(H=>({id:H.id,sender:H.sender_id===t?.id?"me":"them",text:H.content,type:H.type||"text",media:H.media||[],isRead:H.is_read,replyToId:H.reply_to_id,reactions:ne.filter(oe=>oe.message_id===H.id),time:new Date(H.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}))},e[48]=t?.id,e[49]=G):G=e[49];const ae=G;let ie;e[50]!==$?(ie=(V,X,re,ne,H)=>$.mutate({convId:V,text:X,type:re,media:ne,replyToId:H}),e[50]=$,e[51]=ie):ie=e[51];let le;return e[52]!==R||e[53]!==x||e[54]!==ae||e[55]!==p||e[56]!==I||e[57]!==te||e[58]!==W||e[59]!==$.isPending||e[60]!==B||e[61]!==ie||e[62]!==n||e[63]!==S?(le={conversations:x,unreadCount:S,isConvLoading:p,sendMessage:ie,sendTypingStatus:B,typingStatus:n,markAsRead:I,formatMessages:ae,onToggleReaction:W,onDeleteMessage:te,allReactions:R,isSending:$.isPending},e[52]=R,e[53]=x,e[54]=ae,e[55]=p,e[56]=I,e[57]=te,e[58]=W,e[59]=$.isPending,e[60]=B,e[61]=ie,e[62]=n,e[63]=S,e[64]=le):le=e[64],le};var Gn=Q();function de(...t){return qi(Ii(t))}const Zn=()=>{const t=(0,Gn.c)(2),{pathname:e}=nt();let a;return t[0]!==e?(a=[e],t[0]=e,t[1]=a):a=t[1],(0,g.useEffect)(sr,a),null},ke=t=>typeof t!="string"?!1:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t),er=(t,e)=>{const a=document.createElement("canvas"),i=t.naturalWidth/t.width,n=t.naturalHeight/t.height;a.width=e.width*i,a.height=e.height*n;const r=a.getContext("2d");return r.imageSmoothingEnabled=!0,r.imageSmoothingQuality="high",r.drawImage(t,e.x*i,e.y*n,e.width*i,e.height*n,0,0,e.width*i,e.height*n),new Promise((l,o)=>{a.toBlob(c=>{if(!c){o(new Error("Canvas is empty"));return}l(c)},"image/jpeg",.95)})},dt=t=>{if(!t)return"";const e=new Date-new Date(t),a=Math.floor(e/1e3),i=Math.floor(a/60),n=Math.floor(i/60),r=Math.floor(n/24);return a<60?"Just now":i<60?`${i}m ago`:n<24?`${n}h ago`:r<7?`${r}d ago`:new Date(t).toLocaleDateString()},tr=t=>typeof t!="string"?!1:/[\u0980-\u09FF]/.test(t),ct=t=>{if(!t)return null;const e=t.match(/(https?:\/\/[^\s]+)/g);return e?e[0]:null};function sr(){window.scrollTo(0,0)}var Rt=Q();function fe(t){const e=(0,Rt.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=de("relative flex size-8 shrink-0 overflow-hidden rounded-full",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(Aa,{"data-slot":"avatar",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function xe(t){const e=(0,Rt.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=de("aspect-square size-full",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(Ba,{"data-slot":"avatar-image",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function he(t){const e=(0,Rt.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=de("bg-muted flex size-full items-center justify-center rounded-full",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(pa,{"data-slot":"avatar-fallback",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var ar=Q(),ir=t=>{const e=(0,ar.c)(23),{handleProfileClick:a}=t,{currentUser:i}=pe(),{unreadCount:n}=Es(i),{unreadCount:r}=Lt(i),l=nt();let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=[{id:"home",icon:$t,path:"/"},{id:"community",icon:Ge,path:"/community"},{id:"reels",icon:ut,path:"/reels"},{id:"messages",icon:ht,path:"/messages"},{id:"notifications",icon:Pt,path:"/notifications"}],e[0]=o):o=e[0];const c=o;let m;e[1]!==r||e[2]!==n?(m=c.map(w=>(0,s.jsx)(cs,{to:w.path,className:rr,children:y=>{const{isActive:k}=y;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(w.icon,{size:26,strokeWidth:k?2.5:2}),w.id==="notifications"&&n>0&&(0,s.jsx)("span",{className:"absolute top-3 right-[30%] size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"}),w.id==="messages"&&r>0&&(0,s.jsx)("span",{className:"absolute top-3 right-[30%] size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"})]})}},w.id)),e[1]=r,e[2]=n,e[3]=m):m=e[3];let d;e[4]!==i||e[5]!==a?(d=()=>{i&&a(i.handle)},e[4]=i,e[5]=a,e[6]=d):d=e[6];const u=`size-7 border-2 ${l.pathname.startsWith("/u/")?"border-black dark:border-white":"border-transparent opacity-70"}`,f=i?.avatar||"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm";let p;e[7]!==f?(p=(0,s.jsx)(xe,{src:f,alt:"Profile",className:"object-cover"}),e[7]=f,e[8]=p):p=e[8];let b;e[9]!==i?.handle?.[0]?(b=i?.handle?.[0]?.toUpperCase(),e[9]=i?.handle?.[0],e[10]=b):b=e[10];let x;e[11]!==b?(x=(0,s.jsx)(he,{children:b}),e[11]=b,e[12]=x):x=e[12];let h;e[13]!==u||e[14]!==p||e[15]!==x?(h=(0,s.jsxs)(fe,{className:u,children:[p,x]}),e[13]=u,e[14]=p,e[15]=x,e[16]=h):h=e[16];let v;e[17]!==d||e[18]!==h?(v=(0,s.jsx)("button",{onClick:d,className:"flex-1 flex flex-col items-center justify-center h-full",children:h}),e[17]=d,e[18]=h,e[19]=v):v=e[19];let j;return e[20]!==v||e[21]!==m?(j=(0,s.jsxs)("nav",{className:"fixed bottom-0 left-0 right-0 z-[40] flex h-16 items-center border-t border-zinc-100 bg-white/90 pb-safe backdrop-blur-md dark:border-zinc-800 dark:bg-black/90 md:hidden",children:[m,v]}),e[20]=v,e[21]=m,e[22]=j):j=e[22],j},nr=ir;function rr(t){const{isActive:e}=t;return`flex flex-1 flex-col items-center justify-center h-full transition-all duration-200 relative ${e?"text-black dark:text-white":"text-zinc-400 opacity-70"}`}var lr=Q(),or=()=>{const t=(0,lr.c)(5);let e,a;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,s.jsx)("img",{src:"https://systemadminbd.com/uploads/675346dd55e0c7.43939630.png",alt:"Welcome Banner",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-700"}),a=(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"}),t[0]=e,t[1]=a):(e=t[0],a=t[1]);let i;t[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsx)("h1",{className:"text-3xl sm:text-4xl font-black mb-1 drop-shadow-lg",children:"Welcome to Sysm"}),t[2]=i):i=t[2];let n;t[3]===Symbol.for("react.memo_cache_sentinel")?(n=(0,s.jsxs)("div",{className:"absolute bottom-6 left-8 text-white",children:[i,(0,s.jsxs)("p",{className:"text-sm sm:text-base font-medium opacity-90 tracking-wide drop-shadow-md",children:["a social network built by"," ",(0,s.jsx)("a",{href:"https://t.me/systemadminbd",target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:"@Systemadminbd"})]})]}),t[3]=n):n=t[3];let r;return t[4]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsxs)("div",{className:"relative w-full aspect-[21/9] sm:aspect-[2.5/1] rounded-3xl overflow-hidden mb-6 group cursor-pointer",children:[e,a,n,(0,s.jsx)("div",{className:"absolute bottom-4 right-8",children:(0,s.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",className:"size-12 animate-pulse opacity-80 rounded-xl",alt:""})})]}),t[4]=r):r=t[4],r},cr=or,dr=Q(),mr=t=>{const e=(0,dr.c)(27),{onPostClick:a}=t,i=nt(),n=je(),{darkMode:r}=Mt(),l=i.pathname==="/";let o;e[0]!==i.pathname?(o=i.pathname.startsWith("/reels")||i.pathname.startsWith("/messages")&&i.pathname.split("/").length>2,e[0]=i.pathname,e[1]=o):o=e[1];const c=o;let m;e[2]!==n?(m=M=>{n(`/u/${M}`)},e[2]=n,e[3]=m):m=e[3];const d=m,u=`min-h-screen bg-[--background] text-[--foreground] font-sans selection:bg-violet-500 selection:text-white transition-colors duration-200 ${r?"dark":""}`;let f;e[4]!==a?(f=(0,s.jsx)(br,{onPostClick:a}),e[4]=a,e[5]=f):f=e[5];const p=!c&&"pb-24 md:pb-0";let b;e[6]!==p?(b=de("flex-1 flex justify-center gap-x-2 md:gap-x-8 py-0 md:py-5 px-0 md:px-4",p),e[6]=p,e[7]=b):b=e[7];let x;e[8]!==l?(x=l&&(0,s.jsx)("div",{className:"w-full max-w-full overflow-hidden",children:(0,s.jsx)(cr,{})}),e[8]=l,e[9]=x):x=e[9];let h;e[10]===Symbol.for("react.memo_cache_sentinel")?(h=(0,s.jsx)("div",{className:"w-full",children:(0,s.jsx)(da,{})}),e[10]=h):h=e[10];let v;e[11]!==x?(v=(0,s.jsxs)("div",{className:"flex flex-col flex-1 w-0 overflow-x-hidden",children:[x,h]}),e[11]=x,e[12]=v):v=e[12];let j;e[13]===Symbol.for("react.memo_cache_sentinel")?(j=(0,s.jsx)(gl,{}),e[13]=j):j=e[13];let w;e[14]!==b||e[15]!==v?(w=(0,s.jsxs)("div",{className:b,children:[v,j]}),e[14]=b,e[15]=v,e[16]=w):w=e[16];let y;e[17]!==w||e[18]!==f?(y=(0,s.jsxs)("div",{className:"flex justify-center w-full max-w-[1300px] mx-auto min-h-screen px-0 sm:px-0",children:[f,w]}),e[17]=w,e[18]=f,e[19]=y):y=e[19];let k;e[20]!==d||e[21]!==c?(k=!c&&(0,s.jsx)(nr,{handleProfileClick:d}),e[20]=d,e[21]=c,e[22]=k):k=e[22];let S;return e[23]!==y||e[24]!==k||e[25]!==u?(S=(0,s.jsxs)("div",{className:u,children:[y,k]}),e[23]=y,e[24]=k,e[25]=u,e[26]=S):S=e[26],S},ur=mr,fr=Q(),xr=t=>{const e=(0,fr.c)(2),{children:a}=t;let i;return e[0]!==a?(i=(0,s.jsx)("div",{className:"w-full animate-in fade-in slide-in-from-bottom-2 duration-300 ease-out",children:a}),e[0]=a,e[1]=i):i=e[1],i},$e=xr,hr=Q(),pr=t=>{const e=(0,hr.c)(18),{onPostClick:a}=t,{currentUser:i}=pe(),{unreadCount:n}=Es(i),{unreadCount:r}=Lt(i);let l,o,c,m,d;e[0]===Symbol.for("react.memo_cache_sentinel")?(l={id:"home",icon:$t,path:"/"},o={id:"community",icon:Ge,path:"/community"},c={id:"reels",icon:ut,path:"/reels"},m={id:"messages",icon:ht,path:"/messages"},d={id:"notifications",icon:Pt,path:"/notifications"},e[0]=l,e[1]=o,e[2]=c,e[3]=m,e[4]=d):(l=e[0],o=e[1],c=e[2],m=e[3],d=e[4]);const u=i?`/u/${i.handle}`:"/community";let f;e[5]!==u?(f=[l,o,c,m,d,{id:"profile",icon:Ct,path:u}],e[5]=u,e[6]=f):f=e[6];const p=f;let b;e[7]===Symbol.for("react.memo_cache_sentinel")?(b=(0,s.jsx)(wa,{to:"/",className:"mb-8 hover:scale-110 transition-transform",children:(0,s.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",alt:"Logo",className:"size-8 rounded-lg"})}),e[7]=b):b=e[7];let x;e[8]!==r||e[9]!==p||e[10]!==n?(x=p.map(j=>(0,s.jsxs)(cs,{to:j.path,className:gr,children:[(0,s.jsx)(j.icon,{size:26,strokeWidth:2.5}),j.id==="notifications"&&n>0&&(0,s.jsx)("span",{className:"absolute top-2 right-2 size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"}),j.id==="messages"&&r>0&&(0,s.jsx)("span",{className:"absolute top-2 right-2 size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"})]},j.id)),e[8]=r,e[9]=p,e[10]=n,e[11]=x):x=e[11];let h;e[12]!==i||e[13]!==a?(h=i&&(0,s.jsx)("button",{onClick:a,className:"p-2.5 mt-2 rounded-xl text-white bg-zinc-950 dark:bg-white dark:text-zinc-950 hover:scale-110 active:scale-95 transition-all duration-200 shadow-lg cursor-pointer",title:"Create Post",children:(0,s.jsx)(Oe,{size:26,strokeWidth:2.5})}),e[12]=i,e[13]=a,e[14]=h):h=e[14];let v;return e[15]!==h||e[16]!==x?(v=(0,s.jsxs)("aside",{className:"sticky top-0 hidden md:flex h-screen w-[68px] flex-col items-center py-5 border-r border-zinc-100 dark:border-zinc-800 shrink-0 bg-white dark:bg-black transition-colors duration-200",children:[b,(0,s.jsxs)("nav",{className:"flex flex-col gap-y-4 w-full items-center",children:[x,h]})]}),e[15]=h,e[16]=x,e[17]=v):v=e[17],v},br=pr;function gr(t){const{isActive:e}=t;return`p-2.5 rounded-xl transition-all duration-200 border border-transparent relative ${e?"text-black dark:text-white bg-zinc-100 dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800":"text-zinc-500 hover:bg-zinc-50 dark:hover:bg-zinc-900"}`}var Fe=Q();function Bt(t){const e=(0,Fe.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(ia,{"data-slot":"alert-dialog",...a}),e[2]=a,e[3]=i):i=e[3],i}function vr(t){const e=(0,Fe.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(Mi,{"data-slot":"alert-dialog-portal",...a}),e[2]=a,e[3]=i):i=e[3],i}function jr(t){const e=(0,Fe.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=de("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)($a,{"data-slot":"alert-dialog-overlay",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function Wt(t){const e=(0,Fe.c)(9);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]===Symbol.for("react.memo_cache_sentinel")?(n=(0,s.jsx)(jr,{}),e[3]=n):n=e[3];let r;e[4]!==a?(r=de("bg-white dark:bg-zinc-950 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-2xl border border-zinc-100 dark:border-zinc-800 p-6 shadow-xl duration-200 sm:max-w-md",a),e[4]=a,e[5]=r):r=e[5];let l;return e[6]!==i||e[7]!==r?(l=(0,s.jsxs)(vr,{children:[n,(0,s.jsx)(ha,{"data-slot":"alert-dialog-content","aria-describedby":void 0,className:r,...i})]}),e[6]=i,e[7]=r,e[8]=l):l=e[8],l}function Ut(t){const e=(0,Fe.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=de("flex flex-col gap-2 text-center sm:text-left",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)("div",{"data-slot":"alert-dialog-header",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function Ht(t){const e=(0,Fe.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=de("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)("div",{"data-slot":"alert-dialog-footer",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function Qt(t){const e=(0,Fe.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=de("text-lg font-semibold",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(Ea,{"data-slot":"alert-dialog-title",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function Jt(t){const e=(0,Fe.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=de("text-muted-foreground text-sm",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(ga,{"data-slot":"alert-dialog-description",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function Vt(t){const e=(0,Fe.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=de("inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-bold transition-all active:scale-95 bg-zinc-900 text-white hover:bg-zinc-800 dark:bg-white dark:text-black dark:hover:bg-zinc-200",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(_a,{className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function Kt(t){const e=(0,Fe.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=de("inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-bold border border-zinc-200 bg-white text-zinc-900 hover:bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-950 dark:text-zinc-50 dark:hover:bg-zinc-900",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(ca,{className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var yr=Q(),wr=t=>{const e=(0,yr.c)(12);let a,i,n,r;e[0]!==t?({children:a,variant:n,className:r,...i}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n,e[4]=r):(a=e[1],i=e[2],n=e[3],r=e[4]);const l=n===void 0?"primary":n,o=r===void 0?"":r;let c;e[5]===Symbol.for("react.memo_cache_sentinel")?(c={primary:"text-white hover:text-white bg-zinc-900 hover:bg-zinc-800 border border-zinc-900 dark:bg-white dark:text-black dark:border-white dark:hover:bg-zinc-200",secondary:"text-zinc-900 border border-zinc-300 hover:border-zinc-400 bg-transparent hover:bg-zinc-50 dark:text-white dark:border-zinc-700 dark:hover:border-zinc-600 dark:hover:bg-zinc-900",outline:"text-zinc-900 border border-zinc-300 hover:border-zinc-400 bg-white dark:bg-transparent dark:text-white dark:border-zinc-700 dark:hover:bg-zinc-900",danger:"text-white bg-red-500 hover:bg-red-600 border border-red-500",ghost:"text-zinc-500 hover:bg-zinc-100 dark:text-zinc-400 dark:hover:bg-zinc-800 border-transparent"},e[5]=c):c=e[5];const m=`rounded-full font-bold inline-flex items-center justify-center relative overflow-hidden px-4 py-1.5 transition-all duration-200 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:active:scale-100 touch-manipulation ${c[l]} ${o}`;let d;e[6]!==a?(d=(0,s.jsx)("div",{className:"flex items-center gap-x-1.5",children:a}),e[6]=a,e[7]=d):d=e[7];let u;return e[8]!==i||e[9]!==m||e[10]!==d?(u=(0,s.jsx)("button",{className:m,...i,children:d}),e[8]=i,e[9]=m,e[10]=d,e[11]=u):u=e[11],u},ue=wr,et=Q();function Nr(t){const e=(0,et.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(li,{"data-slot":"context-menu",...a}),e[2]=a,e[3]=i):i=e[3],i}function zr(t){const e=(0,et.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(za,{"data-slot":"context-menu-trigger",...a}),e[2]=a,e[3]=i):i=e[3],i}function kr(t){const e=(0,et.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=de("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(aa,{children:(0,s.jsx)(la,{"data-slot":"context-menu-content",className:n,...i})}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function Nt(t){const e=(0,et.c)(12);let a,i,n,r;e[0]!==t?({className:a,inset:i,variant:r,...n}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n,e[4]=r):(a=e[1],i=e[2],n=e[3],r=e[4]);const l=r===void 0?"default":r;let o;e[5]!==a?(o=de("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),e[5]=a,e[6]=o):o=e[6];let c;return e[7]!==i||e[8]!==n||e[9]!==o||e[10]!==l?(c=(0,s.jsx)(ka,{"data-slot":"context-menu-item","data-inset":i,"data-variant":l,className:o,...n}),e[7]=i,e[8]=n,e[9]=o,e[10]=l,e[11]=c):c=e[11],c}function _r(t){const e=(0,et.c)(10);let a,i,n;e[0]!==t?({className:a,inset:i,...n}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n):(a=e[1],i=e[2],n=e[3]);let r;e[4]!==a?(r=de("text-foreground px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",a),e[4]=a,e[5]=r):r=e[5];let l;return e[6]!==i||e[7]!==n||e[8]!==r?(l=(0,s.jsx)(di,{"data-slot":"context-menu-label","data-inset":i,className:r,...n}),e[6]=i,e[7]=n,e[8]=r,e[9]=l):l=e[9],l}function Xt(t){const e=(0,et.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=de("bg-border -mx-1 my-1 h-px",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(ya,{"data-slot":"context-menu-separator",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var He=Q();function qs(t){const e=(0,He.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(ba,{"data-slot":"dialog",...a}),e[2]=a,e[3]=i):i=e[3],i}function Cr(t){const e=(0,He.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(ma,{"data-slot":"dialog-portal",...a}),e[2]=a,e[3]=i):i=e[3],i}function Sr(t){const e=(0,He.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=de("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(Oa,{"data-slot":"dialog-overlay",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function Ts(t){const e=(0,He.c)(11);let a,i,n;e[0]!==t?({className:i,children:a,...n}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n):(a=e[1],i=e[2],n=e[3]);let r;e[4]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsx)(Sr,{}),e[4]=r):r=e[4];let l;e[5]!==i?(l=de("bg-white dark:bg-zinc-950 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-2xl border border-zinc-100 dark:border-zinc-800 p-6 shadow-xl duration-200 sm:max-w-md",i),e[5]=i,e[6]=l):l=e[6];let o;return e[7]!==a||e[8]!==n||e[9]!==l?(o=(0,s.jsxs)(Cr,{children:[r,(0,s.jsx)(fa,{"data-slot":"alert-dialog-content","aria-describedby":void 0,className:l,...n,children:a})]}),e[7]=a,e[8]=n,e[9]=l,e[10]=o):o=e[10],o}function Os(t){const e=(0,He.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=de("flex flex-col gap-2 text-center sm:text-left",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)("div",{"data-slot":"dialog-header",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function As(t){const e=(0,He.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=de("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)("div",{"data-slot":"dialog-footer",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function Ds(t){const e=(0,He.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=de("text-lg leading-none font-semibold",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(vi,{"data-slot":"dialog-title",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function $r(t){const e=(0,He.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=de("text-muted-foreground text-sm",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(Ra,{"data-slot":"dialog-description",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var ot=Q();function Bs(t){const e=(0,ot.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(Ci,{"data-slot":"dropdown-menu",...a}),e[2]=a,e[3]=i):i=e[3],i}function Ws(t){const e=(0,ot.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(oa,{"data-slot":"dropdown-menu-trigger",...a}),e[2]=a,e[3]=i):i=e[3],i}function Us(t){const e=(0,ot.c)(10);let a,i,n;e[0]!==t?({className:a,sideOffset:n,...i}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n):(a=e[1],i=e[2],n=e[3]);const r=n===void 0?4:n;let l;e[4]!==a?(l=de("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",a),e[4]=a,e[5]=l):l=e[5];let o;return e[6]!==i||e[7]!==r||e[8]!==l?(o=(0,s.jsx)(na,{children:(0,s.jsx)($i,{"data-slot":"dropdown-menu-content",sideOffset:r,className:l,...i})}),e[6]=i,e[7]=r,e[8]=l,e[9]=o):o=e[9],o}function Ke(t){const e=(0,ot.c)(12);let a,i,n,r;e[0]!==t?({className:a,inset:i,variant:r,...n}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n,e[4]=r):(a=e[1],i=e[2],n=e[3],r=e[4]);const l=r===void 0?"default":r;let o;e[5]!==a?(o=de("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),e[5]=a,e[6]=o):o=e[6];let c;return e[7]!==i||e[8]!==n||e[9]!==o||e[10]!==l?(c=(0,s.jsx)(Pa,{"data-slot":"dropdown-menu-item","data-inset":i,"data-variant":l,className:o,...n}),e[7]=i,e[8]=n,e[9]=o,e[10]=l,e[11]=c):c=e[11],c}function Pr(t){const e=(0,ot.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=de("bg-border -mx-1 my-1 h-px",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(Fa,{"data-slot":"dropdown-menu-separator",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var Mr=Q(),Fr=t=>{const e=(0,Mr.c)(10),{onEmojiSelect:a,className:i}=t;let n;e[0]!==i?(n=de("isolate flex h-[350px] w-[320px] flex-col overflow-hidden rounded-xl border border-zinc-200 bg-white shadow-xl dark:border-zinc-800 dark:bg-zinc-950",i),e[0]=i,e[1]=n):n=e[1];let r;e[2]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsx)(Je.Search,{className:"z-10 mx-3 mt-3 appearance-none rounded-lg border-none bg-zinc-100 px-3 py-2 text-sm outline-none placeholder:text-zinc-500 focus:ring-1 focus:ring-violet-500 dark:bg-zinc-900 dark:text-white",placeholder:"Search emojis..."}),e[2]=r):r=e[2];let l,o;e[3]===Symbol.for("react.memo_cache_sentinel")?(l=(0,s.jsx)(Je.Loading,{className:"absolute inset-0 flex items-center justify-center text-zinc-400 text-sm dark:text-zinc-500",children:"Loading"}),o=(0,s.jsx)(Je.Empty,{className:"absolute inset-0 flex items-center justify-center text-zinc-400 text-sm dark:text-zinc-500",children:"No emoji found."}),e[3]=l,e[4]=o):(l=e[3],o=e[4]);let c,m;e[5]===Symbol.for("react.memo_cache_sentinel")?(c=(0,s.jsxs)(Je.Viewport,{className:"relative flex-1 outline-none no-scrollbar",children:[l,o,(0,s.jsx)(Je.List,{className:"select-none pb-2",components:{CategoryHeader:Rr,Row:Ir,Emoji:Er}})]}),m=(0,s.jsx)(Je.ActiveEmoji,{children:qr}),e[5]=c,e[6]=m):(c=e[5],m=e[6]);let d;return e[7]!==a||e[8]!==n?(d=(0,s.jsxs)(Je.Root,{onEmojiSelect:a,className:n,children:[r,c,m]}),e[7]=a,e[8]=n,e[9]=d):d=e[9],d},Lr=Fr;function Rr(t){const{category:e,...a}=t;return(0,s.jsx)("div",{className:"bg-white/80 px-4 pt-4 pb-1.5 font-bold text-zinc-500 text-[11px] uppercase tracking-wider backdrop-blur-sm dark:bg-zinc-950/80 dark:text-zinc-400",...a,children:e.label})}function Ir(t){const{children:e,...a}=t;return(0,s.jsx)("div",{className:"scroll-my-1 px-2",...a,children:e})}function Er(t){const{emoji:e,...a}=t;return(0,s.jsx)("button",{className:"flex aspect-square size-9 items-center justify-center rounded-lg text-xl transition-colors hover:bg-zinc-100 data-[active]:bg-violet-500/10 data-[active]:text-violet-500 dark:hover:bg-zinc-900 dark:data-[active]:bg-violet-500/20",...a,children:e.emoji})}function qr(t){const{emoji:e}=t;return(0,s.jsx)("div",{className:"flex items-center gap-3 border-t border-zinc-100 p-3 dark:border-zinc-800",children:e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"text-2xl",children:e.emoji}),(0,s.jsx)("span",{className:"text-xs font-bold text-zinc-600 dark:text-zinc-400 truncate",children:e.label.replace(/:/g,"").replace(/_/g," ")})]}):(0,s.jsx)("span",{className:"text-xs font-medium text-zinc-400",children:"Select an emoji..."})})}var Tr=Q(),Or=t=>{const e=(0,Tr.c)(33),{src:a,isOpen:i,onClose:n,onCropComplete:r,aspect:l,circular:o}=t,[c,m]=(0,g.useState)(),[d,u]=(0,g.useState)(null),f=(0,g.useRef)(null);let p;e[0]!==l?(p=R=>{const{width:L,height:T}=R.currentTarget;m(l?_i(Ha({unit:"%",width:100},l,L,T),L,T):{unit:"%",width:100,height:100,x:0,y:0})},e[0]=l,e[1]=p):p=e[1];const b=p;let x;e[2]!==d||e[3]!==n||e[4]!==r?(x=async()=>{if(d&&f.current)try{r(await er(f.current,d)),n()}catch(R){console.error("Error cropping image:",R)}},e[2]=d,e[3]=n,e[4]=r,e[5]=x):x=e[5];const h=x;let v;e[6]!==n?(v=R=>!R&&n(),e[6]=n,e[7]=v):v=e[7];let j;e[8]===Symbol.for("react.memo_cache_sentinel")?(j=(0,s.jsx)(Os,{className:"p-4 shrink-0",children:(0,s.jsx)(Ds,{children:"Crop Image"})}),e[8]=j):j=e[8];let w,y;e[9]===Symbol.for("react.memo_cache_sentinel")?(w=R=>m(R),y=(R,L)=>u(L),e[9]=w,e[10]=y):(w=e[9],y=e[10]);let k;e[11]!==b||e[12]!==a?(k=(0,s.jsx)("img",{ref:f,src:a,alt:"Crop preview",onLoad:b,className:"max-h-[60vh] w-auto block"}),e[11]=b,e[12]=a,e[13]=k):k=e[13];let S;e[14]!==l||e[15]!==o||e[16]!==c||e[17]!==k?(S=(0,s.jsx)("div",{className:"p-6 flex items-center justify-center bg-zinc-100/50 dark:bg-zinc-950/50 min-h-[300px] max-h-[65vh] overflow-auto",children:(0,s.jsx)(Pi,{crop:c,onChange:w,onComplete:y,aspect:l,circularCrop:o,className:"max-w-full shadow-2xl",children:k})}),e[14]=l,e[15]=o,e[16]=c,e[17]=k,e[18]=S):S=e[18];let M;e[19]!==n?(M=(0,s.jsx)(ue,{variant:"outline",onClick:n,className:"!w-auto px-6",children:"Cancel"}),e[19]=n,e[20]=M):M=e[20];let E;e[21]!==h?(E=(0,s.jsx)(ue,{onClick:h,className:"!w-auto px-6",children:"Apply Crop"}),e[21]=h,e[22]=E):E=e[22];let F;e[23]!==E||e[24]!==M?(F=(0,s.jsxs)(As,{className:"p-4 bg-white dark:bg-zinc-900 shrink-0 flex flex-row justify-end gap-2",children:[M,E]}),e[23]=E,e[24]=M,e[25]=F):F=e[25];let N;e[26]!==F||e[27]!==S?(N=(0,s.jsxs)(Ts,{className:"sm:max-w-2xl bg-white dark:bg-zinc-900 p-0 overflow-hidden",children:[j,S,F]}),e[26]=F,e[27]=S,e[28]=N):N=e[28];let P;return e[29]!==i||e[30]!==N||e[31]!==v?(P=(0,s.jsx)(qs,{open:i,onOpenChange:v,children:N}),e[29]=i,e[30]=N,e[31]=v,e[32]=P):P=e[32],P},Ar=Or,Dr=Q(),Br=t=>{const e=(0,Dr.c)(105),{images:a,currentIndex:i,onClose:n,onNavigate:r}=t,l=i===void 0?0:i,[o,c]=(0,g.useState)(1);let m;e[0]===Symbol.for("react.memo_cache_sentinel")?(m={x:0,y:0},e[0]=m):m=e[0];const[d,u]=(0,g.useState)(m),[f,p]=(0,g.useState)(!1);let b;e[1]===Symbol.for("react.memo_cache_sentinel")?(b={x:0,y:0},e[1]=b):b=e[1];const[x,h]=(0,g.useState)(b),[v,j]=(0,g.useState)(null),[w,y]=(0,g.useState)(null),k=(0,g.useRef)(null),S=(0,g.useRef)(null);let M;e[2]===Symbol.for("react.memo_cache_sentinel")?(M=()=>c(Ur),e[2]=M):M=e[2];const E=M;let F;e[3]===Symbol.for("react.memo_cache_sentinel")?(F=()=>{c(A=>{const se=Math.max(A-.5,1);return se===1&&u({x:0,y:0}),se})},e[3]=F):F=e[3];const N=F;let P;e[4]===Symbol.for("react.memo_cache_sentinel")?(P=()=>{c(1),u({x:0,y:0})},e[4]=P):P=e[4];const R=P;let L;e[5]!==l||e[6]!==r?(L=()=>{l>0&&(R(),r(l-1))},e[5]=l,e[6]=r,e[7]=L):L=e[7];const T=L;let D;e[8]!==l||e[9]!==a?.length||e[10]!==r?(D=()=>{l<(a?.length||0)-1&&(R(),r(l+1))},e[8]=l,e[9]=a?.length,e[10]=r,e[11]=D):D=e[11],a?.length;const C=D;let _;e[12]!==C||e[13]!==T||e[14]!==n?(_=()=>{const A=se=>{se.key==="Escape"&&n(),se.key==="ArrowLeft"&&T(),se.key==="ArrowRight"&&C()};return window.addEventListener("keydown",A),()=>window.removeEventListener("keydown",A)},e[12]=C,e[13]=T,e[14]=n,e[15]=_):_=e[15];let z;if(e[16]!==l||e[17]!==C||e[18]!==T||e[19]!==n?(z=[l,n,T,C],e[16]=l,e[17]=C,e[18]=T,e[19]=n,e[20]=z):z=e[20],(0,g.useEffect)(_,z),!a||a.length===0)return null;const $=a[l],q=a.length>1;let B;e[21]!==d.x||e[22]!==d.y||e[23]!==o?(B=A=>{o>1&&(p(!0),h({x:A.clientX-d.x,y:A.clientY-d.y}))},e[21]=d.x,e[22]=d.y,e[23]=o,e[24]=B):B=e[24];const Y=B;let I;e[25]!==x||e[26]!==f||e[27]!==o?(I=A=>{f&&o>1&&u({x:A.clientX-x.x,y:A.clientY-x.y})},e[25]=x,e[26]=f,e[27]=o,e[28]=I):I=e[28];const U=I;let W;e[29]===Symbol.for("react.memo_cache_sentinel")?(W=()=>p(!1),e[29]=W):W=e[29];const K=W;let te;e[30]!==d.x||e[31]!==d.y||e[32]!==o?(te=A=>{A.touches.length===1?(j({x:A.touches[0].clientX,y:A.touches[0].clientY,time:Date.now()}),o>1&&(p(!0),h({x:A.touches[0].clientX-d.x,y:A.touches[0].clientY-d.y}))):A.touches.length===2&&y(Math.hypot(A.touches[0].clientX-A.touches[1].clientX,A.touches[0].clientY-A.touches[1].clientY))},e[30]=d.x,e[31]=d.y,e[32]=o,e[33]=te):te=e[33];const G=te;let ae;e[34]!==x||e[35]!==w||e[36]!==f||e[37]!==o?(ae=A=>{if(A.touches.length===1)f&&o>1&&u({x:A.touches[0].clientX-x.x,y:A.touches[0].clientY-x.y});else if(A.touches.length===2&&w){const se=Math.hypot(A.touches[0].clientX-A.touches[1].clientX,A.touches[0].clientY-A.touches[1].clientY);c(Math.min(Math.max(o*(se/w),1),4)),y(se)}},e[34]=x,e[35]=w,e[36]=f,e[37]=o,e[38]=ae):ae=e[38];const ie=ae;let le;e[39]!==C||e[40]!==T||e[41]!==o||e[42]!==v?(le=A=>{if(A.touches.length<2&&y(null),p(!1),v&&o===1){const se={x:A.changedTouches[0].clientX,y:A.changedTouches[0].clientY},Se=se.x-v.x,ge=se.y-v.y,Ne=Date.now()-v.time;Math.abs(Se)>50&&Math.abs(ge)<50&&Ne<300&&(Se>0?T():C())}j(null)},e[39]=C,e[40]=T,e[41]=o,e[42]=v,e[43]=le):le=e[43];const V=le;let X;e[44]!==$?(X=A=>{A.stopPropagation();const se=document.createElement("a");se.href=$,se.download=`sysm-${Date.now()}.jpg`,document.body.appendChild(se),se.click(),document.body.removeChild(se)},e[44]=$,e[45]=X):X=e[45];const re=X,ne=q?`${l+1} / ${a.length}`:"Image View";let H;e[46]!==ne?(H=(0,s.jsx)("div",{className:"flex flex-col",children:(0,s.jsx)("span",{className:"text-white font-bold text-lg drop-shadow-md",children:ne})}),e[46]=ne,e[47]=H):H=e[47];let oe;e[48]===Symbol.for("react.memo_cache_sentinel")?(oe=(0,s.jsx)("button",{onClick:N,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors hidden sm:block",children:(0,s.jsx)(Ca,{size:20})}),e[48]=oe):oe=e[48];let ee;e[49]===Symbol.for("react.memo_cache_sentinel")?(ee=(0,s.jsx)("button",{onClick:E,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors hidden sm:block",children:(0,s.jsx)(sa,{size:20})}),e[49]=ee):ee=e[49];let ce;e[50]===Symbol.for("react.memo_cache_sentinel")?(ce=(0,s.jsx)("button",{onClick:R,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors",children:(0,s.jsx)(si,{size:20})}),e[50]=ce):ce=e[50];let be;e[51]===Symbol.for("react.memo_cache_sentinel")?(be=(0,s.jsx)(ms,{size:20}),e[51]=be):be=e[51];let ve;e[52]!==re?(ve=(0,s.jsx)("button",{onClick:re,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors",children:be}),e[52]=re,e[53]=ve):ve=e[53];let Xe;e[54]===Symbol.for("react.memo_cache_sentinel")?(Xe=(0,s.jsx)("div",{className:"w-px h-6 bg-white/20 mx-1 hidden sm:block"}),e[54]=Xe):Xe=e[54];let Qe;e[55]===Symbol.for("react.memo_cache_sentinel")?(Qe=(0,s.jsx)(_e,{size:24}),e[55]=Qe):Qe=e[55];let Le;e[56]!==n?(Le=(0,s.jsx)("button",{onClick:n,className:"text-white p-2 bg-white/10 hover:bg-white/20 rounded-full transition-all",children:Qe}),e[56]=n,e[57]=Le):Le=e[57];let Ae;e[58]!==ve||e[59]!==Le?(Ae=(0,s.jsxs)("div",{className:"flex items-center gap-1 sm:gap-3",onClick:Hr,children:[oe,ee,ce,ve,Xe,Le]}),e[58]=ve,e[59]=Le,e[60]=Ae):Ae=e[60];let Re;e[61]!==H||e[62]!==Ae?(Re=(0,s.jsxs)("div",{className:"absolute top-0 left-0 right-0 p-4 z-20 flex items-center justify-between bg-gradient-to-b from-black/60 to-transparent",children:[H,Ae]}),e[61]=H,e[62]=Ae,e[63]=Re):Re=e[63];let we;e[64]!==l||e[65]!==T||e[66]!==q||e[67]!==o?(we=q&&l>0&&o===1&&(0,s.jsx)("button",{onClick:A=>{A.stopPropagation(),T()},className:"absolute left-6 z-10 p-4 bg-white/5 hover:bg-white/10 rounded-full text-white backdrop-blur-sm transition-all active:scale-90 hidden md:flex",children:(0,s.jsx)(us,{size:32})}),e[64]=l,e[65]=T,e[66]=q,e[67]=o,e[68]=we):we=e[68];const st=`translate(${d.x}px, ${d.y}px) scale(${o})`;let De;e[69]!==st?(De={transform:st},e[69]=st,e[70]=De):De=e[70];let Ie;e[71]!==$?(Ie=(0,s.jsx)("img",{ref:S,src:$,className:"max-w-[95vw] max-h-[85vh] object-contain select-none shadow-2xl rounded-sm",alt:"",draggable:!1}),e[71]=$,e[72]=Ie):Ie=e[72];let Ee;e[73]!==Y||e[74]!==De||e[75]!==Ie?(Ee=(0,s.jsx)("div",{className:"relative transition-transform duration-200 ease-out cursor-grab active:cursor-grabbing",style:De,onMouseDown:Y,onClick:Qr,children:Ie}),e[73]=Y,e[74]=De,e[75]=Ie,e[76]=Ee):Ee=e[76];let qe;e[77]!==l||e[78]!==C||e[79]!==q||e[80]!==a.length||e[81]!==o?(qe=q&&l<a.length-1&&o===1&&(0,s.jsx)("button",{onClick:A=>{A.stopPropagation(),C()},className:"absolute right-6 z-10 p-4 bg-white/5 hover:bg-white/10 rounded-full text-white backdrop-blur-sm transition-all active:scale-90 hidden md:flex",children:(0,s.jsx)(ls,{size:32})}),e[77]=l,e[78]=C,e[79]=q,e[80]=a.length,e[81]=o,e[82]=qe):qe=e[82];let Te;e[83]!==we||e[84]!==Ee||e[85]!==qe?(Te=(0,s.jsxs)("div",{className:"w-full h-full relative flex items-center justify-center",children:[we,Ee,qe]}),e[83]=we,e[84]=Ee,e[85]=qe,e[86]=Te):Te=e[86];let Be;e[87]!==l||e[88]!==q||e[89]!==a||e[90]!==r?(Be=q&&(0,s.jsx)("div",{className:"absolute bottom-8 flex gap-3 p-3 bg-black/40 backdrop-blur-xl rounded-2xl border border-white/10 overflow-x-auto max-w-[90%] hide-scrollbar",onClick:Jr,children:a.map((A,se)=>(0,s.jsx)("button",{onClick:()=>{R(),r(se)},className:`size-14 rounded-xl overflow-hidden border-2 transition-all shrink-0 ${se===l?"border-violet-500 scale-110 shadow-lg shadow-violet-500/20":"border-transparent opacity-40 hover:opacity-100"}`,children:(0,s.jsx)("img",{src:A,className:"size-full object-cover",alt:""})},se))}),e[87]=l,e[88]=q,e[89]=a,e[90]=r,e[91]=Be):Be=e[91];let J;e[92]!==q||e[93]!==o?(J=o===1&&q&&(0,s.jsx)("div",{className:"absolute bottom-4 text-white/30 text-[10px] uppercase tracking-widest font-bold md:hidden",children:"Swipe to navigate"}),e[92]=q,e[93]=o,e[94]=J):J=e[94];let Z;return e[95]!==U||e[96]!==V||e[97]!==ie||e[98]!==G||e[99]!==n||e[100]!==Re||e[101]!==Te||e[102]!==Be||e[103]!==J?(Z=(0,s.jsxs)("div",{ref:k,className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-md flex flex-col items-center justify-center overflow-hidden touch-none",onMouseMove:U,onMouseUp:K,onMouseLeave:K,onTouchStart:G,onTouchMove:ie,onTouchEnd:V,onClick:n,children:[Re,Te,Be,J]}),e[95]=U,e[96]=V,e[97]=ie,e[98]=G,e[99]=n,e[100]=Re,e[101]=Te,e[102]=Be,e[103]=J,e[104]=Z):Z=e[104],Z},Wr=Br;function Ur(t){return Math.min(t+.5,4)}function Hr(t){return t.stopPropagation()}function Qr(t){return t.stopPropagation()}function Jr(t){return t.stopPropagation()}var Vr=Q(),Hs=g.forwardRef((t,e)=>{const a=(0,Vr.c)(20);let i,n,r,l,o;a[0]!==t?({className:i,label:n,type:o,textarea:l,...r}=t,a[0]=t,a[1]=i,a[2]=n,a[3]=r,a[4]=l,a[5]=o):(i=a[1],n=a[2],r=a[3],l=a[4],o=a[5]);const c=l?"textarea":"input";let m;a[6]!==n?(m=n&&(0,s.jsx)("label",{className:"text-sm font-bold text-zinc-500 dark:text-zinc-400 ml-1",children:n}),a[6]=n,a[7]=m):m=a[7];const d=l&&"min-h-[100px] resize-none";let u;a[8]!==i||a[9]!==d?(u=de("flex w-full rounded-xl border border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900 px-4 py-2.5 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-zinc-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:ring-offset-zinc-950 dark:text-white transition-all",d,i),a[8]=i,a[9]=d,a[10]=u):u=a[10];let f;a[11]!==c||a[12]!==r||a[13]!==e||a[14]!==u||a[15]!==o?(f=(0,s.jsx)(c,{type:o,className:u,ref:e,...r}),a[11]=c,a[12]=r,a[13]=e,a[14]=u,a[15]=o,a[16]=f):f=a[16];let p;return a[17]!==m||a[18]!==f?(p=(0,s.jsxs)("div",{className:"w-full space-y-1.5",children:[m,f]}),a[17]=m,a[18]=f,a[19]=p):p=a[19],p});Hs.displayName="Input";var We=Hs,Kr=Q(),Xr=t=>{const e=(0,Kr.c)(20),{isOpen:a,onClose:i,title:n,children:r,footer:l,description:o,className:c}=t;let m;e[0]!==i?(m=v=>{v||i()},e[0]=i,e[1]=m):m=e[1];const d=m;let u;e[2]!==c?(u=de("sm:max-w-md max-h-[calc(100dvh-2rem)] flex flex-col p-0 gap-0 overflow-hidden bg-white dark:bg-zinc-900",c),e[2]=c,e[3]=u):u=e[3];let f;e[4]!==o||e[5]!==n?(f=n&&(0,s.jsxs)(Os,{className:"px-5 py-4 shrink-0",children:[(0,s.jsx)(Ds,{className:"text-xl font-bold",children:n}),o&&(0,s.jsx)($r,{children:o})]}),e[4]=o,e[5]=n,e[6]=f):f=e[6];let p;e[7]!==r?(p=(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-5 min-h-0",children:r}),e[7]=r,e[8]=p):p=e[8];let b;e[9]!==l?(b=l&&(0,s.jsx)(As,{className:"px-5 py-4 shrink-0 bg-white dark:bg-zinc-900",children:l}),e[9]=l,e[10]=b):b=e[10];let x;e[11]!==u||e[12]!==f||e[13]!==p||e[14]!==b?(x=(0,s.jsxs)(Ts,{className:u,children:[f,p,b]}),e[11]=u,e[12]=f,e[13]=p,e[14]=b,e[15]=x):x=e[15];let h;return e[16]!==d||e[17]!==a||e[18]!==x?(h=(0,s.jsx)(qs,{open:a,onOpenChange:d,children:x}),e[16]=d,e[17]=a,e[18]=x,e[19]=h):h=e[19],h},tt=Xr,Yr=Q(),Gr=t=>{const e=(0,Yr.c)(20),{title:a,message:i,icon:n,showHome:r,showBack:l}=t,o=a===void 0?"Not Found":a,c=i===void 0?"The content you are looking for doesn't exist or has been removed.":i,m=n===void 0?vs:n,d=r===void 0?!0:r,u=l===void 0?!0:l,f=je(),p=m;let b;e[0]!==p?(b=(0,s.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-900 p-6 rounded-full mb-6",children:(0,s.jsx)(p,{size:48,className:"text-zinc-400 dark:text-zinc-600"})}),e[0]=p,e[1]=b):b=e[1];let x;e[2]!==o?(x=(0,s.jsx)("h2",{className:"text-2xl font-black mb-2 dark:text-white",children:o}),e[2]=o,e[3]=x):x=e[3];let h;e[4]!==c?(h=(0,s.jsx)("p",{className:"text-zinc-500 dark:text-zinc-400 max-w-xs mb-8 leading-relaxed",children:c}),e[4]=c,e[5]=h):h=e[5];let v;e[6]!==f||e[7]!==u?(v=u&&(0,s.jsxs)(ue,{variant:"secondary",onClick:()=>f(-1),className:"rounded-full px-6",children:[(0,s.jsx)(Ze,{size:18,className:"mr-2"}),"Go Back"]}),e[6]=f,e[7]=u,e[8]=v):v=e[8];let j;e[9]!==f||e[10]!==d?(j=d&&(0,s.jsxs)(ue,{onClick:()=>f("/"),className:"bg-zinc-900 dark:bg-white text-white dark:text-zinc-900 rounded-full px-6",children:[(0,s.jsx)($t,{size:18,className:"mr-2"}),"Home"]}),e[9]=f,e[10]=d,e[11]=j):j=e[11];let w;e[12]!==j||e[13]!==v?(w=(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-center gap-3",children:[v,j]}),e[12]=j,e[13]=v,e[14]=w):w=e[14];let y;return e[15]!==w||e[16]!==b||e[17]!==x||e[18]!==h?(y=(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[400px] p-8 text-center animate-in fade-in zoom-in-95 duration-300",children:[b,x,h,w]}),e[15]=w,e[16]=b,e[17]=x,e[18]=h,e[19]=y):y=e[19],y},It=Gr,Et=Q();function Qs(t){const e=(0,Et.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(ai,{"data-slot":"popover",...a}),e[2]=a,e[3]=i):i=e[3],i}function Js(t){const e=(0,Et.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(ti,{"data-slot":"popover-trigger",...a}),e[2]=a,e[3]=i):i=e[3],i}function Vs(t){const e=(0,Et.c)(12);let a,i,n,r;e[0]!==t?({className:a,align:n,sideOffset:r,...i}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n,e[4]=r):(a=e[1],i=e[2],n=e[3],r=e[4]);const l=n===void 0?"center":n,o=r===void 0?4:r;let c;e[5]!==a?(c=de("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 rounded-md border p-4 shadow-md outline-hidden",a),e[5]=a,e[6]=c):c=e[6];let m;return e[7]!==l||e[8]!==i||e[9]!==o||e[10]!==c?(m=(0,s.jsx)(fi,{children:(0,s.jsx)(bi,{"data-slot":"popover-content",align:l,sideOffset:o,className:c,...i})}),e[7]=l,e[8]=i,e[9]=o,e[10]=c,e[11]=m):m=e[11],m}var Zr=Q(),el=()=>{const t=(0,Zr.c)(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,s.jsx)(Ni,{size:16,className:"fill-blue-500 text-white ml-1 inline-block shrink-0"}),t[0]=e):e=t[0],e},it=el;const Ks=(t,e,a)=>{const i=t?.id,[n,r]=(0,g.useState)(!1),[l,o]=(0,g.useState)({followers:t?.followers||t?.follower_count||0,following:t?.following||t?.following_count||0}),[c,m]=(0,g.useState)(!1);return(0,g.useEffect)(()=>{t&&(o({followers:t.followers||t.follower_count||0,following:t.following||t.following_count||0}),i&&ke(i)&&(Ki(i).then(u=>{u&&o({followers:u.followers,following:u.following})}).catch(()=>{}),e&&ke(e)&&Qi(e,i).then(r).catch(()=>r(!1))))},[t,i,e]),{isFollowing:n,stats:l,loading:c,handleFollow:async()=>{if(!e)return a("Please login to follow!","error");if(e===i)return a("You cannot follow yourself!","error");if(!i||!ke(i)||!ke(e)){const u=!n;r(u),o(f=>{const p=typeof f.followers=="string"?parseInt(f.followers.replace(/,/g,"")):f.followers||0;return{...f,followers:u?p+1:Math.max(0,p-1)}}),a(u?"Followed":"Unfollowed");return}m(!0);try{const u=await Hi(e,i);r(u),o(f=>({...f,followers:u?(f.followers||0)+1:Math.max(0,(f.followers||0)-1)})),a(u?"Followed":"Unfollowed")}catch(u){console.error("Failed to toggle follow:",u),a("Failed to update follow status","error")}finally{m(!1)}},setStats:o}};var tl=({profile:t,onUserClick:e,isCommunity:a=!1})=>{const{onlineUsers:i}=Ms(),{currentUser:n}=pe(),{addToast:r}=Ce(),l=i.has(t.id),[o,c]=(0,g.useState)(!1),[m,d]=(0,g.useState)(a),{isFollowing:u,loading:f,handleFollow:p}=Ks(a?null:t,n?.id,r);(0,g.useEffect)(()=>{a&&n&&t.id?Ss(t.id,n.id).then(c).finally(()=>d(!1)):d(!1)},[a,n,t.id]);const b=async v=>{if(v.stopPropagation(),!n)return r("Please login to join communities","error");d(!0);try{const j=await Cs(t.id,n.id);c(j),r(j?`Joined ${t.name}`:`Left ${t.name}`)}catch{r("Failed to update membership","error")}finally{d(!1)}},x=n?.id===t.id,h=a?m:f;return(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-zinc-100 dark:border-zinc-800 hover:bg-zinc-50 dark:hover:bg-zinc-900/40 transition-colors group cursor-pointer",onClick:()=>e(t.handle),children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)(fe,{className:`size-12 border border-zinc-200 dark:border-zinc-800 shadow-sm ${a?"rounded-2xl":""}`,children:[(0,s.jsx)(xe,{src:t.avatar,alt:t.handle,className:"object-cover"}),(0,s.jsx)(he,{className:a?"rounded-2xl":"",children:t.handle?.[0]?.toUpperCase()})]}),l&&!a&&(0,s.jsx)("span",{className:"absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full shadow-sm"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white leading-none",children:t.name}),t.verified&&(0,s.jsx)(it,{})]}),(0,s.jsxs)("span",{className:"text-sm text-zinc-500 mt-0.5",children:["@",t.handle]}),a&&(0,s.jsxs)("span",{className:"text-xs text-zinc-400 mt-1",children:[t.membersCount||0," members"]}),!a&&t.followers&&(0,s.jsxs)("span",{className:"text-xs text-zinc-400 mt-1",children:[t.followers," followers"]})]})]}),!x&&(0,s.jsx)(ue,{variant:a?o?"secondary":"outline":u?"secondary":"outline",className:"!w-auto !py-1.5 !px-4 text-sm font-bold rounded-full border-zinc-200 dark:border-zinc-700 hover:bg-zinc-100 dark:hover:bg-zinc-800",onClick:a?b:v=>{v.stopPropagation(),p()},disabled:h,children:h?(0,s.jsx)(me,{size:14,className:"animate-spin"}):a?o?"Joined":"Join":u?"Following":"Follow"})]})},Xs=tl,Ys=Q();function Yt(t){const e=(0,Ys.c)(14);let a,i,n;e[0]!==t?({className:i,children:a,...n}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n):(a=e[1],i=e[2],n=e[3]);let r;e[4]!==i?(r=de("relative",i),e[4]=i,e[5]=r):r=e[5];let l;e[6]!==a?(l=(0,s.jsx)(Za,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:a}),e[6]=a,e[7]=l):l=e[7];let o,c;e[8]===Symbol.for("react.memo_cache_sentinel")?(o=(0,s.jsx)(St,{}),c=(0,s.jsx)(Va,{}),e[8]=o,e[9]=c):(o=e[8],c=e[9]);let m;return e[10]!==n||e[11]!==r||e[12]!==l?(m=(0,s.jsxs)(mi,{"data-slot":"scroll-area",className:r,...n,children:[l,o,c]}),e[10]=n,e[11]=r,e[12]=l,e[13]=m):m=e[13],m}function St(t){const e=(0,Ys.c)(13);let a,i,n;e[0]!==t?({className:a,orientation:n,...i}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n):(a=e[1],i=e[2],n=e[3]);const r=n===void 0?"vertical":n,l=r==="vertical"&&"h-full w-2.5 border-l border-l-transparent",o=r==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent";let c;e[4]!==a||e[5]!==l||e[6]!==o?(c=de("flex touch-none p-px transition-colors select-none",l,o,a),e[4]=a,e[5]=l,e[6]=o,e[7]=c):c=e[7];let m;e[8]===Symbol.for("react.memo_cache_sentinel")?(m=(0,s.jsx)(Xa,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"}),e[8]=m):m=e[8];let d;return e[9]!==r||e[10]!==i||e[11]!==c?(d=(0,s.jsx)(zi,{"data-slot":"scroll-area-scrollbar",orientation:r,className:c,...i,children:m}),e[9]=r,e[10]=i,e[11]=c,e[12]=d):d=e[12],d}var sl=Q(),al=t=>{const e=(0,sl.c)(13),{value:a,onChange:i,onClear:n,placeholder:r}=t,l=r===void 0?"Search...":r;let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=(0,s.jsx)(ps,{size:18,className:"absolute left-4 top-1/2 -translate-y-1/2 text-zinc-400 group-focus-within:text-violet-500 transition-colors"}),e[0]=o):o=e[0];let c;e[1]!==i?(c=f=>i(f.target.value),e[1]=i,e[2]=c):c=e[2];let m;e[3]!==l||e[4]!==c||e[5]!==a?(m=(0,s.jsx)("input",{className:"w-full rounded-full border border-zinc-100 dark:border-zinc-800 bg-zinc-50 dark:bg-zinc-900/50 text-zinc-900 dark:text-white px-11 py-2.5 text-sm outline-none focus:border-violet-500 focus:ring-1 focus:ring-violet-500 transition-all",placeholder:l,value:a,onChange:c}),e[3]=l,e[4]=c,e[5]=a,e[6]=m):m=e[6];let d;e[7]!==n||e[8]!==a?(d=a&&(0,s.jsx)("button",{onClick:n,className:"absolute right-4 top-1/2 -translate-y-1/2 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 transition-colors",children:(0,s.jsx)(_e,{size:16})}),e[7]=n,e[8]=a,e[9]=d):d=e[9];let u;return e[10]!==m||e[11]!==d?(u=(0,s.jsxs)("div",{className:"relative group w-full",children:[o,m,d]}),e[10]=m,e[11]=d,e[12]=u):u=e[12],u},ft=al,il=Q(),nl=t=>{const e=(0,il.c)(9),{className:a}=t,{setAuthMode:i}=pe();let n;e[0]!==a?(n=de("border border-[--border] rounded-2xl p-8 flex flex-col items-center text-center gap-4 bg-[--card] shadow-sm",a),e[0]=a,e[1]=n):n=e[1];let r,l;e[2]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"size-16 rounded-full border-4 border-amber-400 border-t-transparent animate-spin duration-[3000ms]"}),(0,s.jsx)("span",{className:"absolute inset-0 flex items-center justify-center text-2xl",children:""})]}),l=(0,s.jsx)("h3",{className:"font-extrabold text-lg text-[--foreground] mt-2 leading-tight",children:"Get your Sysm account now!"}),e[2]=r,e[3]=l):(r=e[2],l=e[3]);let o;e[4]!==i?(o=(0,s.jsx)("button",{onClick:()=>i("signup"),className:"w-full bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 py-2.5 rounded-full font-black text-sm uppercase tracking-wider hover:opacity-90 active:scale-95 transition-all shadow-lg cursor-pointer",children:"Signup now"}),e[4]=i,e[5]=o):o=e[5];let c;return e[6]!==n||e[7]!==o?(c=(0,s.jsxs)("div",{className:n,children:[r,l,o]}),e[6]=n,e[7]=o,e[8]=c):c=e[8],c},Gs=nl,rl=Q(),ll=()=>{const t=(0,rl.c)(3);let e;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,s.jsx)("div",{className:"size-11 rounded-full bg-zinc-200 dark:bg-zinc-800 shrink-0"}),t[0]=e):e=t[0];let a;t[1]===Symbol.for("react.memo_cache_sentinel")?(a=(0,s.jsx)("div",{className:"h-4 bg-zinc-200 dark:bg-zinc-800 rounded w-1/3"}),t[1]=a):a=t[1];let i;return t[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsx)("div",{className:"px-5 pt-4 pb-3 border-b border-zinc-100 dark:border-zinc-800 animate-pulse",children:(0,s.jsxs)("div",{className:"flex items-start gap-x-3",children:[e,(0,s.jsxs)("div",{className:"flex-1 space-y-3",children:[a,(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"h-3 bg-zinc-200 dark:bg-zinc-800 rounded w-full"}),(0,s.jsx)("div",{className:"h-3 bg-zinc-200 dark:bg-zinc-800 rounded w-5/6"})]}),(0,s.jsx)("div",{className:"h-48 bg-zinc-200 dark:bg-zinc-800 rounded-xl w-full"})]})]})}),t[2]=i):i=t[2],i},qt=ll,gt=Q();function ol(t){const e=(0,gt.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=de("flex flex-col gap-2",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(hi,{"data-slot":"tabs",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function cl(t){const e=(0,gt.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=de("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(Ja,{"data-slot":"tabs-list",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function dl(t){const e=(0,gt.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=de("inline-flex items-center justify-center gap-1.5 px-2 py-1 text-sm font-medium whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 outline-none focus:outline-none focus-visible:outline-none ring-0 focus:ring-0 focus-visible:ring-0 shadow-none data-[state=active]:shadow-none",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(ji,{"data-slot":"tabs-trigger",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function zt(t){const e=(0,gt.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=de("flex-1 outline-none",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(ii,{"data-slot":"tabs-content",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var ml=Q();function ul(t){const e=(0,ml.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=de("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)("textarea",{"data-slot":"textarea",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var fl=Q(),xl=t=>{const e=(0,fl.c)(7),{className:a}=t;let i;e[0]!==a?(i=de("flex items-center gap-1 px-1 py-1.5",a),e[0]=a,e[1]=i):i=e[1];let n,r,l;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,s.jsx)("div",{className:"size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse"}),r=(0,s.jsx)("div",{className:"size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse [animation-delay:0.2s]"}),l=(0,s.jsx)("div",{className:"size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse [animation-delay:0.4s]"}),e[2]=n,e[3]=r,e[4]=l):(n=e[2],r=e[3],l=e[4]);let o;return e[5]!==i?(o=(0,s.jsxs)("div",{className:i,children:[n,r,l]}),e[5]=i,e[6]=o):o=e[6],o},hl=xl,pl=Q(),bl=()=>{const t=(0,pl.c)(48),{currentUser:e,setAuthMode:a}=pe(),{darkMode:i,toggleDarkMode:n}=Mt(),[r,l]=(0,g.useState)(""),o=je();let c;t[0]===Symbol.for("react.memo_cache_sentinel")?(c={queryKey:["trending-hashtags"],queryFn:vl,refetchInterval:6e4},t[0]=c):c=t[0];const{data:m}=Pe(c);let d;t[1]!==m?(d=m===void 0?[]:m,t[1]=m,t[2]=d):d=t[2];const u=d;let f;t[3]===Symbol.for("react.memo_cache_sentinel")?(f=[" 2026 Sysm","Terms","Privacy","Guidelines","Discord","Sysm","GitHub","Support","Status"],t[3]=f):f=t[3];const p=f;let b;t[4]!==i?(b=i?(0,s.jsx)(ki,{size:20}):(0,s.jsx)(Si,{size:20}),t[4]=i,t[5]=b):b=t[5];let x;t[6]!==b||t[7]!==n?(x=(0,s.jsx)("button",{onClick:n,className:"p-3 rounded-full bg-zinc-50 dark:bg-zinc-900 text-zinc-500 dark:text-zinc-400 border border-zinc-100 dark:border-zinc-800 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-all cursor-pointer",title:"Toggle Theme",children:b}),t[6]=b,t[7]=n,t[8]=x):x=t[8];const h=x;if(e){let P;t[9]===Symbol.for("react.memo_cache_sentinel")?(P=()=>l(""),t[9]=P):P=t[9];let R;t[10]!==r?(R=(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(ft,{value:r,onChange:l,onClear:P})}),t[10]=r,t[11]=R):R=t[11];let L;t[12]!==R||t[13]!==h?(L=(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[R,h]}),t[12]=R,t[13]=h,t[14]=L):L=t[14];let T;t[15]===Symbol.for("react.memo_cache_sentinel")?(T=(0,s.jsx)("h3",{className:"font-extrabold text-xl mb-4 px-2 text-[--foreground]",children:"What's happening"}),t[15]=T):T=t[15];let D;if(t[16]!==o||t[17]!==u){let q;t[19]!==o?(q=B=>(0,s.jsxs)("div",{onClick:()=>o(`/community?q=${encodeURIComponent(B.name)}`),className:"px-3 py-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-xl cursor-pointer transition-colors group",children:[(0,s.jsx)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400 font-medium",children:"Trending"}),(0,s.jsx)("div",{className:"font-bold text-[--foreground]",children:B.name}),(0,s.jsxs)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:[B.usage_count," posts"]})]},B.id),t[19]=o,t[20]=q):q=t[20],D=u.map(q),t[16]=o,t[17]=u,t[18]=D}else D=t[18];let C;t[21]!==u.length?(C=u.length===0&&(0,s.jsx)("p",{className:"text-sm text-zinc-500 px-2",children:"No trends yet"}),t[21]=u.length,t[22]=C):C=t[22];let _;t[23]!==D||t[24]!==C?(_=(0,s.jsxs)("div",{className:"bg-zinc-50 dark:bg-zinc-900 rounded-2xl p-4 border border-[--border]",children:[T,(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[D,C]})]}),t[23]=D,t[24]=C,t[25]=_):_=t[25];let z;t[26]===Symbol.for("react.memo_cache_sentinel")?(z=(0,s.jsx)("div",{className:"flex flex-wrap gap-x-4 gap-y-2 px-2 text-[13px] text-zinc-500 font-medium pb-5",children:p.map(jl)}),t[26]=z):z=t[26];let $;return t[27]!==_||t[28]!==L?($=(0,s.jsxs)("aside",{className:"sticky top-5 hidden w-[320px] shrink-0 flex-col gap-y-6 lg:flex overflow-y-auto max-h-screen",children:[L,_,z]}),t[27]=_,t[28]=L,t[29]=$):$=t[29],$}let v,j;t[30]!==a?(v=(0,s.jsx)("button",{onClick:()=>a("signup"),className:"flex-1 bg-[--card] border border-[--border] py-2.5 rounded-full font-bold text-[--foreground] hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors shadow-sm cursor-pointer",children:"Signup"}),j=()=>a("login"),t[30]=a,t[31]=v,t[32]=j):(v=t[31],j=t[32]);let w;t[33]===Symbol.for("react.memo_cache_sentinel")?(w=(0,s.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",alt:"",className:"size-4 rounded-sm"}),t[33]=w):w=t[33];let y;t[34]!==j?(y=(0,s.jsxs)("button",{onClick:j,className:"flex-1 bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 py-2.5 rounded-full font-bold flex items-center justify-center gap-2 hover:opacity-90 transition-opacity cursor-pointer",children:[w,"Login"]}),t[34]=j,t[35]=y):y=t[35];let k;t[36]!==v||t[37]!==y||t[38]!==h?(k=(0,s.jsxs)("div",{className:"flex gap-3",children:[v,y,h]}),t[36]=v,t[37]=y,t[38]=h,t[39]=k):k=t[39];let S;t[40]===Symbol.for("react.memo_cache_sentinel")?(S=()=>l(""),t[40]=S):S=t[40];let M;t[41]!==r?(M=(0,s.jsx)(ft,{value:r,onChange:l,onClear:S}),t[41]=r,t[42]=M):M=t[42];let E;t[43]===Symbol.for("react.memo_cache_sentinel")?(E=(0,s.jsx)(Gs,{}),t[43]=E):E=t[43];let F;t[44]===Symbol.for("react.memo_cache_sentinel")?(F=(0,s.jsx)("div",{className:"flex flex-wrap gap-x-4 gap-y-2 px-2 text-[13px] text-zinc-500 font-medium pb-5",children:p.map(yl)}),t[44]=F):F=t[44];let N;return t[45]!==k||t[46]!==M?(N=(0,s.jsxs)("aside",{className:"sticky top-5 hidden w-[350px] shrink-0 flex-col gap-y-6 lg:flex pr-4",children:[k,M,E,F]}),t[45]=k,t[46]=M,t[47]=N):N=t[47],N},gl=bl;function vl(){return Pn(5)}function jl(t){return(0,s.jsx)("a",{href:"#",className:"hover:underline",children:t},t)}function yl(t){return(0,s.jsx)("a",{href:"#",className:"hover:underline",children:t},t)}var Pc=Q(),wl=({isOpen:t,onClose:e})=>{const{currentUser:a}=pe(),{addToast:i}=Ce(),n=je(),[r,l]=(0,g.useState)({name:"",handle:"",description:"",isPrivate:!1}),[o,c]=(0,g.useState)(!1),m=async d=>{if(d.preventDefault(),!(!r.name||!r.handle||!a)){c(!0);try{const u=await _n({name:r.name,handle:r.handle.toLowerCase().replace(/\s+/g,"-"),description:r.description,is_private:r.isPrivate,creator_id:a.id}),{error:f}=await O.from("community_members").insert([{community_id:u.id,user_id:a.id,role:"admin"}]);if(f)throw f;i(`Community "${u.name}" created!`),e(),n(`/c/${u.handle}`)}catch(u){console.error(u),i(u.message||"Failed to create community","error")}finally{c(!1)}}};return(0,s.jsx)(tt,{isOpen:t,onClose:()=>!o&&e(),title:"Create Community",className:"sm:max-w-md",children:(0,s.jsxs)("form",{onSubmit:m,className:"space-y-5",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center p-6 bg-zinc-50 dark:bg-zinc-900 rounded-2xl border-2 border-dashed border-zinc-200 dark:border-zinc-800",children:[(0,s.jsx)("div",{className:"size-20 rounded-2xl bg-white dark:bg-black flex items-center justify-center shadow-sm mb-3",children:(0,s.jsx)(Ge,{size:32,className:"text-violet-600"})}),(0,s.jsx)("p",{className:"text-xs font-medium text-zinc-500 text-center max-w-[200px]",children:"Communities are where people with shared interests connect."})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("label",{className:"text-sm font-bold ml-1",children:"Community Name"}),(0,s.jsx)("input",{type:"text",required:!0,className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all",placeholder:"e.g. Photography Enthusiasts",value:r.name,onChange:d=>l({...r,name:d.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("label",{className:"text-sm font-bold ml-1",children:"Handle"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-zinc-500 font-medium",children:"c/"}),(0,s.jsx)("input",{type:"text",required:!0,className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl pl-8 pr-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all",placeholder:"photography",value:r.handle,onChange:d=>l({...r,handle:d.target.value.toLowerCase().replace(/[^a-z0-9-]/g,"")})})]})]}),(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("label",{className:"text-sm font-bold ml-1",children:"Description (Optional)"}),(0,s.jsx)("textarea",{className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all min-h-[100px] resize-none",placeholder:"What is this community about?",value:r.description,onChange:d=>l({...r,description:d.target.value})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-zinc-50 dark:bg-zinc-900 rounded-xl border border-zinc-200 dark:border-zinc-800",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-sm font-bold",children:"Private Community"}),(0,s.jsx)("span",{className:"text-[10px] text-zinc-500",children:"Only Admins can post in private communities"})]}),(0,s.jsx)("input",{type:"checkbox",className:"size-5 rounded-md accent-violet-600 cursor-pointer",checked:r.isPrivate,onChange:d=>l({...r,isPrivate:d.target.checked})})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,s.jsx)(ue,{type:"button",variant:"outline",className:"flex-1",onClick:e,disabled:o,children:"Cancel"}),(0,s.jsx)(ue,{type:"submit",className:"flex-1",disabled:o||!r.name||!r.handle,children:o?(0,s.jsx)(me,{size:18,className:"animate-spin"}):"Create"})]})]})})},Nl=wl,zl=({isOpen:t,onClose:e,initialCommunity:a})=>{const{currentUser:i}=pe(),{addPost:n}=bt(),{addToast:r}=Ce(),[l,o]=(0,g.useState)(""),[c,m]=(0,g.useState)([]),[d,u]=(0,g.useState)({}),[f,p]=(0,g.useState)(!1),[b,x]=(0,g.useState)({options:["",""],duration:"1 day"}),[h,v]=(0,g.useState)(!1),[j,w]=(0,g.useState)(null);(0,g.useEffect)(()=>{w(a||null)},[a,t]);const{data:y=[]}=Pe({queryKey:["user-communities",i?.id],queryFn:()=>kn(i?.id),enabled:!!i?.id}),k=(0,g.useRef)(null),S=(0,g.useRef)(null),[M,E]=(0,g.useState)(null),F=C=>{const _=Array.from(C.target.files);m(z=>[...z,..._])},N=C=>{const _=C.target.files[0];_&&M!==null&&u(z=>({...z,[M]:_})),E(null)},P=C=>{m(z=>z.filter(($,q)=>q!==C));const _={...d};delete _[C],u(_)},R=()=>{b.options.length<4&&x(C=>({...C,options:[...C.options,""]}))},L=C=>{x(_=>({..._,options:_.options.filter((z,$)=>$!==C)}))},T=(C,_)=>{const z=[...b.options];z[C]=_,x($=>({...$,options:z}))},D=async C=>{if(C.preventDefault(),!(!l.trim()&&c.length===0||!i)){v(!0);try{const _=[];for(let $=0;$<c.length;$++){const q=c[$],B=await Me(q,"media",d[$]||null);_.push(B)}let z=null;f&&b.options.some($=>$.trim())&&(z={options:b.options.filter($=>$.trim()).map(($,q)=>({id:q+1,text:$,votes:0})),ends_at:new Date(Date.now()+1440*60*1e3).toISOString()}),await n({content:l,media:_,poll:z,type:_.length>0?_[0].type==="video"?"video":"image":z?"poll":"text",userId:i.id,communityId:j?.id||null}),o(""),m([]),p(!1),x({options:["",""],duration:"1 day"}),w(null),e(),r("Post published!")}catch(_){console.error("Failed to create post:",_),r("Failed to publish post.")}finally{v(!1)}}};return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(tt,{isOpen:t,onClose:()=>!h&&e(),title:"Create Post",className:"sm:max-w-xl",footer:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,s.jsxs)("div",{className:"flex text-violet-600 gap-1",children:[(0,s.jsx)("button",{type:"button",onClick:()=>k.current?.click(),className:"p-2.5 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full transition-colors",title:"Attach media",children:(0,s.jsx)(ds,{size:22})}),(0,s.jsx)("button",{type:"button",onClick:()=>p(!0),className:"p-2.5 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full transition-colors",title:"Add poll",children:(0,s.jsx)(Sa,{size:22})}),(0,s.jsx)("button",{type:"button",className:"p-2.5 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full transition-colors",children:(0,s.jsx)(rs,{size:22})}),(0,s.jsx)("input",{type:"file",ref:k,onChange:F,multiple:!0,className:"hidden",accept:"image/*,video/*,application/pdf"}),(0,s.jsx)("input",{type:"file",ref:S,onChange:N,className:"hidden",accept:"image/*"})]}),(0,s.jsx)(ue,{onClick:D,disabled:!l.trim()&&c.length===0||h,className:"px-8 py-2.5 min-w-[100px] text-base",children:h?(0,s.jsx)(me,{size:18,className:"animate-spin"}):"Post"})]}),children:(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)(fe,{className:"size-12 border border-zinc-200 dark:border-zinc-800",children:[(0,s.jsx)(xe,{src:i?.avatar,className:"object-cover"}),(0,s.jsx)(he,{children:i?.handle?.[0]?.toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"mb-2",children:(0,s.jsxs)(Bs,{children:[(0,s.jsx)(Ws,{asChild:!0,children:(0,s.jsx)("button",{className:"flex items-center gap-1.5 px-3 py-1 rounded-full border border-zinc-200 dark:border-zinc-800 text-xs font-bold text-violet-600 dark:text-violet-400 hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors",children:j?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Ge,{size:14}),(0,s.jsx)("span",{children:j.name})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(mt,{size:14}),(0,s.jsx)("span",{children:"Everyone"})]})})}),(0,s.jsxs)(Us,{align:"start",className:"w-56 rounded-xl",children:[(0,s.jsxs)(Ke,{onClick:()=>w(null),className:"gap-2 py-2.5 cursor-pointer",children:[(0,s.jsx)(mt,{size:16,className:"text-zinc-500"}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"font-bold text-sm",children:"Everyone"}),(0,s.jsx)("span",{className:"text-[10px] text-zinc-500",children:"Post to your public feed"})]})]}),y.filter(C=>!C.isPrivate||C.myRole==="admin").map(C=>(0,s.jsxs)(Ke,{onClick:()=>w(C),className:"gap-2 py-2.5 cursor-pointer",children:[(0,s.jsxs)(fe,{className:"size-6",children:[(0,s.jsx)(xe,{src:C.avatar}),(0,s.jsx)(he,{children:C.name[0]})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"font-bold text-sm",children:C.name}),(0,s.jsx)("span",{className:"text-[10px] text-zinc-500",children:"Post to community"})]})]},C.id))]})]})}),(0,s.jsx)("textarea",{className:"w-full bg-transparent border-none outline-none text-lg min-h-[120px] resize-none dark:text-white",placeholder:"What's happening?",autoFocus:!0,value:l,onChange:C=>o(C.target.value)}),f&&(0,s.jsxs)("div",{className:"mt-4 p-4 rounded-2xl space-y-3 bg-zinc-50/50 dark:bg-zinc-900/50",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsx)("span",{className:"text-sm font-bold opacity-60",children:"Poll"}),(0,s.jsx)("button",{type:"button",onClick:()=>p(!1),className:"text-zinc-500 hover:text-rose-500",children:(0,s.jsx)(_e,{size:18})})]}),b.options.map((C,_)=>(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{className:"flex-1 bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-xl px-4 py-2 text-sm outline-none focus:border-violet-500",placeholder:`Option ${_+1}`,value:C,onChange:z=>T(_,z.target.value)}),b.options.length>2&&(0,s.jsx)("button",{type:"button",onClick:()=>L(_),className:"p-2 text-rose-500 hover:bg-rose-50 dark:hover:bg-rose-900/20 rounded-lg transition-colors",children:(0,s.jsx)(bs,{size:16})})]},_)),b.options.length<4&&(0,s.jsx)("button",{type:"button",onClick:R,className:"text-sm font-bold text-violet-600 hover:bg-violet-50 dark:hover:bg-violet-900/20 px-3 py-1.5 rounded-lg transition-colors",children:"+ Add option"})]}),c.length>0&&(0,s.jsx)("div",{className:"mt-4 flex flex-wrap gap-2",children:c.map((C,_)=>(0,s.jsxs)("div",{className:"relative group size-24 rounded-xl overflow-hidden bg-zinc-100 dark:bg-zinc-800 shadow-sm",children:[C.type.startsWith("image/")?(0,s.jsx)("img",{src:URL.createObjectURL(C),className:"size-full object-cover",alt:""}):(0,s.jsx)("div",{className:"size-full flex flex-col items-center justify-center text-zinc-500 bg-zinc-100 dark:bg-zinc-800",children:C.type.startsWith("video/")?(0,s.jsxs)(s.Fragment,{children:[d[_]?(0,s.jsx)("img",{src:URL.createObjectURL(d[_]),className:"size-full object-cover",alt:"Custom thumbnail"}):(0,s.jsx)(Oe,{size:24,className:"animate-pulse"}),(0,s.jsx)("button",{type:"button",onClick:()=>{E(_),S.current?.click()},className:"absolute inset-x-0 bottom-0 bg-black/60 text-white text-[10px] font-bold py-1 backdrop-blur-sm hover:bg-black transition-colors",children:d[_]?"Change Thumbnail":"Add Thumbnail"})]}):(0,s.jsx)(ns,{size:24})}),(0,s.jsx)("button",{type:"button",onClick:()=>P(_),className:"absolute top-1 right-1 size-6 rounded-full bg-black/60 text-white flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)(_e,{size:14,strokeWidth:3})})]},_))})]})]})})})})},kl=zl,_l=({isOpen:t,onClose:e})=>{const{currentUser:a}=pe(),{addToast:i}=Ce(),n=pt(),[r,l]=(0,g.useState)(null),[o,c]=(0,g.useState)(!1),[m,d]=(0,g.useState)(null),u=(0,g.useRef)(null),f=h=>{const v=h.target.files[0];v&&l(v)},p=()=>{if(!r)return;const h=new FileReader;h.onload=()=>{d(h.result)},h.readAsDataURL(r)},b=h=>{l(new File([h],`story-cropped-${Date.now()}.jpg`,{type:"image/jpeg"})),d(null)},x=async()=>{if(!(!r||!a)){c(!0);try{const h=await Me(r);await yn(a.id,h.url,h.type),l(null),e(),i("Story shared!"),n.invalidateQueries(["stories"])}catch(h){console.error("Failed to create story:",h),i("Failed to share story.")}finally{c(!1)}}};return(0,s.jsxs)(tt,{isOpen:t,onClose:()=>!o&&e(),title:"Add Story",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[r?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"relative aspect-[9/16] w-full max-w-[280px] mx-auto rounded-3xl overflow-hidden shadow-2xl",children:[(0,s.jsx)("img",{src:URL.createObjectURL(r),className:"w-full h-full object-cover",alt:"Preview"}),(0,s.jsx)("button",{onClick:()=>l(null),className:"absolute top-4 right-4 p-2 bg-black/50 text-white rounded-full hover:bg-rose-500 transition-colors",title:"Remove",children:(0,s.jsx)(_e,{size:20})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-center gap-4 py-2 bg-zinc-50/50 dark:bg-zinc-900/50 rounded-2xl",children:[(0,s.jsxs)("button",{onClick:p,className:"flex flex-col items-center gap-1.5 p-3 rounded-xl hover:bg-white dark:hover:bg-zinc-800 transition-all text-zinc-600 dark:text-zinc-400 hover:text-violet-600 dark:hover:text-violet-400 group",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm group-hover:shadow-md transition-all",children:(0,s.jsx)(xs,{size:20})}),(0,s.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Crop / Edit"})]}),(0,s.jsxs)("button",{className:"flex flex-col items-center gap-1.5 p-3 rounded-xl opacity-40 cursor-not-allowed text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm",children:(0,s.jsx)("svg",{size:20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:(0,s.jsx)("path",{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 21 3 22l1-4.5L17 3z"})})}),(0,s.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Text"})]}),(0,s.jsxs)("button",{className:"flex flex-col items-center gap-1.5 p-3 rounded-xl opacity-40 cursor-not-allowed text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm",children:(0,s.jsxs)("svg",{size:20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[(0,s.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,s.jsx)("path",{d:"M8 14s1.5 2 4 2 4-2 4-2"}),(0,s.jsx)("line",{x1:"9",y1:"9",x2:"9.01",y2:"9"}),(0,s.jsx)("line",{x1:"15",y1:"9",x2:"15.01",y2:"9"})]})}),(0,s.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Stickers"})]})]})]}):(0,s.jsxs)("div",{className:"py-10",children:[(0,s.jsxs)("div",{className:"relative w-full group",onClick:()=>u.current?.click(),children:[(0,s.jsx)("div",{className:"relative z-40 cursor-pointer group-hover:translate-x-8 group-hover:shadow-2xl group-hover:-translate-y-8 transition-all duration-500 bg-zinc-900 dark:bg-white flex items-center justify-center h-32 w-32 mx-auto rounded-xl border-4 border-white dark:border-zinc-900",children:(0,s.jsxs)("svg",{className:"h-8 w-8 text-white/60 dark:text-zinc-950/60",strokeLinejoin:"round",strokeLinecap:"round",strokeWidth:"2",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2"}),(0,s.jsx)("path",{d:"M7 9l5 -5l5 5"}),(0,s.jsx)("path",{d:"M12 4l0 12"})]})}),(0,s.jsx)("div",{className:"absolute border-2 opacity-0 group-hover:opacity-80 transition-all duration-300 border-dashed border-violet-500 inset-0 z-30 bg-transparent flex items-center justify-center h-32 w-32 mx-auto rounded-xl"})]}),(0,s.jsxs)("div",{className:"text-center mt-8",children:[(0,s.jsx)("p",{className:"font-bold dark:text-white",children:"Choose a photo"}),(0,s.jsx)("p",{className:"text-sm text-zinc-500",children:"Stories last for 24 hours"})]})]}),(0,s.jsx)("input",{type:"file",ref:u,onChange:f,className:"hidden",accept:"image/*"}),(0,s.jsx)(ue,{className:"w-full py-3 text-lg",disabled:!r||o,onClick:x,children:o?(0,s.jsx)(me,{size:24,className:"animate-spin mx-auto"}):"Share story"})]}),m&&(0,s.jsx)(Ar,{src:m,isOpen:!!m,onClose:()=>d(null),onCropComplete:b,aspect:9/16})]})},Cl=_l;function Sl({isOpen:t,onClose:e,community:a,onUpdate:i}){const{addToast:n}=Ce(),{currentUser:r}=pe(),[l,o]=(0,g.useState)({name:"",handle:"",description:"",avatar:"",cover:"",isPrivate:!1}),[c,m]=(0,g.useState)(!1),[d,u]=(0,g.useState)([]),[f,p]=(0,g.useState)(!1),[b,x]=(0,g.useState)(""),[h,v]=(0,g.useState)(!1),j=r?.id===a?.creatorId,w=(0,g.useRef)(null),y=(0,g.useRef)(null);(0,g.useEffect)(()=>{a&&t&&(o({name:a.name||"",handle:a.handle||"",description:a.description||"",avatar:a.avatar||"",cover:a.cover||"",isPrivate:a.isPrivate||!1}),x(""),u([]),v(!1))},[a,t,j]);const k=async(N="")=>{if(!(!N&&!j)){p(!0),v(!0);try{u(await Sn(a.id,N))}catch(P){console.error("Failed to load members:",P)}finally{p(!1)}}};(0,g.useEffect)(()=>{if(b.length>=2){const N=setTimeout(()=>{k(b)},500);return()=>clearTimeout(N)}else b.length===0&&(u([]),v(!1))},[b]);const S=async(N,P)=>{const R=P==="admin"?"member":"admin";try{await $n(a.id,N,R),u(L=>L.map(T=>T.userId===N?{...T,role:R}:T)),n(`Role updated to ${R}`)}catch{n("Failed to update role","error")}},M=(N,P)=>{const R=N.target.files[0];R&&E(R,P)},E=async(N,P)=>{m(!0);try{const R=await Me(N);o(L=>({...L,[P]:R.url})),n(`${P.charAt(0).toUpperCase()+P.slice(1)} uploaded!`)}catch{n(`Failed to upload ${P}`,"error")}finally{m(!1)}},F=async N=>{if(N.preventDefault(),!(!l.name||!l.handle||!a)){m(!0);try{const P=await Cn(a.id,{name:l.name,handle:l.handle.toLowerCase().replace(/[^a-z0-9-]/g,""),description:l.description,avatar_url:l.avatar,cover_url:l.cover,is_private:l.isPrivate});n("Community updated successfully!"),i&&i(P),e()}catch(P){console.error(P),n(P.message||"Failed to update community","error")}finally{m(!1)}}};return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(tt,{isOpen:t,onClose:()=>!c&&e(),title:"Edit Community",className:"sm:max-w-xl",children:[(0,s.jsxs)("div",{className:"space-y-6 max-h-[85vh] overflow-y-auto px-1",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("div",{className:"h-32 sm:h-40 bg-zinc-100 dark:bg-zinc-900 rounded-xl overflow-hidden relative group",children:[l.cover&&(0,s.jsx)("img",{src:l.cover,className:"w-full h-full object-cover",alt:""}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black/20 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)("button",{onClick:()=>y.current?.click(),className:"p-3 bg-black/60 text-white rounded-full hover:bg-black transition-all",children:(0,s.jsx)(At,{size:20})})})]}),(0,s.jsx)("div",{className:"absolute -bottom-8 left-6",children:(0,s.jsxs)("div",{className:"relative group size-20 sm:size-24 rounded-2xl border-4 border-white dark:border-black bg-zinc-100 dark:bg-zinc-800 overflow-hidden shadow-lg",children:[(0,s.jsx)("img",{src:l.avatar,className:"size-full object-cover",alt:""}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)("button",{onClick:()=>w.current?.click(),className:"text-white p-2",children:(0,s.jsx)(At,{size:18})})})]})})]}),(0,s.jsx)("div",{className:"pt-6",children:(0,s.jsxs)("form",{onSubmit:F,className:"space-y-5",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("label",{className:"text-sm font-bold ml-1",children:"Community Name"}),(0,s.jsx)("input",{type:"text",required:!0,className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all font-medium",value:l.name,onChange:N=>o({...l,name:N.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("label",{className:"text-sm font-bold ml-1 text-rose-500",children:"Handle (Experimental)"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-zinc-500 font-medium text-sm",children:"c/"}),(0,s.jsx)("input",{type:"text",required:!0,className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl pl-8 pr-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all font-medium text-sm",value:l.handle,onChange:N=>o({...l,handle:N.target.value})})]})]}),(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("label",{className:"text-sm font-bold ml-1",children:"Description"}),(0,s.jsx)("textarea",{className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all min-h-[100px] resize-none font-medium",placeholder:"What is this community about?",value:l.description,onChange:N=>o({...l,description:N.target.value})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-zinc-50 dark:bg-zinc-900 rounded-xl border border-zinc-200 dark:border-zinc-800",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-sm font-bold",children:"Private Community"}),(0,s.jsx)("span",{className:"text-[10px] text-zinc-500",children:"Only Admins can post in private communities"})]}),(0,s.jsx)("input",{type:"checkbox",className:"size-5 rounded-md accent-violet-600 cursor-pointer",checked:l.isPrivate,onChange:N=>o({...l,isPrivate:N.target.checked})})]}),j&&(0,s.jsxs)("div",{className:"space-y-4 pt-4 border-t border-zinc-100 dark:border-zinc-800",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-1 px-1",children:[(0,s.jsx)("span",{className:"text-sm font-bold",children:"Manage Members"}),(0,s.jsx)("span",{className:"text-[10px] text-zinc-500",children:"Search for members to manage their roles"})]}),(0,s.jsx)("div",{className:"px-1",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(Ct,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-zinc-400",size:16}),(0,s.jsx)("input",{type:"text",placeholder:"Search members by name or handle...",className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl pl-10 pr-4 py-2 text-sm outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all font-medium",value:b,onChange:N=>x(N.target.value),onKeyDown:N=>{N.key==="Enter"&&(N.preventDefault(),N.stopPropagation())}})]})}),h&&(0,s.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 rounded-xl border border-zinc-200 dark:border-zinc-800 overflow-hidden max-h-[300px] overflow-y-auto mt-2",children:f?(0,s.jsx)("div",{className:"p-8 flex justify-center",children:(0,s.jsx)(me,{className:"animate-spin text-violet-500"})}):d.length===0?(0,s.jsxs)("div",{className:"p-8 text-center text-sm text-zinc-500 font-medium",children:['No results found for "',b,'"']}):(0,s.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:d.map(N=>(0,s.jsxs)("div",{className:"p-3 flex items-center justify-between hover:bg-zinc-100/50 dark:hover:bg-zinc-800/50 transition-colors",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)(fe,{className:"size-9 border border-zinc-200 dark:border-zinc-700",children:[(0,s.jsx)(xe,{src:N.user.avatar_url}),(0,s.jsx)(he,{children:N.user.username?.[0]?.toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex flex-col min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("span",{className:"text-sm font-bold truncate max-w-[120px]",children:N.user.display_name}),N.user.is_verified&&(0,s.jsx)(it,{})]}),(0,s.jsxs)("span",{className:"text-xs text-zinc-500",children:["@",N.user.username]})]})]}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:N.userId===a.creatorId?(0,s.jsx)("span",{className:"text-[10px] font-bold px-2.5 py-1 bg-zinc-200 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 rounded-full",children:"OWNER"}):(0,s.jsx)("button",{type:"button",onClick:()=>S(N.userId,N.role),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-full text-[11px] font-bold transition-all ${N.role==="admin"?"bg-rose-50 text-rose-600 hover:bg-rose-100 dark:bg-rose-950/20 dark:text-rose-400":"bg-zinc-100 text-zinc-600 hover:bg-zinc-200 dark:bg-zinc-800 dark:text-zinc-400 dark:hover:bg-zinc-700"}`,children:N.role==="admin"?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ei,{size:14}),"Remove Admin"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Ct,{size:14}),"Make Admin"]})})})]},N.userId))})})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 pt-6 py-2",children:[(0,s.jsx)(ue,{type:"button",variant:"outline",className:"flex-1 rounded-xl h-11 font-bold",onClick:e,disabled:c,children:"Cancel"}),(0,s.jsx)(ue,{type:"submit",className:"flex-1 rounded-xl h-11 font-bold bg-zinc-900 dark:bg-white text-white dark:text-black hover:bg-zinc-800 dark:hover:bg-zinc-200 transition-all active:scale-95",disabled:c||!l.name,children:c?(0,s.jsx)(me,{size:18,className:"animate-spin"}):"Save Changes"})]})]})})]}),(0,s.jsx)("input",{type:"file",ref:w,className:"hidden",accept:"image/*",onChange:N=>M(N,"avatar")}),(0,s.jsx)("input",{type:"file",ref:y,className:"hidden",accept:"image/*",onChange:N=>M(N,"cover")})]})})}var $l=({isOpen:t,onClose:e,editProfileData:a,setEditProfileData:i})=>{const{updateProfile:n}=pe(),{addToast:r}=Ce(),[l,o]=(0,g.useState)(!1),[c,m]=(0,g.useState)(null),[d,u]=(0,g.useState)(null),f=(0,g.useRef)(null),p=(0,g.useRef)(null),b=(h,v)=>{const j=h.target.files[0];j&&(v==="avatar"?m(j):u(j))},x=async()=>{o(!0);try{let h=a.avatar,v=a.cover;c&&(h=(await Me(c)).url),d&&(v=(await Me(d)).url),await n({...a,avatar:h,cover:v}),m(null),u(null),e(),r("Profile updated!")}catch(h){console.error("Failed to update profile:",h),r("Failed to update profile.","error")}finally{o(!1)}};return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(tt,{isOpen:t,onClose:()=>!l&&e(),title:"Edit Profile",children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("input",{type:"file",ref:p,className:"hidden",accept:"image/*",onChange:h=>b(h,"cover")}),(0,s.jsx)("input",{type:"file",ref:f,className:"hidden",accept:"image/*",onChange:h=>b(h,"avatar")}),(0,s.jsxs)("div",{className:"relative h-32 bg-zinc-100 dark:bg-zinc-800 rounded-xl overflow-hidden group cursor-pointer",onClick:()=>p.current?.click(),children:[(d||a?.cover)&&(0,s.jsx)("img",{src:d?URL.createObjectURL(d):a.cover,className:"w-full h-full object-cover opacity-60",alt:""}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("div",{className:"bg-black/50 p-2 rounded-full text-white group-hover:scale-110 transition-transform",children:(0,s.jsx)(Oe,{size:20})})})]}),(0,s.jsx)("div",{className:"relative -mt-16 ml-4",children:(0,s.jsxs)("div",{className:"relative size-24 rounded-full border-4 border-white dark:border-black overflow-hidden group cursor-pointer shadow-lg bg-white dark:bg-black",onClick:()=>f.current?.click(),children:[(c||a?.avatar)&&(0,s.jsxs)(fe,{className:"size-full opacity-60 rounded-none",children:[(0,s.jsx)(xe,{src:c?URL.createObjectURL(c):a.avatar,className:"object-cover"}),(0,s.jsx)(he,{children:a?.handle?.[0]?.toUpperCase()})]}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("div",{className:"bg-black/50 p-2 rounded-full text-white group-hover:scale-110 transition-transform",children:(0,s.jsx)(Oe,{size:16})})})]})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(We,{label:"Name",value:a?.name||"",onChange:h=>i({...a,name:h.target.value})}),(0,s.jsx)(We,{label:"Bio",textarea:!0,value:a?.bio||"",onChange:h=>i({...a,bio:h.target.value})}),(0,s.jsx)(We,{label:"Location",value:a?.location||"",onChange:h=>i({...a,location:h.target.value})}),(0,s.jsx)(We,{label:"Website",value:a?.website||"",onChange:h=>i({...a,website:h.target.value})})]}),(0,s.jsx)(ue,{className:"w-full py-3",disabled:l,onClick:x,children:l?(0,s.jsx)(me,{size:24,className:"animate-spin text-white mx-auto"}):"Save changes"})]})})})},Pl=$l,Ml=Q(),Fl=t=>{const e=(0,Ml.c)(22),{isPostModalOpen:a,setIsPostModalOpen:i,isEditProfileOpen:n,setIsEditProfileOpen:r,isStoryModalOpen:l,setIsStoryModalOpen:o,editProfileData:c,setEditProfileData:m,postCommunity:d}=t;let u;e[0]!==i?(u=()=>i(!1),e[0]=i,e[1]=u):u=e[1];let f;e[2]!==a||e[3]!==d||e[4]!==u?(f=(0,s.jsx)(kl,{isOpen:a,onClose:u,initialCommunity:d}),e[2]=a,e[3]=d,e[4]=u,e[5]=f):f=e[5];let p;e[6]!==r?(p=()=>r(!1),e[6]=r,e[7]=p):p=e[7];let b;e[8]!==c||e[9]!==n||e[10]!==m||e[11]!==p?(b=(0,s.jsx)(Pl,{isOpen:n,onClose:p,editProfileData:c,setEditProfileData:m}),e[8]=c,e[9]=n,e[10]=m,e[11]=p,e[12]=b):b=e[12];let x;e[13]!==o?(x=()=>o(!1),e[13]=o,e[14]=x):x=e[14];let h;e[15]!==l||e[16]!==x?(h=(0,s.jsx)(Cl,{isOpen:l,onClose:x}),e[15]=l,e[16]=x,e[17]=h):h=e[17];let v;return e[18]!==f||e[19]!==b||e[20]!==h?(v=(0,s.jsxs)(s.Fragment,{children:[f,b,h]}),e[18]=f,e[19]=b,e[20]=h,e[21]=v):v=e[21],v},Ll=Fl,Rl=Q(),Il=t=>{const e=(0,Rl.c)(77),{story:a,onClose:i}=t,[n,r]=(0,g.useState)(0),[l,o]=(0,g.useState)(0),c=a.stories,m=c[n];let d;e[0]!==n||e[1]!==i||e[2]!==c.length?(d=()=>{n<c.length-1?(r(ql),o(0)):i()},e[0]=n,e[1]=i,e[2]=c.length,e[3]=d):d=e[3];const u=d;let f;e[4]!==n?(f=()=>{n>0&&(r(Tl),o(0))},e[4]=n,e[5]=f):f=e[5];const p=f;let b;e[6]!==u?(b=()=>{const W=setInterval(()=>{o(K=>K>=100?(u(),100):K+1)},50);return()=>clearInterval(W)},e[6]=u,e[7]=b):b=e[7];let x;e[8]!==n||e[9]!==u?(x=[u,n],e[8]=n,e[9]=u,e[10]=x):x=e[10],(0,g.useEffect)(b,x);let h;if(e[11]!==n||e[12]!==l||e[13]!==c){let W;e[15]!==n||e[16]!==l?(W=(K,te)=>(0,s.jsx)("div",{className:"flex-1 h-full bg-white/30 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full bg-white transition-all duration-100",style:{width:te<n?"100%":te===n?`${l}%`:"0%"}})},te),e[15]=n,e[16]=l,e[17]=W):W=e[17],h=c.map(W),e[11]=n,e[12]=l,e[13]=c,e[14]=h}else h=e[14];let v;e[18]!==h?(v=(0,s.jsx)("div",{className:"flex gap-1.5 h-0.5 w-full bg-transparent",children:h}),e[18]=h,e[19]=v):v=e[19];let j;e[20]!==a.user.avatar||e[21]!==a.user.handle?(j=(0,s.jsx)(xe,{src:a.user.avatar,alt:a.user.handle,className:"object-cover"}),e[20]=a.user.avatar,e[21]=a.user.handle,e[22]=j):j=e[22];let w;e[23]!==a.user.handle?.[0]?(w=a.user.handle?.[0]?.toUpperCase(),e[23]=a.user.handle?.[0],e[24]=w):w=e[24];let y;e[25]!==w?(y=(0,s.jsx)(he,{children:w}),e[25]=w,e[26]=y):y=e[26];let k;e[27]!==j||e[28]!==y?(k=(0,s.jsxs)(fe,{className:"size-10 border border-white/20 shadow-sm",children:[j,y]}),e[27]=j,e[28]=y,e[29]=k):k=e[29];let S;e[30]!==a.user.handle?(S=(0,s.jsx)("span",{className:"text-white text-sm font-bold shadow-black drop-shadow-md",children:a.user.handle}),e[30]=a.user.handle,e[31]=S):S=e[31];let M;e[32]!==m.created_at?(M=new Date(m.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),e[32]=m.created_at,e[33]=M):M=e[33];let E;e[34]!==M?(E=(0,s.jsx)("span",{className:"text-white/60 text-[10px] shadow-black drop-shadow-md",children:M}),e[34]=M,e[35]=E):E=e[35];let F;e[36]!==S||e[37]!==E?(F=(0,s.jsxs)("div",{className:"flex flex-col",children:[S,E]}),e[36]=S,e[37]=E,e[38]=F):F=e[38];let N;e[39]!==k||e[40]!==F?(N=(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[k,F]}),e[39]=k,e[40]=F,e[41]=N):N=e[41];let P;e[42]===Symbol.for("react.memo_cache_sentinel")?(P=(0,s.jsx)(_e,{size:24}),e[42]=P):P=e[42];let R;e[43]!==i?(R=(0,s.jsx)("button",{onClick:i,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors",children:P}),e[43]=i,e[44]=R):R=e[44];let L;e[45]!==N||e[46]!==R?(L=(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[N,R]}),e[45]=N,e[46]=R,e[47]=L):L=e[47];let T;e[48]!==L||e[49]!==v?(T=(0,s.jsxs)("div",{className:"absolute top-0 left-0 right-0 p-4 z-20 flex flex-col gap-4",children:[v,L]}),e[48]=L,e[49]=v,e[50]=T):T=e[50];let D;e[51]!==n||e[52]!==p?(D=n>0&&(0,s.jsx)("button",{onClick:W=>{W.stopPropagation(),p()},className:"absolute left-4 z-30 p-2 bg-black/20 hover:bg-black/40 rounded-full text-white backdrop-blur-md transition-all active:scale-90",children:(0,s.jsx)(us,{size:32})}),e[51]=n,e[52]=p,e[53]=D):D=e[53];let C;e[54]!==m.id||e[55]!==m.media?(C=(0,s.jsx)("div",{className:"relative w-full h-full flex items-center justify-center",children:(0,s.jsx)("img",{src:m.media,className:"max-w-full max-h-full object-contain rounded-xl shadow-2xl animate-in fade-in zoom-in-95 duration-300",alt:""},m.id)}),e[54]=m.id,e[55]=m.media,e[56]=C):C=e[56];let _;e[57]!==u?(_=W=>{W.stopPropagation(),u()},e[57]=u,e[58]=_):_=e[58];let z;e[59]===Symbol.for("react.memo_cache_sentinel")?(z=(0,s.jsx)(ls,{size:32}),e[59]=z):z=e[59];let $;e[60]!==_?($=(0,s.jsx)("button",{onClick:_,className:"absolute right-4 z-30 p-2 bg-black/20 hover:bg-black/40 rounded-full text-white backdrop-blur-md transition-all active:scale-90",children:z}),e[60]=_,e[61]=$):$=e[61];let q;e[62]!==p?(q=(0,s.jsx)("div",{className:"flex-1 cursor-w-resize",onClick:p}),e[62]=p,e[63]=q):q=e[63];let B;e[64]!==u?(B=(0,s.jsx)("div",{className:"flex-1 cursor-e-resize",onClick:u}),e[64]=u,e[65]=B):B=e[65];let Y;e[66]!==q||e[67]!==B?(Y=(0,s.jsxs)("div",{className:"absolute inset-0 flex z-20",children:[q,B]}),e[66]=q,e[67]=B,e[68]=Y):Y=e[68];let I;e[69]!==D||e[70]!==C||e[71]!==$||e[72]!==Y?(I=(0,s.jsxs)("div",{className:"w-full h-full max-w-xl relative flex items-center justify-center p-2",children:[D,C,$,Y]}),e[69]=D,e[70]=C,e[71]=$,e[72]=Y,e[73]=I):I=e[73];let U;return e[74]!==T||e[75]!==I?(U=(0,s.jsxs)("div",{className:"fixed inset-0 z-[100] bg-black flex flex-col items-center justify-center animate-in fade-in duration-300",children:[T,I]}),e[74]=T,e[75]=I,e[76]=U):U=e[76],U},El=Il;function ql(t){return t+1}function Tl(t){return t-1}var Ol=({type:t,onComplete:e,onSwitch:a})=>{const{login:i,signup:n}=pe(),{addToast:r}=Ce(),[l,o]=(0,g.useState)({name:"",email:"",username:"",password:""}),[c,m]=(0,g.useState)(!1),[d,u]=(0,g.useState)(null),f=async p=>{p.preventDefault(),m(!0),u(null);try{t==="login"?(await i({email:l.email,password:l.password}),r("Welcome back!")):(await n({email:l.email,password:l.password,username:l.username,name:l.name}),r("Account created successfully!")),e()}catch(b){console.error("Auth error:",b),u(b.message||"Authentication failed. Please check your credentials."),r("Authentication failed!")}finally{m(!1)}};return(0,s.jsxs)("div",{className:"max-w-md mx-auto p-8 w-full animate-in fade-in slide-in-from-bottom-5 duration-300",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("div",{className:"flex justify-center mb-4",children:(0,s.jsx)("div",{className:"bg-black dark:bg-white dark:text-black text-white p-3 rounded-2xl shadow-lg",children:(0,s.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",alt:"Logo",className:"w-10 h-10 rounded-xl"})})}),(0,s.jsx)("h2",{className:"text-3xl font-extrabold mb-2 dark:text-white tracking-tight",children:t==="login"?"Welcome back!":"Join Sysm today"}),(0,s.jsx)("p",{className:"text-zinc-500 font-medium",children:"The decentralized social network"})]}),d&&(0,s.jsxs)("div",{className:"mb-6 p-4 bg-rose-50 dark:bg-rose-900/20 border border-rose-100 dark:border-rose-800 rounded-xl flex items-center gap-3 text-rose-600 dark:text-rose-400 text-sm",children:[(0,s.jsx)(vs,{size:18}),(0,s.jsx)("span",{children:d})]}),(0,s.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,s.jsx)(We,{label:"Email",type:"email",placeholder:"john@example.com",value:l.email,onChange:p=>o({...l,email:p.target.value}),required:!0}),t==="signup"&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(We,{label:"Name",placeholder:"John Doe",value:l.name,onChange:p=>o({...l,name:p.target.value}),required:!0}),(0,s.jsx)(We,{label:"Username",placeholder:"johndoe",value:l.username,onChange:p=>o({...l,username:p.target.value}),required:!0})]}),(0,s.jsx)(We,{label:"Password",type:"password",placeholder:"",value:l.password,onChange:p=>o({...l,password:p.target.value}),required:!0}),(0,s.jsx)(ue,{type:"submit",className:"w-full justify-center py-3 mt-6 text-lg",disabled:c,children:c?(0,s.jsx)(me,{size:24,className:"animate-spin"}):t==="login"?"Log in":"Sign up"})]}),(0,s.jsxs)("div",{className:"mt-8 text-center text-sm",children:[(0,s.jsx)("span",{className:"text-zinc-500",children:t==="login"?"Don't have an account?":"Already have an account?"}),(0,s.jsx)("button",{onClick:a,className:"font-bold ml-1 hover:underline dark:text-white",children:t==="login"?"Sign up":"Log in"})]})]})},Al=Ol,Dl=Q(),Bl=t=>{const e=(0,Dl.c)(20),{icon:a,count:i,label:n,onClick:r,active:l,activeColorClass:o}=t,c=o===void 0?"text-violet-600":o,m=a;let d;e[0]!==r?(d=y=>{y.stopPropagation(),r&&r(y)},e[0]=r,e[1]=d):d=e[1];const u=`group flex items-center gap-x-1.5 text-[12px] sm:text-[13px] font-bold transition-all ${l?c:"text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-300"}`,f=`rounded-full p-2 transition-colors ${l?"":"group-hover:bg-zinc-100 dark:group-hover:bg-zinc-800"}`,p=l?2.5:2,b=l?"fill-current":"";let x;e[2]!==m||e[3]!==p||e[4]!==b?(x=(0,s.jsx)(m,{size:18,strokeWidth:p,className:b}),e[2]=m,e[3]=p,e[4]=b,e[5]=x):x=e[5];let h;e[6]!==f||e[7]!==x?(h=(0,s.jsx)("div",{className:f,children:x}),e[6]=f,e[7]=x,e[8]=h):h=e[8];let v;e[9]!==n?(v=n&&(0,s.jsx)("span",{className:"hidden xs:inline",children:n}),e[9]=n,e[10]=v):v=e[10];let j;e[11]!==l||e[12]!==i?(j=i!=null&&(0,s.jsx)("span",{className:l?"font-bold":"",children:i||0}),e[11]=l,e[12]=i,e[13]=j):j=e[13];let w;return e[14]!==j||e[15]!==d||e[16]!==u||e[17]!==h||e[18]!==v?(w=(0,s.jsxs)("button",{onClick:d,className:u,children:[h,v,j]}),e[14]=j,e[15]=d,e[16]=u,e[17]=h,e[18]=v,e[19]=w):w=e[19],w},Ye=Bl,Wl=Q(),Ul=t=>{const e=(0,Wl.c)(51),{currentUser:a,newComment:i,setNewComment:n,handleSubmitComment:r,loading:l,selectedFiles:o,setSelectedFiles:c,isUploading:m}=t;let d;e[0]!==o?(d=o===void 0?[]:o,e[0]=o,e[1]=d):d=e[1];const u=d,f=(0,g.useRef)(null);let p;e[2]!==c?(p=_=>{const z=Array.from(_.target.files);c&&c($=>[...$,...z])},e[2]=c,e[3]=p):p=e[3];const b=p;let x;e[4]!==c?(x=_=>{c&&c(z=>z.filter(($,q)=>q!==_))},e[4]=c,e[5]=x):x=e[5];const h=x;if(!a){let _;return e[6]===Symbol.for("react.memo_cache_sentinel")?(_=(0,s.jsx)("div",{className:"p-6 text-center border-y border-zinc-100 dark:border-zinc-800 bg-zinc-50/30 dark:bg-zinc-900/10",children:(0,s.jsx)("p",{className:"text-zinc-500 text-sm",children:"Please login to join the conversation."})}),e[6]=_):_=e[6],_}let v;e[7]!==a.avatar||e[8]!==a.handle?(v=(0,s.jsx)(xe,{src:a.avatar,alt:a.handle,className:"object-cover"}),e[7]=a.avatar,e[8]=a.handle,e[9]=v):v=e[9];let j;e[10]!==a.handle?.[0]?(j=a.handle?.[0]?.toUpperCase(),e[10]=a.handle?.[0],e[11]=j):j=e[11];let w;e[12]!==j?(w=(0,s.jsx)(he,{children:j}),e[12]=j,e[13]=w):w=e[13];let y;e[14]!==v||e[15]!==w?(y=(0,s.jsxs)(fe,{className:"size-9 border border-zinc-200 dark:border-zinc-700",children:[v,w]}),e[14]=v,e[15]=w,e[16]=y):y=e[16];let k;e[17]!==n?(k=_=>n(_.target.value),e[17]=n,e[18]=k):k=e[18];let S;e[19]!==i||e[20]!==k?(S=(0,s.jsx)("textarea",{id:"comment-input",className:"w-full bg-transparent outline-none text-base min-h-[60px] resize-none dark:text-white placeholder:text-zinc-500",placeholder:"Post your reply...",value:i,onChange:k}),e[19]=i,e[20]=k,e[21]=S):S=e[21];let M;e[22]!==h||e[23]!==u?(M=u.length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mt-2 mb-2",children:u.map((_,z)=>(0,s.jsxs)("div",{className:"relative size-20 rounded-xl overflow-hidden border border-zinc-200 dark:border-zinc-800",children:[_.type.startsWith("image/")?(0,s.jsx)("img",{src:URL.createObjectURL(_),className:"size-full object-cover",alt:""}):(0,s.jsx)("div",{className:"size-full flex items-center justify-center bg-zinc-100 dark:bg-zinc-800",children:(0,s.jsx)(ws,{size:20,className:"text-zinc-500"})}),(0,s.jsx)("button",{onClick:()=>h(z),className:"absolute top-1 right-1 bg-black/60 text-white rounded-full p-1 hover:bg-black transition-colors",children:(0,s.jsx)(_e,{size:12})})]},z))}),e[22]=h,e[23]=u,e[24]=M):M=e[24];let E;e[25]===Symbol.for("react.memo_cache_sentinel")?(E=()=>f.current?.click(),e[25]=E):E=e[25];let F;e[26]===Symbol.for("react.memo_cache_sentinel")?(F=(0,s.jsx)("button",{type:"button",onClick:E,className:"text-violet-600 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full p-2 transition-colors",title:"Attach media",children:(0,s.jsx)(ds,{size:20})}),e[26]=F):F=e[26];let N;e[27]!==b?(N=(0,s.jsxs)("div",{className:"flex text-violet-600 gap-1",children:[F,(0,s.jsx)("input",{type:"file",ref:f,onChange:b,multiple:!0,className:"hidden",accept:"image/*,video/*,application/pdf"})]}),e[27]=b,e[28]=N):N=e[28];let P;e[29]!==m||e[30]!==l||e[31]!==i||e[32]!==u.length?(P=!i.trim()&&u.length===0||l||m,e[29]=m,e[30]=l,e[31]=i,e[32]=u.length,e[33]=P):P=e[33];let R;e[34]!==m||e[35]!==l?(R=l||m?(0,s.jsx)(me,{size:16,className:"animate-spin text-white mx-auto"}):"Reply",e[34]=m,e[35]=l,e[36]=R):R=e[36];let L;e[37]!==r||e[38]!==P||e[39]!==R?(L=(0,s.jsx)(ue,{className:"!w-auto px-5 py-1.5 text-sm font-bold min-w-[70px]",onClick:r,disabled:P,children:R}),e[37]=r,e[38]=P,e[39]=R,e[40]=L):L=e[40];let T;e[41]!==N||e[42]!==L?(T=(0,s.jsxs)("div",{className:"flex justify-between items-center mt-2 pt-3 border-t border-zinc-100 dark:border-zinc-800",children:[N,L]}),e[41]=N,e[42]=L,e[43]=T):T=e[43];let D;e[44]!==S||e[45]!==M||e[46]!==T?(D=(0,s.jsxs)("div",{className:"flex-1",children:[S,M,T]}),e[44]=S,e[45]=M,e[46]=T,e[47]=D):D=e[47];let C;return e[48]!==D||e[49]!==y?(C=(0,s.jsx)("div",{className:"p-4 border-y border-zinc-100 dark:border-zinc-800 bg-zinc-50/30 dark:bg-zinc-900/10",children:(0,s.jsxs)("div",{className:"flex gap-3",children:[y,D]})}),e[48]=D,e[49]=y,e[50]=C):C=e[50],C},Hl=Ul,Ql=Q(),Jl=t=>{const e=(0,Ql.c)(17),{file:a}=t;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsx)("div",{className:"size-10 rounded-xl bg-violet-100 dark:bg-violet-900/30 flex items-center justify-center text-violet-600",children:(0,s.jsx)(ns,{size:20})}),e[0]=i):i=e[0];let n;e[1]!==a.name?(n=(0,s.jsx)("div",{className:"text-sm font-bold truncate dark:text-white",children:a.name}),e[1]=a.name,e[2]=n):n=e[2];const r=a.size/1024/1024;let l;e[3]!==r?(l=r.toFixed(2),e[3]=r,e[4]=l):l=e[4];let o;e[5]!==l?(o=(0,s.jsxs)("div",{className:"text-xs text-zinc-500 uppercase",children:[l," MB"]}),e[5]=l,e[6]=o):o=e[6];let c;e[7]!==n||e[8]!==o?(c=(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[n,o]}),e[7]=n,e[8]=o,e[9]=c):c=e[9];let m;e[10]===Symbol.for("react.memo_cache_sentinel")?(m=(0,s.jsx)(ms,{size:18}),e[10]=m):m=e[10];let d;e[11]!==a.name||e[12]!==a.url?(d=(0,s.jsx)("a",{href:a.url,download:a.name,className:"p-2 text-zinc-400 hover:text-violet-600 transition-colors",onClick:Kl,children:m}),e[11]=a.name,e[12]=a.url,e[13]=d):d=e[13];let u;return e[14]!==c||e[15]!==d?(u=(0,s.jsxs)("div",{className:"mt-3 flex items-center gap-3 p-3 rounded-2xl border border-zinc-100 dark:border-zinc-800 bg-zinc-50/50 dark:bg-zinc-900/10 group hover:border-violet-500/30 transition-colors",children:[i,c,d]}),e[14]=c,e[15]=d,e[16]=u):u=e[16],u},Vl=Jl;function Kl(t){return t.stopPropagation()}var Mc=Q(),Xl=Q(),Yl=t=>{const e=(0,Xl.c)(30),{url:a}=t;let i,n;e[0]!==a?(i=["link-preview",a],n=()=>Fn(a),e[0]=a,e[1]=i,e[2]=n):(i=e[1],n=e[2]);const r=!!a;let l;e[3]!==i||e[4]!==n||e[5]!==r?(l={queryKey:i,queryFn:n,staleTime:864e5,enabled:r},e[3]=i,e[4]=n,e[5]=r,e[6]=l):l=e[6];const{data:o,isLoading:c,isError:m}=Pe(l);if(c){let w;return e[7]===Symbol.for("react.memo_cache_sentinel")?(w=(0,s.jsx)("div",{className:"mt-3 rounded-2xl border border-zinc-100 dark:border-zinc-800 overflow-hidden animate-pulse bg-zinc-50 dark:bg-zinc-900/50 h-24 flex items-center justify-center",children:(0,s.jsx)(mt,{className:"text-zinc-300 dark:text-zinc-700 animate-spin",size:24})}),e[7]=w):w=e[7],w}if(m||!o||!o.title&&!o.image)return null;let d;e[8]!==o.image||e[9]!==o.title?(d=o.image&&(0,s.jsx)("div",{className:"w-full aspect-[1.91/1] overflow-hidden bg-zinc-100 dark:bg-zinc-900 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)("img",{src:o.image,alt:o.title,className:"w-full h-full object-cover group-hover:scale-[1.02] transition-transform duration-500",onError:Zl})}),e[8]=o.image,e[9]=o.title,e[10]=d):d=e[10];let u;e[11]===Symbol.for("react.memo_cache_sentinel")?(u=(0,s.jsx)(mt,{size:12}),e[11]=u):u=e[11];let f;e[12]!==o.siteName?(f=(0,s.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-zinc-500 font-bold uppercase tracking-wider",children:[u,(0,s.jsx)("span",{children:o.siteName})]}),e[12]=o.siteName,e[13]=f):f=e[13];let p;e[14]!==o.title?(p=(0,s.jsx)("h4",{className:"font-bold text-[15px] line-clamp-2 dark:text-white leading-snug group-hover:text-violet-600 transition-colors",children:o.title}),e[14]=o.title,e[15]=p):p=e[15];let b;e[16]!==o.description?(b=o.description&&(0,s.jsx)("p",{className:"text-xs text-zinc-500 dark:text-zinc-400 line-clamp-2 leading-relaxed",children:o.description}),e[16]=o.description,e[17]=b):b=e[17];let x;e[18]===Symbol.for("react.memo_cache_sentinel")?(x=(0,s.jsx)(Ta,{size:10}),e[18]=x):x=e[18];let h;e[19]!==a?(h=(0,s.jsxs)("div",{className:"pt-1 flex items-center gap-1 text-[11px] text-zinc-400 font-medium",children:[x,(0,s.jsx)("span",{className:"truncate",children:a})]}),e[19]=a,e[20]=h):h=e[20];let v;e[21]!==h||e[22]!==f||e[23]!==p||e[24]!==b?(v=(0,s.jsxs)("div",{className:"p-3.5 space-y-1",children:[f,p,b,h]}),e[21]=h,e[22]=f,e[23]=p,e[24]=b,e[25]=v):v=e[25];let j;return e[26]!==v||e[27]!==d||e[28]!==a?(j=(0,s.jsxs)("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"mt-3 flex flex-col rounded-2xl border border-zinc-100 dark:border-zinc-800 overflow-hidden bg-white dark:bg-zinc-950 hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-all group shadow-sm",onClick:Gl,children:[d,v]}),e[26]=v,e[27]=d,e[28]=a,e[29]=j):j=e[29],j},Gt=Yl;function Gl(t){return t.stopPropagation()}function Zl(t){return t.target.style.display="none"}var eo=Q(),to=t=>{const e=(0,eo.c)(12),{src:a,poster:i}=t,n=(0,g.useRef)(null);let r,l;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=()=>{const p=new IntersectionObserver(x=>{const[h]=x;n.current?.plyr&&(h.isIntersecting?n.current.plyr.play().catch(()=>{n.current.plyr.muted=!0,n.current.plyr.play()}):n.current.plyr.pause())},{threshold:.6}),b=n.current?.elements?.container;return b&&p.observe(b),()=>{b&&p.unobserve(b)}},l=[],e[0]=r,e[1]=l):(r=e[0],l=e[1]),(0,g.useEffect)(r,l);let o;e[2]!==a?(o=[{src:a,type:"video/mp4"}],e[2]=a,e[3]=o):o=e[3];let c;e[4]!==i||e[5]!==o?(c={type:"video",sources:o,poster:i},e[4]=i,e[5]=o,e[6]=c):c=e[6];let m;e[7]===Symbol.for("react.memo_cache_sentinel")?(m={controls:["play-large","play","progress","current-time","mute","volume","fullscreen"],settings:["quality","speed"],ratio:"16:9",clickToPlay:!0,hideControls:!0,resetOnEnd:!0},e[7]=m):m=e[7];let d;e[8]!==c?(d={source:c,options:m},e[8]=c,e[9]=d):d=e[9];const u=d;let f;return e[10]!==u?(f=(0,s.jsx)("div",{className:"mt-3 overflow-hidden rounded-2xl shadow-sm border border-zinc-100 dark:border-zinc-800 bg-black",onClick:ao,children:(0,s.jsx)(js,{ref:n,...u})}),e[10]=u,e[11]=f):f=e[11],f},so=to;function ao(t){return t.stopPropagation()}var io=Q(),no=t=>{const e=(0,io.c)(3),{items:a}=t,i=a===void 0?[]:a,{openLightbox:n}=Ft();if(!i||i.length===0)return null;const r=Array.isArray(i)?i:[i],l=r.filter(lo),o=r.filter(oo),c=p=>{const b=l.filter(co).map(mo),x=l[p];n(b,b.indexOf(x.url||x.src))},m="mt-3 space-y-2",d=l.length>0&&(0,s.jsx)("div",{className:`grid gap-2 rounded-2xl overflow-hidden border border-zinc-100 dark:border-zinc-800 ${l.length===1?"grid-cols-1":l.length===2?"grid-cols-2 aspect-[16/9]":(l.length===3,"grid-cols-2 grid-rows-2 aspect-[16/9]")}`,children:l.map((p,b)=>(0,s.jsx)("div",{className:`relative overflow-hidden bg-zinc-100 dark:bg-zinc-900 cursor-pointer ${l.length===3&&b===0?"row-span-2":""}`,onClick:x=>{p.type==="image"&&(x.stopPropagation(),c(b))},children:p.type==="video"?(0,s.jsx)(so,{src:p.url,poster:p.poster}):(0,s.jsx)("img",{src:p.url||p.src,className:"size-full object-cover hover:scale-[1.02] transition-transform duration-500",alt:"",loading:"lazy"})},b))}),u=o.map(uo);let f;return e[0]!==d||e[1]!==u?(f=(0,s.jsxs)("div",{className:m,children:[d,u]}),e[0]=d,e[1]=u,e[2]=f):f=e[2],f},ro=no;function lo(t){return t.type==="image"||t.type==="video"}function oo(t){return t.type==="file"}function co(t){return t.type==="image"}function mo(t){return t.url||t.src}function uo(t,e){return(0,s.jsx)(Vl,{file:t},e)}var fo=Q(),xo=t=>{const e=(0,fo.c)(18),{poll:a,onVote:i}=t,n=a.options.reduce(ho,0),[r,l]=(0,g.useState)(null);let o;e[0]!==i||e[1]!==r?(o=b=>{r||(l(b),i&&i(b))},e[0]=i,e[1]=r,e[2]=o):o=e[2];const c=o;let m;if(e[3]!==c||e[4]!==a.options||e[5]!==n||e[6]!==r){let b;e[8]!==c||e[9]!==n||e[10]!==r?(b=(x,h)=>{const v=n>0?Math.round((x.votes+(r===x.id?1:0))/(n+(r?1:0))*100):0,j=r===x.id;return(0,s.jsxs)("div",{onClick:w=>{w.stopPropagation(),c(x.id)},className:`relative h-10 w-full rounded-xl overflow-hidden cursor-pointer border ${j?"border-violet-500 dark:border-violet-500":"border-zinc-200 dark:border-zinc-700"}`,children:[r&&(0,s.jsx)("div",{className:"absolute top-0 left-0 h-full bg-zinc-200 dark:bg-zinc-800 transition-all duration-500",style:{width:`${v}%`}}),(0,s.jsxs)("div",{className:"absolute inset-0 flex items-center justify-between px-4 z-10",children:[(0,s.jsxs)("span",{className:`font-medium text-sm ${j?"text-violet-600 font-bold":"text-zinc-700 dark:text-zinc-200"}`,children:[x.text," ",j&&(0,s.jsx)(os,{size:14,className:"inline ml-1 mb-0.5"})]}),r&&(0,s.jsxs)("span",{className:"text-sm font-bold text-zinc-900 dark:text-white",children:[v,"%"]})]})]},x.id||h)},e[8]=c,e[9]=n,e[10]=r,e[11]=b):b=e[11],m=a.options.map(b),e[3]=c,e[4]=a.options,e[5]=n,e[6]=r,e[7]=m}else m=e[7];const d=n+(r?1:0),u=r?"6 days left":"Click to vote";let f;e[12]!==d||e[13]!==u?(f=(0,s.jsxs)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400 pl-1",children:[d," votes "," ",u]}),e[12]=d,e[13]=u,e[14]=f):f=e[14];let p;return e[15]!==m||e[16]!==f?(p=(0,s.jsxs)("div",{className:"mt-3 space-y-2",children:[m,f]}),e[15]=m,e[16]=f,e[17]=p):p=e[17],p},Zt=xo;function ho(t,e){return t+e.votes}const po=(t,e,a,i)=>{const[n,r]=(0,g.useState)(!1),[l,o]=(0,g.useState)(!1),[c,m]=(0,g.useState)(e||{comments:0,likes:0,mirrors:0});return(0,g.useEffect)(()=>{a&&t&&ke(t)&&ke(a.id)&&(rn(t,a.id).then(r).catch(()=>r(!1)),on(t,a.id).then(o).catch(()=>o(!1)))},[t,a]),{liked:n,reposted:l,localStats:c,setLocalStats:m,handleLike:async f=>{if(f&&f.stopPropagation(),!a)return i("Please login to like!","error");if(!ke(t)||!ke(a.id)){const p=!n;r(p),m(b=>({...b,likes:p?(b.likes||0)+1:(b.likes||0)-1}));return}try{const p=await nn(t,a.id);r(p),m(b=>({...b,likes:p?(b.likes||0)+1:(b.likes||0)-1}))}catch(p){console.error("Failed to toggle like:",p)}},handleRepost:async f=>{if(f&&f.stopPropagation(),!a)return i("Please login to repost!","error");if(!ke(t)||!ke(a.id)){const p=!l;o(p),m(b=>({...b,mirrors:p?(b.mirrors||0)+1:(b.mirrors||0)-1}));return}try{const p=await ln(t,a.id);o(p),m(b=>({...b,mirrors:p?(b.mirrors||0)+1:(b.mirrors||0)-1})),i(p?"Reposted!":"Removed repost")}catch(p){console.error("Failed to toggle repost:",p),i("Failed to update repost","error")}}}};var bo=Q();const Zs=t=>{const e=(0,bo.c)(5);let a;e[0]!==t?(a=()=>dt(t),e[0]=t,e[1]=a):a=e[1];const[i,n]=(0,g.useState)(a);let r,l;return e[2]!==t?(r=()=>{if(!t)return;const o=setTimeout(()=>{n(dt(t))},0),c=setInterval(()=>{n(dt(t))},6e4);return()=>{clearTimeout(o),clearInterval(c)}},l=[t],e[2]=t,e[3]=r,e[4]=l):(r=e[3],l=e[4]),(0,g.useEffect)(r,l),i},go=()=>{const{handle:t}=xt(),e=je(),{profiles:a,currentUser:i,getProfileByHandle:n}=pe(),{addToast:r}=Ce(),[l,o]=(0,g.useState)(a[t]),[c,m]=(0,g.useState)(!l),[d,u]=(0,g.useState)([]),[f,p]=(0,g.useState)("feed"),[b,x]=(0,g.useState)(!0),[h,v]=(0,g.useState)(!1),[j,w]=(0,g.useState)(!0),y=(0,g.useRef)(d);(0,g.useEffect)(()=>{y.current=d},[d]);const[k,S]=(0,g.useState)(!1),[M,E]=(0,g.useState)("Followers"),[F,N]=(0,g.useState)([]),[P,R]=(0,g.useState)(!1),[L,T]=(0,g.useState)(!1),[D,C]=(0,g.useState)(!0),_=(0,g.useRef)(F);(0,g.useEffect)(()=>{_.current=F},[F]);const z=(0,g.useCallback)(async(I,U=!1)=>{if(I){U?v(!0):x(!0);try{const W=y.current,K=await Gi(I,U&&W.length>0?W[W.length-1].created_at:null,10);K.length<10?w(!1):w(!0),u(U?te=>[...te,...K]:K)}catch(W){console.error("Failed to fetch user posts:",W)}finally{x(!1),v(!1)}}},[]),$=async(I,U=!1)=>{const W=l?.id;if(W){U?T(!0):(E(I),S(!0),R(!0),N([]));try{const K=_.current,te=U&&K.length>0?K[K.length-1].followed_at:null,G=I==="Followers"?await Ji(W,te,10):await Vi(W,te,10);G.length<10?C(!1):C(!0),N(U?ae=>[...ae,...G]:G)}catch(K){console.error(`Failed to fetch ${I}:`,K),r(`Failed to load ${I}`)}finally{R(!1),T(!1)}}};(0,g.useEffect)(()=>{(async()=>{let U=a[t];U?o(U):(m(!0),U=await n(t),o(U),m(!1)),U?.id&&z(U.id)})()},[t,a,n,z]);const q=(0,g.useMemo)(()=>f==="feed"?d.filter(I=>I.community_id===null&&I.parent_id===null):f==="media"?d.filter(I=>I.community_id===null&&I.parent_id===null&&(I.type==="video"||I.type==="image"||I.media&&I.media.length>0)):f==="communities"?d.filter(I=>I.community_id!==null):d,[d,f]);return{handle:t,profile:l,loading:c,userPosts:d,setUserPosts:u,activeProfileTab:f,setActiveProfileTab:p,loadingPosts:b,isFetchingMorePosts:h,hasMorePosts:j,filteredPosts:q,isFollowModalOpen:k,setIsFollowModalOpen:S,followModalType:M,followListData:F,isListLoading:P,isFetchingMoreFollows:L,hasMoreFollows:D,openFollowModal:$,handlePostClick:I=>{e(`/post/${I}`)},handleUserClick:I=>{I!==t&&e(`/u/${I}`)},loadUserPosts:z,currentUser:i,addToast:r,navigate:e}},vo=()=>{const{handle:t}=xt(),e=je(),{currentUser:a}=pe(),{addToast:i}=Ce(),[n,r]=(0,g.useState)(null),[l,o]=(0,g.useState)(!0),[c,m]=(0,g.useState)(!1),[d,u]=(0,g.useState)(null),[f,p]=(0,g.useState)(!1),[b,x]=(0,g.useState)([]),[h,v]=(0,g.useState)(!0),[j,w]=(0,g.useState)(!1),[y,k]=(0,g.useState)(!0),S=(0,g.useRef)(b);(0,g.useEffect)(()=>{S.current=b},[b]);const M=(0,g.useCallback)(async(F,N=!1)=>{if(F){N?w(!0):v(!0);try{const P=S.current,R=await zn(F,N&&P.length>0?P[P.length-1].sort_timestamp:null,10);R.length<10?k(!1):k(!0),x(N?L=>[...L,...R]:R)}catch(P){console.error("Failed to fetch community posts:",P)}finally{v(!1),w(!1)}}},[]);return(0,g.useEffect)(()=>{(async()=>{o(!0);try{const N=await Nn(t);if(r(N),N?.id&&(M(N.id),a)){const P=await Ss(N.id,a.id);m(!!P),u(P?.role||null)}}catch{}finally{o(!1)}})()},[t,a,M]),{community:n,loading:l,isMember:c,userRole:d,isJoining:f,communityPosts:b,loadingPosts:h,isFetchingMorePosts:j,hasMorePosts:y,handleJoinToggle:async()=>{if(!a)return i("Please login to join communities","error");p(!0);try{const F=await Cs(n.id,a.id);m(F),u(F?"member":null),r(N=>({...N,membersCount:F?N.membersCount+1:N.membersCount-1})),i(F?`Joined ${n.name}`:`Left ${n.name}`)}catch{i("Failed to update membership","error")}finally{p(!1)}},loadCommunityPosts:M,currentUser:a,addToast:i,navigate:e}},jo=()=>{const{currentUser:t}=pe(),e=je(),a=nt(),i=new URLSearchParams(a.search).get("q")||"",[n,r]=(0,g.useState)(i),[l,o]=(0,g.useState)(!1);(0,g.useEffect)(()=>{r(i)},[i]);const[c,m]=(0,g.useState)([]),[d,u]=(0,g.useState)(!0),[f,p]=(0,g.useState)(!1),[b,x]=(0,g.useState)(!0),h=(0,g.useRef)(c);(0,g.useEffect)(()=>{h.current=c},[c]);const v=(0,g.useCallback)(async(y=!1)=>{y?p(!0):u(!0);try{const k=h.current,S=await wn(y&&k.length>0?k[k.length-1].createdAt:null,10);S.length<10?x(!1):x(!0),m(y?M=>[...M,...S]:S)}catch(k){console.error("Failed to fetch communities:",k)}finally{u(!1),p(!1)}},[]);(0,g.useEffect)(()=>{v()},[v]);const j=(0,g.useMemo)(()=>{let y=c;return n&&(y=y.filter(k=>k.name?.toLowerCase().includes(n.toLowerCase())||k.handle?.toLowerCase().includes(n.toLowerCase()))),y},[c,n]);return{currentUser:t,searchQuery:n,setSearchQuery:r,isCreateModalOpen:l,setIsCreateModalOpen:o,communitiesData:c,isCommunitiesLoading:d,isFetchingMoreCommunities:f,hasMoreCommunities:b,filteredCommunities:j,handleCommunityClick:y=>{e(`/c/${y}`)},loadCommunities:v,navigate:e}};var ea=({id:t,user:e,timeAgo:a,content:i,contentClass:n,media:r,quotedPost:l,stats:o,onClick:c,repostedBy:m,onUserClick:d,currentUser:u,showToast:f,poll:p,isDetail:b,initialComments:x,onDelete:h,isComment:v,onReply:j,community:w})=>{const y=je(),{liked:k,reposted:S,localStats:M,setLocalStats:E,handleLike:F,handleRepost:N}=po(t,o,u,f),{deletePost:P,updatePost:R}=bt(),[L,T]=(0,g.useState)(x||[]),[D,C]=(0,g.useState)(""),[_,z]=(0,g.useState)(!1),[$,q]=(0,g.useState)(!1),[B,Y]=(0,g.useState)(!1),[I,U]=(0,g.useState)(!0),[W,K]=(0,g.useState)([]),[te,G]=(0,g.useState)(!1),[ae,ie]=(0,g.useState)(!1),[le,V]=(0,g.useState)(!1),[X,re]=(0,g.useState)(i),[ne,H]=(0,g.useState)(r||[]),[oe,ee]=(0,g.useState)([]),[ce,be]=(0,g.useState)(!1),[ve,Xe]=(0,g.useState)(!1),Qe=(0,g.useRef)(null),Le=(0,g.useRef)(L);(0,g.useEffect)(()=>{Le.current=L},[L]);const Ae=async()=>{const J=JSON.stringify(ne)!==JSON.stringify(r||[])||oe.length>0;if(!X.trim()||X===i&&!J){V(!1);return}be(!0);try{const Z=[];for(const A of oe){const se=await Me(A);Z.push(se)}await R(t,{content:X,media:[...ne,...Z]}),ee([]),V(!1),f&&f("Post updated")}catch(Z){console.error("Failed to update post:",Z),f&&f("Failed to update post")}finally{be(!1)}},Re=async J=>{J&&J.stopPropagation();try{await P(t),f&&f("Post deleted successfully"),h&&h(t)}catch(Z){console.error("Failed to delete post:",Z),f&&f("Failed to delete post")}finally{ie(!1)}},we=(0,g.useCallback)(async(J=!1)=>{if(t){J?Y(!0):z(!0);try{const Z=Le.current,A=await sn(t,J&&Z.length>0?Z[Z.length-1].created_at:null,10);A.length<10?U(!1):U(!0),T(J?se=>[...se,...A]:A)}catch(Z){console.error("Failed to load comments:",Z)}finally{z(!1),Y(!1)}}},[t]);(0,g.useEffect)(()=>{b&&t&&we()},[b,t,we]);const st=async J=>{if(J.preventDefault(),!(!D.trim()&&W.length===0||!u)){q(!0),G(!0);try{const Z=[];for(const A of W){const se=await Me(A);Z.push(se)}await an(t,u.id,D,Z),C(""),K([]),E(A=>({...A,comments:(A.comments||0)+1})),f&&f("Reply posted!"),we()}catch(Z){console.error("Failed to post comment:",Z),f&&f("Failed to post reply.")}finally{q(!1),G(!1)}}},De=J=>{J.stopPropagation();const Z=`${window.location.origin}/post/${t}`;navigator.clipboard.writeText(Z),f&&f("Link copied to clipboard!")},Ie=({trigger:J})=>(0,s.jsxs)(Bs,{children:[(0,s.jsx)(Ws,{asChild:!0,onClick:Z=>Z.stopPropagation(),children:J}),(0,s.jsxs)(Us,{align:"end",className:"w-48 rounded-xl bg-white dark:bg-zinc-900 border-zinc-100 dark:border-zinc-800",children:[(0,s.jsxs)(Ke,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5",onClick:De,children:[(0,s.jsx)(is,{size:16}),(0,s.jsx)("span",{children:"Copy link to post"})]}),!v&&(0,s.jsxs)(Ke,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5",onClick:Z=>{Z.stopPropagation(),f&&f("Post reported")},children:[(0,s.jsx)(ja,{size:16}),(0,s.jsx)("span",{children:"Report post"})]}),!Ee&&(0,s.jsxs)(Ke,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5 text-rose-500 focus:text-rose-500",onClick:Z=>{Z.stopPropagation(),f&&f("User blocked")},children:[(0,s.jsx)(pi,{size:16}),(0,s.jsxs)("span",{children:["Block @",e.handle]})]}),Ee&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Pr,{className:"bg-zinc-100 dark:bg-zinc-800"}),(0,s.jsxs)(Ke,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-900 py-2.5",onClick:Z=>{Z.stopPropagation(),V(!0)},children:[(0,s.jsx)(xs,{size:16}),(0,s.jsx)("span",{children:"Edit post"})]}),(0,s.jsxs)(Ke,{className:"gap-2 cursor-pointer focus:bg-rose-50 dark:focus:bg-rose-900/20 py-2.5 text-rose-500 focus:text-rose-500",onClick:Z=>{Z.stopPropagation(),ie(!0)},children:[(0,s.jsx)(bs,{size:16}),(0,s.jsx)("span",{children:"Delete post"})]})]})]})]}),Ee=u?.handle===e.handle,qe=J=>{if(!J)return null;const Z=le?ne:J;return!Z||Array.isArray(Z)&&Z.length===0?null:le?(0,s.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,s.jsxs)("div",{className:"grid gap-2 grid-cols-2 sm:grid-cols-3",children:[ne.map((A,se)=>(0,s.jsxs)("div",{className:"relative aspect-square rounded-xl overflow-hidden border border-zinc-200 dark:border-zinc-800 group",children:[A.type==="video"?(0,s.jsx)("div",{className:"size-full bg-zinc-100 dark:bg-zinc-900 flex items-center justify-center",children:(0,s.jsx)(ut,{size:24,className:"text-zinc-400"})}):(0,s.jsx)("img",{src:A.url||A.src,className:"size-full object-cover",alt:""}),(0,s.jsx)("button",{onClick:Se=>{Se.stopPropagation(),H(ge=>ge.filter((Ne,ze)=>ze!==se))},className:"absolute top-1.5 right-1.5 size-7 rounded-full bg-black/60 text-white flex items-center justify-center hover:bg-black transition-colors",children:(0,s.jsx)(_e,{size:16})})]},`old-${se}`)),oe.map((A,se)=>(0,s.jsxs)("div",{className:"relative aspect-square rounded-xl overflow-hidden border-2 border-dashed border-violet-500 bg-violet-50/10 group",children:[A.type.startsWith("image/")?(0,s.jsx)("img",{src:URL.createObjectURL(A),className:"size-full object-cover",alt:""}):(0,s.jsx)("div",{className:"size-full flex items-center justify-center",children:(0,s.jsx)(ut,{size:24,className:"text-violet-500 animate-pulse"})}),(0,s.jsx)("button",{onClick:Se=>{Se.stopPropagation(),ee(ge=>ge.filter((Ne,ze)=>ze!==se))},className:"absolute top-1.5 right-1.5 size-7 rounded-full bg-black/60 text-white flex items-center justify-center hover:bg-black transition-colors",children:(0,s.jsx)(_e,{size:16})}),(0,s.jsx)("div",{className:"absolute bottom-1 left-1 bg-violet-600 text-white text-[8px] font-bold px-1 rounded",children:"NEW"})]},`new-${se}`)),ne.length+oe.length<4&&(0,s.jsxs)("button",{onClick:A=>{A.stopPropagation(),Qe.current?.click()},className:"relative aspect-square rounded-xl border-2 border-dashed border-zinc-200 dark:border-zinc-800 flex flex-col items-center justify-center gap-1 text-zinc-400 hover:text-violet-500 hover:border-violet-500 hover:bg-violet-50/5 transition-all",children:[(0,s.jsx)(Oe,{size:20}),(0,s.jsx)("span",{className:"text-[10px] font-bold",children:"Add Media"})]})]}),(0,s.jsx)("input",{type:"file",ref:Qe,onChange:A=>{const se=Array.from(A.target.files);ee(Se=>[...Se,...se])},multiple:!0,className:"hidden",accept:"image/*,video/*"})]}):g.isValidElement(Z)?Z:(0,s.jsx)(ro,{items:Z})},Te=(J,Z)=>{const A=typeof J=="string"&&tr(J);if(le)return(0,s.jsxs)("div",{className:"flex flex-col gap-2 mt-2",onClick:se=>se.stopPropagation(),children:[(0,s.jsx)(ul,{value:X,onChange:se=>re(se.target.value),className:`min-h-[100px] w-full bg-zinc-50 dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800 rounded-xl focus:ring-violet-500 ${A?"font-bangla text-lg":"font-english"}`,autoFocus:!0}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)("button",{onClick:()=>{V(!1),re(i),H(r||[]),ee([])},className:"px-4 py-1.5 text-sm font-bold text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-300 transition-colors",children:"Cancel"}),(0,s.jsx)("button",{onClick:Ae,disabled:ce||!X.trim()||X===i,className:"px-4 py-1.5 text-sm font-bold bg-violet-600 text-white rounded-full hover:bg-violet-700 disabled:opacity-50 transition-all active:scale-95",children:ce?"Saving...":"Save"})]})]});if(typeof J=="string"){const se=!b&&J.length>280,Se=se&&!ve?J.substring(0,280):J;return(0,s.jsxs)("div",{className:`whitespace-pre-line ${Z||""} ${A?"font-bangla text-[1.15em] leading-relaxed":"font-english text-[1.05em]"}`,children:[(0,s.jsx)(gs,{options:{formatHref:(ge,Ne)=>Ne==="mention"?`/u/${ge.substring(1)}`:Ne==="hashtag"?`/community?q=${encodeURIComponent(ge)}`:ge,attributes:{onClick:ge=>ge.stopPropagation(),className:"text-rose-500 dark:text-rose-400 font-bold hover:underline cursor-pointer"},render:({attributes:ge,content:Ne})=>{const{href:ze,...Tt}=ge,Ot=!ze.startsWith("/")&&(ze.startsWith("http")||ze.startsWith("www"));return ze.startsWith("/u/")||ze.startsWith("/community")?(0,s.jsx)("span",{...Tt,onClick:ta=>{ta.stopPropagation(),y(ze)},children:Ne},Ne):(0,s.jsx)("a",{href:ze,...Tt,target:Ot?"_blank":void 0,rel:Ot?"noopener noreferrer":void 0,children:Ne},Ne)}},children:Se}),se&&!ve&&"...",se&&(0,s.jsx)("button",{onClick:ge=>{ge.stopPropagation(),Xe(!ve)},className:"ml-1 text-rose-500 dark:text-rose-400 font-bold hover:underline cursor-pointer",children:ve?"Show less":"See more"})]})}return J},Be=J=>{C(Z=>{const A=`@${J} `;return Z.includes(A)?Z:Z+A}),document.getElementById("comment-input")?.focus()};return b?(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("article",{className:"p-5 dark:bg-black",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex items-start gap-x-3",children:[(0,s.jsx)("button",{className:"shrink-0",onClick:()=>d&&d(e.handle),children:(0,s.jsxs)(fe,{className:"size-12 border border-zinc-200 dark:border-zinc-700",children:[(0,s.jsx)(xe,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,s.jsx)(he,{children:e.handle[0]?.toUpperCase()})]})}),(0,s.jsxs)("div",{className:"flex flex-col min-w-0",children:[(0,s.jsx)("div",{className:"flex flex-wrap items-center gap-x-1.5",children:(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-1.5 text-base sm:text-lg",children:[(0,s.jsxs)("button",{className:"font-bold hover:underline text-zinc-900 dark:text-white flex items-center gap-1 shrink-0",onClick:()=>d&&d(e.handle),children:[e.handle,e.verified&&(0,s.jsx)(it,{})]}),w&&(0,s.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,s.jsx)("span",{className:"text-zinc-400 font-medium text-sm sm:text-base",children:">"}),(0,s.jsxs)("button",{className:"flex items-center gap-1 font-bold text-zinc-900 dark:text-zinc-100 hover:underline",onClick:J=>{J.stopPropagation(),y(`/c/${w.handle}`)},children:[(0,s.jsxs)(fe,{className:"size-5 bg-zinc-100 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700",children:[(0,s.jsx)(xe,{src:w.avatar,alt:w.name,className:"object-cover"}),(0,s.jsx)(he,{className:"text-[9px] font-bold text-zinc-500",children:w.name?.[0]?.toUpperCase()})]}),w.name]})]})]})}),(0,s.jsxs)("span",{className:"text-xs sm:text-sm text-zinc-500 dark:text-zinc-400 font-medium",children:["@",e.handle]})]})]}),(0,s.jsx)(Ie,{trigger:(0,s.jsx)("button",{className:"text-zinc-500 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full p-2 transition-colors",children:(0,s.jsx)(_t,{size:20})})})]}),(0,s.jsx)("div",{className:"break-words text-zinc-900 dark:text-zinc-100 mt-4 text-lg sm:text-xl leading-relaxed sm:leading-8 whitespace-pre-line",children:Te(i,n)}),ct(i)&&(0,s.jsx)(Gt,{url:ct(i)}),qe(r),p&&(0,s.jsx)(Zt,{poll:p}),l&&(0,s.jsx)("div",{className:"mt-4 border border-zinc-200 dark:border-zinc-700 rounded-2xl overflow-hidden shadow-sm",children:(0,s.jsx)(es,{...l})}),(0,s.jsx)("div",{className:"my-4 flex items-center text-zinc-500 dark:text-zinc-400 text-sm border-b border-zinc-100 dark:border-zinc-800 pb-4",children:a||"Recent"}),(0,s.jsxs)("div",{className:"border-b border-zinc-100 dark:border-zinc-800 pb-4 flex items-center gap-x-6 text-zinc-500 dark:text-zinc-400 text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,s.jsx)("span",{className:"font-bold text-black dark:text-white",children:M.likes||0})," ",(0,s.jsx)("span",{className:"opacity-70",children:"Likes"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,s.jsx)("span",{className:"font-bold text-black dark:text-white",children:M.comments||0})," ",(0,s.jsx)("span",{className:"opacity-70",children:"Comments"})]})]}),(0,s.jsxs)("div",{className:"mt-4 flex w-full items-center justify-around py-1",children:[(0,s.jsx)(Ye,{icon:at,label:"Like",onClick:F,active:k,activeColorClass:"text-rose-500"}),!v&&(0,s.jsx)(Ye,{icon:wt,label:"Repost",onClick:N,active:S,activeColorClass:"text-emerald-500"}),(0,s.jsx)(Ye,{icon:kt,label:"Comment",onClick:()=>document.getElementById("comment-input")?.focus()})]})]}),(0,s.jsx)(Hl,{currentUser:u,newComment:D,setNewComment:C,handleSubmitComment:st,loading:$,selectedFiles:W,setSelectedFiles:K,isUploading:te}),(0,s.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:_?(0,s.jsx)("div",{className:"p-8 flex justify-center",children:(0,s.jsx)(me,{className:"animate-spin text-violet-500"})}):(0,s.jsxs)(s.Fragment,{children:[I&&L.length>0&&(0,s.jsxs)("button",{onClick:()=>we(!0),disabled:B,className:"w-full py-3 text-sm font-bold text-violet-600 hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors flex items-center justify-center gap-2",children:[B&&(0,s.jsx)(me,{size:14,className:"animate-spin"}),"View more replies"]}),L.map(J=>(0,s.jsx)(ea,{...J,isComment:!0,onReply:Be,onUserClick:d,currentUser:u,showToast:f,onDelete:Z=>T(A=>A.filter(se=>se.id!==Z))},J.id))]})}),(0,s.jsx)(Bt,{open:ae,onOpenChange:ie,children:(0,s.jsxs)(Wt,{onClick:J=>J.stopPropagation(),children:[(0,s.jsxs)(Ut,{children:[(0,s.jsx)(Qt,{children:"Are you absolutely sure?"}),(0,s.jsx)(Jt,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,s.jsxs)(Ht,{children:[(0,s.jsx)(Kt,{onClick:J=>J.stopPropagation(),children:"Cancel"}),(0,s.jsx)(Vt,{onClick:Re,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]}):(0,s.jsxs)("article",{onClick:c,className:`p-4 mb-4 bg-white dark:bg-black border border-zinc-200 dark:border-zinc-800 rounded-xl hover:shadow-md transition-all ${c?"cursor-pointer":""}`,children:[m&&(0,s.jsxs)("div",{className:"mb-2 flex items-center space-x-1.5 text-[13px] text-zinc-500 font-semibold ml-1",children:[(0,s.jsx)(wt,{size:14,className:"text-zinc-400"}),(0,s.jsx)("span",{className:"hover:underline cursor-pointer flex items-center text-zinc-600 dark:text-zinc-400",onClick:J=>{J.stopPropagation(),d&&d(m.handle)},children:(0,s.jsx)("span",{className:"truncate max-w-[150px]",children:typeof m=="object"?m.name:m})}),(0,s.jsx)("span",{className:"text-zinc-400",children:"reposted"})]}),(0,s.jsxs)("div",{className:"flex items-start gap-x-3",children:[(0,s.jsx)("button",{className:"shrink-0 group",onClick:J=>{J.stopPropagation(),d&&d(e.handle)},children:(0,s.jsxs)(fe,{className:"size-11 border border-zinc-200 dark:border-zinc-700 group-hover:brightness-95 transition-all",children:[(0,s.jsx)(xe,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,s.jsx)(he,{children:e.handle[0]?.toUpperCase()})]})}),(0,s.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,s.jsxs)("div",{className:"flex w-full items-start justify-between",children:[(0,s.jsx)("div",{className:"flex flex-col min-w-0 flex-1",children:(0,s.jsx)("div",{className:"flex flex-wrap items-center gap-x-1.5 leading-none",children:(0,s.jsxs)("div",{className:"flex items-center gap-1.5 min-w-0 max-w-full",children:[(0,s.jsxs)("button",{className:"font-bold text-[15px] hover:underline text-zinc-900 dark:text-white flex items-center gap-1 shrink-0",onClick:J=>{J.stopPropagation(),d&&d(e.handle)},children:[(0,s.jsx)("span",{className:"truncate max-w-[120px] sm:max-w-[200px]",children:e.handle}),e.verified&&(0,s.jsx)(it,{})]}),w&&(0,s.jsxs)("div",{className:"flex items-center gap-1 min-w-0 text-zinc-500",children:[(0,s.jsx)("span",{className:"text-zinc-400 font-medium shrink-0 text-xs sm:text-sm",children:">"}),(0,s.jsxs)("button",{className:"flex items-center gap-1 font-bold text-zinc-900 dark:text-zinc-100 hover:underline truncate max-w-[100px] sm:max-w-[180px] text-[14px] sm:text-[15px]",onClick:J=>{J.stopPropagation(),y(`/c/${w.handle}`)},children:[(0,s.jsxs)(fe,{className:"size-4 bg-zinc-100 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700",children:[(0,s.jsx)(xe,{src:w.avatar,alt:w.name,className:"object-cover"}),(0,s.jsx)(he,{className:"text-[8px] font-bold text-zinc-500",children:w.name?.[0]?.toUpperCase()})]}),w.name]})]}),(0,s.jsx)("span",{className:"text-zinc-400 text-xs sm:text-sm whitespace-nowrap pt-0.5 ml-1",children:a||"Recent"})]})})}),(0,s.jsx)(Ie,{trigger:(0,s.jsx)("button",{className:"text-zinc-400 hover:bg-zinc-100 hover:text-zinc-700 dark:hover:bg-zinc-800 dark:hover:text-zinc-200 rounded-full p-2 -mr-2 transition-colors",children:(0,s.jsx)(_t,{size:18})})})]}),(0,s.jsxs)("div",{className:"break-words text-zinc-900 dark:text-zinc-100 mt-1 whitespace-pre-line text-sm sm:text-[15px] leading-relaxed",children:[Te(i,n),ct(i)&&(0,s.jsx)(Gt,{url:ct(i)}),qe(r),p&&(0,s.jsx)(Zt,{poll:p,onVote:()=>f&&f("Voted!")}),l&&(0,s.jsx)("div",{className:"mt-3 border border-zinc-200 dark:border-zinc-700 rounded-2xl overflow-hidden bg-white dark:bg-zinc-900 hover:bg-zinc-50 dark:hover:bg-zinc-800 transition-colors cursor-pointer",onClick:J=>J.stopPropagation(),children:(0,s.jsx)(es,{...l})})]}),(0,s.jsx)("div",{className:"mt-3 flex w-full flex-wrap items-center justify-between gap-3 pr-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4 sm:gap-x-8",children:[(0,s.jsx)(Ye,{icon:at,label:"Like",count:M.likes,active:k,onClick:F,activeColorClass:"text-rose-500"}),!v&&(0,s.jsx)(Ye,{icon:wt,label:"Repost",count:M.mirrors,active:S,onClick:N,activeColorClass:"text-emerald-500"}),(0,s.jsx)(Ye,{icon:kt,label:"Comment",count:M.comments,onClick:J=>{v&&j?(J.stopPropagation(),j(e.handle)):c&&c(J)}})]})})]})]}),(0,s.jsx)(Bt,{open:ae,onOpenChange:ie,children:(0,s.jsxs)(Wt,{onClick:J=>J.stopPropagation(),children:[(0,s.jsxs)(Ut,{children:[(0,s.jsx)(Qt,{children:"Are you absolutely sure?"}),(0,s.jsx)(Jt,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,s.jsxs)(Ht,{children:[(0,s.jsx)(Kt,{onClick:J=>J.stopPropagation(),children:"Cancel"}),(0,s.jsx)(Vt,{onClick:Re,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]})},vt=ea,yo=Q(),wo=t=>{const e=(0,yo.c)(23),{user:a,time:i,content:n}=t;let r;e[0]!==a.avatar||e[1]!==a.handle?(r=(0,s.jsx)(xe,{src:a.avatar,alt:a.handle}),e[0]=a.avatar,e[1]=a.handle,e[2]=r):r=e[2];let l;e[3]!==a.handle[0]?(l=a.handle[0]?.toUpperCase(),e[3]=a.handle[0],e[4]=l):l=e[4];let o;e[5]!==l?(o=(0,s.jsx)(he,{children:l}),e[5]=l,e[6]=o):o=e[6];let c;e[7]!==r||e[8]!==o?(c=(0,s.jsxs)(fe,{className:"size-6",children:[r,o]}),e[7]=r,e[8]=o,e[9]=c):c=e[9];let m;e[10]!==a.handle?(m=(0,s.jsx)("span",{className:"font-semibold text-sm",children:a.handle}),e[10]=a.handle,e[11]=m):m=e[11];let d;e[12]!==i?(d=(0,s.jsxs)("span",{className:"text-zinc-500 text-sm",children:[" ",i]}),e[12]=i,e[13]=d):d=e[13];let u;e[14]!==c||e[15]!==m||e[16]!==d?(u=(0,s.jsxs)("div",{className:"flex items-center gap-x-2 mb-2",children:[c,m,d]}),e[14]=c,e[15]=m,e[16]=d,e[17]=u):u=e[17];let f;e[18]!==n?(f=(0,s.jsx)("p",{className:"text-sm text-zinc-800 dark:text-zinc-300 whitespace-pre-line",children:n}),e[18]=n,e[19]=f):f=e[19];let p;return e[20]!==u||e[21]!==f?(p=(0,s.jsxs)("div",{className:"p-4",children:[u,f]}),e[20]=u,e[21]=f,e[22]=p):p=e[22],p},es=wo,No=Q(),zo=t=>{const e=(0,No.c)(56),{reel:a}=t,i=(0,g.useRef)(null),[n,r]=(0,g.useState)(!1),l=(0,g.useRef)(0),o=Array.isArray(a.media)?a.media[0]?.src||a.media[0]?.url:a.media?.src||a.media?.url||a.url;let c,m;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=()=>{const ae=new IntersectionObserver(le=>{const[V]=le;i.current?.plyr&&(V.isIntersecting?i.current.plyr.play().catch(()=>{i.current.plyr.muted=!0,i.current.plyr.play()}):i.current.plyr.pause())},{threshold:.8}),ie=i.current?.elements?.container;return ie&&ae.observe(ie),()=>{ie&&ae.unobserve(ie)}},m=[],e[0]=c,e[1]=m):(c=e[0],m=e[1]),(0,g.useEffect)(c,m);let d;e[2]===Symbol.for("react.memo_cache_sentinel")?(d=()=>{const ae=Date.now();ae-l.current<300&&(r(!0),setTimeout(()=>r(!1),800)),l.current=ae},e[2]=d):d=e[2];const u=d;let f;e[3]!==o?(f={type:"video",sources:[{src:o,type:"video/mp4"}]},e[3]=o,e[4]=f):f=e[4];let p;e[5]===Symbol.for("react.memo_cache_sentinel")?(p={controls:[],loop:{active:!0},clickToPlay:!0,ratio:"9:16"},e[5]=p):p=e[5];let b;e[6]!==f?(b={source:f,options:p},e[6]=f,e[7]=b):b=e[7];const x=b;let h;e[8]!==x?(h=(0,s.jsx)("div",{className:"w-full h-full max-w-[450px]",children:(0,s.jsx)(js,{ref:i,...x})}),e[8]=x,e[9]=h):h=e[9];let v;e[10]!==n?(v=n&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-50 animate-in zoom-in-50 fade-in duration-300",children:(0,s.jsx)(at,{size:100,fill:"white",className:"text-white drop-shadow-2xl scale-125"})}),e[10]=n,e[11]=v):v=e[11];let j;e[12]===Symbol.for("react.memo_cache_sentinel")?(j=(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-black/60 pointer-events-none"}),e[12]=j):j=e[12];const w=a.user?.avatar,y=a.user?.handle;let k;e[13]!==w||e[14]!==y?(k=(0,s.jsx)(xe,{src:w,alt:y,className:"object-cover"}),e[13]=w,e[14]=y,e[15]=k):k=e[15];let S;e[16]!==a.user?.handle?.[0]?(S=a.user?.handle?.[0]?.toUpperCase(),e[16]=a.user?.handle?.[0],e[17]=S):S=e[17];let M;e[18]!==S?(M=(0,s.jsx)(he,{children:S}),e[18]=S,e[19]=M):M=e[19];let E;e[20]!==k||e[21]!==M?(E=(0,s.jsxs)(fe,{className:"size-10 border-2 border-white",children:[k,M]}),e[20]=k,e[21]=M,e[22]=E):E=e[22];const F=a.user?.handle;let N;e[23]!==F?(N=(0,s.jsxs)("span",{className:"font-bold",children:["@",F]}),e[23]=F,e[24]=N):N=e[24];let P;e[25]===Symbol.for("react.memo_cache_sentinel")?(P=(0,s.jsx)("button",{className:"bg-white text-black text-xs font-bold px-3 py-1 rounded-full ml-2 hover:scale-105 active:scale-95 transition-all",children:"Follow"}),e[25]=P):P=e[25];let R;e[26]!==E||e[27]!==N?(R=(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3 pointer-events-auto",children:[E,N,P]}),e[26]=E,e[27]=N,e[28]=R):R=e[28];let L;e[29]!==a.content?(L=(0,s.jsx)("p",{className:"text-sm mb-3 line-clamp-2",children:a.content}),e[29]=a.content,e[30]=L):L=e[30];let T;e[31]===Symbol.for("react.memo_cache_sentinel")?(T=(0,s.jsx)(ra,{size:14,className:"animate-spin-slow"}),e[31]=T):T=e[31];const D=a.user?.handle;let C;e[32]!==D?(C=(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs opacity-90",children:[T,(0,s.jsxs)("span",{children:["Original Audio - ",D]})]}),e[32]=D,e[33]=C):C=e[33];let _;e[34]!==R||e[35]!==L||e[36]!==C?(_=(0,s.jsxs)("div",{className:"absolute bottom-20 left-4 right-16 text-white pointer-events-none",children:[R,L,C]}),e[34]=R,e[35]=L,e[36]=C,e[37]=_):_=e[37];let z;e[38]===Symbol.for("react.memo_cache_sentinel")?(z=(0,s.jsx)("button",{className:"p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90",children:(0,s.jsx)(at,{size:28})}),e[38]=z):z=e[38];const $=a.stats?.likes||0;let q;e[39]!==$?(q=(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[z,(0,s.jsx)("span",{className:"text-white text-xs font-bold",children:$})]}),e[39]=$,e[40]=q):q=e[40];let B;e[41]===Symbol.for("react.memo_cache_sentinel")?(B=(0,s.jsx)("button",{className:"p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90",children:(0,s.jsx)(kt,{size:28})}),e[41]=B):B=e[41];const Y=a.stats?.comments||0;let I;e[42]!==Y?(I=(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[B,(0,s.jsx)("span",{className:"text-white text-xs font-bold",children:Y})]}),e[42]=Y,e[43]=I):I=e[43];let U;e[44]===Symbol.for("react.memo_cache_sentinel")?(U=(0,s.jsx)("button",{className:"p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90",children:(0,s.jsx)(gi,{size:28})}),e[44]=U):U=e[44];const W=a.stats?.shares||0;let K;e[45]!==W?(K=(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[U,(0,s.jsx)("span",{className:"text-white text-xs font-bold",children:W})]}),e[45]=W,e[46]=K):K=e[46];let te;e[47]!==q||e[48]!==I||e[49]!==K?(te=(0,s.jsxs)("div",{className:"absolute bottom-20 right-2 flex flex-col items-center gap-6 z-10",children:[q,I,K]}),e[47]=q,e[48]=I,e[49]=K,e[50]=te):te=e[50];let G;return e[51]!==_||e[52]!==te||e[53]!==h||e[54]!==v?(G=(0,s.jsxs)("div",{className:"relative h-screen w-full bg-black snap-start flex items-center justify-center overflow-hidden",onClick:u,children:[h,v,j,_,te]}),e[51]=_,e[52]=te,e[53]=h,e[54]=v,e[55]=G):G=e[55],G},ko=zo,_o=Q(),Co=t=>{const e=(0,_o.c)(96),{onPostInCommunity:a}=t,[i,n]=g.useState(!1),{community:r,loading:l,isMember:o,userRole:c,isJoining:m,communityPosts:d,loadingPosts:u,isFetchingMorePosts:f,hasMorePosts:p,handleJoinToggle:b,loadCommunityPosts:x,currentUser:h,addToast:v,navigate:j}=vo(),w=o&&(!r.isPrivate||c==="admin");if(l){let ce;return e[0]===Symbol.for("react.memo_cache_sentinel")?(ce=(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)(me,{size:40,className:"animate-spin text-violet-500"})}),e[0]=ce):ce=e[0],ce}if(!r){const ce=`The community @${r?.handle||"unknown"} could not be found.`;let be;return e[1]!==ce?(be=(0,s.jsx)("div",{className:"bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-[600px] flex items-center justify-center",children:(0,s.jsx)(It,{title:"Community doesn't exist",message:ce,icon:Ge})}),e[1]=ce,e[2]=be):be=e[2],be}let y;e[3]!==j?(y=()=>j(-1),e[3]=j,e[4]=y):y=e[4];let k;e[5]===Symbol.for("react.memo_cache_sentinel")?(k=(0,s.jsx)(Ze,{size:22}),e[5]=k):k=e[5];let S;e[6]!==y?(S=(0,s.jsx)("button",{onClick:y,className:"p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:k}),e[6]=y,e[7]=S):S=e[7];let M;e[8]!==r.name?(M=(0,s.jsx)("h5",{className:"text-lg font-bold dark:text-white leading-none",children:r.name}),e[8]=r.name,e[9]=M):M=e[9];let E;e[10]!==r.membersCount?(E=(0,s.jsxs)("span",{className:"text-xs text-zinc-500 mt-0.5",children:[r.membersCount," Members"]}),e[10]=r.membersCount,e[11]=E):E=e[11];let F;e[12]!==M||e[13]!==E?(F=(0,s.jsxs)("div",{className:"flex flex-col",children:[M,E]}),e[12]=M,e[13]=E,e[14]=F):F=e[14];let N;e[15]!==S||e[16]!==F?(N=(0,s.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4",children:[S,F]})}),e[15]=S,e[16]=F,e[17]=N):N=e[17];let P;e[18]!==r.cover?(P=(0,s.jsx)("div",{className:"h-32 sm:h-52 bg-zinc-100 dark:bg-zinc-900 overflow-hidden relative",children:r.cover?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("img",{src:r.cover,className:"w-full h-full object-cover",alt:""}),(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 to-transparent"})]}):(0,s.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-violet-500/20 to-fuchsia-500/20"})}),e[18]=r.cover,e[19]=P):P=e[19];let R;e[20]!==r.avatar?(R=(0,s.jsx)("div",{className:"size-24 sm:size-32 rounded-3xl border-4 border-white dark:border-black bg-zinc-100 dark:bg-zinc-800 overflow-hidden shadow-xl",children:(0,s.jsx)("img",{src:r.avatar,className:"size-full object-cover",alt:""})}),e[20]=r.avatar,e[21]=R):R=e[21];let L;e[22]!==c?(L=c==="admin"&&(0,s.jsx)(ue,{variant:"outline",onClick:()=>n(!0),className:"rounded-full font-bold px-6 h-10 border-zinc-200 dark:border-zinc-800",children:"Edit"}),e[22]=c,e[23]=L):L=e[23];const T=o?"outline":"default",D=`rounded-full font-bold px-8 h-10 transition-all ${o?"border-zinc-200 dark:border-zinc-800 hover:bg-rose-50 hover:text-rose-500 hover:border-rose-100 dark:hover:bg-rose-900/20":"bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 hover:scale-105"}`;let C;e[24]!==m||e[25]!==o?(C=m?(0,s.jsx)(me,{size:18,className:"animate-spin"}):o?"Joined":"Join",e[24]=m,e[25]=o,e[26]=C):C=e[26];let _;e[27]!==b||e[28]!==m||e[29]!==T||e[30]!==D||e[31]!==C?(_=(0,s.jsx)(ue,{variant:T,onClick:b,disabled:m,className:D,children:C}),e[27]=b,e[28]=m,e[29]=T,e[30]=D,e[31]=C,e[32]=_):_=e[32];let z;e[33]!==L||e[34]!==_?(z=(0,s.jsxs)("div",{className:"pb-1 flex gap-2",children:[L,_]}),e[33]=L,e[34]=_,e[35]=z):z=e[35];let $;e[36]!==z||e[37]!==R?($=(0,s.jsxs)("div",{className:"flex justify-between items-end -mt-12 sm:-mt-16 mb-4 relative z-10",children:[R,z]}),e[36]=z,e[37]=R,e[38]=$):$=e[38];let q;e[39]!==r.name?(q=(0,s.jsx)("h1",{className:"text-2xl sm:text-3xl font-black dark:text-white tracking-tight leading-tight",children:r.name}),e[39]=r.name,e[40]=q):q=e[40];let B;e[41]!==r.handle?(B=(0,s.jsxs)("p",{className:"text-zinc-500 font-bold text-sm sm:text-base",children:["c/",r.handle]}),e[41]=r.handle,e[42]=B):B=e[42];let Y;e[43]!==r.description?(Y=r.description&&(0,s.jsx)("p",{className:"mt-4 text-[15px] sm:text-base dark:text-zinc-300 leading-relaxed max-w-2xl",children:r.description}),e[43]=r.description,e[44]=Y):Y=e[44];let I;e[45]!==r.membersCount?(I=(0,s.jsx)("span",{className:"text-lg font-black dark:text-white",children:r.membersCount}),e[45]=r.membersCount,e[46]=I):I=e[46];let U;e[47]===Symbol.for("react.memo_cache_sentinel")?(U=(0,s.jsx)("span",{className:"text-[11px] font-bold uppercase tracking-widest text-zinc-500",children:"Members"}),e[47]=U):U=e[47];let W;e[48]!==I?(W=(0,s.jsxs)("div",{className:"flex flex-col",children:[I,U]}),e[48]=I,e[49]=W):W=e[49];let K;e[50]!==r.postsCount?(K=(0,s.jsx)("span",{className:"text-lg font-black dark:text-white",children:r.postsCount}),e[50]=r.postsCount,e[51]=K):K=e[51];let te;e[52]===Symbol.for("react.memo_cache_sentinel")?(te=(0,s.jsx)("span",{className:"text-[11px] font-bold uppercase tracking-widest text-zinc-500",children:"Posts"}),e[52]=te):te=e[52];let G;e[53]!==K?(G=(0,s.jsxs)("div",{className:"flex flex-col",children:[K,te]}),e[53]=K,e[54]=G):G=e[54];let ae;e[55]!==W||e[56]!==G?(ae=(0,s.jsxs)("div",{className:"flex gap-6 mt-5",children:[W,G]}),e[55]=W,e[56]=G,e[57]=ae):ae=e[57];let ie;e[58]!==q||e[59]!==B||e[60]!==Y||e[61]!==ae?(ie=(0,s.jsxs)("div",{className:"space-y-1",children:[q,B,Y,ae]}),e[58]=q,e[59]=B,e[60]=Y,e[61]=ae,e[62]=ie):ie=e[62];let le;e[63]!==$||e[64]!==ie?(le=(0,s.jsxs)("div",{className:"px-4 pb-6",children:[$,ie]}),e[63]=$,e[64]=ie,e[65]=le):le=e[65];let V;e[66]!==le||e[67]!==P?(V=(0,s.jsxs)("div",{className:"relative",children:[P,le]}),e[66]=le,e[67]=P,e[68]=V):V=e[68];let X;e[69]!==v||e[70]!==r.id||e[71]!==r.name||e[72]!==d||e[73]!==h||e[74]!==p||e[75]!==f||e[76]!==x||e[77]!==u||e[78]!==j?(X=(0,s.jsx)("div",{className:"border-t border-zinc-100 dark:border-zinc-800",children:u?(0,s.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,s.jsx)(me,{className:"animate-spin text-violet-500",size:32})}):d.length>0?(0,s.jsxs)(s.Fragment,{children:[d.map(ce=>(0,s.jsx)(vt,{currentUser:h,showToast:v,...ce,onClick:()=>j(`/post/${ce.id}`),onUserClick:be=>j(`/u/${be}`)},ce.feed_id||ce.id)),p&&(0,s.jsx)("div",{className:"p-6 flex justify-center",children:(0,s.jsxs)(ue,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>x(r.id,!0),disabled:f,children:[f&&(0,s.jsx)(me,{size:18,className:"animate-spin mr-2"}),"Load more"]})})]}):(0,s.jsxs)("div",{className:"p-20 text-center text-zinc-500 flex flex-col items-center gap-4",children:[(0,s.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full mb-2",children:(0,s.jsx)(Ge,{size:40,className:"text-zinc-300"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"No posts here yet"}),(0,s.jsxs)("p",{className:"text-sm max-w-[250px]",children:["Be the first to share something in ",r.name,"!"]})]})}),e[69]=v,e[70]=r.id,e[71]=r.name,e[72]=d,e[73]=h,e[74]=p,e[75]=f,e[76]=x,e[77]=u,e[78]=j,e[79]=X):X=e[79];let re;e[80]!==V||e[81]!==X||e[82]!==N?(re=(0,s.jsxs)("div",{className:"relative",children:[N,V,X]}),e[80]=V,e[81]=X,e[82]=N,e[83]=re):re=e[83];let ne;e[84]!==w||e[85]!==r||e[86]!==a?(ne=w&&(0,s.jsx)("button",{onClick:()=>a(r),className:"fixed bottom-20 right-5 md:hidden z-50 bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 size-12 rounded-full flex items-center justify-center shadow-2xl hover:scale-110 active:scale-90 transition-all cursor-pointer group",title:`Post to ${r.name}`,children:(0,s.jsx)(Oe,{size:28,className:"group-hover:rotate-90 transition-transform duration-300"})}),e[84]=w,e[85]=r,e[86]=a,e[87]=ne):ne=e[87];let H;e[88]===Symbol.for("react.memo_cache_sentinel")?(H=()=>n(!1),e[88]=H):H=e[88];let oe;e[89]!==r||e[90]!==i?(oe=(0,s.jsx)(Sl,{isOpen:i,onClose:H,community:r,onUpdate:$o}),e[89]=r,e[90]=i,e[91]=oe):oe=e[91];let ee;return e[92]!==re||e[93]!==ne||e[94]!==oe?(ee=(0,s.jsxs)("div",{className:"border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:[re,ne,oe]}),e[92]=re,e[93]=ne,e[94]=oe,e[95]=ee):ee=e[95],ee},So=Co;function $o(){window.location.reload()}var Po=Q(),Mo=()=>{const t=(0,Po.c)(36),{currentUser:e,searchQuery:a,setSearchQuery:i,isCreateModalOpen:n,setIsCreateModalOpen:r,communitiesData:l,isCommunitiesLoading:o,isFetchingMoreCommunities:c,hasMoreCommunities:m,filteredCommunities:d,handleCommunityClick:u,loadCommunities:f}=jo();if(o&&!l.length){let F;return t[0]===Symbol.for("react.memo_cache_sentinel")?(F=(0,s.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:[1,2,3].map(Lo)}),t[0]=F):F=t[0],F}let p;t[1]!==i?(p=()=>i(""),t[1]=i,t[2]=p):p=t[2];let b;t[3]!==a||t[4]!==i||t[5]!==p?(b=(0,s.jsx)(ft,{value:a,onChange:i,onClear:p,placeholder:"Search communities...",className:"flex-1"}),t[3]=a,t[4]=i,t[5]=p,t[6]=b):b=t[6];let x;t[7]!==e||t[8]!==r?(x=e&&(0,s.jsx)("button",{onClick:()=>r(!0),className:"size-11 rounded-xl bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 flex items-center justify-center hover:scale-105 active:scale-95 transition-all shadow-sm shrink-0",title:"Create Community",children:(0,s.jsx)(Oe,{size:22,strokeWidth:3})}),t[7]=e,t[8]=r,t[9]=x):x=t[9];let h;t[10]!==b||t[11]!==x?(h=(0,s.jsxs)("div",{className:"p-4 flex gap-2",children:[b,x]}),t[10]=b,t[11]=x,t[12]=h):h=t[12];let v;t[13]===Symbol.for("react.memo_cache_sentinel")?(v=(0,s.jsxs)("div",{className:"px-5 py-2 border-t border-zinc-100 dark:border-zinc-800",children:[(0,s.jsx)("h2",{className:"text-lg font-bold dark:text-white",children:"Communities"}),(0,s.jsx)("p",{className:"text-xs text-zinc-500",children:"Discover and join interest-based groups"})]}),t[13]=v):v=t[13];let j;t[14]!==h?(j=(0,s.jsxs)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-10 border-b border-zinc-100 dark:border-zinc-800",children:[h,v]}),t[14]=h,t[15]=j):j=t[15];let w;t[16]!==d||t[17]!==u?(w=d.length>0?d.map(F=>(0,s.jsx)(Xs,{profile:F,onUserClick:u,isCommunity:!0},F.handle)):(0,s.jsx)("div",{className:"p-20 text-center text-zinc-500",children:(0,s.jsx)("p",{className:"font-bold",children:"No communities found"})}),t[16]=d,t[17]=u,t[18]=w):w=t[18];let y;t[19]!==d.length||t[20]!==m||t[21]!==c||t[22]!==f?(y=m&&d.length>0&&(0,s.jsx)("div",{className:"p-6 flex justify-center border-t border-zinc-100 dark:border-zinc-800",children:(0,s.jsxs)(ue,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>f(!0),disabled:c,children:[c&&(0,s.jsx)(me,{size:18,className:"animate-spin mr-2"}),"Load more"]})}),t[19]=d.length,t[20]=m,t[21]=c,t[22]=f,t[23]=y):y=t[23];let k;t[24]!==w||t[25]!==y?(k=(0,s.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:[w,y]}),t[24]=w,t[25]=y,t[26]=k):k=t[26];let S;t[27]!==r?(S=()=>r(!1),t[27]=r,t[28]=S):S=t[28];let M;t[29]!==n||t[30]!==S?(M=(0,s.jsx)(Nl,{isOpen:n,onClose:S}),t[29]=n,t[30]=S,t[31]=M):M=t[31];let E;return t[32]!==M||t[33]!==j||t[34]!==k?(E=(0,s.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm",children:[j,k,M]}),t[32]=M,t[33]=j,t[34]=k,t[35]=E):E=t[35],E},Fo=Mo;function Lo(t){return(0,s.jsx)(qt,{},t)}var Ro=Q(),Io=t=>{const e=(0,Ro.c)(24),{user:a,onClick:i,isAddStory:n}=t,r=n===void 0?!1:n,l=`relative p-0.5 rounded-full ${r?"bg-transparent":"bg-gradient-to-tr from-yellow-400 via-pink-500 to-violet-600"}`;let o;e[0]!==a.avatar||e[1]!==a.handle?(o=(0,s.jsx)(xe,{src:a.avatar,alt:a.handle,className:"object-cover"}),e[0]=a.avatar,e[1]=a.handle,e[2]=o):o=e[2];let c;e[3]!==a.handle?.[0]?(c=a.handle?.[0]?.toUpperCase(),e[3]=a.handle?.[0],e[4]=c):c=e[4];let m;e[5]!==c?(m=(0,s.jsx)(he,{children:c}),e[5]=c,e[6]=m):m=e[6];let d;e[7]!==o||e[8]!==m?(d=(0,s.jsxs)(fe,{className:"size-14 sm:size-16 border border-zinc-100 dark:border-zinc-800",children:[o,m]}),e[7]=o,e[8]=m,e[9]=d):d=e[9];let u;e[10]!==r?(u=r&&(0,s.jsx)("div",{className:"absolute bottom-0 right-0 bg-violet-600 border-2 border-white dark:border-black rounded-full p-1 text-white shadow-lg",children:(0,s.jsx)(Oe,{size:14,strokeWidth:3})}),e[10]=r,e[11]=u):u=e[11];let f;e[12]!==d||e[13]!==u?(f=(0,s.jsx)("div",{className:"bg-white dark:bg-black rounded-full p-0.5",children:(0,s.jsxs)("div",{className:"relative",children:[d,u]})}),e[12]=d,e[13]=u,e[14]=f):f=e[14];let p;e[15]!==l||e[16]!==f?(p=(0,s.jsx)("div",{className:l,children:f}),e[15]=l,e[16]=f,e[17]=p):p=e[17];const b=r?"Add Story":a.handle;let x;e[18]!==b?(x=(0,s.jsx)("span",{className:"text-[11px] font-semibold text-zinc-600 dark:text-zinc-400 truncate w-16 text-center leading-tight",children:b}),e[18]=b,e[19]=x):x=e[19];let h;return e[20]!==i||e[21]!==x||e[22]!==p?(h=(0,s.jsxs)("button",{onClick:i,className:"flex flex-col items-center gap-2 group shrink-0",children:[p,x]}),e[20]=i,e[21]=x,e[22]=p,e[23]=h):h=e[23],h},ts=Io,Eo=Q(),qo=t=>{const e=(0,Eo.c)(49),{onStoryClick:a,onAddStory:i}=t,{currentUser:n}=pe(),{posts:r,loading:l,hasMore:o,isFetchingNextPage:c,fetchNextPage:m}=bt(),{addToast:d}=Ce(),u=je();let f;e[0]===Symbol.for("react.memo_cache_sentinel")?(f={threshold:.1},e[0]=f):f=e[0];const{ref:p,inView:b}=wi(f);let x,h;e[1]!==m||e[2]!==o||e[3]!==b||e[4]!==c?(x=()=>{b&&o&&!c&&m()},h=[b,o,c,m],e[1]=m,e[2]=o,e[3]=b,e[4]=c,e[5]=x,e[6]=h):(x=e[5],h=e[6]),(0,g.useEffect)(x,h);let v;e[7]===Symbol.for("react.memo_cache_sentinel")?(v={queryKey:["stories"],queryFn:jn},e[7]=v):v=e[7];const{data:j,isLoading:w}=Pe(v);let y;e[8]!==j?(y=j===void 0?[]:j,e[8]=j,e[9]=y):y=e[9];const k=y;let S;if(e[10]!==k){const I={};k.forEach(U=>{if(!U.user)return;const W=U.user.id;I[W]||(I[W]={user:U.user,stories:[]}),I[W].stories.push(U)}),S=Object.values(I),e[10]=k,e[11]=S}else S=e[11];const M=S,E=r;let F;e[12]!==u?(F=I=>{u(`/post/${I}`)},e[12]=u,e[13]=F):F=e[13];const N=F;let P;e[14]!==u?(P=I=>{u(`/u/${I}`)},e[14]=u,e[15]=P):P=e[15];const R=P;if(l||w){let I;return e[16]===Symbol.for("react.memo_cache_sentinel")?(I=(0,s.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:[(0,s.jsxs)(Yt,{className:"w-full whitespace-nowrap border-b border-zinc-100 dark:border-zinc-800",children:[(0,s.jsxs)("div",{className:"flex w-max gap-3 py-4 px-4",children:[(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"}),(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"}),(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"})]}),(0,s.jsx)(St,{orientation:"horizontal",className:"hidden"})]}),[1,2,3].map(Oo)]}),e[16]=I):I=e[16],I}let L;e[17]!==n||e[18]!==i?(L=n&&(0,s.jsx)(ts,{user:n,isAddStory:!0,onClick:i}),e[17]=n,e[18]=i,e[19]=L):L=e[19];let T;e[20]!==M||e[21]!==a?(T=M.map(I=>(0,s.jsx)(ts,{user:I.user,onClick:()=>a(I)},I.user.id)),e[20]=M,e[21]=a,e[22]=T):T=e[22];let D;e[23]!==L||e[24]!==T?(D=(0,s.jsxs)("div",{className:"flex w-max gap-4 py-4 px-4",children:[L,T]}),e[23]=L,e[24]=T,e[25]=D):D=e[25];let C;e[26]===Symbol.for("react.memo_cache_sentinel")?(C=(0,s.jsx)(St,{orientation:"horizontal",className:"hidden"}),e[26]=C):C=e[26];let _;e[27]!==D?(_=(0,s.jsxs)(Yt,{className:"w-full border-b border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black",children:[D,C]}),e[27]=D,e[28]=_):_=e[28];let z;e[29]!==n?(z=!n&&(0,s.jsx)("div",{className:"px-4 py-2 md:hidden",children:(0,s.jsx)(Gs,{className:"p-6"})}),e[29]=n,e[30]=z):z=e[30];let $;e[31]!==d||e[32]!==n||e[33]!==N||e[34]!==R||e[35]!==E?($=E.length>0?E.map(I=>(0,s.jsx)(vt,{...I,currentUser:n,showToast:d,onClick:()=>N(I.id),onUserClick:R},I.feed_id||I.id)):(0,s.jsxs)("div",{className:"p-20 text-center text-zinc-500",children:[(0,s.jsx)("p",{className:"text-lg font-medium",children:"No posts yet."}),(0,s.jsx)("p",{className:"text-sm",children:"Be the first to share something amazing!"})]}),e[31]=d,e[32]=n,e[33]=N,e[34]=R,e[35]=E,e[36]=$):$=e[36];let q;e[37]!==o||e[38]!==E.length||e[39]!==c||e[40]!==p?(q=E.length>0&&(0,s.jsx)("div",{ref:p,className:"py-8 flex justify-center",children:c?(0,s.jsx)(me,{className:"animate-spin text-violet-500",size:24}):o?(0,s.jsx)("div",{className:"h-4"}):(0,s.jsx)("p",{className:"text-sm text-zinc-500 font-medium",children:"You've reached the end of the feed."})}),e[37]=o,e[38]=E.length,e[39]=c,e[40]=p,e[41]=q):q=e[41];let B;e[42]!==$||e[43]!==q?(B=(0,s.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm",children:[$,q]}),e[42]=$,e[43]=q,e[44]=B):B=e[44];let Y;return e[45]!==_||e[46]!==z||e[47]!==B?(Y=(0,s.jsxs)("div",{className:"w-full max-w-full overflow-hidden",children:[_,z,B]}),e[45]=_,e[46]=z,e[47]=B,e[48]=Y):Y=e[48],Y},To=qo;function Oo(t){return(0,s.jsx)(qt,{},t)}var Ao=Q(),Do=t=>{const e=(0,Ao.c)(50),{conv:a,selectedId:i,onSelect:n,onlineUsers:r}=t,l=Zs(a.user?.lastSeen);let o;e[0]!==a.user?.id||e[1]!==r?(o=r.has(a.user?.id),e[0]=a.user?.id,e[1]=r,e[2]=o):o=e[2];const c=o;let m;e[3]!==a||e[4]!==n?(m=()=>n(a),e[3]=a,e[4]=n,e[5]=m):m=e[5];const d=`flex items-center gap-3 p-4 cursor-pointer transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900 ${i===a.id?"bg-zinc-50 dark:bg-zinc-900 border-r-2 border-violet-500":""}`,u=a.user?.avatar,f=a.user?.name;let p;e[6]!==u||e[7]!==f?(p=(0,s.jsx)(xe,{src:u,alt:f,className:"object-cover"}),e[6]=u,e[7]=f,e[8]=p):p=e[8];let b;e[9]!==a.user?.name?.[0]?(b=a.user?.name?.[0]?.toUpperCase(),e[9]=a.user?.name?.[0],e[10]=b):b=e[10];let x;e[11]!==b?(x=(0,s.jsx)(he,{children:b}),e[11]=b,e[12]=x):x=e[12];let h;e[13]!==p||e[14]!==x?(h=(0,s.jsxs)(fe,{className:"size-12",children:[p,x]}),e[13]=p,e[14]=x,e[15]=h):h=e[15];let v;e[16]!==c?(v=c&&(0,s.jsx)("span",{className:"absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full"}),e[16]=c,e[17]=v):v=e[17];let j;e[18]!==v||e[19]!==h?(j=(0,s.jsxs)("div",{className:"relative",children:[h,v]}),e[18]=v,e[19]=h,e[20]=j):j=e[20];const w=a.user?.name;let y;e[21]!==w?(y=(0,s.jsx)("span",{className:"font-bold dark:text-white truncate",children:w}),e[21]=w,e[22]=y):y=e[22];let k;e[23]!==a.user?.lastSeen||e[24]!==c||e[25]!==l?(k=c?(0,s.jsx)("span",{className:"text-[10px] text-emerald-500 font-medium leading-none mb-1",children:"Online"}):a.user?.lastSeen&&(0,s.jsx)("span",{className:"text-[10px] text-zinc-500 font-medium leading-none mb-1",children:l}),e[23]=a.user?.lastSeen,e[24]=c,e[25]=l,e[26]=k):k=e[26];let S;e[27]!==y||e[28]!==k?(S=(0,s.jsxs)("div",{className:"flex flex-col min-w-0",children:[y,k]}),e[27]=y,e[28]=k,e[29]=S):S=e[29];let M;e[30]!==a.time?(M=(0,s.jsx)("span",{className:"text-xs text-zinc-500 whitespace-nowrap ml-2",children:a.time}),e[30]=a.time,e[31]=M):M=e[31];let E;e[32]!==S||e[33]!==M?(E=(0,s.jsxs)("div",{className:"flex justify-between items-center mb-0.5",children:[S,M]}),e[32]=S,e[33]=M,e[34]=E):E=e[34];let F;e[35]!==a.lastMessage?(F=(0,s.jsx)("p",{className:"text-zinc-500 text-sm truncate pr-2",children:a.lastMessage}),e[35]=a.lastMessage,e[36]=F):F=e[36];let N;e[37]!==a.unread?(N=a.unread>0&&(0,s.jsx)("span",{className:"bg-violet-600 text-white text-[10px] font-bold size-5 rounded-full flex items-center justify-center shrink-0",children:a.unread}),e[37]=a.unread,e[38]=N):N=e[38];let P;e[39]!==F||e[40]!==N?(P=(0,s.jsxs)("div",{className:"flex-1 flex justify-between items-center",children:[F,N]}),e[39]=F,e[40]=N,e[41]=P):P=e[41];let R;e[42]!==E||e[43]!==P?(R=(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[E,P]}),e[42]=E,e[43]=P,e[44]=R):R=e[44];let L;return e[45]!==j||e[46]!==m||e[47]!==R||e[48]!==d?(L=(0,s.jsxs)("div",{onClick:m,className:d,children:[j,R]}),e[45]=j,e[46]=m,e[47]=R,e[48]=d,e[49]=L):L=e[49],L},Bo=({conversations:t,userResults:e=[],onSelect:a,onStartNew:i,selectedId:n,searchQuery:r,onSearchChange:l,onlineUsers:o=new Set})=>(0,s.jsxs)("div",{className:"flex-1 flex flex-col min-w-0 bg-white dark:bg-black",children:[(0,s.jsx)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)(ft,{value:r,onChange:l,onClear:()=>l(""),placeholder:"Search people or messages..."})}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[t.length>0&&(0,s.jsx)("div",{className:"py-2",children:t.map(c=>(0,s.jsx)(Do,{conv:c,selectedId:n,onSelect:a,onlineUsers:o},c.id))}),e.length>0&&(0,s.jsxs)("div",{className:"border-t border-zinc-100 dark:border-zinc-800",children:[(0,s.jsx)("div",{className:"px-4 py-3 text-xs font-bold text-zinc-500 uppercase tracking-wider",children:"People"}),e.map(c=>(0,s.jsxs)("div",{onClick:()=>i(c),className:"flex items-center gap-3 p-4 cursor-pointer transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[(0,s.jsxs)(fe,{className:"size-12",children:[(0,s.jsx)(xe,{src:c.avatar,alt:c.name,className:"object-cover"}),(0,s.jsx)(he,{children:c.name?.[0]?.toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"font-bold dark:text-white truncate",children:c.name}),(0,s.jsxs)("div",{className:"text-zinc-500 text-sm truncate",children:["@",c.handle]})]}),(0,s.jsx)(fs,{size:18,className:"text-violet-500"})]},c.id))]}),t.length===0&&e.length===0&&r&&(0,s.jsx)("div",{className:"p-8 text-center",children:(0,s.jsxs)("p",{className:"text-zinc-500 text-sm",children:['No conversations or people found for "',r,'"']})}),t.length===0&&!r&&(0,s.jsx)("div",{className:"p-8 text-center",children:(0,s.jsx)("p",{className:"text-zinc-500 text-sm",children:"No messages yet. Search for people to start a chat!"})})]})]}),Wo=Bo,Uo=Q(),Ho=["","","","","",""],Qo=t=>{const e=(0,Uo.c)(6),{onSelect:a,currentReaction:i}=t;let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,s.jsx)(Js,{asChild:!0,children:(0,s.jsx)("button",{className:"p-1.5 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-300 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full transition-all active:scale-90",onClick:Vo,children:(0,s.jsx)(hs,{size:16})})}),e[0]=n):n=e[0];let r;e[1]!==i||e[2]!==a?(r=Ho.map(o=>(0,s.jsx)("button",{onClick:()=>a(o),className:`text-xl p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full transition-all active:scale-125 ${i===o?"bg-zinc-100 dark:bg-zinc-800":""}`,children:o},o)),e[1]=i,e[2]=a,e[3]=r):r=e[3];let l;return e[4]!==r?(l=(0,s.jsxs)(Qs,{children:[n,(0,s.jsx)(Vs,{side:"top",align:"center",className:"w-fit p-1 rounded-full bg-white dark:bg-zinc-900 border border-zinc-100 dark:border-zinc-800 shadow-xl",onClick:Ko,children:(0,s.jsx)("div",{className:"flex items-center gap-1",children:r})})]}),e[4]=r,e[5]=l):l=e[5],l},Jo=Qo;function Vo(t){return t.stopPropagation()}function Ko(t){return t.stopPropagation()}var Xo=Q(),Yo=t=>{const e=(0,Xo.c)(10),{reactions:a,currentUser:i,onToggle:n}=t;let r;e[0]!==a?(r=a===void 0?[]:a,e[0]=a,e[1]=r):r=e[1];const l=r;let o;e[2]!==i?.id||e[3]!==l?(o={},l.forEach(u=>{o[u.emoji]||(o[u.emoji]={count:0,me:!1}),o[u.emoji].count=o[u.emoji].count+1,u.user_id===i?.id&&(o[u.emoji].me=!0)}),e[2]=i?.id,e[3]=l,e[4]=o):o=e[4];const c=o;if(l.length===0)return null;let m;e[5]!==c?(m=Object.entries(c),e[5]=c,e[6]=m):m=e[6];let d;return e[7]!==n||e[8]!==m?(d=(0,s.jsx)("div",{className:"flex flex-wrap gap-1 mt-1 px-2",children:m.map(u=>{const[f,p]=u;return(0,s.jsxs)("button",{onClick:b=>{b.stopPropagation(),n(f)},className:`flex items-center gap-1.5 px-2 py-0.5 rounded-full text-xs font-medium border transition-all active:scale-90 ${p.me?"bg-violet-50 border-violet-200 text-violet-600 dark:bg-violet-900/30 dark:border-violet-800 dark:text-violet-400":"bg-white border-zinc-100 text-zinc-600 dark:bg-zinc-900 dark:border-zinc-800 dark:text-zinc-400"}`,children:[(0,s.jsx)("span",{children:f}),p.count>1&&(0,s.jsx)("span",{children:p.count})]},f)})}),e[7]=n,e[8]=m,e[9]=d):d=e[9],d},Go=Yo,Zo=["","","","","",""],ec=({conversation:t,messages:e,onBack:a,onSendMessage:i,onToggleReaction:n,onDeleteMessage:r,currentUser:l,onTyping:o,isLoading:c,isTyping:m,isOnline:d})=>{const{openLightbox:u}=Ft(),[f,p]=(0,g.useState)(""),[b,x]=(0,g.useState)(!1),[h,v]=(0,g.useState)([]),[j,w]=(0,g.useState)(!1),[y,k]=(0,g.useState)(null),S=(0,g.useRef)(null),M=(0,g.useRef)(null),E=(0,g.useRef)(null),F=Zs(t.user?.lastSeen);(0,g.useEffect)(()=>{M.current&&(M.current.scrollTop=M.current.scrollHeight)},[e,m]);const N=z=>{const $=z.target.value;p($),o&&(o(!0),E.current&&clearTimeout(E.current),E.current=setTimeout(()=>{o(!1)},2e3))},P=z=>{p($=>$+z.emoji)},R=z=>{z.preventDefault(),!(!f.trim()&&h.length===0)&&(o&&(clearTimeout(E.current),o(!1)),i(t.id,f,h.length>0?"image":"text",h,y?.id),p(""),v([]),k(null))},L=async z=>{const $=Array.from(z.target.files);if($.length!==0){x(!0);try{const q=await Promise.all($.map(B=>Me(B)));v(B=>[...B,...q])}catch(q){console.error("Upload failed:",q)}finally{x(!1)}}},T=z=>{v($=>$.filter(q=>q.url!==z))},D=z=>{!z.media||z.media.length===0||u(z.media.map($=>$.url),0)},C=(0,g.useMemo)(()=>{const z=e.filter($=>$.sender==="me");return z.length>0?z[z.length-1].id:null},[e]),_=z=>e.find($=>$.id===z);return(0,s.jsxs)("div",{className:"flex-1 flex flex-col h-full min-w-0 bg-white dark:bg-black md:border-l md:border-zinc-100 dark:md:border-zinc-800",children:[(0,s.jsxs)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800 flex items-center justify-between shrink-0 bg-white/80 dark:bg-black/80 backdrop-blur-md sticky top-0 z-10",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("button",{onClick:a,className:"md:hidden p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:(0,s.jsx)(Ze,{size:20})}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)(fe,{className:"size-10 border border-zinc-200 dark:border-zinc-700",children:[(0,s.jsx)(xe,{src:t.user.avatar,alt:t.user.name,className:"object-cover"}),(0,s.jsx)(he,{children:t.user.name?.[0]?.toUpperCase()})]}),d&&(0,s.jsx)("span",{className:"absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-bold dark:text-white",children:t.user.name}),d?(0,s.jsxs)("div",{className:"text-xs text-emerald-500 font-medium flex items-center gap-1",children:[(0,s.jsx)("span",{className:"size-1.5 bg-emerald-500 rounded-full animate-pulse"}),"Online"]}):(0,s.jsx)("div",{className:"text-xs text-zinc-500 font-medium",children:t.user.lastSeen?`Last seen ${F}`:"Offline"})]})]}),(0,s.jsx)("button",{className:"p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full dark:text-zinc-400",children:(0,s.jsx)(Ia,{size:20})})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",ref:M,children:[(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsxs)("div",{className:"relative w-fit mx-auto",children:[(0,s.jsxs)(fe,{className:"size-20 mx-auto mb-3 border-4 border-zinc-50 dark:border-zinc-900 shadow-sm",children:[(0,s.jsx)(xe,{src:t.user.avatar,alt:t.user.name,className:"object-cover"}),(0,s.jsx)(he,{className:"text-2xl font-bold",children:t.user.name?.[0]?.toUpperCase()})]}),d&&(0,s.jsx)("span",{className:"absolute bottom-4 right-1 size-5 bg-emerald-500 border-4 border-white dark:border-black rounded-full animate-in zoom-in duration-300"})]}),(0,s.jsx)("h4",{className:"font-bold dark:text-white text-lg",children:t.user.name}),(0,s.jsxs)("p",{className:"text-sm text-zinc-500",children:["@",t.user.handle]}),(0,s.jsxs)("p",{className:"text-xs text-zinc-400 mt-4 max-w-xs mx-auto",children:["This is the beginning of your direct message history with"," ",(0,s.jsxs)("span",{className:"font-bold",children:["@",t.user.handle]})]})]}),c&&e.length===0?(0,s.jsx)("div",{className:"flex justify-center p-8",children:(0,s.jsx)(me,{className:"animate-spin text-violet-500",size:32})}):e.map(z=>(0,s.jsxs)(Nr,{children:[(0,s.jsx)(zr,{asChild:!0,children:(0,s.jsxs)("div",{id:`msg-${z.id}`,className:`flex items-end gap-2 group ${z.sender==="me"?"flex-row-reverse":"flex-row"}`,children:[(0,s.jsxs)("div",{className:`max-w-[75%] p-1 rounded-2xl text-[15px] shadow-sm relative ${z.sender==="me"?"bg-violet-600 text-white rounded-tr-none":"bg-zinc-100 dark:bg-zinc-800 dark:text-white rounded-tl-none"}`,children:[z.replyToId&&(0,s.jsxs)("div",{className:`mb-2 p-2 rounded-lg border-l-4 text-xs truncate cursor-pointer ${z.sender==="me"?"bg-violet-500/50 border-violet-300 text-violet-100":"bg-zinc-200/50 dark:bg-zinc-700/50 border-zinc-400 dark:border-zinc-500 text-zinc-600 dark:text-zinc-300"}`,onClick:$=>{$.stopPropagation(),document.getElementById(`msg-${z.replyToId}`)?.scrollIntoView({behavior:"smooth",block:"center"})},children:[(0,s.jsx)("span",{className:"font-bold block mb-0.5",children:_(z.replyToId)?.sender==="me"?"You":t.user.name}),_(z.replyToId)?.text||"Media"]}),z.media?.length>0&&(0,s.jsx)("div",{className:"mb-2 grid gap-1 grid-cols-1 overflow-hidden rounded-lg cursor-pointer",onClick:()=>D(z),children:z.media.map(($,q)=>(0,s.jsx)("img",{src:$.url,alt:"",className:"max-h-60 w-full object-cover rounded-md hover:brightness-90 transition-all"},q))}),z.text&&(0,s.jsx)("div",{className:"m-0 leading-tight px-3 py-1 whitespace-pre-line break-words",children:(0,s.jsx)(gs,{options:{attributes:{target:"_blank",rel:"noopener noreferrer",className:"underline decoration-2 underline-offset-2 hover:opacity-80 transition-opacity break-all",onClick:$=>$.stopPropagation()}},children:z.text})}),z.reactions?.length>0&&(0,s.jsx)(Go,{reactions:z.reactions,currentUser:l,onToggle:$=>n(z.id,$)}),(0,s.jsxs)("div",{className:`text-[10px] flex items-center justify-end gap-1 px-3 pb-1 ${z.sender==="me"?"text-violet-200":"text-zinc-400"}`,children:[z.time,z.sender==="me"&&z.id===C&&(0,s.jsx)("span",{className:"ml-0.5",children:z.isRead?(0,s.jsx)(Ua,{size:14,className:"text-white"}):(0,s.jsx)(Da,{size:14,className:"text-violet-200"})})]})]}),(0,s.jsx)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)(Jo,{onSelect:$=>n(z.id,$),currentReaction:z.reactions?.find($=>$.user_id===l?.id)?.emoji})})]})}),(0,s.jsxs)(kr,{className:"w-64 rounded-xl bg-white dark:bg-zinc-950 border-zinc-100 dark:border-zinc-800 shadow-xl",children:[(0,s.jsx)(_r,{className:"text-xs text-zinc-500 font-bold px-3 py-2",children:"QUICK REACTION"}),(0,s.jsx)("div",{className:"flex items-center justify-between px-2 pb-2",children:Zo.map($=>(0,s.jsx)("button",{onClick:()=>n(z.id,$),className:"text-xl p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full transition-all active:scale-125",children:$},$))}),(0,s.jsx)(Xt,{className:"bg-zinc-100 dark:bg-zinc-800"}),(0,s.jsxs)(Nt,{className:"gap-3 px-3 py-2.5 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-900",onClick:()=>{navigator.clipboard.writeText(z.text)},children:[(0,s.jsx)(ua,{size:16,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"font-medium",children:"Copy Text"})]}),(0,s.jsxs)(Nt,{className:"gap-3 px-3 py-2.5 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-900",onClick:()=>k(z),children:[(0,s.jsx)(Qa,{size:16,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"font-medium",children:"Reply"})]}),(0,s.jsx)(Xt,{className:"bg-zinc-100 dark:bg-zinc-800"}),(0,s.jsxs)(Nt,{className:"gap-3 px-3 py-2.5 cursor-pointer text-rose-500 focus:text-rose-500 focus:bg-rose-50 dark:focus:bg-rose-900/20",onClick:()=>r(z.id),children:[(0,s.jsx)(Ka,{size:16}),(0,s.jsx)("span",{className:"font-medium",children:"Delete message"})]})]})]},z.id)),m&&(0,s.jsx)("div",{className:"flex justify-start animate-in fade-in slide-in-from-bottom-2 duration-300",children:(0,s.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-800/50 px-3 py-2 rounded-2xl rounded-tl-none border border-zinc-200/50 dark:border-zinc-700/30 shadow-sm",children:(0,s.jsx)(hl,{})})})]}),(0,s.jsxs)("div",{className:"p-4 border-t border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black shrink-0",children:[y&&(0,s.jsxs)("div",{className:"mb-3 p-3 bg-zinc-50 dark:bg-zinc-900 border border-zinc-100 dark:border-zinc-800 rounded-xl flex items-center justify-between animate-in slide-in-from-bottom-2 duration-200",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("span",{className:"text-xs font-bold text-violet-600 dark:text-violet-400 block mb-1",children:["Replying to"," ",y.sender==="me"?"yourself":t.user.name]}),(0,s.jsx)("p",{className:"text-sm text-zinc-500 truncate",children:y.text||"Media"})]}),(0,s.jsx)("button",{onClick:()=>k(null),className:"p-1 hover:bg-zinc-200 dark:hover:bg-zinc-800 rounded-full text-zinc-400 transition-colors",children:(0,s.jsx)(_e,{size:18})})]}),h.length>0&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 mb-3",children:[h.map(z=>(0,s.jsxs)("div",{className:"relative size-16 rounded-xl overflow-hidden border border-zinc-200 dark:border-zinc-800",children:[(0,s.jsx)("img",{src:z.url,className:"size-full object-cover",alt:""}),(0,s.jsx)("button",{type:"button",onClick:()=>T(z.url),className:"absolute top-1 right-1 bg-black/50 text-white rounded-full p-0.5 hover:bg-black transition-colors",children:(0,s.jsx)(_e,{size:12})})]},z.url)),b&&(0,s.jsx)("div",{className:"size-16 rounded-xl bg-zinc-100 dark:bg-zinc-900 flex items-center justify-center",children:(0,s.jsx)(me,{className:"animate-spin text-violet-500",size:20})})]}),(0,s.jsxs)("form",{onSubmit:R,className:"flex items-center gap-2 bg-zinc-100 dark:bg-zinc-900 p-2 rounded-2xl border border-transparent focus-within:border-violet-500 transition-all",children:[(0,s.jsxs)(Qs,{open:j,onOpenChange:w,children:[(0,s.jsx)(Js,{asChild:!0,children:(0,s.jsx)("button",{type:"button",className:"p-2 text-zinc-500 hover:text-violet-600 transition-colors",children:(0,s.jsx)(hs,{size:20})})}),(0,s.jsx)(Vs,{className:"w-fit p-0 border-none bg-transparent shadow-none",side:"top",align:"start",sideOffset:10,children:(0,s.jsx)(Lr,{onEmojiSelect:z=>{P(z)}})})]}),(0,s.jsx)("input",{type:"text",className:"flex-1 min-w-0 bg-transparent border-none outline-none dark:text-white py-1 px-1",placeholder:"Start a new message",value:f,onChange:N}),(0,s.jsx)("input",{type:"file",ref:S,onChange:L,className:"hidden",multiple:!0,accept:"image/*"}),(0,s.jsx)("button",{type:"button",onClick:()=>S.current?.click(),className:"p-2 text-zinc-500 hover:text-violet-600 transition-colors",disabled:b,children:(0,s.jsx)(ws,{size:20})}),(0,s.jsx)(ue,{type:"submit",className:"size-10 !p-0 rounded-xl",disabled:!f.trim()&&h.length===0||b,children:(0,s.jsx)(xi,{size:18})})]})]})]})},tc=ec,sc=Q(),ac=()=>{const t=(0,sc.c)(73),{id:e}=xt(),a=je(),{currentUser:i}=pe(),{onlineUsers:n}=Ms(),r=pt(),[l,o]=(0,g.useState)("");let c;t[0]===Symbol.for("react.memo_cache_sentinel")?(c=[],t[0]=c):c=t[0];const[m,d]=(0,g.useState)(c),{conversations:u,isConvLoading:f,sendMessage:p,sendTypingStatus:b,typingStatus:x,markAsRead:h,formatMessages:v,onToggleReaction:j,allReactions:w}=Lt(i);let y;e:{if(!e||u.length===0){y=null;break e}let ee;t[1]!==u||t[2]!==e?(ee=u.find(ce=>ce.id===e)||null,t[1]=u,t[2]=e,t[3]=ee):ee=t[3],y=ee}const k=y;let S,M;t[4]!==e||t[5]!==h?(S=()=>{e&&h(e)},M=[e,h],t[4]=e,t[5]=h,t[6]=S,t[7]=M):(S=t[6],M=t[7]),(0,g.useEffect)(S,M);let E;t[8]!==u||t[9]!==i?.id||t[10]!==l?(E=()=>{const ee=setTimeout(async()=>{if(l.length>1){const ce=await Bi(l),be=u.map(ic);d(ce.filter(ve=>ve.id!==i?.id&&!be.includes(ve.id)))}else d([])},300);return()=>clearTimeout(ee)},t[8]=u,t[9]=i?.id,t[10]=l,t[11]=E):E=t[11];const F=i?.id;let N;t[12]!==u||t[13]!==l||t[14]!==F?(N=[l,u,F],t[12]=u,t[13]=l,t[14]=F,t[15]=N):N=t[15],(0,g.useEffect)(E,N);let P;t[16]!==i||t[17]!==a||t[18]!==r?(P=async ee=>{try{const ce=await _s(i.id,ee.id);r.invalidateQueries({queryKey:["conversations",i.id]}),o(""),a(`/messages/${ce}`)}catch(ce){console.error("Failed to start conversation:",ce)}},t[16]=i,t[17]=a,t[18]=r,t[19]=P):P=t[19];const R=P;let L;t[20]!==a?(L=ee=>{a(`/messages/${ee.id}`)},t[20]=a,t[21]=L):L=t[21];const T=L,D=k?.id;let C;t[22]!==D?(C=["messages",D],t[22]=D,t[23]=C):C=t[23];let _;t[24]!==k?.id?(_=()=>un(k?.id),t[24]=k?.id,t[25]=_):_=t[25];const z=!!k?.id;let $;t[26]!==C||t[27]!==_||t[28]!==z?($={queryKey:C,queryFn:_,enabled:z},t[26]=C,t[27]=_,t[28]=z,t[29]=$):$=t[29];const{data:q,isLoading:B}=Pe($);let Y;t[30]!==q?(Y=q===void 0?[]:q,t[30]=q,t[31]=Y):Y=t[31];const I=Y;let U;t[32]!==w||t[33]!==I||t[34]!==v?(U=v(I,w),t[32]=w,t[33]=I,t[34]=v,t[35]=U):U=t[35];const W=U;if(!i){let ee;return t[36]===Symbol.for("react.memo_cache_sentinel")?(ee=(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-screen gap-4 p-8 text-center bg-white dark:bg-black md:rounded-xl md:border border-zinc-100 dark:border-zinc-800",children:[(0,s.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-900 p-4 rounded-full",children:(0,s.jsx)(Ga,{size:40,className:"text-zinc-400"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"Sign in to message others"}),(0,s.jsx)("p",{className:"text-zinc-500 max-w-xs",children:"Start decentralized conversations with anyone on the network."})]}),t[36]=ee):ee=t[36],ee}if(f){let ee;return t[37]===Symbol.for("react.memo_cache_sentinel")?(ee=(0,s.jsx)("div",{className:"flex h-screen items-center justify-center bg-white dark:bg-black md:rounded-xl md:border border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)(me,{className:"animate-spin text-violet-500",size:32})}),t[37]=ee):ee=t[37],ee}let K;if(t[38]!==u||t[39]!==l){let ee;t[41]!==l?(ee=ce=>ce.user?.name?.toLowerCase().includes(l.toLowerCase())||ce.user?.handle?.toLowerCase().includes(l.toLowerCase())||ce.lastMessage?.toLowerCase().includes(l.toLowerCase()),t[41]=l,t[42]=ee):ee=t[42],K=u.filter(ee),t[38]=u,t[39]=l,t[40]=K}else K=t[40];const te=K,G=k&&x[k.id];let ae;t[43]!==n||t[44]!==k?(ae=k&&n.has(k.user?.id),t[43]=n,t[44]=k,t[45]=ae):ae=t[45];const ie=ae,le=`flex ${e?"h-[100dvh]":"h-[calc(100dvh-4rem)]"} md:h-[calc(100vh-2rem)] bg-white dark:bg-black overflow-hidden md:rounded-xl md:border border-zinc-100 dark:border-zinc-800`,V=`w-full md:w-80 flex flex-col border-r border-zinc-100 dark:border-zinc-800 ${k?"hidden md:flex":"flex"}`;let X;t[46]===Symbol.for("react.memo_cache_sentinel")?(X=(0,s.jsx)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)("h2",{className:"text-xl font-bold dark:text-white",children:"Messages"})}),t[46]=X):X=t[46];let re;t[47]!==te||t[48]!==T||t[49]!==R||t[50]!==e||t[51]!==l||t[52]!==n||t[53]!==m?(re=(0,s.jsx)(Wo,{conversations:te,userResults:m,onSelect:T,onStartNew:R,selectedId:e,searchQuery:l,onSearchChange:o,onlineUsers:n}),t[47]=te,t[48]=T,t[49]=R,t[50]=e,t[51]=l,t[52]=n,t[53]=m,t[54]=re):re=t[54];let ne;t[55]!==V||t[56]!==re?(ne=(0,s.jsxs)("div",{className:V,children:[X,re]}),t[55]=V,t[56]=re,t[57]=ne):ne=t[57];let H;t[58]!==G||t[59]!==i||t[60]!==B||t[61]!==W||t[62]!==a||t[63]!==j||t[64]!==ie||t[65]!==k||t[66]!==p||t[67]!==b?(H=k?(0,s.jsx)(tc,{conversation:k,messages:W,onBack:()=>a("/messages"),onSendMessage:p,onToggleReaction:j,currentUser:i,onTyping:ee=>b(k.id,ee),isLoading:B,isTyping:G,isOnline:ie}):(0,s.jsxs)("div",{className:"hidden md:flex flex-1 items-center justify-center text-zinc-500 flex-col gap-4",children:[(0,s.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full",children:(0,s.jsx)(ht,{size:48,className:"text-zinc-300"})}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-zinc-900 dark:text-white",children:"Select a message"}),(0,s.jsx)("p",{children:"Choose from your existing conversations or start a new one."})]})]}),t[58]=G,t[59]=i,t[60]=B,t[61]=W,t[62]=a,t[63]=j,t[64]=ie,t[65]=k,t[66]=p,t[67]=b,t[68]=H):H=t[68];let oe;return t[69]!==le||t[70]!==ne||t[71]!==H?(oe=(0,s.jsxs)("div",{className:le,children:[ne,H]}),t[69]=le,t[70]=ne,t[71]=H,t[72]=oe):oe=t[72],oe},ss=ac;function ic(t){return t.user?.id}var nc=()=>{const{currentUser:t}=pe(),e=je(),[a,i]=(0,g.useState)([]),[n,r]=(0,g.useState)(!0),[l,o]=(0,g.useState)(!1),[c,m]=(0,g.useState)(!0),d=(0,g.useRef)(a);(0,g.useEffect)(()=>{d.current=a},[a]);const u=(0,g.useCallback)(async(x=!1)=>{if(t?.id){x?o(!0):r(!0);try{const h=d.current,v=x&&h.length>0?h[h.length-1].created_at:null,j=await bn(t.id,v,10);j.length<10?m(!1):m(!0),i(x?w=>[...w,...j]:j)}catch(h){console.error("Failed to fetch notifications:",h)}finally{r(!1),o(!1)}}},[t?.id]);(0,g.useEffect)(()=>{u()},[u]),(0,g.useEffect)(()=>{if(!t?.id)return;const x=O.channel(`user_notifications:${t.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`recipient_id=eq.${t.id}`},()=>{u()}).subscribe();return()=>O.removeChannel(x)},[t?.id,u]);const f=ys({mutationFn:()=>gn(t.id),onSuccess:()=>{i(x=>x.map(h=>({...h,is_read:!0})))}}),p=x=>{x.type==="follow"?e(`/u/${x.user}`):x.post_id&&e(`/post/${x.post_id}`)};if((0,g.useEffect)(()=>{t?.id&&a.some(x=>!x.is_read)&&f.mutate()},[t?.id,a,f]),n)return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,s.jsx)(me,{size:32,className:"animate-spin text-violet-500"})});if(!t)return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[400px] gap-4 p-8 text-center",children:[(0,s.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-900 p-4 rounded-full",children:(0,s.jsx)(yt,{size:40,className:"text-zinc-400"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"Sign in to see notifications"}),(0,s.jsx)("p",{className:"text-zinc-500 max-w-xs",children:"Join the conversation and keep track of who's engaging with your content."})]});const b=x=>{switch(x){case"like":return(0,s.jsx)(at,{size:20,className:"text-rose-500 fill-rose-500"});case"follow":return(0,s.jsx)(fs,{size:20,className:"text-blue-500"});case"mention":return(0,s.jsx)(yt,{size:20,className:"text-emerald-500"});case"comment":return(0,s.jsx)(La,{size:20,className:"text-violet-500"});case"repost":return(0,s.jsx)(ci,{size:20,className:"text-amber-500"});default:return(0,s.jsx)(yt,{size:20,className:"text-zinc-500"})}};return(0,s.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm",children:[(0,s.jsx)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800 sticky top-0 bg-white/80 dark:bg-black/80 backdrop-blur-md z-10",children:(0,s.jsx)("h2",{className:"text-xl font-bold dark:text-white",children:"Notifications"})}),a.length>0?a.map(x=>(0,s.jsxs)("div",{onClick:()=>p(x),className:`p-4 border-b border-zinc-100 dark:border-zinc-800 flex items-start gap-4 hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors cursor-pointer ${x.is_read?"":"bg-violet-50/30 dark:bg-violet-500/5"}`,children:[(0,s.jsx)("div",{className:"shrink-0 pt-1",children:b(x.type)}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-1",children:[(0,s.jsxs)(fe,{className:"size-8",children:[(0,s.jsx)(xe,{src:x.avatar}),(0,s.jsx)(he,{children:x.user?.[0]?.toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex-1 flex justify-between items-center",children:[(0,s.jsxs)("span",{className:"font-bold text-sm dark:text-white truncate",children:["@",x.user]}),(0,s.jsx)("span",{className:"text-zinc-500 text-xs whitespace-nowrap",children:dt(x.created_at)})]})]}),(0,s.jsxs)("p",{className:"text-zinc-600 dark:text-zinc-400 text-[15px] ml-11",children:[x.type==="like"&&"liked your post",x.type==="follow"&&"followed you",x.type==="mention"&&"mentioned you in a post",x.type==="comment"&&"commented on your post",x.type==="repost"&&"reposted your post"]})]}),!x.is_read&&(0,s.jsx)("div",{className:"size-2 rounded-full bg-violet-500 mt-2 shrink-0 shadow-[0_0_8px_rgba(139,92,246,0.5)]"})]},x.id)):(0,s.jsx)("div",{className:"p-16 text-center text-zinc-500",children:(0,s.jsx)("p",{className:"font-medium",children:"No notifications yet."})}),a.length>0&&c&&(0,s.jsx)("div",{className:"p-6 flex justify-center border-t border-zinc-100 dark:border-zinc-800",children:(0,s.jsxs)(ue,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>u(!0),disabled:l,children:[l?(0,s.jsx)(me,{size:18,className:"animate-spin mr-2"}):null,"Load more"]})}),a.length>0&&!c&&(0,s.jsx)("div",{className:"p-8 text-center text-zinc-500 text-sm",children:"You've caught up with everything!"})]})},rc=nc,lc=Q(),oc=()=>{const t=(0,lc.c)(32),{id:e}=xt(),a=je(),{currentUser:i}=pe(),{addToast:n}=Ce();let r,l;t[0]!==e?(r=["post",e],l=async()=>{if(!ke(e))throw new Error("Invalid post ID");return Yi(e)},t[0]=e,t[1]=r,t[2]=l):(r=t[1],l=t[2]);const o=!!e;let c;t[3]!==r||t[4]!==l||t[5]!==o?(c={queryKey:r,queryFn:l,enabled:o,retry:!1},t[3]=r,t[4]=l,t[5]=o,t[6]=c):c=t[6];const{data:m,isLoading:d,isError:u}=Pe(c);if(d){let S;return t[7]===Symbol.for("react.memo_cache_sentinel")?(S=(0,s.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:(0,s.jsx)(qt,{})}),t[7]=S):S=t[7],S}if(u||!m){let S;return t[8]===Symbol.for("react.memo_cache_sentinel")?(S=(0,s.jsx)("div",{className:"bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-[600px] flex items-center justify-center",children:(0,s.jsx)(It,{title:"Post not found",message:"The post you are looking for doesn't exist. It may have been deleted by the author.",icon:Fi})}),t[8]=S):S=t[8],S}let f;t[9]!==a?(f=()=>a(-1),t[9]=a,t[10]=f):f=t[10];let p;t[11]===Symbol.for("react.memo_cache_sentinel")?(p=(0,s.jsx)(Ze,{size:20,strokeWidth:2.5}),t[11]=p):p=t[11];let b;t[12]!==f?(b=(0,s.jsx)("button",{onClick:f,className:"p-2 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:p}),t[12]=f,t[13]=b):b=t[13];let x;t[14]===Symbol.for("react.memo_cache_sentinel")?(x=(0,s.jsx)("h5",{className:"text-xl font-bold dark:text-white",children:"Post"}),t[14]=x):x=t[14];let h;t[15]!==b?(h=(0,s.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4",children:[b,x]})}),t[15]=b,t[16]=h):h=t[16];let v;t[17]!==m.comments?(v=m.comments||[],t[17]=m.comments,t[18]=v):v=t[18];let j,w;t[19]!==a?(j=S=>a(`/u/${S}`),w=()=>a(-1),t[19]=a,t[20]=j,t[21]=w):(j=t[20],w=t[21]);let y;t[22]!==n||t[23]!==i||t[24]!==m||t[25]!==j||t[26]!==w||t[27]!==v?(y=(0,s.jsx)(vt,{...m,isDetail:!0,currentUser:i,initialComments:v,showToast:n,onUserClick:j,onDelete:w}),t[22]=n,t[23]=i,t[24]=m,t[25]=j,t[26]=w,t[27]=v,t[28]=y):y=t[28];let k;return t[29]!==y||t[30]!==h?(k=(0,s.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm mb-20 animate-in slide-in-from-right-5 duration-300",children:(0,s.jsxs)("div",{className:"border-b border-zinc-100 dark:border-zinc-800",children:[h,y]})}),t[29]=y,t[30]=h,t[31]=k):k=t[31],k},cc=oc,dc=({profile:t,currentUser:e,isCurrentUser:a,onEditProfile:i,showToast:n,isCommunity:r,onShowFollowers:l,onShowFollowing:o})=>{const{isFollowing:c,stats:m,loading:d,handleFollow:u}=Ks(t,e?.id,n),f=je(),[p,b]=(0,g.useState)(!1),x=async()=>{if(!e){n("Please sign in to message users");return}b(!0);try{f(`/messages/${await _s(e.id,t.id)}`)}catch(h){console.error("Failed to start conversation:",h),n("Failed to open chat")}finally{b(!1)}};return(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("div",{className:"relative h-32 sm:h-48 w-full bg-zinc-200 dark:bg-zinc-800",children:[t.cover&&(0,s.jsx)("img",{src:t.cover,className:"h-full w-full object-cover transition-opacity duration-500",alt:"Cover"}),(0,s.jsx)("div",{className:"absolute -bottom-12 sm:-bottom-16 left-4 sm:left-6",children:(0,s.jsx)("div",{className:"p-1 bg-white dark:bg-black rounded-full overflow-hidden shadow-xl ring-4 ring-white dark:ring-black relative",children:(0,s.jsxs)(fe,{className:"size-24 sm:size-32",children:[(0,s.jsx)(xe,{src:t.avatar,alt:t.handle,className:"object-cover"}),(0,s.jsx)(he,{className:"text-4xl font-bold",children:t.handle?.[0]?.toUpperCase()})]})})})]}),(0,s.jsxs)("div",{className:"flex flex-col p-4 sm:p-6 pt-16 sm:pt-20 space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsx)("div",{className:"flex-1 min-w-0 pr-4"}),(0,s.jsx)("div",{className:"flex gap-2 shrink-0",children:a?(0,s.jsx)(ue,{variant:"secondary",onClick:()=>i(t),className:"text-sm px-5",children:"Edit profile"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:x,disabled:p,className:"rounded-full p-2 border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 dark:border-zinc-800 transition-colors disabled:opacity-50",children:p?(0,s.jsx)(me,{size:20,className:"animate-spin"}):(0,s.jsx)(ht,{size:20})}),(0,s.jsx)("button",{className:"rounded-full p-2 border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 dark:border-zinc-800 transition-colors",children:(0,s.jsx)(Pt,{size:20})}),(0,s.jsx)(ue,{variant:c?"secondary":"primary",onClick:u,className:"text-sm px-6 min-w-[100px]",disabled:d,children:d?(0,s.jsx)(me,{size:16,className:"animate-spin mx-auto"}):c?"Following":"Follow"}),(0,s.jsx)("button",{className:"rounded-full p-2 hover:bg-zinc-100 text-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-800 transition-colors",children:(0,s.jsx)(_t,{size:20})})]})})]}),(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsx)("div",{className:"flex items-center gap-1.5",children:(0,s.jsxs)("h3",{className:"text-xl sm:text-2xl font-extrabold truncate dark:text-white flex items-center gap-1",children:[t.name,t.verified&&(0,s.jsx)(it,{})]})}),!r&&(0,s.jsx)("div",{className:"flex items-center space-x-3",children:(0,s.jsxs)("span",{className:"text-zinc-500 font-medium text-sm px-1.5 py-0.5 -ml-1.5 rounded-md dark:text-zinc-400",children:["@",t.handle]})})]}),(0,s.jsx)("div",{className:"whitespace-pre-line text-zinc-900 dark:text-zinc-100 leading-relaxed text-sm sm:text-[15px]",children:t.bio}),(t.website||t.location)&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-x-5 gap-y-2 text-sm pt-1",children:[t.location&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)(rs,{size:14}),(0,s.jsx)("span",{children:t.location})]}),t.website&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)(is,{size:14}),(0,s.jsx)("a",{href:`https://${t.website}`,target:"_blank",rel:"noreferrer",className:"text-violet-600 hover:underline font-semibold text-black dark:text-white",children:t.website})]})]}),(0,s.jsx)("div",{className:"flex gap-4 sm:gap-6 text-sm pt-2 relative z-10",children:r?(0,s.jsxs)("button",{className:"flex gap-x-1 hover:underline group cursor-pointer",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white group-hover:text-violet-600",children:t.members}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Members"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:h=>{h.preventDefault(),h.stopPropagation(),o()},className:"flex gap-x-1 hover:underline group cursor-pointer",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white group-hover:text-violet-600",children:m.following}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Following"})]}),(0,s.jsxs)("button",{onClick:h=>{h.preventDefault(),h.stopPropagation(),l()},className:"flex gap-x-1 hover:underline group cursor-pointer",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white group-hover:text-violet-600",children:m.followers}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Followers"})]})]})})]})]})},mc=dc,uc=Q(),fc=t=>{const e=(0,uc.c)(78),{onEditProfile:a}=t,{handle:i,profile:n,loading:r,setUserPosts:l,activeProfileTab:o,setActiveProfileTab:c,loadingPosts:m,isFetchingMorePosts:d,hasMorePosts:u,filteredPosts:f,isFollowModalOpen:p,setIsFollowModalOpen:b,followModalType:x,followListData:h,isListLoading:v,isFetchingMoreFollows:j,hasMoreFollows:w,openFollowModal:y,handlePostClick:k,handleUserClick:S,loadUserPosts:M,currentUser:E,addToast:F,navigate:N}=go();if(r){let H;return e[0]===Symbol.for("react.memo_cache_sentinel")?(H=(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)(me,{size:40,className:"animate-spin text-violet-500"})}),e[0]=H):H=e[0],H}if(!n){const H=`Try searching for another. The user @${i} could not be found.`;let oe;return e[1]!==H?(oe=(0,s.jsx)("div",{className:"bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-[600px] flex items-center justify-center",children:(0,s.jsx)(It,{title:"Account doesn't exist",message:H,icon:ri})}),e[1]=H,e[2]=oe):oe=e[2],oe}const P=n;let R;e[3]!==F||e[4]!==E||e[5]!==P.handle||e[6]!==f||e[7]!==k||e[8]!==S||e[9]!==u||e[10]!==d||e[11]!==M||e[12]!==m||e[13]!==n||e[14]!==l?(R=()=>m?(0,s.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,s.jsx)(me,{className:"animate-spin text-violet-500",size:32})}):f.length>0?(0,s.jsxs)(s.Fragment,{children:[f.map(H=>(0,s.jsx)(vt,{currentUser:E,showToast:F,...H,onClick:()=>k(H.id),onUserClick:S,onDelete:oe=>l(ee=>ee.filter(ce=>ce.id!==oe))},H.feed_id||H.id)),u&&(0,s.jsx)("div",{className:"p-6 flex justify-center",children:(0,s.jsxs)(ue,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>M(n.id,!0),disabled:d,children:[d&&(0,s.jsx)(me,{size:18,className:"animate-spin mr-2"}),"Load more posts"]})})]}):(0,s.jsxs)("div",{className:"p-20 text-center text-zinc-500 flex flex-col items-center gap-4 animate-in fade-in duration-500",children:[(0,s.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full mb-2 ring-1 ring-zinc-100 dark:ring-zinc-800",children:(0,s.jsx)(ps,{size:40,className:"text-zinc-300 dark:text-zinc-700"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"No posts yet"}),(0,s.jsxs)("p",{className:"text-sm text-zinc-500 dark:text-zinc-400 max-w-[250px]",children:["When @",P.handle," shares posts, they will appear here."]})]}),e[3]=F,e[4]=E,e[5]=P.handle,e[6]=f,e[7]=k,e[8]=S,e[9]=u,e[10]=d,e[11]=M,e[12]=m,e[13]=n,e[14]=l,e[15]=R):R=e[15];const L=R;let T;e[16]!==N?(T=()=>N(-1),e[16]=N,e[17]=T):T=e[17];let D;e[18]===Symbol.for("react.memo_cache_sentinel")?(D=(0,s.jsx)(Ze,{size:22}),e[18]=D):D=e[18];let C;e[19]!==T?(C=(0,s.jsx)("button",{onClick:T,className:"p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:D}),e[19]=T,e[20]=C):C=e[20];let _;e[21]!==P.name?(_=(0,s.jsx)("h5",{className:"text-lg font-bold dark:text-white leading-none",children:P.name}),e[21]=P.name,e[22]=_):_=e[22];const z=P.posts_count||0;let $;e[23]!==z?($=(0,s.jsxs)("span",{className:"text-xs text-zinc-500 mt-0.5",children:[z," Posts"]}),e[23]=z,e[24]=$):$=e[24];let q;e[25]!==_||e[26]!==$?(q=(0,s.jsxs)("div",{className:"flex flex-col",children:[_,$]}),e[25]=_,e[26]=$,e[27]=q):q=e[27];let B;e[28]!==C||e[29]!==q?(B=(0,s.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3 md:hidden",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4",children:[C,q]})}),e[28]=C,e[29]=q,e[30]=B):B=e[30];const Y=E?.handle===P.handle;let I,U;e[31]!==y?(I=()=>y("Followers"),U=()=>y("Following"),e[31]=y,e[32]=I,e[33]=U):(I=e[32],U=e[33]);let W;e[34]!==F||e[35]!==E||e[36]!==P||e[37]!==a||e[38]!==Y||e[39]!==I||e[40]!==U?(W=(0,s.jsx)(mc,{profile:P,currentUser:E,isCurrentUser:Y,onEditProfile:a,showToast:F,onShowFollowers:I,onShowFollowing:U}),e[34]=F,e[35]=E,e[36]=P,e[37]=a,e[38]=Y,e[39]=I,e[40]=U,e[41]=W):W=e[41];let K;e[42]===Symbol.for("react.memo_cache_sentinel")?(K=(0,s.jsx)("div",{className:"sticky top-[60px] md:top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-10 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)(cl,{className:"w-full h-auto bg-transparent p-0 rounded-none justify-start px-2 overflow-x-auto hide-scrollbar",children:["feed","communities","media"].map(hc)})}),e[42]=K):K=e[42];let te;e[43]!==L?(te=(0,s.jsx)(zt,{value:"feed",className:"m-0 border-none",children:L()}),e[43]=L,e[44]=te):te=e[44];let G;e[45]!==L?(G=(0,s.jsx)(zt,{value:"communities",className:"m-0 border-none",children:L()}),e[45]=L,e[46]=G):G=e[46];let ae;e[47]!==L?(ae=(0,s.jsx)(zt,{value:"media",className:"m-0 border-none",children:L()}),e[47]=L,e[48]=ae):ae=e[48];let ie;e[49]!==o||e[50]!==c||e[51]!==te||e[52]!==G||e[53]!==ae?(ie=(0,s.jsxs)(ol,{value:o,onValueChange:c,className:"w-full",children:[K,te,G,ae]}),e[49]=o,e[50]=c,e[51]=te,e[52]=G,e[53]=ae,e[54]=ie):ie=e[54];let le;e[55]!==W||e[56]!==ie||e[57]!==B?(le=(0,s.jsxs)("div",{className:"border-y md:border-b-0 border-zinc-100 dark:border-zinc-800",children:[B,W,ie]}),e[55]=W,e[56]=ie,e[57]=B,e[58]=le):le=e[58];let V;e[59]!==b?(V=()=>b(!1),e[59]=b,e[60]=V):V=e[60];let X;e[61]!==h||e[62]!==x||e[63]!==w||e[64]!==j||e[65]!==v||e[66]!==N||e[67]!==y||e[68]!==b?(X=(0,s.jsx)("div",{className:"min-h-[300px]",children:v?(0,s.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,s.jsx)(me,{className:"animate-spin text-violet-500",size:32})}):h.length>0?(0,s.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800 -mx-6",children:[h.map(H=>(0,s.jsx)(Xs,{profile:H,onUserClick:oe=>{b(!1),N(`/u/${oe}`)}},H.id)),w&&(0,s.jsx)("div",{className:"p-4 flex justify-center",children:(0,s.jsxs)(ue,{variant:"secondary",className:"w-full text-xs",onClick:()=>y(x,!0),disabled:j,children:[j?(0,s.jsx)(me,{size:14,className:"animate-spin mr-2"}):null,"Load more"]})})]}):(0,s.jsx)("div",{className:"flex flex-col items-center justify-center py-20 text-zinc-500",children:(0,s.jsxs)("p",{className:"font-medium",children:["No ",x.toLowerCase()," yet."]})})}),e[61]=h,e[62]=x,e[63]=w,e[64]=j,e[65]=v,e[66]=N,e[67]=y,e[68]=b,e[69]=X):X=e[69];let re;e[70]!==x||e[71]!==p||e[72]!==V||e[73]!==X?(re=(0,s.jsx)(tt,{isOpen:p,onClose:V,title:x,className:"sm:max-w-md",children:X}),e[70]=x,e[71]=p,e[72]=V,e[73]=X,e[74]=re):re=e[74];let ne;return e[75]!==le||e[76]!==re?(ne=(0,s.jsxs)("div",{className:"border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:[le,re]}),e[75]=le,e[76]=re,e[77]=ne):ne=e[77],ne},xc=fc;function hc(t){return(0,s.jsx)(dl,{value:t,className:"flex-1 py-4 text-sm font-bold capitalize rounded-none border-b-2 data-[state=active]:border-black dark:data-[state=active]:border-white data-[state=active]:text-black dark:data-[state=active]:text-white text-zinc-500 transition-all hover:bg-zinc-50 dark:hover:bg-zinc-900 whitespace-nowrap px-4",children:t==="feed"?"Posts":t},t)}var pc=Q(),bc=()=>{const t=(0,pc.c)(12),{posts:e,loading:a}=bt(),i=je();let n,r;if(t[0]!==a||t[1]!==i||t[2]!==e){r=Symbol.for("react.early_return_sentinel");e:{const l=e.filter(vc);if(a){let d;t[5]===Symbol.for("react.memo_cache_sentinel")?(d=(0,s.jsx)("div",{className:"h-[100dvh] w-full flex items-center justify-center bg-black",children:(0,s.jsx)(me,{size:40,className:"animate-spin text-white"})}),t[5]=d):d=t[5],r=d;break e}if(l.length===0){let d;t[6]===Symbol.for("react.memo_cache_sentinel")?(d=(0,s.jsx)("div",{className:"h-[100dvh] w-full flex flex-col items-center justify-center bg-black text-white gap-4",children:(0,s.jsx)("p",{className:"text-zinc-500",children:"No reels found."})}),t[6]=d):d=t[6],r=d;break e}let o;t[7]!==i?(o=()=>i(-1),t[7]=i,t[8]=o):o=t[8];let c;t[9]===Symbol.for("react.memo_cache_sentinel")?(c=(0,s.jsx)(Ze,{size:24,strokeWidth:2.5}),t[9]=c):c=t[9];let m;t[10]!==o?(m=(0,s.jsx)("button",{onClick:o,className:"absolute top-6 left-6 z-50 p-2.5 bg-black/20 hover:bg-black/40 text-white backdrop-blur-md rounded-full transition-all active:scale-90 border border-white/10 shadow-xl",title:"Back",children:c}),t[10]=o,t[11]=m):m=t[11],n=(0,s.jsxs)("div",{className:"h-[100dvh] w-full snap-y snap-mandatory overflow-y-auto no-scrollbar bg-black md:rounded-xl relative",children:[m,l.map(jc)]})}t[0]=a,t[1]=i,t[2]=e,t[3]=n,t[4]=r}else n=t[3],r=t[4];return r!==Symbol.for("react.early_return_sentinel")?r:n},gc=bc;function vc(t){return t.type==="video"||t.category==="video"}function jc(t){return(0,s.jsx)(ko,{reel:t},t.id)}var yc=Q();function wc(){const t=(0,yc.c)(52),e=nt(),{currentUser:a,authMode:i,setAuthMode:n}=pe(),{darkMode:r}=Mt(),{isOpen:l,images:o,currentIndex:c,closeLightbox:m,setIndex:d}=Ft(),[u,f]=(0,g.useState)(!1),[p,b]=(0,g.useState)(!1),[x,h]=(0,g.useState)(!1);let v;t[0]===Symbol.for("react.memo_cache_sentinel")?(v={},t[0]=v):v=t[0];const[j,w]=(0,g.useState)(v),[y,k]=(0,g.useState)(null),[S,M]=(0,g.useState)(null);if(i){const G=r?"dark":"";let ae;t[1]!==n?(ae=()=>n(null),t[1]=n,t[2]=ae):ae=t[2];let ie;t[3]!==i||t[4]!==n?(ie=()=>n(i==="login"?"signup":"login"),t[3]=i,t[4]=n,t[5]=ie):ie=t[5];let le;t[6]!==i||t[7]!==ae||t[8]!==ie?(le=(0,s.jsx)("div",{className:"min-h-screen bg-white dark:bg-black flex items-center justify-center p-4",children:(0,s.jsx)($e,{children:(0,s.jsx)(Al,{type:i,onComplete:ae,onSwitch:ie})})}),t[6]=i,t[7]=ae,t[8]=ie,t[9]=le):le=t[9];let V;return t[10]!==G||t[11]!==le?(V=(0,s.jsx)("div",{className:G,children:le}),t[10]=G,t[11]=le,t[12]=V):V=t[12],V}let E;t[13]===Symbol.for("react.memo_cache_sentinel")?(E=(0,s.jsx)(Zn,{}),t[13]=E):E=t[13];let F;t[14]===Symbol.for("react.memo_cache_sentinel")?(F=(0,s.jsx)(ur,{onPostClick:()=>f(!0)}),t[14]=F):F=t[14];let N;t[15]===Symbol.for("react.memo_cache_sentinel")?(N=(0,s.jsx)(ye,{path:"/",element:(0,s.jsx)($e,{children:(0,s.jsx)(To,{onStoryClick:M,onAddStory:()=>h(!0)})})}),t[15]=N):N=t[15];let P;t[16]===Symbol.for("react.memo_cache_sentinel")?(P=(0,s.jsx)(ye,{path:"/home",element:(0,s.jsx)(Dt,{to:"/",replace:!0})}),t[16]=P):P=t[16];let R;t[17]===Symbol.for("react.memo_cache_sentinel")?(R=(0,s.jsx)(ye,{path:"/community",element:(0,s.jsx)($e,{children:(0,s.jsx)(Fo,{})})}),t[17]=R):R=t[17];let L;t[18]===Symbol.for("react.memo_cache_sentinel")?(L=(0,s.jsx)(ye,{path:"/reels",element:(0,s.jsx)($e,{children:(0,s.jsx)(gc,{})})}),t[18]=L):L=t[18];let T;t[19]===Symbol.for("react.memo_cache_sentinel")?(T=(0,s.jsx)(ye,{path:"/messages",element:(0,s.jsx)($e,{children:(0,s.jsx)(ss,{})})}),t[19]=T):T=t[19];let D;t[20]===Symbol.for("react.memo_cache_sentinel")?(D=(0,s.jsx)(ye,{path:"/messages/:id",element:(0,s.jsx)($e,{children:(0,s.jsx)(ss,{})})}),t[20]=D):D=t[20];let C;t[21]===Symbol.for("react.memo_cache_sentinel")?(C=(0,s.jsx)(ye,{path:"/notifications",element:(0,s.jsx)($e,{children:(0,s.jsx)(rc,{})})}),t[21]=C):C=t[21];let _;t[22]===Symbol.for("react.memo_cache_sentinel")?(_=(0,s.jsx)(ye,{path:"/post/:id",element:(0,s.jsx)($e,{children:(0,s.jsx)(cc,{})})}),t[22]=_):_=t[22];let z;t[23]===Symbol.for("react.memo_cache_sentinel")?(z=(0,s.jsx)(ye,{path:"/c/:handle",element:(0,s.jsx)($e,{children:(0,s.jsx)(So,{onPostInCommunity:G=>{k(G),f(!0)}})})}),t[23]=z):z=t[23];let $;t[24]===Symbol.for("react.memo_cache_sentinel")?($=(0,s.jsx)(ye,{path:"/u/:handle",element:(0,s.jsx)($e,{children:(0,s.jsx)(xc,{onEditProfile:G=>{w(G),b(!0)}})})}),t[24]=$):$=t[24];let q;t[25]===Symbol.for("react.memo_cache_sentinel")?(q=(0,s.jsxs)(ye,{element:F,children:[N,P,R,L,T,D,C,_,z,$,(0,s.jsx)(ye,{path:"*",element:(0,s.jsx)(Dt,{to:"/community"})})]}),t[25]=q):q=t[25];let B;t[26]!==e?(B=(0,s.jsx)(va,{location:e,children:q},e.pathname),t[26]=e,t[27]=B):B=t[27];let Y;t[28]===Symbol.for("react.memo_cache_sentinel")?(Y=G=>{f(G),G||k(null)},t[28]=Y):Y=t[28];let I;t[29]!==j||t[30]!==p||t[31]!==u||t[32]!==x||t[33]!==y?(I=(0,s.jsx)(Ll,{isPostModalOpen:u,setIsPostModalOpen:Y,isEditProfileOpen:p,setIsEditProfileOpen:b,isStoryModalOpen:x,setIsStoryModalOpen:h,editProfileData:j,setEditProfileData:w,postCommunity:y}),t[29]=j,t[30]=p,t[31]=u,t[32]=x,t[33]=y,t[34]=I):I=t[34];let U;t[35]!==S?(U=S&&(0,s.jsx)(El,{story:S,onClose:()=>M(null)}),t[35]=S,t[36]=U):U=t[36];let W;t[37]!==m||t[38]!==c||t[39]!==o||t[40]!==l||t[41]!==d?(W=l&&(0,s.jsx)(Wr,{images:o,currentIndex:c,onClose:m,onNavigate:d}),t[37]=m,t[38]=c,t[39]=o,t[40]=l,t[41]=d,t[42]=W):W=t[42];let K;t[43]!==a||t[44]!==e.pathname?(K=a&&e.pathname==="/"&&(0,s.jsx)("button",{onClick:()=>f(!0),className:"fixed bottom-20 right-5 md:hidden z-50 bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 size-12 rounded-full flex items-center justify-center shadow-2xl hover:scale-110 active:scale-90 transition-all cursor-pointer group",title:"Create Post",children:(0,s.jsx)(Oe,{size:28,className:"group-hover:rotate-90 transition-transform duration-300"})}),t[43]=a,t[44]=e.pathname,t[45]=K):K=t[45];let te;return t[46]!==B||t[47]!==I||t[48]!==U||t[49]!==W||t[50]!==K?(te=(0,s.jsxs)(s.Fragment,{children:[E,B,I,U,W,K]}),t[46]=B,t[47]=I,t[48]=U,t[49]=W,t[50]=K,t[51]=te):te=t[51],te}var Nc=new Li;(0,Ti.createRoot)(document.getElementById("root")).render((0,s.jsx)(g.StrictMode,{children:(0,s.jsx)(ui,{client:Nc,children:(0,s.jsx)(oi,{children:(0,s.jsx)(On,{children:(0,s.jsx)(In,{children:(0,s.jsx)(qn,{children:(0,s.jsx)(Qn,{children:(0,s.jsx)(Un,{children:(0,s.jsx)(Vn,{children:(0,s.jsx)(wc,{})})})})})})})})})}));
