import{a as z}from"./rolldown-runtime-BaZ8gS7u.js";import{c as w,l as M,v as P,w as $,y as F}from"./framework-3lkjbTvb.js";import{t as H}from"./query-CZHA9T67.js";import"./database-COznt_u0.js";import{In as k,mr as S}from"./ui-libs-oBja7Jpd.js";import"./media-libs-C98UjHPF.js";import{En as q,H as C,Wt as L,fn as U,un as A}from"./index-kC8AaCON.js";import{r as B}from"./post-DLwaNz49.js";import"./text-processing-BMF44JzJ.js";import"./VideoPlayer-BZUv5-EO.js";import"./actionsheet-akbTNaLr.js";var E=w(),re=z($(),1);const I=()=>{const e=(0,E.c)(19),{tag:s}=F(),x=P(),{currentUser:p}=U(),{addToast:b}=A();let i,l;e[0]!==s?(i=["hashtag",s],l=v=>{const{pageParam:g}=v;return q(`#${s}`,g,20)},e[0]=s,e[1]=i,e[2]=l):(i=e[1],l=e[2]);const r=!!s;let h;e[3]!==i||e[4]!==l||e[5]!==r?(h={queryKey:i,queryFn:l,initialPageParam:null,getNextPageParam:T,enabled:r},e[3]=i,e[4]=l,e[5]=r,e[6]=h):h=e[6];const{data:n,fetchNextPage:f,hasNextPage:c,isFetchingNextPage:o,isLoading:u}=H(h);let a;e[7]!==n?.pages?(a=n?.pages.flatMap(K)||[],e[7]=n?.pages,e[8]=a):a=e[8];const d=a;let m;return e[9]!==b||e[10]!==p||e[11]!==f||e[12]!==c||e[13]!==o||e[14]!==u||e[15]!==x||e[16]!==d||e[17]!==s?(m={tag:s,posts:d,loading:u,fetchingMore:o,hasMore:c,loadMore:f,navigate:x,currentUser:p,addToast:b},e[9]=b,e[10]=p,e[11]=f,e[12]=c,e[13]=o,e[14]=u,e[15]=x,e[16]=d,e[17]=s,e[18]=m):m=e[18],m};function T(e){if(!(!e||e.length<20))return e[e.length-1].sort_timestamp||e[e.length-1].created_at}function K(e){return e}var Q=w(),t=z(M(),1),W=()=>{const e=(0,Q.c)(30),{tag:s,posts:x,loading:p,fetchingMore:b,hasMore:i,loadMore:l,navigate:r,currentUser:h}=I();let n;e[0]!==r?(n=()=>r(-1),e[0]=r,e[1]=n):n=e[1];let f;e[2]===Symbol.for("react.memo_cache_sentinel")?(f=(0,t.jsx)(S,{size:22}),e[2]=f):f=e[2];let c;e[3]!==n?(c=(0,t.jsx)("button",{onClick:n,className:"rounded-full p-1 transition-colors hover:bg-zinc-100 dark:text-white dark:hover:bg-zinc-800",children:f}),e[3]=n,e[4]=c):c=e[4];let o;e[5]!==s?(o=(0,t.jsxs)("h5",{className:"text-lg font-bold leading-none dark:text-white",children:["#",s]}),e[5]=s,e[6]=o):o=e[6];let u;e[7]===Symbol.for("react.memo_cache_sentinel")?(u=(0,t.jsx)("span",{className:"mt-0.5 text-xs text-zinc-500",children:"Hashtag"}),e[7]=u):u=e[7];let a;e[8]!==o?(a=(0,t.jsxs)("div",{className:"flex flex-col",children:[o,u]}),e[8]=o,e[9]=a):a=e[9];let d;e[10]!==c||e[11]!==a?(d=(0,t.jsx)("div",{className:"sticky top-0 z-20 border-b border-zinc-100 bg-white/90 px-4 py-3 backdrop-blur-md dark:border-zinc-800 dark:bg-black/90",children:(0,t.jsxs)("div",{className:"flex items-center gap-x-4",children:[c,a]})}),e[10]=c,e[11]=a,e[12]=d):d=e[12];let m;e[13]===Symbol.for("react.memo_cache_sentinel")?(m=(0,t.jsx)("div",{className:"relative h-32 overflow-hidden bg-gradient-to-r from-violet-500/10 to-fuchsia-500/10 sm:h-40",children:(0,t.jsx)("div",{className:"absolute inset-0 bg-grid-white/[0.02] bg-[size:20px_20px]"})}),e[13]=m):m=e[13];let v;e[14]===Symbol.for("react.memo_cache_sentinel")?(v=(0,t.jsx)("div",{className:"relative z-10 -mt-10 mb-4 flex items-end justify-between",children:(0,t.jsx)("div",{className:"flex size-20 items-center justify-center rounded-2xl border-4 border-white bg-zinc-100 shadow-xl dark:border-black dark:bg-zinc-800 sm:size-24",children:(0,t.jsx)(k,{size:40,className:"text-zinc-400"})})}),e[14]=v):v=e[14];let g;e[15]!==s?(g=(0,t.jsxs)("div",{className:"relative",children:[m,(0,t.jsxs)("div",{className:"px-4 pb-6",children:[v,(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("h1",{className:"text-2xl font-black leading-tight tracking-tight dark:text-white sm:text-3xl",children:["#",s]}),(0,t.jsxs)("p",{className:"text-sm text-zinc-500 sm:text-base",children:["Posts tagged with #",s]})]})]})]}),e[15]=s,e[16]=g):g=e[16];let j;e[17]!==h||e[18]!==b||e[19]!==i||e[20]!==l||e[21]!==p||e[22]!==r||e[23]!==x||e[24]!==s?(j=(0,t.jsx)("div",{className:"border-t border-zinc-100 dark:border-zinc-800",children:p?(0,t.jsx)("div",{className:"flex flex-col",children:[1,2,3].map(D)}):x.length>0?(0,t.jsxs)(t.Fragment,{children:[x.map(_=>(0,t.jsx)(B,{currentUser:h,..._,onClick:()=>r(`/p/${_.id}`),onUserClick:y=>r(`/u/${y}`)},_.feed_id||_.id)),i&&(0,t.jsx)("div",{className:"flex justify-center p-6",children:(0,t.jsx)(L,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>l(),loading:b,children:"Load more"})})]}):(0,t.jsxs)("div",{className:"flex flex-col items-center gap-4 p-20 text-center text-zinc-500",children:[(0,t.jsx)("div",{className:"mb-2 rounded-full bg-zinc-50 p-6 dark:bg-zinc-900",children:(0,t.jsx)(k,{size:40,className:"text-zinc-300"})}),(0,t.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"No posts found"}),(0,t.jsxs)("p",{className:"text-sm max-w-[250px]",children:["Be the first to post with #",s,"!"]})]})}),e[17]=h,e[18]=b,e[19]=i,e[20]=l,e[21]=p,e[22]=r,e[23]=x,e[24]=s,e[25]=j):j=e[25];let N;return e[26]!==j||e[27]!==d||e[28]!==g?(N=(0,t.jsx)("div",{className:"min-h-screen overflow-hidden rounded-none border-zinc-100 bg-white pb-20 dark:border-zinc-800 dark:bg-black md:rounded-xl",children:(0,t.jsxs)("div",{className:"relative",children:[d,g,j]})}),e[26]=j,e[27]=d,e[28]=g,e[29]=N):N=e[29],N},ae=W;function D(e){return(0,t.jsx)(C,{},e)}export{ae as default};
