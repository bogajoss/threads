import{a as A}from"./rolldown-runtime-BaZ8gS7u.js";import{E as $,c as P,d as H,t as U}from"./framework-CsA6nn9m.js";import"./database-t9niRmCR.js";import{Sn as q,on as E}from"./ui-libs-Ba37rTFj.js";import{E as F,N as S,P as y,T as L,nt as T,rt as B,tt as I}from"./index-DEnaYF6k.js";import{n as M}from"./post-BUjJMsW4.js";import{o as W}from"./hooks-NQYRsaaF.js";import"./linkify-BNMTbiql.js";var Y=P(),re=A($(),1),s=A(H(),1),J=N=>{const e=(0,Y.c)(24),{user:r,onClick:p,isAddStory:i,isSeen:h}=N,x=i===void 0?!1:i,z=`relative p-0.5 rounded-full ${x?"bg-transparent":h!==void 0&&h?"bg-zinc-200 dark:bg-zinc-800":"bg-gradient-to-tr from-yellow-400 via-pink-500 to-violet-600"}`;let f;e[0]!==r.avatar||e[1]!==r.handle?(f=(0,s.jsx)(B,{src:r.avatar,alt:r.handle,className:"object-cover"}),e[0]=r.avatar,e[1]=r.handle,e[2]=f):f=e[2];let t;e[3]!==r.handle?.[0]?(t=r.handle?.[0]?.toUpperCase(),e[3]=r.handle?.[0],e[4]=t):t=e[4];let a;e[5]!==t?(a=(0,s.jsx)(T,{children:t}),e[5]=t,e[6]=a):a=e[6];let l;e[7]!==f||e[8]!==a?(l=(0,s.jsxs)(I,{className:"size-14 border border-zinc-100 dark:border-zinc-800 sm:size-16",children:[f,a]}),e[7]=f,e[8]=a,e[9]=l):l=e[9];let d;e[10]!==x?(d=x&&(0,s.jsx)("div",{className:"absolute bottom-0 right-0 rounded-full border-2 border-white bg-violet-600 p-1 text-white shadow-lg dark:border-black",children:(0,s.jsx)(E,{size:14,strokeWidth:3})}),e[10]=x,e[11]=d):d=e[11];let n;e[12]!==l||e[13]!==d?(n=(0,s.jsx)("div",{className:"rounded-full bg-white p-0.5 dark:bg-black",children:(0,s.jsxs)("div",{className:"relative",children:[l,d]})}),e[12]=l,e[13]=d,e[14]=n):n=e[14];let o;e[15]!==z||e[16]!==n?(o=(0,s.jsx)("div",{className:z,children:n}),e[15]=z,e[16]=n,e[17]=o):o=e[17];const b=x?"Add Story":r.handle;let c;e[18]!==b?(c=(0,s.jsx)("span",{className:"w-16 truncate text-center text-[11px] font-semibold leading-tight text-zinc-600 dark:text-zinc-400",children:b}),e[18]=b,e[19]=c):c=e[19];let u;return e[20]!==p||e[21]!==o||e[22]!==c?(u=(0,s.jsxs)("button",{onClick:p,className:"group flex shrink-0 flex-col items-center gap-2",children:[o,c]}),e[20]=p,e[21]=o,e[22]=c,e[23]=u):u=e[23],u},C=J,O=P(),R=N=>{const e=(0,O.c)(27),{onStoryClick:r,onAddStory:p}=N,{currentUser:i,homePosts:h,groupedStories:x,isPostsLoading:z,isStoriesLoading:f,hasMore:t,isFetchingNextPage:a,fetchNextPage:l,addToast:d,handlePostClick:n,handleUserClick:o}=W();if(z||f){let m;return e[0]===Symbol.for("react.memo_cache_sentinel")?(m=(0,s.jsxs)("div",{className:"min-h-screen overflow-hidden rounded-none border-y border-zinc-100 bg-white dark:bg-black dark:border-zinc-800 md:rounded-xl md:border",children:[(0,s.jsxs)(S,{className:"w-full whitespace-nowrap border-b border-zinc-100 dark:border-zinc-800",children:[(0,s.jsxs)("div",{className:"flex w-max gap-3 px-4 py-4",children:[(0,s.jsx)("div",{className:"size-16 shrink-0 animate-pulse rounded-full bg-zinc-100 dark:bg-zinc-900"}),(0,s.jsx)("div",{className:"size-16 shrink-0 animate-pulse rounded-full bg-zinc-100 dark:bg-zinc-900"}),(0,s.jsx)("div",{className:"size-16 shrink-0 animate-pulse rounded-full bg-zinc-100 dark:bg-zinc-900"})]}),(0,s.jsx)(y,{orientation:"horizontal",className:"hidden"})]}),[1,2,3].map(D)]}),e[0]=m):m=e[0],m}let b;e[1]!==i||e[2]!==x||e[3]!==p||e[4]!==r?(b=()=>(0,s.jsxs)("div",{className:"bg-white dark:bg-black",children:[(0,s.jsxs)(S,{className:"w-full border-b border-zinc-100 bg-white dark:bg-black dark:border-zinc-800",children:[(0,s.jsxs)("div",{className:"flex w-max gap-4 px-4 py-4",children:[i&&(0,s.jsx)(C,{user:i,isAddStory:!0,onClick:p}),x.map(m=>{const k=JSON.parse(localStorage.getItem("seenStories")||"[]").includes(m.user.id);return(0,s.jsx)(C,{user:m.user,isSeen:k,onClick:()=>r(m)},m.user.id)})]}),(0,s.jsx)(y,{orientation:"horizontal",className:"hidden"})]}),!i&&(0,s.jsx)("div",{className:"px-4 py-2 md:hidden",children:(0,s.jsx)(F,{className:"p-6"})})]}),e[1]=i,e[2]=x,e[3]=p,e[4]=r,e[5]=b):b=e[5];const c=b;let u;e[6]!==t||e[7]!==h||e[8]!==a?(u=()=>(0,s.jsx)("div",{className:"flex justify-center py-8",children:a?(0,s.jsx)(q,{className:"animate-spin text-violet-500",size:24}):t?(0,s.jsx)("div",{className:"h-4"}):h.length>0?(0,s.jsx)("p",{className:"text-sm font-medium text-zinc-500",children:"You've reached the end of the feed."}):(0,s.jsxs)("div",{className:"p-20 text-center text-zinc-500",children:[(0,s.jsx)("p",{className:"text-lg font-medium",children:"No posts yet."}),(0,s.jsx)("p",{className:"text-sm",children:"Be the first to share something amazing!"})]})}),e[6]=t,e[7]=h,e[8]=a,e[9]=u):u=e[9];const w=u;let v;e[10]!==w||e[11]!==c?(v={Header:c,Footer:w},e[10]=w,e[11]=c,e[12]=v):v=e[12];let g;e[13]!==l||e[14]!==t||e[15]!==a?(g=()=>{t&&!a&&l()},e[13]=l,e[14]=t,e[15]=a,e[16]=g):g=e[16];let j;e[17]!==d||e[18]!==i||e[19]!==n||e[20]!==o?(j=(m,k)=>(0,s.jsx)(M,{...k,currentUser:i,showToast:d,onClick:()=>n(k.id),onUserClick:o},k.feed_id||k.id),e[17]=d,e[18]=i,e[19]=n,e[20]=o,e[21]=j):j=e[21];let _;return e[22]!==h||e[23]!==v||e[24]!==g||e[25]!==j?(_=(0,s.jsx)("div",{className:"w-full max-w-full overflow-hidden min-h-screen rounded-none border-y border-zinc-100 bg-white shadow-sm dark:bg-black dark:border-zinc-800 md:rounded-xl md:border",children:(0,s.jsx)(U,{useWindowScroll:!0,data:h,components:v,endReached:g,itemContent:j})}),e[22]=h,e[23]=v,e[24]=g,e[25]=j,e[26]=_):_=e[26],_},te=R;function D(N){return(0,s.jsx)(L,{},N)}export{te as default};
