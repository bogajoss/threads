const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/VideoPlayer-BGJg6-E1.js","assets/framework-di2JoXyY.js","assets/database-CdmW3A7f.js","assets/animations-pEILWrFP.js","assets/rolldown-runtime-BaZ8gS7u.js","assets/framework-sg0yWRLc.css","assets/media-libs-D2H42K39.js","assets/media-libs-CqCaMccn.css","assets/VideoPlayer-DB4_Iv-8.js","assets/index-OUPBS7yD.js","assets/ui-libs-yzUERV1o.js","assets/query-CXZjka15.js","assets/index-DwwvjRIa.css","assets/dist-CXJwIUEX.js"])))=>i.map(i=>d[i]);
import{a as ot}from"./rolldown-runtime-BaZ8gS7u.js";import{o as wt,s as Ct}from"./animations-pEILWrFP.js";import{_ as ne,b as ct,c as q,n as $t,u as _t}from"./framework-di2JoXyY.js";import{r as St}from"./query-CXZjka15.js";import{Bn as Ft,En as ue,Fn as Pt,In as Tt,It as Mt,Jn as Rt,Ln as It,Lt as Et,Mn as Dt,Nn as Ae,On as Le,Rn as be,Un as At,Xt as Lt,Zt as Ot,_n as Ut,an as Wt,bn as Bt,en as je,er as Vt,hn as dt,kt as ae,ln as qt,nn as Ht,pn as Gt,rn as Jt,sn as Qt,tn as Xt,zt as Kt}from"./ui-libs-yzUERV1o.js";import{$ as Zt,Ct as Yt,D as es,Dt as mt,J as xt,Jt as ts,Kt as ss,O as is,Ot as ls,Q as as,Qt as ns,S as rs,St as os,Vt as Oe,Wt as cs,Yt as ds,Zt as ms,_n as G,_t as Ue,an as We,bn as Be,cn as xs,dt as Y,et as Ve,f as hs,ft as qe,g as us,gn as ze,gt as He,hn as fs,ht as Ge,l as ht,ln as ps,lt as ee,mt as Je,nt as gs,p as vs,pt as Qe,rn as bs,rt as js,sn as zs,tt as le,u as ks,ut as te,v as fe,vn as he,vt as Xe,wt as Ne,xt as Ns,y as ys,yt as Ke}from"./index-OUPBS7yD.js";import{t as ye}from"./text-processing-C3TjCoM3.js";import{t as we}from"./linkify-FEcu8M-7.js";import{p as ws,u as Ze}from"./hooks-BI5Rwf2N.js";var Cs=q(),y=ot(Ct(),1),t=ot(wt(),1),$s=i=>{const e=(0,Cs.c)(37),{isComment:s,liked:n,reposted:a,handleLike:l,handleRepost:r,handleCommentClick:o,handleShareClick:d,isDetail:p}=i;if(p!==void 0&&p){let j;e[0]!==l||e[1]!==n?(j=(0,t.jsx)(J,{icon:ue,label:"Like",type:"like",onClick:l,active:n}),e[0]=l,e[1]=n,e[2]=j):j=e[2];let k;e[3]!==r||e[4]!==s||e[5]!==a?(k=!s&&(0,t.jsx)(J,{icon:je,label:"Repost",type:"repost",onClick:r,active:a}),e[3]=r,e[4]=s,e[5]=a,e[6]=k):k=e[6];let z;e[7]!==o?(z=(0,t.jsx)(J,{icon:ht,label:"Comment",type:"comment",onClick:o}),e[7]=o,e[8]=z):z=e[8];let c;e[9]!==d||e[10]!==s?(c=!s&&(0,t.jsx)(J,{icon:fe,label:"Share",type:"share",onClick:d}),e[9]=d,e[10]=s,e[11]=c):c=e[11];let $;return e[12]!==j||e[13]!==k||e[14]!==z||e[15]!==c?($=(0,t.jsxs)("div",{className:"mt-4 flex w-full items-center justify-around py-1",children:[j,k,z,c]}),e[12]=j,e[13]=k,e[14]=z,e[15]=c,e[16]=$):$=e[16],$}const g=`flex items-center gap-x-1 ${s?"mt-1.5":"mt-3"}`,h=s?16:18;let f;e[17]!==l||e[18]!==n||e[19]!==h?(f=(0,t.jsx)(J,{icon:ue,size:h,type:"like",onClick:l,active:n}),e[17]=l,e[18]=n,e[19]=h,e[20]=f):f=e[20];const b=s?16:18;let u;e[21]!==o||e[22]!==b?(u=(0,t.jsx)(J,{icon:dt,size:b,type:"comment",onClick:o}),e[21]=o,e[22]=b,e[23]=u):u=e[23];const x=s?16:18;let v;e[24]!==r||e[25]!==a||e[26]!==x?(v=(0,t.jsx)(J,{icon:je,size:x,type:"repost",onClick:r,active:a}),e[24]=r,e[25]=a,e[26]=x,e[27]=v):v=e[27];let m;e[28]!==d||e[29]!==s?(m=!s&&d&&(0,t.jsx)(J,{icon:fe,type:"share",onClick:d}),e[28]=d,e[29]=s,e[30]=m):m=e[30];let w;return e[31]!==g||e[32]!==f||e[33]!==u||e[34]!==v||e[35]!==m?(w=(0,t.jsxs)("div",{className:g,children:[f,u,v,m]}),e[31]=g,e[32]=f,e[33]=u,e[34]=v,e[35]=m,e[36]=w):w=e[36],w},Ye=$s,_s=q(),Ss=i=>{const e=(0,_s.c)(38),{views:s,likes:n,comments:a,isDetail:l,isComment:r,onRepliesClick:o}=i,d=l===void 0?!1:l,p=r===void 0?!1:r;if(d){const v=s||0;let m;e[0]!==v?(m=(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:v}),e[0]=v,e[1]=m):m=e[1];let w;e[2]===Symbol.for("react.memo_cache_sentinel")?(w=(0,t.jsx)("span",{className:"opacity-70",children:"Views"}),e[2]=w):w=e[2];let j;e[3]!==m?(j=(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[m," ",w]}),e[3]=m,e[4]=j):j=e[4];const k=n||0;let z;e[5]!==k?(z=(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:k}),e[5]=k,e[6]=z):z=e[6];let c;e[7]===Symbol.for("react.memo_cache_sentinel")?(c=(0,t.jsx)("span",{className:"opacity-70",children:"Likes"}),e[7]=c):c=e[7];let $;e[8]!==z?($=(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[z," ",c]}),e[8]=z,e[9]=$):$=e[9];const S=a||0;let T;e[10]!==S?(T=(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:S}),e[10]=S,e[11]=T):T=e[11];let F;e[12]===Symbol.for("react.memo_cache_sentinel")?(F=(0,t.jsx)("span",{className:"opacity-70",children:"Comments"}),e[12]=F):F=e[12];let N;e[13]!==T?(N=(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[T," ",F]}),e[13]=T,e[14]=N):N=e[14];let M;return e[15]!==$||e[16]!==N||e[17]!==j?(M=(0,t.jsxs)("div",{className:"mt-4 flex items-center gap-x-6 border-b border-zinc-100 pb-4 text-sm text-zinc-500 dark:border-zinc-800 dark:text-zinc-400",children:[j,$,N]}),e[15]=$,e[16]=N,e[17]=j,e[18]=M):M=e[18],M}if(a===0&&n===0&&(s===0||p))return null;const g=`mt-1 flex items-center gap-x-1.5 px-0.5 ${p?"text-[12px]":"text-[14px]"} font-medium text-zinc-500 dark:text-zinc-400`;let h;e[19]!==a||e[20]!==p||e[21]!==n||e[22]!==s?(h=s>0&&!p&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{className:"hover:underline",children:[s," ",s===1?"view":"views"]}),(a>0||n>0)&&(0,t.jsx)("span",{className:"opacity-50",children:"·"})]}),e[19]=a,e[20]=p,e[21]=n,e[22]=s,e[23]=h):h=e[23];let f;e[24]!==a||e[25]!==o?(f=a>0&&(0,t.jsxs)("button",{className:"hover:underline",onClick:v=>{v.stopPropagation(),o&&o(v)},children:[a," ",a===1?"reply":"replies"]}),e[24]=a,e[25]=o,e[26]=f):f=e[26];let b;e[27]!==a||e[28]!==n?(b=a>0&&n>0&&(0,t.jsx)("span",{className:"opacity-50",children:"·"}),e[27]=a,e[28]=n,e[29]=b):b=e[29];let u;e[30]!==n?(u=n>0&&(0,t.jsxs)("button",{className:"hover:underline",children:[n," ",n===1?"like":"likes"]}),e[30]=n,e[31]=u):u=e[31];let x;return e[32]!==g||e[33]!==h||e[34]!==f||e[35]!==b||e[36]!==u?(x=(0,t.jsxs)("div",{className:g,children:[h,f,b,u]}),e[32]=g,e[33]=h,e[34]=f,e[35]=b,e[36]=u,e[37]=x):x=e[37],x},et=Ss,Fs=q(),Ps=i=>{const e=(0,Fs.c)(43),{user:s,timeAgo:n,community:a,onUserClick:l,actionsMenu:r,isComment:o,isDetail:d,showAvatar:p}=i,g=p===void 0?!1:p,h=ne();let f;e[0]!==l||e[1]!==s.handle?(f=R=>{R.stopPropagation(),l&&l(s.handle)},e[0]=l,e[1]=s.handle,e[2]=f):f=e[2];const b=f;let u;e[3]!==a||e[4]!==h?(u=R=>{R.stopPropagation(),a&&h(`/c/${a.handle}`)},e[3]=a,e[4]=h,e[5]=u):u=e[5];const x=u,v=`flex items-center justify-between ${d?"pb-4":"min-h-[40px] mb-1"}`;let m;e[6]!==b||e[7]!==o||e[8]!==d||e[9]!==g||e[10]!==s.avatar||e[11]!==s.handle?(m=g&&(0,t.jsx)("button",{className:"shrink-0",onClick:b,children:(0,t.jsxs)(ee,{className:`${d?"size-12":o?"size-8":"size-10"} border-0 shadow-sm`,children:[(0,t.jsx)(Y,{src:s.avatar,alt:s.handle,className:"object-cover"}),(0,t.jsx)(te,{className:"text-xs",children:s.handle[0]?.toUpperCase()})]})}),e[6]=b,e[7]=o,e[8]=d,e[9]=g,e[10]=s.avatar,e[11]=s.handle,e[12]=m):m=e[12];const w=`flex shrink-0 items-center gap-1 font-bold text-zinc-900 hover:underline dark:text-white ${d?"text-base sm:text-lg":o?"text-[14px]":"text-[15px]"}`;let j;e[13]!==s.handle?(j=(0,t.jsx)("span",{className:"max-w-[150px] truncate sm:max-w-none",children:s.handle}),e[13]=s.handle,e[14]=j):j=e[14];let k;e[15]!==o||e[16]!==d||e[17]!==s.verified?(k=s.verified&&(0,t.jsx)(ys,{size:d?16:o?12:14,className:"text-blue-500"}),e[15]=o,e[16]=d,e[17]=s.verified,e[18]=k):k=e[18];let z;e[19]!==b||e[20]!==w||e[21]!==j||e[22]!==k?(z=(0,t.jsxs)("button",{className:w,onClick:b,children:[j,k]}),e[19]=b,e[20]=w,e[21]=j,e[22]=k,e[23]=z):z=e[23];let c;e[24]!==a||e[25]!==x||e[26]!==d?(c=a&&(0,t.jsxs)("div",{className:"flex min-w-0 items-center gap-1 text-zinc-500",children:[(0,t.jsx)(ks,{size:d?14:12,className:"shrink-0 text-zinc-400"}),(0,t.jsxs)("button",{className:`flex items-center gap-1 font-bold text-zinc-900 hover:underline dark:text-zinc-100 ${d?"text-[14px] sm:text-[15px]":"text-[13px]"}`,onClick:x,children:[(0,t.jsxs)(ee,{className:"size-3.5 shrink-0 border border-zinc-200 bg-zinc-100 dark:border-zinc-700 dark:bg-zinc-800",children:[(0,t.jsx)(Y,{src:a.avatar,alt:a.name,className:"object-cover"}),(0,t.jsx)(te,{className:"text-[6px] font-bold text-zinc-500",children:a.name?.[0]?.toUpperCase()})]}),(0,t.jsx)("span",{className:"max-w-[150px] truncate sm:max-w-none",children:a.name})]})]}),e[24]=a,e[25]=x,e[26]=d,e[27]=c):c=e[27];let $;e[28]!==c||e[29]!==z?($=(0,t.jsx)("div",{className:"flex min-w-0 flex-1 flex-col",children:(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-x-1.5 leading-none",children:(0,t.jsxs)("div",{className:"flex min-w-0 max-w-full items-center gap-1.5",children:[z,c]})})}),e[28]=c,e[29]=z,e[30]=$):$=e[30];let S;e[31]!==$||e[32]!==m?(S=(0,t.jsxs)("div",{className:"flex items-center gap-x-3 flex-1 min-w-0",children:[m,$]}),e[31]=$,e[32]=m,e[33]=S):S=e[33];const T=n||"Recent";let F;e[34]!==T?(F=(0,t.jsx)("span",{className:"whitespace-nowrap text-[12px] text-zinc-500 dark:text-zinc-400",children:T}),e[34]=T,e[35]=F):F=e[35];let N;e[36]!==r||e[37]!==F?(N=(0,t.jsxs)("div",{className:"-mt-1 flex items-center gap-2",children:[F,r]}),e[36]=r,e[37]=F,e[38]=N):N=e[38];let M;return e[39]!==S||e[40]!==N||e[41]!==v?(M=(0,t.jsxs)("div",{className:v,children:[S,N]}),e[39]=S,e[40]=N,e[41]=v,e[42]=M):M=e[42],M},tt=Ps,Ts=q(),Ms=i=>{const e=(0,Ts.c)(45),{content:s,isDetail:n,isEditing:a,editedContent:l,setEditedContent:r,onCancelEdit:o,onSaveEdit:d,isUpdating:p,contentClass:g}=i,h=ne(),[f,b]=(0,y.useState)(!1),u=typeof s=="string"&&Be(s);if(a&&r){let N;e[0]!==r?(N=_=>r(_.target.value),e[0]=r,e[1]=N):N=e[1];const M=`min-h-[100px] w-full rounded-xl border-zinc-200 bg-zinc-50 focus:ring-violet-500 dark:border-zinc-800 dark:bg-zinc-900 ${Be(l||"")?"font-bangla text-lg":"font-english"}`;let R;e[2]!==l||e[3]!==N||e[4]!==M?(R=(0,t.jsx)(rs,{value:l,onChange:N,className:M,autoFocus:!0}),e[2]=l,e[3]=N,e[4]=M,e[5]=R):R=e[5];let E;e[6]!==o?(E=(0,t.jsx)("button",{onClick:o,className:"px-4 py-1.5 text-sm font-bold text-zinc-500 transition-colors hover:text-zinc-700 dark:hover:text-zinc-300",children:"Cancel"}),e[6]=o,e[7]=E):E=e[7];let D;e[8]!==s||e[9]!==l||e[10]!==p?(D=p||!l?.trim()||l===s,e[8]=s,e[9]=l,e[10]=p,e[11]=D):D=e[11];const U=p?"Saving...":"Save";let A;e[12]!==d||e[13]!==D||e[14]!==U?(A=(0,t.jsx)("button",{onClick:d,disabled:D,className:"rounded-full bg-violet-600 px-4 py-1.5 text-sm font-bold text-white transition-all hover:bg-violet-700 disabled:opacity-50 active:scale-95",children:U}),e[12]=d,e[13]=D,e[14]=U,e[15]=A):A=e[15];let L;e[16]!==E||e[17]!==A?(L=(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[E,A]}),e[16]=E,e[17]=A,e[18]=L):L=e[18];let W;return e[19]!==R||e[20]!==L?(W=(0,t.jsxs)("div",{className:"mt-2 flex flex-col gap-2",onClick:Rs,children:[R,L]}),e[19]=R,e[20]=L,e[21]=W):W=e[21],W}const x=!n&&s.length>280;let v;e[22]!==s||e[23]!==f||e[24]!==x?(v=x&&!f?s.substring(0,280):s,e[22]=s,e[23]=f,e[24]=x,e[25]=v):v=e[25];const m=v,w=n?"text-lg leading-relaxed sm:text-xl sm:leading-8":"text-[15px] leading-relaxed",j=u?"font-bangla text-[1.15em]":"font-english";let k;e[26]!==g||e[27]!==w||e[28]!==j?(k=G("whitespace-pre-line break-words",w,j,g),e[26]=g,e[27]=w,e[28]=j,e[29]=k):k=e[29];let z;e[30]!==h?(z={...we,render:N=>{const{attributes:M,content:R}=N,{href:E,...D}=M,U=window.location.origin;if(E.includes("internal.tag/")){const L=decodeURIComponent(E.split("internal.tag/")[1]);return(0,t.jsxs)("span",{...D,className:G("cursor-pointer font-bold text-rose-600 hover:underline dark:text-rose-400 font-bangla",D.className),onClick:W=>{W.stopPropagation(),h(`/tags/${L}`)},children:["#",L]},R)}let A=null;return E.startsWith("/")?A=E:E.startsWith(U)&&(A=E.replace(U,"")),A?(0,t.jsx)("span",{...D,className:G("cursor-pointer font-medium text-violet-600 hover:underline dark:text-violet-400",D.className),onClick:L=>{L.stopPropagation(),h(A)},children:R},R):(0,t.jsx)("a",{href:E,...D,target:"_blank",rel:"noopener noreferrer",className:G("text-violet-600 hover:underline dark:text-violet-400",D.className),onClick:Is,children:R},R)}},e[30]=h,e[31]=z):z=e[31];let c;e[32]!==m?(c=typeof m=="string"?m.replace(/#([\u0980-\u09FF\w]+)/g,"https://internal.tag/$1"):m,e[32]=m,e[33]=c):c=e[33];let $;e[34]!==z||e[35]!==c?($=(0,t.jsx)(ye,{options:z,children:c}),e[34]=z,e[35]=c,e[36]=$):$=e[36];const S=x&&!f&&"...";let T;e[37]!==f||e[38]!==x?(T=x&&(0,t.jsx)("button",{onClick:N=>{N.stopPropagation(),b(!f)},className:"ml-1 cursor-pointer font-bold text-rose-600 hover:underline dark:text-rose-400",children:f?"Show less":"See more"}),e[37]=f,e[38]=x,e[39]=T):T=e[39];let F;return e[40]!==k||e[41]!==$||e[42]!==S||e[43]!==T?(F=(0,t.jsxs)("div",{className:k,children:[$,S,T]}),e[40]=k,e[41]=$,e[42]=S,e[43]=T,e[44]=F):F=e[44],F},st=Ms;function Rs(i){return i.stopPropagation()}function Is(i){return i.stopPropagation()}var Es=q(),Ds=i=>{const e=(0,Es.c)(28),{media:s,isEditing:n,editedMedia:a,setEditedMedia:l,newFiles:r,setNewFiles:o}=i;let d;e[0]!==a?(d=a===void 0?[]:a,e[0]=a,e[1]=d):d=e[1];const p=d;let g;e[2]!==r?(g=r===void 0?[]:r,e[2]=r,e[3]=g):g=e[3];const h=g,f=(0,y.useRef)(null);if(n&&l&&o){let u;if(e[4]!==p||e[5]!==l){let k;e[7]!==l?(k=(z,c)=>(0,t.jsxs)("div",{className:"group relative aspect-square overflow-hidden rounded-xl border border-zinc-200 dark:border-zinc-800",children:[z.type==="video"?(0,t.jsx)("div",{className:"flex size-full items-center justify-center bg-zinc-100 dark:bg-zinc-900",children:(0,t.jsx)(Ae,{size:24,className:"text-zinc-400"})}):(0,t.jsx)("img",{src:z.url||z.src,className:"size-full object-cover",alt:""}),(0,t.jsx)("button",{onClick:$=>{$.stopPropagation(),l(S=>S.filter((T,F)=>F!==c))},className:"absolute right-1.5 top-1.5 flex size-7 items-center justify-center rounded-full bg-black/60 text-white transition-colors hover:bg-black",children:(0,t.jsx)(ae,{size:16})})]},`old-${c}`),e[7]=l,e[8]=k):k=e[8],u=p.map(k),e[4]=p,e[5]=l,e[6]=u}else u=e[6];let x;if(e[9]!==h||e[10]!==o){let k;e[12]!==o?(k=(z,c)=>(0,t.jsxs)("div",{className:"group relative aspect-square overflow-hidden rounded-xl border-2 border-dashed border-violet-500 bg-violet-50/10",children:[z.type.startsWith("image/")?(0,t.jsx)("img",{src:URL.createObjectURL(z),className:"size-full object-cover",alt:""}):(0,t.jsx)("div",{className:"flex size-full items-center justify-center",children:(0,t.jsx)(Ae,{size:24,className:"animate-pulse text-violet-500"})}),(0,t.jsx)("button",{onClick:$=>{$.stopPropagation(),o(S=>S.filter((T,F)=>F!==c))},className:"absolute right-1.5 top-1.5 flex size-7 items-center justify-center rounded-full bg-black/60 text-white transition-colors hover:bg-black",children:(0,t.jsx)(ae,{size:16})}),(0,t.jsx)("div",{className:"absolute bottom-1 left-1 rounded bg-violet-600 px-1 text-[8px] font-bold text-white",children:"NEW"})]},`new-${c}`),e[12]=o,e[13]=k):k=e[13],x=h.map(k),e[9]=h,e[10]=o,e[11]=x}else x=e[11];let v;e[14]!==p.length||e[15]!==h.length?(v=p.length+h.length<4&&(0,t.jsxs)("button",{onClick:k=>{k.stopPropagation(),f.current?.click()},className:"relative flex aspect-square flex-col items-center justify-center gap-1 rounded-xl border-2 border-dashed border-zinc-200 text-zinc-400 transition-all hover:border-violet-500 hover:bg-violet-50/5 hover:text-violet-500 dark:border-zinc-800",children:[(0,t.jsx)(Xt,{size:20}),(0,t.jsx)("span",{className:"text-[10px] font-bold",children:"Add Media"})]}),e[14]=p.length,e[15]=h.length,e[16]=v):v=e[16];let m;e[17]!==u||e[18]!==x||e[19]!==v?(m=(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:[u,x,v]}),e[17]=u,e[18]=x,e[19]=v,e[20]=m):m=e[20];let w;e[21]!==o?(w=(0,t.jsx)("input",{type:"file",ref:f,onChange:k=>{if(k.target.files){const z=Array.from(k.target.files);o(c=>[...c,...z])}},multiple:!0,className:"hidden",accept:"image/*,video/*"}),e[21]=o,e[22]=w):w=e[22];let j;return e[23]!==m||e[24]!==w?(j=(0,t.jsxs)("div",{className:"mt-3 space-y-3",children:[m,w]}),e[23]=m,e[24]=w,e[25]=j):j=e[25],j}if(!s||s.length===0)return null;let b;return e[26]!==s?(b=(0,t.jsx)(ni,{items:s}),e[26]=s,e[27]=b):b=e[27],b},it=Ds,As=q(),Ls=i=>{const e=(0,As.c)(35),{icon:s,count:n,label:a,onClick:l,active:r,activeColorClass:o,size:d,type:p}=i,g=d===void 0?18:d,h=p===void 0?"default":p;let f,b,u,x,v;if(e[0]!==r||e[1]!==o||e[2]!==n||e[3]!==a||e[4]!==l||e[5]!==h){const T={like:{hoverBg:"group-hover:bg-rose-500/10",hoverText:"group-hover:text-rose-500",activeText:"text-rose-500",activeFill:"fill-rose-500"},repost:{hoverBg:"group-hover:bg-emerald-500/10",hoverText:"group-hover:text-emerald-500",activeText:"text-emerald-500",activeFill:"fill-emerald-500"},comment:{hoverBg:"group-hover:bg-sky-500/10",hoverText:"group-hover:text-sky-500",activeText:"text-sky-500",activeFill:"fill-sky-500"},share:{hoverBg:"group-hover:bg-violet-500/10",hoverText:"group-hover:text-violet-500",activeText:"text-violet-500",activeFill:"fill-violet-500"},default:{hoverBg:"group-hover:bg-zinc-500/10",hoverText:"group-hover:text-zinc-500",activeText:"text-zinc-900 dark:text-white",activeFill:"fill-current"}};f=T[h]||T.default;const F=o||f.activeText;e[11]!==l?(u=N=>{N.stopPropagation(),l&&l(N)},e[11]=l,e[12]=u):u=e[12],x=`${a} ${n!==void 0?`(${n})`:""}`,v=G("group -ml-2 flex items-center gap-x-0.5 rounded-xl px-2 py-1.5 text-[12px] font-bold transition-all sm:gap-x-1 sm:text-[13px]",r?F:"text-zinc-500",!r&&f.hoverText),b=G("rounded-full p-2 transition-all duration-200",!r&&f.hoverBg),e[0]=r,e[1]=o,e[2]=n,e[3]=a,e[4]=l,e[5]=h,e[6]=f,e[7]=b,e[8]=u,e[9]=x,e[10]=v}else f=e[6],b=e[7],u=e[8],x=e[9],v=e[10];const m=r?2.5:2,w=r&&f.activeFill;let j;e[13]!==w?(j=G("transition-colors duration-200",w),e[13]=w,e[14]=j):j=e[14];let k;e[15]!==s||e[16]!==g||e[17]!==m||e[18]!==j?(k=(0,t.jsx)(s,{size:g,strokeWidth:m,className:j}),e[15]=s,e[16]=g,e[17]=m,e[18]=j,e[19]=k):k=e[19];let z;e[20]!==k||e[21]!==b?(z=(0,t.jsx)("div",{className:b,children:k}),e[20]=k,e[21]=b,e[22]=z):z=e[22];let c;e[23]!==a?(c=a&&(0,t.jsx)("span",{className:"hidden xs:inline",children:a}),e[23]=a,e[24]=c):c=e[24];let $;e[25]!==r||e[26]!==n?($=n!=null&&(0,t.jsx)("span",{className:G("transition-all",r?"font-black":"font-bold"),children:n||0}),e[25]=r,e[26]=n,e[27]=$):$=e[27];let S;return e[28]!==z||e[29]!==c||e[30]!==$||e[31]!==u||e[32]!==x||e[33]!==v?(S=(0,t.jsxs)("button",{onClick:u,"aria-label":x,className:v,children:[z,c,$]}),e[28]=z,e[29]=c,e[30]=$,e[31]=u,e[32]=x,e[33]=v,e[34]=S):S=e[34],S},J=Ls,Os=q(),Us=i=>{const e=(0,Os.c)(18),{poll:s,onVote:n}=i,a=s.options.reduce(Ws,0),[l,r]=(0,y.useState)(null);let o;e[0]!==n||e[1]!==l?(o=u=>{l||(r(u),n&&n(u))},e[0]=n,e[1]=l,e[2]=o):o=e[2];const d=o;let p;if(e[3]!==d||e[4]!==s.options||e[5]!==a||e[6]!==l){let u;e[8]!==d||e[9]!==a||e[10]!==l?(u=(x,v)=>{const m=a>0?Math.round((x.votes+(l===x.id?1:0))/(a+(l?1:0))*100):0,w=l===x.id;return(0,t.jsxs)("div",{onClick:()=>d(x.id),className:`relative h-10 w-full overflow-hidden rounded-xl border cursor-pointer ${w?"border-violet-500 dark:border-violet-500":"border-zinc-200 dark:border-zinc-700"}`,children:[l&&(0,t.jsx)("div",{className:"absolute left-0 top-0 h-full bg-zinc-200 transition-all duration-500 dark:bg-zinc-800",style:{width:`${m}%`}}),(0,t.jsxs)("div",{className:"absolute inset-0 z-10 flex items-center justify-between px-4",children:[(0,t.jsxs)("span",{className:`text-sm font-medium ${w?"font-bold text-violet-600":"text-zinc-700 dark:text-zinc-200"}`,children:[x.text," ",w&&(0,t.jsx)(Rt,{size:14,className:"mb-0.5 inline ml-1"})]}),l&&(0,t.jsxs)("span",{className:"text-sm font-bold text-zinc-900 dark:text-white",children:[m,"%"]})]})]},x.id||v)},e[8]=d,e[9]=a,e[10]=l,e[11]=u):u=e[11],p=s.options.map(u),e[3]=d,e[4]=s.options,e[5]=a,e[6]=l,e[7]=p}else p=e[7];const g=a+(l?1:0),h=l?"6 days left":"Click to vote";let f;e[12]!==g||e[13]!==h?(f=(0,t.jsxs)("div",{className:"pl-1 text-xs text-zinc-500 dark:text-zinc-400",children:[g," votes •"," ",h]}),e[12]=g,e[13]=h,e[14]=f):f=e[14];let b;return e[15]!==p||e[16]!==f?(b=(0,t.jsxs)("div",{className:"mt-3 space-y-2",children:[p,f]}),e[15]=p,e[16]=f,e[17]=b):b=e[17],b},lt=Us;function Ws(i,e){return i+e.votes}var Bs=q(),Vs=i=>{const e=(0,Bs.c)(30),{user:s,time:n,content:a}=i,l=ne();let r;e[0]!==s.avatar||e[1]!==s.handle?(r=(0,t.jsx)(Y,{src:s.avatar,alt:s.handle}),e[0]=s.avatar,e[1]=s.handle,e[2]=r):r=e[2];let o;e[3]!==s.handle[0]?(o=s.handle[0]?.toUpperCase(),e[3]=s.handle[0],e[4]=o):o=e[4];let d;e[5]!==o?(d=(0,t.jsx)(te,{children:o}),e[5]=o,e[6]=d):d=e[6];let p;e[7]!==r||e[8]!==d?(p=(0,t.jsxs)(ee,{className:"size-6",children:[r,d]}),e[7]=r,e[8]=d,e[9]=p):p=e[9];let g;e[10]!==s.handle?(g=(0,t.jsx)("span",{className:"text-sm font-semibold",children:s.handle}),e[10]=s.handle,e[11]=g):g=e[11];let h;e[12]!==p||e[13]!==g?(h=(0,t.jsxs)("div",{className:"flex items-center gap-x-2",children:[p,g]}),e[12]=p,e[13]=g,e[14]=h):h=e[14];let f;e[15]!==n?(f=(0,t.jsx)("span",{className:"text-xs text-zinc-500 sm:text-sm",children:n}),e[15]=n,e[16]=f):f=e[16];let b;e[17]!==h||e[18]!==f?(b=(0,t.jsxs)("div",{className:"mb-2 flex items-center justify-between gap-x-2",children:[h,f]}),e[17]=h,e[18]=f,e[19]=b):b=e[19];let u;e[20]!==l?(u={...we,render:w=>{const{attributes:j,content:k}=w,{href:z,...c}=j,$=window.location.origin;let S=null;return z.startsWith("/")?S=z:z.startsWith($)&&(S=z.replace($,"")),S?(0,t.jsx)("span",{...c,className:G("cursor-pointer font-medium text-violet-600 hover:underline dark:text-violet-400",c.className),onClick:T=>{T.stopPropagation(),l(S)},children:k},k):(0,t.jsx)("a",{href:z,...c,target:"_blank",rel:"noopener noreferrer",className:G("text-violet-600 hover:underline dark:text-violet-400",c.className),onClick:qs,children:k},k)}},e[20]=l,e[21]=u):u=e[21];let x;e[22]!==a?(x=(0,t.jsx)("p",{className:"whitespace-pre-line text-sm text-zinc-800 dark:text-zinc-300",children:a}),e[22]=a,e[23]=x):x=e[23];let v;e[24]!==x||e[25]!==u?(v=(0,t.jsx)(ye,{options:u,children:x}),e[24]=x,e[25]=u,e[26]=v):v=e[26];let m;return e[27]!==v||e[28]!==b?(m=(0,t.jsxs)("div",{className:"p-4",children:[b,v]}),e[27]=v,e[28]=b,e[29]=m):m=e[29],m},at=Vs;function qs(i){return i.stopPropagation()}var Hs=q(),Gs=i=>{const e=(0,Hs.c)(54),{currentUser:s,newComment:n,setNewComment:a,handleSubmitComment:l,loading:r,selectedFiles:o,setSelectedFiles:d,isUploading:p}=i;let g;e[0]!==o?(g=o===void 0?[]:o,e[0]=o,e[1]=g):g=e[1];const h=g,f=(0,y.useRef)(null);let b;e[2]!==d?(b=C=>{if(C.target.files){const I=Array.from(C.target.files);d&&d(O=>[...O,...I])}},e[2]=d,e[3]=b):b=e[3];const u=b;let x;e[4]!==d?(x=C=>{d&&d(I=>I.filter((O,B)=>B!==C))},e[4]=d,e[5]=x):x=e[5];const v=x;let m;e[6]!==d?(m=C=>{const I=C.clipboardData.files;if(I&&I.length>0){const O=Array.from(I).filter(Js);O.length>0&&(C.preventDefault(),d&&d(B=>[...B,...O]))}},e[6]=d,e[7]=m):m=e[7];const w=m;if(!s){let C;return e[8]===Symbol.for("react.memo_cache_sentinel")?(C=(0,t.jsx)("div",{className:"border-y border-zinc-100 bg-zinc-50/30 p-6 text-center dark:border-zinc-800 dark:bg-zinc-900/10",children:(0,t.jsx)("p",{className:"text-sm text-zinc-500",children:"Please login to join the conversation."})}),e[8]=C):C=e[8],C}let j;e[9]!==s.avatar||e[10]!==s.handle?(j=(0,t.jsx)(Y,{src:s.avatar,alt:s.handle,className:"object-cover"}),e[9]=s.avatar,e[10]=s.handle,e[11]=j):j=e[11];let k;e[12]!==s.handle?.[0]?(k=s.handle?.[0]?.toUpperCase(),e[12]=s.handle?.[0],e[13]=k):k=e[13];let z;e[14]!==k?(z=(0,t.jsx)(te,{children:k}),e[14]=k,e[15]=z):z=e[15];let c;e[16]!==j||e[17]!==z?(c=(0,t.jsxs)(ee,{className:"size-9 border border-zinc-200 dark:border-zinc-700",children:[j,z]}),e[16]=j,e[17]=z,e[18]=c):c=e[18];let $;e[19]!==a?($=C=>a(C.target.value),e[19]=a,e[20]=$):$=e[20];let S;e[21]!==w||e[22]!==n||e[23]!==$?(S=(0,t.jsx)("textarea",{id:"comment-input",className:"min-h-[60px] w-full resize-none bg-transparent text-base outline-none placeholder:text-zinc-500 dark:text-white",placeholder:"Post your reply...",value:n,onChange:$,onPaste:w}),e[21]=w,e[22]=n,e[23]=$,e[24]=S):S=e[24];let T;e[25]!==v||e[26]!==h?(T=h.length>0&&(0,t.jsx)("div",{className:"mt-2 mb-2 flex flex-wrap gap-2",children:h.map((C,I)=>(0,t.jsxs)("div",{className:"relative size-20 overflow-hidden rounded-xl border border-zinc-200 dark:border-zinc-800",children:[C.type.startsWith("image/")?(0,t.jsx)("img",{src:URL.createObjectURL(C),className:"size-full object-cover",alt:""}):(0,t.jsx)("div",{className:"flex size-full items-center justify-center bg-zinc-100 dark:bg-zinc-800",children:(0,t.jsx)(Qt,{size:20,className:"text-zinc-500"})}),(0,t.jsx)("button",{onClick:()=>v(I),className:"absolute right-1 top-1 rounded-full bg-black/60 p-1 text-white transition-colors hover:bg-black",children:(0,t.jsx)(ae,{size:12})})]},I))}),e[25]=v,e[26]=h,e[27]=T):T=e[27];let F;e[28]===Symbol.for("react.memo_cache_sentinel")?(F=()=>f.current?.click(),e[28]=F):F=e[28];let N;e[29]===Symbol.for("react.memo_cache_sentinel")?(N=(0,t.jsx)("button",{type:"button",onClick:F,className:"rounded-full p-2 text-violet-600 transition-colors hover:bg-violet-50 dark:hover:bg-zinc-800",title:"Attach media",children:(0,t.jsx)(us,{size:20})}),e[29]=N):N=e[29];let M;e[30]!==u?(M=(0,t.jsxs)("div",{className:"flex gap-1 text-violet-600",children:[N,(0,t.jsx)("input",{type:"file",ref:f,onChange:u,multiple:!0,className:"hidden",accept:"image/*,video/*,application/pdf"})]}),e[30]=u,e[31]=M):M=e[31];const R=r||p?"primary":"animated";let E;e[32]!==p||e[33]!==r?(E=!(r||p)&&(0,t.jsx)(fe,{size:20}),e[32]=p,e[33]=r,e[34]=E):E=e[34];const D=r||p;let U;e[35]!==n||e[36]!==h.length?(U=!n.trim()&&h.length===0,e[35]=n,e[36]=h.length,e[37]=U):U=e[37];let A;e[38]!==l||e[39]!==R||e[40]!==E||e[41]!==D||e[42]!==U?(A=(0,t.jsx)(Ns,{variant:R,icon:E,className:"min-w-[70px] !w-auto",onClick:l,loading:D,disabled:U,children:"Reply"}),e[38]=l,e[39]=R,e[40]=E,e[41]=D,e[42]=U,e[43]=A):A=e[43];let L;e[44]!==M||e[45]!==A?(L=(0,t.jsxs)("div",{className:"mt-2 flex items-center justify-between border-t border-zinc-100 pt-3 dark:border-zinc-800",children:[M,A]}),e[44]=M,e[45]=A,e[46]=L):L=e[46];let W;e[47]!==S||e[48]!==T||e[49]!==L?(W=(0,t.jsxs)("div",{className:"flex-1",children:[S,T,L]}),e[47]=S,e[48]=T,e[49]=L,e[50]=W):W=e[50];let _;return e[51]!==W||e[52]!==c?(_=(0,t.jsx)("div",{className:"border-y border-zinc-100 bg-zinc-50/30 p-4 dark:border-zinc-800 dark:bg-zinc-900/10",children:(0,t.jsxs)("div",{className:"flex gap-3",children:[c,W]})}),e[51]=W,e[52]=c,e[53]=_):_=e[53],_},ut=y.memo(Gs);function Js(i){return i.type.startsWith("image/")}var Qs=q(),Xs=i=>{const e=(0,Qs.c)(30),{url:s}=i;let n,a;e[0]!==s?(n=["link-preview",s],a=()=>ls(s),e[0]=s,e[1]=n,e[2]=a):(n=e[1],a=e[2]);const l=!!s;let r;e[3]!==n||e[4]!==a||e[5]!==l?(r={queryKey:n,queryFn:a,staleTime:864e5,enabled:l},e[3]=n,e[4]=a,e[5]=l,e[6]=r):r=e[6];const{data:o,isLoading:d,isError:p}=St(r);if(d){let j;return e[7]===Symbol.for("react.memo_cache_sentinel")?(j=(0,t.jsx)("div",{className:"mt-3 flex h-24 animate-pulse items-center justify-center overflow-hidden rounded-2xl border border-zinc-100 bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-900/50",children:(0,t.jsx)(Le,{className:"animate-spin text-zinc-300 dark:text-zinc-700",size:24})}),e[7]=j):j=e[7],j}if(p||!o||!o.title&&!o.image)return null;let g;e[8]!==o.image||e[9]!==o.title?(g=o.image&&(0,t.jsx)("div",{className:"aspect-[1.91/1] w-full overflow-hidden border-b border-zinc-100 bg-zinc-100 dark:border-zinc-800 dark:bg-zinc-900",children:(0,t.jsx)("img",{src:o.image,alt:o.title??void 0,className:"h-full w-full object-cover transition-transform duration-500 group-hover:scale-[1.02]",onError:Zs})}),e[8]=o.image,e[9]=o.title,e[10]=g):g=e[10];let h;e[11]===Symbol.for("react.memo_cache_sentinel")?(h=(0,t.jsx)(Le,{size:12}),e[11]=h):h=e[11];let f;e[12]!==o.siteName?(f=(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs font-bold uppercase tracking-wider text-zinc-600",children:[h,(0,t.jsx)("span",{children:o.siteName})]}),e[12]=o.siteName,e[13]=f):f=e[13];let b;e[14]!==o.title?(b=(0,t.jsx)("div",{className:"line-clamp-2 text-[15px] font-bold leading-snug transition-colors group-hover:text-violet-700 dark:text-white",children:o.title}),e[14]=o.title,e[15]=b):b=e[15];let u;e[16]!==o.description?(u=o.description&&(0,t.jsx)("p",{className:"line-clamp-2 text-xs leading-relaxed text-zinc-600 dark:text-zinc-400",children:o.description}),e[16]=o.description,e[17]=u):u=e[17];let x;e[18]===Symbol.for("react.memo_cache_sentinel")?(x=(0,t.jsx)(It,{size:10}),e[18]=x):x=e[18];let v;e[19]!==s?(v=(0,t.jsxs)("div",{className:"flex items-center gap-1 pt-1 text-[11px] font-medium text-zinc-500",children:[x,(0,t.jsx)("span",{className:"truncate",children:s})]}),e[19]=s,e[20]=v):v=e[20];let m;e[21]!==v||e[22]!==f||e[23]!==b||e[24]!==u?(m=(0,t.jsxs)("div",{className:"space-y-1 p-3.5",children:[f,b,u,v]}),e[21]=v,e[22]=f,e[23]=b,e[24]=u,e[25]=m):m=e[25];let w;return e[26]!==m||e[27]!==g||e[28]!==s?(w=(0,t.jsxs)("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"group mt-3 flex flex-col overflow-hidden rounded-2xl border border-zinc-100 bg-white shadow-sm transition-all hover:bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-950 dark:hover:bg-zinc-900",onClick:Ks,children:[g,m]}),e[26]=m,e[27]=g,e[28]=s,e[29]=w):w=e[29],w},nt=Xs;function Ks(i){return i.stopPropagation()}function Zs(i){return i.target.style.display="none"}var Ys=q(),ei=i=>{const e=(0,Ys.c)(15),{file:s}=i;let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,t.jsx)("div",{className:"flex size-10 items-center justify-center rounded-xl bg-violet-100 text-violet-600 dark:bg-violet-900/30",children:(0,t.jsx)(Pt,{size:20})}),e[0]=n):n=e[0];let a;e[1]!==s.name?(a=(0,t.jsx)("div",{className:"truncate text-sm font-bold dark:text-white",children:s.name}),e[1]=s.name,e[2]=a):a=e[2];let l;e[3]!==s.size?(l=s.size!==void 0&&(0,t.jsxs)("div",{className:"text-xs uppercase text-zinc-500",children:[(s.size/1024/1024).toFixed(2)," MB"]}),e[3]=s.size,e[4]=l):l=e[4];let r;e[5]!==a||e[6]!==l?(r=(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[a,l]}),e[5]=a,e[6]=l,e[7]=r):r=e[7];let o;e[8]===Symbol.for("react.memo_cache_sentinel")?(o=(0,t.jsx)(Ft,{size:18}),e[8]=o):o=e[8];let d;e[9]!==s.name||e[10]!==s.url?(d=(0,t.jsx)("a",{href:s.url,download:s.name,className:"p-2 text-zinc-400 transition-colors hover:text-violet-600",onClick:si,children:o}),e[9]=s.name,e[10]=s.url,e[11]=d):d=e[11];let p;return e[12]!==r||e[13]!==d?(p=(0,t.jsxs)("div",{className:"group mt-3 flex items-center gap-3 rounded-2xl border border-zinc-100 bg-zinc-50/50 p-3 transition-colors hover:border-violet-500/30 dark:border-zinc-800 dark:bg-zinc-900/10",children:[n,r,d]}),e[12]=r,e[13]=d,e[14]=p):p=e[14],p},ti=ei;function si(i){return i.stopPropagation()}var ft=q(),ii=y.lazy(()=>ct(()=>import("./VideoPlayer-BGJg6-E1.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),li=i=>{const e=(0,ft.c)(10),{item:s,onClick:n}=i,[a,l]=(0,y.useState)(!1);let r;e[0]!==a?(r=!a&&(0,t.jsx)("div",{className:"absolute inset-0 animate-pulse bg-zinc-200 dark:bg-zinc-800"}),e[0]=a,e[1]=r):r=e[1];const o=s.url||s.src,d=`size-full object-cover transition-all duration-500 hover:scale-[1.02] ${a?"opacity-100":"opacity-0"}`;let p;e[2]===Symbol.for("react.memo_cache_sentinel")?(p=()=>l(!0),e[2]=p):p=e[2];let g;e[3]!==o||e[4]!==d?(g=(0,t.jsx)("img",{src:o,className:d,alt:"",loading:"lazy",onLoad:p}),e[3]=o,e[4]=d,e[5]=g):g=e[5];let h;return e[6]!==n||e[7]!==r||e[8]!==g?(h=(0,t.jsxs)("div",{className:"relative size-full overflow-hidden",onClick:n,children:[r,g]}),e[6]=n,e[7]=r,e[8]=g,e[9]=h):h=e[9],h},ai=i=>{const e=(0,ft.c)(3),{items:s}=i,n=s===void 0?[]:s,{openLightbox:a}=os();if(!n||Array.isArray(n)&&n.length===0)return null;const l=Array.isArray(n)?n:[n],r=l.filter(ri),o=l.filter(oi),d=r.some(ci),p=u=>{const x=r.filter(di).map(mi),v=r[u];a(x,x.indexOf(v.url||v.src))},g="mt-2 space-y-2",h=r.length>0&&(0,t.jsx)("div",{className:`grid gap-2 overflow-hidden rounded-2xl border border-zinc-100 dark:border-zinc-800 ${r.length===1?"grid-cols-1":r.length===2?d?"aspect-[8/9] grid-cols-1 grid-rows-2":"aspect-[16/9] grid-cols-2":(r.length===3,"aspect-[16/9] grid-cols-2 grid-rows-2")}`,children:r.map((u,x)=>(0,t.jsx)("div",{className:`relative cursor-pointer overflow-hidden bg-zinc-100 dark:bg-zinc-900 ${r.length===3&&x===0?"row-span-2":""}`,children:u.type==="video"?(0,t.jsx)(y.Suspense,{fallback:(0,t.jsx)("div",{className:"flex aspect-video w-full items-center justify-center bg-zinc-100 dark:bg-zinc-900",children:(0,t.jsx)("div",{className:"size-8 animate-spin rounded-full border-2 border-violet-500 border-t-transparent"})}),children:(0,t.jsx)(ii,{src:u.url,poster:u.poster||void 0})}):(0,t.jsx)(li,{item:u,onClick:v=>{v.stopPropagation(),p(x)}})},x))}),f=o.map(xi);let b;return e[0]!==h||e[1]!==f?(b=(0,t.jsxs)("div",{className:g,children:[h,f]}),e[0]=h,e[1]=f,e[2]=b):b=e[2],b},ni=ai;function ri(i){return i.type==="image"||i.type==="video"}function oi(i){return i.type==="file"}function ci(i){return i.type==="video"}function di(i){return i.type==="image"}function mi(i){return i.url||i.src}function xi(i,e){return(0,t.jsx)(ti,{file:i},e)}var pt=q(),hi=i=>{const e=(0,pt.c)(6),{avatars:s}=i;if(!s||s.length===0)return null;let n,a;if(e[0]!==s){const r=s.slice(0,3);n="relative mt-2 h-7 w-7",a=r.map((o,d)=>{let p,g;return r.length===1?(p="top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",g="size-5"):r.length===2?(g="size-4",p=d===0?"top-0 right-0":"bottom-0 left-0"):(g=d===0?"size-3.5":"size-3",d===0?p="top-0 right-0":d===1?p="bottom-0 right-0":p="top-1/2 left-0 -translate-y-1/2"),(0,t.jsx)("div",{className:`absolute rounded-full border border-white bg-zinc-100 dark:border-black dark:bg-zinc-800 overflow-hidden shadow-sm ${p} ${g}`,style:{zIndex:10-d},children:(0,t.jsx)("img",{src:o,alt:"",className:"h-full w-full object-cover"})},d)}),e[0]=s,e[1]=n,e[2]=a}else n=e[1],a=e[2];let l;return e[3]!==n||e[4]!==a?(l=(0,t.jsx)("div",{className:n,children:a}),e[3]=n,e[4]=a,e[5]=l):l=e[5],l},rt=i=>{const e=(0,pt.c)(32),{id:s,user:n,isCurrentUser:a,isComment:l,onEdit:r,onDelete:o,addToast:d,trigger:p}=i;let g;e[0]!==p?(g=(0,t.jsx)(js,{asChild:!0,onClick:pi,children:p}),e[0]=p,e[1]=g):g=e[1];let h;e[2]!==d||e[3]!==s||e[4]!==l?(h=!l&&(0,t.jsxs)(le,{className:"cursor-pointer gap-2 py-2.5",onClick:j=>{j.stopPropagation(),navigator.clipboard.writeText(`${window.location.origin}/p/${s}`),d("Link copied")},children:[(0,t.jsx)(Lt,{size:16}),(0,t.jsx)("span",{children:"Copy link"})]}),e[2]=d,e[3]=s,e[4]=l,e[5]=h):h=e[5];let f;e[6]!==d||e[7]!==l?(f=!l&&(0,t.jsxs)(le,{className:"cursor-pointer gap-2 py-2.5",onClick:j=>{j.stopPropagation(),d("Post reported")},children:[(0,t.jsx)(Dt,{size:16}),(0,t.jsx)("span",{children:"Report post"})]}),e[6]=d,e[7]=l,e[8]=f):f=e[8];let b;e[9]!==d||e[10]!==a||e[11]!==n?(b=!a&&(0,t.jsxs)(le,{className:"cursor-pointer gap-2 py-2.5",onClick:j=>{j.stopPropagation(),d("User blocked")},children:[(0,t.jsx)(Mt,{size:16}),(0,t.jsxs)("span",{children:["Block @",n.handle]})]}),e[9]=d,e[10]=a,e[11]=n,e[12]=b):b=e[12];let u;e[13]!==l||e[14]!==a||e[15]!==r?(u=a&&(0,t.jsxs)(le,{onClick:j=>{j.stopPropagation(),r()},className:"cursor-pointer gap-2 py-2.5",children:[(0,t.jsx)(Jt,{size:16}),"Edit ",l?"Comment":"Post"]}),e[13]=l,e[14]=a,e[15]=r,e[16]=u):u=e[16];let x;e[17]!==h||e[18]!==f||e[19]!==b||e[20]!==u?(x=(0,t.jsxs)(Ve,{children:[h,f,b,u]}),e[17]=h,e[18]=f,e[19]=b,e[20]=u,e[21]=x):x=e[21];let v;e[22]!==l||e[23]!==a||e[24]!==o?(v=a&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(gs,{}),(0,t.jsx)(Ve,{children:(0,t.jsxs)(le,{variant:"destructive",className:"cursor-pointer gap-2 py-2.5",onClick:j=>{j.stopPropagation(),o()},children:[(0,t.jsx)(Kt,{size:16}),(0,t.jsxs)("span",{children:["Delete ",l?"comment":"post"]})]})})]}),e[22]=l,e[23]=a,e[24]=o,e[25]=v):v=e[25];let m;e[26]!==x||e[27]!==v?(m=(0,t.jsxs)(Zt,{align:"end",className:"w-48 rounded-xl border-zinc-100 bg-white dark:border-zinc-800 dark:bg-zinc-900",children:[x,v]}),e[26]=x,e[27]=v,e[28]=m):m=e[28];let w;return e[29]!==g||e[30]!==m?(w=(0,t.jsxs)(as,{children:[g,m]}),e[29]=g,e[30]=m,e[31]=w):w=e[31],w},ke=({id:i,user:e,timeAgo:s,content:n,contentClass:a,media:l,quotedPost:r,stats:o,onClick:d,repostedBy:p,onUserClick:g,currentUser:h,poll:f,isDetail:b,initialComments:u,onDelete:x,onUpdate:v,isComment:m,onReply:w,community:j,parent_id:k,post_id:z,commenterAvatars:c=[]})=>{const $=ne(),{addToast:S}=Ne(),{liked:T,reposted:F,localStats:N,setLocalStats:M,handleLike:R,handleRepost:E}=ws(i,o,h),{deletePost:D,updatePost:U}=Yt(),{comments:A,fetchNextPage:L,hasNextPage:W,isFetchingNextPage:_,addComment:C,isSubmitting:I}=Ze(i,u),[O,B]=(0,y.useState)(""),[Q,Ce]=(0,y.useState)([]),[vt,$e]=(0,y.useState)(!1),[_e,se]=(0,y.useState)(!1),[re,K]=(0,y.useState)(!1),[X,oe]=(0,y.useState)(n),[ce,de]=(0,y.useState)(l||[]),[me,ie]=(0,y.useState)([]),[Se,Fe]=(0,y.useState)(!1),[bt,pe]=(0,y.useState)(!1),[ge,xe]=(0,y.useState)(null),[ve,Pe]=(0,y.useState)(!1),{comments:jt,refetch:Te}=Ze(z||i,[],ve?i:void 0),{ref:Me,inView:Re}=$t({threshold:.5,triggerOnce:!0});(0,y.useEffect)(()=>{if(Re&&!m){const P=setTimeout(()=>{bs(i).catch(console.error)},1500);return()=>clearTimeout(P)}},[Re,i,m]);const zt=(0,y.useCallback)(async()=>{!i||!z&&!i||N.comments===0||(Pe(!0),Te())},[i,z,N.comments,Te]),Ie=async()=>{const P=JSON.stringify(ce)!==JSON.stringify(l||[])||me.length>0;if(!X.trim()||X===n&&!P){K(!1);return}Fe(!0);try{const V=[];for(const Z of me){const yt=await ze(Z);V.push(yt)}const H=[...ce,...V];m?await zs(i,{content:X,media:H}):await U(i,{content:X,media:H}),ie([]),K(!1),S(`${m?"Comment":"Post"} updated`),v&&v(i,X,H)}catch(V){console.error(`Failed to update ${m?"comment":"post"}:`,V),S(`Failed to update ${m?"comment":"post"}`)}finally{Fe(!1)}},Ee=async P=>{P&&P.stopPropagation();try{m?await ms(i):await D(i),S(`${m?"Comment":"Post"} deleted successfully`),x&&x(i)}catch(V){console.error(`Failed to delete ${m?"comment":"post"}:`,V),S(`Failed to delete ${m?"comment":"post"}`)}finally{se(!1)}},kt=async P=>{if(P.preventDefault(),!(!O.trim()&&Q.length===0||!h)){$e(!0);try{const V=[];for(const H of Q){const Z=await ze(H);V.push(Z)}await C({userId:h.id,content:O,media:V,replyToId:ge?.id}),B(""),Ce([]),xe(null),M(H=>({...H,comments:(H.comments||0)+1})),S("Reply posted!")}catch(V){console.error("Failed to post comment:",V),S("Failed to post reply.")}finally{$e(!1)}}},De=h?.handle===e.handle,Nt=(P,V)=>{xe(V?{handle:P,id:m?k||i:V}:null),B(H=>{const Z=`@${P} `;return H.includes(Z)?H:Z+H}),document.getElementById("comment-input")?.focus()};return b?(0,t.jsxs)("div",{className:"flex flex-col",ref:Me,children:[(0,t.jsxs)("article",{className:"p-5 dark:bg-black",children:[(0,t.jsx)(tt,{user:e,timeAgo:s,community:j,onUserClick:g,isDetail:!0,showAvatar:!0,actionsMenu:(0,t.jsx)(rt,{id:i,user:e,isCurrentUser:De,isComment:m,onEdit:()=>K(!0),onDelete:()=>se(!0),addToast:S,trigger:(0,t.jsx)("button",{"aria-label":"More options",className:"rounded-full p-2 text-zinc-500 transition-colors hover:bg-zinc-100 dark:hover:bg-zinc-800",children:(0,t.jsx)(be,{size:20})})})}),(0,t.jsx)(st,{content:n,isDetail:!0,isEditing:re,editedContent:X,setEditedContent:oe,onCancelEdit:()=>{K(!1),oe(n),de(l||[]),ie([])},onSaveEdit:Ie,isUpdating:Se,contentClass:a}),he(n)&&(0,t.jsx)(nt,{url:he(n)}),(0,t.jsx)(it,{media:l,isEditing:re,editedMedia:ce,setEditedMedia:de,newFiles:me,setNewFiles:ie}),f&&(0,t.jsx)(lt,{poll:f,onVote:P=>xs(i,P,h.id)}),r&&(0,t.jsx)("div",{className:"mt-4 overflow-hidden rounded-2xl border border-zinc-200 shadow-sm dark:border-zinc-700",children:(0,t.jsx)(at,{...r})}),(0,t.jsx)(et,{views:N.views||0,likes:N.likes||0,comments:N.comments||0,isDetail:!0}),(0,t.jsx)(Ye,{liked:T,reposted:F,handleLike:R,handleRepost:E,handleCommentClick:()=>document.getElementById("comment-input")?.focus(),handleShareClick:()=>pe(!0),isDetail:!0,isComment:m})]}),ge&&(0,t.jsxs)("div",{className:"flex items-center justify-between bg-zinc-50 px-5 py-2 dark:bg-zinc-900/50",children:[(0,t.jsxs)("span",{className:"text-sm text-zinc-500",children:["Replying to"," ",(0,t.jsxs)("span",{className:"font-bold text-violet-600",children:["@",ge.handle]})]}),(0,t.jsx)("button",{onClick:()=>xe(null),className:"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200",children:(0,t.jsx)(ae,{size:16})})]}),(0,t.jsx)(ut,{currentUser:h,newComment:O,setNewComment:B,handleSubmitComment:kt,loading:I,selectedFiles:Q,setSelectedFiles:Ce,isUploading:vt}),(0,t.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:[(0,t.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:(0,t.jsxs)(t.Fragment,{children:[W&&A.length>0&&(0,t.jsxs)("button",{onClick:()=>L(),disabled:_,className:"flex w-full items-center justify-center gap-2 py-3 text-sm font-bold text-violet-600 transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[_&&(0,t.jsx)("span",{className:"animate-spin",children:"⌛"}),"View more replies"]}),A.map(P=>(0,t.jsx)(ke,{...P,isComment:!0,post_id:i,onReply:Nt,onUserClick:g,currentUser:h,stats:{likes:P.stats?.likes||0,comments:P.stats?.comments||0,reposts:P.stats?.reposts||0},timeAgo:P.timeAgo||P.created_at},P.id))]})}),(0,t.jsx)(qe,{open:_e,onOpenChange:se,children:(0,t.jsxs)(Ge,{onClick:P=>P.stopPropagation(),children:[(0,t.jsxs)(Xe,{children:[(0,t.jsx)(Ke,{children:"Are you absolutely sure?"}),(0,t.jsx)(He,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,t.jsxs)(Ue,{children:[(0,t.jsx)(Je,{onClick:P=>P.stopPropagation(),children:"Cancel"}),(0,t.jsx)(Qe,{onClick:Ee,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]})]}):(0,t.jsxs)("article",{ref:Me,onClick:d,className:`px-4 transition-all ${m?"py-2 bg-transparent hover:bg-zinc-50/30 dark:hover:bg-zinc-800/20":"py-4 bg-white hover:bg-zinc-50/30 dark:bg-black dark:hover:bg-white/[0.02]"} ${d?"cursor-pointer":""}`,children:[p&&(0,t.jsxs)("div",{className:"mb-2 ml-1 flex items-center space-x-1.5 text-[13px] font-semibold text-zinc-600",children:[(0,t.jsx)(je,{size:14,className:"text-zinc-500"}),(0,t.jsxs)("span",{className:"flex cursor-pointer items-center text-zinc-700 hover:underline dark:text-zinc-300",onClick:P=>{P.stopPropagation(),g&&g(p.handle)},children:[p.handle," Reposted"]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-x-3",children:[(0,t.jsxs)("div",{className:"flex shrink-0 flex-col items-center self-stretch pt-0.5",children:[(0,t.jsx)("div",{className:"cursor-pointer",onClick:P=>{P.stopPropagation(),g&&g(e.handle)},children:(0,t.jsxs)(ee,{className:`${m?"size-8":"size-10"} border-0 shadow-sm`,children:[(0,t.jsx)(Y,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,t.jsx)(te,{className:"text-xs",children:e.handle[0]?.toUpperCase()})]})}),(!m&&N.comments>0||m&&!k&&N.comments>0)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"mt-2 w-0.5 flex-1 rounded-full bg-zinc-100 dark:bg-zinc-800"}),!m&&(0,t.jsx)(hi,{avatars:c.length>0?c:(A||[]).slice(0,3).map(P=>P.user.avatar)})]})]}),(0,t.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col",children:[(0,t.jsx)(tt,{user:e,timeAgo:s,community:j,onUserClick:g,isComment:m,actionsMenu:(0,t.jsx)(rt,{id:i,user:e,isCurrentUser:De,isComment:m,onEdit:()=>K(!0),onDelete:()=>se(!0),addToast:S,trigger:(0,t.jsx)("button",{"aria-label":"More options",className:"rounded-full p-2 text-zinc-500 transition-colors hover:bg-zinc-100 group-hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:group-hover:bg-zinc-800/50",children:(0,t.jsx)(be,{size:18})})})}),(0,t.jsx)(st,{content:n,isEditing:re,editedContent:X,setEditedContent:oe,onCancelEdit:()=>{K(!1),oe(n),de(l||[]),ie([])},onSaveEdit:Ie,isUpdating:Se,contentClass:a}),he(n)&&(0,t.jsx)(nt,{url:he(n)}),(0,t.jsx)(it,{media:l,isEditing:re,editedMedia:ce,setEditedMedia:de,newFiles:me,setNewFiles:ie}),f&&(0,t.jsx)(lt,{poll:f}),r&&(0,t.jsx)("div",{className:"mt-3 overflow-hidden rounded-2xl border border-zinc-200 shadow-sm transition-all hover:bg-zinc-50 dark:border-zinc-800 dark:hover:bg-zinc-900",onClick:P=>{P.stopPropagation(),$(`/p/${r.id}`)},children:(0,t.jsx)(at,{...r})}),(0,t.jsx)(Ye,{liked:T,reposted:F,handleLike:R,handleRepost:E,handleCommentClick:P=>{P?.stopPropagation(),w?w(e.handle,i):d&&d()},handleShareClick:P=>{P?.stopPropagation(),pe(!0)},isComment:m}),(0,t.jsx)(et,{views:N.views||0,likes:N.likes||0,comments:N.comments||0,isComment:m,onRepliesClick:()=>{ve?Pe(!1):zt()}}),ve&&(0,t.jsxs)("div",{className:"relative mt-2 space-y-0",children:[(0,t.jsx)("div",{className:"absolute left-[19px] top-0 bottom-4 w-0.5 bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsx)("div",{className:"flex flex-col",children:jt.map(P=>(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute left-[19px] top-5 h-0.5 w-4 bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsx)("div",{className:"pl-6",children:(0,t.jsx)(ke,{...P,isComment:!0,post_id:z||i,onReply:w,onUserClick:g,currentUser:h,stats:{likes:P.stats?.likes||0,comments:P.stats?.comments||0,reposts:P.stats?.reposts||0},timeAgo:P.timeAgo||P.created_at})})]},P.id))})]}),(0,t.jsx)(gt,{isOpen:bt,onClose:()=>pe(!1),url:`${window.location.origin}/p/${i}`,title:"Share Post"}),(0,t.jsx)(qe,{open:_e,onOpenChange:se,children:(0,t.jsxs)(Ge,{onClick:P=>P.stopPropagation(),children:[(0,t.jsxs)(Xe,{children:[(0,t.jsx)(Ke,{children:"Are you absolutely sure?"}),(0,t.jsx)(He,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,t.jsxs)(Ue,{children:[(0,t.jsx)(Je,{onClick:P=>P.stopPropagation(),children:"Cancel"}),(0,t.jsx)(Qe,{onClick:Ee,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]})]})]})};function ui(i,e){const s=!i.media&&!e.media||i.media?.length===e.media?.length&&i.media?.every((a,l)=>a.url===e.media?.[l].url),n=i.repostedBy?.handle===e.repostedBy?.handle;return i.id===e.id&&i.content===e.content&&i.timeAgo===e.timeAgo&&i.user.id===e.user.id&&i.user.avatar===e.user.avatar&&i.stats.likes===e.stats.likes&&i.stats.comments===e.stats.comments&&i.stats.reposts===e.stats.reposts&&i.currentUser?.id===e.currentUser?.id&&!!s&&!!n}var fi=y.memo(ke,ui);function pi(i){return i.stopPropagation()}var gi=({isOpen:i,onClose:e,url:s,title:n="Share"})=>{const[a,l]=(0,y.useState)(!1),[r,o]=(0,y.useState)(""),[d,p]=(0,y.useState)([]),[g,h]=(0,y.useState)(!1),[f,b]=(0,y.useState)(null),{addToast:u}=Ne(),{currentUser:x}=mt(),v=(0,y.useCallback)(async()=>{if(x){h(!0);try{p((await Oe(x.id)).map(c=>c.user).filter(c=>c!==null).slice(0,5))}catch(c){console.error("Failed to fetch conversations:",c)}finally{h(!1)}}},[x]);(0,y.useEffect)(()=>{i&&x?v():(o(""),p([]))},[i,x,v]);const m=(0,y.useCallback)(async()=>{if(x){h(!0);try{p((await Oe(x.id)).map(c=>c.user).filter(c=>c!==null&&(c.name?.toLowerCase().includes(r.toLowerCase())||c.handle.toLowerCase().includes(r.toLowerCase()))))}catch(c){console.error("Search failed:",c)}finally{h(!1)}}},[r,x]);(0,y.useEffect)(()=>{const c=setTimeout(()=>{r.trim()&&i?m():!r.trim()&&i&&v()},300);return()=>clearTimeout(c)},[r,i,m,v]);const w=async c=>{c&&c.stopPropagation();try{await navigator.clipboard.writeText(s),l(!0),u("Link copied to clipboard!","success"),setTimeout(()=>l(!1),2e3)}catch($){console.error("Failed to copy:",$),u("Failed to copy link","error")}},j=async c=>{if(x){b(c.id);try{await ss(await cs(x.id,c.id),x.id,s,"text"),u(`Sent to ${c.name||c.handle}!`,"success")}catch($){console.error("Failed to send message:",$),u("Failed to send message","error")}finally{b(null)}}},k=[{name:"X",icon:Et,color:"bg-black text-white",href:`https://twitter.com/intent/tweet?url=${encodeURIComponent(s)}`},{name:"Facebook",icon:Tt,color:"bg-[#1877F2] text-white",href:`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(s)}`},{name:"LinkedIn",icon:Bt,color:"bg-[#0A66C2] text-white",href:`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(s)}`},{name:"WhatsApp",icon:Gt,color:"bg-[#25D366] text-white",href:`https://wa.me/?text=${encodeURIComponent(s)}`},{name:"Email",icon:Ut,color:"bg-zinc-600 text-white",href:`mailto:?body=${encodeURIComponent(s)}`}],z=async()=>{if(navigator.share)try{await navigator.share({title:n,url:s})}catch(c){c.name!=="AbortError"&&console.error("Native share failed:",c)}else w()};return(0,t.jsx)(xt,{isOpen:i,onClose:e,title:n,className:"max-w-[420px] !p-0 overflow-hidden",children:(0,t.jsxs)("div",{className:"flex h-full flex-col bg-white dark:bg-zinc-900",children:[(0,t.jsx)("div",{className:"px-5 pb-2 pt-4",children:(0,t.jsxs)("div",{className:"group relative",children:[(0,t.jsx)(Ot,{className:"absolute left-3 top-1/2 size-4 -translate-y-1/2 text-zinc-400 transition-colors group-focus-within:text-violet-500"}),(0,t.jsx)("input",{type:"text",placeholder:"Search people...",value:r,onChange:c=>o(c.target.value),className:"w-full rounded-xl border-none bg-zinc-100 py-2.5 pl-10 pr-4 text-sm transition-all focus:ring-2 focus:ring-violet-500/20 outline-none dark:bg-zinc-800/50"})]})}),(0,t.jsx)("div",{className:"no-scrollbar flex min-h-[100px] items-center gap-4 overflow-x-auto px-5 py-4",children:g?(0,t.jsx)("div",{className:"flex flex-1 justify-center",children:(0,t.jsx)("span",{className:"animate-pulse font-bold text-zinc-400",children:"Loading..."})}):d.length>0?d.map(c=>(0,t.jsxs)("button",{onClick:()=>j(c),disabled:f!==null,className:"group flex shrink-0 flex-col items-center gap-1.5 disabled:opacity-50",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"size-14 overflow-hidden rounded-full border-2 border-white shadow-sm transition-transform group-hover:scale-105 bg-zinc-100 dark:bg-zinc-800 dark:border-zinc-900",children:(0,t.jsx)("img",{src:c.avatar||`https://i.pravatar.cc/150?u=${c.id}`,alt:c.handle,className:"size-full object-cover"})}),f===c.id&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center rounded-full bg-black/40",children:(0,t.jsx)("span",{className:"animate-pulse text-white font-bold",children:"..."})})]}),(0,t.jsx)("span",{className:"max-w-[60px] truncate text-[10px] font-medium text-zinc-500 dark:text-zinc-400",children:c.name?.split(" ")[0]||c.handle})]},c.id)):(0,t.jsx)("div",{className:"flex-1 py-2 text-center",children:(0,t.jsx)("span",{className:"text-xs text-zinc-400",children:"No people found"})})}),(0,t.jsx)("div",{className:"mx-5 h-px bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsxs)("div",{className:"grid grid-cols-5 gap-2 px-5 py-6",children:[k.map(c=>(0,t.jsxs)("a",{href:c.href,target:"_blank",rel:"noopener noreferrer",className:"group flex flex-col items-center gap-2",children:[(0,t.jsx)("div",{className:`size-12 ${c.color} flex items-center justify-center rounded-2xl shadow-md transition-all group-hover:-translate-y-1 group-hover:scale-110 group-hover:shadow-lg`,children:(0,t.jsx)(c.icon,{size:20,strokeWidth:2.5})}),(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-tighter text-zinc-500 dark:text-zinc-400",children:c.name})]},c.name)),(0,t.jsxs)("button",{onClick:z,className:"group flex flex-col items-center gap-2",children:[(0,t.jsx)("div",{className:"flex size-12 items-center justify-center rounded-2xl border border-zinc-200 bg-zinc-100 text-zinc-600 shadow-sm transition-all group-hover:-translate-y-1 group-hover:scale-110 dark:border-zinc-700 dark:bg-zinc-800 dark:text-zinc-300",children:(0,t.jsx)(be,{size:20,strokeWidth:2.5})}),(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-tighter text-zinc-500 dark:text-zinc-400",children:"More"})]})]}),(0,t.jsx)("div",{className:"px-5 pb-6",children:(0,t.jsxs)("div",{className:"group relative",children:[(0,t.jsx)("input",{type:"text",readOnly:!0,value:s,className:"w-full rounded-2xl border border-zinc-200 bg-zinc-50 py-3.5 pl-4 pr-14 text-sm font-medium transition-colors focus:outline-none group-hover:border-zinc-300 dark:border-zinc-800 dark:bg-zinc-950 dark:group-hover:border-zinc-700"}),(0,t.jsx)("button",{onClick:w,className:`absolute right-1.5 top-1/2 flex -translate-y-1/2 items-center gap-2 rounded-xl h-10 px-4 text-xs font-bold shadow-sm transition-all active:scale-95 ${a?"bg-emerald-500 text-white":"bg-zinc-900 text-white hover:opacity-90 dark:bg-white dark:text-zinc-900"}`,children:a?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Vt,{size:14,strokeWidth:3}),(0,t.jsx)("span",{children:"Copied"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(At,{size:14,strokeWidth:3}),(0,t.jsx)("span",{children:"Copy"})]})})]})}),(0,t.jsx)("div",{className:"px-5 pb-5",children:(0,t.jsxs)("button",{onClick:e,className:"group relative flex w-full items-center justify-center overflow-hidden rounded-2xl bg-zinc-900 py-4 font-bold text-white transition-all hover:shadow-xl hover:shadow-zinc-900/10 active:scale-[0.98] dark:bg-white dark:text-zinc-900 dark:hover:shadow-white/10",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-zinc-500 to-zinc-600 opacity-0 transition-opacity duration-300 group-hover:opacity-100"}),(0,t.jsx)("div",{className:"relative flex items-center gap-2",children:(0,t.jsx)("span",{children:"Close"})})]})})]})})},gt=gi,vi=y.lazy(()=>ct(()=>import("./dist-CXJwIUEX.js"),__vite__mapDeps([13,1,2,3,4,5,6,7])).then(i=>({default:i.Plyr}))),bi=y.memo(({reel:i,isActive:e,isMuted:s,shouldLoad:n=!0})=>{const a=ne(),{currentUser:l}=mt(),{addToast:r}=Ne(),o=(0,y.useRef)(null),[d,p]=(0,y.useState)(!1),[g,h]=(0,y.useState)(!1),[f,b]=(0,y.useState)(!1),[u,x]=(0,y.useState)(!1),[v,m]=(0,y.useState)(null),[w,j]=(0,y.useState)(!1),[k,z]=(0,y.useState)(i.stats?.likes||0),[c,$]=(0,y.useState)(!1),[S,T]=(0,y.useState)(0),F=(0,y.useRef)(null),N=(0,y.useMemo)(()=>Array.isArray(i.media)?i.media[0]?.src||i.media[0]?.url:i.media?.src||i.media?.url||i.url,[i.media,i.url]);(0,y.useEffect)(()=>{x(!1);const _=o.current?.plyr;if(_&&typeof _.on=="function"){const C=()=>x(!0);return _.on("ready",C),_.on("canplay",C),_.on("loadeddata",C),()=>{typeof _.off=="function"&&(_.off("ready",C),_.off("canplay",C),_.off("loadeddata",C))}}else{const C=setTimeout(()=>x(!0),1e3);return()=>clearTimeout(C)}},[N]),(0,y.useEffect)(()=>{let _;const C=o.current?.plyr;return C&&u&&(e?_=setTimeout(()=>{if(typeof C.play=="function"){const I=C.play();I!==void 0&&I.catch(()=>{C&&(C.muted=!0,C.play().catch(()=>{}))})}},100):typeof C.pause=="function"&&C.pause()),()=>{_&&clearTimeout(_)}},[e,u]),(0,y.useEffect)(()=>{if(!l?.id||!e)return;(async()=>{try{const[C,I]=await Promise.all([ds(i.id,l.id),ps(l.id,i.user?.id)]);j(C),$(I)}catch(C){console.error("Failed to check interaction status:",C)}})()},[i.id,l?.id,e,i.user?.id]),(0,y.useEffect)(()=>{o.current?.plyr&&(o.current.plyr.muted=s)},[s]),(0,y.useEffect)(()=>{const _=o.current?.plyr;if(!_||!e)return;const C=()=>{const I=_.currentTime,O=_.duration;O>0&&T(I/O*100)};if(typeof _.on=="function")return _.on("timeupdate",C),()=>{typeof _.off=="function"&&_.off("timeupdate",C)}},[e]);const M=_=>{_.stopPropagation();const C=_.currentTarget.getBoundingClientRect(),I=_.clientX-C.left,O=Math.min(Math.max(0,I/C.width),1),B=o.current?.plyr;B&&B.duration&&(B.currentTime=O*B.duration,T(O*100))};(0,y.useEffect)(()=>()=>{F.current&&clearTimeout(F.current)},[]);const R=_=>{const C=_.target;C.closest("button")||C.closest("a")||C.closest(".plyr__controls")||(F.current?(clearTimeout(F.current),F.current=null,D()):F.current=setTimeout(()=>{F.current=null,E()},250))},E=()=>{const _=o.current?.plyr;_&&(_.paused?(_.play().catch(()=>{}),m("play")):(_.pause(),m("pause")),setTimeout(()=>m(null),800))},D=async()=>{if(l&&(p(!0),setTimeout(()=>p(!1),1e3),!w)){j(!0),z(_=>_+1);try{await We(i.id,l.id)}catch{j(!1),z(_=>_-1)}}},U=async _=>{if(_.stopPropagation(),!l)return;const C=!w;j(C),z(I=>C?I+1:I-1);try{await We(i.id,l.id)}catch{j(!C),z(I=>C?I-1:I+1)}},A=async _=>{if(_.stopPropagation(),!l)return;const C=!c;$(C);try{await fs(l.id,i.user?.id)}catch{$(!C)}},L=_=>{_.stopPropagation(),b(!0)},W=(0,y.useMemo)(()=>({source:{type:"video",sources:[{src:N,type:"video/mp4"}]},options:{controls:[],loop:{active:!0},clickToPlay:!1,ratio:"9:16",autoplay:!0,muted:!0,playsinline:!0}}),[N]);return(0,t.jsxs)("div",{"data-id":i.id,className:"reel-item relative flex h-[100dvh] w-full snap-start items-center justify-center overflow-hidden bg-black cursor-pointer",onClick:R,children:[(0,t.jsxs)("div",{className:"relative flex h-full w-full max-w-[450px] items-center justify-center",children:[(0,t.jsx)("div",{className:"w-full",children:n?(0,t.jsx)(y.Suspense,{fallback:(0,t.jsx)("div",{className:"aspect-[9/16] w-full bg-zinc-900 animate-pulse"}),children:(0,t.jsx)(vi,{ref:o,...W})}):(0,t.jsx)("div",{className:"aspect-[9/16] w-full bg-zinc-900",children:(0,t.jsx)("img",{src:i.media?.[0]?.preview||i.media?.[0]?.thumbnail||N,className:"h-full w-full object-cover opacity-50 blur-xl",alt:"Reel preview"})})}),!u&&(0,t.jsx)("div",{className:"absolute inset-0 z-[60] flex items-center justify-center bg-zinc-900",children:(0,t.jsx)(is,{})}),d&&(0,t.jsx)("div",{className:"pointer-events-none absolute inset-0 z-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-in zoom-in-50 fade-out fill-mode-forwards duration-500",children:(0,t.jsx)(ue,{size:120,fill:"white",className:"scale-125 text-white drop-shadow-[0_0_30px_rgba(255,255,255,0.4)]"})})}),v&&(0,t.jsx)("div",{className:"pointer-events-none absolute inset-0 z-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-in fade-in zoom-in-90 scale-100 animate-out zoom-out-110 fade-out fill-mode-forwards duration-500",children:(0,t.jsx)("div",{className:"rounded-full border border-white/20 bg-white/10 p-8 shadow-2xl backdrop-blur-md",children:v==="play"?(0,t.jsx)(Ht,{size:50,fill:"white",className:"ml-1.5 text-white"}):(0,t.jsx)(Wt,{size:50,fill:"white",className:"text-white"})})})}),(0,t.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-black/60"}),(0,t.jsxs)("div",{className:"pointer-events-none absolute bottom-6 left-4 right-16 text-white",children:[(0,t.jsxs)("div",{className:"pointer-events-auto mb-3 flex items-center gap-2",children:[(0,t.jsxs)(_t,{to:`/u/${i.user?.handle}`,className:"flex items-center gap-2 transition-opacity hover:opacity-80",onClick:_=>_.stopPropagation(),children:[(0,t.jsxs)(ee,{className:"size-10 border-2 border-white",children:[(0,t.jsx)(Y,{src:i.user?.avatar,alt:i.user?.handle,className:"object-cover"}),(0,t.jsx)(te,{children:i.user?.handle?.[0]?.toUpperCase()})]}),(0,t.jsxs)("span",{className:"font-bold",children:["@",i.user?.handle]})]}),l?.id!==i.user?.id&&(0,t.jsx)("button",{className:`ml-2 flex items-center gap-1.5 rounded-full px-3 py-1.5 text-xs font-bold transition-all active:scale-95 ${c?"border border-white/50 bg-transparent text-white":"bg-white text-black hover:bg-zinc-200"}`,onClick:A,children:c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(vs,{size:14}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Following"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(hs,{size:14}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Follow"})]})})]}),(0,t.jsx)(ye,{options:{...we,render:({attributes:_,content:C})=>{const{href:I,...O}=_,B=!I.startsWith("/")&&(I.startsWith("http")||I.startsWith("www"));return I.startsWith("/u/")||I.startsWith("/tags/")||I.startsWith("/c/")||I.startsWith("/explore")?(0,t.jsx)("span",{...O,className:"cursor-pointer font-bold text-white hover:underline",onClick:Q=>{Q.stopPropagation(),a(I)},children:C},C):(0,t.jsx)("a",{href:I,...O,className:"text-white hover:underline",target:B?"_blank":void 0,rel:B?"noopener noreferrer":void 0,onClick:Q=>Q.stopPropagation(),children:C},C)}},children:(0,t.jsx)("p",{className:"mb-3 line-clamp-2 text-sm",children:i.content})}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs opacity-90",children:[(0,t.jsx)(qt,{size:14,className:"animate-spin-slow"}),(0,t.jsxs)("span",{children:["Original Audio - ",i.user?.handle]})]})]}),(0,t.jsxs)("div",{className:"absolute bottom-6 right-2 z-10 flex flex-col items-center gap-6",children:[(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)("button",{className:`rounded-full p-3 backdrop-blur-md transition-all active:scale-90 ${w?"bg-rose-500/20 text-rose-500":"bg-zinc-800/50 text-white hover:bg-zinc-700"}`,onClick:U,children:(0,t.jsx)(ue,{size:28,fill:w?"currentColor":"none"})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:k})]}),(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)("button",{className:"rounded-full bg-zinc-800/50 p-3 text-white backdrop-blur-md transition-colors hover:bg-zinc-700 active:scale-90",onClick:_=>{_.stopPropagation(),h(!0)},children:(0,t.jsx)(ht,{size:28})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:i.stats?.comments||0})]}),(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)("button",{className:"rounded-full bg-zinc-800/50 p-3 text-white backdrop-blur-md transition-colors hover:bg-zinc-700 active:scale-90",onClick:L,children:(0,t.jsx)(fe,{size:28})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:i.stats?.shares||0})]})]}),(0,t.jsx)("div",{className:"absolute bottom-0 left-0 z-50 h-[3px] w-full bg-white/20 hover:h-[8px] transition-all cursor-pointer group",onClick:M,children:(0,t.jsx)("div",{className:"h-full bg-white shadow-[0_0_8px_rgba(255,255,255,0.8)] transition-all duration-100 ease-linear relative",style:{width:`${S}%`},children:(0,t.jsx)("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 size-3 bg-white rounded-full shadow-lg scale-0 group-hover:scale-100 transition-transform"})})})]}),(0,t.jsx)(zi,{isOpen:g,onClose:()=>h(!1),reelId:i.id,currentUser:l,showToast:r}),(0,t.jsx)(gt,{isOpen:f,onClose:()=>b(!1),url:`${window.location.origin}/r/${i.id}`,title:"Share Reel"})]})},(i,e)=>i.isActive===e.isActive&&i.reel.id===e.reel.id&&i.isMuted===e.isMuted),Pi=bi,ji=({isOpen:i,onClose:e,reelId:s,currentUser:n,showToast:a})=>{const[l,r]=(0,y.useState)([]),[o,d]=(0,y.useState)(!1),[p,g]=(0,y.useState)(!1),[h,f]=(0,y.useState)(""),[b,u]=(0,y.useState)([]),[x,v]=(0,y.useState)(!1),[m,w]=(0,y.useState)(!0),[j,k]=(0,y.useState)(!1),[z,c]=(0,y.useState)(null),$=(0,y.useRef)(l);(0,y.useEffect)(()=>{$.current=l},[l]);const S=(0,y.useCallback)(async(F=!1)=>{if(s){F?k(!0):d(!0);try{const N=$.current,M=await ns(s,F&&N.length>0?N[N.length-1].created_at:null,10);M.length<10?w(!1):w(!0),r(F?R=>[...R,...M]:M)}catch(N){console.error("Failed to load comments:",N),a&&a("Failed to load comments","error")}finally{d(!1),k(!1)}}},[s,a]);(0,y.useEffect)(()=>{i&&s?S():(r([]),w(!0))},[i,s,S]);const T=async F=>{if(F.preventDefault(),!(!h.trim()&&b.length===0||!n)){g(!0),v(!0);try{const N=[];for(const M of b){const R=await ze(M);N.push(R)}await ts(s,n.id,h,N,z?.id),f(""),u([]),c(null),a&&a("Reply posted!"),S()}catch(N){console.error("Failed to post comment:",N),a&&a("Failed to post reply.","error")}finally{g(!1),v(!1)}}};return(0,t.jsx)(xt,{isOpen:i,onClose:e,title:"Comments",className:"max-sm:h-[95dvh] h-[85vh] overflow-hidden !p-0 sm:max-w-xl",children:(0,t.jsxs)("div",{className:"flex h-full flex-col overflow-hidden bg-white dark:bg-zinc-900",children:[(0,t.jsx)("div",{className:"mx-auto my-3 h-1.5 w-12 shrink-0 rounded-full bg-zinc-200 dark:bg-zinc-800 sm:hidden"}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto scroll-smooth scrollbar-thin scrollbar-thumb-zinc-200 dark:scrollbar-thumb-zinc-800",children:o?(0,t.jsx)("div",{className:"flex flex-col",children:[1,2,3].map(F=>(0,t.jsx)(es,{},F))}):l.length>0?(0,t.jsxs)("div",{className:"flex flex-col",children:[l.map(F=>(0,t.jsx)(fi,{...F,isComment:!0,post_id:s,currentUser:n,showToast:a,onReply:(N,M)=>{c(M?{handle:N,id:M}:null),f(R=>R.includes(`@${N}`)?R:R+`@${N} `)},onDelete:N=>r(M=>M.filter(R=>R.id!==N)),onUpdate:(N,M,R)=>r(E=>E.map(D=>D.id===N?{...D,content:M,media:R}:D))},F.id)),m&&(0,t.jsxs)("button",{onClick:()=>S(!0),disabled:j,className:"flex w-full items-center justify-center gap-2 py-6 text-sm font-bold text-violet-600 transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[j&&(0,t.jsx)("span",{className:"mr-2 animate-pulse",children:"..."}),"View more replies"]})]}):(0,t.jsxs)("div",{className:"flex h-full min-h-[300px] flex-col items-center justify-center p-8 text-center text-zinc-500",children:[(0,t.jsx)("div",{className:"mb-4 flex size-16 items-center justify-center rounded-full bg-zinc-100 dark:bg-zinc-900",children:(0,t.jsx)(dt,{size:32,className:"text-zinc-400"})}),(0,t.jsx)("p",{className:"text-lg font-bold dark:text-zinc-300",children:"No comments yet"}),(0,t.jsx)("p",{className:"text-sm dark:text-zinc-500",children:"Be the first to share what you think!"})]})}),(0,t.jsxs)("div",{className:"shrink-0 border-t border-zinc-100 bg-white pb-safe dark:border-zinc-800 dark:bg-zinc-900",children:[z&&(0,t.jsxs)("div",{className:"flex items-center justify-between border-b border-zinc-50 bg-zinc-50/50 px-4 py-2 dark:border-zinc-800/50 dark:bg-zinc-900/50",children:[(0,t.jsxs)("span",{className:"text-xs text-zinc-500",children:["Replying to"," ",(0,t.jsxs)("span",{className:"font-bold text-violet-600",children:["@",z.handle]})]}),(0,t.jsx)("button",{onClick:()=>c(null),className:"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200",children:(0,t.jsx)(ae,{size:14})})]}),(0,t.jsx)(ut,{currentUser:n,newComment:h,setNewComment:f,handleSubmitComment:T,loading:p,selectedFiles:b,setSelectedFiles:u,isUploading:x})]})]})})},zi=ji,Ti=q();export{fi as n,Pi as t};
