import{n as fs}from"./rolldown-runtime-2JzG8er9.js";import{$ as Pa,$t as Ma,A as Fa,An as Ct,At as Ra,B as La,Bt as xs,C as hs,Cn as Ia,Ct as ps,D as Ea,Dn as St,Dt as bs,E as Ta,En as qa,Et as Ft,F as Da,Fn as wt,Ft as gs,G as Aa,Gt as Oa,H as Wa,Ht as Ba,I as Ua,In as Va,It as Ha,J as Ja,Jt as yt,K as Qa,Kt as Rt,L as Ka,Lt as Xa,M as Ya,Mn as vs,Mt as Ga,N as Za,Nn as $e,Nt as ei,O as ti,On as tt,Ot as js,P as si,Pn as ai,Pt as ii,Q as ni,Qt as ws,R as Je,Rt as $t,S as ys,Sn as ri,St as li,T as oi,Tn as zt,Tt as ci,U as di,Ut as mi,V as ui,Vt as zs,W as fi,Wt as Ns,X as xi,Xt as hi,Y as pi,Yt as bi,Z as gi,Zt as me,_ as ks,_n as vi,_t as ji,an as gt,ar as Kt,at as wi,b as _s,bn as Cs,bt as Ye,c as yi,cn as zi,cr as Ni,ct as ki,d as Ss,dn as Lt,dr as Nt,dt as _i,en as It,et as Ci,f as vd,fn as Si,fr as $i,ft as Pi,g as Mi,gn as $s,gt as Fi,h as Ri,hn as Ps,ht as Li,in as Xt,ir as Ms,it as Ii,j as Ei,jn as K,jt as Fs,k as Ti,kn as qi,kt as Rs,l as Di,ln as Ls,lr as ot,lt as Ai,m as Is,mn as Oi,mt as Wi,n as ct,nn as Dt,nr as Bi,nt as Ui,o as Es,on as Vi,or as Hi,ot as Ji,p as Qi,pn as Ts,pr as Ki,pt as Xi,q as Yi,qt as qs,rn as rt,rr as At,rt as Gi,s as Zi,sn as vt,sr as je,st as en,t as tn,tn as Ds,tt as sn,u as an,un as nn,ur as ge,ut as rn,v as ln,vn as Qe,vt as As,w as on,wn as Yt,wt as cn,x as Os,xn as Ws,xt as Et,y as dn,yn as Bs,yt as _e,z as mn,zt as De}from"./framework-N7fRNyEO.js";import{t as un}from"./query-Jg2nHO9u.js";import{t as fn}from"./database-DCcU4ujN.js";import{n as xn,r as hn,t as pn}from"./vendor-B0AhkwK8.js";/* empty css                 */(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function a(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=a(n);fetch(n.href,r)}})();var bn=$i(),g=fs(Ki(),1),gn="https://dbkcedktqhueqnulnosq.supabase.co",vn="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRia2NlZGt0cWh1ZXFudWxub3NxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg5NzE1NTQsImV4cCI6MjA4NDU0NzU1NH0.m_Tv-H7o5mL1Nac6TH-S1JkS1x7ZN1AK_4Mt1hZlkvU";const A=fn(gn,vn),Ue=t=>t?{id:t.id,handle:t.username,name:t.display_name,avatar:t.avatar_url||"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm",cover:t.cover_url||"https://systemadminbd.com/uploads/675346dd55e0c7.43939630.png",verified:t.is_verified,bio:t.bio,location:t.location,website:t.website,follower_count:t.follower_count||0,following_count:t.following_count||0,lastSeen:t.last_seen_at}:null,st=t=>{if(!t)return null;const e=t.reposter_id||t.reposter_data?.id||t.reposted_by?.id,a=t.feed_id||(e?`${t.id}-${e}`:`${t.id}-orig`);return{...t,feed_id:a,stats:{comments:t.comments_count||0,likes:t.likes_count||0,mirrors:t.mirrors_count||0},user:Ue(t.author_data||t.user),community:t.community_data||t.communities?{...t.community_data||t.communities,avatar:(t.community_data||t.communities).avatar_url||(t.community_data||t.communities).avatar}:null,repostedBy:t.reposter_data?{handle:t.reposter_data.username,name:t.reposter_data.display_name,id:t.reposter_data.id}:t.reposted_by?{handle:t.reposted_by.username,name:t.reposted_by.display_name,id:t.reposted_by.id}:null,timeAgo:new Date(t.created_at).toLocaleDateString()}},Us=t=>t?{...t,stats:{likes:t.likes_count||0},user:Ue(t.user),timeAgo:new Date(t.created_at).toLocaleDateString()}:null,jn=t=>t?{...t,user:t.actor?.username,avatar:t.actor?.avatar_url||"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm"}:null,Vs=t=>t?{...t,media:t.media_url,user:Ue(t.user)}:null,wn=async(t,e=10)=>{const{data:a,error:i}=await A.from("users").select("*").or(`username.ilike.%${t}%,display_name.ilike.%${t}%`).limit(e);if(i)throw i;return a.map(Ue)},Hs=async(t,e="id")=>{const{data:a,error:i}=await A.from("users").select("*").eq(e==="id"?"id":"username",t).maybeSingle();if(i)throw i;return a?Ue(a):null},yn=t=>Hs(t,"username"),Ke=async t=>{if(!t)return;const{error:e}=await A.from("users").update({last_seen_at:new Date().toISOString()}).eq("id",t);e&&console.error("Error updating last seen:",e)},zn=async(t,e)=>{const a={display_name:e.name,username:e.handle,avatar_url:e.avatar,bio:e.bio,cover_url:e.cover,website:e.website,location:e.location};Object.keys(a).forEach(n=>a[n]===void 0&&delete a[n]);const{error:i}=await A.from("users").update(a).eq("id",t);if(i)throw i},Nn=async(t,e)=>{const{data:a}=await A.from("follows").select("*").eq("follower_id",t).eq("following_id",e).maybeSingle();return a?(await A.from("follows").delete().eq("follower_id",t).eq("following_id",e),!1):(await A.from("follows").insert([{follower_id:t,following_id:e}]),!0)},kn=async(t,e)=>{if(!t)return!1;const{data:a}=await A.from("follows").select("*").eq("follower_id",t).eq("following_id",e).maybeSingle();return!!a},_n=async(t,e=null,a=10)=>{let i=A.from("follows").select(`
      created_at,
      user:users!follower_id (
        id,
        username,
        display_name,
        avatar_url,
        is_verified,
        bio
      )
    `).eq("following_id",t).order("created_at",{ascending:!1}).limit(a);e&&(i=i.lt("created_at",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(l=>({...Ue(l.user),followed_at:l.created_at}))},Cn=async(t,e=null,a=10)=>{let i=A.from("follows").select(`
      created_at,
      user:users!following_id (
        id,
        username,
        display_name,
        avatar_url,
        is_verified,
        bio
      )
    `).eq("follower_id",t).order("created_at",{ascending:!1}).limit(a);e&&(i=i.lt("created_at",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(l=>({...Ue(l.user),followed_at:l.created_at}))},Sn=async t=>{const{data:e,error:a}=await A.from("users").select("follower_count, following_count").eq("id",t).maybeSingle();return a||!e?{followers:0,following:0}:{followers:e.follower_count||0,following:e.following_count||0}},$n=async(t=null,e=10)=>{let a=A.from("unified_posts").select("*").order("sort_timestamp",{ascending:!1}).limit(e);t&&(a=a.lt("sort_timestamp",t));const{data:i,error:n}=await a;if(n)throw n;return i.map(st)},Pn=async t=>{const{data:e,error:a}=await A.from("posts").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified,
                bio,
                location,
                website,
                follower_count,
                following_count
            ),
            communities (
                id,
                handle,
                name,
                avatar_url
            ),
            quoted_post:posts!quoted_post_id (
                *,
                user:users!user_id (
                    id,
                    username,
                    display_name,
                    avatar_url,
                    is_verified
                )
            )
        `).eq("id",t).single();if(a)throw a;return st(e)},Mn=async(t,e=null,a=10)=>{let i=A.from("unified_posts").select("*").or(`user_id.eq.${t},reposter_id.eq.${t}`).order("sort_timestamp",{ascending:!1}).limit(a);e&&(i=i.lt("sort_timestamp",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(st)},Fn=async({content:t,media:e=[],type:a="text",userId:i,poll:n=null,parentId:r=null,communityId:l=null})=>{const{data:o,error:c}=await A.from("posts").insert([{user_id:i,content:t,media:e,type:a,poll:n,parent_id:r,community_id:l}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            ),
            communities:community_id (
                id,
                handle,
                name,
                avatar_url
            )
        `);if(c)throw c;return st(o[0])},Rn=async t=>{const{error:e}=await A.from("posts").delete().eq("id",t);if(e)throw e},Ln=async(t,e)=>{const{error:a}=await A.from("posts").update(e).eq("id",t);if(a)throw a},In=async(t,e=null,a=10)=>{let i=A.from("comments").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `).eq("post_id",t).order("created_at",{ascending:!0}).limit(a);e&&(i=i.gt("created_at",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(Us)},En=async(t,e,a,i=[])=>{const{data:n,error:r}=await A.from("comments").insert([{post_id:t,user_id:e,content:a,media:i}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `);if(r)throw r;return Us(n[0])},Tn=async(t,e)=>{const{data:a}=await A.from("likes").select("*").eq("post_id",t).eq("user_id",e).maybeSingle();return a?(await A.from("likes").delete().eq("post_id",t).eq("user_id",e),!1):(await A.from("likes").insert([{post_id:t,user_id:e}]),!0)},qn=async(t,e)=>{if(!e)return!1;const{data:a}=await A.from("likes").select("*").eq("post_id",t).eq("user_id",e).maybeSingle();return!!a},Dn=async(t,e)=>{const{data:a}=await A.from("reposts").select("*").eq("post_id",t).eq("user_id",e).maybeSingle();return a?(await A.from("reposts").delete().eq("post_id",t).eq("user_id",e),!1):(await A.from("reposts").insert([{post_id:t,user_id:e}]),!0)},An=async(t,e)=>{if(!e)return!1;const{data:a}=await A.from("reposts").select("*").eq("post_id",t).eq("user_id",e).maybeSingle();return!!a},On=async(t,e=null,a=10)=>{let i=A.from("unified_posts").select("*").ilike("content",`%${t}%`).order("sort_timestamp",{ascending:!1}).limit(a);e&&(i=i.lt("sort_timestamp",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(st)},Js=async(t,e)=>{const{data:a}=await A.from("conversation_participants").select("conversation_id").eq("user_id",t),i=a.map(o=>o.conversation_id),{data:n}=await A.from("conversation_participants").select("conversation_id").eq("user_id",e).in("conversation_id",i).maybeSingle();if(n)return n.conversation_id;const{data:r,error:l}=await A.from("conversations").insert([{}]).select().single();if(l)throw l;return await A.from("conversation_participants").insert([{conversation_id:r.id,user_id:t},{conversation_id:r.id,user_id:e}]),r.id},Wn=async t=>{if(!t)return 0;const{data:e}=await A.from("conversation_participants").select("conversation_id").eq("user_id",t),a=e?.map(r=>r.conversation_id)||[];if(a.length===0)return 0;const{count:i,error:n}=await A.from("messages").select("*",{count:"exact",head:!0}).eq("is_read",!1).neq("sender_id",t).in("conversation_id",a);if(n)throw n;return i||0},Bn=async(t,e)=>{if(!t||!e)return;const{error:a}=await A.from("messages").update({is_read:!0}).eq("conversation_id",t).neq("sender_id",e).eq("is_read",!1);if(a)throw a},Un=async t=>{if(!t)return[];const{data:e,error:a}=await A.from("conversation_participants").select(`
            conversation:conversations (
                id,
                last_message_at,
                last_message_content,
                participants:conversation_participants (
                    user:users (
                        id,
                        username,
                        display_name,
                        avatar_url
                    )
                ),
                messages (
                    id,
                    is_read,
                    sender_id
                )
            )
        `).eq("user_id",t);if(a)throw a;return e.map(i=>{const n=i.conversation,r=n.participants.find(o=>o.user?.id!==t)||n.participants[0],l=n.messages?.filter(o=>!o.is_read&&o.sender_id!==t).length||0;return{id:n.id,user:Ue(r?.user),lastMessage:n.last_message_content||"No messages yet",lastMessageAt:n.last_message_at,time:n.last_message_at?new Date(n.last_message_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",unread:l}}).sort((i,n)=>i.lastMessageAt?n.lastMessageAt?new Date(n.lastMessageAt)-new Date(i.lastMessageAt):-1:1)},Vn=async t=>{const{data:e,error:a}=await A.from("messages").select("*").eq("conversation_id",t).order("created_at",{ascending:!0});if(a)throw a;return e},Hn=async()=>{const{data:t,error:e}=await A.from("message_reactions").select("*");if(e)throw e;return t||[]},Jn=async(t,e,a)=>{const{data:i}=await A.from("message_reactions").select("*").eq("message_id",t).eq("user_id",e).maybeSingle();return i?i.emoji===a?(await A.from("message_reactions").delete().eq("id",i.id),{action:"removed",emoji:a}):(await A.from("message_reactions").update({emoji:a}).eq("id",i.id),{action:"updated",emoji:a}):(await A.from("message_reactions").insert([{message_id:t,user_id:e,emoji:a}]),{action:"added",emoji:a})},Qn=async(t,e,a,i="text",n=[],r=null)=>{const{data:l,error:o}=await A.from("messages").insert([{conversation_id:t,sender_id:e,content:a,type:i,media:n,reply_to_id:r}]).select();if(o)throw o;return await A.from("conversations").update({last_message_at:new Date,last_message_content:i==="image"||n&&n.length>0?"Sent an image":a}).eq("id",t),l[0]},Kn=async t=>{const{error:e}=await A.from("messages").delete().eq("id",t);if(e)throw e},Xn=async(t,e=null,a=10)=>{if(!t)return[];let i=A.from("notifications").select(`
            *,
            actor:users!actor_id (
                username,
                avatar_url
            )
        `).eq("recipient_id",t).order("created_at",{ascending:!1}).limit(a);e&&(i=i.lt("created_at",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(jn)},Yn=async t=>{const{error:e}=await A.from("notifications").update({is_read:!0}).eq("recipient_id",t).eq("is_read",!1);if(e)throw e},Gn=async t=>{if(!t)return 0;const{count:e,error:a}=await A.from("notifications").select("*",{count:"exact",head:!0}).eq("recipient_id",t).eq("is_read",!1);if(a)throw a;return e||0},Zn=async()=>{const{data:t,error:e}=await A.from("stories").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `).gt("expires_at",new Date().toISOString()).order("created_at",{ascending:!1});if(e)throw e;return t.map(Vs)},er=async(t,e,a="image")=>{const{data:i,error:n}=await A.from("stories").insert([{user_id:t,media_url:e,type:a}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `);if(n)throw n;return Vs(i[0])},dt=t=>t?{id:t.id,handle:t.handle,name:t.name,description:t.description,avatar:t.avatar_url||"https://api.dicebear.com/7.x/identicon/svg?seed=community",cover:t.cover_url||"https://systemadminbd.com/uploads/675346dd55e0c7.43939630.png",membersCount:t.members_count||0,postsCount:t.posts_count||0,isPrivate:t.is_private,createdAt:t.created_at,type:"community",creatorId:t.creator_id}:null,tr=async(t=null,e=10)=>{let a=A.from("communities").select("*").order("created_at",{ascending:!1}).limit(e);t&&(a=a.lt("created_at",t));const{data:i,error:n}=await a;if(n)throw n;return i.map(dt)},sr=async t=>{const{data:e,error:a}=await A.from("communities").select("*").eq("handle",t).single();if(a)throw a;return dt(e)},ar=async(t,e=null,a=10)=>{let i=A.from("unified_posts").select("*").eq("community_id",t).is("reposter_id",null).order("sort_timestamp",{ascending:!1}).limit(a);e&&(i=i.lt("sort_timestamp",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(st)},Qs=async(t,e)=>{const{data:a}=await A.from("community_members").select("*").eq("community_id",t).eq("user_id",e).maybeSingle();if(a){const{error:i}=await A.from("community_members").delete().eq("community_id",t).eq("user_id",e);if(i)throw i;return!1}else{const{error:i}=await A.from("community_members").insert([{community_id:t,user_id:e}]);if(i)throw i;return!0}},Ks=async(t,e)=>{if(!e)return null;const{data:a}=await A.from("community_members").select("*").eq("community_id",t).eq("user_id",e).maybeSingle();return a},ir=async t=>{if(!t)return[];const{data:e,error:a}=await A.from("community_members").select(`
      role,
      communities (*)
    `).eq("user_id",t);if(a)throw a;return e.map(i=>({...dt(i.communities),myRole:i.role}))},nr=async t=>{const{data:e,error:a}=await A.from("communities").insert([t]).select().single();if(a)throw a;return dt(e)},rr=async(t,e)=>{const{data:a,error:i}=await A.from("communities").update(e).eq("id",t).select().single();if(i)throw i;return dt(a)},lr=async(t,e="")=>{let a=A.from("community_members").select(`
      role,
      user_id,
      users:user_id!inner (
        id,
        username,
        display_name,
        avatar_url,
        is_verified
      )
    `).eq("community_id",t);e&&(a=a.or(`username.ilike.%${e}%,display_name.ilike.%${e}%`,{foreignTable:"users"}));const{data:i,error:n}=await a.limit(20);if(n)throw n;return i.map(r=>({role:r.role,userId:r.user_id,user:r.users}))},or=async(t,e,a)=>{const{data:i,error:n}=await A.from("community_members").update({role:a}).eq("community_id",t).eq("user_id",e).select().single();if(n)throw n;return i},cr=async(t=5)=>{const{data:e,error:a}=await A.from("hashtags").select("*").order("usage_count",{ascending:!1}).limit(t);if(a)throw a;return e},dr=async t=>{try{const e=`https://api.allorigins.win/raw?url=${encodeURIComponent(t)}`,a=await fetch(e);if(!a.ok)throw new Error("Failed to fetch preview");const i=await a.text(),n=new DOMParser().parseFromString(i,"text/html"),r=l=>n.querySelector(`meta[property="${l}"]`)?.getAttribute("content")||n.querySelector(`meta[name="${l}"]`)?.getAttribute("content");return{title:r("og:title")||n.title||t,description:r("og:description")||r("description")||"",image:r("og:image")||r("twitter:image")||"",siteName:r("og:site_name")||new URL(t).hostname,url:t}}catch(e){return console.error("Link preview error:",e),null}},mr=async t=>{if(!t)return null;try{const{data:e}=await A.from("link_previews").select("*").eq("url",t).maybeSingle();if(e)return A.from("link_previews").update({last_used_at:new Date().toISOString()}).eq("url",t).then(()=>{}),{title:e.title,description:e.description,image:e.image,siteName:e.site_name,url:e.url};const a=await dr(t);return a?(A.from("link_previews").insert([{url:a.url,title:a.title,description:a.description,image:a.image,site_name:a.siteName}]).then(({error:i})=>{i&&console.error("Cache save error:",i)}),a):null}catch(e){return console.error("Link preview cache error:",e),null}},ur=async(t,e={})=>{if(!t.type.startsWith("image/"))return t;const a={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0,initialQuality:.8,fileType:"image/webp",...e};try{const i=await hn(t,a);return console.log(`Original size: ${(t.size/1024/1024).toFixed(2)} MB`),console.log(`Compressed size: ${(i.size/1024/1024).toFixed(2)} MB`),i}catch(i){return console.error("Image compression failed:",i),t}},fr=(t,e=1)=>new Promise((a,i)=>{const n=document.createElement("video");n.preload="metadata",n.src=URL.createObjectURL(t),n.muted=!0,n.playsInline=!0,n.onloadedmetadata=()=>{n.currentTime=e},n.onseeked=()=>{const r=document.createElement("canvas");r.width=n.videoWidth,r.height=n.videoHeight,r.getContext("2d").drawImage(n,0,0,r.width,r.height),r.toBlob(l=>{const o=new File([l],"thumbnail.webp",{type:"image/webp"});URL.revokeObjectURL(n.src),a(o)},"image/webp",.7)},n.onerror=r=>i(r)}),Pe=async(t,e="media",a=null)=>{let i=t,n=t.name.split(".").pop(),r=null;if(t.type.startsWith("image/")&&(i=await ur(t),n="webp"),t.type.startsWith("video/"))try{a?r=(await Pe(a,e)).url:r=(await Pe(await fr(t),e)).url}catch(d){console.error("Failed to handle video poster:",d)}const l=`${`${crypto.randomUUID()}.${n}`}`,{data:o,error:c}=await A.storage.from(e).upload(l,i);if(c)throw c;const{data:{publicUrl:u}}=A.storage.from(e).getPublicUrl(o.path);return{url:u,poster:r,name:t.name,type:t.type.startsWith("image/")?"image":t.type.startsWith("video/")?"video":"file",size:i.size}};var s=fs(Va(),1),Xs=(0,g.createContext)();const xr=({children:t})=>{const[e,a]=(0,g.useState)(null),[i,n]=(0,g.useState)(null),[r,l]=(0,g.useState)({}),[o,c]=(0,g.useState)(!0),u=async x=>{try{const b=await Hs(x.id);b?(a(b),l(v=>({...v,[b.handle]:b}))):a({id:x.id,email:x.email,name:x.email.split("@")[0],handle:x.email.split("@")[0],avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm",verified:!1})}catch(b){console.error("Error fetching user profile:",b)}finally{c(!1)}};(0,g.useEffect)(()=>{if(!e?.id)return;Ke(e.id);const x=setInterval(()=>Ke(e.id),3e4),b=()=>{document.visibilityState==="visible"&&Ke(e.id)};return window.addEventListener("visibilitychange",b),window.addEventListener("beforeunload",()=>Ke(e.id)),()=>{clearInterval(x),window.removeEventListener("visibilitychange",b),window.removeEventListener("beforeunload",()=>Ke(e.id))}},[e?.id]),(0,g.useEffect)(()=>{A.auth.getSession().then(({data:{session:b}})=>{b?u(b.user):c(!1)});const{data:{subscription:x}}=A.auth.onAuthStateChange((b,v)=>{v?u(v.user):(a(null),c(!1))});return()=>x.unsubscribe()},[]);const d=async({email:x,password:b})=>{const{data:v,error:j}=await A.auth.signInWithPassword({email:x,password:b});if(j)throw j;return n(null),v},m=async({email:x,password:b,username:v,name:j})=>{const{data:{user:w},error:y}=await A.auth.signUp({email:x,password:b,options:{data:{username:v.toLowerCase(),name:j}}});if(y)throw y;return n(null),w},f=async()=>{await A.auth.signOut(),a(null),n(null)},h=async x=>{e&&(await zn(e.id,x),await u(e))},p=async x=>{if(r[x])return r[x];const b=await yn(x);return b?(l(v=>({...v,[x]:b})),b):null};return(0,s.jsx)(Xs.Provider,{value:{currentUser:e,authMode:i,setAuthMode:n,profiles:r,login:d,signup:m,logout:f,updateProfile:h,getProfileByHandle:p,loading:o},children:!o&&t})},be=()=>{const t=(0,g.useContext)(Xs);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t};var hr=K(),Ys=(0,g.createContext)();const pr=t=>{const e=(0,hr.c)(10),{children:a}=t,{currentUser:i}=be();let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=new Set,e[0]=n):n=e[0];const[r,l]=(0,g.useState)(n);let o;e[1]!==i?(o=()=>{if(!i?.id)return;const f=A.channel("global_presence",{config:{presence:{key:i.id}}});return f.on("presence",{event:"sync"},()=>{const h=f.presenceState(),p=new Set;Object.keys(h).forEach(x=>p.add(x)),l(p)}).subscribe(async h=>{h==="SUBSCRIBED"&&(await f.track({userId:i.id,online_at:new Date().toISOString()}),Ke(i.id))}),()=>{i?.id&&Ke(i.id),A.removeChannel(f),l(new Set)}},e[1]=i,e[2]=o):o=e[2];const c=i?.id;let u;e[3]!==c?(u=[c],e[3]=c,e[4]=u):u=e[4],(0,g.useEffect)(o,u);let d;e[5]!==r?(d={onlineUsers:r},e[5]=r,e[6]=d):d=e[6];let m;return e[7]!==a||e[8]!==d?(m=(0,s.jsx)(Ys.Provider,{value:d,children:a}),e[7]=a,e[8]=d,e[9]=m):m=e[9],m},Gs=()=>{const t=(0,g.useContext)(Ys);if(!t)throw new Error("usePresence must be used within a PresenceProvider");return t};var br=K(),Zs=(0,g.createContext)();const gr=t=>{const e=(0,br.c)(19),{children:a}=t,[i,n]=(0,g.useState)(vr),[r,l]=(0,g.useState)(jr),[o,c]=(0,g.useState)(wr);let u,d;e[0]!==i?(u=()=>{localStorage.setItem("theme",i?"dark":"light"),i?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},d=[i],e[0]=i,e[1]=u,e[2]=d):(u=e[1],d=e[2]),(0,g.useEffect)(u,d);let m,f;e[3]!==r?(m=()=>{localStorage.setItem("font-size",r),document.documentElement.style.setProperty("--app-font-size",{small:"14px",base:"16px",large:"18px"}[r])},f=[r],e[3]=r,e[4]=m,e[5]=f):(m=e[4],f=e[5]),(0,g.useEffect)(m,f);let h,p;e[6]!==o?(h=()=>{localStorage.setItem("data-saver",o)},p=[o],e[6]=o,e[7]=h,e[8]=p):(h=e[7],p=e[8]),(0,g.useEffect)(h,p);let x;e[9]!==i?(x=()=>n(!i),e[9]=i,e[10]=x):x=e[10];const b=x;let v;e[11]!==i||e[12]!==o||e[13]!==r||e[14]!==b?(v={darkMode:i,setDarkMode:n,toggleDarkMode:b,fontSize:r,setFontSize:l,dataSaver:o,setDataSaver:c},e[11]=i,e[12]=o,e[13]=r,e[14]=b,e[15]=v):v=e[15];let j;return e[16]!==a||e[17]!==v?(j=(0,s.jsx)(Zs.Provider,{value:v,children:a}),e[16]=a,e[17]=v,e[18]=j):j=e[18],j},mt=()=>{const t=(0,g.useContext)(Zs);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t};function vr(){const t=localStorage.getItem("theme");return t==="dark"||!t&&window.matchMedia("(prefers-color-scheme: dark)").matches}function jr(){return localStorage.getItem("font-size")||"base"}function wr(){return localStorage.getItem("data-saver")==="true"}var yr=K(),zr=t=>{const e=(0,yr.c)(7);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];const{theme:i}=Li(),n=i===void 0?"system":i;let r,l;e[2]===Symbol.for("react.memo_cache_sentinel")?(r={success:(0,s.jsx)(Ps,{className:"size-4"}),info:(0,s.jsx)(It,{className:"size-4"}),warning:(0,s.jsx)(ci,{className:"size-4"}),error:(0,s.jsx)(Ba,{className:"size-4"}),loading:(0,s.jsx)(me,{className:"size-4 animate-spin"})},l={"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)","--border-radius":"var(--radius)"},e[2]=r,e[3]=l):(r=e[2],l=e[3]);let o;return e[4]!==a||e[5]!==n?(o=(0,s.jsx)(qi,{theme:n,className:"toaster group",icons:r,style:l,...a}),e[4]=a,e[5]=n,e[6]=o):o=e[6],o},Nr=K(),ea=(0,g.createContext)();const kr=t=>{const e=(0,Nr.c)(4),{children:a}=t,i=_r;let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n={addToast:i},e[0]=n):n=e[0];let r;e[1]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsx)(zr,{position:"bottom-center",toastOptions:{className:"rounded-full font-bold"}}),e[1]=r):r=e[1];let l;return e[2]!==a?(l=(0,s.jsxs)(ea.Provider,{value:n,children:[a,r]}),e[2]=a,e[3]=l):l=e[3],l},we=()=>{const t=(0,g.useContext)(ea);if(!t)throw new Error("useToast must be used within a ToastProvider");return t};function _r(t,e){const a=e===void 0?"success":e;a==="error"?Ct.error(t):a==="info"?Ct.info(t):Ct.success(t)}var ta=(0,g.createContext)();const Cr=({children:t})=>{const[e,a]=(0,g.useState)([]),[i,n]=(0,g.useState)(!0),[r,l]=(0,g.useState)(!0),[o,c]=(0,g.useState)(!1),u=(0,g.useRef)(e);(0,g.useEffect)(()=>{u.current=e},[e]);const d=(0,g.useCallback)(async(v=!1)=>{v?c(!0):n(!0);try{const j=u.current,w=await $n(v&&j.length>0?j[j.length-1].created_at:null,10);w.length<10?l(!1):l(!0),a(v?y=>[...y,...w]:w)}catch(j){console.error("Failed to load posts:",j)}finally{n(!1),c(!1)}},[]),m=()=>{!r||o||d(!0)};(0,g.useEffect)(()=>{d()},[d]);const f=async v=>{const j=await Fn(v);return d(),j},h=async v=>{await Rn(v),a(j=>j.filter(w=>w.id!==v))},p=async(v,j)=>{await Ln(v,j),a(w=>w.map(y=>y.id===v?{...y,...j}:y))},x=v=>e.find(j=>j.id===v),b=(v,j="feed")=>{let w=e.filter(y=>!!(y.user?.handle===v||y.repostedBy&&y.repostedBy.handle===v));return j==="feed"?w.filter(y=>y.parent_id===null):j==="media"?w.filter(y=>y.parent_id===null&&(y.type==="video"||y.type==="image"||y.media?.length>0)):w};return(0,s.jsx)(ta.Provider,{value:{posts:e,setPosts:a,addPost:f,deletePost:h,updatePost:p,getPostById:x,getUserPosts:b,loading:i,hasMore:r,isFetchingNextPage:o,fetchNextPage:m,refreshPosts:()=>d(!1)},children:t})},kt=()=>{const t=(0,g.useContext)(ta);if(!t)throw new Error("usePosts must be used within a PostProvider");return t};var Sr=K(),sa=(0,g.createContext)();const $r=t=>{const e=(0,Sr.c)(9),{children:a}=t;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i={isOpen:!1,images:[],currentIndex:0},e[0]=i):i=e[0];const[n,r]=(0,g.useState)(i);let l;e[1]===Symbol.for("react.memo_cache_sentinel")?(l=(p,x)=>{const b=x===void 0?0:x;r({isOpen:!0,images:Array.isArray(p)?p:[p],currentIndex:b})},e[1]=l):l=e[1];const o=l;let c;e[2]===Symbol.for("react.memo_cache_sentinel")?(c=()=>{r(Pr)},e[2]=c):c=e[2];const u=c;let d;e[3]===Symbol.for("react.memo_cache_sentinel")?(d=p=>{r(x=>({...x,currentIndex:p}))},e[3]=d):d=e[3];const m=d;let f;e[4]!==n?(f={...n,openLightbox:o,closeLightbox:u,setIndex:m},e[4]=n,e[5]=f):f=e[5];let h;return e[6]!==a||e[7]!==f?(h=(0,s.jsx)(sa.Provider,{value:f,children:a}),e[6]=a,e[7]=f,e[8]=h):h=e[8],h},Ot=()=>{const t=(0,g.useContext)(sa);if(!t)throw new Error("useLightbox must be used within a LightboxProvider");return t};function Pr(t){return{...t,isOpen:!1}}var Mr=K(),aa=(0,g.createContext)();const Fr=t=>{const e=(0,Mr.c)(15),{children:a}=t,[i,n]=(0,g.useState)(null);let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=new Map,e[0]=r):r=e[0];const l=(0,g.useRef)(r);let o;e[1]!==i?(o=(x,b,v)=>{b===0?l.current.has(x)&&l.current.delete(x):l.current.set(x,{ratio:b,...v});let j=null,w=.5;for(const[y,_]of l.current.entries())_.ratio>w&&(w=_.ratio,j=y);j!==i&&n(j)},e[1]=i,e[2]=o):o=e[2];const c=o;let u,d;e[3]!==i?(u=()=>{l.current.forEach((x,b)=>{b===i?x.play():x.pause()})},d=[i],e[3]=i,e[4]=u,e[5]=d):(u=e[4],d=e[5]),(0,g.useEffect)(u,d);let m;e[6]!==i?(m=x=>{l.current.delete(x),i===x&&n(null)},e[6]=i,e[7]=m):m=e[7];const f=m;let h;e[8]!==i||e[9]!==c||e[10]!==f?(h={reportVisibility:c,unregister:f,activeVideoId:i},e[8]=i,e[9]=c,e[10]=f,e[11]=h):h=e[11];let p;return e[12]!==a||e[13]!==h?(p=(0,s.jsx)(aa.Provider,{value:h,children:a}),e[12]=a,e[13]=h,e[14]=p):p=e[14],p},Rr=()=>{const t=(0,g.useContext)(aa);if(!t)throw new Error("useVideoPlayback must be used within a VideoPlaybackProvider");return t};var Lr=K();const ia=t=>{const e=(0,Lr.c)(16),a=wt(),i=t?.id;let n;e[0]!==i?(n=["unread_notifications_count",i],e[0]=i,e[1]=n):n=e[1];let r;e[2]!==t?.id?(r=()=>Gn(t?.id),e[2]=t?.id,e[3]=r):r=e[3];const l=!!t?.id;let o;e[4]!==n||e[5]!==r||e[6]!==l?(o={queryKey:n,queryFn:r,enabled:l},e[4]=n,e[5]=r,e[6]=l,e[7]=o):o=e[7];const{data:c}=$e(o),u=c===void 0?0:c;let d;e[8]!==t||e[9]!==a?(d=()=>{if(!t?.id)return;const p=A.channel(`unread_count:${t.id}`).on("postgres_changes",{event:"*",schema:"public",table:"notifications",filter:`recipient_id=eq.${t.id}`},()=>{a.invalidateQueries({queryKey:["unread_notifications_count",t.id]}),a.invalidateQueries({queryKey:["notifications",t.id]})}).subscribe();return()=>A.removeChannel(p)},e[8]=t,e[9]=a,e[10]=d):d=e[10];const m=t?.id;let f;e[11]!==a||e[12]!==m?(f=[m,a],e[11]=a,e[12]=m,e[13]=f):f=e[13],(0,g.useEffect)(d,f);let h;return e[14]!==u?(h={unreadCount:u},e[14]=u,e[15]=h):h=e[15],h};var Ir=K();const Wt=t=>{const e=(0,Ir.c)(65),a=wt();let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i={},e[0]=i):i=e[0];const[n,r]=(0,g.useState)(i),l=(0,g.useRef)(null),o=t?.id;let c;e[1]!==o?(c=["conversations",o],e[1]=o,e[2]=c):c=e[2];let u;e[3]!==t?.id?(u=()=>Un(t?.id),e[3]=t?.id,e[4]=u):u=e[4];const d=!!t?.id;let m;e[5]!==c||e[6]!==u||e[7]!==d?(m={queryKey:c,queryFn:u,enabled:d},e[5]=c,e[6]=u,e[7]=d,e[8]=m):m=e[8];const{data:f,isLoading:h}=$e(m);let p;e[9]!==f?(p=f===void 0?[]:f,e[9]=f,e[10]=p):p=e[10];const x=p,b=t?.id;let v;e[11]!==b?(v=["unread_messages_count",b],e[11]=b,e[12]=v):v=e[12];let j;e[13]!==t?.id?(j=()=>Wn(t?.id),e[13]=t?.id,e[14]=j):j=e[14];const w=!!t?.id;let y;e[15]!==j||e[16]!==w||e[17]!==v?(y={queryKey:v,queryFn:j,enabled:w},e[15]=j,e[16]=w,e[17]=v,e[18]=y):y=e[18];const{data:_}=$e(y),C=_===void 0?0:_;let F;e[19]===Symbol.for("react.memo_cache_sentinel")?(F=["reactions"],e[19]=F):F=e[19];const E=!!t?.id;let M;e[20]!==E?(M={queryKey:F,queryFn:Hn,enabled:E},e[20]=E,e[21]=M):M=e[21];const{data:N}=$e(M);let P;e[22]!==N?(P=N===void 0?[]:N,e[22]=N,e[23]=P):P=e[23];const L=P;let R;e[24]!==t||e[25]!==a?(R=()=>{if(!t?.id)return;const V=A.channel(`user_messages:${t.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},X=>{const ee=X.new;a.setQueryData(["messages",ee.conversation_id],J=>J?J.find(ce=>ce.id===ee.id)?J:[...J,ee]:[ee]),ee.sender_id!==t.id&&a.invalidateQueries({queryKey:["unread_messages_count",t.id]}),a.invalidateQueries(["conversations",t.id]),r(J=>({...J,[ee.conversation_id]:!1}))}).on("postgres_changes",{event:"DELETE",schema:"public",table:"messages"},X=>{a.invalidateQueries({queryKey:["messages"]}),a.invalidateQueries({queryKey:["conversations",t.id]})}).on("postgres_changes",{event:"*",schema:"public",table:"message_reactions"},()=>{a.invalidateQueries({queryKey:["reactions"]})}).subscribe(),H=A.channel("chat_typing_shared").on("broadcast",{event:"typing"},X=>{const{payload:ee}=X,{conversationId:J,isTyping:ce,userId:te}=ee;te!==t.id&&r(de=>({...de,[J]:ce}))}).subscribe();return l.current=H,()=>{A.removeChannel(V),A.removeChannel(H)}},e[24]=t,e[25]=a,e[26]=R):R=e[26];const I=t?.id;let D;e[27]!==a||e[28]!==I?(D=[I,a],e[27]=a,e[28]=I,e[29]=D):D=e[29],(0,g.useEffect)(R,D);let S;e[30]!==t?(S=V=>{const{convId:H,text:X,type:ee,media:J,replyToId:ce}=V,te=ee===void 0?"text":ee,de=J===void 0?[]:J,fe=ce===void 0?null:ce;return Qn(H,t.id,X,te,de,fe)},e[30]=t,e[31]=S):S=e[31];let $;e[32]!==t||e[33]!==a?($=V=>{a.setQueryData(["messages",V.conversation_id],H=>H?H.find(X=>X.id===V.id)?H:[...H,V]:[V]),a.invalidateQueries(["conversations",t.id])},e[32]=t,e[33]=a,e[34]=$):$=e[34];let q;e[35]!==S||e[36]!==$?(q={mutationFn:S,onSuccess:$},e[35]=S,e[36]=$,e[37]=q):q=e[37];const z=vs(q);let k;e[38]!==t?(k=(V,H)=>{l.current&&l.current.send({type:"broadcast",event:"typing",payload:{conversationId:V,isTyping:H,userId:t.id}})},e[38]=t,e[39]=k):k=e[39];const O=k;let U;e[40]!==t||e[41]!==a?(U=async V=>{!t?.id||!V||(await Bn(V,t.id),a.invalidateQueries({queryKey:["unread_messages_count",t.id]}),a.invalidateQueries({queryKey:["conversations",t.id]}))},e[40]=t,e[41]=a,e[42]=U):U=e[42];const T=U;let W;e[43]!==t||e[44]!==a?(W=async(V,H)=>{if(t?.id)try{await Jn(V,t.id,H),a.invalidateQueries({queryKey:["reactions"]})}catch(X){console.error("Failed to toggle reaction:",X)}},e[43]=t,e[44]=a,e[45]=W):W=e[45];const Q=W;let Z;e[46]!==a?(Z=async V=>{try{await Kn(V),a.invalidateQueries({queryKey:["messages"]})}catch(H){console.error("Failed to delete message:",H)}},e[46]=a,e[47]=Z):Z=e[47];const ae=Z;let ie;e[48]!==t?.id?(ie=(V,H)=>{const X=V===void 0?[]:V,ee=H===void 0?[]:H;return X.map(J=>({id:J.id,sender:J.sender_id===t?.id?"me":"them",text:J.content,type:J.type||"text",media:J.media||[],isRead:J.is_read,replyToId:J.reply_to_id,reactions:ee.filter(ce=>ce.message_id===J.id),time:new Date(J.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}))},e[48]=t?.id,e[49]=ie):ie=e[49];const G=ie;let se;e[50]!==z?(se=(V,H,X,ee,J)=>z.mutate({convId:V,text:H,type:X,media:ee,replyToId:J}),e[50]=z,e[51]=se):se=e[51];let ne;return e[52]!==L||e[53]!==x||e[54]!==G||e[55]!==h||e[56]!==T||e[57]!==ae||e[58]!==Q||e[59]!==z.isPending||e[60]!==O||e[61]!==se||e[62]!==n||e[63]!==C?(ne={conversations:x,unreadCount:C,isConvLoading:h,sendMessage:se,sendTypingStatus:O,typingStatus:n,markAsRead:T,formatMessages:G,onToggleReaction:Q,onDeleteMessage:ae,allReactions:L,isSending:z.isPending},e[52]=L,e[53]=x,e[54]=G,e[55]=h,e[56]=T,e[57]=ae,e[58]=Q,e[59]=z.isPending,e[60]=O,e[61]=se,e[62]=n,e[63]=C,e[64]=ne):ne=e[64],ne};var Er=K();function oe(...t){return pn(xn(t))}const Tr=()=>{const t=(0,Er.c)(2),{pathname:e}=ot();let a;return t[0]!==e?(a=[e],t[0]=e,t[1]=a):a=t[1],(0,g.useEffect)(Ar,a),null},ke=t=>typeof t!="string"?!1:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t),qr=(t,e)=>{const a=document.createElement("canvas"),i=t.naturalWidth/t.width,n=t.naturalHeight/t.height;a.width=e.width*i,a.height=e.height*n;const r=a.getContext("2d");return r.imageSmoothingEnabled=!0,r.imageSmoothingQuality="high",r.drawImage(t,e.x*i,e.y*n,e.width*i,e.height*n,0,0,e.width*i,e.height*n),new Promise((l,o)=>{a.toBlob(c=>{if(!c){o(new Error("Canvas is empty"));return}l(c)},"image/jpeg",.95)})},pt=t=>{if(!t)return"";const e=new Date-new Date(t),a=Math.floor(e/1e3),i=Math.floor(a/60),n=Math.floor(i/60),r=Math.floor(n/24);return a<60?"Just now":i<60?`${i}m ago`:n<24?`${n}h ago`:r<7?`${r}d ago`:new Date(t).toLocaleDateString()},Dr=t=>typeof t!="string"?!1:/[\u0980-\u09FF]/.test(t),ht=t=>{if(!t)return null;const e=t.match(/(https?:\/\/[^\s]+)/g);return e?e[0]:null};function Ar(){window.scrollTo(0,0)}var Bt=K();function xe(t){const e=(0,Bt.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=oe("relative flex size-8 shrink-0 overflow-hidden rounded-full",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(Wi,{"data-slot":"avatar",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function he(t){const e=(0,Bt.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=oe("aspect-square size-full",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(Xi,{"data-slot":"avatar-image",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function pe(t){const e=(0,Bt.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=oe("bg-muted flex size-full items-center justify-center rounded-full",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(Pi,{"data-slot":"avatar-fallback",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var Or=K(),Wr=t=>{const e=(0,Or.c)(23),{handleProfileClick:a}=t,{currentUser:i}=be(),{unreadCount:n}=ia(i),{unreadCount:r}=Wt(i),l=ot();let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=[{id:"home",icon:Dt,path:"/"},{id:"community",icon:Ye,path:"/community"},{id:"reels",icon:vt,path:"/reels"},{id:"messages",icon:yt,path:"/messages"},{id:"notifications",icon:zt,path:"/notifications"}],e[0]=o):o=e[0];const c=o;let u;e[1]!==r||e[2]!==n?(u=c.map(w=>(0,s.jsx)(Ms,{to:w.path,className:Ur,children:y=>{const{isActive:_}=y;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(w.icon,{size:26,strokeWidth:_?2.5:2}),w.id==="notifications"&&n>0&&(0,s.jsx)("span",{className:"absolute top-3 right-[30%] size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"}),w.id==="messages"&&r>0&&(0,s.jsx)("span",{className:"absolute top-3 right-[30%] size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"})]})}},w.id)),e[1]=r,e[2]=n,e[3]=u):u=e[3];let d;e[4]!==i||e[5]!==a?(d=()=>{i&&a(i.handle)},e[4]=i,e[5]=a,e[6]=d):d=e[6];const m=`size-7 border-2 ${l.pathname.startsWith("/u/")?"border-black dark:border-white":"border-transparent opacity-70"}`,f=i?.avatar||"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm";let h;e[7]!==f?(h=(0,s.jsx)(he,{src:f,alt:"Profile",className:"object-cover"}),e[7]=f,e[8]=h):h=e[8];let p;e[9]!==i?.handle?.[0]?(p=i?.handle?.[0]?.toUpperCase(),e[9]=i?.handle?.[0],e[10]=p):p=e[10];let x;e[11]!==p?(x=(0,s.jsx)(pe,{children:p}),e[11]=p,e[12]=x):x=e[12];let b;e[13]!==m||e[14]!==h||e[15]!==x?(b=(0,s.jsxs)(xe,{className:m,children:[h,x]}),e[13]=m,e[14]=h,e[15]=x,e[16]=b):b=e[16];let v;e[17]!==d||e[18]!==b?(v=(0,s.jsx)("button",{onClick:d,className:"flex-1 flex flex-col items-center justify-center h-full",children:b}),e[17]=d,e[18]=b,e[19]=v):v=e[19];let j;return e[20]!==v||e[21]!==u?(j=(0,s.jsxs)("nav",{className:"fixed bottom-0 left-0 right-0 z-[40] flex h-16 items-center border-t border-zinc-100 bg-white/90 pb-safe backdrop-blur-md dark:border-zinc-800 dark:bg-black/90 md:hidden",children:[u,v]}),e[20]=v,e[21]=u,e[22]=j):j=e[22],j},Br=Wr;function Ur(t){const{isActive:e}=t;return`flex flex-1 flex-col items-center justify-center h-full transition-all duration-200 relative ${e?"text-black dark:text-white":"text-zinc-400 opacity-70"}`}var Vr=K(),Hr=()=>{const t=(0,Vr.c)(5);let e,a;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,s.jsx)("img",{src:"https://systemadminbd.com/uploads/675346dd55e0c7.43939630.png",alt:"Welcome Banner",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-700"}),a=(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"}),t[0]=e,t[1]=a):(e=t[0],a=t[1]);let i;t[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsx)("h1",{className:"text-3xl sm:text-4xl font-black mb-1 drop-shadow-lg",children:"Welcome to Sysm"}),t[2]=i):i=t[2];let n;t[3]===Symbol.for("react.memo_cache_sentinel")?(n=(0,s.jsxs)("div",{className:"absolute bottom-6 left-8 text-white",children:[i,(0,s.jsxs)("p",{className:"text-sm sm:text-base font-medium opacity-90 tracking-wide drop-shadow-md",children:["a social network built by"," ",(0,s.jsx)("a",{href:"https://t.me/systemadminbd",target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:"@Systemadminbd"})]})]}),t[3]=n):n=t[3];let r;return t[4]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsxs)("div",{className:"relative w-full aspect-[21/9] sm:aspect-[2.5/1] rounded-3xl overflow-hidden mb-6 group cursor-pointer",children:[e,a,n,(0,s.jsx)("div",{className:"absolute bottom-4 right-8",children:(0,s.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",className:"size-12 animate-pulse opacity-80 rounded-xl",alt:""})})]}),t[4]=r):r=t[4],r},Jr=Hr,Qr=K(),Kr=t=>{const e=(0,Qr.c)(29),{onPostClick:a}=t,i=ot(),n=ge(),{darkMode:r}=mt(),l=i.pathname==="/";let o;e[0]!==i.pathname?(o=i.pathname.startsWith("/reels")||i.pathname.startsWith("/messages")&&i.pathname.split("/").length>2,e[0]=i.pathname,e[1]=o):o=e[1];const c=o;let u;e[2]!==n?(u=F=>{n(`/u/${F}`)},e[2]=n,e[3]=u):u=e[3];const d=u,m=`min-h-screen bg-[--background] text-[--foreground] font-sans selection:bg-violet-500 selection:text-white transition-colors duration-200 ${r?"dark":""}`;let f;e[4]!==a?(f=(0,s.jsx)(tl,{onPostClick:a}),e[4]=a,e[5]=f):f=e[5];const h=!c&&"pb-24 md:pb-0";let p;e[6]!==h?(p=oe("flex-1 flex justify-center gap-x-2 md:gap-x-8 py-0 md:py-5 px-0 md:px-4",h),e[6]=h,e[7]=p):p=e[7];let x;e[8]!==l?(x=l&&(0,s.jsx)("div",{className:"w-full max-w-full overflow-hidden",children:(0,s.jsx)(Jr,{})}),e[8]=l,e[9]=x):x=e[9];let b;e[10]===Symbol.for("react.memo_cache_sentinel")?(b=(0,s.jsx)("div",{className:"w-full",children:(0,s.jsx)(Hi,{})}),e[10]=b):b=e[10];let v;e[11]!==x?(v=(0,s.jsxs)("div",{className:"flex flex-col flex-1 w-0 overflow-x-hidden",children:[x,b]}),e[11]=x,e[12]=v):v=e[12];let j;e[13]!==i.pathname?(j=!i.pathname.startsWith("/messages")&&(0,s.jsx)(ao,{}),e[13]=i.pathname,e[14]=j):j=e[14];let w;e[15]!==j||e[16]!==p||e[17]!==v?(w=(0,s.jsxs)("div",{className:p,children:[v,j]}),e[15]=j,e[16]=p,e[17]=v,e[18]=w):w=e[18];let y;e[19]!==w||e[20]!==f?(y=(0,s.jsxs)("div",{className:"flex justify-center w-full max-w-[1300px] mx-auto min-h-screen px-0 sm:px-0",children:[f,w]}),e[19]=w,e[20]=f,e[21]=y):y=e[21];let _;e[22]!==d||e[23]!==c?(_=!c&&(0,s.jsx)(Br,{handleProfileClick:d}),e[22]=d,e[23]=c,e[24]=_):_=e[24];let C;return e[25]!==y||e[26]!==_||e[27]!==m?(C=(0,s.jsxs)("div",{className:m,children:[y,_]}),e[25]=y,e[26]=_,e[27]=m,e[28]=C):C=e[28],C},Xr=Kr,Yr=K(),Gr=t=>{const e=(0,Yr.c)(2),{children:a}=t;let i;return e[0]!==a?(i=(0,s.jsx)("div",{className:"w-full animate-in fade-in slide-in-from-bottom-2 duration-300 ease-out",children:a}),e[0]=a,e[1]=i):i=e[1],i},Ne=Gr,Zr=K(),el=t=>{const e=(0,Zr.c)(18),{onPostClick:a}=t,{currentUser:i}=be(),{unreadCount:n}=ia(i),{unreadCount:r}=Wt(i);let l,o,c,u,d;e[0]===Symbol.for("react.memo_cache_sentinel")?(l={id:"home",icon:Dt,path:"/"},o={id:"community",icon:Ye,path:"/community"},c={id:"reels",icon:vt,path:"/reels"},u={id:"messages",icon:yt,path:"/messages"},d={id:"notifications",icon:zt,path:"/notifications"},e[0]=l,e[1]=o,e[2]=c,e[3]=u,e[4]=d):(l=e[0],o=e[1],c=e[2],u=e[3],d=e[4]);const m=i?`/u/${i.handle}`:"/community";let f;e[5]!==m?(f=[l,o,c,u,d,{id:"profile",icon:Et,path:m}],e[5]=m,e[6]=f):f=e[6];const h=f;let p;e[7]===Symbol.for("react.memo_cache_sentinel")?(p=(0,s.jsx)(At,{to:"/",className:"mb-8 hover:scale-110 transition-transform",children:(0,s.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",alt:"Logo",className:"size-8 rounded-lg"})}),e[7]=p):p=e[7];let x;e[8]!==r||e[9]!==h||e[10]!==n?(x=h.map(j=>(0,s.jsxs)(Ms,{to:j.path,className:sl,children:[(0,s.jsx)(j.icon,{size:26,strokeWidth:2.5}),j.id==="notifications"&&n>0&&(0,s.jsx)("span",{className:"absolute top-2 right-2 size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"}),j.id==="messages"&&r>0&&(0,s.jsx)("span",{className:"absolute top-2 right-2 size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"})]},j.id)),e[8]=r,e[9]=h,e[10]=n,e[11]=x):x=e[11];let b;e[12]!==i||e[13]!==a?(b=i&&(0,s.jsx)("button",{onClick:a,className:"p-2.5 mt-2 rounded-xl text-white bg-zinc-950 dark:bg-white dark:text-zinc-950 hover:scale-110 active:scale-95 transition-all duration-200 shadow-lg cursor-pointer",title:"Create Post",children:(0,s.jsx)(De,{size:26,strokeWidth:2.5})}),e[12]=i,e[13]=a,e[14]=b):b=e[14];let v;return e[15]!==b||e[16]!==x?(v=(0,s.jsxs)("aside",{className:"sticky top-0 hidden md:flex h-screen w-[68px] flex-col items-center py-5 border-r border-zinc-100 dark:border-zinc-800 shrink-0 bg-white dark:bg-black transition-colors duration-200",children:[p,(0,s.jsxs)("nav",{className:"flex flex-col gap-y-4 w-full items-center",children:[x,b]})]}),e[15]=b,e[16]=x,e[17]=v):v=e[17],v},tl=el;function sl(t){const{isActive:e}=t;return`p-2.5 rounded-xl transition-all duration-200 border border-transparent relative ${e?"text-black dark:text-white bg-zinc-100 dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800":"text-zinc-500 hover:bg-zinc-50 dark:hover:bg-zinc-900"}`}var Me=K();function Gt(t){const e=(0,Me.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(Ii,{"data-slot":"alert-dialog",...a}),e[2]=a,e[3]=i):i=e[3],i}function al(t){const e=(0,Me.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(Gi,{"data-slot":"alert-dialog-portal",...a}),e[2]=a,e[3]=i):i=e[3],i}function il(t){const e=(0,Me.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=oe("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(Ui,{"data-slot":"alert-dialog-overlay",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function Zt(t){const e=(0,Me.c)(9);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]===Symbol.for("react.memo_cache_sentinel")?(n=(0,s.jsx)(il,{}),e[3]=n):n=e[3];let r;e[4]!==a?(r=oe("bg-white dark:bg-zinc-950 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-2xl border border-zinc-100 dark:border-zinc-800 p-6 shadow-xl duration-200 sm:max-w-md",a),e[4]=a,e[5]=r):r=e[5];let l;return e[6]!==i||e[7]!==r?(l=(0,s.jsxs)(al,{children:[n,(0,s.jsx)(Ci,{"data-slot":"alert-dialog-content","aria-describedby":void 0,className:r,...i})]}),e[6]=i,e[7]=r,e[8]=l):l=e[8],l}function es(t){const e=(0,Me.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=oe("flex flex-col gap-2 text-center sm:text-left",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)("div",{"data-slot":"alert-dialog-header",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function ts(t){const e=(0,Me.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=oe("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)("div",{"data-slot":"alert-dialog-footer",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function ss(t){const e=(0,Me.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=oe("text-lg font-semibold",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(wi,{"data-slot":"alert-dialog-title",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function as(t){const e=(0,Me.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=oe("text-muted-foreground text-sm",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(sn,{"data-slot":"alert-dialog-description",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function is(t){const e=(0,Me.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=oe("inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-bold transition-all active:scale-95 bg-zinc-900 text-white hover:bg-zinc-800 dark:bg-white dark:text-black dark:hover:bg-zinc-200",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(ni,{className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function ns(t){const e=(0,Me.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=oe("inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-bold border border-zinc-200 bg-white text-zinc-900 hover:bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-950 dark:text-zinc-50 dark:hover:bg-zinc-900",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(Pa,{className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var nl=K(),rl=t=>{const e=(0,nl.c)(12);let a,i,n,r;e[0]!==t?({children:a,variant:n,className:r,...i}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n,e[4]=r):(a=e[1],i=e[2],n=e[3],r=e[4]);const l=n===void 0?"primary":n,o=r===void 0?"":r;let c;e[5]===Symbol.for("react.memo_cache_sentinel")?(c={primary:"text-white hover:text-white bg-zinc-900 hover:bg-zinc-800 border border-zinc-900 dark:bg-white dark:text-black dark:border-white dark:hover:bg-zinc-200",secondary:"text-zinc-900 border border-zinc-300 hover:border-zinc-400 bg-transparent hover:bg-zinc-50 dark:text-white dark:border-zinc-700 dark:hover:border-zinc-600 dark:hover:bg-zinc-900",outline:"text-zinc-900 border border-zinc-300 hover:border-zinc-400 bg-white dark:bg-transparent dark:text-white dark:border-zinc-700 dark:hover:bg-zinc-900",danger:"text-white bg-red-500 hover:bg-red-600 border border-red-500",ghost:"text-zinc-500 hover:bg-zinc-100 dark:text-zinc-400 dark:hover:bg-zinc-800 border-transparent"},e[5]=c):c=e[5];const u=`rounded-full font-bold inline-flex items-center justify-center relative overflow-hidden px-4 py-1.5 transition-all duration-200 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:active:scale-100 touch-manipulation ${c[l]} ${o}`;let d;e[6]!==a?(d=(0,s.jsx)("div",{className:"flex items-center gap-x-1.5",children:a}),e[6]=a,e[7]=d):d=e[7];let m;return e[8]!==i||e[9]!==u||e[10]!==d?(m=(0,s.jsx)("button",{className:u,...i,children:d}),e[8]=i,e[9]=u,e[10]=d,e[11]=m):m=e[11],m},ue=rl,at=K();function ll(t){const e=(0,at.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(pi,{"data-slot":"context-menu",...a}),e[2]=a,e[3]=i):i=e[3],i}function ol(t){const e=(0,at.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(gi,{"data-slot":"context-menu-trigger",...a}),e[2]=a,e[3]=i):i=e[3],i}function cl(t){const e=(0,at.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=oe("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(Ja,{children:(0,s.jsx)(Aa,{"data-slot":"context-menu-content",className:n,...i})}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function Pt(t){const e=(0,at.c)(12);let a,i,n,r;e[0]!==t?({className:a,inset:i,variant:r,...n}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n,e[4]=r):(a=e[1],i=e[2],n=e[3],r=e[4]);const l=r===void 0?"default":r;let o;e[5]!==a?(o=oe("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),e[5]=a,e[6]=o):o=e[6];let c;return e[7]!==i||e[8]!==n||e[9]!==o||e[10]!==l?(c=(0,s.jsx)(Qa,{"data-slot":"context-menu-item","data-inset":i,"data-variant":l,className:o,...n}),e[7]=i,e[8]=n,e[9]=o,e[10]=l,e[11]=c):c=e[11],c}function dl(t){const e=(0,at.c)(10);let a,i,n;e[0]!==t?({className:a,inset:i,...n}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n):(a=e[1],i=e[2],n=e[3]);let r;e[4]!==a?(r=oe("text-foreground px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",a),e[4]=a,e[5]=r):r=e[5];let l;return e[6]!==i||e[7]!==n||e[8]!==r?(l=(0,s.jsx)(Yi,{"data-slot":"context-menu-label","data-inset":i,className:r,...n}),e[6]=i,e[7]=n,e[8]=r,e[9]=l):l=e[9],l}function rs(t){const e=(0,at.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=oe("bg-border -mx-1 my-1 h-px",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(xi,{"data-slot":"context-menu-separator",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var Ve=K();function na(t){const e=(0,Ve.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(rn,{"data-slot":"dialog",...a}),e[2]=a,e[3]=i):i=e[3],i}function ml(t){const e=(0,Ve.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(Ai,{"data-slot":"dialog-portal",...a}),e[2]=a,e[3]=i):i=e[3],i}function ul(t){const e=(0,Ve.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=oe("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(ki,{"data-slot":"dialog-overlay",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function ra(t){const e=(0,Ve.c)(11);let a,i,n;e[0]!==t?({className:i,children:a,...n}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n):(a=e[1],i=e[2],n=e[3]);let r;e[4]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsx)(ul,{}),e[4]=r):r=e[4];let l;e[5]!==i?(l=oe("bg-white dark:bg-zinc-950 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-2xl border border-zinc-100 dark:border-zinc-800 p-6 shadow-xl duration-200 sm:max-w-md",i),e[5]=i,e[6]=l):l=e[6];let o;return e[7]!==a||e[8]!==n||e[9]!==l?(o=(0,s.jsxs)(ml,{children:[r,(0,s.jsx)(Ji,{"data-slot":"alert-dialog-content","aria-describedby":void 0,className:l,...n,children:a})]}),e[7]=a,e[8]=n,e[9]=l,e[10]=o):o=e[10],o}function la(t){const e=(0,Ve.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=oe("flex flex-col gap-2 text-center sm:text-left",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)("div",{"data-slot":"dialog-header",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function oa(t){const e=(0,Ve.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=oe("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)("div",{"data-slot":"dialog-footer",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function ca(t){const e=(0,Ve.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=oe("text-lg leading-none font-semibold",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(_i,{"data-slot":"dialog-title",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function fl(t){const e=(0,Ve.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=oe("text-muted-foreground text-sm",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(en,{"data-slot":"dialog-description",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var ut=K();function da(t){const e=(0,ut.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(Wa,{"data-slot":"dropdown-menu",...a}),e[2]=a,e[3]=i):i=e[3],i}function ma(t){const e=(0,ut.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(fi,{"data-slot":"dropdown-menu-trigger",...a}),e[2]=a,e[3]=i):i=e[3],i}function ua(t){const e=(0,ut.c)(10);let a,i,n;e[0]!==t?({className:a,sideOffset:n,...i}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n):(a=e[1],i=e[2],n=e[3]);const r=n===void 0?4:n;let l;e[4]!==a?(l=oe("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",a),e[4]=a,e[5]=l):l=e[5];let o;return e[6]!==i||e[7]!==r||e[8]!==l?(o=(0,s.jsx)(ui,{children:(0,s.jsx)(mn,{"data-slot":"dropdown-menu-content",sideOffset:r,className:l,...i})}),e[6]=i,e[7]=r,e[8]=l,e[9]=o):o=e[9],o}function Xe(t){const e=(0,ut.c)(12);let a,i,n,r;e[0]!==t?({className:a,inset:i,variant:r,...n}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n,e[4]=r):(a=e[1],i=e[2],n=e[3],r=e[4]);const l=r===void 0?"default":r;let o;e[5]!==a?(o=oe("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),e[5]=a,e[6]=o):o=e[6];let c;return e[7]!==i||e[8]!==n||e[9]!==o||e[10]!==l?(c=(0,s.jsx)(La,{"data-slot":"dropdown-menu-item","data-inset":i,"data-variant":l,className:o,...n}),e[7]=i,e[8]=n,e[9]=o,e[10]=l,e[11]=c):c=e[11],c}function xl(t){const e=(0,ut.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=oe("bg-border -mx-1 my-1 h-px",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(di,{"data-slot":"dropdown-menu-separator",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var hl=K(),pl=t=>{const e=(0,hl.c)(10),{onEmojiSelect:a,className:i}=t;let n;e[0]!==i?(n=oe("isolate flex h-[350px] w-[320px] flex-col overflow-hidden rounded-xl border border-zinc-200 bg-white shadow-xl dark:border-zinc-800 dark:bg-zinc-950",i),e[0]=i,e[1]=n):n=e[1];let r;e[2]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsx)(Je.Search,{className:"z-10 mx-3 mt-3 appearance-none rounded-lg border-none bg-zinc-100 px-3 py-2 text-sm outline-none placeholder:text-zinc-500 focus:ring-1 focus:ring-violet-500 dark:bg-zinc-900 dark:text-white",placeholder:"Search emojis..."}),e[2]=r):r=e[2];let l,o;e[3]===Symbol.for("react.memo_cache_sentinel")?(l=(0,s.jsx)(Je.Loading,{className:"absolute inset-0 flex items-center justify-center text-zinc-400 text-sm dark:text-zinc-500",children:"Loading"}),o=(0,s.jsx)(Je.Empty,{className:"absolute inset-0 flex items-center justify-center text-zinc-400 text-sm dark:text-zinc-500",children:"No emoji found."}),e[3]=l,e[4]=o):(l=e[3],o=e[4]);let c,u;e[5]===Symbol.for("react.memo_cache_sentinel")?(c=(0,s.jsxs)(Je.Viewport,{className:"relative flex-1 outline-none no-scrollbar",children:[l,o,(0,s.jsx)(Je.List,{className:"select-none pb-2",components:{CategoryHeader:gl,Row:vl,Emoji:jl}})]}),u=(0,s.jsx)(Je.ActiveEmoji,{children:wl}),e[5]=c,e[6]=u):(c=e[5],u=e[6]);let d;return e[7]!==a||e[8]!==n?(d=(0,s.jsxs)(Je.Root,{onEmojiSelect:a,className:n,children:[r,c,u]}),e[7]=a,e[8]=n,e[9]=d):d=e[9],d},bl=pl;function gl(t){const{category:e,...a}=t;return(0,s.jsx)("div",{className:"bg-white/80 px-4 pt-4 pb-1.5 font-bold text-zinc-500 text-[11px] uppercase tracking-wider backdrop-blur-sm dark:bg-zinc-950/80 dark:text-zinc-400",...a,children:e.label})}function vl(t){const{children:e,...a}=t;return(0,s.jsx)("div",{className:"scroll-my-1 px-2",...a,children:e})}function jl(t){const{emoji:e,...a}=t;return(0,s.jsx)("button",{className:"flex aspect-square size-9 items-center justify-center rounded-lg text-xl transition-colors hover:bg-zinc-100 data-[active]:bg-violet-500/10 data-[active]:text-violet-500 dark:hover:bg-zinc-900 dark:data-[active]:bg-violet-500/20",...a,children:e.emoji})}function wl(t){const{emoji:e}=t;return(0,s.jsx)("div",{className:"flex items-center gap-3 border-t border-zinc-100 p-3 dark:border-zinc-800",children:e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"text-2xl",children:e.emoji}),(0,s.jsx)("span",{className:"text-xs font-bold text-zinc-600 dark:text-zinc-400 truncate",children:e.label.replace(/:/g,"").replace(/_/g," ")})]}):(0,s.jsx)("span",{className:"text-xs font-medium text-zinc-400",children:"Select an emoji..."})})}var yl=K(),zl=t=>{const e=(0,yl.c)(33),{src:a,isOpen:i,onClose:n,onCropComplete:r,aspect:l,circular:o}=t,[c,u]=(0,g.useState)(),[d,m]=(0,g.useState)(null),f=(0,g.useRef)(null);let h;e[0]!==l?(h=L=>{const{width:R,height:I}=L.currentTarget;u(l?Ua(Da({unit:"%",width:100},l,R,I),R,I):{unit:"%",width:100,height:100,x:0,y:0})},e[0]=l,e[1]=h):h=e[1];const p=h;let x;e[2]!==d||e[3]!==n||e[4]!==r?(x=async()=>{if(d&&f.current)try{r(await qr(f.current,d)),n()}catch(L){console.error("Error cropping image:",L)}},e[2]=d,e[3]=n,e[4]=r,e[5]=x):x=e[5];const b=x;let v;e[6]!==n?(v=L=>!L&&n(),e[6]=n,e[7]=v):v=e[7];let j;e[8]===Symbol.for("react.memo_cache_sentinel")?(j=(0,s.jsx)(la,{className:"p-4 shrink-0",children:(0,s.jsx)(ca,{children:"Crop Image"})}),e[8]=j):j=e[8];let w,y;e[9]===Symbol.for("react.memo_cache_sentinel")?(w=L=>u(L),y=(L,R)=>m(R),e[9]=w,e[10]=y):(w=e[9],y=e[10]);let _;e[11]!==p||e[12]!==a?(_=(0,s.jsx)("img",{ref:f,src:a,alt:"Crop preview",onLoad:p,className:"max-h-[60vh] w-auto block"}),e[11]=p,e[12]=a,e[13]=_):_=e[13];let C;e[14]!==l||e[15]!==o||e[16]!==c||e[17]!==_?(C=(0,s.jsx)("div",{className:"p-6 flex items-center justify-center bg-zinc-100/50 dark:bg-zinc-950/50 min-h-[300px] max-h-[65vh] overflow-auto",children:(0,s.jsx)(Ka,{crop:c,onChange:w,onComplete:y,aspect:l,circularCrop:o,className:"max-w-full shadow-2xl",children:_})}),e[14]=l,e[15]=o,e[16]=c,e[17]=_,e[18]=C):C=e[18];let F;e[19]!==n?(F=(0,s.jsx)(ue,{variant:"outline",onClick:n,className:"!w-auto px-6",children:"Cancel"}),e[19]=n,e[20]=F):F=e[20];let E;e[21]!==b?(E=(0,s.jsx)(ue,{onClick:b,className:"!w-auto px-6",children:"Apply Crop"}),e[21]=b,e[22]=E):E=e[22];let M;e[23]!==E||e[24]!==F?(M=(0,s.jsxs)(oa,{className:"p-4 bg-white dark:bg-zinc-900 shrink-0 flex flex-row justify-end gap-2",children:[F,E]}),e[23]=E,e[24]=F,e[25]=M):M=e[25];let N;e[26]!==M||e[27]!==C?(N=(0,s.jsxs)(ra,{className:"sm:max-w-2xl bg-white dark:bg-zinc-900 p-0 overflow-hidden",children:[j,C,M]}),e[26]=M,e[27]=C,e[28]=N):N=e[28];let P;return e[29]!==i||e[30]!==N||e[31]!==v?(P=(0,s.jsx)(na,{open:i,onOpenChange:v,children:N}),e[29]=i,e[30]=N,e[31]=v,e[32]=P):P=e[32],P},Nl=zl,kl=K(),_l=t=>{const e=(0,kl.c)(105),{images:a,currentIndex:i,onClose:n,onNavigate:r}=t,l=i===void 0?0:i,[o,c]=(0,g.useState)(1);let u;e[0]===Symbol.for("react.memo_cache_sentinel")?(u={x:0,y:0},e[0]=u):u=e[0];const[d,m]=(0,g.useState)(u),[f,h]=(0,g.useState)(!1);let p;e[1]===Symbol.for("react.memo_cache_sentinel")?(p={x:0,y:0},e[1]=p):p=e[1];const[x,b]=(0,g.useState)(p),[v,j]=(0,g.useState)(null),[w,y]=(0,g.useState)(null),_=(0,g.useRef)(null),C=(0,g.useRef)(null);let F;e[2]===Symbol.for("react.memo_cache_sentinel")?(F=()=>c(Sl),e[2]=F):F=e[2];const E=F;let M;e[3]===Symbol.for("react.memo_cache_sentinel")?(M=()=>{c(B=>{const le=Math.max(B-.5,1);return le===1&&m({x:0,y:0}),le})},e[3]=M):M=e[3];const N=M;let P;e[4]===Symbol.for("react.memo_cache_sentinel")?(P=()=>{c(1),m({x:0,y:0})},e[4]=P):P=e[4];const L=P;let R;e[5]!==l||e[6]!==r?(R=()=>{l>0&&(L(),r(l-1))},e[5]=l,e[6]=r,e[7]=R):R=e[7];const I=R;let D;e[8]!==l||e[9]!==a?.length||e[10]!==r?(D=()=>{l<(a?.length||0)-1&&(L(),r(l+1))},e[8]=l,e[9]=a?.length,e[10]=r,e[11]=D):D=e[11],a?.length;const S=D;let $;e[12]!==S||e[13]!==I||e[14]!==n?($=()=>{const B=le=>{le.key==="Escape"&&n(),le.key==="ArrowLeft"&&I(),le.key==="ArrowRight"&&S()};return window.addEventListener("keydown",B),()=>window.removeEventListener("keydown",B)},e[12]=S,e[13]=I,e[14]=n,e[15]=$):$=e[15];let q;if(e[16]!==l||e[17]!==S||e[18]!==I||e[19]!==n?(q=[l,n,I,S],e[16]=l,e[17]=S,e[18]=I,e[19]=n,e[20]=q):q=e[20],(0,g.useEffect)($,q),!a||a.length===0)return null;const z=a[l],k=a.length>1;let O;e[21]!==d.x||e[22]!==d.y||e[23]!==o?(O=B=>{o>1&&(h(!0),b({x:B.clientX-d.x,y:B.clientY-d.y}))},e[21]=d.x,e[22]=d.y,e[23]=o,e[24]=O):O=e[24];const U=O;let T;e[25]!==x||e[26]!==f||e[27]!==o?(T=B=>{f&&o>1&&m({x:B.clientX-x.x,y:B.clientY-x.y})},e[25]=x,e[26]=f,e[27]=o,e[28]=T):T=e[28];const W=T;let Q;e[29]===Symbol.for("react.memo_cache_sentinel")?(Q=()=>h(!1),e[29]=Q):Q=e[29];const Z=Q;let ae;e[30]!==d.x||e[31]!==d.y||e[32]!==o?(ae=B=>{B.touches.length===1?(j({x:B.touches[0].clientX,y:B.touches[0].clientY,time:Date.now()}),o>1&&(h(!0),b({x:B.touches[0].clientX-d.x,y:B.touches[0].clientY-d.y}))):B.touches.length===2&&y(Math.hypot(B.touches[0].clientX-B.touches[1].clientX,B.touches[0].clientY-B.touches[1].clientY))},e[30]=d.x,e[31]=d.y,e[32]=o,e[33]=ae):ae=e[33];const ie=ae;let G;e[34]!==x||e[35]!==w||e[36]!==f||e[37]!==o?(G=B=>{if(B.touches.length===1)f&&o>1&&m({x:B.touches[0].clientX-x.x,y:B.touches[0].clientY-x.y});else if(B.touches.length===2&&w){const le=Math.hypot(B.touches[0].clientX-B.touches[1].clientX,B.touches[0].clientY-B.touches[1].clientY);c(Math.min(Math.max(o*(le/w),1),4)),y(le)}},e[34]=x,e[35]=w,e[36]=f,e[37]=o,e[38]=G):G=e[38];const se=G;let ne;e[39]!==S||e[40]!==I||e[41]!==o||e[42]!==v?(ne=B=>{if(B.touches.length<2&&y(null),h(!1),v&&o===1){const le={x:B.changedTouches[0].clientX,y:B.changedTouches[0].clientY},Ce=le.x-v.x,qe=le.y-v.y,Be=Date.now()-v.time;Math.abs(Ce)>50&&Math.abs(qe)<50&&Be<300&&(Ce>0?I():S())}j(null)},e[39]=S,e[40]=I,e[41]=o,e[42]=v,e[43]=ne):ne=e[43];const V=ne;let H;e[44]!==z?(H=B=>{B.stopPropagation();const le=document.createElement("a");le.href=z,le.download=`sysm-${Date.now()}.jpg`,document.body.appendChild(le),le.click(),document.body.removeChild(le)},e[44]=z,e[45]=H):H=e[45];const X=H,ee=k?`${l+1} / ${a.length}`:"Image View";let J;e[46]!==ee?(J=(0,s.jsx)("div",{className:"flex flex-col",children:(0,s.jsx)("span",{className:"text-white font-bold text-lg drop-shadow-md",children:ee})}),e[46]=ee,e[47]=J):J=e[47];let ce;e[48]===Symbol.for("react.memo_cache_sentinel")?(ce=(0,s.jsx)("button",{onClick:N,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors hidden sm:block",children:(0,s.jsx)(Fi,{size:20})}),e[48]=ce):ce=e[48];let te;e[49]===Symbol.for("react.memo_cache_sentinel")?(te=(0,s.jsx)("button",{onClick:E,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors hidden sm:block",children:(0,s.jsx)(ji,{size:20})}),e[49]=te):te=e[49];let de;e[50]===Symbol.for("react.memo_cache_sentinel")?(de=(0,s.jsx)("button",{onClick:L,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors",children:(0,s.jsx)(Ha,{size:20})}),e[50]=de):de=e[50];let fe;e[51]===Symbol.for("react.memo_cache_sentinel")?(fe=(0,s.jsx)(Ts,{size:20}),e[51]=fe):fe=e[51];let ve;e[52]!==X?(ve=(0,s.jsx)("button",{onClick:X,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors",children:fe}),e[52]=X,e[53]=ve):ve=e[53];let Ze;e[54]===Symbol.for("react.memo_cache_sentinel")?(Ze=(0,s.jsx)("div",{className:"w-px h-6 bg-white/20 mx-1 hidden sm:block"}),e[54]=Ze):Ze=e[54];let He;e[55]===Symbol.for("react.memo_cache_sentinel")?(He=(0,s.jsx)(_e,{size:24}),e[55]=He):He=e[55];let Fe;e[56]!==n?(Fe=(0,s.jsx)("button",{onClick:n,className:"text-white p-2 bg-white/10 hover:bg-white/20 rounded-full transition-all",children:He}),e[56]=n,e[57]=Fe):Fe=e[57];let Ae;e[58]!==ve||e[59]!==Fe?(Ae=(0,s.jsxs)("div",{className:"flex items-center gap-1 sm:gap-3",onClick:$l,children:[ce,te,de,ve,Ze,Fe]}),e[58]=ve,e[59]=Fe,e[60]=Ae):Ae=e[60];let Re;e[61]!==J||e[62]!==Ae?(Re=(0,s.jsxs)("div",{className:"absolute top-0 left-0 right-0 p-4 z-20 flex items-center justify-between bg-gradient-to-b from-black/60 to-transparent",children:[J,Ae]}),e[61]=J,e[62]=Ae,e[63]=Re):Re=e[63];let ye;e[64]!==l||e[65]!==I||e[66]!==k||e[67]!==o?(ye=k&&l>0&&o===1&&(0,s.jsx)("button",{onClick:B=>{B.stopPropagation(),I()},className:"absolute left-6 z-10 p-4 bg-white/5 hover:bg-white/10 rounded-full text-white backdrop-blur-sm transition-all active:scale-90 hidden md:flex",children:(0,s.jsx)(Bs,{size:32})}),e[64]=l,e[65]=I,e[66]=k,e[67]=o,e[68]=ye):ye=e[68];const nt=`translate(${d.x}px, ${d.y}px) scale(${o})`;let Oe;e[69]!==nt?(Oe={transform:nt},e[69]=nt,e[70]=Oe):Oe=e[70];let Le;e[71]!==z?(Le=(0,s.jsx)("img",{ref:C,src:z,className:"max-w-[95vw] max-h-[85vh] object-contain select-none shadow-2xl rounded-sm",alt:"",draggable:!1}),e[71]=z,e[72]=Le):Le=e[72];let Ie;e[73]!==U||e[74]!==Oe||e[75]!==Le?(Ie=(0,s.jsx)("div",{className:"relative transition-transform duration-200 ease-out cursor-grab active:cursor-grabbing",style:Oe,onMouseDown:U,onClick:Pl,children:Le}),e[73]=U,e[74]=Oe,e[75]=Le,e[76]=Ie):Ie=e[76];let Ee;e[77]!==l||e[78]!==S||e[79]!==k||e[80]!==a.length||e[81]!==o?(Ee=k&&l<a.length-1&&o===1&&(0,s.jsx)("button",{onClick:B=>{B.stopPropagation(),S()},className:"absolute right-6 z-10 p-4 bg-white/5 hover:bg-white/10 rounded-full text-white backdrop-blur-sm transition-all active:scale-90 hidden md:flex",children:(0,s.jsx)(Qe,{size:32})}),e[77]=l,e[78]=S,e[79]=k,e[80]=a.length,e[81]=o,e[82]=Ee):Ee=e[82];let Te;e[83]!==ye||e[84]!==Ie||e[85]!==Ee?(Te=(0,s.jsxs)("div",{className:"w-full h-full relative flex items-center justify-center",children:[ye,Ie,Ee]}),e[83]=ye,e[84]=Ie,e[85]=Ee,e[86]=Te):Te=e[86];let We;e[87]!==l||e[88]!==k||e[89]!==a||e[90]!==r?(We=k&&(0,s.jsx)("div",{className:"absolute bottom-8 flex gap-3 p-3 bg-black/40 backdrop-blur-xl rounded-2xl border border-white/10 overflow-x-auto max-w-[90%] hide-scrollbar",onClick:Ml,children:a.map((B,le)=>(0,s.jsx)("button",{onClick:()=>{L(),r(le)},className:`size-14 rounded-xl overflow-hidden border-2 transition-all shrink-0 ${le===l?"border-violet-500 scale-110 shadow-lg shadow-violet-500/20":"border-transparent opacity-40 hover:opacity-100"}`,children:(0,s.jsx)("img",{src:B,className:"size-full object-cover",alt:""})},le))}),e[87]=l,e[88]=k,e[89]=a,e[90]=r,e[91]=We):We=e[91];let Y;e[92]!==k||e[93]!==o?(Y=o===1&&k&&(0,s.jsx)("div",{className:"absolute bottom-4 text-white/30 text-[10px] uppercase tracking-widest font-bold md:hidden",children:"Swipe to navigate"}),e[92]=k,e[93]=o,e[94]=Y):Y=e[94];let re;return e[95]!==W||e[96]!==V||e[97]!==se||e[98]!==ie||e[99]!==n||e[100]!==Re||e[101]!==Te||e[102]!==We||e[103]!==Y?(re=(0,s.jsxs)("div",{ref:_,className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-md flex flex-col items-center justify-center overflow-hidden touch-none",onMouseMove:W,onMouseUp:Z,onMouseLeave:Z,onTouchStart:ie,onTouchMove:se,onTouchEnd:V,onClick:n,children:[Re,Te,We,Y]}),e[95]=W,e[96]=V,e[97]=se,e[98]=ie,e[99]=n,e[100]=Re,e[101]=Te,e[102]=We,e[103]=Y,e[104]=re):re=e[104],re},Cl=_l;function Sl(t){return Math.min(t+.5,4)}function $l(t){return t.stopPropagation()}function Pl(t){return t.stopPropagation()}function Ml(t){return t.stopPropagation()}var Fl=K(),fa=g.forwardRef((t,e)=>{const a=(0,Fl.c)(20);let i,n,r,l,o;a[0]!==t?({className:i,label:n,type:o,textarea:l,...r}=t,a[0]=t,a[1]=i,a[2]=n,a[3]=r,a[4]=l,a[5]=o):(i=a[1],n=a[2],r=a[3],l=a[4],o=a[5]);const c=l?"textarea":"input";let u;a[6]!==n?(u=n&&(0,s.jsx)("label",{className:"text-sm font-bold text-zinc-500 dark:text-zinc-400 ml-1",children:n}),a[6]=n,a[7]=u):u=a[7];const d=l&&"min-h-[100px] resize-none";let m;a[8]!==i||a[9]!==d?(m=oe("flex w-full rounded-xl border border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900 px-4 py-2.5 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-zinc-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:ring-offset-zinc-950 dark:text-white transition-all",d,i),a[8]=i,a[9]=d,a[10]=m):m=a[10];let f;a[11]!==c||a[12]!==r||a[13]!==e||a[14]!==m||a[15]!==o?(f=(0,s.jsx)(c,{type:o,className:m,ref:e,...r}),a[11]=c,a[12]=r,a[13]=e,a[14]=m,a[15]=o,a[16]=f):f=a[16];let h;return a[17]!==u||a[18]!==f?(h=(0,s.jsxs)("div",{className:"w-full space-y-1.5",children:[u,f]}),a[17]=u,a[18]=f,a[19]=h):h=a[19],h});fa.displayName="Input";var Se=fa,Rl=K(),Ll=t=>{const e=(0,Rl.c)(20),{isOpen:a,onClose:i,title:n,children:r,footer:l,description:o,className:c}=t;let u;e[0]!==i?(u=v=>{v||i()},e[0]=i,e[1]=u):u=e[1];const d=u;let m;e[2]!==c?(m=oe("sm:max-w-md max-h-[calc(100dvh-2rem)] flex flex-col p-0 gap-0 overflow-hidden bg-white dark:bg-zinc-900",c),e[2]=c,e[3]=m):m=e[3];let f;e[4]!==o||e[5]!==n?(f=n&&(0,s.jsxs)(la,{className:"px-5 py-4 shrink-0",children:[(0,s.jsx)(ca,{className:"text-xl font-bold",children:n}),o&&(0,s.jsx)(fl,{children:o})]}),e[4]=o,e[5]=n,e[6]=f):f=e[6];let h;e[7]!==r?(h=(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-5 min-h-0",children:r}),e[7]=r,e[8]=h):h=e[8];let p;e[9]!==l?(p=l&&(0,s.jsx)(oa,{className:"px-5 py-4 shrink-0 bg-white dark:bg-zinc-900",children:l}),e[9]=l,e[10]=p):p=e[10];let x;e[11]!==m||e[12]!==f||e[13]!==h||e[14]!==p?(x=(0,s.jsxs)(ra,{className:m,children:[f,h,p]}),e[11]=m,e[12]=f,e[13]=h,e[14]=p,e[15]=x):x=e[15];let b;return e[16]!==d||e[17]!==a||e[18]!==x?(b=(0,s.jsx)(na,{open:a,onOpenChange:d,children:x}),e[16]=d,e[17]=a,e[18]=x,e[19]=b):b=e[19],b},it=Ll,Il=K(),El=t=>{const e=(0,Il.c)(20),{title:a,message:i,icon:n,showHome:r,showBack:l}=t,o=a===void 0?"Not Found":a,c=i===void 0?"The content you are looking for doesn't exist or has been removed.":i,u=n===void 0?$s:n,d=r===void 0?!0:r,m=l===void 0?!0:l,f=ge(),h=u;let p;e[0]!==h?(p=(0,s.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-900 p-6 rounded-full mb-6",children:(0,s.jsx)(h,{size:48,className:"text-zinc-400 dark:text-zinc-600"})}),e[0]=h,e[1]=p):p=e[1];let x;e[2]!==o?(x=(0,s.jsx)("h2",{className:"text-2xl font-black mb-2 dark:text-white",children:o}),e[2]=o,e[3]=x):x=e[3];let b;e[4]!==c?(b=(0,s.jsx)("p",{className:"text-zinc-500 dark:text-zinc-400 max-w-xs mb-8 leading-relaxed",children:c}),e[4]=c,e[5]=b):b=e[5];let v;e[6]!==f||e[7]!==m?(v=m&&(0,s.jsxs)(ue,{variant:"secondary",onClick:()=>f(-1),className:"rounded-full px-6",children:[(0,s.jsx)(tt,{size:18,className:"mr-2"}),"Go Back"]}),e[6]=f,e[7]=m,e[8]=v):v=e[8];let j;e[9]!==f||e[10]!==d?(j=d&&(0,s.jsxs)(ue,{onClick:()=>f("/"),className:"bg-zinc-900 dark:bg-white text-white dark:text-zinc-900 rounded-full px-6",children:[(0,s.jsx)(Dt,{size:18,className:"mr-2"}),"Home"]}),e[9]=f,e[10]=d,e[11]=j):j=e[11];let w;e[12]!==j||e[13]!==v?(w=(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-center gap-3",children:[v,j]}),e[12]=j,e[13]=v,e[14]=w):w=e[14];let y;return e[15]!==w||e[16]!==p||e[17]!==x||e[18]!==b?(y=(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[400px] p-8 text-center animate-in fade-in zoom-in-95 duration-300",children:[p,x,b,w]}),e[15]=w,e[16]=p,e[17]=x,e[18]=b,e[19]=y):y=e[19],y},Ut=El,Vt=K();function xa(t){const e=(0,Vt.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(Za,{"data-slot":"popover",...a}),e[2]=a,e[3]=i):i=e[3],i}function ha(t){const e=(0,Vt.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(si,{"data-slot":"popover-trigger",...a}),e[2]=a,e[3]=i):i=e[3],i}function pa(t){const e=(0,Vt.c)(12);let a,i,n,r;e[0]!==t?({className:a,align:n,sideOffset:r,...i}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n,e[4]=r):(a=e[1],i=e[2],n=e[3],r=e[4]);const l=n===void 0?"center":n,o=r===void 0?4:r;let c;e[5]!==a?(c=oe("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 rounded-md border p-4 shadow-md outline-hidden",a),e[5]=a,e[6]=c):c=e[6];let u;return e[7]!==l||e[8]!==i||e[9]!==o||e[10]!==c?(u=(0,s.jsx)(Ya,{children:(0,s.jsx)(Ei,{"data-slot":"popover-content",align:l,sideOffset:o,className:c,...i})}),e[7]=l,e[8]=i,e[9]=o,e[10]=c,e[11]=u):u=e[11],u}var Tl=K(),ql=()=>{const t=(0,Tl.c)(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,s.jsx)(qa,{size:16,className:"fill-blue-500 text-white ml-1 inline-block shrink-0"}),t[0]=e):e=t[0],e},lt=ql;const ba=(t,e,a)=>{const i=t?.id,[n,r]=(0,g.useState)(!1),[l,o]=(0,g.useState)({followers:t?.followers||t?.follower_count||0,following:t?.following||t?.following_count||0}),[c,u]=(0,g.useState)(!1);return(0,g.useEffect)(()=>{t&&(o({followers:t.followers||t.follower_count||0,following:t.following||t.following_count||0}),i&&ke(i)&&(Sn(i).then(m=>{m&&o({followers:m.followers,following:m.following})}).catch(()=>{}),e&&ke(e)&&kn(e,i).then(r).catch(()=>r(!1))))},[t,i,e]),{isFollowing:n,stats:l,loading:c,handleFollow:async()=>{if(!e)return a("Please login to follow!","error");if(e===i)return a("You cannot follow yourself!","error");if(!i||!ke(i)||!ke(e)){const m=!n;r(m),o(f=>{const h=typeof f.followers=="string"?parseInt(f.followers.replace(/,/g,"")):f.followers||0;return{...f,followers:m?h+1:Math.max(0,h-1)}}),a(m?"Followed":"Unfollowed");return}u(!0);try{const m=await Nn(e,i);r(m),o(f=>({...f,followers:m?(f.followers||0)+1:Math.max(0,(f.followers||0)-1)})),a(m?"Followed":"Unfollowed")}catch(m){console.error("Failed to toggle follow:",m),a("Failed to update follow status","error")}finally{u(!1)}},setStats:o}};var Dl=({profile:t,onUserClick:e,isCommunity:a=!1})=>{const{onlineUsers:i}=Gs(),{currentUser:n}=be(),{addToast:r}=we(),l=i.has(t.id),[o,c]=(0,g.useState)(!1),[u,d]=(0,g.useState)(a),{isFollowing:m,loading:f,handleFollow:h}=ba(a?null:t,n?.id,r);(0,g.useEffect)(()=>{a&&n&&t.id?Ks(t.id,n.id).then(c).finally(()=>d(!1)):d(!1)},[a,n,t.id]);const p=async v=>{if(v.stopPropagation(),!n)return r("Please login to join communities","error");d(!0);try{const j=await Qs(t.id,n.id);c(j),r(j?`Joined ${t.name}`:`Left ${t.name}`)}catch{r("Failed to update membership","error")}finally{d(!1)}},x=n?.id===t.id,b=a?u:f;return(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-zinc-100 dark:border-zinc-800 hover:bg-zinc-50 dark:hover:bg-zinc-900/40 transition-colors group cursor-pointer",onClick:()=>e(t.handle),children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)(xe,{className:`size-12 border border-zinc-200 dark:border-zinc-800 shadow-sm ${a?"rounded-2xl":""}`,children:[(0,s.jsx)(he,{src:t.avatar,alt:t.handle,className:"object-cover"}),(0,s.jsx)(pe,{className:a?"rounded-2xl":"",children:t.handle?.[0]?.toUpperCase()})]}),l&&!a&&(0,s.jsx)("span",{className:"absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full shadow-sm"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white leading-none",children:t.name}),t.verified&&(0,s.jsx)(lt,{})]}),(0,s.jsxs)("span",{className:"text-sm text-zinc-500 mt-0.5",children:["@",t.handle]}),a&&(0,s.jsxs)("span",{className:"text-xs text-zinc-400 mt-1",children:[t.membersCount||0," members"]}),!a&&t.followers&&(0,s.jsxs)("span",{className:"text-xs text-zinc-400 mt-1",children:[t.followers," followers"]})]})]}),!x&&(0,s.jsx)(ue,{variant:a?o?"secondary":"outline":m?"secondary":"outline",className:"!w-auto !py-1.5 !px-4 text-sm font-bold rounded-full border-zinc-200 dark:border-zinc-700 hover:bg-zinc-100 dark:hover:bg-zinc-800",onClick:a?p:v=>{v.stopPropagation(),h()},disabled:b,children:b?(0,s.jsx)(me,{size:14,className:"animate-spin"}):a?o?"Joined":"Join":m?"Following":"Follow"})]})},ga=Dl,va=K();function ls(t){const e=(0,va.c)(14);let a,i,n;e[0]!==t?({className:i,children:a,...n}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n):(a=e[1],i=e[2],n=e[3]);let r;e[4]!==i?(r=oe("relative",i),e[4]=i,e[5]=r):r=e[5];let l;e[6]!==a?(l=(0,s.jsx)(Fa,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:a}),e[6]=a,e[7]=l):l=e[7];let o,c;e[8]===Symbol.for("react.memo_cache_sentinel")?(o=(0,s.jsx)(Tt,{}),c=(0,s.jsx)(Ta,{}),e[8]=o,e[9]=c):(o=e[8],c=e[9]);let u;return e[10]!==n||e[11]!==r||e[12]!==l?(u=(0,s.jsxs)(Ea,{"data-slot":"scroll-area",className:r,...n,children:[l,o,c]}),e[10]=n,e[11]=r,e[12]=l,e[13]=u):u=e[13],u}function Tt(t){const e=(0,va.c)(13);let a,i,n;e[0]!==t?({className:a,orientation:n,...i}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n):(a=e[1],i=e[2],n=e[3]);const r=n===void 0?"vertical":n,l=r==="vertical"&&"h-full w-2.5 border-l border-l-transparent",o=r==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent";let c;e[4]!==a||e[5]!==l||e[6]!==o?(c=oe("flex touch-none p-px transition-colors select-none",l,o,a),e[4]=a,e[5]=l,e[6]=o,e[7]=c):c=e[7];let u;e[8]===Symbol.for("react.memo_cache_sentinel")?(u=(0,s.jsx)(Ti,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"}),e[8]=u):u=e[8];let d;return e[9]!==r||e[10]!==i||e[11]!==c?(d=(0,s.jsx)(ti,{"data-slot":"scroll-area-scrollbar",orientation:r,className:c,...i,children:u}),e[9]=r,e[10]=i,e[11]=c,e[12]=d):d=e[12],d}var Al=K(),Ol=t=>{const e=(0,Al.c)(13),{value:a,onChange:i,onClear:n,placeholder:r}=t,l=r===void 0?"Search...":r;let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=(0,s.jsx)(gs,{size:18,className:"absolute left-4 top-1/2 -translate-y-1/2 text-zinc-400 group-focus-within:text-violet-500 transition-colors"}),e[0]=o):o=e[0];let c;e[1]!==i?(c=f=>i(f.target.value),e[1]=i,e[2]=c):c=e[2];let u;e[3]!==l||e[4]!==c||e[5]!==a?(u=(0,s.jsx)("input",{className:"w-full rounded-full border border-zinc-100 dark:border-zinc-800 bg-zinc-50 dark:bg-zinc-900/50 text-zinc-900 dark:text-white px-11 py-2.5 text-sm outline-none focus:border-violet-500 focus:ring-1 focus:ring-violet-500 transition-all",placeholder:l,value:a,onChange:c}),e[3]=l,e[4]=c,e[5]=a,e[6]=u):u=e[6];let d;e[7]!==n||e[8]!==a?(d=a&&(0,s.jsx)("button",{onClick:n,className:"absolute right-4 top-1/2 -translate-y-1/2 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 transition-colors",children:(0,s.jsx)(_e,{size:16})}),e[7]=n,e[8]=a,e[9]=d):d=e[9];let m;return e[10]!==u||e[11]!==d?(m=(0,s.jsxs)("div",{className:"relative group w-full",children:[o,u,d]}),e[10]=u,e[11]=d,e[12]=m):m=e[12],m},jt=Ol,Ge=K(),Wl=dn;var Bl=on,ja=g.forwardRef((t,e)=>{const a=(0,Ge.c)(12);let i,n,r;a[0]!==t?({className:n,children:i,...r}=t,a[0]=t,a[1]=i,a[2]=n,a[3]=r):(i=a[1],n=a[2],r=a[3]);let l;a[4]!==n?(l=oe("flex h-9 w-full items-center justify-between rounded-md border border-zinc-200 bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-white placeholder:text-zinc-500 focus:outline-none focus:ring-1 focus:ring-zinc-950 disabled:cursor-not-allowed disabled:opacity-50 dark:border-zinc-800 dark:ring-offset-zinc-950 dark:focus:ring-zinc-300 [&>span]:line-clamp-1",n),a[4]=n,a[5]=l):l=a[5];let o;a[6]===Symbol.for("react.memo_cache_sentinel")?(o=(0,s.jsx)(Qi,{asChild:!0,children:(0,s.jsx)(Cs,{className:"h-4 w-4 opacity-50"})}),a[6]=o):o=a[6];let c;return a[7]!==i||a[8]!==r||a[9]!==e||a[10]!==l?(c=(0,s.jsxs)(hs,{ref:e,className:l,...r,children:[i,o]}),a[7]=i,a[8]=r,a[9]=e,a[10]=l,a[11]=c):c=a[11],c});ja.displayName=hs.displayName;var wa=g.forwardRef((t,e)=>{const a=(0,Ge.c)(10);let i,n;a[0]!==t?({className:i,...n}=t,a[0]=t,a[1]=i,a[2]=n):(i=a[1],n=a[2]);let r;a[3]!==i?(r=oe("flex cursor-default items-center justify-center py-1",i),a[3]=i,a[4]=r):r=a[4];let l;a[5]===Symbol.for("react.memo_cache_sentinel")?(l=(0,s.jsx)(vi,{className:"h-4 w-4"}),a[5]=l):l=a[5];let o;return a[6]!==n||a[7]!==e||a[8]!==r?(o=(0,s.jsx)(Os,{ref:e,className:r,...n,children:l}),a[6]=n,a[7]=e,a[8]=r,a[9]=o):o=a[9],o});wa.displayName=Os.displayName;var ya=g.forwardRef((t,e)=>{const a=(0,Ge.c)(10);let i,n;a[0]!==t?({className:i,...n}=t,a[0]=t,a[1]=i,a[2]=n):(i=a[1],n=a[2]);let r;a[3]!==i?(r=oe("flex cursor-default items-center justify-center py-1",i),a[3]=i,a[4]=r):r=a[4];let l;a[5]===Symbol.for("react.memo_cache_sentinel")?(l=(0,s.jsx)(Cs,{className:"h-4 w-4"}),a[5]=l):l=a[5];let o;return a[6]!==n||a[7]!==e||a[8]!==r?(o=(0,s.jsx)(_s,{ref:e,className:r,...n,children:l}),a[6]=n,a[7]=e,a[8]=r,a[9]=o):o=a[9],o});ya.displayName=_s.displayName;var za=g.forwardRef((t,e)=>{const a=(0,Ge.c)(21);let i,n,r,l;a[0]!==t?({className:n,children:i,position:l,...r}=t,a[0]=t,a[1]=i,a[2]=n,a[3]=r,a[4]=l):(i=a[1],n=a[2],r=a[3],l=a[4]);const o=l===void 0?"popper":l,c=o==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1";let u;a[5]!==n||a[6]!==c?(u=oe("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-zinc-200 bg-white text-zinc-950 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-zinc-800 dark:bg-zinc-950 dark:text-zinc-50",c,n),a[5]=n,a[6]=c,a[7]=u):u=a[7];let d;a[8]===Symbol.for("react.memo_cache_sentinel")?(d=(0,s.jsx)(wa,{}),a[8]=d):d=a[8];const m=o==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]";let f;a[9]!==m?(f=oe("p-1",m),a[9]=m,a[10]=f):f=a[10];let h;a[11]!==i||a[12]!==f?(h=(0,s.jsx)(oi,{className:f,children:i}),a[11]=i,a[12]=f,a[13]=h):h=a[13];let p;a[14]===Symbol.for("react.memo_cache_sentinel")?(p=(0,s.jsx)(ya,{}),a[14]=p):p=a[14];let x;return a[15]!==o||a[16]!==r||a[17]!==e||a[18]!==u||a[19]!==h?(x=(0,s.jsx)(ln,{children:(0,s.jsxs)(Ss,{ref:e,className:u,position:o,...r,children:[d,h,p]})}),a[15]=o,a[16]=r,a[17]=e,a[18]=u,a[19]=h,a[20]=x):x=a[20],x});za.displayName=Ss.displayName;var Ul=g.forwardRef((t,e)=>{const a=(0,Ge.c)(9);let i,n;a[0]!==t?({className:i,...n}=t,a[0]=t,a[1]=i,a[2]=n):(i=a[1],n=a[2]);let r;a[3]!==i?(r=oe("px-2 py-1.5 text-sm font-semibold",i),a[3]=i,a[4]=r):r=a[4];let l;return a[5]!==n||a[6]!==e||a[7]!==r?(l=(0,s.jsx)(ks,{ref:e,className:r,...n}),a[5]=n,a[6]=e,a[7]=r,a[8]=l):l=a[8],l});Ul.displayName=ks.displayName;var bt=g.forwardRef((t,e)=>{const a=(0,Ge.c)(14);let i,n,r;a[0]!==t?({className:n,children:i,...r}=t,a[0]=t,a[1]=i,a[2]=n,a[3]=r):(i=a[1],n=a[2],r=a[3]);let l;a[4]!==n?(l=oe("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-zinc-100 focus:text-zinc-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-zinc-800 dark:focus:text-zinc-50",n),a[4]=n,a[5]=l):l=a[5];let o;a[6]===Symbol.for("react.memo_cache_sentinel")?(o=(0,s.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(Ri,{children:(0,s.jsx)(Ws,{className:"h-4 w-4"})})}),a[6]=o):o=a[6];let c;a[7]!==i?(c=(0,s.jsx)(Mi,{children:i}),a[7]=i,a[8]=c):c=a[8];let u;return a[9]!==r||a[10]!==e||a[11]!==l||a[12]!==c?(u=(0,s.jsxs)(Is,{ref:e,className:l,...r,children:[o,c]}),a[9]=r,a[10]=e,a[11]=l,a[12]=c,a[13]=u):u=a[13],u});bt.displayName=Is.displayName;var Vl=g.forwardRef((t,e)=>{const a=(0,Ge.c)(9);let i,n;a[0]!==t?({className:i,...n}=t,a[0]=t,a[1]=i,a[2]=n):(i=a[1],n=a[2]);let r;a[3]!==i?(r=oe("-mx-1 my-1 h-px bg-zinc-100 dark:bg-zinc-800",i),a[3]=i,a[4]=r):r=a[4];let l;return a[5]!==n||a[6]!==e||a[7]!==r?(l=(0,s.jsx)(ys,{ref:e,className:r,...n}),a[5]=n,a[6]=e,a[7]=r,a[8]=l):l=a[8],l});Vl.displayName=ys.displayName;var Hl=K(),Jl=t=>{const e=(0,Hl.c)(9),{className:a}=t,{setAuthMode:i}=be();let n;e[0]!==a?(n=oe("border border-[--border] rounded-2xl p-8 flex flex-col items-center text-center gap-4 bg-[--card] shadow-sm",a),e[0]=a,e[1]=n):n=e[1];let r,l;e[2]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"size-16 rounded-full border-4 border-amber-400 border-t-transparent animate-spin duration-[3000ms]"}),(0,s.jsx)("span",{className:"absolute inset-0 flex items-center justify-center text-2xl",children:""})]}),l=(0,s.jsx)("h3",{className:"font-extrabold text-lg text-[--foreground] mt-2 leading-tight",children:"Get your Sysm account now!"}),e[2]=r,e[3]=l):(r=e[2],l=e[3]);let o;e[4]!==i?(o=(0,s.jsx)("button",{onClick:()=>i("signup"),className:"w-full bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 py-2.5 rounded-full font-black text-sm uppercase tracking-wider hover:opacity-90 active:scale-95 transition-all shadow-lg cursor-pointer",children:"Signup now"}),e[4]=i,e[5]=o):o=e[5];let c;return e[6]!==n||e[7]!==o?(c=(0,s.jsxs)("div",{className:n,children:[r,l,o]}),e[6]=n,e[7]=o,e[8]=c):c=e[8],c},Na=Jl,Ql=K(),Kl=()=>{const t=(0,Ql.c)(3);let e;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,s.jsx)("div",{className:"size-11 rounded-full bg-zinc-200 dark:bg-zinc-800 shrink-0"}),t[0]=e):e=t[0];let a;t[1]===Symbol.for("react.memo_cache_sentinel")?(a=(0,s.jsx)("div",{className:"h-4 bg-zinc-200 dark:bg-zinc-800 rounded w-1/3"}),t[1]=a):a=t[1];let i;return t[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsx)("div",{className:"px-5 pt-4 pb-3 border-b border-zinc-100 dark:border-zinc-800 animate-pulse",children:(0,s.jsxs)("div",{className:"flex items-start gap-x-3",children:[e,(0,s.jsxs)("div",{className:"flex-1 space-y-3",children:[a,(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"h-3 bg-zinc-200 dark:bg-zinc-800 rounded w-full"}),(0,s.jsx)("div",{className:"h-3 bg-zinc-200 dark:bg-zinc-800 rounded w-5/6"})]}),(0,s.jsx)("div",{className:"h-48 bg-zinc-200 dark:bg-zinc-800 rounded-xl w-full"})]})]})}),t[2]=i):i=t[2],i},Ht=Kl,_t=K();function ka(t){const e=(0,_t.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=oe("flex flex-col gap-2",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(Di,{"data-slot":"tabs",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function _a(t){const e=(0,_t.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=oe("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(yi,{"data-slot":"tabs-list",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function qt(t){const e=(0,_t.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=oe("inline-flex items-center justify-center gap-1.5 px-2 py-1 text-sm font-medium whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 outline-none focus:outline-none focus-visible:outline-none ring-0 focus:ring-0 focus-visible:ring-0 shadow-none data-[state=active]:shadow-none",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(an,{"data-slot":"tabs-trigger",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function Mt(t){const e=(0,_t.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=oe("flex-1 outline-none",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(Zi,{"data-slot":"tabs-content",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var Xl=K();function Yl(t){const e=(0,Xl.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=oe("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)("textarea",{"data-slot":"textarea",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var Gl=K(),Zl=t=>{const e=(0,Gl.c)(7),{className:a}=t;let i;e[0]!==a?(i=oe("flex items-center gap-1 px-1 py-1.5",a),e[0]=a,e[1]=i):i=e[1];let n,r,l;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,s.jsx)("div",{className:"size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse"}),r=(0,s.jsx)("div",{className:"size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse [animation-delay:0.2s]"}),l=(0,s.jsx)("div",{className:"size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse [animation-delay:0.4s]"}),e[2]=n,e[3]=r,e[4]=l):(n=e[2],r=e[3],l=e[4]);let o;return e[5]!==i?(o=(0,s.jsxs)("div",{className:i,children:[n,r,l]}),e[5]=i,e[6]=o):o=e[6],o},eo=Zl,to=K(),so=()=>{const t=(0,to.c)(48),{currentUser:e,setAuthMode:a}=be(),{darkMode:i,toggleDarkMode:n}=mt(),[r,l]=(0,g.useState)(""),o=ge();let c;t[0]===Symbol.for("react.memo_cache_sentinel")?(c={queryKey:["trending-hashtags"],queryFn:io,refetchInterval:6e4},t[0]=c):c=t[0];const{data:u}=$e(c);let d;t[1]!==u?(d=u===void 0?[]:u,t[1]=u,t[2]=d):d=t[2];const m=d;let f;t[3]===Symbol.for("react.memo_cache_sentinel")?(f=[" 2026 Sysm","Terms","Privacy","Guidelines","Discord","Sysm","GitHub","Support","Status"],t[3]=f):f=t[3];const h=f;let p;t[4]!==i?(p=i?(0,s.jsx)(js,{size:20}):(0,s.jsx)(Ns,{size:20}),t[4]=i,t[5]=p):p=t[5];let x;t[6]!==p||t[7]!==n?(x=(0,s.jsx)("button",{onClick:n,className:"p-3 rounded-full bg-zinc-50 dark:bg-zinc-900 text-zinc-500 dark:text-zinc-400 border border-zinc-100 dark:border-zinc-800 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-all cursor-pointer",title:"Toggle Theme",children:p}),t[6]=p,t[7]=n,t[8]=x):x=t[8];const b=x;if(e){let P;t[9]===Symbol.for("react.memo_cache_sentinel")?(P=()=>l(""),t[9]=P):P=t[9];let L;t[10]!==r?(L=(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(jt,{value:r,onChange:l,onClear:P})}),t[10]=r,t[11]=L):L=t[11];let R;t[12]!==L||t[13]!==b?(R=(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[L,b]}),t[12]=L,t[13]=b,t[14]=R):R=t[14];let I;t[15]===Symbol.for("react.memo_cache_sentinel")?(I=(0,s.jsx)("h3",{className:"font-extrabold text-xl mb-4 px-2 text-[--foreground]",children:"What's happening"}),t[15]=I):I=t[15];let D;if(t[16]!==o||t[17]!==m){let k;t[19]!==o?(k=O=>(0,s.jsxs)("div",{onClick:()=>o(`/community?q=${encodeURIComponent(O.name)}`),className:"px-3 py-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-xl cursor-pointer transition-colors group",children:[(0,s.jsx)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400 font-medium",children:"Trending"}),(0,s.jsx)("div",{className:"font-bold text-[--foreground]",children:O.name}),(0,s.jsxs)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:[O.usage_count," posts"]})]},O.id),t[19]=o,t[20]=k):k=t[20],D=m.map(k),t[16]=o,t[17]=m,t[18]=D}else D=t[18];let S;t[21]!==m.length?(S=m.length===0&&(0,s.jsx)("p",{className:"text-sm text-zinc-500 px-2",children:"No trends yet"}),t[21]=m.length,t[22]=S):S=t[22];let $;t[23]!==D||t[24]!==S?($=(0,s.jsxs)("div",{className:"bg-zinc-50 dark:bg-zinc-900 rounded-2xl p-4 border border-[--border]",children:[I,(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[D,S]})]}),t[23]=D,t[24]=S,t[25]=$):$=t[25];let q;t[26]===Symbol.for("react.memo_cache_sentinel")?(q=(0,s.jsx)("div",{className:"flex flex-wrap gap-x-4 gap-y-2 px-2 text-[13px] text-zinc-500 font-medium pb-5",children:h.map(no)}),t[26]=q):q=t[26];let z;return t[27]!==$||t[28]!==R?(z=(0,s.jsxs)("aside",{className:"sticky top-5 hidden w-[320px] shrink-0 flex-col gap-y-6 lg:flex overflow-y-auto max-h-screen",children:[R,$,q]}),t[27]=$,t[28]=R,t[29]=z):z=t[29],z}let v,j;t[30]!==a?(v=(0,s.jsx)("button",{onClick:()=>a("signup"),className:"flex-1 bg-[--card] border border-[--border] py-2.5 rounded-full font-bold text-[--foreground] hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors shadow-sm cursor-pointer",children:"Signup"}),j=()=>a("login"),t[30]=a,t[31]=v,t[32]=j):(v=t[31],j=t[32]);let w;t[33]===Symbol.for("react.memo_cache_sentinel")?(w=(0,s.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",alt:"",className:"size-4 rounded-sm"}),t[33]=w):w=t[33];let y;t[34]!==j?(y=(0,s.jsxs)("button",{onClick:j,className:"flex-1 bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 py-2.5 rounded-full font-bold flex items-center justify-center gap-2 hover:opacity-90 transition-opacity cursor-pointer",children:[w,"Login"]}),t[34]=j,t[35]=y):y=t[35];let _;t[36]!==v||t[37]!==y||t[38]!==b?(_=(0,s.jsxs)("div",{className:"flex gap-3",children:[v,y,b]}),t[36]=v,t[37]=y,t[38]=b,t[39]=_):_=t[39];let C;t[40]===Symbol.for("react.memo_cache_sentinel")?(C=()=>l(""),t[40]=C):C=t[40];let F;t[41]!==r?(F=(0,s.jsx)(jt,{value:r,onChange:l,onClear:C}),t[41]=r,t[42]=F):F=t[42];let E;t[43]===Symbol.for("react.memo_cache_sentinel")?(E=(0,s.jsx)(Na,{}),t[43]=E):E=t[43];let M;t[44]===Symbol.for("react.memo_cache_sentinel")?(M=(0,s.jsx)("div",{className:"flex flex-wrap gap-x-4 gap-y-2 px-2 text-[13px] text-zinc-500 font-medium pb-5",children:h.map(ro)}),t[44]=M):M=t[44];let N;return t[45]!==_||t[46]!==F?(N=(0,s.jsxs)("aside",{className:"sticky top-5 hidden w-[350px] shrink-0 flex-col gap-y-6 lg:flex pr-4",children:[_,F,E,M]}),t[45]=_,t[46]=F,t[47]=N):N=t[47],N},ao=so;function io(){return cr(5)}function no(t){return(0,s.jsx)("a",{href:"#",className:"hover:underline",children:t},t)}function ro(t){return(0,s.jsx)("a",{href:"#",className:"hover:underline",children:t},t)}var Nd=K(),lo=({isOpen:t,onClose:e})=>{const{currentUser:a}=be(),{addToast:i}=we(),n=ge(),[r,l]=(0,g.useState)({name:"",handle:"",description:"",isPrivate:!1}),[o,c]=(0,g.useState)(!1),u=async d=>{if(d.preventDefault(),!(!r.name||!r.handle||!a)){c(!0);try{const m=await nr({name:r.name,handle:r.handle.toLowerCase().replace(/\s+/g,"-"),description:r.description,is_private:r.isPrivate,creator_id:a.id}),{error:f}=await A.from("community_members").insert([{community_id:m.id,user_id:a.id,role:"admin"}]);if(f)throw f;i(`Community "${m.name}" created!`),e(),n(`/c/${m.handle}`)}catch(m){console.error(m),i(m.message||"Failed to create community","error")}finally{c(!1)}}};return(0,s.jsx)(it,{isOpen:t,onClose:()=>!o&&e(),title:"Create Community",className:"sm:max-w-md",children:(0,s.jsxs)("form",{onSubmit:u,className:"space-y-5",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center p-6 bg-zinc-50 dark:bg-zinc-900 rounded-2xl border-2 border-dashed border-zinc-200 dark:border-zinc-800",children:[(0,s.jsx)("div",{className:"size-20 rounded-2xl bg-white dark:bg-black flex items-center justify-center shadow-sm mb-3",children:(0,s.jsx)(Ye,{size:32,className:"text-violet-600"})}),(0,s.jsx)("p",{className:"text-xs font-medium text-zinc-500 text-center max-w-[200px]",children:"Communities are where people with shared interests connect."})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("label",{className:"text-sm font-bold ml-1",children:"Community Name"}),(0,s.jsx)("input",{type:"text",required:!0,className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all",placeholder:"e.g. Photography Enthusiasts",value:r.name,onChange:d=>l({...r,name:d.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("label",{className:"text-sm font-bold ml-1",children:"Handle"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-zinc-500 font-medium",children:"c/"}),(0,s.jsx)("input",{type:"text",required:!0,className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl pl-8 pr-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all",placeholder:"photography",value:r.handle,onChange:d=>l({...r,handle:d.target.value.toLowerCase().replace(/[^a-z0-9-]/g,"")})})]})]}),(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("label",{className:"text-sm font-bold ml-1",children:"Description (Optional)"}),(0,s.jsx)("textarea",{className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all min-h-[100px] resize-none",placeholder:"What is this community about?",value:r.description,onChange:d=>l({...r,description:d.target.value})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-zinc-50 dark:bg-zinc-900 rounded-xl border border-zinc-200 dark:border-zinc-800",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-sm font-bold",children:"Private Community"}),(0,s.jsx)("span",{className:"text-[10px] text-zinc-500",children:"Only Admins can post in private communities"})]}),(0,s.jsx)("input",{type:"checkbox",className:"size-5 rounded-md accent-violet-600 cursor-pointer",checked:r.isPrivate,onChange:d=>l({...r,isPrivate:d.target.checked})})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,s.jsx)(ue,{type:"button",variant:"outline",className:"flex-1",onClick:e,disabled:o,children:"Cancel"}),(0,s.jsx)(ue,{type:"submit",className:"flex-1",disabled:o||!r.name||!r.handle,children:o?(0,s.jsx)(me,{size:18,className:"animate-spin"}):"Create"})]})]})})},oo=lo,co=({isOpen:t,onClose:e,initialCommunity:a})=>{const{currentUser:i}=be(),{addPost:n}=kt(),{addToast:r}=we(),[l,o]=(0,g.useState)(""),[c,u]=(0,g.useState)([]),[d,m]=(0,g.useState)({}),[f,h]=(0,g.useState)(!1),[p,x]=(0,g.useState)({options:["",""],duration:"1 day"}),[b,v]=(0,g.useState)(!1),[j,w]=(0,g.useState)(null);(0,g.useEffect)(()=>{w(a||null)},[a,t]);const{data:y=[]}=$e({queryKey:["user-communities",i?.id],queryFn:()=>ir(i?.id),enabled:!!i?.id}),_=(0,g.useRef)(null),C=(0,g.useRef)(null),[F,E]=(0,g.useState)(null),M=S=>{const $=Array.from(S.target.files);u(q=>[...q,...$])},N=S=>{const $=S.target.files[0];$&&F!==null&&m(q=>({...q,[F]:$})),E(null)},P=S=>{u(q=>q.filter((z,k)=>k!==S));const $={...d};delete $[S],m($)},L=()=>{p.options.length<4&&x(S=>({...S,options:[...S.options,""]}))},R=S=>{x($=>({...$,options:$.options.filter((q,z)=>z!==S)}))},I=(S,$)=>{const q=[...p.options];q[S]=$,x(z=>({...z,options:q}))},D=async S=>{if(S.preventDefault(),!(!l.trim()&&c.length===0||!i)){v(!0);try{const $=[];for(let z=0;z<c.length;z++){const k=c[z],O=await Pe(k,"media",d[z]||null);$.push(O)}let q=null;f&&p.options.some(z=>z.trim())&&(q={options:p.options.filter(z=>z.trim()).map((z,k)=>({id:k+1,text:z,votes:0})),ends_at:new Date(Date.now()+1440*60*1e3).toISOString()}),await n({content:l,media:$,poll:q,type:$.length>0?$[0].type==="video"?"video":"image":q?"poll":"text",userId:i.id,communityId:j?.id||null}),o(""),u([]),h(!1),x({options:["",""],duration:"1 day"}),w(null),e(),r("Post published!")}catch($){console.error("Failed to create post:",$),r("Failed to publish post.")}finally{v(!1)}}};return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(it,{isOpen:t,onClose:()=>!b&&e(),title:"Create Post",className:"sm:max-w-xl",footer:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,s.jsxs)("div",{className:"flex text-violet-600 gap-1",children:[(0,s.jsx)("button",{type:"button",onClick:()=>_.current?.click(),className:"p-2.5 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full transition-colors",title:"Attach media",children:(0,s.jsx)(Ds,{size:22})}),(0,s.jsx)("button",{type:"button",onClick:()=>h(!0),className:"p-2.5 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full transition-colors",title:"Add poll",children:(0,s.jsx)(Ia,{size:22})}),(0,s.jsx)("button",{type:"button",className:"p-2.5 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full transition-colors",children:(0,s.jsx)(qs,{size:22})}),(0,s.jsx)("input",{type:"file",ref:_,onChange:M,multiple:!0,className:"hidden",accept:"image/*,video/*,application/pdf"}),(0,s.jsx)("input",{type:"file",ref:C,onChange:N,className:"hidden",accept:"image/*"})]}),(0,s.jsx)(ue,{onClick:D,disabled:!l.trim()&&c.length===0||b,className:"px-8 py-2.5 min-w-[100px] text-base",children:b?(0,s.jsx)(me,{size:18,className:"animate-spin"}):"Post"})]}),children:(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)(xe,{className:"size-12 border border-zinc-200 dark:border-zinc-800",children:[(0,s.jsx)(he,{src:i?.avatar,className:"object-cover"}),(0,s.jsx)(pe,{children:i?.handle?.[0]?.toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"mb-2",children:(0,s.jsxs)(da,{children:[(0,s.jsx)(ma,{asChild:!0,children:(0,s.jsx)("button",{className:"flex items-center gap-1.5 px-3 py-1 rounded-full border border-zinc-200 dark:border-zinc-800 text-xs font-bold text-violet-600 dark:text-violet-400 hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors",children:j?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Ye,{size:14}),(0,s.jsx)("span",{children:j.name})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(gt,{size:14}),(0,s.jsx)("span",{children:"Everyone"})]})})}),(0,s.jsxs)(ua,{align:"start",className:"w-56 rounded-xl",children:[(0,s.jsxs)(Xe,{onClick:()=>w(null),className:"gap-2 py-2.5 cursor-pointer",children:[(0,s.jsx)(gt,{size:16,className:"text-zinc-500"}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"font-bold text-sm",children:"Everyone"}),(0,s.jsx)("span",{className:"text-[10px] text-zinc-500",children:"Post to your public feed"})]})]}),y.filter(S=>!S.isPrivate||S.myRole==="admin").map(S=>(0,s.jsxs)(Xe,{onClick:()=>w(S),className:"gap-2 py-2.5 cursor-pointer",children:[(0,s.jsxs)(xe,{className:"size-6",children:[(0,s.jsx)(he,{src:S.avatar}),(0,s.jsx)(pe,{children:S.name[0]})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"font-bold text-sm",children:S.name}),(0,s.jsx)("span",{className:"text-[10px] text-zinc-500",children:"Post to community"})]})]},S.id))]})]})}),(0,s.jsx)("textarea",{className:"w-full bg-transparent border-none outline-none text-lg min-h-[120px] resize-none dark:text-white",placeholder:"What's happening?",autoFocus:!0,value:l,onChange:S=>o(S.target.value)}),f&&(0,s.jsxs)("div",{className:"mt-4 p-4 rounded-2xl space-y-3 bg-zinc-50/50 dark:bg-zinc-900/50",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsx)("span",{className:"text-sm font-bold opacity-60",children:"Poll"}),(0,s.jsx)("button",{type:"button",onClick:()=>h(!1),className:"text-zinc-500 hover:text-rose-500",children:(0,s.jsx)(_e,{size:18})})]}),p.options.map((S,$)=>(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{className:"flex-1 bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-xl px-4 py-2 text-sm outline-none focus:border-violet-500",placeholder:`Option ${$+1}`,value:S,onChange:q=>I($,q.target.value)}),p.options.length>2&&(0,s.jsx)("button",{type:"button",onClick:()=>R($),className:"p-2 text-rose-500 hover:bg-rose-50 dark:hover:bg-rose-900/20 rounded-lg transition-colors",children:(0,s.jsx)(bs,{size:16})})]},$)),p.options.length<4&&(0,s.jsx)("button",{type:"button",onClick:L,className:"text-sm font-bold text-violet-600 hover:bg-violet-50 dark:hover:bg-violet-900/20 px-3 py-1.5 rounded-lg transition-colors",children:"+ Add option"})]}),c.length>0&&(0,s.jsx)("div",{className:"mt-4 flex flex-wrap gap-2",children:c.map((S,$)=>(0,s.jsxs)("div",{className:"relative group size-24 rounded-xl overflow-hidden bg-zinc-100 dark:bg-zinc-800 shadow-sm",children:[S.type.startsWith("image/")?(0,s.jsx)("img",{src:URL.createObjectURL(S),className:"size-full object-cover",alt:""}):(0,s.jsx)("div",{className:"size-full flex flex-col items-center justify-center text-zinc-500 bg-zinc-100 dark:bg-zinc-800",children:S.type.startsWith("video/")?(0,s.jsxs)(s.Fragment,{children:[d[$]?(0,s.jsx)("img",{src:URL.createObjectURL(d[$]),className:"size-full object-cover",alt:"Custom thumbnail"}):(0,s.jsx)(De,{size:24,className:"animate-pulse"}),(0,s.jsx)("button",{type:"button",onClick:()=>{E($),C.current?.click()},className:"absolute inset-x-0 bottom-0 bg-black/60 text-white text-[10px] font-bold py-1 backdrop-blur-sm hover:bg-black transition-colors",children:d[$]?"Change Thumbnail":"Add Thumbnail"})]}):(0,s.jsx)(Ls,{size:24})}),(0,s.jsx)("button",{type:"button",onClick:()=>P($),className:"absolute top-1 right-1 size-6 rounded-full bg-black/60 text-white flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)(_e,{size:14,strokeWidth:3})})]},$))})]})]})})})})},mo=co,uo=({isOpen:t,onClose:e})=>{const{currentUser:a}=be(),{addToast:i}=we(),n=wt(),[r,l]=(0,g.useState)(null),[o,c]=(0,g.useState)(!1),[u,d]=(0,g.useState)(null),m=(0,g.useRef)(null),f=b=>{const v=b.target.files[0];v&&l(v)},h=()=>{if(!r)return;const b=new FileReader;b.onload=()=>{d(b.result)},b.readAsDataURL(r)},p=b=>{l(new File([b],`story-cropped-${Date.now()}.jpg`,{type:"image/jpeg"})),d(null)},x=async()=>{if(!(!r||!a)){c(!0);try{const b=await Pe(r);await er(a.id,b.url,b.type),l(null),e(),i("Story shared!"),n.invalidateQueries(["stories"])}catch(b){console.error("Failed to create story:",b),i("Failed to share story.")}finally{c(!1)}}};return(0,s.jsxs)(it,{isOpen:t,onClose:()=>!o&&e(),title:"Add Story",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[r?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"relative aspect-[9/16] w-full max-w-[280px] mx-auto rounded-3xl overflow-hidden shadow-2xl",children:[(0,s.jsx)("img",{src:URL.createObjectURL(r),className:"w-full h-full object-cover",alt:"Preview"}),(0,s.jsx)("button",{onClick:()=>l(null),className:"absolute top-4 right-4 p-2 bg-black/50 text-white rounded-full hover:bg-rose-500 transition-colors",title:"Remove",children:(0,s.jsx)(_e,{size:20})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-center gap-4 py-2 bg-zinc-50/50 dark:bg-zinc-900/50 rounded-2xl",children:[(0,s.jsxs)("button",{onClick:h,className:"flex flex-col items-center gap-1.5 p-3 rounded-xl hover:bg-white dark:hover:bg-zinc-800 transition-all text-zinc-600 dark:text-zinc-400 hover:text-violet-600 dark:hover:text-violet-400 group",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm group-hover:shadow-md transition-all",children:(0,s.jsx)(xs,{size:20})}),(0,s.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Crop / Edit"})]}),(0,s.jsxs)("button",{className:"flex flex-col items-center gap-1.5 p-3 rounded-xl opacity-40 cursor-not-allowed text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm",children:(0,s.jsx)("svg",{size:20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:(0,s.jsx)("path",{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 21 3 22l1-4.5L17 3z"})})}),(0,s.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Text"})]}),(0,s.jsxs)("button",{className:"flex flex-col items-center gap-1.5 p-3 rounded-xl opacity-40 cursor-not-allowed text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm",children:(0,s.jsxs)("svg",{size:20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[(0,s.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,s.jsx)("path",{d:"M8 14s1.5 2 4 2 4-2 4-2"}),(0,s.jsx)("line",{x1:"9",y1:"9",x2:"9.01",y2:"9"}),(0,s.jsx)("line",{x1:"15",y1:"9",x2:"15.01",y2:"9"})]})}),(0,s.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Stickers"})]})]})]}):(0,s.jsxs)("div",{className:"py-10",children:[(0,s.jsxs)("div",{className:"relative w-full group",onClick:()=>m.current?.click(),children:[(0,s.jsx)("div",{className:"relative z-40 cursor-pointer group-hover:translate-x-8 group-hover:shadow-2xl group-hover:-translate-y-8 transition-all duration-500 bg-zinc-900 dark:bg-white flex items-center justify-center h-32 w-32 mx-auto rounded-xl border-4 border-white dark:border-zinc-900",children:(0,s.jsxs)("svg",{className:"h-8 w-8 text-white/60 dark:text-zinc-950/60",strokeLinejoin:"round",strokeLinecap:"round",strokeWidth:"2",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2"}),(0,s.jsx)("path",{d:"M7 9l5 -5l5 5"}),(0,s.jsx)("path",{d:"M12 4l0 12"})]})}),(0,s.jsx)("div",{className:"absolute border-2 opacity-0 group-hover:opacity-80 transition-all duration-300 border-dashed border-violet-500 inset-0 z-30 bg-transparent flex items-center justify-center h-32 w-32 mx-auto rounded-xl"})]}),(0,s.jsxs)("div",{className:"text-center mt-8",children:[(0,s.jsx)("p",{className:"font-bold dark:text-white",children:"Choose a photo"}),(0,s.jsx)("p",{className:"text-sm text-zinc-500",children:"Stories last for 24 hours"})]})]}),(0,s.jsx)("input",{type:"file",ref:m,onChange:f,className:"hidden",accept:"image/*"}),(0,s.jsx)(ue,{className:"w-full py-3 text-lg",disabled:!r||o,onClick:x,children:o?(0,s.jsx)(me,{size:24,className:"animate-spin mx-auto"}):"Share story"})]}),u&&(0,s.jsx)(Nl,{src:u,isOpen:!!u,onClose:()=>d(null),onCropComplete:p,aspect:9/16})]})},fo=uo;function xo({isOpen:t,onClose:e,community:a,onUpdate:i}){const{addToast:n}=we(),{currentUser:r}=be(),[l,o]=(0,g.useState)({name:"",handle:"",description:"",avatar:"",cover:"",isPrivate:!1}),[c,u]=(0,g.useState)(!1),[d,m]=(0,g.useState)([]),[f,h]=(0,g.useState)(!1),[p,x]=(0,g.useState)(""),[b,v]=(0,g.useState)(!1),j=r?.id===a?.creatorId,w=(0,g.useRef)(null),y=(0,g.useRef)(null);(0,g.useEffect)(()=>{a&&t&&(o({name:a.name||"",handle:a.handle||"",description:a.description||"",avatar:a.avatar||"",cover:a.cover||"",isPrivate:a.isPrivate||!1}),x(""),m([]),v(!1))},[a,t,j]);const _=(0,g.useCallback)(async(N="")=>{if(!(!N&&!j)){h(!0),v(!0);try{m(await lr(a.id,N))}catch(P){console.error("Failed to load members:",P)}finally{h(!1)}}},[a.id,j]);(0,g.useEffect)(()=>{if(p.length>=2){const N=setTimeout(()=>{_(p)},500);return()=>clearTimeout(N)}else p.length===0&&(m([]),v(!1))},[p,_]);const C=async(N,P)=>{const L=P==="admin"?"member":"admin";try{await or(a.id,N,L),m(R=>R.map(I=>I.userId===N?{...I,role:L}:I)),n(`Role updated to ${L}`)}catch{n("Failed to update role","error")}},F=(N,P)=>{const L=N.target.files[0];L&&E(L,P)},E=async(N,P)=>{u(!0);try{const L=await Pe(N);o(R=>({...R,[P]:L.url})),n(`${P.charAt(0).toUpperCase()+P.slice(1)} uploaded!`)}catch{n(`Failed to upload ${P}`,"error")}finally{u(!1)}},M=async N=>{if(N.preventDefault(),!(!l.name||!l.handle||!a)){u(!0);try{const P=await rr(a.id,{name:l.name,handle:l.handle.toLowerCase().replace(/[^a-z0-9-]/g,""),description:l.description,avatar_url:l.avatar,cover_url:l.cover,is_private:l.isPrivate});n("Community updated successfully!"),i&&i(P),e()}catch(P){console.error(P),n(P.message||"Failed to update community","error")}finally{u(!1)}}};return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(it,{isOpen:t,onClose:()=>!c&&e(),title:"Edit Community",className:"sm:max-w-xl",children:[(0,s.jsxs)("div",{className:"space-y-6 max-h-[85vh] overflow-y-auto px-1",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("div",{className:"h-32 sm:h-40 bg-zinc-100 dark:bg-zinc-900 rounded-xl overflow-hidden relative group",children:[l.cover&&(0,s.jsx)("img",{src:l.cover,className:"w-full h-full object-cover",alt:""}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black/20 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)("button",{onClick:()=>y.current?.click(),className:"p-3 bg-black/60 text-white rounded-full hover:bg-black transition-all",children:(0,s.jsx)(Yt,{size:20})})})]}),(0,s.jsx)("div",{className:"absolute -bottom-8 left-6",children:(0,s.jsxs)("div",{className:"relative group size-20 sm:size-24 rounded-2xl border-4 border-white dark:border-black bg-zinc-100 dark:bg-zinc-800 overflow-hidden shadow-lg",children:[(0,s.jsx)("img",{src:l.avatar,className:"size-full object-cover",alt:""}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)("button",{onClick:()=>w.current?.click(),className:"text-white p-2",children:(0,s.jsx)(Yt,{size:18})})})]})})]}),(0,s.jsx)("div",{className:"pt-6",children:(0,s.jsxs)("form",{onSubmit:M,className:"space-y-5",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("label",{className:"text-sm font-bold ml-1",children:"Community Name"}),(0,s.jsx)("input",{type:"text",required:!0,className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all font-medium",value:l.name,onChange:N=>o({...l,name:N.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("label",{className:"text-sm font-bold ml-1 text-rose-500",children:"Handle (Experimental)"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-zinc-500 font-medium text-sm",children:"c/"}),(0,s.jsx)("input",{type:"text",required:!0,className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl pl-8 pr-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all font-medium text-sm",value:l.handle,onChange:N=>o({...l,handle:N.target.value})})]})]}),(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("label",{className:"text-sm font-bold ml-1",children:"Description"}),(0,s.jsx)("textarea",{className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all min-h-[100px] resize-none font-medium",placeholder:"What is this community about?",value:l.description,onChange:N=>o({...l,description:N.target.value})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-zinc-50 dark:bg-zinc-900 rounded-xl border border-zinc-200 dark:border-zinc-800",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-sm font-bold",children:"Private Community"}),(0,s.jsx)("span",{className:"text-[10px] text-zinc-500",children:"Only Admins can post in private communities"})]}),(0,s.jsx)("input",{type:"checkbox",className:"size-5 rounded-md accent-violet-600 cursor-pointer",checked:l.isPrivate,onChange:N=>o({...l,isPrivate:N.target.checked})})]}),j&&(0,s.jsxs)("div",{className:"space-y-4 pt-4 border-t border-zinc-100 dark:border-zinc-800",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-1 px-1",children:[(0,s.jsx)("span",{className:"text-sm font-bold",children:"Manage Members"}),(0,s.jsx)("span",{className:"text-[10px] text-zinc-500",children:"Search for members to manage their roles"})]}),(0,s.jsx)("div",{className:"px-1",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(Et,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-zinc-400",size:16}),(0,s.jsx)("input",{type:"text",placeholder:"Search members by name or handle...",className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl pl-10 pr-4 py-2 text-sm outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all font-medium",value:p,onChange:N=>x(N.target.value),onKeyDown:N=>{N.key==="Enter"&&(N.preventDefault(),N.stopPropagation())}})]})}),b&&(0,s.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 rounded-xl border border-zinc-200 dark:border-zinc-800 overflow-hidden max-h-[300px] overflow-y-auto mt-2",children:f?(0,s.jsx)("div",{className:"p-8 flex justify-center",children:(0,s.jsx)(me,{className:"animate-spin text-violet-500"})}):d.length===0?(0,s.jsxs)("div",{className:"p-8 text-center text-sm text-zinc-500 font-medium",children:['No results found for "',p,'"']}):(0,s.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:d.map(N=>(0,s.jsxs)("div",{className:"p-3 flex items-center justify-between hover:bg-zinc-100/50 dark:hover:bg-zinc-800/50 transition-colors",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)(xe,{className:"size-9 border border-zinc-200 dark:border-zinc-700",children:[(0,s.jsx)(he,{src:N.user.avatar_url}),(0,s.jsx)(pe,{children:N.user.username?.[0]?.toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex flex-col min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("span",{className:"text-sm font-bold truncate max-w-[120px]",children:N.user.display_name}),N.user.is_verified&&(0,s.jsx)(lt,{})]}),(0,s.jsxs)("span",{className:"text-xs text-zinc-500",children:["@",N.user.username]})]})]}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:N.userId===a.creatorId?(0,s.jsx)("span",{className:"text-[10px] font-bold px-2.5 py-1 bg-zinc-200 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 rounded-full",children:"OWNER"}):(0,s.jsx)("button",{type:"button",onClick:()=>C(N.userId,N.role),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-full text-[11px] font-bold transition-all ${N.role==="admin"?"bg-rose-50 text-rose-600 hover:bg-rose-100 dark:bg-rose-950/20 dark:text-rose-400":"bg-zinc-100 text-zinc-600 hover:bg-zinc-200 dark:bg-zinc-800 dark:text-zinc-400 dark:hover:bg-zinc-700"}`,children:N.role==="admin"?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Fs,{size:14}),"Remove Admin"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Et,{size:14}),"Make Admin"]})})})]},N.userId))})})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 pt-6 py-2",children:[(0,s.jsx)(ue,{type:"button",variant:"outline",className:"flex-1 rounded-xl h-11 font-bold",onClick:e,disabled:c,children:"Cancel"}),(0,s.jsx)(ue,{type:"submit",className:"flex-1 rounded-xl h-11 font-bold bg-zinc-900 dark:bg-white text-white dark:text-black hover:bg-zinc-800 dark:hover:bg-zinc-200 transition-all active:scale-95",disabled:c||!l.name,children:c?(0,s.jsx)(me,{size:18,className:"animate-spin"}):"Save Changes"})]})]})})]}),(0,s.jsx)("input",{type:"file",ref:w,className:"hidden",accept:"image/*",onChange:N=>F(N,"avatar")}),(0,s.jsx)("input",{type:"file",ref:y,className:"hidden",accept:"image/*",onChange:N=>F(N,"cover")})]})})}var ho=({isOpen:t,onClose:e,editProfileData:a,setEditProfileData:i})=>{const{updateProfile:n}=be(),{addToast:r}=we(),[l,o]=(0,g.useState)(!1),[c,u]=(0,g.useState)(null),[d,m]=(0,g.useState)(null),f=(0,g.useRef)(null),h=(0,g.useRef)(null),p=(b,v)=>{const j=b.target.files[0];j&&(v==="avatar"?u(j):m(j))},x=async()=>{o(!0);try{let b=a.avatar,v=a.cover;c&&(b=(await Pe(c)).url),d&&(v=(await Pe(d)).url),await n({...a,avatar:b,cover:v}),u(null),m(null),e(),r("Profile updated!")}catch(b){console.error("Failed to update profile:",b),r("Failed to update profile.","error")}finally{o(!1)}};return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(it,{isOpen:t,onClose:()=>!l&&e(),title:"Edit Profile",children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("input",{type:"file",ref:h,className:"hidden",accept:"image/*",onChange:b=>p(b,"cover")}),(0,s.jsx)("input",{type:"file",ref:f,className:"hidden",accept:"image/*",onChange:b=>p(b,"avatar")}),(0,s.jsxs)("div",{className:"relative h-32 bg-zinc-100 dark:bg-zinc-800 rounded-xl overflow-hidden group cursor-pointer",onClick:()=>h.current?.click(),children:[(d||a?.cover)&&(0,s.jsx)("img",{src:d?URL.createObjectURL(d):a.cover,className:"w-full h-full object-cover opacity-60",alt:""}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("div",{className:"bg-black/50 p-2 rounded-full text-white group-hover:scale-110 transition-transform",children:(0,s.jsx)(De,{size:20})})})]}),(0,s.jsx)("div",{className:"relative -mt-16 ml-4",children:(0,s.jsxs)("div",{className:"relative size-24 rounded-full border-4 border-white dark:border-black overflow-hidden group cursor-pointer shadow-lg bg-white dark:bg-black",onClick:()=>f.current?.click(),children:[(c||a?.avatar)&&(0,s.jsxs)(xe,{className:"size-full opacity-60 rounded-none",children:[(0,s.jsx)(he,{src:c?URL.createObjectURL(c):a.avatar,className:"object-cover"}),(0,s.jsx)(pe,{children:a?.handle?.[0]?.toUpperCase()})]}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("div",{className:"bg-black/50 p-2 rounded-full text-white group-hover:scale-110 transition-transform",children:(0,s.jsx)(De,{size:16})})})]})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(Se,{label:"Name",value:a?.name||"",onChange:b=>i({...a,name:b.target.value})}),(0,s.jsx)(Se,{label:"Bio",textarea:!0,value:a?.bio||"",onChange:b=>i({...a,bio:b.target.value})}),(0,s.jsx)(Se,{label:"Location",value:a?.location||"",onChange:b=>i({...a,location:b.target.value})}),(0,s.jsx)(Se,{label:"Website",value:a?.website||"",onChange:b=>i({...a,website:b.target.value})})]}),(0,s.jsx)(ue,{className:"w-full py-3",disabled:l,onClick:x,children:l?(0,s.jsx)(me,{size:24,className:"animate-spin text-white mx-auto"}):"Save changes"})]})})})},po=ho,bo=K(),go=t=>{const e=(0,bo.c)(22),{isPostModalOpen:a,setIsPostModalOpen:i,isEditProfileOpen:n,setIsEditProfileOpen:r,isStoryModalOpen:l,setIsStoryModalOpen:o,editProfileData:c,setEditProfileData:u,postCommunity:d}=t;let m;e[0]!==i?(m=()=>i(!1),e[0]=i,e[1]=m):m=e[1];let f;e[2]!==a||e[3]!==d||e[4]!==m?(f=(0,s.jsx)(mo,{isOpen:a,onClose:m,initialCommunity:d}),e[2]=a,e[3]=d,e[4]=m,e[5]=f):f=e[5];let h;e[6]!==r?(h=()=>r(!1),e[6]=r,e[7]=h):h=e[7];let p;e[8]!==c||e[9]!==n||e[10]!==u||e[11]!==h?(p=(0,s.jsx)(po,{isOpen:n,onClose:h,editProfileData:c,setEditProfileData:u}),e[8]=c,e[9]=n,e[10]=u,e[11]=h,e[12]=p):p=e[12];let x;e[13]!==o?(x=()=>o(!1),e[13]=o,e[14]=x):x=e[14];let b;e[15]!==l||e[16]!==x?(b=(0,s.jsx)(fo,{isOpen:l,onClose:x}),e[15]=l,e[16]=x,e[17]=b):b=e[17];let v;return e[18]!==f||e[19]!==p||e[20]!==b?(v=(0,s.jsxs)(s.Fragment,{children:[f,p,b]}),e[18]=f,e[19]=p,e[20]=b,e[21]=v):v=e[21],v},vo=go,jo=K(),wo=t=>{const e=(0,jo.c)(91),{story:a,onClose:i}=t,[n,r]=(0,g.useState)(0),[l,o]=(0,g.useState)(0),[c,u]=(0,g.useState)(!1),d=a.stories,m=d[n];let f;e[0]!==n||e[1]!==i||e[2]!==d.length||e[3]!==a.user.id?(f=()=>{n<d.length-1?(r(zo),o(0)):i(a.user.id)},e[0]=n,e[1]=i,e[2]=d.length,e[3]=a.user.id,e[4]=f):f=e[4];const h=f;let p;e[5]!==n?(p=()=>{n>0&&(r(No),o(0))},e[5]=n,e[6]=p):p=e[6];const x=p;let b;e[7]===Symbol.for("react.memo_cache_sentinel")?(b=X=>{X.stopPropagation(),u(ko)},e[7]=b):b=e[7];const v=b;let j;e[8]!==h||e[9]!==c?(j=()=>{if(c)return;const X=setInterval(()=>{o(ee=>ee>=100?(h(),100):ee+1)},50);return()=>clearInterval(X)},e[8]=h,e[9]=c,e[10]=j):j=e[10];let w;e[11]!==n||e[12]!==h||e[13]!==c?(w=[h,n,c],e[11]=n,e[12]=h,e[13]=c,e[14]=w):w=e[14],(0,g.useEffect)(j,w);let y;if(e[15]!==n||e[16]!==l||e[17]!==d){let X;e[19]!==n||e[20]!==l?(X=(ee,J)=>(0,s.jsx)("div",{className:"flex-1 h-full bg-white/30 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full bg-white transition-all duration-100",style:{width:J<n?"100%":J===n?`${l}%`:"0%"}})},J),e[19]=n,e[20]=l,e[21]=X):X=e[21],y=d.map(X),e[15]=n,e[16]=l,e[17]=d,e[18]=y}else y=e[18];let _;e[22]!==y?(_=(0,s.jsx)("div",{className:"flex gap-1.5 h-0.5 w-full bg-transparent",children:y}),e[22]=y,e[23]=_):_=e[23];const C=`/u/${a.user.handle}`;let F;e[24]!==a.user.avatar||e[25]!==a.user.handle?(F=(0,s.jsx)(he,{src:a.user.avatar,alt:a.user.handle,className:"object-cover"}),e[24]=a.user.avatar,e[25]=a.user.handle,e[26]=F):F=e[26];let E;e[27]!==a.user.handle?.[0]?(E=a.user.handle?.[0]?.toUpperCase(),e[27]=a.user.handle?.[0],e[28]=E):E=e[28];let M;e[29]!==E?(M=(0,s.jsx)(pe,{children:E}),e[29]=E,e[30]=M):M=e[30];let N;e[31]!==M||e[32]!==F?(N=(0,s.jsxs)(xe,{className:"size-10 border border-white/20 shadow-sm",children:[F,M]}),e[31]=M,e[32]=F,e[33]=N):N=e[33];let P;e[34]!==a.user.handle?(P=(0,s.jsx)("span",{className:"text-white text-sm font-bold shadow-black drop-shadow-md",children:a.user.handle}),e[34]=a.user.handle,e[35]=P):P=e[35];let L;e[36]!==m.created_at?(L=new Date(m.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),e[36]=m.created_at,e[37]=L):L=e[37];let R;e[38]!==L?(R=(0,s.jsx)("span",{className:"text-white/60 text-[10px] shadow-black drop-shadow-md",children:L}),e[38]=L,e[39]=R):R=e[39];let I;e[40]!==P||e[41]!==R?(I=(0,s.jsxs)("div",{className:"flex flex-col",children:[P,R]}),e[40]=P,e[41]=R,e[42]=I):I=e[42];let D;e[43]!==N||e[44]!==I||e[45]!==C?(D=(0,s.jsxs)(At,{to:C,className:"flex items-center gap-3 hover:opacity-80 transition-opacity",onClick:_o,children:[N,I]}),e[43]=N,e[44]=I,e[45]=C,e[46]=D):D=e[46];let S;e[47]!==i||e[48]!==a.user.id?(S=()=>i(a.user.id),e[47]=i,e[48]=a.user.id,e[49]=S):S=e[49];let $;e[50]===Symbol.for("react.memo_cache_sentinel")?($=(0,s.jsx)(_e,{size:24}),e[50]=$):$=e[50];let q;e[51]!==S?(q=(0,s.jsx)("button",{onClick:S,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors",children:$}),e[51]=S,e[52]=q):q=e[52];let z;e[53]!==D||e[54]!==q?(z=(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[D,q]}),e[53]=D,e[54]=q,e[55]=z):z=e[55];let k;e[56]!==z||e[57]!==_?(k=(0,s.jsxs)("div",{className:"absolute top-0 left-0 right-0 p-4 z-20 flex flex-col gap-4",children:[_,z]}),e[56]=z,e[57]=_,e[58]=k):k=e[58];let O;e[59]!==n||e[60]!==x?(O=n>0&&(0,s.jsx)("button",{onClick:X=>{X.stopPropagation(),x()},className:"absolute left-4 z-30 p-2 bg-black/20 hover:bg-black/40 rounded-full text-white backdrop-blur-md transition-all active:scale-90",children:(0,s.jsx)(Bs,{size:32})}),e[59]=n,e[60]=x,e[61]=O):O=e[61];let U;e[62]!==m.id||e[63]!==m.media?(U=(0,s.jsx)("img",{src:m.media,className:"max-w-full max-h-full object-contain rounded-xl shadow-2xl animate-in fade-in zoom-in-95 duration-300",alt:""},m.id),e[62]=m.id,e[63]=m.media,e[64]=U):U=e[64];let T;e[65]!==c?(T=c&&(0,s.jsx)("div",{className:"absolute inset-0 z-10 flex items-center justify-center pointer-events-none",children:(0,s.jsx)("div",{className:"px-4 py-2 bg-black/40 rounded-full text-white text-xs font-bold backdrop-blur-md border border-white/10 animate-in fade-in zoom-in duration-200",children:"PAUSED"})}),e[65]=c,e[66]=T):T=e[66];let W;e[67]!==U||e[68]!==T?(W=(0,s.jsxs)("div",{className:"relative w-full h-full flex items-center justify-center",children:[U,T]}),e[67]=U,e[68]=T,e[69]=W):W=e[69];let Q;e[70]!==h?(Q=X=>{X.stopPropagation(),h()},e[70]=h,e[71]=Q):Q=e[71];let Z;e[72]===Symbol.for("react.memo_cache_sentinel")?(Z=(0,s.jsx)(Qe,{size:32}),e[72]=Z):Z=e[72];let ae;e[73]!==Q?(ae=(0,s.jsx)("button",{onClick:Q,className:"absolute right-4 z-30 p-2 bg-black/20 hover:bg-black/40 rounded-full text-white backdrop-blur-md transition-all active:scale-90",children:Z}),e[73]=Q,e[74]=ae):ae=e[74];let ie;e[75]!==x?(ie=(0,s.jsx)("div",{className:"w-[30%] cursor-w-resize",onClick:x}),e[75]=x,e[76]=ie):ie=e[76];let G;e[77]===Symbol.for("react.memo_cache_sentinel")?(G=(0,s.jsx)("div",{className:"w-[40%] cursor-pointer flex items-center justify-center",onClick:v}),e[77]=G):G=e[77];let se;e[78]!==h?(se=(0,s.jsx)("div",{className:"w-[30%] cursor-e-resize",onClick:h}),e[78]=h,e[79]=se):se=e[79];let ne;e[80]!==ie||e[81]!==se?(ne=(0,s.jsxs)("div",{className:"absolute inset-0 flex z-20",children:[ie,G,se]}),e[80]=ie,e[81]=se,e[82]=ne):ne=e[82];let V;e[83]!==O||e[84]!==W||e[85]!==ae||e[86]!==ne?(V=(0,s.jsxs)("div",{className:"w-full h-full max-w-xl relative flex items-center justify-center p-2",children:[O,W,ae,ne]}),e[83]=O,e[84]=W,e[85]=ae,e[86]=ne,e[87]=V):V=e[87];let H;return e[88]!==k||e[89]!==V?(H=(0,s.jsxs)("div",{className:"fixed inset-0 z-[100] bg-black flex flex-col items-center justify-center animate-in fade-in duration-300",children:[k,V]}),e[88]=k,e[89]=V,e[90]=H):H=e[90],H},yo=wo;function zo(t){return t+1}function No(t){return t-1}function ko(t){return!t}function _o(t){return t.stopPropagation()}var Co=({type:t,onComplete:e,onSwitch:a})=>{const{login:i,signup:n}=be(),{addToast:r}=we(),[l,o]=(0,g.useState)({name:"",email:"",username:"",password:""}),[c,u]=(0,g.useState)(!1),[d,m]=(0,g.useState)(null),f=async h=>{h.preventDefault(),u(!0),m(null);try{t==="login"?(await i({email:l.email,password:l.password}),r("Welcome back!")):(await n({email:l.email,password:l.password,username:l.username,name:l.name}),r("Account created successfully!")),e()}catch(p){console.error("Auth error:",p),m(p.message||"Authentication failed. Please check your credentials."),r("Authentication failed!")}finally{u(!1)}};return(0,s.jsxs)("div",{className:"max-w-md mx-auto p-8 w-full animate-in fade-in slide-in-from-bottom-5 duration-300",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("div",{className:"flex justify-center mb-4",children:(0,s.jsx)("div",{className:"bg-black dark:bg-white dark:text-black text-white p-3 rounded-2xl shadow-lg",children:(0,s.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",alt:"Logo",className:"w-10 h-10 rounded-xl"})})}),(0,s.jsx)("h2",{className:"text-3xl font-extrabold mb-2 dark:text-white tracking-tight",children:t==="login"?"Welcome back!":"Join Sysm today"}),(0,s.jsx)("p",{className:"text-zinc-500 font-medium",children:"The decentralized social network"})]}),d&&(0,s.jsxs)("div",{className:"mb-6 p-4 bg-rose-50 dark:bg-rose-900/20 border border-rose-100 dark:border-rose-800 rounded-xl flex items-center gap-3 text-rose-600 dark:text-rose-400 text-sm",children:[(0,s.jsx)($s,{size:18}),(0,s.jsx)("span",{children:d})]}),(0,s.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,s.jsx)(Se,{label:"Email",type:"email",placeholder:"john@example.com",value:l.email,onChange:h=>o({...l,email:h.target.value}),required:!0}),t==="signup"&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Se,{label:"Name",placeholder:"John Doe",value:l.name,onChange:h=>o({...l,name:h.target.value}),required:!0}),(0,s.jsx)(Se,{label:"Username",placeholder:"johndoe",value:l.username,onChange:h=>o({...l,username:h.target.value}),required:!0})]}),(0,s.jsx)(Se,{label:"Password",type:"password",placeholder:"",value:l.password,onChange:h=>o({...l,password:h.target.value}),required:!0}),(0,s.jsx)(ue,{type:"submit",className:"w-full justify-center py-3 mt-6 text-lg",disabled:c,children:c?(0,s.jsx)(me,{size:24,className:"animate-spin"}):t==="login"?"Log in":"Sign up"})]}),(0,s.jsxs)("div",{className:"mt-8 text-center text-sm",children:[(0,s.jsx)("span",{className:"text-zinc-500",children:t==="login"?"Don't have an account?":"Already have an account?"}),(0,s.jsx)("button",{onClick:a,className:"font-bold ml-1 hover:underline dark:text-white",children:t==="login"?"Sign up":"Log in"})]})]})},So=Co,$o=K(),Po=t=>{const e=(0,$o.c)(20),{icon:a,count:i,label:n,onClick:r,active:l,activeColorClass:o}=t,c=o===void 0?"text-violet-600":o,u=a;let d;e[0]!==r?(d=y=>{y.stopPropagation(),r&&r(y)},e[0]=r,e[1]=d):d=e[1];const m=`group flex items-center gap-x-1.5 text-[12px] sm:text-[13px] font-bold transition-all ${l?c:"text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-300"}`,f=`rounded-full p-2 transition-colors ${l?"":"group-hover:bg-zinc-100 dark:group-hover:bg-zinc-800"}`,h=l?2.5:2,p=l?"fill-current":"";let x;e[2]!==u||e[3]!==h||e[4]!==p?(x=(0,s.jsx)(u,{size:18,strokeWidth:h,className:p}),e[2]=u,e[3]=h,e[4]=p,e[5]=x):x=e[5];let b;e[6]!==f||e[7]!==x?(b=(0,s.jsx)("div",{className:f,children:x}),e[6]=f,e[7]=x,e[8]=b):b=e[8];let v;e[9]!==n?(v=n&&(0,s.jsx)("span",{className:"hidden xs:inline",children:n}),e[9]=n,e[10]=v):v=e[10];let j;e[11]!==l||e[12]!==i?(j=i!=null&&(0,s.jsx)("span",{className:l?"font-bold":"",children:i||0}),e[11]=l,e[12]=i,e[13]=j):j=e[13];let w;return e[14]!==j||e[15]!==d||e[16]!==m||e[17]!==b||e[18]!==v?(w=(0,s.jsxs)("button",{onClick:d,className:m,children:[b,v,j]}),e[14]=j,e[15]=d,e[16]=m,e[17]=b,e[18]=v,e[19]=w):w=e[19],w},et=Po,Mo=K(),Fo=t=>{const e=(0,Mo.c)(51),{currentUser:a,newComment:i,setNewComment:n,handleSubmitComment:r,loading:l,selectedFiles:o,setSelectedFiles:c,isUploading:u}=t;let d;e[0]!==o?(d=o===void 0?[]:o,e[0]=o,e[1]=d):d=e[1];const m=d,f=(0,g.useRef)(null);let h;e[2]!==c?(h=$=>{const q=Array.from($.target.files);c&&c(z=>[...z,...q])},e[2]=c,e[3]=h):h=e[3];const p=h;let x;e[4]!==c?(x=$=>{c&&c(q=>q.filter((z,k)=>k!==$))},e[4]=c,e[5]=x):x=e[5];const b=x;if(!a){let $;return e[6]===Symbol.for("react.memo_cache_sentinel")?($=(0,s.jsx)("div",{className:"p-6 text-center border-y border-zinc-100 dark:border-zinc-800 bg-zinc-50/30 dark:bg-zinc-900/10",children:(0,s.jsx)("p",{className:"text-zinc-500 text-sm",children:"Please login to join the conversation."})}),e[6]=$):$=e[6],$}let v;e[7]!==a.avatar||e[8]!==a.handle?(v=(0,s.jsx)(he,{src:a.avatar,alt:a.handle,className:"object-cover"}),e[7]=a.avatar,e[8]=a.handle,e[9]=v):v=e[9];let j;e[10]!==a.handle?.[0]?(j=a.handle?.[0]?.toUpperCase(),e[10]=a.handle?.[0],e[11]=j):j=e[11];let w;e[12]!==j?(w=(0,s.jsx)(pe,{children:j}),e[12]=j,e[13]=w):w=e[13];let y;e[14]!==v||e[15]!==w?(y=(0,s.jsxs)(xe,{className:"size-9 border border-zinc-200 dark:border-zinc-700",children:[v,w]}),e[14]=v,e[15]=w,e[16]=y):y=e[16];let _;e[17]!==n?(_=$=>n($.target.value),e[17]=n,e[18]=_):_=e[18];let C;e[19]!==i||e[20]!==_?(C=(0,s.jsx)("textarea",{id:"comment-input",className:"w-full bg-transparent outline-none text-base min-h-[60px] resize-none dark:text-white placeholder:text-zinc-500",placeholder:"Post your reply...",value:i,onChange:_}),e[19]=i,e[20]=_,e[21]=C):C=e[21];let F;e[22]!==b||e[23]!==m?(F=m.length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mt-2 mb-2",children:m.map(($,q)=>(0,s.jsxs)("div",{className:"relative size-20 rounded-xl overflow-hidden border border-zinc-200 dark:border-zinc-800",children:[$.type.startsWith("image/")?(0,s.jsx)("img",{src:URL.createObjectURL($),className:"size-full object-cover",alt:""}):(0,s.jsx)("div",{className:"size-full flex items-center justify-center bg-zinc-100 dark:bg-zinc-800",children:(0,s.jsx)(zs,{size:20,className:"text-zinc-500"})}),(0,s.jsx)("button",{onClick:()=>b(q),className:"absolute top-1 right-1 bg-black/60 text-white rounded-full p-1 hover:bg-black transition-colors",children:(0,s.jsx)(_e,{size:12})})]},q))}),e[22]=b,e[23]=m,e[24]=F):F=e[24];let E;e[25]===Symbol.for("react.memo_cache_sentinel")?(E=()=>f.current?.click(),e[25]=E):E=e[25];let M;e[26]===Symbol.for("react.memo_cache_sentinel")?(M=(0,s.jsx)("button",{type:"button",onClick:E,className:"text-violet-600 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full p-2 transition-colors",title:"Attach media",children:(0,s.jsx)(Ds,{size:20})}),e[26]=M):M=e[26];let N;e[27]!==p?(N=(0,s.jsxs)("div",{className:"flex text-violet-600 gap-1",children:[M,(0,s.jsx)("input",{type:"file",ref:f,onChange:p,multiple:!0,className:"hidden",accept:"image/*,video/*,application/pdf"})]}),e[27]=p,e[28]=N):N=e[28];let P;e[29]!==u||e[30]!==l||e[31]!==i||e[32]!==m.length?(P=!i.trim()&&m.length===0||l||u,e[29]=u,e[30]=l,e[31]=i,e[32]=m.length,e[33]=P):P=e[33];let L;e[34]!==u||e[35]!==l?(L=l||u?(0,s.jsx)(me,{size:16,className:"animate-spin text-white mx-auto"}):"Reply",e[34]=u,e[35]=l,e[36]=L):L=e[36];let R;e[37]!==r||e[38]!==P||e[39]!==L?(R=(0,s.jsx)(ue,{className:"!w-auto px-5 py-1.5 text-sm font-bold min-w-[70px]",onClick:r,disabled:P,children:L}),e[37]=r,e[38]=P,e[39]=L,e[40]=R):R=e[40];let I;e[41]!==N||e[42]!==R?(I=(0,s.jsxs)("div",{className:"flex justify-between items-center mt-2 pt-3 border-t border-zinc-100 dark:border-zinc-800",children:[N,R]}),e[41]=N,e[42]=R,e[43]=I):I=e[43];let D;e[44]!==C||e[45]!==F||e[46]!==I?(D=(0,s.jsxs)("div",{className:"flex-1",children:[C,F,I]}),e[44]=C,e[45]=F,e[46]=I,e[47]=D):D=e[47];let S;return e[48]!==D||e[49]!==y?(S=(0,s.jsx)("div",{className:"p-4 border-y border-zinc-100 dark:border-zinc-800 bg-zinc-50/30 dark:bg-zinc-900/10",children:(0,s.jsxs)("div",{className:"flex gap-3",children:[y,D]})}),e[48]=D,e[49]=y,e[50]=S):S=e[50],S},Ro=Fo,Lo=K(),Io=t=>{const e=(0,Lo.c)(17),{file:a}=t;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsx)("div",{className:"size-10 rounded-xl bg-violet-100 dark:bg-violet-900/30 flex items-center justify-center text-violet-600",children:(0,s.jsx)(Ls,{size:20})}),e[0]=i):i=e[0];let n;e[1]!==a.name?(n=(0,s.jsx)("div",{className:"text-sm font-bold truncate dark:text-white",children:a.name}),e[1]=a.name,e[2]=n):n=e[2];const r=a.size/1024/1024;let l;e[3]!==r?(l=r.toFixed(2),e[3]=r,e[4]=l):l=e[4];let o;e[5]!==l?(o=(0,s.jsxs)("div",{className:"text-xs text-zinc-500 uppercase",children:[l," MB"]}),e[5]=l,e[6]=o):o=e[6];let c;e[7]!==n||e[8]!==o?(c=(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[n,o]}),e[7]=n,e[8]=o,e[9]=c):c=e[9];let u;e[10]===Symbol.for("react.memo_cache_sentinel")?(u=(0,s.jsx)(Ts,{size:18}),e[10]=u):u=e[10];let d;e[11]!==a.name||e[12]!==a.url?(d=(0,s.jsx)("a",{href:a.url,download:a.name,className:"p-2 text-zinc-400 hover:text-violet-600 transition-colors",onClick:To,children:u}),e[11]=a.name,e[12]=a.url,e[13]=d):d=e[13];let m;return e[14]!==c||e[15]!==d?(m=(0,s.jsxs)("div",{className:"mt-3 flex items-center gap-3 p-3 rounded-2xl border border-zinc-100 dark:border-zinc-800 bg-zinc-50/50 dark:bg-zinc-900/10 group hover:border-violet-500/30 transition-colors",children:[i,c,d]}),e[14]=c,e[15]=d,e[16]=m):m=e[16],m},Eo=Io;function To(t){return t.stopPropagation()}var kd=K(),qo=K(),Do=t=>{const e=(0,qo.c)(30),{url:a}=t;let i,n;e[0]!==a?(i=["link-preview",a],n=()=>mr(a),e[0]=a,e[1]=i,e[2]=n):(i=e[1],n=e[2]);const r=!!a;let l;e[3]!==i||e[4]!==n||e[5]!==r?(l={queryKey:i,queryFn:n,staleTime:864e5,enabled:r},e[3]=i,e[4]=n,e[5]=r,e[6]=l):l=e[6];const{data:o,isLoading:c,isError:u}=$e(l);if(c){let w;return e[7]===Symbol.for("react.memo_cache_sentinel")?(w=(0,s.jsx)("div",{className:"mt-3 rounded-2xl border border-zinc-100 dark:border-zinc-800 overflow-hidden animate-pulse bg-zinc-50 dark:bg-zinc-900/50 h-24 flex items-center justify-center",children:(0,s.jsx)(gt,{className:"text-zinc-300 dark:text-zinc-700 animate-spin",size:24})}),e[7]=w):w=e[7],w}if(u||!o||!o.title&&!o.image)return null;let d;e[8]!==o.image||e[9]!==o.title?(d=o.image&&(0,s.jsx)("div",{className:"w-full aspect-[1.91/1] overflow-hidden bg-zinc-100 dark:bg-zinc-900 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)("img",{src:o.image,alt:o.title,className:"w-full h-full object-cover group-hover:scale-[1.02] transition-transform duration-500",onError:Oo})}),e[8]=o.image,e[9]=o.title,e[10]=d):d=e[10];let m;e[11]===Symbol.for("react.memo_cache_sentinel")?(m=(0,s.jsx)(gt,{size:12}),e[11]=m):m=e[11];let f;e[12]!==o.siteName?(f=(0,s.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-zinc-500 font-bold uppercase tracking-wider",children:[m,(0,s.jsx)("span",{children:o.siteName})]}),e[12]=o.siteName,e[13]=f):f=e[13];let h;e[14]!==o.title?(h=(0,s.jsx)("h4",{className:"font-bold text-[15px] line-clamp-2 dark:text-white leading-snug group-hover:text-violet-600 transition-colors",children:o.title}),e[14]=o.title,e[15]=h):h=e[15];let p;e[16]!==o.description?(p=o.description&&(0,s.jsx)("p",{className:"text-xs text-zinc-500 dark:text-zinc-400 line-clamp-2 leading-relaxed",children:o.description}),e[16]=o.description,e[17]=p):p=e[17];let x;e[18]===Symbol.for("react.memo_cache_sentinel")?(x=(0,s.jsx)(nn,{size:10}),e[18]=x):x=e[18];let b;e[19]!==a?(b=(0,s.jsxs)("div",{className:"pt-1 flex items-center gap-1 text-[11px] text-zinc-400 font-medium",children:[x,(0,s.jsx)("span",{className:"truncate",children:a})]}),e[19]=a,e[20]=b):b=e[20];let v;e[21]!==b||e[22]!==f||e[23]!==h||e[24]!==p?(v=(0,s.jsxs)("div",{className:"p-3.5 space-y-1",children:[f,h,p,b]}),e[21]=b,e[22]=f,e[23]=h,e[24]=p,e[25]=v):v=e[25];let j;return e[26]!==v||e[27]!==d||e[28]!==a?(j=(0,s.jsxs)("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"mt-3 flex flex-col rounded-2xl border border-zinc-100 dark:border-zinc-800 overflow-hidden bg-white dark:bg-zinc-950 hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-all group shadow-sm",onClick:Ao,children:[d,v]}),e[26]=v,e[27]=d,e[28]=a,e[29]=j):j=e[29],j},os=Do;function Ao(t){return t.stopPropagation()}function Oo(t){return t.target.style.display="none"}var Wo=K(),Bo=t=>{const e=(0,Wo.c)(17),{src:a,poster:i}=t,n=(0,g.useRef)(null),{reportVisibility:r,unregister:l}=Rr(),{dataSaver:o}=mt(),c=(0,g.useId)();let u;e[0]===Symbol.for("react.memo_cache_sentinel")?(u={play:()=>{const w=n.current?.plyr;w&&(w.muted=!0,w.play().catch(Vo))},pause:()=>{n.current?.plyr?.pause()}},e[0]=u):u=e[0];const d=u;let m,f;e[1]!==o||e[2]!==c||e[3]!==r||e[4]!==l?(m=()=>{const w=new IntersectionObserver(_=>{const[C]=_;r(c,o?0:C.intersectionRatio,d)},{threshold:[0,.6]}),y=n.current?.elements?.container;return y&&w.observe(y),()=>{l(c),y&&w.unobserve(y)}},f=[c,r,l,d,o],e[1]=o,e[2]=c,e[3]=r,e[4]=l,e[5]=m,e[6]=f):(m=e[5],f=e[6]),(0,g.useEffect)(m,f);let h;e[7]!==a?(h=[{src:a,type:"video/mp4"}],e[7]=a,e[8]=h):h=e[8];let p;e[9]!==i||e[10]!==h?(p={type:"video",sources:h,poster:i},e[9]=i,e[10]=h,e[11]=p):p=e[11];let x;e[12]===Symbol.for("react.memo_cache_sentinel")?(x={controls:["play-large","play","progress","current-time","mute","volume","fullscreen"],settings:["quality","speed"],ratio:"16:9",clickToPlay:!0,hideControls:!0,resetOnEnd:!0},e[12]=x):x=e[12];let b;e[13]!==p?(b={source:p,options:x},e[13]=p,e[14]=b):b=e[14];const v=b;let j;return e[15]!==v?(j=(0,s.jsx)("div",{className:"mt-3 overflow-hidden rounded-2xl shadow-sm border border-zinc-100 dark:border-zinc-800 bg-black",onClick:Ho,children:(0,s.jsx)(Es,{ref:n,...v})}),e[15]=v,e[16]=j):j=e[16],j},Uo=Bo;function Vo(){}function Ho(t){return t.stopPropagation()}var Jo=K(),Qo=t=>{const e=(0,Jo.c)(3),{items:a}=t,i=a===void 0?[]:a,{openLightbox:n}=Ot();if(!i||i.length===0)return null;const r=Array.isArray(i)?i:[i],l=r.filter(Xo),o=r.filter(Yo),c=h=>{const p=l.filter(Go).map(Zo),x=l[h];n(p,p.indexOf(x.url||x.src))},u="mt-3 space-y-2",d=l.length>0&&(0,s.jsx)("div",{className:`grid gap-2 rounded-2xl overflow-hidden border border-zinc-100 dark:border-zinc-800 ${l.length===1?"grid-cols-1":l.length===2?"grid-cols-2 aspect-[16/9]":(l.length===3,"grid-cols-2 grid-rows-2 aspect-[16/9]")}`,children:l.map((h,p)=>(0,s.jsx)("div",{className:`relative overflow-hidden bg-zinc-100 dark:bg-zinc-900 cursor-pointer ${l.length===3&&p===0?"row-span-2":""}`,onClick:x=>{h.type==="image"&&(x.stopPropagation(),c(p))},children:h.type==="video"?(0,s.jsx)(Uo,{src:h.url,poster:h.poster}):(0,s.jsx)("img",{src:h.url||h.src,className:"size-full object-cover hover:scale-[1.02] transition-transform duration-500",alt:"",loading:"lazy"})},p))}),m=o.map(ec);let f;return e[0]!==d||e[1]!==m?(f=(0,s.jsxs)("div",{className:u,children:[d,m]}),e[0]=d,e[1]=m,e[2]=f):f=e[2],f},Ko=Qo;function Xo(t){return t.type==="image"||t.type==="video"}function Yo(t){return t.type==="file"}function Go(t){return t.type==="image"}function Zo(t){return t.url||t.src}function ec(t,e){return(0,s.jsx)(Eo,{file:t},e)}var tc=K(),sc=t=>{const e=(0,tc.c)(18),{poll:a,onVote:i}=t,n=a.options.reduce(ac,0),[r,l]=(0,g.useState)(null);let o;e[0]!==i||e[1]!==r?(o=p=>{r||(l(p),i&&i(p))},e[0]=i,e[1]=r,e[2]=o):o=e[2];const c=o;let u;if(e[3]!==c||e[4]!==a.options||e[5]!==n||e[6]!==r){let p;e[8]!==c||e[9]!==n||e[10]!==r?(p=(x,b)=>{const v=n>0?Math.round((x.votes+(r===x.id?1:0))/(n+(r?1:0))*100):0,j=r===x.id;return(0,s.jsxs)("div",{onClick:w=>{w.stopPropagation(),c(x.id)},className:`relative h-10 w-full rounded-xl overflow-hidden cursor-pointer border ${j?"border-violet-500 dark:border-violet-500":"border-zinc-200 dark:border-zinc-700"}`,children:[r&&(0,s.jsx)("div",{className:"absolute top-0 left-0 h-full bg-zinc-200 dark:bg-zinc-800 transition-all duration-500",style:{width:`${v}%`}}),(0,s.jsxs)("div",{className:"absolute inset-0 flex items-center justify-between px-4 z-10",children:[(0,s.jsxs)("span",{className:`font-medium text-sm ${j?"text-violet-600 font-bold":"text-zinc-700 dark:text-zinc-200"}`,children:[x.text," ",j&&(0,s.jsx)(Ps,{size:14,className:"inline ml-1 mb-0.5"})]}),r&&(0,s.jsxs)("span",{className:"text-sm font-bold text-zinc-900 dark:text-white",children:[v,"%"]})]})]},x.id||b)},e[8]=c,e[9]=n,e[10]=r,e[11]=p):p=e[11],u=a.options.map(p),e[3]=c,e[4]=a.options,e[5]=n,e[6]=r,e[7]=u}else u=e[7];const d=n+(r?1:0),m=r?"6 days left":"Click to vote";let f;e[12]!==d||e[13]!==m?(f=(0,s.jsxs)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400 pl-1",children:[d," votes "," ",m]}),e[12]=d,e[13]=m,e[14]=f):f=e[14];let h;return e[15]!==u||e[16]!==f?(h=(0,s.jsxs)("div",{className:"mt-3 space-y-2",children:[u,f]}),e[15]=u,e[16]=f,e[17]=h):h=e[17],h},cs=sc;function ac(t,e){return t+e.votes}const ft={formatHref:(t,e)=>e==="mention"?`/u/${t.substring(1)}`:e==="hashtag"?`/explore?q=${encodeURIComponent(t)}`:t,attributes:{onClick:t=>t.stopPropagation(),className:"text-rose-500 dark:text-rose-400 font-bold hover:underline cursor-pointer"},target:(t,e)=>e==="url"?"_blank":null,rel:(t,e)=>e==="url"?"noopener noreferrer":null},ic=(t,e,a,i)=>{const[n,r]=(0,g.useState)(!1),[l,o]=(0,g.useState)(!1),[c,u]=(0,g.useState)(e||{comments:0,likes:0,mirrors:0});return(0,g.useEffect)(()=>{a&&t&&ke(t)&&ke(a.id)&&(qn(t,a.id).then(r).catch(()=>r(!1)),An(t,a.id).then(o).catch(()=>o(!1)))},[t,a]),{liked:n,reposted:l,localStats:c,setLocalStats:u,handleLike:async f=>{if(f&&f.stopPropagation(),!a)return i("Please login to like!","error");if(!ke(t)||!ke(a.id)){const h=!n;r(h),u(p=>({...p,likes:h?(p.likes||0)+1:(p.likes||0)-1}));return}try{const h=await Tn(t,a.id);r(h),u(p=>({...p,likes:h?(p.likes||0)+1:(p.likes||0)-1}))}catch(h){console.error("Failed to toggle like:",h)}},handleRepost:async f=>{if(f&&f.stopPropagation(),!a)return i("Please login to repost!","error");if(!ke(t)||!ke(a.id)){const h=!l;o(h),u(p=>({...p,mirrors:h?(p.mirrors||0)+1:(p.mirrors||0)-1}));return}try{const h=await Dn(t,a.id);o(h),u(p=>({...p,mirrors:h?(p.mirrors||0)+1:(p.mirrors||0)-1})),i(h?"Reposted!":"Removed repost")}catch(h){console.error("Failed to toggle repost:",h),i("Failed to update repost","error")}}}};var nc=K();const Ca=t=>{const e=(0,nc.c)(5);let a;e[0]!==t?(a=()=>pt(t),e[0]=t,e[1]=a):a=e[1];const[i,n]=(0,g.useState)(a);let r,l;return e[2]!==t?(r=()=>{if(!t)return;const o=setTimeout(()=>{n(pt(t))},0),c=setInterval(()=>{n(pt(t))},6e4);return()=>{clearTimeout(o),clearInterval(c)}},l=[t],e[2]=t,e[3]=r,e[4]=l):(r=e[3],l=e[4]),(0,g.useEffect)(r,l),i},rc=()=>{const{handle:t}=Nt(),e=ge(),{profiles:a,currentUser:i,getProfileByHandle:n}=be(),{addToast:r}=we(),[l,o]=(0,g.useState)(a[t]),[c,u]=(0,g.useState)(!l),[d,m]=(0,g.useState)([]),[f,h]=(0,g.useState)("feed"),[p,x]=(0,g.useState)(!0),[b,v]=(0,g.useState)(!1),[j,w]=(0,g.useState)(!0),y=(0,g.useRef)(d);(0,g.useEffect)(()=>{y.current=d},[d]);const[_,C]=(0,g.useState)(!1),[F,E]=(0,g.useState)("Followers"),[M,N]=(0,g.useState)([]),[P,L]=(0,g.useState)(!1),[R,I]=(0,g.useState)(!1),[D,S]=(0,g.useState)(!0),$=(0,g.useRef)(M);(0,g.useEffect)(()=>{$.current=M},[M]);const q=(0,g.useCallback)(async(T,W=!1)=>{if(T){W?v(!0):x(!0);try{const Q=y.current,Z=await Mn(T,W&&Q.length>0?Q[Q.length-1].created_at:null,10);Z.length<10?w(!1):w(!0),m(W?ae=>[...ae,...Z]:Z)}catch(Q){console.error("Failed to fetch user posts:",Q)}finally{x(!1),v(!1)}}},[]),z=async(T,W=!1)=>{const Q=l?.id;if(Q){W?I(!0):(E(T),C(!0),L(!0),N([]));try{const Z=$.current,ae=W&&Z.length>0?Z[Z.length-1].followed_at:null,ie=T==="Followers"?await _n(Q,ae,10):await Cn(Q,ae,10);ie.length<10?S(!1):S(!0),N(W?G=>[...G,...ie]:ie)}catch(Z){console.error(`Failed to fetch ${T}:`,Z),r(`Failed to load ${T}`)}finally{L(!1),I(!1)}}};(0,g.useEffect)(()=>{(async()=>{let W=a[t];W?o(W):(u(!0),W=await n(t),o(W),u(!1)),W?.id&&q(W.id)})()},[t,a,n,q]);const k=(0,g.useMemo)(()=>f==="feed"?d.filter(T=>T.community_id===null&&T.parent_id===null):f==="media"?d.filter(T=>T.community_id===null&&T.parent_id===null&&(T.type==="video"||T.type==="image"||T.media&&T.media.length>0)):f==="communities"?d.filter(T=>T.community_id!==null):d,[d,f]);return{handle:t,profile:l,loading:c,userPosts:d,setUserPosts:m,activeProfileTab:f,setActiveProfileTab:h,loadingPosts:p,isFetchingMorePosts:b,hasMorePosts:j,filteredPosts:k,isFollowModalOpen:_,setIsFollowModalOpen:C,followModalType:F,followListData:M,isListLoading:P,isFetchingMoreFollows:R,hasMoreFollows:D,openFollowModal:z,handlePostClick:T=>{e(`/post/${T}`)},handleUserClick:T=>{T!==t&&e(`/u/${T}`)},loadUserPosts:q,currentUser:i,addToast:r,navigate:e}},lc=()=>{const{handle:t}=Nt(),e=ge(),{currentUser:a}=be(),{addToast:i}=we(),[n,r]=(0,g.useState)(null),[l,o]=(0,g.useState)(!0),[c,u]=(0,g.useState)(!1),[d,m]=(0,g.useState)(null),[f,h]=(0,g.useState)(!1),[p,x]=(0,g.useState)([]),[b,v]=(0,g.useState)(!0),[j,w]=(0,g.useState)(!1),[y,_]=(0,g.useState)(!0),C=(0,g.useRef)(p);(0,g.useEffect)(()=>{C.current=p},[p]);const F=(0,g.useCallback)(async(M,N=!1)=>{if(M){N?w(!0):v(!0);try{const P=C.current,L=await ar(M,N&&P.length>0?P[P.length-1].sort_timestamp:null,10);L.length<10?_(!1):_(!0),x(N?R=>[...R,...L]:L)}catch(P){console.error("Failed to fetch community posts:",P)}finally{v(!1),w(!1)}}},[]);return(0,g.useEffect)(()=>{(async()=>{o(!0);try{const N=await sr(t);if(r(N),N?.id&&(F(N.id),a)){const P=await Ks(N.id,a.id);u(!!P),m(P?.role||null)}}catch{}finally{o(!1)}})()},[t,a,F]),{community:n,loading:l,isMember:c,userRole:d,isJoining:f,communityPosts:p,loadingPosts:b,isFetchingMorePosts:j,hasMorePosts:y,handleJoinToggle:async()=>{if(!a)return i("Please login to join communities","error");h(!0);try{const M=await Qs(n.id,a.id);u(M),m(M?"member":null),r(N=>({...N,membersCount:M?N.membersCount+1:N.membersCount-1})),i(M?`Joined ${n.name}`:`Left ${n.name}`)}catch{i("Failed to update membership","error")}finally{h(!1)}},loadCommunityPosts:F,currentUser:a,addToast:i,navigate:e}},oc=()=>{const{currentUser:t}=be(),e=ge(),a=ot(),i=new URLSearchParams(a.search),n=i.get("q")||"",r=i.get("tab")||(n?"posts":"communities"),[l,o]=(0,g.useState)(n),[c,u]=(0,g.useState)(r),[d,m]=(0,g.useState)(!1),[f,h]=(0,g.useState)([]),[p,x]=(0,g.useState)(!0),[b,v]=(0,g.useState)(!1),[j,w]=(0,g.useState)(!0),y=(0,g.useRef)(f),[_,C]=(0,g.useState)([]),[F,E]=(0,g.useState)(!1),[M,N]=(0,g.useState)(!1),[P,L]=(0,g.useState)(!0),R=(0,g.useRef)(_);(0,g.useEffect)(()=>{y.current=f},[f]),(0,g.useEffect)(()=>{R.current=_},[_]),(0,g.useEffect)(()=>{n!==l&&(o(n),n&&u("posts"))},[n]);const I=(0,g.useCallback)(async(z=!1)=>{z?v(!0):x(!0);try{const k=y.current,O=await tr(z&&k.length>0?k[k.length-1].createdAt:null,10);O.length<10?w(!1):w(!0),h(z?U=>[...U,...O]:O)}catch(k){console.error("Failed to fetch communities:",k)}finally{x(!1),v(!1)}},[]),D=(0,g.useCallback)(async(z=!1)=>{if(!l){C([]);return}z?N(!0):E(!0);try{const k=R.current,O=await On(l,z&&k.length>0?k[k.length-1].sortTimestamp:null,10);O.length<10?L(!1):L(!0),C(z?U=>[...U,...O]:O)}catch(k){console.error("Failed to search posts:",k)}finally{E(!1),N(!1)}},[l]);(0,g.useEffect)(()=>{I()},[I]),(0,g.useEffect)(()=>{l?D():C([])},[l,D]);const S=(0,g.useMemo)(()=>{let z=f;return l&&(z=z.filter(k=>k.name?.toLowerCase().includes(l.toLowerCase())||k.handle?.toLowerCase().includes(l.toLowerCase()))),z},[f,l]);return{currentUser:t,searchQuery:l,setSearchQuery:z=>{o(z)},activeTab:c,setActiveTab:u,isCreateModalOpen:d,setIsCreateModalOpen:m,communitiesData:f,isCommunitiesLoading:p,isFetchingMoreCommunities:b,hasMoreCommunities:j,postsData:_,isPostsLoading:F,isFetchingMorePosts:M,hasMorePosts:P,filteredCommunities:S,handleCommunityClick:z=>{e(`/c/${z}`)},loadCommunities:I,loadPosts:D,navigate:e}};var Sa=({id:t,user:e,timeAgo:a,content:i,contentClass:n,media:r,quotedPost:l,stats:o,onClick:c,repostedBy:u,onUserClick:d,currentUser:m,showToast:f,poll:h,isDetail:p,initialComments:x,onDelete:b,isComment:v,onReply:j,community:w})=>{const y=ge(),{liked:_,reposted:C,localStats:F,setLocalStats:E,handleLike:M,handleRepost:N}=ic(t,o,m,f),{deletePost:P,updatePost:L}=kt(),[R,I]=(0,g.useState)(x||[]),[D,S]=(0,g.useState)(""),[$,q]=(0,g.useState)(!1),[z,k]=(0,g.useState)(!1),[O,U]=(0,g.useState)(!1),[T,W]=(0,g.useState)(!0),[Q,Z]=(0,g.useState)([]),[ae,ie]=(0,g.useState)(!1),[G,se]=(0,g.useState)(!1),[ne,V]=(0,g.useState)(!1),[H,X]=(0,g.useState)(i),[ee,J]=(0,g.useState)(r||[]),[ce,te]=(0,g.useState)([]),[de,fe]=(0,g.useState)(!1),[ve,Ze]=(0,g.useState)(!1),He=(0,g.useRef)(null),Fe=(0,g.useRef)(R);(0,g.useEffect)(()=>{Fe.current=R},[R]);const Ae=async()=>{const Y=JSON.stringify(ee)!==JSON.stringify(r||[])||ce.length>0;if(!H.trim()||H===i&&!Y){V(!1);return}fe(!0);try{const re=[];for(const B of ce){const le=await Pe(B);re.push(le)}await L(t,{content:H,media:[...ee,...re]}),te([]),V(!1),f&&f("Post updated")}catch(re){console.error("Failed to update post:",re),f&&f("Failed to update post")}finally{fe(!1)}},Re=async Y=>{Y&&Y.stopPropagation();try{await P(t),f&&f("Post deleted successfully"),b&&b(t)}catch(re){console.error("Failed to delete post:",re),f&&f("Failed to delete post")}finally{se(!1)}},ye=(0,g.useCallback)(async(Y=!1)=>{if(t){Y?U(!0):q(!0);try{const re=Fe.current,B=await In(t,Y&&re.length>0?re[re.length-1].created_at:null,10);B.length<10?W(!1):W(!0),I(Y?le=>[...le,...B]:B)}catch(re){console.error("Failed to load comments:",re)}finally{q(!1),U(!1)}}},[t]);(0,g.useEffect)(()=>{p&&t&&ye()},[p,t,ye]);const nt=async Y=>{if(Y.preventDefault(),!(!D.trim()&&Q.length===0||!m)){k(!0),ie(!0);try{const re=[];for(const B of Q){const le=await Pe(B);re.push(le)}await En(t,m.id,D,re),S(""),Z([]),E(B=>({...B,comments:(B.comments||0)+1})),f&&f("Reply posted!"),ye()}catch(re){console.error("Failed to post comment:",re),f&&f("Failed to post reply.")}finally{k(!1),ie(!1)}}},Oe=Y=>{Y.stopPropagation();const re=`${window.location.origin}/post/${t}`;navigator.clipboard.writeText(re),f&&f("Link copied to clipboard!")},Le=({trigger:Y})=>(0,s.jsxs)(da,{children:[(0,s.jsx)(ma,{asChild:!0,onClick:re=>re.stopPropagation(),children:Y}),(0,s.jsxs)(ua,{align:"end",className:"w-48 rounded-xl bg-white dark:bg-zinc-900 border-zinc-100 dark:border-zinc-800",children:[(0,s.jsxs)(Xe,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5",onClick:Oe,children:[(0,s.jsx)(ws,{size:16}),(0,s.jsx)("span",{children:"Copy link to post"})]}),!v&&(0,s.jsxs)(Xe,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5",onClick:re=>{re.stopPropagation(),f&&f("Post reported")},children:[(0,s.jsx)(Vi,{size:16}),(0,s.jsx)("span",{children:"Report post"})]}),!Ie&&(0,s.jsxs)(Xe,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5 text-rose-500 focus:text-rose-500",onClick:re=>{re.stopPropagation(),f&&f("User blocked")},children:[(0,s.jsx)(cn,{size:16}),(0,s.jsxs)("span",{children:["Block @",e.handle]})]}),Ie&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(xl,{className:"bg-zinc-100 dark:bg-zinc-800"}),(0,s.jsxs)(Xe,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-900 py-2.5",onClick:re=>{re.stopPropagation(),V(!0)},children:[(0,s.jsx)(xs,{size:16}),(0,s.jsx)("span",{children:"Edit post"})]}),(0,s.jsxs)(Xe,{className:"gap-2 cursor-pointer focus:bg-rose-50 dark:focus:bg-rose-900/20 py-2.5 text-rose-500 focus:text-rose-500",onClick:re=>{re.stopPropagation(),se(!0)},children:[(0,s.jsx)(bs,{size:16}),(0,s.jsx)("span",{children:"Delete post"})]})]})]})]}),Ie=m?.handle===e.handle,Ee=Y=>{if(!Y)return null;const re=ne?ee:Y;return!re||Array.isArray(re)&&re.length===0?null:ne?(0,s.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,s.jsxs)("div",{className:"grid gap-2 grid-cols-2 sm:grid-cols-3",children:[ee.map((B,le)=>(0,s.jsxs)("div",{className:"relative aspect-square rounded-xl overflow-hidden border border-zinc-200 dark:border-zinc-800 group",children:[B.type==="video"?(0,s.jsx)("div",{className:"size-full bg-zinc-100 dark:bg-zinc-900 flex items-center justify-center",children:(0,s.jsx)(vt,{size:24,className:"text-zinc-400"})}):(0,s.jsx)("img",{src:B.url||B.src,className:"size-full object-cover",alt:""}),(0,s.jsx)("button",{onClick:Ce=>{Ce.stopPropagation(),J(qe=>qe.filter((Be,ze)=>ze!==le))},className:"absolute top-1.5 right-1.5 size-7 rounded-full bg-black/60 text-white flex items-center justify-center hover:bg-black transition-colors",children:(0,s.jsx)(_e,{size:16})})]},`old-${le}`)),ce.map((B,le)=>(0,s.jsxs)("div",{className:"relative aspect-square rounded-xl overflow-hidden border-2 border-dashed border-violet-500 bg-violet-50/10 group",children:[B.type.startsWith("image/")?(0,s.jsx)("img",{src:URL.createObjectURL(B),className:"size-full object-cover",alt:""}):(0,s.jsx)("div",{className:"size-full flex items-center justify-center",children:(0,s.jsx)(vt,{size:24,className:"text-violet-500 animate-pulse"})}),(0,s.jsx)("button",{onClick:Ce=>{Ce.stopPropagation(),te(qe=>qe.filter((Be,ze)=>ze!==le))},className:"absolute top-1.5 right-1.5 size-7 rounded-full bg-black/60 text-white flex items-center justify-center hover:bg-black transition-colors",children:(0,s.jsx)(_e,{size:16})}),(0,s.jsx)("div",{className:"absolute bottom-1 left-1 bg-violet-600 text-white text-[8px] font-bold px-1 rounded",children:"NEW"})]},`new-${le}`)),ee.length+ce.length<4&&(0,s.jsxs)("button",{onClick:B=>{B.stopPropagation(),He.current?.click()},className:"relative aspect-square rounded-xl border-2 border-dashed border-zinc-200 dark:border-zinc-800 flex flex-col items-center justify-center gap-1 text-zinc-400 hover:text-violet-500 hover:border-violet-500 hover:bg-violet-50/5 transition-all",children:[(0,s.jsx)(De,{size:20}),(0,s.jsx)("span",{className:"text-[10px] font-bold",children:"Add Media"})]})]}),(0,s.jsx)("input",{type:"file",ref:He,onChange:B=>{const le=Array.from(B.target.files);te(Ce=>[...Ce,...le])},multiple:!0,className:"hidden",accept:"image/*,video/*"})]}):g.isValidElement(re)?re:(0,s.jsx)(Ko,{items:re})},Te=(Y,re)=>{const B=typeof Y=="string"&&Dr(Y);if(ne)return(0,s.jsxs)("div",{className:"flex flex-col gap-2 mt-2",onClick:le=>le.stopPropagation(),children:[(0,s.jsx)(Yl,{value:H,onChange:le=>X(le.target.value),className:`min-h-[100px] w-full bg-zinc-50 dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800 rounded-xl focus:ring-violet-500 ${B?"font-bangla text-lg":"font-english"}`,autoFocus:!0}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)("button",{onClick:()=>{V(!1),X(i),J(r||[]),te([])},className:"px-4 py-1.5 text-sm font-bold text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-300 transition-colors",children:"Cancel"}),(0,s.jsx)("button",{onClick:Ae,disabled:de||!H.trim()||H===i,className:"px-4 py-1.5 text-sm font-bold bg-violet-600 text-white rounded-full hover:bg-violet-700 disabled:opacity-50 transition-all active:scale-95",children:de?"Saving...":"Save"})]})]});if(typeof Y=="string"){const le=!p&&Y.length>280,Ce=le&&!ve?Y.substring(0,280):Y;return(0,s.jsxs)("div",{className:`whitespace-pre-line ${re||""} ${B?"font-bangla text-[1.15em] leading-relaxed":"font-english text-[1.05em]"}`,children:[(0,s.jsx)(ct,{options:{...ft,render:({attributes:qe,content:Be})=>{const{href:ze,...Jt}=qe,Qt=!ze.startsWith("/")&&(ze.startsWith("http")||ze.startsWith("www"));return ze.startsWith("/u/")||ze.startsWith("/explore")?(0,s.jsx)("span",{...Jt,onClick:$a=>{$a.stopPropagation(),y(ze)},children:Be},Be):(0,s.jsx)("a",{href:ze,...Jt,target:Qt?"_blank":void 0,rel:Qt?"noopener noreferrer":void 0,children:Be},Be)}},children:Ce}),le&&!ve&&"...",le&&(0,s.jsx)("button",{onClick:qe=>{qe.stopPropagation(),Ze(!ve)},className:"ml-1 text-rose-500 dark:text-rose-400 font-bold hover:underline cursor-pointer",children:ve?"Show less":"See more"})]})}return Y},We=Y=>{S(re=>{const B=`@${Y} `;return re.includes(B)?re:re+B}),document.getElementById("comment-input")?.focus()};return p?(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("article",{className:"p-5 dark:bg-black",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex items-start gap-x-3",children:[(0,s.jsx)("button",{className:"shrink-0",onClick:()=>d&&d(e.handle),children:(0,s.jsxs)(xe,{className:"size-12 border border-zinc-200 dark:border-zinc-700",children:[(0,s.jsx)(he,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,s.jsx)(pe,{children:e.handle[0]?.toUpperCase()})]})}),(0,s.jsxs)("div",{className:"flex flex-col min-w-0",children:[(0,s.jsx)("div",{className:"flex flex-wrap items-center gap-x-1.5",children:(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-1.5 text-base sm:text-lg",children:[(0,s.jsxs)("button",{className:"font-bold hover:underline text-zinc-900 dark:text-white flex items-center gap-1 shrink-0",onClick:()=>d&&d(e.handle),children:[e.handle,e.verified&&(0,s.jsx)(lt,{})]}),w&&(0,s.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,s.jsx)("span",{className:"text-zinc-400 font-medium text-sm sm:text-base",children:">"}),(0,s.jsxs)("button",{className:"flex items-center gap-1 font-bold text-zinc-900 dark:text-zinc-100 hover:underline",onClick:Y=>{Y.stopPropagation(),y(`/c/${w.handle}`)},children:[(0,s.jsxs)(xe,{className:"size-5 bg-zinc-100 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700",children:[(0,s.jsx)(he,{src:w.avatar,alt:w.name,className:"object-cover"}),(0,s.jsx)(pe,{className:"text-[9px] font-bold text-zinc-500",children:w.name?.[0]?.toUpperCase()})]}),w.name]})]})]})}),(0,s.jsxs)("span",{className:"text-xs sm:text-sm text-zinc-500 dark:text-zinc-400 font-medium",children:["@",e.handle]})]})]}),(0,s.jsx)(Le,{trigger:(0,s.jsx)("button",{className:"text-zinc-500 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full p-2 transition-colors",children:(0,s.jsx)(Lt,{size:20})})})]}),(0,s.jsx)("div",{className:"break-words text-zinc-900 dark:text-zinc-100 mt-4 text-lg sm:text-xl leading-relaxed sm:leading-8 whitespace-pre-line",children:Te(i,n)}),ht(i)&&(0,s.jsx)(os,{url:ht(i)}),Ee(r),h&&(0,s.jsx)(cs,{poll:h}),l&&(0,s.jsx)("div",{className:"mt-4 border border-zinc-200 dark:border-zinc-700 rounded-2xl overflow-hidden shadow-sm",children:(0,s.jsx)(ds,{...l})}),(0,s.jsx)("div",{className:"my-4 flex items-center text-zinc-500 dark:text-zinc-400 text-sm border-b border-zinc-100 dark:border-zinc-800 pb-4",children:a||"Recent"}),(0,s.jsxs)("div",{className:"border-b border-zinc-100 dark:border-zinc-800 pb-4 flex items-center gap-x-6 text-zinc-500 dark:text-zinc-400 text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,s.jsx)("span",{className:"font-bold text-black dark:text-white",children:F.likes||0})," ",(0,s.jsx)("span",{className:"opacity-70",children:"Likes"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,s.jsx)("span",{className:"font-bold text-black dark:text-white",children:F.comments||0})," ",(0,s.jsx)("span",{className:"opacity-70",children:"Comments"})]})]}),(0,s.jsxs)("div",{className:"mt-4 flex w-full items-center justify-around py-1",children:[(0,s.jsx)(et,{icon:rt,label:"Like",onClick:M,active:_,activeColorClass:"text-rose-500"}),!v&&(0,s.jsx)(et,{icon:$t,label:"Repost",onClick:N,active:C,activeColorClass:"text-emerald-500"}),(0,s.jsx)(et,{icon:Rt,label:"Comment",onClick:()=>document.getElementById("comment-input")?.focus()})]})]}),(0,s.jsx)(Ro,{currentUser:m,newComment:D,setNewComment:S,handleSubmitComment:nt,loading:z,selectedFiles:Q,setSelectedFiles:Z,isUploading:ae}),(0,s.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:$?(0,s.jsx)("div",{className:"p-8 flex justify-center",children:(0,s.jsx)(me,{className:"animate-spin text-violet-500"})}):(0,s.jsxs)(s.Fragment,{children:[T&&R.length>0&&(0,s.jsxs)("button",{onClick:()=>ye(!0),disabled:O,className:"w-full py-3 text-sm font-bold text-violet-600 hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors flex items-center justify-center gap-2",children:[O&&(0,s.jsx)(me,{size:14,className:"animate-spin"}),"View more replies"]}),R.map(Y=>(0,s.jsx)(Sa,{...Y,isComment:!0,onReply:We,onUserClick:d,currentUser:m,showToast:f,onDelete:re=>I(B=>B.filter(le=>le.id!==re))},Y.id))]})}),(0,s.jsx)(Gt,{open:G,onOpenChange:se,children:(0,s.jsxs)(Zt,{onClick:Y=>Y.stopPropagation(),children:[(0,s.jsxs)(es,{children:[(0,s.jsx)(ss,{children:"Are you absolutely sure?"}),(0,s.jsx)(as,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,s.jsxs)(ts,{children:[(0,s.jsx)(ns,{onClick:Y=>Y.stopPropagation(),children:"Cancel"}),(0,s.jsx)(is,{onClick:Re,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]}):(0,s.jsxs)("article",{onClick:c,className:`p-4 mb-4 bg-white dark:bg-black rounded-xl hover:shadow-md transition-all ${c?"cursor-pointer":""}`,children:[u&&(0,s.jsxs)("div",{className:"mb-2 flex items-center space-x-1.5 text-[13px] text-zinc-500 font-semibold ml-1",children:[(0,s.jsx)($t,{size:14,className:"text-zinc-400"}),(0,s.jsx)("span",{className:"hover:underline cursor-pointer flex items-center text-zinc-600 dark:text-zinc-400",onClick:Y=>{Y.stopPropagation(),d&&d(u.handle)},children:(0,s.jsx)("span",{className:"truncate max-w-[150px]",children:typeof u=="object"?u.name:u})}),(0,s.jsx)("span",{className:"text-zinc-400",children:"reposted"})]}),(0,s.jsxs)("div",{className:"flex items-start gap-x-3",children:[(0,s.jsx)("button",{className:"shrink-0 group",onClick:Y=>{Y.stopPropagation(),d&&d(e.handle)},children:(0,s.jsxs)(xe,{className:"size-11 border border-zinc-200 dark:border-zinc-700 group-hover:brightness-95 transition-all",children:[(0,s.jsx)(he,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,s.jsx)(pe,{children:e.handle[0]?.toUpperCase()})]})}),(0,s.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,s.jsxs)("div",{className:"flex w-full items-start justify-between",children:[(0,s.jsx)("div",{className:"flex flex-col min-w-0 flex-1",children:(0,s.jsx)("div",{className:"flex flex-wrap items-center gap-x-1.5 leading-none",children:(0,s.jsxs)("div",{className:"flex items-center gap-1.5 min-w-0 max-w-full",children:[(0,s.jsxs)("button",{className:"font-bold text-[15px] hover:underline text-zinc-900 dark:text-white flex items-center gap-1 shrink-0",onClick:Y=>{Y.stopPropagation(),d&&d(e.handle)},children:[(0,s.jsx)("span",{className:"truncate max-w-[120px] sm:max-w-[200px]",children:e.handle}),e.verified&&(0,s.jsx)(lt,{})]}),w&&(0,s.jsxs)("div",{className:"flex items-center gap-1 min-w-0 text-zinc-500",children:[(0,s.jsx)("span",{className:"text-zinc-400 font-medium shrink-0 text-xs sm:text-sm",children:">"}),(0,s.jsxs)("button",{className:"flex items-center gap-1 font-bold text-zinc-900 dark:text-zinc-100 hover:underline truncate max-w-[100px] sm:max-w-[180px] text-[14px] sm:text-[15px]",onClick:Y=>{Y.stopPropagation(),y(`/c/${w.handle}`)},children:[(0,s.jsxs)(xe,{className:"size-4 bg-zinc-100 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700",children:[(0,s.jsx)(he,{src:w.avatar,alt:w.name,className:"object-cover"}),(0,s.jsx)(pe,{className:"text-[8px] font-bold text-zinc-500",children:w.name?.[0]?.toUpperCase()})]}),w.name]})]}),(0,s.jsx)("span",{className:"text-zinc-400 text-xs sm:text-sm whitespace-nowrap pt-0.5 ml-1",children:a||"Recent"})]})})}),(0,s.jsx)(Le,{trigger:(0,s.jsx)("button",{className:"text-zinc-400 hover:bg-zinc-100 hover:text-zinc-700 dark:hover:bg-zinc-800 dark:hover:text-zinc-200 rounded-full p-2 -mr-2 transition-colors",children:(0,s.jsx)(Lt,{size:18})})})]}),(0,s.jsxs)("div",{className:"break-words text-zinc-900 dark:text-zinc-100 mt-1 whitespace-pre-line text-sm sm:text-[15px] leading-relaxed",children:[Te(i,n),ht(i)&&(0,s.jsx)(os,{url:ht(i)}),Ee(r),h&&(0,s.jsx)(cs,{poll:h,onVote:()=>f&&f("Voted!")}),l&&(0,s.jsx)("div",{className:"mt-3 border border-zinc-200 dark:border-zinc-700 rounded-2xl overflow-hidden bg-white dark:bg-zinc-900 hover:bg-zinc-50 dark:hover:bg-zinc-800 transition-colors cursor-pointer",onClick:Y=>Y.stopPropagation(),children:(0,s.jsx)(ds,{...l})})]}),(0,s.jsx)("div",{className:"mt-3 flex w-full flex-wrap items-center justify-between gap-3 pr-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4 sm:gap-x-8",children:[(0,s.jsx)(et,{icon:rt,label:"Like",count:F.likes,active:_,onClick:M,activeColorClass:"text-rose-500"}),!v&&(0,s.jsx)(et,{icon:$t,label:"Repost",count:F.mirrors,active:C,onClick:N,activeColorClass:"text-emerald-500"}),(0,s.jsx)(et,{icon:Rt,label:"Comment",count:F.comments,onClick:Y=>{v&&j?(Y.stopPropagation(),j(e.handle)):c&&c(Y)}})]})})]})]}),(0,s.jsx)(Gt,{open:G,onOpenChange:se,children:(0,s.jsxs)(Zt,{onClick:Y=>Y.stopPropagation(),children:[(0,s.jsxs)(es,{children:[(0,s.jsx)(ss,{children:"Are you absolutely sure?"}),(0,s.jsx)(as,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,s.jsxs)(ts,{children:[(0,s.jsx)(ns,{onClick:Y=>Y.stopPropagation(),children:"Cancel"}),(0,s.jsx)(is,{onClick:Re,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]})},xt=Sa,cc=K(),dc=t=>{const e=(0,cc.c)(28),{user:a,time:i,content:n}=t,r=ge();let l;e[0]!==a.avatar||e[1]!==a.handle?(l=(0,s.jsx)(he,{src:a.avatar,alt:a.handle}),e[0]=a.avatar,e[1]=a.handle,e[2]=l):l=e[2];let o;e[3]!==a.handle[0]?(o=a.handle[0]?.toUpperCase(),e[3]=a.handle[0],e[4]=o):o=e[4];let c;e[5]!==o?(c=(0,s.jsx)(pe,{children:o}),e[5]=o,e[6]=c):c=e[6];let u;e[7]!==l||e[8]!==c?(u=(0,s.jsxs)(xe,{className:"size-6",children:[l,c]}),e[7]=l,e[8]=c,e[9]=u):u=e[9];let d;e[10]!==a.handle?(d=(0,s.jsx)("span",{className:"font-semibold text-sm",children:a.handle}),e[10]=a.handle,e[11]=d):d=e[11];let m;e[12]!==i?(m=(0,s.jsxs)("span",{className:"text-zinc-500 text-sm",children:[" ",i]}),e[12]=i,e[13]=m):m=e[13];let f;e[14]!==u||e[15]!==d||e[16]!==m?(f=(0,s.jsxs)("div",{className:"flex items-center gap-x-2 mb-2",children:[u,d,m]}),e[14]=u,e[15]=d,e[16]=m,e[17]=f):f=e[17];let h;e[18]!==r?(h={...ft,render:v=>{const{attributes:j,content:w}=v,{href:y,..._}=j,C=!y.startsWith("/")&&(y.startsWith("http")||y.startsWith("www"));return y.startsWith("/u/")||y.startsWith("/explore")?(0,s.jsx)("span",{..._,onClick:F=>{F.stopPropagation(),r(y)},children:w},w):(0,s.jsx)("a",{href:y,..._,target:C?"_blank":void 0,rel:C?"noopener noreferrer":void 0,onClick:mc,children:w},w)}},e[18]=r,e[19]=h):h=e[19];let p;e[20]!==n?(p=(0,s.jsx)("p",{className:"text-sm text-zinc-800 dark:text-zinc-300 whitespace-pre-line",children:n}),e[20]=n,e[21]=p):p=e[21];let x;e[22]!==h||e[23]!==p?(x=(0,s.jsx)(ct,{options:h,children:p}),e[22]=h,e[23]=p,e[24]=x):x=e[24];let b;return e[25]!==x||e[26]!==f?(b=(0,s.jsxs)("div",{className:"p-4",children:[f,x]}),e[25]=x,e[26]=f,e[27]=b):b=e[27],b},ds=dc;function mc(t){return t.stopPropagation()}var uc=K(),fc=t=>{const e=(0,uc.c)(66),{reel:a,isActive:i}=t,n=ge(),r=(0,g.useRef)(null),[l,o]=(0,g.useState)(!1),c=(0,g.useRef)(0),u=Array.isArray(a.media)?a.media[0]?.src||a.media[0]?.url:a.media?.src||a.media?.url||a.url;let d,m;e[0]!==i?(d=()=>{r.current?.plyr&&(i?r.current.plyr.play().catch(ee=>{console.error("Autoplay failed:",ee),r.current.plyr.muted=!0,r.current.plyr.play()}):r.current.plyr.pause())},m=[i],e[0]=i,e[1]=d,e[2]=m):(d=e[1],m=e[2]),(0,g.useEffect)(d,m);let f;e[3]===Symbol.for("react.memo_cache_sentinel")?(f=()=>{const ee=Date.now();ee-c.current<300&&(o(!0),setTimeout(()=>o(!1),800)),c.current=ee},e[3]=f):f=e[3];const h=f;let p;e[4]!==u?(p={type:"video",sources:[{src:u,type:"video/mp4"}]},e[4]=u,e[5]=p):p=e[5];let x;e[6]===Symbol.for("react.memo_cache_sentinel")?(x={controls:[],loop:{active:!0},clickToPlay:!0,ratio:"9:16"},e[6]=x):x=e[6];let b;e[7]!==p?(b={source:p,options:x},e[7]=p,e[8]=b):b=e[8];const v=b;let j;e[9]!==v?(j=(0,s.jsx)("div",{className:"w-full h-full max-w-[450px]",children:(0,s.jsx)(Es,{ref:r,...v})}),e[9]=v,e[10]=j):j=e[10];let w;e[11]!==l?(w=l&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-50 animate-in zoom-in-50 fade-in duration-300",children:(0,s.jsx)(rt,{size:100,fill:"white",className:"text-white drop-shadow-2xl scale-125"})}),e[11]=l,e[12]=w):w=e[12];let y;e[13]===Symbol.for("react.memo_cache_sentinel")?(y=(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-black/60 pointer-events-none"}),e[13]=y):y=e[13];const _=`/u/${a.user?.handle}`,C=a.user?.avatar,F=a.user?.handle;let E;e[14]!==C||e[15]!==F?(E=(0,s.jsx)(he,{src:C,alt:F,className:"object-cover"}),e[14]=C,e[15]=F,e[16]=E):E=e[16];let M;e[17]!==a.user?.handle?.[0]?(M=a.user?.handle?.[0]?.toUpperCase(),e[17]=a.user?.handle?.[0],e[18]=M):M=e[18];let N;e[19]!==M?(N=(0,s.jsx)(pe,{children:M}),e[19]=M,e[20]=N):N=e[20];let P;e[21]!==E||e[22]!==N?(P=(0,s.jsxs)(xe,{className:"size-10 border-2 border-white",children:[E,N]}),e[21]=E,e[22]=N,e[23]=P):P=e[23];const L=a.user?.handle;let R;e[24]!==L?(R=(0,s.jsxs)("span",{className:"font-bold",children:["@",L]}),e[24]=L,e[25]=R):R=e[25];let I;e[26]!==_||e[27]!==P||e[28]!==R?(I=(0,s.jsxs)(At,{to:_,className:"flex items-center gap-2 hover:opacity-80 transition-opacity",onClick:hc,children:[P,R]}),e[26]=_,e[27]=P,e[28]=R,e[29]=I):I=e[29];let D;e[30]===Symbol.for("react.memo_cache_sentinel")?(D=(0,s.jsx)("button",{className:"bg-white text-black text-xs font-bold px-3 py-1 rounded-full ml-2 hover:scale-105 active:scale-95 transition-all",onClick:pc,children:"Follow"}),e[30]=D):D=e[30];let S;e[31]!==I?(S=(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3 pointer-events-auto",children:[I,D]}),e[31]=I,e[32]=S):S=e[32];let $;e[33]!==n?($={...ft,render:ee=>{const{attributes:J,content:ce}=ee,{href:te,...de}=J,fe=!te.startsWith("/")&&(te.startsWith("http")||te.startsWith("www"));return te.startsWith("/u/")||te.startsWith("/explore")?(0,s.jsx)("span",{...de,className:"text-white font-bold hover:underline cursor-pointer",onClick:ve=>{ve.stopPropagation(),n(te)},children:ce},ce):(0,s.jsx)("a",{href:te,...de,className:"text-white hover:underline",target:fe?"_blank":void 0,rel:fe?"noopener noreferrer":void 0,onClick:bc,children:ce},ce)}},e[33]=n,e[34]=$):$=e[34];let q;e[35]!==a.content?(q=(0,s.jsx)("p",{className:"text-sm mb-3 line-clamp-2",children:a.content}),e[35]=a.content,e[36]=q):q=e[36];let z;e[37]!==$||e[38]!==q?(z=(0,s.jsx)(ct,{options:$,children:q}),e[37]=$,e[38]=q,e[39]=z):z=e[39];let k;e[40]===Symbol.for("react.memo_cache_sentinel")?(k=(0,s.jsx)(mi,{size:14,className:"animate-spin-slow"}),e[40]=k):k=e[40];const O=a.user?.handle;let U;e[41]!==O?(U=(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs opacity-90",children:[k,(0,s.jsxs)("span",{children:["Original Audio - ",O]})]}),e[41]=O,e[42]=U):U=e[42];let T;e[43]!==S||e[44]!==z||e[45]!==U?(T=(0,s.jsxs)("div",{className:"absolute bottom-20 left-4 right-16 text-white pointer-events-none",children:[S,z,U]}),e[43]=S,e[44]=z,e[45]=U,e[46]=T):T=e[46];let W;e[47]===Symbol.for("react.memo_cache_sentinel")?(W=(0,s.jsx)("button",{className:"p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90",children:(0,s.jsx)(rt,{size:28})}),e[47]=W):W=e[47];const Q=a.stats?.likes||0;let Z;e[48]!==Q?(Z=(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[W,(0,s.jsx)("span",{className:"text-white text-xs font-bold",children:Q})]}),e[48]=Q,e[49]=Z):Z=e[49];let ae;e[50]===Symbol.for("react.memo_cache_sentinel")?(ae=(0,s.jsx)("button",{className:"p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90",children:(0,s.jsx)(Rt,{size:28})}),e[50]=ae):ae=e[50];const ie=a.stats?.comments||0;let G;e[51]!==ie?(G=(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[ae,(0,s.jsx)("span",{className:"text-white text-xs font-bold",children:ie})]}),e[51]=ie,e[52]=G):G=e[52];let se;e[53]===Symbol.for("react.memo_cache_sentinel")?(se=(0,s.jsx)("button",{className:"p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90",children:(0,s.jsx)(Ga,{size:28})}),e[53]=se):se=e[53];const ne=a.stats?.shares||0;let V;e[54]!==ne?(V=(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[se,(0,s.jsx)("span",{className:"text-white text-xs font-bold",children:ne})]}),e[54]=ne,e[55]=V):V=e[55];let H;e[56]!==Z||e[57]!==G||e[58]!==V?(H=(0,s.jsxs)("div",{className:"absolute bottom-20 right-2 flex flex-col items-center gap-6 z-10",children:[Z,G,V]}),e[56]=Z,e[57]=G,e[58]=V,e[59]=H):H=e[59];let X;return e[60]!==a.id||e[61]!==T||e[62]!==H||e[63]!==j||e[64]!==w?(X=(0,s.jsxs)("div",{"data-id":a.id,className:"reel-item relative h-screen w-full bg-black snap-start flex items-center justify-center overflow-hidden",onClick:h,children:[j,w,y,T,H]}),e[60]=a.id,e[61]=T,e[62]=H,e[63]=j,e[64]=w,e[65]=X):X=e[65],X},xc=fc;function hc(t){return t.stopPropagation()}function pc(t){return t.stopPropagation()}function bc(t){return t.stopPropagation()}var gc=K(),vc=t=>{const e=(0,gc.c)(96),{onPostInCommunity:a}=t,[i,n]=g.useState(!1),{community:r,loading:l,isMember:o,userRole:c,isJoining:u,communityPosts:d,loadingPosts:m,isFetchingMorePosts:f,hasMorePosts:h,handleJoinToggle:p,loadCommunityPosts:x,currentUser:b,addToast:v,navigate:j}=lc(),w=o&&(!r.isPrivate||c==="admin");if(l){let de;return e[0]===Symbol.for("react.memo_cache_sentinel")?(de=(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)(me,{size:40,className:"animate-spin text-violet-500"})}),e[0]=de):de=e[0],de}if(!r){const de=`The community @${r?.handle||"unknown"} could not be found.`;let fe;return e[1]!==de?(fe=(0,s.jsx)("div",{className:"bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-[600px] flex items-center justify-center",children:(0,s.jsx)(Ut,{title:"Community doesn't exist",message:de,icon:Ye})}),e[1]=de,e[2]=fe):fe=e[2],fe}let y;e[3]!==j?(y=()=>j(-1),e[3]=j,e[4]=y):y=e[4];let _;e[5]===Symbol.for("react.memo_cache_sentinel")?(_=(0,s.jsx)(tt,{size:22}),e[5]=_):_=e[5];let C;e[6]!==y?(C=(0,s.jsx)("button",{onClick:y,className:"p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:_}),e[6]=y,e[7]=C):C=e[7];let F;e[8]!==r.name?(F=(0,s.jsx)("h5",{className:"text-lg font-bold dark:text-white leading-none",children:r.name}),e[8]=r.name,e[9]=F):F=e[9];let E;e[10]!==r.membersCount?(E=(0,s.jsxs)("span",{className:"text-xs text-zinc-500 mt-0.5",children:[r.membersCount," Members"]}),e[10]=r.membersCount,e[11]=E):E=e[11];let M;e[12]!==F||e[13]!==E?(M=(0,s.jsxs)("div",{className:"flex flex-col",children:[F,E]}),e[12]=F,e[13]=E,e[14]=M):M=e[14];let N;e[15]!==C||e[16]!==M?(N=(0,s.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4",children:[C,M]})}),e[15]=C,e[16]=M,e[17]=N):N=e[17];let P;e[18]!==r.cover?(P=(0,s.jsx)("div",{className:"h-32 sm:h-52 bg-zinc-100 dark:bg-zinc-900 overflow-hidden relative",children:r.cover?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("img",{src:r.cover,className:"w-full h-full object-cover",alt:""}),(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 to-transparent"})]}):(0,s.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-violet-500/20 to-fuchsia-500/20"})}),e[18]=r.cover,e[19]=P):P=e[19];let L;e[20]!==r.avatar?(L=(0,s.jsx)("div",{className:"size-24 sm:size-32 rounded-3xl border-4 border-white dark:border-black bg-zinc-100 dark:bg-zinc-800 overflow-hidden shadow-xl",children:(0,s.jsx)("img",{src:r.avatar,className:"size-full object-cover",alt:""})}),e[20]=r.avatar,e[21]=L):L=e[21];let R;e[22]!==c?(R=c==="admin"&&(0,s.jsx)(ue,{variant:"outline",onClick:()=>n(!0),className:"rounded-full font-bold px-6 h-10 border-zinc-200 dark:border-zinc-800",children:"Edit"}),e[22]=c,e[23]=R):R=e[23];const I=o?"outline":"default",D=`rounded-full font-bold px-8 h-10 transition-all ${o?"border-zinc-200 dark:border-zinc-800 hover:bg-rose-50 hover:text-rose-500 hover:border-rose-100 dark:hover:bg-rose-900/20":"bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 hover:scale-105"}`;let S;e[24]!==u||e[25]!==o?(S=u?(0,s.jsx)(me,{size:18,className:"animate-spin"}):o?"Joined":"Join",e[24]=u,e[25]=o,e[26]=S):S=e[26];let $;e[27]!==p||e[28]!==u||e[29]!==I||e[30]!==D||e[31]!==S?($=(0,s.jsx)(ue,{variant:I,onClick:p,disabled:u,className:D,children:S}),e[27]=p,e[28]=u,e[29]=I,e[30]=D,e[31]=S,e[32]=$):$=e[32];let q;e[33]!==R||e[34]!==$?(q=(0,s.jsxs)("div",{className:"pb-1 flex gap-2",children:[R,$]}),e[33]=R,e[34]=$,e[35]=q):q=e[35];let z;e[36]!==q||e[37]!==L?(z=(0,s.jsxs)("div",{className:"flex justify-between items-end -mt-12 sm:-mt-16 mb-4 relative z-10",children:[L,q]}),e[36]=q,e[37]=L,e[38]=z):z=e[38];let k;e[39]!==r.name?(k=(0,s.jsx)("h1",{className:"text-2xl sm:text-3xl font-black dark:text-white tracking-tight leading-tight",children:r.name}),e[39]=r.name,e[40]=k):k=e[40];let O;e[41]!==r.handle?(O=(0,s.jsxs)("p",{className:"text-zinc-500 font-bold text-sm sm:text-base",children:["c/",r.handle]}),e[41]=r.handle,e[42]=O):O=e[42];let U;e[43]!==r.description?(U=r.description&&(0,s.jsx)("p",{className:"mt-4 text-[15px] sm:text-base dark:text-zinc-300 leading-relaxed max-w-2xl",children:r.description}),e[43]=r.description,e[44]=U):U=e[44];let T;e[45]!==r.membersCount?(T=(0,s.jsx)("span",{className:"text-lg font-black dark:text-white",children:r.membersCount}),e[45]=r.membersCount,e[46]=T):T=e[46];let W;e[47]===Symbol.for("react.memo_cache_sentinel")?(W=(0,s.jsx)("span",{className:"text-[11px] font-bold uppercase tracking-widest text-zinc-500",children:"Members"}),e[47]=W):W=e[47];let Q;e[48]!==T?(Q=(0,s.jsxs)("div",{className:"flex flex-col",children:[T,W]}),e[48]=T,e[49]=Q):Q=e[49];let Z;e[50]!==r.postsCount?(Z=(0,s.jsx)("span",{className:"text-lg font-black dark:text-white",children:r.postsCount}),e[50]=r.postsCount,e[51]=Z):Z=e[51];let ae;e[52]===Symbol.for("react.memo_cache_sentinel")?(ae=(0,s.jsx)("span",{className:"text-[11px] font-bold uppercase tracking-widest text-zinc-500",children:"Posts"}),e[52]=ae):ae=e[52];let ie;e[53]!==Z?(ie=(0,s.jsxs)("div",{className:"flex flex-col",children:[Z,ae]}),e[53]=Z,e[54]=ie):ie=e[54];let G;e[55]!==Q||e[56]!==ie?(G=(0,s.jsxs)("div",{className:"flex gap-6 mt-5",children:[Q,ie]}),e[55]=Q,e[56]=ie,e[57]=G):G=e[57];let se;e[58]!==k||e[59]!==O||e[60]!==U||e[61]!==G?(se=(0,s.jsxs)("div",{className:"space-y-1",children:[k,O,U,G]}),e[58]=k,e[59]=O,e[60]=U,e[61]=G,e[62]=se):se=e[62];let ne;e[63]!==z||e[64]!==se?(ne=(0,s.jsxs)("div",{className:"px-4 pb-6",children:[z,se]}),e[63]=z,e[64]=se,e[65]=ne):ne=e[65];let V;e[66]!==ne||e[67]!==P?(V=(0,s.jsxs)("div",{className:"relative",children:[P,ne]}),e[66]=ne,e[67]=P,e[68]=V):V=e[68];let H;e[69]!==v||e[70]!==r.id||e[71]!==r.name||e[72]!==d||e[73]!==b||e[74]!==h||e[75]!==f||e[76]!==x||e[77]!==m||e[78]!==j?(H=(0,s.jsx)("div",{className:"border-t border-zinc-100 dark:border-zinc-800",children:m?(0,s.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,s.jsx)(me,{className:"animate-spin text-violet-500",size:32})}):d.length>0?(0,s.jsxs)(s.Fragment,{children:[d.map(de=>(0,s.jsx)(xt,{currentUser:b,showToast:v,...de,onClick:()=>j(`/post/${de.id}`),onUserClick:fe=>j(`/u/${fe}`)},de.feed_id||de.id)),h&&(0,s.jsx)("div",{className:"p-6 flex justify-center",children:(0,s.jsxs)(ue,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>x(r.id,!0),disabled:f,children:[f&&(0,s.jsx)(me,{size:18,className:"animate-spin mr-2"}),"Load more"]})})]}):(0,s.jsxs)("div",{className:"p-20 text-center text-zinc-500 flex flex-col items-center gap-4",children:[(0,s.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full mb-2",children:(0,s.jsx)(Ye,{size:40,className:"text-zinc-300"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"No posts here yet"}),(0,s.jsxs)("p",{className:"text-sm max-w-[250px]",children:["Be the first to share something in ",r.name,"!"]})]})}),e[69]=v,e[70]=r.id,e[71]=r.name,e[72]=d,e[73]=b,e[74]=h,e[75]=f,e[76]=x,e[77]=m,e[78]=j,e[79]=H):H=e[79];let X;e[80]!==V||e[81]!==H||e[82]!==N?(X=(0,s.jsxs)("div",{className:"relative",children:[N,V,H]}),e[80]=V,e[81]=H,e[82]=N,e[83]=X):X=e[83];let ee;e[84]!==w||e[85]!==r||e[86]!==a?(ee=w&&(0,s.jsx)("button",{onClick:()=>a(r),className:"fixed bottom-20 right-5 md:hidden z-50 bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 size-12 rounded-full flex items-center justify-center shadow-2xl hover:scale-110 active:scale-90 transition-all cursor-pointer group",title:`Post to ${r.name}`,children:(0,s.jsx)(De,{size:28,className:"group-hover:rotate-90 transition-transform duration-300"})}),e[84]=w,e[85]=r,e[86]=a,e[87]=ee):ee=e[87];let J;e[88]===Symbol.for("react.memo_cache_sentinel")?(J=()=>n(!1),e[88]=J):J=e[88];let ce;e[89]!==r||e[90]!==i?(ce=(0,s.jsx)(xo,{isOpen:i,onClose:J,community:r,onUpdate:wc}),e[89]=r,e[90]=i,e[91]=ce):ce=e[91];let te;return e[92]!==X||e[93]!==ee||e[94]!==ce?(te=(0,s.jsxs)("div",{className:"border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:[X,ee,ce]}),e[92]=X,e[93]=ee,e[94]=ce,e[95]=te):te=e[95],te},jc=vc;function wc(){window.location.reload()}var yc=K(),zc=()=>{const t=(0,yc.c)(51),{addToast:e}=we(),{currentUser:a,searchQuery:i,setSearchQuery:n,activeTab:r,setActiveTab:l,isCreateModalOpen:o,setIsCreateModalOpen:c,communitiesData:u,isCommunitiesLoading:d,isFetchingMoreCommunities:m,hasMoreCommunities:f,postsData:h,isPostsLoading:p,isFetchingMorePosts:x,hasMorePosts:b,filteredCommunities:v,handleCommunityClick:j,loadCommunities:w,loadPosts:y,navigate:_}=oc();if((d||p)&&!u.length&&!h.length){let k;return t[0]===Symbol.for("react.memo_cache_sentinel")?(k=(0,s.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:[1,2,3].map(kc)}),t[0]=k):k=t[0],k}let C;t[1]!==n?(C=()=>n(""),t[1]=n,t[2]=C):C=t[2];let F;t[3]!==i||t[4]!==n||t[5]!==C?(F=(0,s.jsx)(jt,{value:i,onChange:n,onClear:C,placeholder:"Search communities or posts...",className:"flex-1"}),t[3]=i,t[4]=n,t[5]=C,t[6]=F):F=t[6];let E;t[7]!==a||t[8]!==c?(E=a&&(0,s.jsx)("button",{onClick:()=>c(!0),className:"size-11 rounded-xl bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 flex items-center justify-center hover:scale-105 active:scale-95 transition-all shadow-sm shrink-0",title:"Create Community",children:(0,s.jsx)(De,{size:22,strokeWidth:3})}),t[7]=a,t[8]=c,t[9]=E):E=t[9];let M;t[10]!==F||t[11]!==E?(M=(0,s.jsxs)("div",{className:"p-4 flex gap-2",children:[F,E]}),t[10]=F,t[11]=E,t[12]=M):M=t[12];let N;t[13]===Symbol.for("react.memo_cache_sentinel")?(N=(0,s.jsxs)(qt,{value:"communities",className:"h-full rounded-none border-b-2 border-transparent data-[state=active]:border-violet-600 data-[state=active]:bg-transparent px-2 font-bold text-zinc-500 data-[state=active]:text-zinc-950 dark:data-[state=active]:text-white transition-all gap-2",children:[(0,s.jsx)(Ye,{size:18}),"Communities"]}),t[13]=N):N=t[13];let P;t[14]===Symbol.for("react.memo_cache_sentinel")?(P=(0,s.jsxs)(_a,{className:"w-full h-12 bg-transparent p-0 rounded-none border-none gap-8 px-4",children:[N,(0,s.jsxs)(qt,{value:"posts",className:"h-full rounded-none border-b-2 border-transparent data-[state=active]:border-violet-600 data-[state=active]:bg-transparent px-2 font-bold text-zinc-500 data-[state=active]:text-zinc-950 dark:data-[state=active]:text-white transition-all gap-2",children:[(0,s.jsx)(Xt,{size:18}),"Posts"]})]}),t[14]=P):P=t[14];let L;t[15]!==r||t[16]!==l?(L=(0,s.jsx)("div",{className:"px-1 border-t border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)(ka,{value:r,onValueChange:l,className:"w-full",children:P})}),t[15]=r,t[16]=l,t[17]=L):L=t[17];let R;t[18]!==M||t[19]!==L?(R=(0,s.jsxs)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-10 border-b border-zinc-100 dark:border-zinc-800",children:[M,L]}),t[18]=M,t[19]=L,t[20]=R):R=t[20];let I;t[21]!==r||t[22]!==v||t[23]!==j||t[24]!==f||t[25]!==m||t[26]!==w?(I=r==="communities"&&(0,s.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:[v.length>0?v.map(k=>(0,s.jsx)(ga,{profile:k,onUserClick:j,isCommunity:!0},k.handle)):(0,s.jsx)("div",{className:"p-20 text-center text-zinc-500",children:(0,s.jsx)("p",{className:"font-bold",children:"No communities found"})}),f&&v.length>0&&(0,s.jsx)("div",{className:"p-6 flex justify-center border-t border-zinc-100 dark:border-zinc-800",children:(0,s.jsxs)(ue,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>w(!0),disabled:m,children:[m&&(0,s.jsx)(me,{size:18,className:"animate-spin mr-2"}),"Load more"]})})]}),t[21]=r,t[22]=v,t[23]=j,t[24]=f,t[25]=m,t[26]=w,t[27]=I):I=t[27];let D;t[28]!==r||t[29]!==e||t[30]!==a||t[31]!==b||t[32]!==x||t[33]!==p||t[34]!==y||t[35]!==_||t[36]!==h||t[37]!==i?(D=r==="posts"&&(0,s.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:i?h.length>0?(0,s.jsxs)(s.Fragment,{children:[h.map(k=>(0,s.jsx)(xt,{currentUser:a,showToast:e,...k,onClick:()=>_(`/post/${k.id}`),onUserClick:O=>_(`/u/${O}`)},k.id)),b&&(0,s.jsx)("div",{className:"p-6 flex justify-center border-t border-zinc-100 dark:border-zinc-800",children:(0,s.jsxs)(ue,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>y(!0),disabled:x,children:[x&&(0,s.jsx)(me,{size:18,className:"animate-spin mr-2"}),"Load more"]})})]}):p?(0,s.jsx)("div",{className:"p-20 flex justify-center",children:(0,s.jsx)(me,{className:"animate-spin text-violet-500",size:32})}):(0,s.jsx)("div",{className:"p-20 text-center text-zinc-500",children:(0,s.jsxs)("p",{className:"font-bold",children:['No posts found matching "',i,'"']})}):(0,s.jsxs)("div",{className:"p-20 text-center text-zinc-500 flex flex-col items-center gap-3",children:[(0,s.jsx)("div",{className:"p-4 bg-zinc-50 dark:bg-zinc-900 rounded-full",children:(0,s.jsx)(Xt,{size:32,className:"text-zinc-300"})}),(0,s.jsx)("p",{className:"font-bold",children:"Enter a keyword or hashtag to search posts"})]})}),t[28]=r,t[29]=e,t[30]=a,t[31]=b,t[32]=x,t[33]=p,t[34]=y,t[35]=_,t[36]=h,t[37]=i,t[38]=D):D=t[38];let S;t[39]!==I||t[40]!==D?(S=(0,s.jsxs)("div",{className:"min-h-screen",children:[I,D]}),t[39]=I,t[40]=D,t[41]=S):S=t[41];let $;t[42]!==c?($=()=>c(!1),t[42]=c,t[43]=$):$=t[43];let q;t[44]!==o||t[45]!==$?(q=(0,s.jsx)(oo,{isOpen:o,onClose:$}),t[44]=o,t[45]=$,t[46]=q):q=t[46];let z;return t[47]!==S||t[48]!==q||t[49]!==R?(z=(0,s.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm",children:[R,S,q]}),t[47]=S,t[48]=q,t[49]=R,t[50]=z):z=t[50],z},Nc=zc;function kc(t){return(0,s.jsx)(Ht,{},t)}var _c=K(),Cc=t=>{const e=(0,_c.c)(24),{user:a,onClick:i,isAddStory:n,isSeen:r}=t,l=n===void 0?!1:n,o=`relative p-0.5 rounded-full ${l?"bg-transparent":r!==void 0&&r?"bg-zinc-200 dark:bg-zinc-800":"bg-gradient-to-tr from-yellow-400 via-pink-500 to-violet-600"}`;let c;e[0]!==a.avatar||e[1]!==a.handle?(c=(0,s.jsx)(he,{src:a.avatar,alt:a.handle,className:"object-cover"}),e[0]=a.avatar,e[1]=a.handle,e[2]=c):c=e[2];let u;e[3]!==a.handle?.[0]?(u=a.handle?.[0]?.toUpperCase(),e[3]=a.handle?.[0],e[4]=u):u=e[4];let d;e[5]!==u?(d=(0,s.jsx)(pe,{children:u}),e[5]=u,e[6]=d):d=e[6];let m;e[7]!==c||e[8]!==d?(m=(0,s.jsxs)(xe,{className:"size-14 sm:size-16 border border-zinc-100 dark:border-zinc-800",children:[c,d]}),e[7]=c,e[8]=d,e[9]=m):m=e[9];let f;e[10]!==l?(f=l&&(0,s.jsx)("div",{className:"absolute bottom-0 right-0 bg-violet-600 border-2 border-white dark:border-black rounded-full p-1 text-white shadow-lg",children:(0,s.jsx)(De,{size:14,strokeWidth:3})}),e[10]=l,e[11]=f):f=e[11];let h;e[12]!==m||e[13]!==f?(h=(0,s.jsx)("div",{className:"bg-white dark:bg-black rounded-full p-0.5",children:(0,s.jsxs)("div",{className:"relative",children:[m,f]})}),e[12]=m,e[13]=f,e[14]=h):h=e[14];let p;e[15]!==o||e[16]!==h?(p=(0,s.jsx)("div",{className:o,children:h}),e[15]=o,e[16]=h,e[17]=p):p=e[17];const x=l?"Add Story":a.handle;let b;e[18]!==x?(b=(0,s.jsx)("span",{className:"text-[11px] font-semibold text-zinc-600 dark:text-zinc-400 truncate w-16 text-center leading-tight",children:x}),e[18]=x,e[19]=b):b=e[19];let v;return e[20]!==i||e[21]!==p||e[22]!==b?(v=(0,s.jsxs)("button",{onClick:i,className:"flex flex-col items-center gap-2 group shrink-0",children:[p,b]}),e[20]=i,e[21]=p,e[22]=b,e[23]=v):v=e[23],v},ms=Cc,Sc=K(),$c=t=>{const e=(0,Sc.c)(49),{onStoryClick:a,onAddStory:i}=t,{currentUser:n}=be(),{posts:r,loading:l,hasMore:o,isFetchingNextPage:c,fetchNextPage:u}=kt(),{addToast:d}=we(),m=ge();let f;e[0]===Symbol.for("react.memo_cache_sentinel")?(f={threshold:.1},e[0]=f):f=e[0];const{ref:h,inView:p}=tn(f);let x,b;e[1]!==u||e[2]!==o||e[3]!==p||e[4]!==c?(x=()=>{p&&o&&!c&&u()},b=[p,o,c,u],e[1]=u,e[2]=o,e[3]=p,e[4]=c,e[5]=x,e[6]=b):(x=e[5],b=e[6]),(0,g.useEffect)(x,b);let v;e[7]===Symbol.for("react.memo_cache_sentinel")?(v={queryKey:["stories"],queryFn:Zn},e[7]=v):v=e[7];const{data:j,isLoading:w}=$e(v);let y;e[8]!==j?(y=j===void 0?[]:j,e[8]=j,e[9]=y):y=e[9];const _=y;let C;if(e[10]!==_){const T={};_.forEach(W=>{if(!W.user)return;const Q=W.user.id;T[Q]||(T[Q]={user:W.user,stories:[]}),T[Q].stories.push(W)}),C=Object.values(T),e[10]=_,e[11]=C}else C=e[11];const F=C,E=r;let M;e[12]!==m?(M=T=>{m(`/post/${T}`)},e[12]=m,e[13]=M):M=e[13];const N=M;let P;e[14]!==m?(P=T=>{m(`/u/${T}`)},e[14]=m,e[15]=P):P=e[15];const L=P;if(l||w){let T;return e[16]===Symbol.for("react.memo_cache_sentinel")?(T=(0,s.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:[(0,s.jsxs)(ls,{className:"w-full whitespace-nowrap border-b border-zinc-100 dark:border-zinc-800",children:[(0,s.jsxs)("div",{className:"flex w-max gap-3 py-4 px-4",children:[(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"}),(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"}),(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"})]}),(0,s.jsx)(Tt,{orientation:"horizontal",className:"hidden"})]}),[1,2,3].map(Mc)]}),e[16]=T):T=e[16],T}let R;e[17]!==n||e[18]!==i?(R=n&&(0,s.jsx)(ms,{user:n,isAddStory:!0,onClick:i}),e[17]=n,e[18]=i,e[19]=R):R=e[19];let I;e[20]!==F||e[21]!==a?(I=F.map(T=>{const W=JSON.parse(localStorage.getItem("seenStories")||"[]").includes(T.user.id);return(0,s.jsx)(ms,{user:T.user,isSeen:W,onClick:()=>a(T)},T.user.id)}),e[20]=F,e[21]=a,e[22]=I):I=e[22];let D;e[23]!==R||e[24]!==I?(D=(0,s.jsxs)("div",{className:"flex w-max gap-4 py-4 px-4",children:[R,I]}),e[23]=R,e[24]=I,e[25]=D):D=e[25];let S;e[26]===Symbol.for("react.memo_cache_sentinel")?(S=(0,s.jsx)(Tt,{orientation:"horizontal",className:"hidden"}),e[26]=S):S=e[26];let $;e[27]!==D?($=(0,s.jsxs)(ls,{className:"w-full border-b border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black",children:[D,S]}),e[27]=D,e[28]=$):$=e[28];let q;e[29]!==n?(q=!n&&(0,s.jsx)("div",{className:"px-4 py-2 md:hidden",children:(0,s.jsx)(Na,{className:"p-6"})}),e[29]=n,e[30]=q):q=e[30];let z;e[31]!==d||e[32]!==n||e[33]!==N||e[34]!==L||e[35]!==E?(z=E.length>0?E.map(T=>(0,s.jsx)(xt,{...T,currentUser:n,showToast:d,onClick:()=>N(T.id),onUserClick:L},T.feed_id||T.id)):(0,s.jsxs)("div",{className:"p-20 text-center text-zinc-500",children:[(0,s.jsx)("p",{className:"text-lg font-medium",children:"No posts yet."}),(0,s.jsx)("p",{className:"text-sm",children:"Be the first to share something amazing!"})]}),e[31]=d,e[32]=n,e[33]=N,e[34]=L,e[35]=E,e[36]=z):z=e[36];let k;e[37]!==o||e[38]!==E.length||e[39]!==c||e[40]!==h?(k=E.length>0&&(0,s.jsx)("div",{ref:h,className:"py-8 flex justify-center",children:c?(0,s.jsx)(me,{className:"animate-spin text-violet-500",size:24}):o?(0,s.jsx)("div",{className:"h-4"}):(0,s.jsx)("p",{className:"text-sm text-zinc-500 font-medium",children:"You've reached the end of the feed."})}),e[37]=o,e[38]=E.length,e[39]=c,e[40]=h,e[41]=k):k=e[41];let O;e[42]!==z||e[43]!==k?(O=(0,s.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm",children:[z,k]}),e[42]=z,e[43]=k,e[44]=O):O=e[44];let U;return e[45]!==$||e[46]!==q||e[47]!==O?(U=(0,s.jsxs)("div",{className:"w-full max-w-full overflow-hidden",children:[$,q,O]}),e[45]=$,e[46]=q,e[47]=O,e[48]=U):U=e[48],U},Pc=$c;function Mc(t){return(0,s.jsx)(Ht,{},t)}var Fc=K(),Rc=t=>{const e=(0,Fc.c)(55),{conv:a,selectedId:i,onSelect:n,onlineUsers:r}=t,l=ge(),o=Ca(a.user?.lastSeen);let c;e[0]!==a.user?.id||e[1]!==r?(c=r.has(a.user?.id),e[0]=a.user?.id,e[1]=r,e[2]=c):c=e[2];const u=c;let d;e[3]!==a.user||e[4]!==l?(d=$=>{$.stopPropagation(),a.user?.handle&&l(`/u/${a.user.handle}`)},e[3]=a.user,e[4]=l,e[5]=d):d=e[5];const m=d;let f;e[6]!==a||e[7]!==n?(f=()=>n(a),e[6]=a,e[7]=n,e[8]=f):f=e[8];const h=`flex items-center gap-3 p-4 cursor-pointer transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900 ${i===a.id?"bg-zinc-50 dark:bg-zinc-900 border-r-2 border-violet-500":""}`,p=a.user?.avatar,x=a.user?.name;let b;e[9]!==p||e[10]!==x?(b=(0,s.jsx)(he,{src:p,alt:x,className:"object-cover"}),e[9]=p,e[10]=x,e[11]=b):b=e[11];let v;e[12]!==a.user?.name?.[0]?(v=a.user?.name?.[0]?.toUpperCase(),e[12]=a.user?.name?.[0],e[13]=v):v=e[13];let j;e[14]!==v?(j=(0,s.jsx)(pe,{children:v}),e[14]=v,e[15]=j):j=e[15];let w;e[16]!==b||e[17]!==j?(w=(0,s.jsxs)(xe,{className:"size-12 group-hover:brightness-90 transition-all",children:[b,j]}),e[16]=b,e[17]=j,e[18]=w):w=e[18];let y;e[19]!==u?(y=u&&(0,s.jsx)("span",{className:"absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full"}),e[19]=u,e[20]=y):y=e[20];let _;e[21]!==m||e[22]!==w||e[23]!==y?(_=(0,s.jsxs)("div",{className:"relative group",onClick:m,children:[w,y]}),e[21]=m,e[22]=w,e[23]=y,e[24]=_):_=e[24];const C=a.user?.name;let F;e[25]!==m||e[26]!==C?(F=(0,s.jsx)("span",{onClick:m,className:"font-bold dark:text-white truncate hover:underline cursor-pointer",children:C}),e[25]=m,e[26]=C,e[27]=F):F=e[27];let E;e[28]!==a.user?.lastSeen||e[29]!==u||e[30]!==o?(E=u?(0,s.jsx)("span",{className:"text-[10px] text-emerald-500 font-medium leading-none mb-1",children:"Online"}):a.user?.lastSeen&&(0,s.jsx)("span",{className:"text-[10px] text-zinc-500 font-medium leading-none mb-1",children:o}),e[28]=a.user?.lastSeen,e[29]=u,e[30]=o,e[31]=E):E=e[31];let M;e[32]!==F||e[33]!==E?(M=(0,s.jsxs)("div",{className:"flex flex-col min-w-0",children:[F,E]}),e[32]=F,e[33]=E,e[34]=M):M=e[34];let N;e[35]!==a.time?(N=(0,s.jsx)("span",{className:"text-xs text-zinc-500 whitespace-nowrap ml-2",children:a.time}),e[35]=a.time,e[36]=N):N=e[36];let P;e[37]!==M||e[38]!==N?(P=(0,s.jsxs)("div",{className:"flex justify-between items-center mb-0.5",children:[M,N]}),e[37]=M,e[38]=N,e[39]=P):P=e[39];let L;e[40]!==a.lastMessage?(L=(0,s.jsx)("p",{className:"text-zinc-500 text-sm truncate pr-2",children:a.lastMessage}),e[40]=a.lastMessage,e[41]=L):L=e[41];let R;e[42]!==a.unread?(R=a.unread>0&&(0,s.jsx)("span",{className:"bg-violet-600 text-white text-[10px] font-bold size-5 rounded-full flex items-center justify-center shrink-0",children:a.unread}),e[42]=a.unread,e[43]=R):R=e[43];let I;e[44]!==L||e[45]!==R?(I=(0,s.jsxs)("div",{className:"flex-1 flex justify-between items-center",children:[L,R]}),e[44]=L,e[45]=R,e[46]=I):I=e[46];let D;e[47]!==P||e[48]!==I?(D=(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[P,I]}),e[47]=P,e[48]=I,e[49]=D):D=e[49];let S;return e[50]!==_||e[51]!==D||e[52]!==f||e[53]!==h?(S=(0,s.jsxs)("div",{onClick:f,className:h,children:[_,D]}),e[50]=_,e[51]=D,e[52]=f,e[53]=h,e[54]=S):S=e[54],S},Lc=({conversations:t,userResults:e=[],onSelect:a,onStartNew:i,selectedId:n,searchQuery:r,onSearchChange:l,onlineUsers:o=new Set})=>(0,s.jsxs)("div",{className:"flex-1 flex flex-col min-w-0 bg-white dark:bg-black",children:[(0,s.jsx)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)(jt,{value:r,onChange:l,onClear:()=>l(""),placeholder:"Search people or messages..."})}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[t.length>0&&(0,s.jsx)("div",{className:"py-2",children:t.filter(c=>c.lastMessage!=="No messages yet"||c.id===n).map(c=>(0,s.jsx)(Rc,{conv:c,selectedId:n,onSelect:a,onlineUsers:o},c.id))}),e.length>0&&(0,s.jsxs)("div",{className:"border-t border-zinc-100 dark:border-zinc-800",children:[(0,s.jsx)("div",{className:"px-4 py-3 text-xs font-bold text-zinc-500 uppercase tracking-wider",children:"People"}),e.map(c=>(0,s.jsxs)("div",{onClick:()=>i(c),className:"flex items-center gap-3 p-4 cursor-pointer transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[(0,s.jsxs)(xe,{className:"size-12",children:[(0,s.jsx)(he,{src:c.avatar,alt:c.name,className:"object-cover"}),(0,s.jsx)(pe,{children:c.name?.[0]?.toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"font-bold dark:text-white truncate",children:c.name}),(0,s.jsxs)("div",{className:"text-zinc-500 text-sm truncate",children:["@",c.handle]})]}),(0,s.jsx)(ps,{size:18,className:"text-violet-500"})]},c.id))]}),t.length===0&&e.length===0&&r&&(0,s.jsx)("div",{className:"p-8 text-center",children:(0,s.jsxs)("p",{className:"text-zinc-500 text-sm",children:['No conversations or people found for "',r,'"']})}),t.length===0&&!r&&(0,s.jsx)("div",{className:"p-8 text-center",children:(0,s.jsx)("p",{className:"text-zinc-500 text-sm",children:"No messages yet. Search for people to start a chat!"})})]})]}),Ic=Lc,Ec=K(),Tc=["","","","","",""],qc=t=>{const e=(0,Ec.c)(6),{onSelect:a,currentReaction:i}=t;let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,s.jsx)(ha,{asChild:!0,children:(0,s.jsx)("button",{className:"p-1.5 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-300 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full transition-all active:scale-90",onClick:Ac,children:(0,s.jsx)(Rs,{size:16})})}),e[0]=n):n=e[0];let r;e[1]!==i||e[2]!==a?(r=Tc.map(o=>(0,s.jsx)("button",{onClick:()=>a(o),className:`text-xl p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full transition-all active:scale-125 ${i===o?"bg-zinc-100 dark:bg-zinc-800":""}`,children:o},o)),e[1]=i,e[2]=a,e[3]=r):r=e[3];let l;return e[4]!==r?(l=(0,s.jsxs)(xa,{children:[n,(0,s.jsx)(pa,{side:"top",align:"center",className:"w-fit p-1 rounded-full bg-white dark:bg-zinc-900 border border-zinc-100 dark:border-zinc-800 shadow-xl",onClick:Oc,children:(0,s.jsx)("div",{className:"flex items-center gap-1",children:r})})]}),e[4]=r,e[5]=l):l=e[5],l},Dc=qc;function Ac(t){return t.stopPropagation()}function Oc(t){return t.stopPropagation()}var Wc=K(),Bc=t=>{const e=(0,Wc.c)(10),{reactions:a,currentUser:i,onToggle:n}=t;let r;e[0]!==a?(r=a===void 0?[]:a,e[0]=a,e[1]=r):r=e[1];const l=r;let o;e[2]!==i?.id||e[3]!==l?(o={},l.forEach(m=>{o[m.emoji]||(o[m.emoji]={count:0,me:!1}),o[m.emoji].count=o[m.emoji].count+1,m.user_id===i?.id&&(o[m.emoji].me=!0)}),e[2]=i?.id,e[3]=l,e[4]=o):o=e[4];const c=o;if(l.length===0)return null;let u;e[5]!==c?(u=Object.entries(c),e[5]=c,e[6]=u):u=e[6];let d;return e[7]!==n||e[8]!==u?(d=(0,s.jsx)("div",{className:"flex flex-wrap gap-1 mt-1 px-2",children:u.map(m=>{const[f,h]=m;return(0,s.jsxs)("button",{onClick:p=>{p.stopPropagation(),n(f)},className:`flex items-center gap-1.5 px-2 py-0.5 rounded-full text-xs font-medium border transition-all active:scale-90 ${h.me?"bg-violet-50 border-violet-200 text-violet-600 dark:bg-violet-900/30 dark:border-violet-800 dark:text-violet-400":"bg-white border-zinc-100 text-zinc-600 dark:bg-zinc-900 dark:border-zinc-800 dark:text-zinc-400"}`,children:[(0,s.jsx)("span",{children:f}),h.count>1&&(0,s.jsx)("span",{children:h.count})]},f)})}),e[7]=n,e[8]=u,e[9]=d):d=e[9],d},Uc=Bc,Vc=["","","","","",""],Hc=({conversation:t,messages:e,onBack:a,onSendMessage:i,onToggleReaction:n,onDeleteMessage:r,currentUser:l,onTyping:o,isLoading:c,isTyping:u,isOnline:d})=>{const m=ge(),{openLightbox:f}=Ot(),[h,p]=(0,g.useState)(""),[x,b]=(0,g.useState)(!1),[v,j]=(0,g.useState)([]),[w,y]=(0,g.useState)(!1),[_,C]=(0,g.useState)(null),F=(0,g.useRef)(null),E=(0,g.useRef)(null),M=(0,g.useRef)(null),N=Ca(t.user?.lastSeen);(0,g.useEffect)(()=>{E.current&&(E.current.scrollTop=E.current.scrollHeight)},[e,u]);const P=z=>{const k=z.target.value;p(k),o&&(o(!0),M.current&&clearTimeout(M.current),M.current=setTimeout(()=>{o(!1)},2e3))},L=z=>{p(k=>k+z.emoji)},R=z=>{z.preventDefault(),!(!h.trim()&&v.length===0)&&(o&&(clearTimeout(M.current),o(!1)),i(t.id,h,v.length>0?"image":"text",v,_?.id),p(""),j([]),C(null))},I=async z=>{const k=Array.from(z.target.files);if(k.length!==0){b(!0);try{const O=await Promise.all(k.map(U=>Pe(U)));j(U=>[...U,...O])}catch(O){console.error("Upload failed:",O)}finally{b(!1)}}},D=z=>{j(k=>k.filter(O=>O.url!==z))},S=z=>{!z.media||z.media.length===0||f(z.media.map(k=>k.url),0)},$=(0,g.useMemo)(()=>{const z=e.filter(k=>k.sender==="me");return z.length>0?z[z.length-1].id:null},[e]),q=z=>e.find(k=>k.id===z);return(0,s.jsxs)("div",{className:"flex-1 flex flex-col h-full min-w-0 bg-white dark:bg-black md:border-l md:border-zinc-100 dark:md:border-zinc-800",children:[(0,s.jsxs)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800 flex items-center justify-between shrink-0 bg-white/80 dark:bg-black/80 backdrop-blur-md sticky top-0 z-10",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("button",{onClick:a,className:"md:hidden p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:(0,s.jsx)(tt,{size:20})}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)(xe,{className:"size-10 border border-zinc-200 dark:border-zinc-700",children:[(0,s.jsx)(he,{src:t.user.avatar,alt:t.user.name,className:"object-cover"}),(0,s.jsx)(pe,{children:t.user.name?.[0]?.toUpperCase()})]}),d&&(0,s.jsx)("span",{className:"absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-bold dark:text-white",children:t.user.name}),d?(0,s.jsxs)("div",{className:"text-xs text-emerald-500 font-medium flex items-center gap-1",children:[(0,s.jsx)("span",{className:"size-1.5 bg-emerald-500 rounded-full animate-pulse"}),"Online"]}):(0,s.jsx)("div",{className:"text-xs text-zinc-500 font-medium",children:t.user.lastSeen?`Last seen ${N}`:"Offline"})]})]}),(0,s.jsx)("button",{className:"p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full dark:text-zinc-400",children:(0,s.jsx)(Si,{size:20})})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",ref:E,children:[(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsxs)("div",{className:"relative w-fit mx-auto",children:[(0,s.jsxs)(xe,{className:"size-20 mx-auto mb-3 border-4 border-zinc-50 dark:border-zinc-900 shadow-sm",children:[(0,s.jsx)(he,{src:t.user.avatar,alt:t.user.name,className:"object-cover"}),(0,s.jsx)(pe,{className:"text-2xl font-bold",children:t.user.name?.[0]?.toUpperCase()})]}),d&&(0,s.jsx)("span",{className:"absolute bottom-4 right-1 size-5 bg-emerald-500 border-4 border-white dark:border-black rounded-full animate-in zoom-in duration-300"})]}),(0,s.jsx)("h4",{className:"font-bold dark:text-white text-lg",children:t.user.name}),(0,s.jsxs)("p",{className:"text-sm text-zinc-500",children:["@",t.user.handle]}),(0,s.jsxs)("p",{className:"text-xs text-zinc-400 mt-4 max-w-xs mx-auto",children:["This is the beginning of your direct message history with"," ",(0,s.jsxs)("span",{className:"font-bold",children:["@",t.user.handle]})]})]}),c&&e.length===0?(0,s.jsx)("div",{className:"flex justify-center p-8",children:(0,s.jsx)(me,{className:"animate-spin text-violet-500",size:32})}):e.map(z=>(0,s.jsxs)(ll,{children:[(0,s.jsx)(ol,{asChild:!0,children:(0,s.jsxs)("div",{id:`msg-${z.id}`,className:`flex items-end gap-2 group ${z.sender==="me"?"flex-row-reverse":"flex-row"}`,children:[(0,s.jsxs)("div",{className:`max-w-[75%] p-1 rounded-2xl text-[15px] shadow-sm relative ${z.sender==="me"?"bg-violet-600 text-white rounded-tr-none":"bg-zinc-100 dark:bg-zinc-800 dark:text-white rounded-tl-none"}`,children:[z.replyToId&&(0,s.jsxs)("div",{className:`mb-2 p-2 rounded-lg border-l-4 text-xs truncate cursor-pointer ${z.sender==="me"?"bg-violet-500/50 border-violet-300 text-violet-100":"bg-zinc-200/50 dark:bg-zinc-700/50 border-zinc-400 dark:border-zinc-500 text-zinc-600 dark:text-zinc-300"}`,onClick:k=>{k.stopPropagation(),document.getElementById(`msg-${z.replyToId}`)?.scrollIntoView({behavior:"smooth",block:"center"})},children:[(0,s.jsx)("span",{className:"font-bold block mb-0.5",children:q(z.replyToId)?.sender==="me"?"You":t.user.name}),q(z.replyToId)?.text||"Media"]}),z.media?.length>0&&(0,s.jsx)("div",{className:"mb-2 grid gap-1 grid-cols-1 overflow-hidden rounded-lg cursor-pointer",onClick:()=>S(z),children:z.media.map((k,O)=>(0,s.jsx)("img",{src:k.url,alt:"",className:"max-h-60 w-full object-cover rounded-md hover:brightness-90 transition-all"},O))}),z.text&&(0,s.jsx)("div",{className:"m-0 leading-tight px-3 py-1 whitespace-pre-line break-words",children:(0,s.jsx)(ct,{options:{...ft,render:({attributes:k,content:O})=>{const{href:U,...T}=k,W=!U.startsWith("/")&&(U.startsWith("http")||U.startsWith("www"));return U.startsWith("/u/")||U.startsWith("/explore")?(0,s.jsx)("span",{...T,className:`underline decoration-2 underline-offset-2 cursor-pointer transition-opacity break-all ${z.sender==="me"?"text-white":"text-rose-500 dark:text-rose-400"}`,onClick:Q=>{Q.stopPropagation(),m(U)},children:O},O):(0,s.jsx)("a",{href:U,...T,className:`underline decoration-2 underline-offset-2 hover:opacity-80 transition-opacity break-all ${z.sender==="me"?"text-white":""}`,target:W?"_blank":void 0,rel:W?"noopener noreferrer":void 0,onClick:Q=>Q.stopPropagation(),children:O},O)}},children:z.text})}),z.reactions?.length>0&&(0,s.jsx)(Uc,{reactions:z.reactions,currentUser:l,onToggle:k=>n(z.id,k)}),(0,s.jsxs)("div",{className:`text-[10px] flex items-center justify-end gap-1 px-3 pb-1 ${z.sender==="me"?"text-violet-200":"text-zinc-400"}`,children:[z.time,z.sender==="me"&&z.id===$&&(0,s.jsx)("span",{className:"ml-0.5",children:z.isRead?(0,s.jsx)(ri,{size:14,className:"text-white"}):(0,s.jsx)(Ws,{size:14,className:"text-violet-200"})})]})]}),(0,s.jsx)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)(Dc,{onSelect:k=>n(z.id,k),currentReaction:z.reactions?.find(k=>k.user_id===l?.id)?.emoji})})]})}),(0,s.jsxs)(cl,{className:"w-64 rounded-xl bg-white dark:bg-zinc-950 border-zinc-100 dark:border-zinc-800 shadow-xl",children:[(0,s.jsx)(dl,{className:"text-xs text-zinc-500 font-bold px-3 py-2",children:"QUICK REACTION"}),(0,s.jsx)("div",{className:"flex items-center justify-between px-2 pb-2",children:Vc.map(k=>(0,s.jsx)("button",{onClick:()=>n(z.id,k),className:"text-xl p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full transition-all active:scale-125",children:k},k))}),(0,s.jsx)(rs,{className:"bg-zinc-100 dark:bg-zinc-800"}),(0,s.jsxs)(Pt,{className:"gap-3 px-3 py-2.5 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-900",onClick:()=>{navigator.clipboard.writeText(z.text)},children:[(0,s.jsx)(Oi,{size:16,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"font-medium",children:"Copy Text"})]}),(0,s.jsxs)(Pt,{className:"gap-3 px-3 py-2.5 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-900",onClick:()=>C(z),children:[(0,s.jsx)(Xa,{size:16,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"font-medium",children:"Reply"})]}),(0,s.jsx)(rs,{className:"bg-zinc-100 dark:bg-zinc-800"}),(0,s.jsxs)(Pt,{className:"gap-3 px-3 py-2.5 cursor-pointer text-rose-500 focus:text-rose-500 focus:bg-rose-50 dark:focus:bg-rose-900/20",onClick:()=>r(z.id),children:[(0,s.jsx)(Ft,{size:16}),(0,s.jsx)("span",{className:"font-medium",children:"Delete message"})]})]})]},z.id)),u&&(0,s.jsx)("div",{className:"flex justify-start animate-in fade-in slide-in-from-bottom-2 duration-300",children:(0,s.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-800/50 px-3 py-2 rounded-2xl rounded-tl-none border border-zinc-200/50 dark:border-zinc-700/30 shadow-sm",children:(0,s.jsx)(eo,{})})})]}),(0,s.jsxs)("div",{className:"p-4 border-t border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black shrink-0",children:[_&&(0,s.jsxs)("div",{className:"mb-3 p-3 bg-zinc-50 dark:bg-zinc-900 border border-zinc-100 dark:border-zinc-800 rounded-xl flex items-center justify-between animate-in slide-in-from-bottom-2 duration-200",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("span",{className:"text-xs font-bold text-violet-600 dark:text-violet-400 block mb-1",children:["Replying to"," ",_.sender==="me"?"yourself":t.user.name]}),(0,s.jsx)("p",{className:"text-sm text-zinc-500 truncate",children:_.text||"Media"})]}),(0,s.jsx)("button",{onClick:()=>C(null),className:"p-1 hover:bg-zinc-200 dark:hover:bg-zinc-800 rounded-full text-zinc-400 transition-colors",children:(0,s.jsx)(_e,{size:18})})]}),v.length>0&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 mb-3",children:[v.map(z=>(0,s.jsxs)("div",{className:"relative size-16 rounded-xl overflow-hidden border border-zinc-200 dark:border-zinc-800",children:[(0,s.jsx)("img",{src:z.url,className:"size-full object-cover",alt:""}),(0,s.jsx)("button",{type:"button",onClick:()=>D(z.url),className:"absolute top-1 right-1 bg-black/50 text-white rounded-full p-0.5 hover:bg-black transition-colors",children:(0,s.jsx)(_e,{size:12})})]},z.url)),x&&(0,s.jsx)("div",{className:"size-16 rounded-xl bg-zinc-100 dark:bg-zinc-900 flex items-center justify-center",children:(0,s.jsx)(me,{className:"animate-spin text-violet-500",size:20})})]}),(0,s.jsxs)("form",{onSubmit:R,className:"flex items-center gap-2 bg-zinc-100 dark:bg-zinc-900 p-2 rounded-2xl border border-transparent focus-within:border-violet-500 transition-all",children:[(0,s.jsxs)(xa,{open:w,onOpenChange:y,children:[(0,s.jsx)(ha,{asChild:!0,children:(0,s.jsx)("button",{type:"button",className:"p-2 text-zinc-500 hover:text-violet-600 transition-colors",children:(0,s.jsx)(Rs,{size:20})})}),(0,s.jsx)(pa,{className:"w-fit p-0 border-none bg-transparent shadow-none",side:"top",align:"start",sideOffset:10,children:(0,s.jsx)(bl,{onEmojiSelect:z=>{L(z)}})})]}),(0,s.jsx)("input",{type:"text",className:"flex-1 min-w-0 bg-transparent border-none outline-none dark:text-white py-1 px-1",placeholder:"Start a new message",value:h,onChange:P}),(0,s.jsx)("input",{type:"file",ref:F,onChange:I,className:"hidden",multiple:!0,accept:"image/*"}),(0,s.jsx)("button",{type:"button",onClick:()=>F.current?.click(),className:"p-2 text-zinc-500 hover:text-violet-600 transition-colors",disabled:x,children:(0,s.jsx)(zs,{size:20})}),(0,s.jsx)(ue,{type:"submit",className:"size-10 !p-0 rounded-xl",disabled:!h.trim()&&v.length===0||x,children:(0,s.jsx)(ii,{size:18})})]})]})]})},Jc=Hc,Qc=K(),Kc=()=>{const t=(0,Qc.c)(73),{id:e}=Nt(),a=ge(),{currentUser:i}=be(),{onlineUsers:n}=Gs(),r=wt(),[l,o]=(0,g.useState)("");let c;t[0]===Symbol.for("react.memo_cache_sentinel")?(c=[],t[0]=c):c=t[0];const[u,d]=(0,g.useState)(c),{conversations:m,isConvLoading:f,sendMessage:h,sendTypingStatus:p,typingStatus:x,markAsRead:b,formatMessages:v,onToggleReaction:j,allReactions:w}=Wt(i);let y;e:{if(!e||m.length===0){y=null;break e}let te;t[1]!==m||t[2]!==e?(te=m.find(de=>de.id===e)||null,t[1]=m,t[2]=e,t[3]=te):te=t[3],y=te}const _=y;let C,F;t[4]!==e||t[5]!==b?(C=()=>{e&&b(e)},F=[e,b],t[4]=e,t[5]=b,t[6]=C,t[7]=F):(C=t[6],F=t[7]),(0,g.useEffect)(C,F);let E;t[8]!==m||t[9]!==i?.id||t[10]!==l?(E=()=>{const te=setTimeout(async()=>{if(l.length>1){const de=await wn(l),fe=m.map(Xc);d(de.filter(ve=>ve.id!==i?.id&&!fe.includes(ve.id)))}else d([])},300);return()=>clearTimeout(te)},t[8]=m,t[9]=i?.id,t[10]=l,t[11]=E):E=t[11];const M=i?.id;let N;t[12]!==m||t[13]!==l||t[14]!==M?(N=[l,m,M],t[12]=m,t[13]=l,t[14]=M,t[15]=N):N=t[15],(0,g.useEffect)(E,N);let P;t[16]!==i||t[17]!==a||t[18]!==r?(P=async te=>{try{const de=await Js(i.id,te.id);r.invalidateQueries({queryKey:["conversations",i.id]}),o(""),a(`/messages/${de}`)}catch(de){console.error("Failed to start conversation:",de)}},t[16]=i,t[17]=a,t[18]=r,t[19]=P):P=t[19];const L=P;let R;t[20]!==a?(R=te=>{a(`/messages/${te.id}`)},t[20]=a,t[21]=R):R=t[21];const I=R,D=_?.id;let S;t[22]!==D?(S=["messages",D],t[22]=D,t[23]=S):S=t[23];let $;t[24]!==_?.id?($=()=>Vn(_?.id),t[24]=_?.id,t[25]=$):$=t[25];const q=!!_?.id;let z;t[26]!==S||t[27]!==$||t[28]!==q?(z={queryKey:S,queryFn:$,enabled:q},t[26]=S,t[27]=$,t[28]=q,t[29]=z):z=t[29];const{data:k,isLoading:O}=$e(z);let U;t[30]!==k?(U=k===void 0?[]:k,t[30]=k,t[31]=U):U=t[31];const T=U;let W;t[32]!==w||t[33]!==T||t[34]!==v?(W=v(T,w),t[32]=w,t[33]=T,t[34]=v,t[35]=W):W=t[35];const Q=W;if(!i){let te;return t[36]===Symbol.for("react.memo_cache_sentinel")?(te=(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-screen gap-4 p-8 text-center bg-white dark:bg-black md:rounded-xl md:border border-zinc-100 dark:border-zinc-800",children:[(0,s.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-900 p-4 rounded-full",children:(0,s.jsx)(As,{size:40,className:"text-zinc-400"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"Sign in to message others"}),(0,s.jsx)("p",{className:"text-zinc-500 max-w-xs",children:"Start decentralized conversations with anyone on the network."})]}),t[36]=te):te=t[36],te}if(f){let te;return t[37]===Symbol.for("react.memo_cache_sentinel")?(te=(0,s.jsx)("div",{className:"flex h-screen items-center justify-center bg-white dark:bg-black md:rounded-xl md:border border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)(me,{className:"animate-spin text-violet-500",size:32})}),t[37]=te):te=t[37],te}let Z;if(t[38]!==m||t[39]!==l){let te;t[41]!==l?(te=de=>de.user?.name?.toLowerCase().includes(l.toLowerCase())||de.user?.handle?.toLowerCase().includes(l.toLowerCase())||de.lastMessage?.toLowerCase().includes(l.toLowerCase()),t[41]=l,t[42]=te):te=t[42],Z=m.filter(te),t[38]=m,t[39]=l,t[40]=Z}else Z=t[40];const ae=Z,ie=_&&x[_.id];let G;t[43]!==n||t[44]!==_?(G=_&&n.has(_.user?.id),t[43]=n,t[44]=_,t[45]=G):G=t[45];const se=G,ne=`flex ${e?"h-[100dvh]":"h-[calc(100dvh-4rem)]"} md:h-[calc(100vh-2rem)] bg-white dark:bg-black overflow-hidden md:rounded-xl md:border border-zinc-100 dark:border-zinc-800`,V=`w-full md:w-80 flex flex-col border-r border-zinc-100 dark:border-zinc-800 ${_?"hidden md:flex":"flex"}`;let H;t[46]===Symbol.for("react.memo_cache_sentinel")?(H=(0,s.jsx)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)("h2",{className:"text-xl font-bold dark:text-white",children:"Messages"})}),t[46]=H):H=t[46];let X;t[47]!==ae||t[48]!==I||t[49]!==L||t[50]!==e||t[51]!==l||t[52]!==n||t[53]!==u?(X=(0,s.jsx)(Ic,{conversations:ae,userResults:u,onSelect:I,onStartNew:L,selectedId:e,searchQuery:l,onSearchChange:o,onlineUsers:n}),t[47]=ae,t[48]=I,t[49]=L,t[50]=e,t[51]=l,t[52]=n,t[53]=u,t[54]=X):X=t[54];let ee;t[55]!==V||t[56]!==X?(ee=(0,s.jsxs)("div",{className:V,children:[H,X]}),t[55]=V,t[56]=X,t[57]=ee):ee=t[57];let J;t[58]!==ie||t[59]!==i||t[60]!==O||t[61]!==Q||t[62]!==a||t[63]!==j||t[64]!==se||t[65]!==_||t[66]!==h||t[67]!==p?(J=_?(0,s.jsx)(Jc,{conversation:_,messages:Q,onBack:()=>a("/messages"),onSendMessage:h,onToggleReaction:j,currentUser:i,onTyping:te=>p(_.id,te),isLoading:O,isTyping:ie,isOnline:se}):(0,s.jsxs)("div",{className:"hidden md:flex flex-1 items-center justify-center text-zinc-500 flex-col gap-4",children:[(0,s.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full",children:(0,s.jsx)(yt,{size:48,className:"text-zinc-300"})}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-zinc-900 dark:text-white",children:"Select a message"}),(0,s.jsx)("p",{children:"Choose from your existing conversations or start a new one."})]})]}),t[58]=ie,t[59]=i,t[60]=O,t[61]=Q,t[62]=a,t[63]=j,t[64]=se,t[65]=_,t[66]=h,t[67]=p,t[68]=J):J=t[68];let ce;return t[69]!==ne||t[70]!==ee||t[71]!==J?(ce=(0,s.jsxs)("div",{className:ne,children:[ee,J]}),t[69]=ne,t[70]=ee,t[71]=J,t[72]=ce):ce=t[72],ce},us=Kc;function Xc(t){return t.user?.id}var Yc=()=>{const{currentUser:t}=be(),e=ge(),[a,i]=(0,g.useState)([]),[n,r]=(0,g.useState)(!0),[l,o]=(0,g.useState)(!1),[c,u]=(0,g.useState)(!0),d=(0,g.useRef)(a);(0,g.useEffect)(()=>{d.current=a},[a]);const m=(0,g.useCallback)(async(x=!1)=>{if(t?.id){x?o(!0):r(!0);try{const b=d.current,v=x&&b.length>0?b[b.length-1].created_at:null,j=await Xn(t.id,v,10);j.length<10?u(!1):u(!0),i(x?w=>[...w,...j]:j)}catch(b){console.error("Failed to fetch notifications:",b)}finally{r(!1),o(!1)}}},[t?.id]);(0,g.useEffect)(()=>{m()},[m]),(0,g.useEffect)(()=>{if(!t?.id)return;const x=A.channel(`user_notifications:${t.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`recipient_id=eq.${t.id}`},()=>{m()}).subscribe();return()=>A.removeChannel(x)},[t?.id,m]);const f=vs({mutationFn:()=>Yn(t.id),onSuccess:()=>{i(x=>x.map(b=>({...b,is_read:!0})))}}),h=x=>{x.type==="follow"?e(`/u/${x.user}`):x.post_id&&e(`/post/${x.post_id}`)};if((0,g.useEffect)(()=>{t?.id&&a.some(x=>!x.is_read)&&f.mutate()},[t?.id,a,f]),n)return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,s.jsx)(me,{size:32,className:"animate-spin text-violet-500"})});if(!t)return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[400px] gap-4 p-8 text-center",children:[(0,s.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-900 p-4 rounded-full",children:(0,s.jsx)(St,{size:40,className:"text-zinc-400"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"Sign in to see notifications"}),(0,s.jsx)("p",{className:"text-zinc-500 max-w-xs",children:"Join the conversation and keep track of who's engaging with your content."})]});const p=x=>{switch(x){case"like":return(0,s.jsx)(rt,{size:20,className:"text-rose-500 fill-rose-500"});case"follow":return(0,s.jsx)(ps,{size:20,className:"text-blue-500"});case"mention":return(0,s.jsx)(St,{size:20,className:"text-emerald-500"});case"comment":return(0,s.jsx)(Oa,{size:20,className:"text-violet-500"});case"repost":return(0,s.jsx)(Ma,{size:20,className:"text-amber-500"});default:return(0,s.jsx)(St,{size:20,className:"text-zinc-500"})}};return(0,s.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm",children:[(0,s.jsx)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800 sticky top-0 bg-white/80 dark:bg-black/80 backdrop-blur-md z-10",children:(0,s.jsx)("h2",{className:"text-xl font-bold dark:text-white",children:"Notifications"})}),a.length>0?a.map(x=>(0,s.jsxs)("div",{onClick:()=>h(x),className:`p-4 border-b border-zinc-100 dark:border-zinc-800 flex items-start gap-4 hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors cursor-pointer ${x.is_read?"":"bg-violet-50/30 dark:bg-violet-500/5"}`,children:[(0,s.jsx)("div",{className:"shrink-0 pt-1",children:p(x.type)}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-1",children:[(0,s.jsxs)(xe,{className:"size-8",children:[(0,s.jsx)(he,{src:x.avatar}),(0,s.jsx)(pe,{children:x.user?.[0]?.toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex-1 flex justify-between items-center",children:[(0,s.jsxs)("span",{className:"font-bold text-sm dark:text-white truncate",children:["@",x.user]}),(0,s.jsx)("span",{className:"text-zinc-500 text-xs whitespace-nowrap",children:pt(x.created_at)})]})]}),(0,s.jsxs)("p",{className:"text-zinc-600 dark:text-zinc-400 text-[15px] ml-11",children:[x.type==="like"&&"liked your post",x.type==="follow"&&"followed you",x.type==="mention"&&"mentioned you in a post",x.type==="comment"&&"commented on your post",x.type==="repost"&&"reposted your post"]})]}),!x.is_read&&(0,s.jsx)("div",{className:"size-2 rounded-full bg-violet-500 mt-2 shrink-0 shadow-[0_0_8px_rgba(139,92,246,0.5)]"})]},x.id)):(0,s.jsx)("div",{className:"p-16 text-center text-zinc-500",children:(0,s.jsx)("p",{className:"font-medium",children:"No notifications yet."})}),a.length>0&&c&&(0,s.jsx)("div",{className:"p-6 flex justify-center border-t border-zinc-100 dark:border-zinc-800",children:(0,s.jsxs)(ue,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>m(!0),disabled:l,children:[l?(0,s.jsx)(me,{size:18,className:"animate-spin mr-2"}):null,"Load more"]})}),a.length>0&&!c&&(0,s.jsx)("div",{className:"p-8 text-center text-zinc-500 text-sm",children:"You've caught up with everything!"})]})},Gc=Yc,Zc=K(),ed=()=>{const t=(0,Zc.c)(32),{id:e}=Nt(),a=ge(),{currentUser:i}=be(),{addToast:n}=we();let r,l;t[0]!==e?(r=["post",e],l=async()=>{if(!ke(e))throw new Error("Invalid post ID");return Pn(e)},t[0]=e,t[1]=r,t[2]=l):(r=t[1],l=t[2]);const o=!!e;let c;t[3]!==r||t[4]!==l||t[5]!==o?(c={queryKey:r,queryFn:l,enabled:o,retry:!1},t[3]=r,t[4]=l,t[5]=o,t[6]=c):c=t[6];const{data:u,isLoading:d,isError:m}=$e(c);if(d){let C;return t[7]===Symbol.for("react.memo_cache_sentinel")?(C=(0,s.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:(0,s.jsx)(Ht,{})}),t[7]=C):C=t[7],C}if(m||!u){let C;return t[8]===Symbol.for("react.memo_cache_sentinel")?(C=(0,s.jsx)("div",{className:"bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-[600px] flex items-center justify-center",children:(0,s.jsx)(Ut,{title:"Post not found",message:"The post you are looking for doesn't exist. It may have been deleted by the author.",icon:zi})}),t[8]=C):C=t[8],C}let f;t[9]!==a?(f=()=>a(-1),t[9]=a,t[10]=f):f=t[10];let h;t[11]===Symbol.for("react.memo_cache_sentinel")?(h=(0,s.jsx)(tt,{size:20,strokeWidth:2.5}),t[11]=h):h=t[11];let p;t[12]!==f?(p=(0,s.jsx)("button",{onClick:f,className:"p-2 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:h}),t[12]=f,t[13]=p):p=t[13];let x;t[14]===Symbol.for("react.memo_cache_sentinel")?(x=(0,s.jsx)("h5",{className:"text-xl font-bold dark:text-white",children:"Post"}),t[14]=x):x=t[14];let b;t[15]!==p?(b=(0,s.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4",children:[p,x]})}),t[15]=p,t[16]=b):b=t[16];let v;t[17]!==u.comments?(v=u.comments||[],t[17]=u.comments,t[18]=v):v=t[18];let j,w;t[19]!==a?(j=C=>a(`/u/${C}`),w=()=>a(-1),t[19]=a,t[20]=j,t[21]=w):(j=t[20],w=t[21]);let y;t[22]!==n||t[23]!==i||t[24]!==u||t[25]!==j||t[26]!==w||t[27]!==v?(y=(0,s.jsx)(xt,{...u,isDetail:!0,currentUser:i,initialComments:v,showToast:n,onUserClick:j,onDelete:w}),t[22]=n,t[23]=i,t[24]=u,t[25]=j,t[26]=w,t[27]=v,t[28]=y):y=t[28];let _;return t[29]!==y||t[30]!==b?(_=(0,s.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm mb-20 animate-in slide-in-from-right-5 duration-300",children:(0,s.jsxs)("div",{className:"border-b border-zinc-100 dark:border-zinc-800",children:[b,y]})}),t[29]=y,t[30]=b,t[31]=_):_=t[31],_},td=ed,sd=({profile:t,currentUser:e,isCurrentUser:a,onEditProfile:i,showToast:n,isCommunity:r,onShowFollowers:l,onShowFollowing:o})=>{const{isFollowing:c,stats:u,loading:d,handleFollow:m}=ba(t,e?.id,n),f=ge(),[h,p]=(0,g.useState)(!1),x=async()=>{if(!e){n("Please sign in to message users");return}p(!0);try{f(`/messages/${await Js(e.id,t.id)}`)}catch(b){console.error("Failed to start conversation:",b),n("Failed to open chat")}finally{p(!1)}};return(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("div",{className:"relative h-32 sm:h-48 w-full bg-zinc-200 dark:bg-zinc-800",children:[t.cover&&(0,s.jsx)("img",{src:t.cover,className:"h-full w-full object-cover transition-opacity duration-500",alt:"Cover"}),(0,s.jsx)("div",{className:"absolute -bottom-12 sm:-bottom-16 left-4 sm:left-6",children:(0,s.jsx)("div",{className:"p-1 bg-white dark:bg-black rounded-full overflow-hidden shadow-xl ring-4 ring-white dark:ring-black relative",children:(0,s.jsxs)(xe,{className:"size-24 sm:size-32",children:[(0,s.jsx)(he,{src:t.avatar,alt:t.handle,className:"object-cover"}),(0,s.jsx)(pe,{className:"text-4xl font-bold",children:t.handle?.[0]?.toUpperCase()})]})})})]}),(0,s.jsxs)("div",{className:"flex flex-col p-4 sm:p-6 pt-16 sm:pt-20 space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsx)("div",{className:"flex-1 min-w-0 pr-4"}),(0,s.jsx)("div",{className:"flex gap-2 shrink-0",children:a?(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(ue,{variant:"secondary",onClick:()=>i(t),className:"text-sm px-5",children:"Edit profile"}),(0,s.jsx)("button",{onClick:()=>f("/settings"),className:"p-2 rounded-full border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 transition-all active:scale-95",title:"Settings",children:(0,s.jsx)(ei,{size:20})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:x,disabled:h,className:"rounded-full p-2 border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 dark:border-zinc-800 transition-colors disabled:opacity-50",children:h?(0,s.jsx)(me,{size:20,className:"animate-spin"}):(0,s.jsx)(yt,{size:20})}),(0,s.jsx)("button",{className:"rounded-full p-2 border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 dark:border-zinc-800 transition-colors",children:(0,s.jsx)(zt,{size:20})}),(0,s.jsx)(ue,{variant:c?"secondary":"primary",onClick:m,className:"text-sm px-6 min-w-[100px]",disabled:d,children:d?(0,s.jsx)(me,{size:16,className:"animate-spin mx-auto"}):c?"Following":"Follow"}),(0,s.jsx)("button",{className:"rounded-full p-2 hover:bg-zinc-100 text-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-800 transition-colors",children:(0,s.jsx)(Lt,{size:20})})]})})]}),(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsx)("div",{className:"flex items-center gap-1.5",children:(0,s.jsxs)("h3",{className:"text-xl sm:text-2xl font-extrabold truncate dark:text-white flex items-center gap-1",children:[t.name,t.verified&&(0,s.jsx)(lt,{})]})}),!r&&(0,s.jsx)("div",{className:"flex items-center space-x-3",children:(0,s.jsxs)("span",{className:"text-zinc-500 font-medium text-sm px-1.5 py-0.5 -ml-1.5 rounded-md dark:text-zinc-400",children:["@",t.handle]})})]}),(0,s.jsx)("div",{className:"whitespace-pre-line text-zinc-900 dark:text-zinc-100 leading-relaxed text-sm sm:text-[15px]",children:(0,s.jsx)(ct,{options:{...ft,render:({attributes:b,content:v})=>{const{href:j,...w}=b,y=!j.startsWith("/")&&(j.startsWith("http")||j.startsWith("www"));return j.startsWith("/u/")||j.startsWith("/explore")?(0,s.jsx)("span",{...w,className:"text-rose-500 dark:text-rose-400 font-bold hover:underline cursor-pointer",onClick:_=>{_.stopPropagation(),f(j)},children:v},v):(0,s.jsx)("a",{href:j,...w,target:y?"_blank":void 0,rel:y?"noopener noreferrer":void 0,children:v},v)}},children:t.bio})}),(t.website||t.location)&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-x-5 gap-y-2 text-sm pt-1",children:[t.location&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)(qs,{size:14}),(0,s.jsx)("span",{children:t.location})]}),t.website&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)(ws,{size:14}),(0,s.jsx)("a",{href:`https://${t.website}`,target:"_blank",rel:"noreferrer",className:"text-violet-600 hover:underline font-semibold text-black dark:text-white",children:t.website})]})]}),(0,s.jsx)("div",{className:"flex gap-4 sm:gap-6 text-sm pt-2 relative z-10",children:r?(0,s.jsxs)("button",{className:"flex gap-x-1 hover:underline group cursor-pointer",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white group-hover:text-violet-600",children:t.members}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Members"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:b=>{b.preventDefault(),b.stopPropagation(),o()},className:"flex gap-x-1 hover:underline group cursor-pointer",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white group-hover:text-violet-600",children:u.following}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Following"})]}),(0,s.jsxs)("button",{onClick:b=>{b.preventDefault(),b.stopPropagation(),l()},className:"flex gap-x-1 hover:underline group cursor-pointer",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white group-hover:text-violet-600",children:u.followers}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Followers"})]})]})})]})]})},ad=sd,id=K(),nd=t=>{const e=(0,id.c)(78),{onEditProfile:a}=t,{handle:i,profile:n,loading:r,setUserPosts:l,activeProfileTab:o,setActiveProfileTab:c,loadingPosts:u,isFetchingMorePosts:d,hasMorePosts:m,filteredPosts:f,isFollowModalOpen:h,setIsFollowModalOpen:p,followModalType:x,followListData:b,isListLoading:v,isFetchingMoreFollows:j,hasMoreFollows:w,openFollowModal:y,handlePostClick:_,handleUserClick:C,loadUserPosts:F,currentUser:E,addToast:M,navigate:N}=rc();if(r){let J;return e[0]===Symbol.for("react.memo_cache_sentinel")?(J=(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)(me,{size:40,className:"animate-spin text-violet-500"})}),e[0]=J):J=e[0],J}if(!n){const J=`Try searching for another. The user @${i} could not be found.`;let ce;return e[1]!==J?(ce=(0,s.jsx)("div",{className:"bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-[600px] flex items-center justify-center",children:(0,s.jsx)(Ut,{title:"Account doesn't exist",message:J,icon:li})}),e[1]=J,e[2]=ce):ce=e[2],ce}const P=n;let L;e[3]!==M||e[4]!==E||e[5]!==P.handle||e[6]!==f||e[7]!==_||e[8]!==C||e[9]!==m||e[10]!==d||e[11]!==F||e[12]!==u||e[13]!==n||e[14]!==l?(L=()=>u?(0,s.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,s.jsx)(me,{className:"animate-spin text-violet-500",size:32})}):f.length>0?(0,s.jsxs)(s.Fragment,{children:[f.map(J=>(0,s.jsx)(xt,{currentUser:E,showToast:M,...J,onClick:()=>_(J.id),onUserClick:C,onDelete:ce=>l(te=>te.filter(de=>de.id!==ce))},J.feed_id||J.id)),m&&(0,s.jsx)("div",{className:"p-6 flex justify-center",children:(0,s.jsxs)(ue,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>F(n.id,!0),disabled:d,children:[d&&(0,s.jsx)(me,{size:18,className:"animate-spin mr-2"}),"Load more posts"]})})]}):(0,s.jsxs)("div",{className:"p-20 text-center text-zinc-500 flex flex-col items-center gap-4 animate-in fade-in duration-500",children:[(0,s.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full mb-2 ring-1 ring-zinc-100 dark:ring-zinc-800",children:(0,s.jsx)(gs,{size:40,className:"text-zinc-300 dark:text-zinc-700"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"No posts yet"}),(0,s.jsxs)("p",{className:"text-sm text-zinc-500 dark:text-zinc-400 max-w-[250px]",children:["When @",P.handle," shares posts, they will appear here."]})]}),e[3]=M,e[4]=E,e[5]=P.handle,e[6]=f,e[7]=_,e[8]=C,e[9]=m,e[10]=d,e[11]=F,e[12]=u,e[13]=n,e[14]=l,e[15]=L):L=e[15];const R=L;let I;e[16]!==N?(I=()=>N(-1),e[16]=N,e[17]=I):I=e[17];let D;e[18]===Symbol.for("react.memo_cache_sentinel")?(D=(0,s.jsx)(tt,{size:22}),e[18]=D):D=e[18];let S;e[19]!==I?(S=(0,s.jsx)("button",{onClick:I,className:"p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:D}),e[19]=I,e[20]=S):S=e[20];let $;e[21]!==P.name?($=(0,s.jsx)("h5",{className:"text-lg font-bold dark:text-white leading-none",children:P.name}),e[21]=P.name,e[22]=$):$=e[22];const q=P.posts_count||0;let z;e[23]!==q?(z=(0,s.jsxs)("span",{className:"text-xs text-zinc-500 mt-0.5",children:[q," Posts"]}),e[23]=q,e[24]=z):z=e[24];let k;e[25]!==$||e[26]!==z?(k=(0,s.jsxs)("div",{className:"flex flex-col",children:[$,z]}),e[25]=$,e[26]=z,e[27]=k):k=e[27];let O;e[28]!==S||e[29]!==k?(O=(0,s.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3 md:hidden",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4",children:[S,k]})}),e[28]=S,e[29]=k,e[30]=O):O=e[30];const U=E?.handle===P.handle;let T,W;e[31]!==y?(T=()=>y("Followers"),W=()=>y("Following"),e[31]=y,e[32]=T,e[33]=W):(T=e[32],W=e[33]);let Q;e[34]!==M||e[35]!==E||e[36]!==P||e[37]!==a||e[38]!==U||e[39]!==T||e[40]!==W?(Q=(0,s.jsx)(ad,{profile:P,currentUser:E,isCurrentUser:U,onEditProfile:a,showToast:M,onShowFollowers:T,onShowFollowing:W}),e[34]=M,e[35]=E,e[36]=P,e[37]=a,e[38]=U,e[39]=T,e[40]=W,e[41]=Q):Q=e[41];let Z;e[42]===Symbol.for("react.memo_cache_sentinel")?(Z=(0,s.jsx)("div",{className:"sticky top-[60px] md:top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-10 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)(_a,{className:"w-full h-auto bg-transparent p-0 rounded-none justify-start px-2 overflow-x-auto hide-scrollbar",children:["feed","communities","media"].map(ld)})}),e[42]=Z):Z=e[42];let ae;e[43]!==R?(ae=(0,s.jsx)(Mt,{value:"feed",className:"m-0 border-none",children:R()}),e[43]=R,e[44]=ae):ae=e[44];let ie;e[45]!==R?(ie=(0,s.jsx)(Mt,{value:"communities",className:"m-0 border-none",children:R()}),e[45]=R,e[46]=ie):ie=e[46];let G;e[47]!==R?(G=(0,s.jsx)(Mt,{value:"media",className:"m-0 border-none",children:R()}),e[47]=R,e[48]=G):G=e[48];let se;e[49]!==o||e[50]!==c||e[51]!==ae||e[52]!==ie||e[53]!==G?(se=(0,s.jsxs)(ka,{value:o,onValueChange:c,className:"w-full",children:[Z,ae,ie,G]}),e[49]=o,e[50]=c,e[51]=ae,e[52]=ie,e[53]=G,e[54]=se):se=e[54];let ne;e[55]!==Q||e[56]!==se||e[57]!==O?(ne=(0,s.jsxs)("div",{className:"border-y md:border-b-0 border-zinc-100 dark:border-zinc-800",children:[O,Q,se]}),e[55]=Q,e[56]=se,e[57]=O,e[58]=ne):ne=e[58];let V;e[59]!==p?(V=()=>p(!1),e[59]=p,e[60]=V):V=e[60];let H;e[61]!==b||e[62]!==x||e[63]!==w||e[64]!==j||e[65]!==v||e[66]!==N||e[67]!==y||e[68]!==p?(H=(0,s.jsx)("div",{className:"min-h-[300px]",children:v?(0,s.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,s.jsx)(me,{className:"animate-spin text-violet-500",size:32})}):b.length>0?(0,s.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800 -mx-6",children:[b.map(J=>(0,s.jsx)(ga,{profile:J,onUserClick:ce=>{p(!1),N(`/u/${ce}`)}},J.id)),w&&(0,s.jsx)("div",{className:"p-4 flex justify-center",children:(0,s.jsxs)(ue,{variant:"secondary",className:"w-full text-xs",onClick:()=>y(x,!0),disabled:j,children:[j?(0,s.jsx)(me,{size:14,className:"animate-spin mr-2"}):null,"Load more"]})})]}):(0,s.jsx)("div",{className:"flex flex-col items-center justify-center py-20 text-zinc-500",children:(0,s.jsxs)("p",{className:"font-medium",children:["No ",x.toLowerCase()," yet."]})})}),e[61]=b,e[62]=x,e[63]=w,e[64]=j,e[65]=v,e[66]=N,e[67]=y,e[68]=p,e[69]=H):H=e[69];let X;e[70]!==x||e[71]!==h||e[72]!==V||e[73]!==H?(X=(0,s.jsx)(it,{isOpen:h,onClose:V,title:x,className:"sm:max-w-md",children:H}),e[70]=x,e[71]=h,e[72]=V,e[73]=H,e[74]=X):X=e[74];let ee;return e[75]!==ne||e[76]!==X?(ee=(0,s.jsxs)("div",{className:"border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:[ne,X]}),e[75]=ne,e[76]=X,e[77]=ee):ee=e[77],ee},rd=nd;function ld(t){return(0,s.jsx)(qt,{value:t,className:"flex-1 py-4 text-sm font-bold capitalize rounded-none border-b-2 data-[state=active]:border-black dark:data-[state=active]:border-white data-[state=active]:text-black dark:data-[state=active]:text-white text-zinc-500 transition-all hover:bg-zinc-50 dark:hover:bg-zinc-900 whitespace-nowrap px-4",children:t==="feed"?"Posts":t},t)}var od=K(),cd=()=>{const t=(0,od.c)(23),{posts:e,loading:a}=kt(),i=ge(),n=(0,g.useRef)(null),[r,l]=(0,g.useState)(null);let o;t[0]!==e?(o=e.filter(md),t[0]=e,t[1]=o):o=t[1];const c=o;let u;t[2]!==c.length?(u=()=>{if(c.length===0)return;const b={root:n.current,threshold:.6},v=w=>{w.forEach(y=>{y.isIntersecting&&l(y.target.dataset.id)})},j=new IntersectionObserver(v,b);return document.querySelectorAll(".reel-item").forEach(w=>j.observe(w)),()=>j.disconnect()},t[2]=c.length,t[3]=u):u=t[3];let d;if(t[4]!==c?(d=[c],t[4]=c,t[5]=d):d=t[5],(0,g.useEffect)(u,d),a){let b;return t[6]===Symbol.for("react.memo_cache_sentinel")?(b=(0,s.jsx)("div",{className:"h-[100dvh] w-full flex items-center justify-center bg-black",children:(0,s.jsx)(me,{size:40,className:"animate-spin text-white"})}),t[6]=b):b=t[6],b}if(c.length===0){let b;t[7]===Symbol.for("react.memo_cache_sentinel")?(b=(0,s.jsx)("p",{className:"text-zinc-500",children:"No reels found."}),t[7]=b):b=t[7];let v;return t[8]!==i?(v=(0,s.jsxs)("div",{className:"h-[100dvh] w-full flex flex-col items-center justify-center bg-black text-white gap-4",children:[b,(0,s.jsx)("button",{onClick:()=>i(-1),className:"px-4 py-2 bg-white text-black rounded-full text-sm font-bold",children:"Go Back"})]}),t[8]=i,t[9]=v):v=t[9],v}let m;t[10]!==i?(m=()=>i(-1),t[10]=i,t[11]=m):m=t[11];let f;t[12]===Symbol.for("react.memo_cache_sentinel")?(f=(0,s.jsx)(tt,{size:24,strokeWidth:2.5}),t[12]=f):f=t[12];let h;t[13]!==m?(h=(0,s.jsx)("button",{onClick:m,className:"absolute top-6 left-6 z-50 p-2.5 bg-black/20 hover:bg-black/40 text-white backdrop-blur-md rounded-full transition-all active:scale-90 border border-white/10 shadow-xl",title:"Back",children:f}),t[13]=m,t[14]=h):h=t[14];let p;if(t[15]!==r||t[16]!==c){let b;t[18]!==r?(b=v=>(0,s.jsx)(xc,{reel:v,isActive:r===v.id},v.id),t[18]=r,t[19]=b):b=t[19],p=c.map(b),t[15]=r,t[16]=c,t[17]=p}else p=t[17];let x;return t[20]!==h||t[21]!==p?(x=(0,s.jsxs)("div",{ref:n,className:"h-[100dvh] w-full snap-y snap-mandatory overflow-y-auto no-scrollbar bg-black md:rounded-xl relative",children:[h,p]}),t[20]=h,t[21]=p,t[22]=x):x=t[22],x},dd=cd;function md(t){return t.type==="video"||t.category==="video"}var ud=()=>{const{currentUser:t,logout:e}=be(),{darkMode:a,toggleDarkMode:i,fontSize:n,setFontSize:r,dataSaver:l,setDataSaver:o}=mt(),{addToast:c}=we(),[u,d]=(0,g.useState)(!1),[m,f]=(0,g.useState)({newPassword:"",confirmPassword:""}),[h,p]=(0,g.useState)(!1),x=async()=>{try{await e(),c("Logged out successfully")}catch(C){console.error("Logout error:",C),c("Failed to logout")}},b=async C=>{if(C.preventDefault(),m.newPassword!==m.confirmPassword){c("Passwords do not match","error");return}if(m.newPassword.length<6){c("Password must be at least 6 characters","error");return}p(!0);try{const{error:F}=await A.auth.updateUser({password:m.newPassword});if(F)throw F;c("Password updated successfully!"),d(!1),f({newPassword:"",confirmPassword:""})}catch(F){console.error("Password update error:",F),c(F.message||"Failed to update password","error")}finally{p(!1)}},v=async()=>{if(t?.email){p(!0);try{const{error:C}=await A.auth.resetPasswordForEmail(t.email,{redirectTo:`${window.location.origin}/settings?type=recovery`});if(C)throw C;c("Password reset email sent!")}catch(C){console.error("Reset password error:",C),c(C.message||"Failed to send reset email","error")}finally{p(!1)}}},j=()=>{["seenStories","font-size","data-saver","theme"].forEach(C=>localStorage.removeItem(C)),c("Cache cleared! Reloading..."),setTimeout(()=>window.location.reload(),1500)},w=async()=>{p(!0);try{const C={user:{id:t.id,handle:t.handle,name:t.name,email:t.email},exportDate:new Date().toISOString(),note:"This is a mock export of your Sysm data."},F=new Blob([JSON.stringify(C,null,2)],{type:"application/json"}),E=URL.createObjectURL(F),M=document.createElement("a");M.href=E,M.download=`sysm-data-${t.handle}.json`,M.click(),URL.revokeObjectURL(E),c("Data export started!")}catch{c("Failed to export data","error")}finally{p(!1)}},y=()=>{window.confirm("Are you absolutely sure? This will permanently delete your account and all associated data. This action is irreversible.")&&(c("Account deletion request submitted. Logging out..."),setTimeout(x,2e3))},_=()=>{window.prompt("Please describe the bug you found:")&&c("Bug reported! Thank you for your feedback.")};return t?(0,s.jsxs)("div",{className:"flex flex-col min-h-screen bg-white dark:bg-black md:rounded-xl md:border border-zinc-100 dark:border-zinc-800",children:[(0,s.jsx)("div",{className:"sticky top-0 z-10 bg-white/80 dark:bg-black/80 backdrop-blur-md p-4 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)("h2",{className:"text-xl font-bold dark:text-white",children:"Settings"})}),(0,s.jsxs)("div",{className:"p-4 space-y-6 max-w-2xl mx-auto w-full pb-20 mt-4",children:[(0,s.jsxs)("section",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-sm font-bold text-zinc-500 uppercase tracking-wider px-2",children:"Account Security"}),(0,s.jsxs)("div",{className:"bg-zinc-50 dark:bg-zinc-900 rounded-2xl overflow-hidden divide-y divide-zinc-200 dark:divide-zinc-800",children:[(0,s.jsxs)("button",{onClick:()=>d(!u),className:"w-full px-4 py-4 flex items-center gap-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[(0,s.jsx)(hi,{size:20,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"flex-1 font-medium dark:text-zinc-200",children:"Change Password"}),(0,s.jsx)(Qe,{size:16,className:"text-zinc-400"})]}),u&&(0,s.jsxs)("form",{onSubmit:b,className:"p-4 space-y-3 bg-white dark:bg-black animate-in fade-in slide-in-from-top-2",children:[(0,s.jsx)(Se,{type:"password",placeholder:"New Password",value:m.newPassword,onChange:C=>f({...m,newPassword:C.target.value})}),(0,s.jsx)(Se,{type:"password",placeholder:"Confirm Password",value:m.confirmPassword,onChange:C=>f({...m,confirmPassword:C.target.value})}),(0,s.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,s.jsx)(ue,{type:"button",variant:"secondary",onClick:()=>d(!1),children:"Cancel"}),(0,s.jsx)(ue,{type:"submit",disabled:h,children:h?"Saving...":"Update Password"})]})]}),(0,s.jsxs)("button",{onClick:v,className:"w-full px-4 py-4 flex items-center gap-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[(0,s.jsx)(Fs,{size:20,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"flex-1 font-medium dark:text-zinc-200",children:"Reset via Email"}),(0,s.jsx)(Qe,{size:16,className:"text-zinc-400"})]})]})]}),(0,s.jsxs)("section",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-sm font-bold text-zinc-500 uppercase tracking-wider px-2",children:"Display & Typography"}),(0,s.jsxs)("div",{className:"bg-zinc-50 dark:bg-zinc-900 rounded-2xl overflow-hidden divide-y divide-zinc-200 dark:divide-zinc-800",children:[(0,s.jsxs)("button",{onClick:i,className:"w-full px-4 py-4 flex items-center gap-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[a?(0,s.jsx)(Ns,{size:20,className:"text-violet-500"}):(0,s.jsx)(js,{size:20,className:"text-amber-500"}),(0,s.jsx)("span",{className:"flex-1 font-medium dark:text-zinc-200",children:"Dark Mode"}),(0,s.jsx)("div",{className:`w-10 h-6 rounded-full relative transition-colors ${a?"bg-violet-600":"bg-zinc-300"}`,children:(0,s.jsx)("div",{className:`absolute top-1 size-4 bg-white rounded-full transition-all ${a?"left-5":"left-1"}`})})]}),(0,s.jsxs)("div",{className:"px-4 py-4 flex items-center justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(Ra,{size:20,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"font-medium dark:text-zinc-200",children:"Font Size"})]}),(0,s.jsxs)(Wl,{value:n,onValueChange:r,children:[(0,s.jsx)(ja,{className:"w-[140px] bg-zinc-100 dark:bg-zinc-800 border-none font-bold text-violet-600 dark:text-violet-400 capitalize transition-all hover:bg-zinc-200 dark:hover:bg-zinc-700",children:(0,s.jsx)(Bl,{placeholder:"Select"})}),(0,s.jsxs)(za,{className:"bg-white dark:bg-zinc-900 border-zinc-100 dark:border-zinc-800 shadow-2xl rounded-xl p-1",children:[(0,s.jsx)(bt,{value:"small",className:"py-2.5 rounded-lg focus:bg-zinc-50 dark:focus:bg-zinc-800 focus:text-violet-600 font-medium cursor-pointer",children:"Small"}),(0,s.jsx)(bt,{value:"base",className:"py-2.5 rounded-lg focus:bg-zinc-50 dark:focus:bg-zinc-800 focus:text-violet-600 font-medium cursor-pointer",children:"Default"}),(0,s.jsx)(bt,{value:"large",className:"py-2.5 rounded-lg focus:bg-zinc-50 dark:focus:bg-zinc-800 focus:text-violet-600 font-medium cursor-pointer",children:"Large"})]})]})]})]})]}),(0,s.jsxs)("section",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-sm font-bold text-zinc-500 uppercase tracking-wider px-2",children:"Data & Storage"}),(0,s.jsxs)("div",{className:"bg-zinc-50 dark:bg-zinc-900 rounded-2xl overflow-hidden divide-y divide-zinc-200 dark:divide-zinc-800",children:[(0,s.jsxs)("button",{onClick:()=>o(!l),className:"w-full px-4 py-4 flex items-center gap-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[(0,s.jsx)(As,{size:20,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"flex-1 font-medium dark:text-zinc-200",children:"Data Saver"}),(0,s.jsx)("div",{className:`w-10 h-6 rounded-full relative transition-colors ${l?"bg-emerald-600":"bg-zinc-300"}`,children:(0,s.jsx)("div",{className:`absolute top-1 size-4 bg-white rounded-full transition-all ${l?"left-5":"left-1"}`})})]}),(0,s.jsxs)("button",{onClick:j,className:"w-full px-4 py-4 flex items-center gap-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[(0,s.jsx)(Ft,{size:20,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"flex-1 font-medium dark:text-zinc-200",children:"Clear Local Cache"}),(0,s.jsx)(Qe,{size:16,className:"text-zinc-400"})]}),(0,s.jsxs)("button",{onClick:w,className:"w-full px-4 py-4 flex items-center gap-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[(0,s.jsx)(It,{size:20,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"flex-1 font-medium dark:text-zinc-200",children:"Download My Data (Export)"}),(0,s.jsx)(Qe,{size:16,className:"text-zinc-400"})]})]})]}),(0,s.jsxs)("section",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-sm font-bold text-zinc-500 uppercase tracking-wider px-2",children:"Support"}),(0,s.jsxs)("div",{className:"bg-zinc-50 dark:bg-zinc-900 rounded-2xl overflow-hidden divide-y divide-zinc-200 dark:divide-zinc-800",children:[(0,s.jsxs)("button",{onClick:_,className:"w-full px-4 py-4 flex items-center gap-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[(0,s.jsx)(zt,{size:20,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"flex-1 font-medium dark:text-zinc-200",children:"Report a Bug"}),(0,s.jsx)(Qe,{size:16,className:"text-zinc-400"})]}),(0,s.jsxs)("div",{className:"px-4 py-4 flex items-center gap-3",children:[(0,s.jsx)(It,{size:20,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"flex-1 font-medium dark:text-zinc-200",children:"Version"}),(0,s.jsx)("span",{className:"text-zinc-500",children:"1.0.0 (Beta)"})]})]})]}),(0,s.jsx)("section",{className:"space-y-4 pt-4",children:(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsxs)("button",{onClick:x,className:"w-full bg-zinc-100 dark:bg-zinc-900 text-zinc-900 dark:text-zinc-100 p-4 rounded-2xl font-bold flex items-center justify-center gap-2 hover:bg-zinc-200 dark:hover:bg-zinc-800 transition-colors shadow-sm",children:[(0,s.jsx)(bi,{size:20}),"Log Out"]}),(0,s.jsxs)("button",{onClick:y,className:"w-full bg-rose-50 dark:bg-rose-900/10 text-rose-600 dark:text-rose-500 p-4 rounded-2xl font-bold flex items-center justify-center gap-2 border border-rose-100 dark:border-rose-900/20 hover:bg-rose-100 dark:hover:bg-rose-900/40 transition-colors",children:[(0,s.jsx)(Ft,{size:20}),"Delete Account Permanently"]})]})}),(0,s.jsx)("div",{className:"text-center text-xs text-zinc-400 py-4 pb-10",children:"Sysm  2026. Decentralized & Open Source."})]})]}):(0,s.jsx)("div",{className:"flex flex-col items-center justify-center p-10 text-center",children:(0,s.jsx)("p",{className:"text-zinc-500",children:"Please login to view settings."})})},fd=ud,xd=K();function hd(){const t=(0,xd.c)(53),e=ot(),{currentUser:a,authMode:i,setAuthMode:n}=be(),{darkMode:r}=mt(),{isOpen:l,images:o,currentIndex:c,closeLightbox:u,setIndex:d}=Ot(),[m,f]=(0,g.useState)(!1),[h,p]=(0,g.useState)(!1),[x,b]=(0,g.useState)(!1);let v;t[0]===Symbol.for("react.memo_cache_sentinel")?(v={},t[0]=v):v=t[0];const[j,w]=(0,g.useState)(v),[y,_]=(0,g.useState)(null),[C,F]=(0,g.useState)(null);if(i){const G=r?"dark":"";let se;t[1]!==n?(se=()=>n(null),t[1]=n,t[2]=se):se=t[2];let ne;t[3]!==i||t[4]!==n?(ne=()=>n(i==="login"?"signup":"login"),t[3]=i,t[4]=n,t[5]=ne):ne=t[5];let V;t[6]!==i||t[7]!==se||t[8]!==ne?(V=(0,s.jsx)("div",{className:"min-h-screen bg-white dark:bg-black flex items-center justify-center p-4",children:(0,s.jsx)(Ne,{children:(0,s.jsx)(So,{type:i,onComplete:se,onSwitch:ne})})}),t[6]=i,t[7]=se,t[8]=ne,t[9]=V):V=t[9];let H;return t[10]!==G||t[11]!==V?(H=(0,s.jsx)("div",{className:G,children:V}),t[10]=G,t[11]=V,t[12]=H):H=t[12],H}let E;t[13]===Symbol.for("react.memo_cache_sentinel")?(E=(0,s.jsx)(Tr,{}),t[13]=E):E=t[13];let M;t[14]===Symbol.for("react.memo_cache_sentinel")?(M=(0,s.jsx)(Xr,{onPostClick:()=>f(!0)}),t[14]=M):M=t[14];let N;t[15]===Symbol.for("react.memo_cache_sentinel")?(N=(0,s.jsx)(je,{path:"/",element:(0,s.jsx)(Ne,{children:(0,s.jsx)(Pc,{onStoryClick:F,onAddStory:()=>b(!0)})})}),t[15]=N):N=t[15];let P;t[16]===Symbol.for("react.memo_cache_sentinel")?(P=(0,s.jsx)(je,{path:"/home",element:(0,s.jsx)(Kt,{to:"/",replace:!0})}),t[16]=P):P=t[16];let L;t[17]===Symbol.for("react.memo_cache_sentinel")?(L=(0,s.jsx)(je,{path:"/community",element:(0,s.jsx)(Ne,{children:(0,s.jsx)(Nc,{})})}),t[17]=L):L=t[17];let R;t[18]===Symbol.for("react.memo_cache_sentinel")?(R=(0,s.jsx)(je,{path:"/reels",element:(0,s.jsx)(Ne,{children:(0,s.jsx)(dd,{})})}),t[18]=R):R=t[18];let I;t[19]===Symbol.for("react.memo_cache_sentinel")?(I=(0,s.jsx)(je,{path:"/messages",element:(0,s.jsx)(Ne,{children:(0,s.jsx)(us,{})})}),t[19]=I):I=t[19];let D;t[20]===Symbol.for("react.memo_cache_sentinel")?(D=(0,s.jsx)(je,{path:"/settings",element:(0,s.jsx)(Ne,{children:(0,s.jsx)(fd,{})})}),t[20]=D):D=t[20];let S;t[21]===Symbol.for("react.memo_cache_sentinel")?(S=(0,s.jsx)(je,{path:"/messages/:id",element:(0,s.jsx)(Ne,{children:(0,s.jsx)(us,{})})}),t[21]=S):S=t[21];let $;t[22]===Symbol.for("react.memo_cache_sentinel")?($=(0,s.jsx)(je,{path:"/notifications",element:(0,s.jsx)(Ne,{children:(0,s.jsx)(Gc,{})})}),t[22]=$):$=t[22];let q;t[23]===Symbol.for("react.memo_cache_sentinel")?(q=(0,s.jsx)(je,{path:"/post/:id",element:(0,s.jsx)(Ne,{children:(0,s.jsx)(td,{})})}),t[23]=q):q=t[23];let z;t[24]===Symbol.for("react.memo_cache_sentinel")?(z=(0,s.jsx)(je,{path:"/c/:handle",element:(0,s.jsx)(Ne,{children:(0,s.jsx)(jc,{onPostInCommunity:G=>{_(G),f(!0)}})})}),t[24]=z):z=t[24];let k;t[25]===Symbol.for("react.memo_cache_sentinel")?(k=(0,s.jsx)(je,{path:"/u/:handle",element:(0,s.jsx)(Ne,{children:(0,s.jsx)(rd,{onEditProfile:G=>{w(G),p(!0)}})})}),t[25]=k):k=t[25];let O;t[26]===Symbol.for("react.memo_cache_sentinel")?(O=(0,s.jsxs)(je,{element:M,children:[N,P,L,R,I,D,S,$,q,z,k,(0,s.jsx)(je,{path:"*",element:(0,s.jsx)(Kt,{to:"/community"})})]}),t[26]=O):O=t[26];let U;t[27]!==e?(U=(0,s.jsx)(Ni,{location:e,children:O},e.pathname),t[27]=e,t[28]=U):U=t[28];let T;t[29]===Symbol.for("react.memo_cache_sentinel")?(T=G=>{f(G),G||_(null)},t[29]=T):T=t[29];let W;t[30]!==j||t[31]!==h||t[32]!==m||t[33]!==x||t[34]!==y?(W=(0,s.jsx)(vo,{isPostModalOpen:m,setIsPostModalOpen:T,isEditProfileOpen:h,setIsEditProfileOpen:p,isStoryModalOpen:x,setIsStoryModalOpen:b,editProfileData:j,setEditProfileData:w,postCommunity:y}),t[30]=j,t[31]=h,t[32]=m,t[33]=x,t[34]=y,t[35]=W):W=t[35];let Q;t[36]!==C?(Q=C&&(0,s.jsx)(yo,{story:C,onClose:G=>{if(G){const se=JSON.parse(localStorage.getItem("seenStories")||"[]");se.includes(G)||localStorage.setItem("seenStories",JSON.stringify([...se,G]))}F(null)}}),t[36]=C,t[37]=Q):Q=t[37];let Z;t[38]!==u||t[39]!==c||t[40]!==o||t[41]!==l||t[42]!==d?(Z=l&&(0,s.jsx)(Cl,{images:o,currentIndex:c,onClose:u,onNavigate:d}),t[38]=u,t[39]=c,t[40]=o,t[41]=l,t[42]=d,t[43]=Z):Z=t[43];let ae;t[44]!==a||t[45]!==e.pathname?(ae=a&&e.pathname==="/"&&(0,s.jsx)("button",{onClick:()=>f(!0),className:"fixed bottom-20 right-5 md:hidden z-50 bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 size-12 rounded-full flex items-center justify-center shadow-2xl hover:scale-110 active:scale-90 transition-all cursor-pointer group",title:"Create Post",children:(0,s.jsx)(De,{size:28,className:"group-hover:rotate-90 transition-transform duration-300"})}),t[44]=a,t[45]=e.pathname,t[46]=ae):ae=t[46];let ie;return t[47]!==U||t[48]!==W||t[49]!==Q||t[50]!==Z||t[51]!==ae?(ie=(0,s.jsxs)(Fr,{children:[E,U,W,Q,Z,ae]}),t[47]=U,t[48]=W,t[49]=Q,t[50]=Z,t[51]=ae,t[52]=ie):ie=t[52],ie}var pd=new un;(0,bn.createRoot)(document.getElementById("root")).render((0,s.jsx)(g.StrictMode,{children:(0,s.jsx)(ai,{client:pd,children:(0,s.jsx)(Bi,{children:(0,s.jsx)(gr,{children:(0,s.jsx)(xr,{children:(0,s.jsx)(pr,{children:(0,s.jsx)(Cr,{children:(0,s.jsx)(kr,{children:(0,s.jsx)($r,{children:(0,s.jsx)(hd,{})})})})})})})})})}));
