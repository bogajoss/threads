import{a as $}from"./rolldown-runtime-BaZ8gS7u.js";import{c as S,l as F,t as H,v as A,w as M}from"./framework-3lkjbTvb.js";import"./database-COznt_u0.js";import{an as U,in as T}from"./ui-libs-DgV3EAwD.js";import"./media-libs-C98UjHPF.js";import{A as q,C as B,D as I,E as L,O as V,T as E,an as O,b as W,d as Y,dt as P,in as D,k as G,nt as _,rn as J,rt as K,s as Q,tt as X,ut as R,w as Z}from"./index-5RZ1uRDG.js";import{r as ee}from"./post-BekPuQU2.js";import"./text-processing-BMF44JzJ.js";import"./VideoPlayer-Cg7iFPkV.js";import"./actionsheet-DoAmLTwy.js";var se=S(),Ne=$(M(),1),s=$(F(),1),te=v=>{const e=(0,se.c)(24),{user:t,onClick:u,isAddStory:l,isSeen:r}=v,f=l===void 0?!1:l,p=`relative p-0.5 rounded-full ${f?"bg-transparent":r!==void 0&&r?"bg-zinc-200 dark:bg-zinc-800":"bg-gradient-to-tr from-yellow-400 via-pink-500 to-violet-600"}`;let d;e[0]!==t.avatar||e[1]!==t.handle?(d=(0,s.jsx)(O,{src:t.avatar,alt:t.handle,className:"object-cover"}),e[0]=t.avatar,e[1]=t.handle,e[2]=d):d=e[2];let i;e[3]!==t.handle?.[0]?(i=t.handle?.[0]?.toUpperCase(),e[3]=t.handle?.[0],e[4]=i):i=e[4];let a;e[5]!==i?(a=(0,s.jsx)(D,{children:i}),e[5]=i,e[6]=a):a=e[6];let n;e[7]!==d||e[8]!==a?(n=(0,s.jsxs)(J,{className:"size-14 border border-zinc-100 dark:border-zinc-800 sm:size-16",children:[d,a]}),e[7]=d,e[8]=a,e[9]=n):n=e[9];let o;e[10]!==f?(o=f&&(0,s.jsx)("div",{className:"absolute bottom-0 right-0 rounded-full border-2 border-white bg-violet-600 p-1 text-white shadow-lg dark:border-black",children:(0,s.jsx)(T,{size:14,strokeWidth:3})}),e[10]=f,e[11]=o):o=e[11];let c;e[12]!==n||e[13]!==o?(c=(0,s.jsx)("div",{className:"rounded-full bg-white p-0.5 dark:bg-black",children:(0,s.jsxs)("div",{className:"relative",children:[n,o]})}),e[12]=n,e[13]=o,e[14]=c):c=e[14];let m;e[15]!==p||e[16]!==c?(m=(0,s.jsx)("div",{className:p,children:c}),e[15]=p,e[16]=c,e[17]=m):m=e[17];const b=f?"Add Story":t.handle;let h;e[18]!==b?(h=(0,s.jsx)("span",{className:"w-16 truncate text-center text-[11px] font-semibold leading-tight text-zinc-600 dark:text-zinc-400",children:b}),e[18]=b,e[19]=h):h=e[19];let x;return e[20]!==u||e[21]!==m||e[22]!==h?(x=(0,s.jsxs)("button",{onClick:u,className:"group flex shrink-0 flex-col items-center gap-2",children:[m,h]}),e[20]=u,e[21]=m,e[22]=h,e[23]=x):x=e[23],x},C=te,re=S(),ae=v=>{const e=(0,re.c)(25),{index:t}=v,u=t===void 0?0:t,l=A(),{reels:r,loading:f}=Q();if(f&&r.length===0){let h;e[0]===Symbol.for("react.memo_cache_sentinel")?(h=(0,s.jsxs)("div",{className:"mb-3 px-4 flex items-center justify-between",children:[(0,s.jsx)(_,{className:"h-6 w-32 rounded"}),(0,s.jsx)(_,{className:"h-4 w-16 rounded"})]}),e[0]=h):h=e[0];let x;return e[1]===Symbol.for("react.memo_cache_sentinel")?(x=(0,s.jsxs)("div",{className:"my-4 border-y border-zinc-100 bg-zinc-50/30 py-4 dark:border-zinc-800 dark:bg-zinc-900/10",children:[h,(0,s.jsx)("div",{className:"flex gap-4 overflow-hidden px-4",children:[...Array(5)].map(ie)})]}),e[1]=x):x=e[1],x}if(r.length===0)return null;const p=u%Math.max(1,Math.floor(r.length/5))*5;let d,i,a,n,o;if(e[2]!==l||e[3]!==r||e[4]!==p){const h=r.slice(p,p+10);n="my-4 border-y border-zinc-100 bg-zinc-50/30 py-4 dark:border-zinc-800 dark:bg-zinc-900/10";let x;e[10]===Symbol.for("react.memo_cache_sentinel")?(x=(0,s.jsx)("h3",{className:"font-bold text-lg",children:"Recommended Reels"}),e[10]=x):x=e[10],e[11]!==l?(o=(0,s.jsxs)("div",{className:"mb-3 px-4 flex items-center justify-between",children:[x,(0,s.jsx)("button",{onClick:()=>l("/r"),className:"text-sm font-semibold text-violet-600 hover:underline",children:"View all"})]}),e[11]=l,e[12]=o):o=e[12],i=B,d=Z;let g;e[13]!==l?(g=j=>(0,s.jsxs)(E,{className:"aspect-[9/16] w-[150px] sm:w-[180px]",onClick:()=>l(`/r/${j.id}`),children:[(0,s.jsx)(q,{src:j.media?.[0]?.url||"",poster:j.media?.[0]?.poster||""}),(0,s.jsx)(G,{}),(0,s.jsxs)("div",{className:"absolute top-2 left-2 z-10 flex items-center gap-1 rounded-full bg-black/20 px-2 py-1 backdrop-blur-md",children:[(0,s.jsx)(U,{size:10,fill:"white",className:"text-white"}),(0,s.jsx)("span",{className:"text-[10px] font-bold text-white",children:j.stats?.views||0})]}),(0,s.jsxs)(L,{children:[(0,s.jsx)(I,{name:j.user?.handle,src:j.user?.avatar}),(0,s.jsx)(V,{children:j.user?.handle})]})]},j.id),e[13]=l,e[14]=g):g=e[14],a=h.map(g),e[2]=l,e[3]=r,e[4]=p,e[5]=d,e[6]=i,e[7]=a,e[8]=n,e[9]=o}else d=e[5],i=e[6],a=e[7],n=e[8],o=e[9];let c;e[15]!==d||e[16]!==a?(c=(0,s.jsx)(d,{children:a}),e[15]=d,e[16]=a,e[17]=c):c=e[17];let m;e[18]!==i||e[19]!==c?(m=(0,s.jsx)(i,{children:c}),e[18]=i,e[19]=c,e[20]=m):m=e[20];let b;return e[21]!==n||e[22]!==o||e[23]!==m?(b=(0,s.jsxs)("div",{className:n,children:[o,m]}),e[21]=n,e[22]=o,e[23]=m,e[24]=b):b=e[24],b},le=ae;function ie(v,e){return(0,s.jsx)(_,{className:"aspect-[9/16] w-[150px] shrink-0 rounded-xl sm:w-[180px]"},e)}var w=S(),ne=v=>{const e=(0,w.c)(19),{currentUser:t,groupedStories:u,onAddStory:l,onStoryClick:r}=v;let f;e[0]!==t||e[1]!==l?(f=t&&(0,s.jsx)(C,{user:t,isAddStory:!0,onClick:l}),e[0]=t,e[1]=l,e[2]=f):f=e[2];let p;if(e[3]!==u||e[4]!==r){let c;e[6]!==r?(c=m=>(0,s.jsx)(C,{user:m.user,isSeen:m.isSeen,onClick:()=>r(m)},m.user.id),e[6]=r,e[7]=c):c=e[7],p=u.map(c),e[3]=u,e[4]=r,e[5]=p}else p=e[5];let d;e[8]!==f||e[9]!==p?(d=(0,s.jsxs)("div",{className:"flex w-max gap-4 px-4 py-4",children:[f,p]}),e[8]=f,e[9]=p,e[10]=d):d=e[10];let i;e[11]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsx)(P,{orientation:"horizontal",className:"hidden"}),e[11]=i):i=e[11];let a;e[12]!==d?(a=(0,s.jsxs)(R,{className:"w-full border-b border-zinc-100 bg-background dark:border-zinc-800",children:[d,i]}),e[12]=d,e[13]=a):a=e[13];let n;e[14]!==t?(n=!t&&(0,s.jsx)("div",{className:"px-4 py-2 md:hidden",children:(0,s.jsx)(K,{className:"p-6"})}),e[14]=t,e[15]=n):n=e[15];let o;return e[16]!==a||e[17]!==n?(o=(0,s.jsxs)("div",{className:"bg-background",children:[a,n]}),e[16]=a,e[17]=n,e[18]=o):o=e[18],o},oe=v=>{const e=(0,w.c)(4),{isFetchingNextPage:t,hasMore:u,hasPosts:l}=v;let r;return e[0]!==u||e[1]!==l||e[2]!==t?(r=(0,s.jsx)("div",{className:"flex justify-center py-8",children:t?(0,s.jsx)("p",{className:"text-sm text-zinc-400 animate-pulse",children:"Loading more..."}):u?(0,s.jsx)("div",{className:"h-4"}):l?(0,s.jsx)("p",{className:"text-sm font-medium text-zinc-500",children:"You've reached the end of the feed."}):(0,s.jsxs)("div",{className:"p-20 text-center text-zinc-500",children:[(0,s.jsx)("p",{className:"text-lg font-medium",children:"No posts yet."}),(0,s.jsx)("p",{className:"text-sm",children:"Be the first to share something amazing!"})]})}),e[0]=u,e[1]=l,e[2]=t,e[3]=r):r=e[3],r},de=v=>{const e=(0,w.c)(29),{onStoryClick:t}=v,u=A(),{currentUser:l,homePosts:r,groupedStories:f,isPostsLoading:p,isStoriesLoading:d,hasMore:i,isFetchingNextPage:a,fetchNextPage:n,handlePostClick:o,handleUserClick:c,refreshPosts:m}=Y();if(p||d){let N;return e[0]===Symbol.for("react.memo_cache_sentinel")?(N=(0,s.jsxs)("div",{className:"min-h-screen overflow-hidden rounded-none border-y border-zinc-100 bg-background dark:border-zinc-800 md:rounded-xl md:border",children:[(0,s.jsxs)(R,{className:"w-full whitespace-nowrap border-b border-zinc-100 dark:border-zinc-800",children:[(0,s.jsxs)("div",{className:"flex w-max gap-3 px-4 py-4",children:[(0,s.jsx)("div",{className:"size-16 shrink-0 animate-pulse rounded-full bg-zinc-100 dark:bg-zinc-900"}),(0,s.jsx)("div",{className:"size-16 shrink-0 animate-pulse rounded-full bg-zinc-100 dark:bg-zinc-900"}),(0,s.jsx)("div",{className:"size-16 shrink-0 animate-pulse rounded-full bg-zinc-100 dark:bg-zinc-900"})]}),(0,s.jsx)(P,{orientation:"horizontal",className:"hidden"})]}),[1,2,3].map(ce)]}),e[0]=N):N=e[0],N}let b;e[1]!==l||e[2]!==f||e[3]!==u||e[4]!==t?(b=()=>(0,s.jsx)(ne,{currentUser:l,groupedStories:f,onAddStory:()=>u("/create",{state:{isStory:!0}}),onStoryClick:t}),e[1]=l,e[2]=f,e[3]=u,e[4]=t,e[5]=b):b=e[5];let h;e[6]!==i||e[7]!==r||e[8]!==a?(h=()=>(0,s.jsx)(oe,{isFetchingNextPage:a,hasMore:i,hasPosts:r.length>0}),e[6]=i,e[7]=r,e[8]=a,e[9]=h):h=e[9];let x;e[10]!==b||e[11]!==h?(x={Header:b,Footer:h},e[10]=b,e[11]=h,e[12]=x):x=e[12];let g;e[13]!==n||e[14]!==i||e[15]!==a?(g=()=>{i&&!a&&n()},e[13]=n,e[14]=i,e[15]=a,e[16]=g):g=e[16];let j;e[17]!==l||e[18]!==o||e[19]!==c?(j=(N,z)=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ee,{...z,currentUser:l,onClick:()=>o(z.id),onUserClick:c},z.feed_id||z.id),(N===4||N>4&&(N-4)%25===0)&&(0,s.jsx)(le,{index:Math.floor((N+1)/5)})]}),e[17]=l,e[18]=o,e[19]=c,e[20]=j):j=e[20];let k;e[21]!==r||e[22]!==x||e[23]!==g||e[24]!==j?(k=(0,s.jsx)(H,{useWindowScroll:!0,data:r,overscan:400,increaseViewportBy:200,components:x,endReached:g,itemContent:j}),e[21]=r,e[22]=x,e[23]=g,e[24]=j,e[25]=k):k=e[25];let y;return e[26]!==m||e[27]!==k?(y=(0,s.jsx)("div",{className:"w-full max-full min-h-screen rounded-none border-zinc-100 bg-background dark:border-zinc-800 md:rounded-xl",children:(0,s.jsx)(W,{onRefresh:m,children:k})}),e[26]=m,e[27]=k,e[28]=y):y=e[28],y},ke=de;function ce(v){return(0,s.jsx)(X,{},v)}export{ke as default};
