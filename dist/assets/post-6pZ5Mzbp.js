const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/VideoPlayer-g5KtG9S4.js","assets/framework-qAfQIUpw.js","assets/database-CdmW3A7f.js","assets/animations-DnIvWaa_.js","assets/rolldown-runtime-BaZ8gS7u.js","assets/framework-sg0yWRLc.css","assets/media-libs-BYH8vgqC.js","assets/media-libs-CqCaMccn.css","assets/VideoPlayer-DvODOJ-Q.js","assets/index-BDHAGO-X.js","assets/ui-libs-B8EJCVYu.js","assets/query-gr-7CPJN.js","assets/index-D9XckxLl.css","assets/dist-DzEd4B1b.js"])))=>i.map(i=>d[i]);
import{a as dt}from"./rolldown-runtime-BaZ8gS7u.js";import{a as $t,i as ne,o as Ft,s as Pt}from"./animations-DnIvWaa_.js";import{_ as oe,b as mt,c as B,n as Tt,u as Rt}from"./framework-qAfQIUpw.js";import{r as It}from"./query-gr-7CPJN.js";import{$t as Mt,Bt as Et,Fn as xt,Hn as ke,In as Ue,It as At,Kn as Dt,Nn as We,Qn as Lt,Rn as Ot,Rt as Ut,Vn as Wt,Wn as Vt,Zt as Bt,an as qt,cn as Ht,dn as Qt,gn as ft,in as Gt,ir as Xt,jn as pe,kt as re,ln as Jt,mn as Kt,on as Yt,rn as ye,wn as Zt,yn as es,zn as ts}from"./ui-libs-B8EJCVYu.js";import{An as ss,At as Ve,Cn as is,Ct as ee,D as ls,Dt as Be,E as ge,Et as qe,F as as,Ft as ht,In as He,It as ns,Lt as rs,Mn as Ne,Mt as Qe,Nn as G,Ot as Ge,P as os,Pn as ue,Pt as cs,Qt as ds,Rt as Ce,Sn as ms,St as te,Tt as Xe,Ut as xs,Vt as ut,Yt as Je,_ as pt,_n as fs,b as hs,cn as us,en as ps,fn as gs,jt as Ke,k as vs,kt as Ye,ln as bs,tt as gt,v as js,w as zs,wt as se,x as ks,yn as Ze}from"./index-BDHAGO-X.js";import{t as _e}from"./text-processing-CRKQxkaV.js";import{t as Se}from"./linkify-Bgxg4QY4.js";import{n as ae,t as ys}from"./actionsheet-DqUQOnYn.js";import{p as Ns,u as et}from"./hooks-BwGALAFG.js";var ws=B(),w=dt(Pt(),1),t=dt(Ft(),1),Cs=i=>{const e=(0,ws.c)(37),{isComment:s,liked:r,reposted:a,handleLike:l,handleRepost:o,handleCommentClick:d,handleShareClick:c,isDetail:v}=i;if(v!==void 0&&v){let C;e[0]!==l||e[1]!==r?(C=(0,t.jsx)(X,{icon:pe,label:"Like",type:"like",onClick:l,active:r}),e[0]=l,e[1]=r,e[2]=C):C=e[2];let b;e[3]!==o||e[4]!==s||e[5]!==a?(b=!s&&(0,t.jsx)(X,{icon:ye,label:"Repost",type:"repost",onClick:o,active:a}),e[3]=o,e[4]=s,e[5]=a,e[6]=b):b=e[6];let k;e[7]!==d?(k=(0,t.jsx)(X,{icon:pt,label:"Comment",type:"comment",onClick:d}),e[7]=d,e[8]=k):k=e[8];let n;e[9]!==c||e[10]!==s?(n=!s&&(0,t.jsx)(X,{icon:ge,label:"Share",type:"share",onClick:c}),e[9]=c,e[10]=s,e[11]=n):n=e[11];let _;return e[12]!==C||e[13]!==b||e[14]!==k||e[15]!==n?(_=(0,t.jsxs)("div",{className:"mt-4 flex w-full items-center justify-around py-1",children:[C,b,k,n]}),e[12]=C,e[13]=b,e[14]=k,e[15]=n,e[16]=_):_=e[16],_}const p=`flex items-center gap-x-1 ${s?"mt-1.5":"mt-3"}`,h=s?16:18;let f;e[17]!==l||e[18]!==r||e[19]!==h?(f=(0,t.jsx)(X,{icon:pe,size:h,type:"like",onClick:l,active:r}),e[17]=l,e[18]=r,e[19]=h,e[20]=f):f=e[20];const j=s?16:18;let u;e[21]!==d||e[22]!==j?(u=(0,t.jsx)(X,{icon:ft,size:j,type:"comment",onClick:d}),e[21]=d,e[22]=j,e[23]=u):u=e[23];const x=s?16:18;let g;e[24]!==o||e[25]!==a||e[26]!==x?(g=(0,t.jsx)(X,{icon:ye,size:x,type:"repost",onClick:o,active:a}),e[24]=o,e[25]=a,e[26]=x,e[27]=g):g=e[27];let m;e[28]!==c||e[29]!==s?(m=!s&&c&&(0,t.jsx)(X,{icon:ge,type:"share",onClick:c}),e[28]=c,e[29]=s,e[30]=m):m=e[30];let N;return e[31]!==p||e[32]!==f||e[33]!==u||e[34]!==g||e[35]!==m?(N=(0,t.jsxs)("div",{className:p,children:[f,u,g,m]}),e[31]=p,e[32]=f,e[33]=u,e[34]=g,e[35]=m,e[36]=N):N=e[36],N},tt=Cs,_s=B(),Ss=i=>{const e=(0,_s.c)(38),{views:s,likes:r,comments:a,isDetail:l,isComment:o,onRepliesClick:d}=i,c=l===void 0?!1:l,v=o===void 0?!1:o;if(c){const g=s||0;let m;e[0]!==g?(m=(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:g}),e[0]=g,e[1]=m):m=e[1];let N;e[2]===Symbol.for("react.memo_cache_sentinel")?(N=(0,t.jsx)("span",{className:"opacity-70",children:"Views"}),e[2]=N):N=e[2];let C;e[3]!==m?(C=(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[m," ",N]}),e[3]=m,e[4]=C):C=e[4];const b=r||0;let k;e[5]!==b?(k=(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:b}),e[5]=b,e[6]=k):k=e[6];let n;e[7]===Symbol.for("react.memo_cache_sentinel")?(n=(0,t.jsx)("span",{className:"opacity-70",children:"Likes"}),e[7]=n):n=e[7];let _;e[8]!==k?(_=(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[k," ",n]}),e[8]=k,e[9]=_):_=e[9];const S=a||0;let R;e[10]!==S?(R=(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:S}),e[10]=S,e[11]=R):R=e[11];let $;e[12]===Symbol.for("react.memo_cache_sentinel")?($=(0,t.jsx)("span",{className:"opacity-70",children:"Comments"}),e[12]=$):$=e[12];let z;e[13]!==R?(z=(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[R," ",$]}),e[13]=R,e[14]=z):z=e[14];let P;return e[15]!==_||e[16]!==z||e[17]!==C?(P=(0,t.jsxs)("div",{className:"mt-4 flex items-center gap-x-6 border-b border-zinc-100 pb-4 text-sm text-zinc-500 dark:border-zinc-800 dark:text-zinc-400",children:[C,_,z]}),e[15]=_,e[16]=z,e[17]=C,e[18]=P):P=e[18],P}if(a===0&&r===0&&(s===0||v))return null;const p=`mt-1 flex items-center gap-x-1.5 px-0.5 ${v?"text-[12px]":"text-[14px]"} font-medium text-zinc-500 dark:text-zinc-400`;let h;e[19]!==a||e[20]!==v||e[21]!==r||e[22]!==s?(h=s>0&&!v&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{className:"hover:underline",children:[s," ",s===1?"view":"views"]}),(a>0||r>0)&&(0,t.jsx)("span",{className:"opacity-50",children:"·"})]}),e[19]=a,e[20]=v,e[21]=r,e[22]=s,e[23]=h):h=e[23];let f;e[24]!==a||e[25]!==d?(f=a>0&&(0,t.jsxs)("button",{className:"hover:underline",onClick:g=>{g.stopPropagation(),d&&d(g)},children:[a," ",a===1?"reply":"replies"]}),e[24]=a,e[25]=d,e[26]=f):f=e[26];let j;e[27]!==a||e[28]!==r?(j=a>0&&r>0&&(0,t.jsx)("span",{className:"opacity-50",children:"·"}),e[27]=a,e[28]=r,e[29]=j):j=e[29];let u;e[30]!==r?(u=r>0&&(0,t.jsxs)("button",{className:"hover:underline",children:[r," ",r===1?"like":"likes"]}),e[30]=r,e[31]=u):u=e[31];let x;return e[32]!==p||e[33]!==h||e[34]!==f||e[35]!==j||e[36]!==u?(x=(0,t.jsxs)("div",{className:p,children:[h,f,j,u]}),e[32]=p,e[33]=h,e[34]=f,e[35]=j,e[36]=u,e[37]=x):x=e[37],x},st=Ss,$s=B(),Fs=i=>{const e=(0,$s.c)(43),{user:s,timeAgo:r,community:a,onUserClick:l,actionsMenu:o,isComment:d,isDetail:c,showAvatar:v}=i,p=v===void 0?!1:v,h=oe();let f;e[0]!==l||e[1]!==s.handle?(f=I=>{I.stopPropagation(),l&&l(s.handle)},e[0]=l,e[1]=s.handle,e[2]=f):f=e[2];const j=f;let u;e[3]!==a||e[4]!==h?(u=I=>{I.stopPropagation(),a&&h(`/c/${a.handle}`)},e[3]=a,e[4]=h,e[5]=u):u=e[5];const x=u,g=`flex items-center justify-between ${c?"pb-4":"min-h-[40px] mb-1"}`;let m;e[6]!==j||e[7]!==d||e[8]!==c||e[9]!==p||e[10]!==s.avatar||e[11]!==s.handle?(m=p&&(0,t.jsx)("button",{className:"shrink-0",onClick:j,children:(0,t.jsxs)(te,{className:`${c?"size-12":d?"size-8":"size-10"} border-0 shadow-sm`,children:[(0,t.jsx)(se,{src:s.avatar,alt:s.handle,className:"object-cover"}),(0,t.jsx)(ee,{className:"text-xs",children:s.handle[0]?.toUpperCase()})]})}),e[6]=j,e[7]=d,e[8]=c,e[9]=p,e[10]=s.avatar,e[11]=s.handle,e[12]=m):m=e[12];const N=`flex shrink-0 items-center gap-1 font-bold text-zinc-900 hover:underline dark:text-white ${c?"text-base sm:text-lg":d?"text-[14px]":"text-[15px]"}`;let C;e[13]!==s.handle?(C=(0,t.jsx)("span",{className:"max-w-[150px] truncate sm:max-w-none",children:s.handle}),e[13]=s.handle,e[14]=C):C=e[14];let b;e[15]!==d||e[16]!==c||e[17]!==s.verified?(b=s.verified&&(0,t.jsx)(ls,{size:c?16:d?12:14,className:"text-blue-500"}),e[15]=d,e[16]=c,e[17]=s.verified,e[18]=b):b=e[18];let k;e[19]!==j||e[20]!==N||e[21]!==C||e[22]!==b?(k=(0,t.jsxs)("button",{className:N,onClick:j,children:[C,b]}),e[19]=j,e[20]=N,e[21]=C,e[22]=b,e[23]=k):k=e[23];let n;e[24]!==a||e[25]!==x||e[26]!==c?(n=a&&(0,t.jsxs)("div",{className:"flex min-w-0 items-center gap-1 text-zinc-500",children:[(0,t.jsx)(js,{size:c?14:12,className:"shrink-0 text-zinc-400"}),(0,t.jsxs)("button",{className:`flex items-center gap-1 font-bold text-zinc-900 hover:underline dark:text-zinc-100 ${c?"text-[14px] sm:text-[15px]":"text-[13px]"}`,onClick:x,children:[(0,t.jsxs)(te,{className:"size-3.5 shrink-0 border border-zinc-200 bg-zinc-100 dark:border-zinc-700 dark:bg-zinc-800",children:[(0,t.jsx)(se,{src:a.avatar,alt:a.name,className:"object-cover"}),(0,t.jsx)(ee,{className:"text-[6px] font-bold text-zinc-500",children:a.name?.[0]?.toUpperCase()})]}),(0,t.jsx)("span",{className:"max-w-[150px] truncate sm:max-w-none",children:a.name})]})]}),e[24]=a,e[25]=x,e[26]=c,e[27]=n):n=e[27];let _;e[28]!==n||e[29]!==k?(_=(0,t.jsx)("div",{className:"flex min-w-0 flex-1 flex-col",children:(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-x-1.5 leading-none",children:(0,t.jsxs)("div",{className:"flex min-w-0 max-w-full items-center gap-1.5",children:[k,n]})})}),e[28]=n,e[29]=k,e[30]=_):_=e[30];let S;e[31]!==_||e[32]!==m?(S=(0,t.jsxs)("div",{className:"flex items-center gap-x-3 flex-1 min-w-0",children:[m,_]}),e[31]=_,e[32]=m,e[33]=S):S=e[33];const R=r||"Recent";let $;e[34]!==R?($=(0,t.jsx)("span",{className:"whitespace-nowrap text-[12px] text-zinc-500 dark:text-zinc-400",children:R}),e[34]=R,e[35]=$):$=e[35];let z;e[36]!==o||e[37]!==$?(z=(0,t.jsxs)("div",{className:"-mt-1 flex items-center gap-2",children:[$,o]}),e[36]=o,e[37]=$,e[38]=z):z=e[38];let P;return e[39]!==S||e[40]!==z||e[41]!==g?(P=(0,t.jsxs)("div",{className:g,children:[S,z]}),e[39]=S,e[40]=z,e[41]=g,e[42]=P):P=e[42],P},it=Fs,Ps=B(),Ts=i=>{const e=(0,Ps.c)(45),{content:s,isDetail:r,isEditing:a,editedContent:l,setEditedContent:o,onCancelEdit:d,onSaveEdit:c,isUpdating:v,contentClass:p}=i,h=oe(),[f,j]=(0,w.useState)(!1),u=typeof s=="string"&&He(s);if(a&&o){let z;e[0]!==o?(z=H=>o(H.target.value),e[0]=o,e[1]=z):z=e[1];const P=`min-h-[100px] w-full rounded-xl border-zinc-200 bg-zinc-50 focus:ring-violet-500 dark:border-zinc-800 dark:bg-zinc-900 ${He(l||"")?"font-bangla text-lg":"font-english"}`;let I;e[2]!==l||e[3]!==z||e[4]!==P?(I=(0,t.jsx)(vs,{value:l,onChange:z,className:P,autoFocus:!0}),e[2]=l,e[3]=z,e[4]=P,e[5]=I):I=e[5];let M;e[6]!==d?(M=(0,t.jsx)("button",{onClick:d,className:"px-4 py-1.5 text-sm font-bold text-zinc-500 transition-colors hover:text-zinc-700 dark:hover:text-zinc-300",children:"Cancel"}),e[6]=d,e[7]=M):M=e[7];let A;e[8]!==s||e[9]!==l||e[10]!==v?(A=v||!l?.trim()||l===s,e[8]=s,e[9]=l,e[10]=v,e[11]=A):A=e[11];const O=v?"Saving...":"Save";let D;e[12]!==c||e[13]!==A||e[14]!==O?(D=(0,t.jsx)("button",{onClick:c,disabled:A,className:"rounded-full bg-violet-600 px-4 py-1.5 text-sm font-bold text-white transition-all hover:bg-violet-700 disabled:opacity-50 active:scale-95",children:O}),e[12]=c,e[13]=A,e[14]=O,e[15]=D):D=e[15];let L;e[16]!==M||e[17]!==D?(L=(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[M,D]}),e[16]=M,e[17]=D,e[18]=L):L=e[18];let U;return e[19]!==I||e[20]!==L?(U=(0,t.jsxs)("div",{className:"mt-2 flex flex-col gap-2",onClick:Rs,children:[I,L]}),e[19]=I,e[20]=L,e[21]=U):U=e[21],U}const x=!r&&s.length>280;let g;e[22]!==s||e[23]!==f||e[24]!==x?(g=x&&!f?s.substring(0,280):s,e[22]=s,e[23]=f,e[24]=x,e[25]=g):g=e[25];const m=g,N=r?"text-lg leading-relaxed sm:text-xl sm:leading-8":"text-[15px] leading-relaxed",C=u?"font-bangla text-[1.15em]":"font-english";let b;e[26]!==p||e[27]!==N||e[28]!==C?(b=G("whitespace-pre-line break-words",N,C,p),e[26]=p,e[27]=N,e[28]=C,e[29]=b):b=e[29];let k;e[30]!==h?(k={...Se,render:z=>{const{attributes:P,content:I}=z,{href:M,...A}=P,O=window.location.origin;if(M.includes("internal.tag/")){const L=decodeURIComponent(M.split("internal.tag/")[1]);return(0,t.jsxs)("span",{...A,className:G("cursor-pointer font-bold text-rose-600 hover:underline dark:text-rose-400 font-bangla",A.className),onClick:U=>{U.stopPropagation(),h(`/tags/${L}`)},children:["#",L]},I)}let D=null;return M.startsWith("/")?D=M:M.startsWith(O)&&(D=M.replace(O,"")),D?(0,t.jsx)("span",{...A,className:G("cursor-pointer font-medium text-violet-600 hover:underline dark:text-violet-400",A.className),onClick:L=>{L.stopPropagation(),h(D)},children:I},I):(0,t.jsx)("a",{href:M,...A,target:"_blank",rel:"noopener noreferrer",className:G("text-violet-600 hover:underline dark:text-violet-400",A.className),onClick:Is,children:I},I)}},e[30]=h,e[31]=k):k=e[31];let n;e[32]!==m?(n=typeof m=="string"?m.replace(/#([\u0980-\u09FF\w]+)/g,"https://internal.tag/$1"):m,e[32]=m,e[33]=n):n=e[33];let _;e[34]!==k||e[35]!==n?(_=(0,t.jsx)(_e,{options:k,children:n}),e[34]=k,e[35]=n,e[36]=_):_=e[36];const S=x&&!f&&"...";let R;e[37]!==f||e[38]!==x?(R=x&&(0,t.jsx)("button",{onClick:z=>{z.stopPropagation(),j(!f)},className:"ml-1 cursor-pointer font-bold text-rose-600 hover:underline dark:text-rose-400",children:f?"Show less":"See more"}),e[37]=f,e[38]=x,e[39]=R):R=e[39];let $;return e[40]!==b||e[41]!==_||e[42]!==S||e[43]!==R?($=(0,t.jsxs)("div",{className:b,children:[_,S,R]}),e[40]=b,e[41]=_,e[42]=S,e[43]=R,e[44]=$):$=e[44],$},lt=Ts;function Rs(i){return i.stopPropagation()}function Is(i){return i.stopPropagation()}var Ms=B(),Es=i=>{const e=(0,Ms.c)(28),{media:s,isEditing:r,editedMedia:a,setEditedMedia:l,newFiles:o,setNewFiles:d}=i;let c;e[0]!==a?(c=a===void 0?[]:a,e[0]=a,e[1]=c):c=e[1];const v=c;let p;e[2]!==o?(p=o===void 0?[]:o,e[2]=o,e[3]=p):p=e[3];const h=p,f=(0,w.useRef)(null);if(r&&l&&d){let u;if(e[4]!==v||e[5]!==l){let b;e[7]!==l?(b=(k,n)=>(0,t.jsxs)("div",{className:"group relative aspect-square overflow-hidden rounded-xl border border-zinc-200 dark:border-zinc-800",children:[k.type==="video"?(0,t.jsx)("div",{className:"flex size-full items-center justify-center bg-zinc-100 dark:bg-zinc-900",children:(0,t.jsx)(Ue,{size:24,className:"text-zinc-400"})}):(0,t.jsx)("img",{src:k.url||k.src,className:"size-full object-cover",alt:""}),(0,t.jsx)("button",{onClick:_=>{_.stopPropagation(),l(S=>S.filter((R,$)=>$!==n))},className:"absolute right-1.5 top-1.5 flex size-7 items-center justify-center rounded-full bg-black/60 text-white transition-colors hover:bg-black",children:(0,t.jsx)(re,{size:16})})]},`old-${n}`),e[7]=l,e[8]=b):b=e[8],u=v.map(b),e[4]=v,e[5]=l,e[6]=u}else u=e[6];let x;if(e[9]!==h||e[10]!==d){let b;e[12]!==d?(b=(k,n)=>(0,t.jsxs)("div",{className:"group relative aspect-square overflow-hidden rounded-xl border-2 border-dashed border-violet-500 bg-violet-50/10",children:[k.type.startsWith("image/")?(0,t.jsx)("img",{src:URL.createObjectURL(k),className:"size-full object-cover",alt:""}):(0,t.jsx)("div",{className:"flex size-full items-center justify-center",children:(0,t.jsx)(Ue,{size:24,className:"animate-pulse text-violet-500"})}),(0,t.jsx)("button",{onClick:_=>{_.stopPropagation(),d(S=>S.filter((R,$)=>$!==n))},className:"absolute right-1.5 top-1.5 flex size-7 items-center justify-center rounded-full bg-black/60 text-white transition-colors hover:bg-black",children:(0,t.jsx)(re,{size:16})}),(0,t.jsx)("div",{className:"absolute bottom-1 left-1 rounded bg-violet-600 px-1 text-[8px] font-bold text-white",children:"NEW"})]},`new-${n}`),e[12]=d,e[13]=b):b=e[13],x=h.map(b),e[9]=h,e[10]=d,e[11]=x}else x=e[11];let g;e[14]!==v.length||e[15]!==h.length?(g=v.length+h.length<4&&(0,t.jsxs)("button",{onClick:b=>{b.stopPropagation(),f.current?.click()},className:"relative flex aspect-square flex-col items-center justify-center gap-1 rounded-xl border-2 border-dashed border-zinc-200 text-zinc-400 transition-all hover:border-violet-500 hover:bg-violet-50/5 hover:text-violet-500 dark:border-zinc-800",children:[(0,t.jsx)(Gt,{size:20}),(0,t.jsx)("span",{className:"text-[10px] font-bold",children:"Add Media"})]}),e[14]=v.length,e[15]=h.length,e[16]=g):g=e[16];let m;e[17]!==u||e[18]!==x||e[19]!==g?(m=(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:[u,x,g]}),e[17]=u,e[18]=x,e[19]=g,e[20]=m):m=e[20];let N;e[21]!==d?(N=(0,t.jsx)("input",{type:"file",ref:f,onChange:b=>{if(b.target.files){const k=Array.from(b.target.files);d(n=>[...n,...k])}},multiple:!0,className:"hidden",accept:"image/*,video/*"}),e[21]=d,e[22]=N):N=e[22];let C;return e[23]!==m||e[24]!==N?(C=(0,t.jsxs)("div",{className:"mt-3 space-y-3",children:[m,N]}),e[23]=m,e[24]=N,e[25]=C):C=e[25],C}if(!s||s.length===0)return null;let j;return e[26]!==s?(j=(0,t.jsx)(ai,{items:s}),e[26]=s,e[27]=j):j=e[27],j},at=Es,As=B(),Ds=i=>{const e=(0,As.c)(48),{icon:s,count:r,label:a,onClick:l,active:o,activeColorClass:d,size:c,type:v}=i,p=c===void 0?18:c,h=v===void 0?"default":v;let f,j,u,x,g,m,N;if(e[0]!==o||e[1]!==d||e[2]!==r||e[3]!==a||e[4]!==l||e[5]!==h){const A={like:{hoverBg:"group-hover:bg-rose-500/10",hoverText:"group-hover:text-rose-500",activeText:"text-rose-500",activeFill:"fill-rose-500"},repost:{hoverBg:"group-hover:bg-emerald-500/10",hoverText:"group-hover:text-emerald-500",activeText:"text-emerald-500",activeFill:"fill-emerald-500"},comment:{hoverBg:"group-hover:bg-sky-500/10",hoverText:"group-hover:text-sky-500",activeText:"text-sky-500",activeFill:"fill-sky-500"},share:{hoverBg:"group-hover:bg-violet-500/10",hoverText:"group-hover:text-violet-500",activeText:"text-violet-500",activeFill:"fill-violet-500"},default:{hoverBg:"group-hover:bg-zinc-500/10",hoverText:"group-hover:text-zinc-500",activeText:"text-zinc-900 dark:text-white",activeFill:"fill-current"}};j=A[h]||A.default;const O=d||j.activeText;f=ne.button,e[13]===Symbol.for("react.memo_cache_sentinel")?(x={scale:.85},e[13]=x):x=e[13],e[14]!==l?(g=D=>{D.stopPropagation(),l&&l(D)},e[14]=l,e[15]=g):g=e[15],m=`${a} ${r!==void 0?`(${r})`:""}`,N=G("group -ml-2 flex items-center gap-x-0.5 rounded-xl px-2 py-1.5 text-[12px] font-bold transition-all sm:gap-x-1 sm:text-[13px]",o?O:"text-zinc-500",!o&&j.hoverText),u=G("rounded-full p-2 transition-all duration-200",!o&&j.hoverBg),e[0]=o,e[1]=d,e[2]=r,e[3]=a,e[4]=l,e[5]=h,e[6]=f,e[7]=j,e[8]=u,e[9]=x,e[10]=g,e[11]=m,e[12]=N}else f=e[6],j=e[7],u=e[8],x=e[9],g=e[10],m=e[11],N=e[12];let C;e[16]!==o?(C=o?{scale:[1,1.4,1],rotate:[0,15,0]}:{scale:1},e[16]=o,e[17]=C):C=e[17];let b;e[18]===Symbol.for("react.memo_cache_sentinel")?(b={duration:.45,type:"spring",stiffness:300,damping:15},e[18]=b):b=e[18];const k=o?2.5:2,n=o&&j.activeFill;let _;e[19]!==n?(_=G("transition-colors duration-200",n),e[19]=n,e[20]=_):_=e[20];let S;e[21]!==s||e[22]!==p||e[23]!==k||e[24]!==_?(S=(0,t.jsx)(s,{size:p,strokeWidth:k,className:_}),e[21]=s,e[22]=p,e[23]=k,e[24]=_,e[25]=S):S=e[25];let R;e[26]!==S||e[27]!==C?(R=(0,t.jsx)(ne.div,{animate:C,transition:b,children:S}),e[26]=S,e[27]=C,e[28]=R):R=e[28];let $;e[29]!==R||e[30]!==u?($=(0,t.jsx)("div",{className:u,children:R}),e[29]=R,e[30]=u,e[31]=$):$=e[31];let z;e[32]!==a?(z=a&&(0,t.jsx)("span",{className:"hidden xs:inline",children:a}),e[32]=a,e[33]=z):z=e[33];let P;e[34]!==o||e[35]!==r?(P=r!=null&&(0,t.jsx)(ne.span,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},className:G("transition-all",o?"font-black":"font-bold"),children:r||0},r),e[34]=o,e[35]=r,e[36]=P):P=e[36];let I;e[37]!==P?(I=(0,t.jsx)($t,{mode:"wait",children:P}),e[37]=P,e[38]=I):I=e[38];let M;return e[39]!==f||e[40]!==$||e[41]!==z||e[42]!==I||e[43]!==x||e[44]!==g||e[45]!==m||e[46]!==N?(M=(0,t.jsxs)(f,{whileTap:x,onClick:g,"aria-label":m,className:N,children:[$,z,I]}),e[39]=f,e[40]=$,e[41]=z,e[42]=I,e[43]=x,e[44]=g,e[45]=m,e[46]=N,e[47]=M):M=e[47],M},X=Ds,Ls=B(),Os=i=>{const e=(0,Ls.c)(18),{poll:s,onVote:r}=i,a=s.options.reduce(Us,0),[l,o]=(0,w.useState)(null);let d;e[0]!==r||e[1]!==l?(d=u=>{l||(o(u),r&&r(u))},e[0]=r,e[1]=l,e[2]=d):d=e[2];const c=d;let v;if(e[3]!==c||e[4]!==s.options||e[5]!==a||e[6]!==l){let u;e[8]!==c||e[9]!==a||e[10]!==l?(u=(x,g)=>{const m=a>0?Math.round((x.votes+(l===x.id?1:0))/(a+(l?1:0))*100):0,N=l===x.id;return(0,t.jsxs)("div",{onClick:()=>c(x.id),className:`relative h-10 w-full overflow-hidden rounded-xl border cursor-pointer ${N?"border-violet-500 dark:border-violet-500":"border-zinc-200 dark:border-zinc-700"}`,children:[l&&(0,t.jsx)("div",{className:"absolute left-0 top-0 h-full bg-zinc-200 transition-all duration-500 dark:bg-zinc-800",style:{width:`${m}%`}}),(0,t.jsxs)("div",{className:"absolute inset-0 z-10 flex items-center justify-between px-4",children:[(0,t.jsxs)("span",{className:`text-sm font-medium ${N?"font-bold text-violet-600":"text-zinc-700 dark:text-zinc-200"}`,children:[x.text," ",N&&(0,t.jsx)(Lt,{size:14,className:"mb-0.5 inline ml-1"})]}),l&&(0,t.jsxs)("span",{className:"text-sm font-bold text-zinc-900 dark:text-white",children:[m,"%"]})]})]},x.id||g)},e[8]=c,e[9]=a,e[10]=l,e[11]=u):u=e[11],v=s.options.map(u),e[3]=c,e[4]=s.options,e[5]=a,e[6]=l,e[7]=v}else v=e[7];const p=a+(l?1:0),h=l?"6 days left":"Click to vote";let f;e[12]!==p||e[13]!==h?(f=(0,t.jsxs)("div",{className:"pl-1 text-xs text-zinc-500 dark:text-zinc-400",children:[p," votes •"," ",h]}),e[12]=p,e[13]=h,e[14]=f):f=e[14];let j;return e[15]!==v||e[16]!==f?(j=(0,t.jsxs)("div",{className:"mt-3 space-y-2",children:[v,f]}),e[15]=v,e[16]=f,e[17]=j):j=e[17],j},nt=Os;function Us(i,e){return i+e.votes}var Ws=B(),Vs=i=>{const e=(0,Ws.c)(30),{user:s,time:r,content:a}=i,l=oe();let o;e[0]!==s.avatar||e[1]!==s.handle?(o=(0,t.jsx)(se,{src:s.avatar,alt:s.handle}),e[0]=s.avatar,e[1]=s.handle,e[2]=o):o=e[2];let d;e[3]!==s.handle[0]?(d=s.handle[0]?.toUpperCase(),e[3]=s.handle[0],e[4]=d):d=e[4];let c;e[5]!==d?(c=(0,t.jsx)(ee,{children:d}),e[5]=d,e[6]=c):c=e[6];let v;e[7]!==o||e[8]!==c?(v=(0,t.jsxs)(te,{className:"size-6",children:[o,c]}),e[7]=o,e[8]=c,e[9]=v):v=e[9];let p;e[10]!==s.handle?(p=(0,t.jsx)("span",{className:"text-sm font-semibold",children:s.handle}),e[10]=s.handle,e[11]=p):p=e[11];let h;e[12]!==v||e[13]!==p?(h=(0,t.jsxs)("div",{className:"flex items-center gap-x-2",children:[v,p]}),e[12]=v,e[13]=p,e[14]=h):h=e[14];let f;e[15]!==r?(f=(0,t.jsx)("span",{className:"text-xs text-zinc-500 sm:text-sm",children:r}),e[15]=r,e[16]=f):f=e[16];let j;e[17]!==h||e[18]!==f?(j=(0,t.jsxs)("div",{className:"mb-2 flex items-center justify-between gap-x-2",children:[h,f]}),e[17]=h,e[18]=f,e[19]=j):j=e[19];let u;e[20]!==l?(u={...Se,render:N=>{const{attributes:C,content:b}=N,{href:k,...n}=C,_=window.location.origin;let S=null;return k.startsWith("/")?S=k:k.startsWith(_)&&(S=k.replace(_,"")),S?(0,t.jsx)("span",{...n,className:G("cursor-pointer font-medium text-violet-600 hover:underline dark:text-violet-400",n.className),onClick:R=>{R.stopPropagation(),l(S)},children:b},b):(0,t.jsx)("a",{href:k,...n,target:"_blank",rel:"noopener noreferrer",className:G("text-violet-600 hover:underline dark:text-violet-400",n.className),onClick:Bs,children:b},b)}},e[20]=l,e[21]=u):u=e[21];let x;e[22]!==a?(x=(0,t.jsx)("p",{className:"whitespace-pre-line text-sm text-zinc-800 dark:text-zinc-300",children:a}),e[22]=a,e[23]=x):x=e[23];let g;e[24]!==x||e[25]!==u?(g=(0,t.jsx)(_e,{options:u,children:x}),e[24]=x,e[25]=u,e[26]=g):g=e[26];let m;return e[27]!==g||e[28]!==j?(m=(0,t.jsxs)("div",{className:"p-4",children:[j,g]}),e[27]=g,e[28]=j,e[29]=m):m=e[29],m},rt=Vs;function Bs(i){return i.stopPropagation()}var qs=B(),Hs=i=>{const e=(0,qs.c)(54),{currentUser:s,newComment:r,setNewComment:a,handleSubmitComment:l,loading:o,selectedFiles:d,setSelectedFiles:c,isUploading:v}=i;let p;e[0]!==d?(p=d===void 0?[]:d,e[0]=d,e[1]=p):p=e[1];const h=p,f=(0,w.useRef)(null);let j;e[2]!==c?(j=y=>{if(y.target.files){const F=Array.from(y.target.files);c&&c(E=>[...E,...F])}},e[2]=c,e[3]=j):j=e[3];const u=j;let x;e[4]!==c?(x=y=>{c&&c(F=>F.filter((E,V)=>V!==y))},e[4]=c,e[5]=x):x=e[5];const g=x;let m;e[6]!==c?(m=y=>{const F=y.clipboardData.files;if(F&&F.length>0){const E=Array.from(F).filter(Qs);E.length>0&&(y.preventDefault(),c&&c(V=>[...V,...E]))}},e[6]=c,e[7]=m):m=e[7];const N=m;if(!s){let y;return e[8]===Symbol.for("react.memo_cache_sentinel")?(y=(0,t.jsx)("div",{className:"border-y border-zinc-100 bg-zinc-50/30 p-6 text-center dark:border-zinc-800 dark:bg-zinc-900/10",children:(0,t.jsx)("p",{className:"text-sm text-zinc-500",children:"Please login to join the conversation."})}),e[8]=y):y=e[8],y}let C;e[9]!==s.avatar||e[10]!==s.handle?(C=(0,t.jsx)(se,{src:s.avatar,alt:s.handle,className:"object-cover"}),e[9]=s.avatar,e[10]=s.handle,e[11]=C):C=e[11];let b;e[12]!==s.handle?.[0]?(b=s.handle?.[0]?.toUpperCase(),e[12]=s.handle?.[0],e[13]=b):b=e[13];let k;e[14]!==b?(k=(0,t.jsx)(ee,{children:b}),e[14]=b,e[15]=k):k=e[15];let n;e[16]!==C||e[17]!==k?(n=(0,t.jsxs)(te,{className:"size-9 border border-zinc-200 dark:border-zinc-700",children:[C,k]}),e[16]=C,e[17]=k,e[18]=n):n=e[18];let _;e[19]!==a?(_=y=>a(y.target.value),e[19]=a,e[20]=_):_=e[20];let S;e[21]!==N||e[22]!==r||e[23]!==_?(S=(0,t.jsx)("textarea",{id:"comment-input",className:"min-h-[60px] w-full resize-none bg-transparent text-base outline-none placeholder:text-zinc-500 dark:text-white",placeholder:"Post your reply...",value:r,onChange:_,onPaste:N}),e[21]=N,e[22]=r,e[23]=_,e[24]=S):S=e[24];let R;e[25]!==g||e[26]!==h?(R=h.length>0&&(0,t.jsx)("div",{className:"mt-2 mb-2 flex flex-wrap gap-2",children:h.map((y,F)=>(0,t.jsxs)("div",{className:"relative size-20 overflow-hidden rounded-xl border border-zinc-200 dark:border-zinc-800",children:[y.type.startsWith("image/")?(0,t.jsx)("img",{src:URL.createObjectURL(y),className:"size-full object-cover",alt:""}):(0,t.jsx)("div",{className:"flex size-full items-center justify-center bg-zinc-100 dark:bg-zinc-800",children:(0,t.jsx)(Jt,{size:20,className:"text-zinc-500"})}),(0,t.jsx)("button",{onClick:()=>g(F),className:"absolute right-1 top-1 rounded-full bg-black/60 p-1 text-white transition-colors hover:bg-black",children:(0,t.jsx)(re,{size:12})})]},F))}),e[25]=g,e[26]=h,e[27]=R):R=e[27];let $;e[28]===Symbol.for("react.memo_cache_sentinel")?($=()=>f.current?.click(),e[28]=$):$=e[28];let z;e[29]===Symbol.for("react.memo_cache_sentinel")?(z=(0,t.jsx)("button",{type:"button",onClick:$,className:"rounded-full p-2 text-violet-600 transition-colors hover:bg-violet-50 dark:hover:bg-zinc-800",title:"Attach media",children:(0,t.jsx)(zs,{size:20})}),e[29]=z):z=e[29];let P;e[30]!==u?(P=(0,t.jsxs)("div",{className:"flex gap-1 text-violet-600",children:[z,(0,t.jsx)("input",{type:"file",ref:f,onChange:u,multiple:!0,className:"hidden",accept:"image/*,video/*,application/pdf"})]}),e[30]=u,e[31]=P):P=e[31];const I=o||v?"primary":"animated";let M;e[32]!==v||e[33]!==o?(M=!(o||v)&&(0,t.jsx)(ge,{size:20}),e[32]=v,e[33]=o,e[34]=M):M=e[34];const A=o||v;let O;e[35]!==r||e[36]!==h.length?(O=!r.trim()&&h.length===0,e[35]=r,e[36]=h.length,e[37]=O):O=e[37];let D;e[38]!==l||e[39]!==I||e[40]!==M||e[41]!==A||e[42]!==O?(D=(0,t.jsx)(cs,{variant:I,icon:M,className:"min-w-[70px] !w-auto",onClick:l,loading:A,disabled:O,children:"Reply"}),e[38]=l,e[39]=I,e[40]=M,e[41]=A,e[42]=O,e[43]=D):D=e[43];let L;e[44]!==P||e[45]!==D?(L=(0,t.jsxs)("div",{className:"mt-2 flex items-center justify-between border-t border-zinc-100 pt-3 dark:border-zinc-800",children:[P,D]}),e[44]=P,e[45]=D,e[46]=L):L=e[46];let U;e[47]!==S||e[48]!==R||e[49]!==L?(U=(0,t.jsxs)("div",{className:"flex-1",children:[S,R,L]}),e[47]=S,e[48]=R,e[49]=L,e[50]=U):U=e[50];let H;return e[51]!==U||e[52]!==n?(H=(0,t.jsx)("div",{className:"border-y border-zinc-100 bg-zinc-50/30 p-4 dark:border-zinc-800 dark:bg-zinc-900/10",children:(0,t.jsxs)("div",{className:"flex gap-3",children:[n,U]})}),e[51]=U,e[52]=n,e[53]=H):H=e[53],H},vt=w.memo(Hs);function Qs(i){return i.type.startsWith("image/")}var Gs=B(),Xs=i=>{const e=(0,Gs.c)(30),{url:s}=i;let r,a;e[0]!==s?(r=["link-preview",s],a=()=>xs(s),e[0]=s,e[1]=r,e[2]=a):(r=e[1],a=e[2]);const l=!!s;let o;e[3]!==r||e[4]!==a||e[5]!==l?(o={queryKey:r,queryFn:a,staleTime:864e5,enabled:l},e[3]=r,e[4]=a,e[5]=l,e[6]=o):o=e[6];const{data:d,isLoading:c,isError:v}=It(o);if(c){let C;return e[7]===Symbol.for("react.memo_cache_sentinel")?(C=(0,t.jsx)("div",{className:"mt-3 flex h-24 animate-pulse items-center justify-center overflow-hidden rounded-2xl border border-zinc-100 bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-900/50",children:(0,t.jsx)(We,{className:"animate-spin text-zinc-300 dark:text-zinc-700",size:24})}),e[7]=C):C=e[7],C}if(v||!d||!d.title&&!d.image)return null;let p;e[8]!==d.image||e[9]!==d.title?(p=d.image&&(0,t.jsx)("div",{className:"aspect-[1.91/1] w-full overflow-hidden border-b border-zinc-100 bg-zinc-100 dark:border-zinc-800 dark:bg-zinc-900",children:(0,t.jsx)("img",{src:d.image,alt:d.title??void 0,className:"h-full w-full object-cover transition-transform duration-500 group-hover:scale-[1.02]",onError:Ks})}),e[8]=d.image,e[9]=d.title,e[10]=p):p=e[10];let h;e[11]===Symbol.for("react.memo_cache_sentinel")?(h=(0,t.jsx)(We,{size:12}),e[11]=h):h=e[11];let f;e[12]!==d.siteName?(f=(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs font-bold uppercase tracking-wider text-zinc-600",children:[h,(0,t.jsx)("span",{children:d.siteName})]}),e[12]=d.siteName,e[13]=f):f=e[13];let j;e[14]!==d.title?(j=(0,t.jsx)("div",{className:"line-clamp-2 text-[15px] font-bold leading-snug transition-colors group-hover:text-violet-700 dark:text-white",children:d.title}),e[14]=d.title,e[15]=j):j=e[15];let u;e[16]!==d.description?(u=d.description&&(0,t.jsx)("p",{className:"line-clamp-2 text-xs leading-relaxed text-zinc-600 dark:text-zinc-400",children:d.description}),e[16]=d.description,e[17]=u):u=e[17];let x;e[18]===Symbol.for("react.memo_cache_sentinel")?(x=(0,t.jsx)(Wt,{size:10}),e[18]=x):x=e[18];let g;e[19]!==s?(g=(0,t.jsxs)("div",{className:"flex items-center gap-1 pt-1 text-[11px] font-medium text-zinc-500",children:[x,(0,t.jsx)("span",{className:"truncate",children:s})]}),e[19]=s,e[20]=g):g=e[20];let m;e[21]!==g||e[22]!==f||e[23]!==j||e[24]!==u?(m=(0,t.jsxs)("div",{className:"space-y-1 p-3.5",children:[f,j,u,g]}),e[21]=g,e[22]=f,e[23]=j,e[24]=u,e[25]=m):m=e[25];let N;return e[26]!==m||e[27]!==p||e[28]!==s?(N=(0,t.jsxs)("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"group mt-3 flex flex-col overflow-hidden rounded-2xl border border-zinc-100 bg-white shadow-sm transition-all hover:bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-950 dark:hover:bg-zinc-900",onClick:Js,children:[p,m]}),e[26]=m,e[27]=p,e[28]=s,e[29]=N):N=e[29],N},ot=Xs;function Js(i){return i.stopPropagation()}function Ks(i){return i.target.style.display="none"}var Ys=B(),Zs=i=>{const e=(0,Ys.c)(15),{file:s}=i;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=(0,t.jsx)("div",{className:"flex size-10 items-center justify-center rounded-xl bg-violet-100 text-violet-600 dark:bg-violet-900/30",children:(0,t.jsx)(Ot,{size:20})}),e[0]=r):r=e[0];let a;e[1]!==s.name?(a=(0,t.jsx)("div",{className:"truncate text-sm font-bold dark:text-white",children:s.name}),e[1]=s.name,e[2]=a):a=e[2];let l;e[3]!==s.size?(l=s.size!==void 0&&(0,t.jsxs)("div",{className:"text-xs uppercase text-zinc-500",children:[(s.size/1024/1024).toFixed(2)," MB"]}),e[3]=s.size,e[4]=l):l=e[4];let o;e[5]!==a||e[6]!==l?(o=(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[a,l]}),e[5]=a,e[6]=l,e[7]=o):o=e[7];let d;e[8]===Symbol.for("react.memo_cache_sentinel")?(d=(0,t.jsx)(Vt,{size:18}),e[8]=d):d=e[8];let c;e[9]!==s.name||e[10]!==s.url?(c=(0,t.jsx)("a",{href:s.url,download:s.name,className:"p-2 text-zinc-400 transition-colors hover:text-violet-600",onClick:ti,children:d}),e[9]=s.name,e[10]=s.url,e[11]=c):c=e[11];let v;return e[12]!==o||e[13]!==c?(v=(0,t.jsxs)("div",{className:"group mt-3 flex items-center gap-3 rounded-2xl border border-zinc-100 bg-zinc-50/50 p-3 transition-colors hover:border-violet-500/30 dark:border-zinc-800 dark:bg-zinc-900/10",children:[r,o,c]}),e[12]=o,e[13]=c,e[14]=v):v=e[14],v},ei=Zs;function ti(i){return i.stopPropagation()}var bt=B(),si=w.lazy(()=>mt(()=>import("./VideoPlayer-g5KtG9S4.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),ii=i=>{const e=(0,bt.c)(10),{item:s,onClick:r}=i,[a,l]=(0,w.useState)(!1);let o;e[0]!==a?(o=!a&&(0,t.jsx)("div",{className:"absolute inset-0 animate-pulse bg-zinc-200 dark:bg-zinc-800"}),e[0]=a,e[1]=o):o=e[1];const d=s.url||s.src,c=`size-full object-cover transition-all duration-500 hover:scale-[1.02] ${a?"opacity-100":"opacity-0"}`;let v;e[2]===Symbol.for("react.memo_cache_sentinel")?(v=()=>l(!0),e[2]=v):v=e[2];let p;e[3]!==d||e[4]!==c?(p=(0,t.jsx)("img",{src:d,className:c,alt:"",loading:"lazy",onLoad:v}),e[3]=d,e[4]=c,e[5]=p):p=e[5];let h;return e[6]!==r||e[7]!==o||e[8]!==p?(h=(0,t.jsxs)("div",{className:"relative size-full overflow-hidden",onClick:r,children:[o,p]}),e[6]=r,e[7]=o,e[8]=p,e[9]=h):h=e[9],h},li=i=>{const e=(0,bt.c)(3),{items:s}=i,r=s===void 0?[]:s,{openLightbox:a}=ns();if(!r||Array.isArray(r)&&r.length===0)return null;const l=Array.isArray(r)?r:[r],o=l.filter(ni),d=l.filter(ri),c=o.some(oi),v=u=>{const x=o.filter(ci).map(di),g=o[u];a(x,x.indexOf(g.url||g.src))},p="mt-2 space-y-2",h=o.length>0&&(0,t.jsx)("div",{className:`grid gap-2 overflow-hidden rounded-2xl border border-zinc-100 dark:border-zinc-800 ${o.length===1?"grid-cols-1":o.length===2?c?"aspect-[8/9] grid-cols-1 grid-rows-2":"aspect-[16/9] grid-cols-2":(o.length===3,"aspect-[16/9] grid-cols-2 grid-rows-2")}`,children:o.map((u,x)=>(0,t.jsx)("div",{className:`relative cursor-pointer overflow-hidden bg-zinc-100 dark:bg-zinc-900 ${o.length===3&&x===0?"row-span-2":""}`,children:u.type==="video"?(0,t.jsx)(w.Suspense,{fallback:(0,t.jsx)("div",{className:"flex aspect-video w-full items-center justify-center bg-zinc-100 dark:bg-zinc-900",children:(0,t.jsx)("div",{className:"size-8 animate-spin rounded-full border-2 border-violet-500 border-t-transparent"})}),children:(0,t.jsx)(si,{src:u.url,poster:u.poster||void 0})}):(0,t.jsx)(ii,{item:u,onClick:g=>{g.stopPropagation(),v(x)}})},x))}),f=d.map(mi);let j;return e[0]!==h||e[1]!==f?(j=(0,t.jsxs)("div",{className:p,children:[h,f]}),e[0]=h,e[1]=f,e[2]=j):j=e[2],j},ai=li;function ni(i){return i.type==="image"||i.type==="video"}function ri(i){return i.type==="file"}function oi(i){return i.type==="video"}function ci(i){return i.type==="image"}function di(i){return i.url||i.src}function mi(i,e){return(0,t.jsx)(ei,{file:i},e)}var jt=B(),xi=i=>{const e=(0,jt.c)(6),{avatars:s}=i;if(!s||s.length===0)return null;let r,a;if(e[0]!==s){const o=s.slice(0,3);r="relative mt-2 h-7 w-7",a=o.map((d,c)=>{let v,p;return o.length===1?(v="top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",p="size-5"):o.length===2?(p="size-4",v=c===0?"top-0 right-0":"bottom-0 left-0"):(p=c===0?"size-3.5":"size-3",c===0?v="top-0 right-0":c===1?v="bottom-0 right-0":v="top-1/2 left-0 -translate-y-1/2"),(0,t.jsx)("div",{className:`absolute rounded-full border border-white bg-zinc-100 dark:border-black dark:bg-zinc-800 overflow-hidden shadow-sm ${v} ${p}`,style:{zIndex:10-c},children:(0,t.jsx)("img",{src:d,alt:"",className:"h-full w-full object-cover"})},c)}),e[0]=s,e[1]=r,e[2]=a}else r=e[1],a=e[2];let l;return e[3]!==r||e[4]!==a?(l=(0,t.jsx)("div",{className:r,children:a}),e[3]=r,e[4]=a,e[5]=l):l=e[5],l},ct=i=>{const e=(0,jt.c)(37),{id:s,user:r,isCurrentUser:a,isComment:l,onEdit:o,onDelete:d,addToast:c,trigger:v}=i,{openReport:p}=ht(),[h,f]=(0,w.useState)(!1);let j;e[0]===Symbol.for("react.memo_cache_sentinel")?(j=$=>{$.stopPropagation(),f(!0)},e[0]=j):j=e[0];let u;e[1]!==v?(u=(0,t.jsx)("div",{onClick:j,children:v}),e[1]=v,e[2]=u):u=e[2];let x;e[3]===Symbol.for("react.memo_cache_sentinel")?(x=()=>f(!1),e[3]=x):x=e[3];let g;e[4]!==c||e[5]!==s||e[6]!==l?(g=!l&&(0,t.jsx)(ae,{icon:(0,t.jsx)(Bt,{size:18}),onClick:$=>{$.stopPropagation(),navigator.clipboard.writeText(`${window.location.origin}/p/${s}`),c("Link copied"),f(!1)},children:"Copy link"}),e[4]=c,e[5]=s,e[6]=l,e[7]=g):g=e[7];let m;e[8]===Symbol.for("react.memo_cache_sentinel")?(m=(0,t.jsx)(xt,{size:18}),e[8]=m):m=e[8];let N;e[9]!==s||e[10]!==p?(N=$=>{$.stopPropagation(),p("post",s),f(!1)},e[9]=s,e[10]=p,e[11]=N):N=e[11];const C=l?"comment":"post";let b;e[12]!==N||e[13]!==C?(b=(0,t.jsxs)(ae,{icon:m,onClick:N,children:["Report ",C]}),e[12]=N,e[13]=C,e[14]=b):b=e[14];let k;e[15]!==a||e[16]!==p||e[17]!==r?(k=!a&&(0,t.jsxs)(ae,{icon:(0,t.jsx)(At,{size:18}),onClick:$=>{$.stopPropagation(),p("user",r.id),f(!1)},children:["Report @",r.handle]}),e[15]=a,e[16]=p,e[17]=r,e[18]=k):k=e[18];let n;e[19]!==l||e[20]!==a||e[21]!==o?(n=a&&(0,t.jsxs)(ae,{icon:(0,t.jsx)(Yt,{size:18}),onClick:$=>{$.stopPropagation(),o(),f(!1)},children:["Edit ",l?"Comment":"Post"]}),e[19]=l,e[20]=a,e[21]=o,e[22]=n):n=e[22];let _;e[23]!==l||e[24]!==a||e[25]!==d?(_=a&&(0,t.jsxs)(ae,{variant:"destructive",icon:(0,t.jsx)(Et,{size:18}),onClick:$=>{$.stopPropagation(),d(),f(!1)},children:["Delete ",l?"comment":"post"]}),e[23]=l,e[24]=a,e[25]=d,e[26]=_):_=e[26];let S;e[27]!==h||e[28]!==n||e[29]!==_||e[30]!==g||e[31]!==b||e[32]!==k?(S=(0,t.jsxs)(ys,{isOpen:h,onClose:x,children:[g,b,k,n,_]}),e[27]=h,e[28]=n,e[29]=_,e[30]=g,e[31]=b,e[32]=k,e[33]=S):S=e[33];let R;return e[34]!==S||e[35]!==u?(R=(0,t.jsxs)(t.Fragment,{children:[u,S]}),e[34]=S,e[35]=u,e[36]=R):R=e[36],R},we=({id:i,user:e,timeAgo:s,content:r,contentClass:a,media:l,quotedPost:o,stats:d,onClick:c,repostedBy:v,onUserClick:p,currentUser:h,poll:f,isDetail:j,initialComments:u,onDelete:x,onUpdate:g,isComment:m,onReply:N,community:C,parent_id:b,post_id:k,commenterAvatars:n=[]})=>{const _=oe(),{addToast:S}=Ce(),{liked:R,reposted:$,localStats:z,setLocalStats:P,handleLike:I,handleRepost:M}=Ns(i,d,h),{deletePost:A,updatePost:O}=rs(),{comments:D,fetchNextPage:L,hasNextPage:U,isFetchingNextPage:H,addComment:y,deleteComment:F,updateComment:E,isSubmitting:V}=et(i,u),[Q,J]=(0,w.useState)(""),[ve,$e]=(0,w.useState)([]),[kt,Fe]=(0,w.useState)(!1),[Pe,ie]=(0,w.useState)(!1),[ce,Y]=(0,w.useState)(!1),[K,de]=(0,w.useState)(r),[me,xe]=(0,w.useState)(l||[]),[fe,le]=(0,w.useState)([]),[Te,Re]=(0,w.useState)(!1),[yt,be]=(0,w.useState)(!1),[je,he]=(0,w.useState)(null),[ze,Ie]=(0,w.useState)(!1),{comments:Nt,refetch:Me}=et(k||i,void 0,ze?i:void 0),{ref:Ee,inView:Ae}=Tt({threshold:.5,triggerOnce:!0});(0,w.useEffect)(()=>{if(Ae&&!m){const T=setTimeout(()=>{fs(i).catch(console.error)},1500);return()=>clearTimeout(T)}},[Ae,i,m]);const wt=(0,w.useCallback)(async()=>{!i||!k&&!i||z.comments===0||(Ie(!0),Me())},[i,k,z.comments,Me]),De=async()=>{const T=JSON.stringify(me)!==JSON.stringify(l||[])||fe.length>0;if(!K.trim()||K===r&&!T){Y(!1);return}Re(!0);try{const W=[];for(const Z of fe){const St=await Ne(Z);W.push(St)}const q=[...me,...W];m?await E({commentId:i,content:K,media:q}):await O(i,{content:K,media:q}),le([]),Y(!1),S(`${m?"Comment":"Post"} updated`),g&&g(i,K,q)}catch(W){console.error(`Failed to update ${m?"comment":"post"}:`,W),S(`Failed to update ${m?"comment":"post"}`)}finally{Re(!1)}},Le=async T=>{T&&T.stopPropagation();try{m?await F(i):await A(i),S(`${m?"Comment":"Post"} deleted successfully`),x&&x(i)}catch(W){console.error(`Failed to delete ${m?"comment":"post"}:`,W),S(`Failed to delete ${m?"comment":"post"}`)}finally{ie(!1)}},Ct=async T=>{if(T.preventDefault(),!(!Q.trim()&&ve.length===0||!h)){Fe(!0);try{const W=[];for(const q of ve){const Z=await Ne(q);W.push(Z)}await y({userId:h.id,content:Q,media:W,replyToId:je?.id}),J(""),$e([]),he(null),P(q=>({...q,comments:(q.comments||0)+1})),S("Reply posted!")}catch(W){console.error("Failed to post comment:",W),S("Failed to post reply.")}finally{Fe(!1)}}},Oe=h?.handle===e.handle,_t=(T,W)=>{he(W?{handle:T,id:m?b||i:W}:null),J(q=>{const Z=`@${T} `;return q.includes(Z)?q:Z+q}),document.getElementById("comment-input")?.focus()};return j?(0,t.jsxs)(ne.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"flex flex-col",ref:Ee,children:[(0,t.jsxs)("article",{className:"p-5 dark:bg-black",children:[(0,t.jsx)(it,{user:e,timeAgo:s,community:C,onUserClick:p,isDetail:!0,showAvatar:!0,actionsMenu:(0,t.jsx)(ct,{id:i,user:e,isCurrentUser:Oe,isComment:m,onEdit:()=>Y(!0),onDelete:()=>ie(!0),addToast:S,trigger:(0,t.jsx)("button",{"aria-label":"More options",className:"rounded-full p-2 text-zinc-500 transition-colors hover:bg-zinc-100 dark:hover:bg-zinc-800",children:(0,t.jsx)(ke,{size:20})})})}),(0,t.jsx)(lt,{content:r,isDetail:!0,isEditing:ce,editedContent:K,setEditedContent:de,onCancelEdit:()=>{Y(!1),de(r),xe(l||[]),le([])},onSaveEdit:De,isUpdating:Te,contentClass:a}),ue(r)&&(0,t.jsx)(ot,{url:ue(r)}),(0,t.jsx)(at,{media:l,isEditing:ce,editedMedia:me,setEditedMedia:xe,newFiles:fe,setNewFiles:le}),f&&(0,t.jsx)(nt,{poll:f,onVote:T=>ms(i,T,h.id)}),o&&(0,t.jsx)("div",{className:"mt-4 overflow-hidden rounded-2xl border border-zinc-200 shadow-sm dark:border-zinc-700",children:(0,t.jsx)(rt,{...o})}),(0,t.jsx)(st,{views:z.views||0,likes:z.likes||0,comments:z.comments||0,isDetail:!0}),(0,t.jsx)(tt,{liked:R,reposted:$,handleLike:I,handleRepost:M,handleCommentClick:()=>document.getElementById("comment-input")?.focus(),handleShareClick:()=>be(!0),isDetail:!0,isComment:m})]}),je&&(0,t.jsxs)("div",{className:"flex items-center justify-between bg-zinc-50 px-5 py-2 dark:bg-zinc-900/50",children:[(0,t.jsxs)("span",{className:"text-sm text-zinc-500",children:["Replying to"," ",(0,t.jsxs)("span",{className:"font-bold text-violet-600",children:["@",je.handle]})]}),(0,t.jsx)("button",{onClick:()=>he(null),className:"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200",children:(0,t.jsx)(re,{size:16})})]}),(0,t.jsx)(vt,{currentUser:h,newComment:Q,setNewComment:J,handleSubmitComment:Ct,loading:V,selectedFiles:ve,setSelectedFiles:$e,isUploading:kt}),(0,t.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:[(0,t.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:(0,t.jsxs)(t.Fragment,{children:[U&&D.length>0&&(0,t.jsxs)("button",{onClick:()=>L(),disabled:H,className:"flex w-full items-center justify-center gap-2 py-3 text-sm font-bold text-violet-600 transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[H&&(0,t.jsx)("span",{className:"animate-spin",children:"⌛"}),"View more replies"]}),D.map(T=>(0,t.jsx)(we,{...T,isComment:!0,post_id:i,onReply:_t,onUserClick:p,currentUser:h,stats:{likes:T.stats?.likes||0,comments:T.stats?.comments||0,reposts:T.stats?.reposts||0},timeAgo:T.timeAgo||T.created_at},T.id))]})}),(0,t.jsx)(Xe,{open:Pe,onOpenChange:ie,children:(0,t.jsxs)(Ge,{onClick:T=>T.stopPropagation(),children:[(0,t.jsxs)(Ke,{children:[(0,t.jsx)(Qe,{children:"Are you absolutely sure?"}),(0,t.jsx)(Ye,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,t.jsxs)(Ve,{children:[(0,t.jsx)(Be,{onClick:T=>T.stopPropagation(),children:"Cancel"}),(0,t.jsx)(qe,{onClick:Le,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]})]}):(0,t.jsxs)(ne.article,{initial:{opacity:0,y:10},whileInView:{opacity:1,y:0},viewport:{once:!0,margin:"-50px"},transition:{duration:.4,ease:"easeOut"},ref:Ee,onClick:c,className:`px-4 transition-all ${m?"py-2 bg-transparent hover:bg-zinc-50/30 dark:hover:bg-zinc-800/20":"py-4 bg-white hover:bg-zinc-50/30 dark:bg-black dark:hover:bg-white/[0.02]"} ${c?"cursor-pointer":""}`,children:[v&&(0,t.jsxs)("div",{className:"mb-2 ml-1 flex items-center space-x-1.5 text-[13px] font-semibold text-zinc-600",children:[(0,t.jsx)(ye,{size:14,className:"text-zinc-500"}),(0,t.jsxs)("span",{className:"flex cursor-pointer items-center text-zinc-700 hover:underline dark:text-zinc-300",onClick:T=>{T.stopPropagation(),p&&p(v.handle)},children:[v.handle," Reposted"]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-x-3",children:[(0,t.jsxs)("div",{className:"flex shrink-0 flex-col items-center self-stretch pt-0.5",children:[(0,t.jsx)("div",{className:"cursor-pointer",onClick:T=>{T.stopPropagation(),p&&p(e.handle)},children:(0,t.jsxs)(te,{className:`${m?"size-8":"size-10"} border-0 shadow-sm`,children:[(0,t.jsx)(se,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,t.jsx)(ee,{className:"text-xs",children:e.handle[0]?.toUpperCase()})]})}),(!m&&z.comments>0||m&&!b&&z.comments>0)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"mt-2 w-0.5 flex-1 rounded-full bg-zinc-100 dark:bg-zinc-800"}),!m&&(0,t.jsx)(xi,{avatars:n.length>0?n:(D||[]).slice(0,3).map(T=>T.user.avatar)})]})]}),(0,t.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col",children:[(0,t.jsx)(it,{user:e,timeAgo:s,community:C,onUserClick:p,isComment:m,actionsMenu:(0,t.jsx)(ct,{id:i,user:e,isCurrentUser:Oe,isComment:m,onEdit:()=>Y(!0),onDelete:()=>ie(!0),addToast:S,trigger:(0,t.jsx)("button",{"aria-label":"More options",className:"rounded-full p-2 text-zinc-500 transition-colors hover:bg-zinc-100 group-hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:group-hover:bg-zinc-800/50",children:(0,t.jsx)(ke,{size:18})})})}),(0,t.jsx)(lt,{content:r,isEditing:ce,editedContent:K,setEditedContent:de,onCancelEdit:()=>{Y(!1),de(r),xe(l||[]),le([])},onSaveEdit:De,isUpdating:Te,contentClass:a}),ue(r)&&(0,t.jsx)(ot,{url:ue(r)}),(0,t.jsx)(at,{media:l,isEditing:ce,editedMedia:me,setEditedMedia:xe,newFiles:fe,setNewFiles:le}),f&&(0,t.jsx)(nt,{poll:f}),o&&(0,t.jsx)("div",{className:"mt-3 overflow-hidden rounded-2xl border border-zinc-200 shadow-sm transition-all hover:bg-zinc-50 dark:border-zinc-800 dark:hover:bg-zinc-900",onClick:T=>{T.stopPropagation(),_(`/p/${o.id}`)},children:(0,t.jsx)(rt,{...o})}),(0,t.jsx)(tt,{liked:R,reposted:$,handleLike:I,handleRepost:M,handleCommentClick:T=>{if(T?.stopPropagation(),N){const W=m&&b||i;N(e.handle,W)}else c&&c()},handleShareClick:T=>{T?.stopPropagation(),be(!0)},isComment:m}),(0,t.jsx)(st,{views:z.views||0,likes:z.likes||0,comments:z.comments||0,isComment:m,onRepliesClick:()=>{ze?Ie(!1):wt()}}),ze&&(0,t.jsxs)("div",{className:"relative mt-2 space-y-0",children:[(0,t.jsx)("div",{className:"absolute left-[19px] top-0 bottom-4 w-0.5 bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsx)("div",{className:"flex flex-col",children:Nt.map(T=>(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute left-[19px] top-5 h-0.5 w-4 bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsx)("div",{className:"pl-6",children:(0,t.jsx)(we,{...T,isComment:!0,post_id:k||i,onReply:N,onUserClick:p,currentUser:h,stats:{likes:T.stats?.likes||0,comments:T.stats?.comments||0,reposts:T.stats?.reposts||0},timeAgo:T.timeAgo||T.created_at})})]},T.id))})]}),(0,t.jsx)(zt,{isOpen:yt,onClose:()=>be(!1),url:`${window.location.origin}/p/${i}`,title:"Share Post"}),(0,t.jsx)(Xe,{open:Pe,onOpenChange:ie,children:(0,t.jsxs)(Ge,{onClick:T=>T.stopPropagation(),children:[(0,t.jsxs)(Ke,{children:[(0,t.jsx)(Qe,{children:"Are you absolutely sure?"}),(0,t.jsx)(Ye,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,t.jsxs)(Ve,{children:[(0,t.jsx)(Be,{onClick:T=>T.stopPropagation(),children:"Cancel"}),(0,t.jsx)(qe,{onClick:Le,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]})]})]})};function fi(i,e){const s=!i.media&&!e.media||i.media?.length===e.media?.length&&i.media?.every((a,l)=>a.url===e.media?.[l].url),r=i.repostedBy?.handle===e.repostedBy?.handle;return i.id===e.id&&i.content===e.content&&i.timeAgo===e.timeAgo&&i.user.id===e.user.id&&i.user.avatar===e.user.avatar&&i.stats.likes===e.stats.likes&&i.stats.comments===e.stats.comments&&i.stats.reposts===e.stats.reposts&&i.currentUser?.id===e.currentUser?.id&&!!s&&!!r}var hi=w.memo(we,fi),ui=({isOpen:i,onClose:e,url:s,title:r="Share"})=>{const[a,l]=(0,w.useState)(!1),[o,d]=(0,w.useState)(""),[c,v]=(0,w.useState)([]),[p,h]=(0,w.useState)(!1),[f,j]=(0,w.useState)(null),{addToast:u}=Ce(),{currentUser:x}=ut(),g=(0,w.useCallback)(async()=>{if(x){h(!0);try{v((await Je(x.id)).map(n=>n.user).filter(n=>n!==null).slice(0,5))}catch(n){console.error("Failed to fetch conversations:",n)}finally{h(!1)}}},[x]);(0,w.useEffect)(()=>{i&&x?g():(d(""),v([]))},[i,x,g]);const m=(0,w.useCallback)(async()=>{if(x){h(!0);try{v((await Je(x.id)).map(n=>n.user).filter(n=>n!==null&&(n.name?.toLowerCase().includes(o.toLowerCase())||n.handle.toLowerCase().includes(o.toLowerCase()))))}catch(n){console.error("Search failed:",n)}finally{h(!1)}}},[o,x]);(0,w.useEffect)(()=>{const n=setTimeout(()=>{o.trim()&&i?m():!o.trim()&&i&&g()},300);return()=>clearTimeout(n)},[o,i,m,g]);const N=async n=>{n&&n.stopPropagation();try{await navigator.clipboard.writeText(s),l(!0),u("Link copied to clipboard!","success"),setTimeout(()=>l(!1),2e3)}catch(_){console.error("Failed to copy:",_),u("Failed to copy link","error")}},C=async n=>{if(x){j(n.id);try{await ps(await ds(x.id,n.id),x.id,s,"text"),u(`Sent to ${n.name||n.handle}!`,"success")}catch(_){console.error("Failed to send message:",_),u("Failed to send message","error")}finally{j(null)}}},b=[{name:"X",icon:Ut,color:"bg-black text-white",href:`https://twitter.com/intent/tweet?url=${encodeURIComponent(s)}`},{name:"Facebook",icon:ts,color:"bg-[#1877F2] text-white",href:`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(s)}`},{name:"LinkedIn",icon:Zt,color:"bg-[#0A66C2] text-white",href:`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(s)}`},{name:"WhatsApp",icon:Kt,color:"bg-[#25D366] text-white",href:`https://wa.me/?text=${encodeURIComponent(s)}`},{name:"Email",icon:es,color:"bg-zinc-600 text-white",href:`mailto:?body=${encodeURIComponent(s)}`}],k=async()=>{if(navigator.share)try{await navigator.share({title:r,url:s})}catch(n){n.name!=="AbortError"&&console.error("Native share failed:",n)}else N()};return(0,t.jsx)(gt,{isOpen:i,onClose:e,title:r,className:"max-w-[420px] !p-0 overflow-hidden",children:(0,t.jsxs)("div",{className:"flex h-full flex-col bg-white dark:bg-zinc-900",children:[(0,t.jsx)("div",{className:"px-5 pb-2 pt-4",children:(0,t.jsxs)("div",{className:"group relative",children:[(0,t.jsx)(Mt,{className:"absolute left-3 top-1/2 size-4 -translate-y-1/2 text-zinc-400 transition-colors group-focus-within:text-violet-500"}),(0,t.jsx)("input",{type:"text",placeholder:"Search people...",value:o,onChange:n=>d(n.target.value),className:"w-full rounded-xl border-none bg-zinc-100 py-2.5 pl-10 pr-4 text-sm transition-all focus:ring-2 focus:ring-violet-500/20 outline-none dark:bg-zinc-800/50"})]})}),(0,t.jsx)("div",{className:"no-scrollbar flex min-h-[100px] items-center gap-4 overflow-x-auto px-5 py-4",children:p?(0,t.jsx)("div",{className:"flex flex-1 justify-center",children:(0,t.jsx)("span",{className:"animate-pulse font-bold text-zinc-400",children:"Loading..."})}):c.length>0?c.map(n=>(0,t.jsxs)("button",{onClick:()=>C(n),disabled:f!==null,className:"group flex shrink-0 flex-col items-center gap-1.5 disabled:opacity-50",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"size-14 overflow-hidden rounded-full border-2 border-white shadow-sm transition-transform group-hover:scale-105 bg-zinc-100 dark:bg-zinc-800 dark:border-zinc-900",children:(0,t.jsx)("img",{src:n.avatar||`https://i.pravatar.cc/150?u=${n.id}`,alt:n.handle,className:"size-full object-cover"})}),f===n.id&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center rounded-full bg-black/40",children:(0,t.jsx)("span",{className:"animate-pulse text-white font-bold",children:"..."})})]}),(0,t.jsx)("span",{className:"max-w-[60px] truncate text-[10px] font-medium text-zinc-500 dark:text-zinc-400",children:n.name?.split(" ")[0]||n.handle})]},n.id)):(0,t.jsx)("div",{className:"flex-1 py-2 text-center",children:(0,t.jsx)("span",{className:"text-xs text-zinc-400",children:"No people found"})})}),(0,t.jsx)("div",{className:"mx-5 h-px bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsxs)("div",{className:"grid grid-cols-5 gap-2 px-5 py-6",children:[b.map(n=>(0,t.jsxs)("a",{href:n.href,target:"_blank",rel:"noopener noreferrer",className:"group flex flex-col items-center gap-2",children:[(0,t.jsx)("div",{className:`size-12 ${n.color} flex items-center justify-center rounded-2xl shadow-md transition-all group-hover:-translate-y-1 group-hover:scale-110 group-hover:shadow-lg`,children:(0,t.jsx)(n.icon,{size:20,strokeWidth:2.5})}),(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-tighter text-zinc-500 dark:text-zinc-400",children:n.name})]},n.name)),(0,t.jsxs)("button",{onClick:k,className:"group flex flex-col items-center gap-2",children:[(0,t.jsx)("div",{className:"flex size-12 items-center justify-center rounded-2xl border border-zinc-200 bg-zinc-100 text-zinc-600 shadow-sm transition-all group-hover:-translate-y-1 group-hover:scale-110 dark:border-zinc-700 dark:bg-zinc-800 dark:text-zinc-300",children:(0,t.jsx)(ke,{size:20,strokeWidth:2.5})}),(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-tighter text-zinc-500 dark:text-zinc-400",children:"More"})]})]}),(0,t.jsx)("div",{className:"px-5 pb-6",children:(0,t.jsxs)("div",{className:"group relative",children:[(0,t.jsx)("input",{type:"text",readOnly:!0,value:s,className:"w-full rounded-2xl border border-zinc-200 bg-zinc-50 py-3.5 pl-4 pr-14 text-sm font-medium transition-colors focus:outline-none group-hover:border-zinc-300 dark:border-zinc-800 dark:bg-zinc-950 dark:group-hover:border-zinc-700"}),(0,t.jsx)("button",{onClick:N,className:`absolute right-1.5 top-1/2 flex -translate-y-1/2 items-center gap-2 rounded-xl h-10 px-4 text-xs font-bold shadow-sm transition-all active:scale-95 ${a?"bg-emerald-500 text-white":"bg-zinc-900 text-white hover:opacity-90 dark:bg-white dark:text-zinc-900"}`,children:a?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Xt,{size:14,strokeWidth:3}),(0,t.jsx)("span",{children:"Copied"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Dt,{size:14,strokeWidth:3}),(0,t.jsx)("span",{children:"Copy"})]})})]})}),(0,t.jsx)("div",{className:"px-5 pb-5",children:(0,t.jsxs)("button",{onClick:e,className:"group relative flex w-full items-center justify-center overflow-hidden rounded-2xl bg-zinc-900 py-4 font-bold text-white transition-all hover:shadow-xl hover:shadow-zinc-900/10 active:scale-[0.98] dark:bg-white dark:text-zinc-900 dark:hover:shadow-white/10",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-zinc-500 to-zinc-600 opacity-0 transition-opacity duration-300 group-hover:opacity-100"}),(0,t.jsx)("div",{className:"relative flex items-center gap-2",children:(0,t.jsx)("span",{children:"Close"})})]})})]})})},zt=ui,pi=w.lazy(()=>mt(()=>import("./dist-DzEd4B1b.js"),__vite__mapDeps([13,1,2,3,4,5,6,7])).then(i=>({default:i.Plyr}))),gi=w.memo(({reel:i,isActive:e,isMuted:s,shouldLoad:r=!0})=>{const a=oe(),{currentUser:l}=ut(),{addToast:o}=Ce(),{openReport:d}=ht(),c=(0,w.useRef)(null),[v,p]=(0,w.useState)(!1),[h,f]=(0,w.useState)(!1),[j,u]=(0,w.useState)(!1),[x,g]=(0,w.useState)(!1),[m,N]=(0,w.useState)(null),[C,b]=(0,w.useState)(!1),[k,n]=(0,w.useState)(i.stats?.likes||0),[_,S]=(0,w.useState)(!1),[R,$]=(0,w.useState)(0),z=(0,w.useRef)(null),P=(0,w.useMemo)(()=>Array.isArray(i.media)?i.media[0]?.src||i.media[0]?.url:i.media?.src||i.media?.url||i.url,[i.media,i.url]);(0,w.useEffect)(()=>{g(!1);const y=c.current?.plyr;if(y&&typeof y.on=="function"){const F=()=>g(!0);return y.on("ready",F),y.on("canplay",F),y.on("loadeddata",F),()=>{typeof y.off=="function"&&(y.off("ready",F),y.off("canplay",F),y.off("loadeddata",F))}}else{const F=setTimeout(()=>g(!0),1e3);return()=>clearTimeout(F)}},[P]),(0,w.useEffect)(()=>{let y;const F=c.current?.plyr;return F&&x&&(e?y=setTimeout(()=>{if(typeof F.play=="function"){const E=F.play();E!==void 0&&E.catch(()=>{F&&(F.muted=!0,F.play().catch(()=>{}))})}},100):typeof F.pause=="function"&&F.pause()),()=>{y&&clearTimeout(y)}},[e,x]),(0,w.useEffect)(()=>{if(!l?.id||!e)return;(async()=>{try{const[F,E]=await Promise.all([bs(i.id,l.id),is(l.id,i.user?.id)]);b(F),S(E)}catch(F){console.error("Failed to check interaction status:",F)}})()},[i.id,l?.id,e,i.user?.id]),(0,w.useEffect)(()=>{c.current?.plyr&&(c.current.plyr.muted=s)},[s]),(0,w.useEffect)(()=>{const y=c.current?.plyr;if(!y||!e)return;const F=()=>{const E=y.currentTime,V=y.duration;V>0&&$(E/V*100)};if(typeof y.on=="function")return y.on("timeupdate",F),()=>{typeof y.off=="function"&&y.off("timeupdate",F)}},[e]);const I=y=>{y.stopPropagation();const F=y.currentTarget.getBoundingClientRect(),E=y.clientX-F.left,V=Math.min(Math.max(0,E/F.width),1),Q=c.current?.plyr;Q&&Q.duration&&(Q.currentTime=V*Q.duration,$(V*100))};(0,w.useEffect)(()=>()=>{z.current&&clearTimeout(z.current)},[]);const M=y=>{const F=y.target;F.closest("button")||F.closest("a")||F.closest(".plyr__controls")||(z.current?(clearTimeout(z.current),z.current=null,O()):z.current=setTimeout(()=>{z.current=null,A()},250))},A=()=>{const y=c.current?.plyr;y&&(y.paused?(y.play().catch(()=>{}),N("play")):(y.pause(),N("pause")),setTimeout(()=>N(null),800))},O=async()=>{if(l&&(p(!0),setTimeout(()=>p(!1),1e3),!C)){b(!0),n(y=>y+1);try{await Ze(i.id,l.id)}catch{b(!1),n(y=>y-1)}}},D=async y=>{if(y.stopPropagation(),!l)return;const F=!C;b(F),n(E=>F?E+1:E-1);try{await Ze(i.id,l.id)}catch{b(!F),n(E=>F?E-1:E+1)}},L=async y=>{if(y.stopPropagation(),!l)return;const F=!_;S(F);try{await ss(l.id,i.user?.id)}catch{S(!F)}},U=y=>{y.stopPropagation(),u(!0)},H=(0,w.useMemo)(()=>({source:{type:"video",sources:[{src:P,type:"video/mp4"}]},options:{controls:[],loop:{active:!0},clickToPlay:!1,ratio:"9:16",autoplay:!0,muted:!0,playsinline:!0}}),[P]);return(0,t.jsxs)("div",{"data-id":i.id,className:"reel-item relative flex h-[100dvh] w-full snap-start items-center justify-center overflow-hidden bg-black cursor-pointer",onClick:M,children:[(0,t.jsxs)("div",{className:"relative flex h-full w-full max-w-[450px] items-center justify-center",children:[(0,t.jsx)("div",{className:"w-full",children:r?(0,t.jsx)(w.Suspense,{fallback:(0,t.jsx)("div",{className:"aspect-[9/16] w-full bg-zinc-900 animate-pulse"}),children:(0,t.jsx)(pi,{ref:c,...H})}):(0,t.jsx)("div",{className:"aspect-[9/16] w-full bg-zinc-900",children:(0,t.jsx)("img",{src:i.media?.[0]?.preview||i.media?.[0]?.thumbnail||P,className:"h-full w-full object-cover opacity-50 blur-xl",alt:"Reel preview"})})}),!x&&(0,t.jsx)("div",{className:"absolute inset-0 z-[60] flex items-center justify-center bg-zinc-900",children:(0,t.jsx)(as,{})}),v&&(0,t.jsx)("div",{className:"pointer-events-none absolute inset-0 z-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-in zoom-in-50 fade-out fill-mode-forwards duration-500",children:(0,t.jsx)(pe,{size:120,fill:"white",className:"scale-125 text-white drop-shadow-[0_0_30px_rgba(255,255,255,0.4)]"})})}),m&&(0,t.jsx)("div",{className:"pointer-events-none absolute inset-0 z-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-in fade-in zoom-in-90 scale-100 animate-out zoom-out-110 fade-out fill-mode-forwards duration-500",children:(0,t.jsx)("div",{className:"rounded-full border border-white/20 bg-white/10 p-8 shadow-2xl backdrop-blur-md",children:m==="play"?(0,t.jsx)(qt,{size:50,fill:"white",className:"ml-1.5 text-white"}):(0,t.jsx)(Ht,{size:50,fill:"white",className:"text-white"})})})}),(0,t.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-black/60"}),(0,t.jsxs)("div",{className:"pointer-events-none absolute bottom-6 left-4 right-16 text-white",children:[(0,t.jsxs)("div",{className:"pointer-events-auto mb-3 flex items-center gap-2",children:[(0,t.jsxs)(Rt,{to:`/u/${i.user?.handle}`,className:"flex items-center gap-2 transition-opacity hover:opacity-80",onClick:y=>y.stopPropagation(),children:[(0,t.jsxs)(te,{className:"size-10 border-2 border-white",children:[(0,t.jsx)(se,{src:i.user?.avatar,alt:i.user?.handle,className:"object-cover"}),(0,t.jsx)(ee,{children:i.user?.handle?.[0]?.toUpperCase()})]}),(0,t.jsxs)("span",{className:"font-bold",children:["@",i.user?.handle]})]}),l?.id!==i.user?.id&&(0,t.jsx)("button",{className:`ml-2 flex items-center gap-1.5 rounded-full px-3 py-1.5 text-xs font-bold transition-all active:scale-95 ${_?"border border-white/50 bg-transparent text-white":"bg-white text-black hover:bg-zinc-200"}`,onClick:L,children:_?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ks,{size:14}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Following"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(hs,{size:14}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Follow"})]})})]}),(0,t.jsx)(_e,{options:{...Se,render:({attributes:y,content:F})=>{const{href:E,...V}=y,Q=!E.startsWith("/")&&(E.startsWith("http")||E.startsWith("www"));return E.startsWith("/u/")||E.startsWith("/tags/")||E.startsWith("/c/")||E.startsWith("/explore")?(0,t.jsx)("span",{...V,className:"cursor-pointer font-bold text-white hover:underline",onClick:J=>{J.stopPropagation(),a(E)},children:F},F):(0,t.jsx)("a",{href:E,...V,className:"text-white hover:underline",target:Q?"_blank":void 0,rel:Q?"noopener noreferrer":void 0,onClick:J=>J.stopPropagation(),children:F},F)}},children:(0,t.jsx)("p",{className:"mb-3 line-clamp-2 text-sm",children:i.content})}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs opacity-90",children:[(0,t.jsx)(Qt,{size:14,className:"animate-spin-slow"}),(0,t.jsxs)("span",{children:["Original Audio - ",i.user?.handle]})]})]}),(0,t.jsxs)("div",{className:"absolute bottom-6 right-2 z-10 flex flex-col items-center gap-6",children:[(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)("button",{className:`rounded-full p-3 backdrop-blur-md transition-all active:scale-90 ${C?"bg-rose-500/20 text-rose-500":"bg-zinc-800/50 text-white hover:bg-zinc-700"}`,onClick:D,children:(0,t.jsx)(pe,{size:28,fill:C?"currentColor":"none"})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:k})]}),(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)("button",{className:"rounded-full bg-zinc-800/50 p-3 text-white backdrop-blur-md transition-colors hover:bg-zinc-700 active:scale-90",onClick:y=>{y.stopPropagation(),f(!0)},children:(0,t.jsx)(pt,{size:28})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:i.stats?.comments||0})]}),(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)("button",{className:"rounded-full bg-zinc-800/50 p-3 text-white backdrop-blur-md transition-colors hover:bg-zinc-700 active:scale-90",onClick:U,children:(0,t.jsx)(ge,{size:28})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:i.stats?.shares||0})]}),(0,t.jsx)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:(0,t.jsx)("button",{className:"rounded-full bg-zinc-800/50 p-3 text-white backdrop-blur-md transition-colors hover:bg-rose-500/20 hover:text-rose-500 active:scale-90",onClick:y=>{y.stopPropagation(),d("reel",i.id)},children:(0,t.jsx)(xt,{size:28})})})]}),(0,t.jsx)("div",{className:"absolute bottom-0 left-0 z-50 h-[3px] w-full bg-white/20 hover:h-[8px] transition-all cursor-pointer group",onClick:I,children:(0,t.jsx)("div",{className:"h-full bg-white shadow-[0_0_8px_rgba(255,255,255,0.8)] transition-all duration-100 ease-linear relative",style:{width:`${R}%`},children:(0,t.jsx)("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 size-3 bg-white rounded-full shadow-lg scale-0 group-hover:scale-100 transition-transform"})})})]}),(0,t.jsx)(bi,{isOpen:h,onClose:()=>f(!1),reelId:i.id,currentUser:l,showToast:o}),(0,t.jsx)(zt,{isOpen:j,onClose:()=>u(!1),url:`${window.location.origin}/r/${i.id}`,title:"Share Reel"})]})},(i,e)=>i.isActive===e.isActive&&i.reel.id===e.reel.id&&i.isMuted===e.isMuted),Fi=gi,vi=({isOpen:i,onClose:e,reelId:s,currentUser:r,showToast:a})=>{const[l,o]=(0,w.useState)([]),[d,c]=(0,w.useState)(!1),[v,p]=(0,w.useState)(!1),[h,f]=(0,w.useState)(""),[j,u]=(0,w.useState)([]),[x,g]=(0,w.useState)(!1),[m,N]=(0,w.useState)(!0),[C,b]=(0,w.useState)(!1),[k,n]=(0,w.useState)(null),_=(0,w.useRef)(l);(0,w.useEffect)(()=>{_.current=l},[l]);const S=(0,w.useCallback)(async($=!1)=>{if(s){$?b(!0):c(!0);try{const z=_.current,P=await gs(s,$&&z.length>0?z[z.length-1].created_at:null,10);P.length<10?N(!1):N(!0),o($?I=>[...I,...P]:P)}catch(z){console.error("Failed to load comments:",z),a&&a("Failed to load comments","error")}finally{c(!1),b(!1)}}},[s,a]);(0,w.useEffect)(()=>{i&&s?S():(o([]),N(!0))},[i,s,S]);const R=async $=>{if($.preventDefault(),!(!h.trim()&&j.length===0||!r)){p(!0),g(!0);try{const z=[];for(const P of j){const I=await Ne(P);z.push(I)}await us(s,r.id,h,z,k?.id),f(""),u([]),n(null),a&&a("Reply posted!"),S()}catch(z){console.error("Failed to post comment:",z),a&&a("Failed to post reply.","error")}finally{p(!1),g(!1)}}};return(0,t.jsx)(gt,{isOpen:i,onClose:e,title:"Comments",className:"max-sm:h-[95dvh] h-[85vh] overflow-hidden !p-0 sm:max-w-xl",children:(0,t.jsxs)("div",{className:"flex h-full flex-col overflow-hidden bg-white dark:bg-zinc-900",children:[(0,t.jsx)("div",{className:"mx-auto my-3 h-1.5 w-12 shrink-0 rounded-full bg-zinc-200 dark:bg-zinc-800 sm:hidden"}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto scroll-smooth scrollbar-thin scrollbar-thumb-zinc-200 dark:scrollbar-thumb-zinc-800",children:d?(0,t.jsx)("div",{className:"flex flex-col",children:[1,2,3].map($=>(0,t.jsx)(os,{},$))}):l.length>0?(0,t.jsxs)("div",{className:"flex flex-col",children:[l.map($=>(0,t.jsx)(hi,{...$,isComment:!0,post_id:s,currentUser:r,showToast:a,onReply:(z,P)=>{n(P?{handle:z,id:P}:null),f(I=>I.includes(`@${z}`)?I:I+`@${z} `)},onDelete:z=>o(P=>P.filter(I=>I.id!==z)),onUpdate:(z,P,I)=>o(M=>M.map(A=>A.id===z?{...A,content:P,media:I}:A))},$.id)),m&&(0,t.jsxs)("button",{onClick:()=>S(!0),disabled:C,className:"flex w-full items-center justify-center gap-2 py-6 text-sm font-bold text-violet-600 transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[C&&(0,t.jsx)("span",{className:"mr-2 animate-pulse",children:"..."}),"View more replies"]})]}):(0,t.jsxs)("div",{className:"flex h-full min-h-[300px] flex-col items-center justify-center p-8 text-center text-zinc-500",children:[(0,t.jsx)("div",{className:"mb-4 flex size-16 items-center justify-center rounded-full bg-zinc-100 dark:bg-zinc-900",children:(0,t.jsx)(ft,{size:32,className:"text-zinc-400"})}),(0,t.jsx)("p",{className:"text-lg font-bold dark:text-zinc-300",children:"No comments yet"}),(0,t.jsx)("p",{className:"text-sm dark:text-zinc-500",children:"Be the first to share what you think!"})]})}),(0,t.jsxs)("div",{className:"shrink-0 border-t border-zinc-100 bg-white pb-safe dark:border-zinc-800 dark:bg-zinc-900",children:[k&&(0,t.jsxs)("div",{className:"flex items-center justify-between border-b border-zinc-50 bg-zinc-50/50 px-4 py-2 dark:border-zinc-800/50 dark:bg-zinc-900/50",children:[(0,t.jsxs)("span",{className:"text-xs text-zinc-500",children:["Replying to"," ",(0,t.jsxs)("span",{className:"font-bold text-violet-600",children:["@",k.handle]})]}),(0,t.jsx)("button",{onClick:()=>n(null),className:"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200",children:(0,t.jsx)(re,{size:14})})]}),(0,t.jsx)(vt,{currentUser:r,newComment:h,setNewComment:f,handleSubmitComment:R,loading:v,selectedFiles:j,setSelectedFiles:u,isUploading:x})]})]})})},bi=vi,Pi=B();export{hi as n,Fi as t};
