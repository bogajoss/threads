import{a as C}from"./rolldown-runtime-BaZ8gS7u.js";import{c as U,s as W}from"./animations-DZuN0xpW.js";import{_ as L}from"./framework-YRQI4BOE.js";import"./database-Bh-Nv8Zy.js";import{Ft as S,In as I,Vn as A,ar as E,lr as w,tn as B,xn as D}from"./ui-libs-dHBs5Tk6.js";import"./media-libs-CqtNZWFg.js";import{Qt as M,Xt as T,Zt as O,_t as p,a as q,en as k,in as G,kn as y,on as $}from"./index-Dq2Ooid_.js";import{t as Q}from"./CircularProgress-D3aWv6b6.js";var r=C(U(),1),e=C(W(),1),V=()=>{const d=L(),{currentUser:l,updateProfile:P}=$(),{addToast:m}=G(),[_,f]=(0,r.useState)(!1),[s,n]=(0,r.useState)(l||{}),[x,v]=(0,r.useState)(null),[o,g]=(0,r.useState)(null),b=(0,r.useRef)(null),j=(0,r.useRef)(null);(0,r.useEffect)(()=>{l&&n(l)},[l]);const N=(a,i)=>{const t=a.target.files?.[0];if(t){if(t.type==="image/gif"&&!l?.isPro){m("GIF profile pictures are only available for PRO users!","error");return}i==="avatar"?v(t):g(t)}},F=async()=>{f(!0);try{let a=s.avatar,i=s.cover;x&&(a=(await y(x)).url),o&&(i=(await y(o)).url);const u=(h=>{if(!h)return h;const c=h.trim();if(!c)return c;try{return new URL(/^https?:\/\//i.test(c)?c:`https://${c}`).hostname.replace(/^www\./i,"")}catch{return c.replace(/^https?:\/\//i,"").replace(/^www\./i,"").replace(/\/.*$/,"")}})(s?.website);await P({...s,avatar:a,cover:i,website:u}),v(null),g(null),m("Profile updated!"),d(-1)}catch(a){console.error("Failed to update profile:",a),m("Failed to update profile.","error")}finally{f(!1)}},z=(a=>(a||"").trim().split(/\s+/).filter(Boolean).length)(s?.bio),R=z>=50;return l?(0,e.jsx)(q,{children:(0,e.jsxs)("div",{className:"flex min-h-screen flex-col border-zinc-100 bg-white dark:border-zinc-800 dark:bg-black md:rounded-xl md:border",children:[(0,e.jsx)("div",{className:"sticky top-0 z-10 border-b border-zinc-100 bg-white/80 p-4 backdrop-blur-md dark:border-zinc-800 dark:bg-black/80",children:(0,e.jsxs)("div",{className:"flex items-center gap-4",children:[(0,e.jsx)("button",{onClick:()=>d(-1),className:"rounded-full p-2 transition-colors hover:bg-zinc-100 dark:hover:bg-zinc-800",children:(0,e.jsx)(E,{size:24})}),(0,e.jsx)("h2",{className:"text-xl font-bold dark:text-white",children:"Edit Profile"})]})}),(0,e.jsxs)("div",{className:"mx-auto mt-4 w-full max-w-2xl space-y-8 p-4 pb-24",children:[(0,e.jsx)("input",{type:"file",ref:j,className:"hidden",accept:"image/*",onChange:a=>N(a,"cover")}),(0,e.jsx)("input",{type:"file",ref:b,className:"hidden",accept:"image/*",onChange:a=>N(a,"avatar")}),(0,e.jsxs)("section",{className:"space-y-4",children:[(0,e.jsx)("h3",{className:"px-2 text-sm font-bold uppercase tracking-wider text-zinc-500",children:"Media"}),(0,e.jsxs)("div",{className:"overflow-hidden rounded-2xl bg-zinc-50 dark:bg-zinc-900",children:[(0,e.jsxs)("div",{className:"group relative h-40 cursor-pointer overflow-hidden bg-zinc-100 dark:bg-zinc-800",onClick:()=>j.current?.click(),children:[(o||s?.cover)&&(0,e.jsx)("img",{src:o?URL.createObjectURL(o):s.cover,className:"h-full w-full object-cover opacity-80 transition-opacity group-hover:opacity-60",alt:""}),(0,e.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/20 opacity-0 transition-opacity group-hover:opacity-100",children:(0,e.jsxs)("div",{className:"flex flex-col items-center gap-1 text-white",children:[(0,e.jsx)(w,{size:24}),(0,e.jsx)("span",{className:"text-xs font-bold uppercase",children:"Change Cover"})]})})]}),(0,e.jsxs)("div",{className:"flex items-center gap-6 p-4",children:[(0,e.jsxs)("div",{className:"group relative size-24 cursor-pointer overflow-hidden rounded-full ring-4 ring-white shadow-lg dark:ring-zinc-800",onClick:()=>b.current?.click(),children:[(0,e.jsxs)(T,{className:"size-full rounded-none",children:[(0,e.jsx)(M,{src:x?URL.createObjectURL(x):s.avatar,className:"object-cover transition-opacity group-hover:opacity-60"}),(0,e.jsx)(O,{children:s?.handle?.[0]?.toUpperCase()})]}),(0,e.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/20 opacity-0 transition-opacity group-hover:opacity-100",children:(0,e.jsx)(w,{size:20,className:"text-white"})})]}),(0,e.jsxs)("div",{className:"flex-1",children:[(0,e.jsx)("p",{className:"text-sm font-bold dark:text-zinc-200",children:"Profile Picture"}),(0,e.jsx)("p",{className:"text-xs text-zinc-500",children:"Recommended size: 400x400px"})]})]})]})]}),(0,e.jsxs)("section",{className:"space-y-4",children:[(0,e.jsx)("h3",{className:"px-2 text-sm font-bold uppercase tracking-wider text-zinc-500",children:"Basic Info"}),(0,e.jsxs)("div",{className:"divide-y divide-zinc-200 overflow-hidden rounded-2xl bg-zinc-50 dark:divide-zinc-800 dark:bg-zinc-900",children:[(0,e.jsxs)("div",{className:"flex flex-col gap-2 p-4",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2 text-zinc-500",children:[(0,e.jsx)(S,{size:16}),(0,e.jsx)("label",{className:"text-xs font-bold uppercase tracking-tight",children:"Display Name"})]}),(0,e.jsx)(p,{value:s?.name||"",className:"h-auto bg-transparent p-0 text-base font-medium placeholder:text-zinc-400 focus-visible:ring-0 dark:text-zinc-100 shadow-none",onChange:a=>n({...s,name:a.target.value})})]}),(0,e.jsxs)("div",{className:"flex flex-col gap-2 p-4",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2 text-zinc-500",children:[(0,e.jsx)(A,{size:16}),(0,e.jsx)("label",{className:"text-xs font-bold uppercase tracking-tight",children:"Bio"})]}),(0,e.jsx)(Q,{current:z,max:60,size:20,strokeWidth:3,isWarning:R})]}),(0,e.jsx)(p,{textarea:!0,value:s?.bio||"",className:"min-h-[80px] bg-transparent p-0 text-base font-medium resize-none placeholder:text-zinc-400 focus-visible:ring-0 dark:text-zinc-100 shadow-none",onChange:a=>{const i=a.target.value,t=i.trim().split(/\s+/).filter(Boolean);if(t.length>60){const u=t.slice(0,60).join(" ");n({...s,bio:u})}else n({...s,bio:i})}})]})]})]}),(0,e.jsxs)("section",{className:"space-y-4",children:[(0,e.jsx)("h3",{className:"px-2 text-sm font-bold uppercase tracking-wider text-zinc-500",children:"Public Details"}),(0,e.jsxs)("div",{className:"divide-y divide-zinc-200 overflow-hidden rounded-2xl bg-zinc-50 dark:divide-zinc-800 dark:bg-zinc-900",children:[(0,e.jsxs)("div",{className:"flex flex-col gap-2 p-4",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2 text-zinc-500",children:[(0,e.jsx)(D,{size:16}),(0,e.jsx)("label",{className:"text-xs font-bold uppercase tracking-tight",children:"Location"})]}),(0,e.jsx)(p,{placeholder:"Where are you based?",value:s?.location||"",className:"h-auto bg-transparent p-0 text-base font-medium placeholder:text-zinc-400 focus-visible:ring-0 dark:text-zinc-100 shadow-none",onChange:a=>n({...s,location:a.target.value})})]}),(0,e.jsxs)("div",{className:"flex flex-col gap-2 p-4",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2 text-zinc-500",children:[(0,e.jsx)(I,{size:16}),(0,e.jsx)("label",{className:"text-xs font-bold uppercase tracking-tight",children:"Website"})]}),(0,e.jsx)(p,{placeholder:"yoursite.com",value:s?.website||"",className:"h-auto bg-transparent p-0 text-base font-medium placeholder:text-zinc-400 focus-visible:ring-0 dark:text-zinc-100 shadow-none",onChange:a=>n({...s,website:a.target.value})})]})]})]}),(0,e.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,e.jsx)(k,{variant:"secondary",className:"flex-1 rounded-2xl p-4 font-bold",onClick:()=>d(-1),children:"Cancel"}),(0,e.jsxs)(k,{className:"flex-1 rounded-2xl p-4 font-bold bg-violet-600 hover:bg-violet-700 text-white",onClick:F,loading:_,children:[(0,e.jsx)(B,{size:18,className:"mr-2"}),"Save Changes"]})]}),(0,e.jsx)("div",{className:"py-10 text-center text-xs text-zinc-400",children:"Your profile changes will be visible to everyone on MySys."})]})]})}):(d("/login"),null)},te=V;export{te as default};
