import{a as b}from"./rolldown-runtime-BaZ8gS7u.js";import{c as P,s as E}from"./animations-DZuN0xpW.js";import{_ as j,c as D}from"./framework-YRQI4BOE.js";import{An as v}from"./index-fIvlXT17.js";import{i as C,n as R,r as H,t as S}from"./text-processing-COMFTedg.js";var w=H("hashtag",{isLink:!0});function I({scanner:n,parser:t}){const{POUND:i,UNDERSCORE:p,FULLWIDTHMIDDLEDOT:l,ASCIINUMERICAL:m,ALPHANUMERICAL:h}=n.tokens,{alpha:c,numeric:u,alphanumeric:e,emoji:s}=n.tokens.groups,a=t.start.tt(i),o=a.tt(p),r=new R(w);a.tt(m,r),a.tt(h,r),a.ta(u,o),a.ta(c,r),a.ta(s,r),a.ta(l,r),o.tt(m,r),o.tt(h,r),o.ta(c,r),o.ta(s,r),o.ta(l,r),o.ta(u,o),o.tt(p,o),r.ta(e,r),r.ta(s,r),r.tt(l,r),r.tt(p,r)}C("hashtag",I);var M=H("mention",{isLink:!0,toHref(){return"/"+this.toString().slice(1)}});function T({scanner:n,parser:t}){const{HYPHEN:i,SLASH:p,UNDERSCORE:l,AT:m}=n.tokens,{domain:h}=n.tokens.groups,c=t.start.tt(m),u=c.tt(i);u.tt(i,u);const e=c.tt(l,M);c.ta(h,e),u.tt(l,e),u.ta(h,e),e.ta(h,e),e.tt(i,e),e.tt(l,e);const s=e.tt(p);s.ta(h,e),s.tt(l,e),s.tt(i,e)}C("mention",T);const U={formatHref:(n,t)=>t==="mention"?`/u/${n.substring(1)}`:t==="hashtag"?`/tags/${n.substring(1)}`:n,attributes:{onClick:n=>n.stopPropagation(),className:"cursor-pointer font-bold text-rose-600 hover:underline dark:text-rose-400"},validate:{hashtag:n=>/^#[\u0980-\u09FF\w]+$/.test(n)},target:(n,t)=>t==="url"?"_blank":void 0,rel:(n,t)=>t==="url"?"noopener noreferrer":void 0};var $=D(),G=b(P(),1),k=b(E(),1),F=n=>{const t=(0,$.c)(13),{content:i,className:p,onClick:l}=n,m=j(),h=O;let c;t[0]!==i?(c=typeof i=="string"?h(i):i,t[0]=i,t[1]=c):c=t[1];const u=c;let e;t[2]!==p?(e=v("whitespace-pre-line break-words",p),t[2]=p,t[3]=e):e=t[3];let s;t[4]!==m?(s={...U,render:r=>{const{attributes:A,content:d}=r,{href:f,...g}=A,N=window.location.origin;if(f.includes("internal.tag/")){const x=decodeURIComponent(f.split("internal.tag/")[1]);return(0,k.jsxs)("span",{...g,className:v("cursor-pointer font-bold text-blue-600 hover:underline dark:text-blue-400",g.className),onClick:L=>{L.stopPropagation(),m(`/tags/${x}`)},children:["#",x]},d)}let _=null;return f.startsWith("/")?_=f:f.startsWith(N)&&(_=f.replace(N,"")),_?(0,k.jsx)("span",{...g,className:v("cursor-pointer font-medium text-blue-600 hover:underline dark:text-blue-400",g.className),onClick:x=>{x.stopPropagation(),m(_)},children:d},d):(0,k.jsx)("a",{href:f,...g,target:"_blank",rel:"noopener noreferrer",className:v("text-blue-600 hover:underline dark:text-blue-400",g.className),onClick:q,children:d},d)}},t[4]=m,t[5]=s):s=t[5];let a;t[6]!==u||t[7]!==s?(a=(0,k.jsx)(S,{options:s,children:u}),t[6]=u,t[7]=s,t[8]=a):a=t[8];let o;return t[9]!==l||t[10]!==e||t[11]!==a?(o=(0,k.jsx)("div",{className:e,onClick:l,children:a}),t[9]=l,t[10]=e,t[11]=a,t[12]=o):o=t[12],o},J=F;function O(n){return n.replace(/#([\u0980-\u09FF\w]+)/g,"https://internal.tag/$1")}function q(n){return n.stopPropagation()}export{J as t};
