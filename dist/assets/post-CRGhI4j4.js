import{a as vt}from"./rolldown-runtime-BaZ8gS7u.js";import{E as Wt,b as $e,c as H,d as Ut,n as Bt,p as Vt}from"./framework-CsA6nn9m.js";import{r as qt}from"./query-QyXblnmD.js";import{$t as Ht,An as Jt,Bn as Gt,Dn as fe,Fn as Kt,Ft as le,In as ye,Kn as Qt,Kt as Xt,Ln as Yt,Nn as Zt,Pn as es,Rn as ts,Sn as ss,Tn as as,Ut as is,Wt as ns,_n as jt,an as ls,cn as rs,fn as os,hn as cs,in as ke,jn as tt,kn as st,ln as ds,on as ms,t as zt,tn as xs,un as us,vn as hs,xn as Z}from"./ui-libs-BTPHttU6.js";import{At as ps,B as Nt,Bt as fs,Ft as we,G as at,Gt as gs,Ht as it,J as bs,K as ne,Mt as vs,Ot as nt,Pt as js,Qt as pe,U as zs,W as Ns,Wt as ks,Xt as Ce,Yt as ys,Zt as q,at as lt,c as rt,ct as ot,d as ws,dt as Cs,en as Ss,et as Q,ft as Fs,g as ct,gt as $s,h as Se,ht as kt,it as dt,jt as yt,kt as _s,lt as mt,mt as Ps,nt as X,ot as xt,pt as Rs,q as Is,rt as ut,s as wt,st as ht,tt as Y,u as Ms,ut as pt,v as As,vt as Ct,yt as Ts}from"./index-ChrI94EA.js";import{n as _e,t as Pe}from"./linkify-CDs92yJ8.js";import{d as Es}from"./hooks-CtTsWAW1.js";var Ls=H(),n=vt(Wt(),1),t=vt(Ut(),1),Ds=s=>{const e=(0,Ls.c)(35),{icon:a,count:d,label:o,onClick:x,active:l,activeColorClass:h,size:g,type:w}=s,v=g===void 0?18:g,b=w===void 0?"default":w;let r,p,u,f,k;if(e[0]!==l||e[1]!==h||e[2]!==d||e[3]!==o||e[4]!==x||e[5]!==b){const L={like:{hoverBg:"group-hover:bg-rose-500/10",hoverText:"group-hover:text-rose-500",activeText:"text-rose-500",activeFill:"fill-rose-500"},repost:{hoverBg:"group-hover:bg-emerald-500/10",hoverText:"group-hover:text-emerald-500",activeText:"text-emerald-500",activeFill:"fill-emerald-500"},comment:{hoverBg:"group-hover:bg-sky-500/10",hoverText:"group-hover:text-sky-500",activeText:"text-sky-500",activeFill:"fill-sky-500"},share:{hoverBg:"group-hover:bg-violet-500/10",hoverText:"group-hover:text-violet-500",activeText:"text-violet-500",activeFill:"fill-violet-500"},default:{hoverBg:"group-hover:bg-zinc-500/10",hoverText:"group-hover:text-zinc-500",activeText:"text-zinc-900 dark:text-white",activeFill:"fill-current"}};r=L[b]||L.default;const C=h||r.activeText;e[11]!==x?(u=M=>{M.stopPropagation(),x&&x(M)},e[11]=x,e[12]=u):u=e[12],f=`${o} ${d!==void 0?`(${d})`:""}`,k=q("group -ml-2 flex items-center gap-x-0.5 rounded-xl px-2 py-1.5 text-[12px] font-bold transition-all sm:gap-x-1 sm:text-[13px]",l?C:"text-zinc-500",!l&&r.hoverText),p=q("rounded-full p-2 transition-all duration-200",!l&&r.hoverBg),e[0]=l,e[1]=h,e[2]=d,e[3]=o,e[4]=x,e[5]=b,e[6]=r,e[7]=p,e[8]=u,e[9]=f,e[10]=k}else r=e[6],p=e[7],u=e[8],f=e[9],k=e[10];const F=l?2.5:2,m=l&&r.activeFill;let S;e[13]!==m?(S=q("transition-colors duration-200",m),e[13]=m,e[14]=S):S=e[14];let y;e[15]!==a||e[16]!==v||e[17]!==F||e[18]!==S?(y=(0,t.jsx)(a,{size:v,strokeWidth:F,className:S}),e[15]=a,e[16]=v,e[17]=F,e[18]=S,e[19]=y):y=e[19];let P;e[20]!==y||e[21]!==p?(P=(0,t.jsx)("div",{className:p,children:y}),e[20]=y,e[21]=p,e[22]=P):P=e[22];let i;e[23]!==o?(i=o&&(0,t.jsx)("span",{className:"hidden xs:inline",children:o}),e[23]=o,e[24]=i):i=e[24];let _;e[25]!==l||e[26]!==d?(_=d!=null&&(0,t.jsx)("span",{className:q("transition-all",l?"font-black":"font-bold"),children:d||0}),e[25]=l,e[26]=d,e[27]=_):_=e[27];let A;return e[28]!==P||e[29]!==i||e[30]!==_||e[31]!==u||e[32]!==f||e[33]!==k?(A=(0,t.jsxs)("button",{onClick:u,"aria-label":f,className:k,children:[P,i,_]}),e[28]=P,e[29]=i,e[30]=_,e[31]=u,e[32]=f,e[33]=k,e[34]=A):A=e[34],A},G=Ds,Os=H(),Ws=s=>{const e=(0,Os.c)(46),{currentUser:a,newComment:d,setNewComment:o,handleSubmitComment:x,loading:l,selectedFiles:h,setSelectedFiles:g,isUploading:w}=s;let v;e[0]!==h?(v=h===void 0?[]:h,e[0]=h,e[1]=v):v=e[1];const b=v,r=(0,n.useRef)(null);let p;e[2]!==g?(p=j=>{if(j.target.files){const I=Array.from(j.target.files);g&&g(B=>[...B,...I])}},e[2]=g,e[3]=p):p=e[3];const u=p;let f;e[4]!==g?(f=j=>{g&&g(I=>I.filter((B,ee)=>ee!==j))},e[4]=g,e[5]=f):f=e[5];const k=f;if(!a){let j;return e[6]===Symbol.for("react.memo_cache_sentinel")?(j=(0,t.jsx)("div",{className:"border-y border-zinc-100 bg-zinc-50/30 p-6 text-center dark:border-zinc-800 dark:bg-zinc-900/10",children:(0,t.jsx)("p",{className:"text-sm text-zinc-500",children:"Please login to join the conversation."})}),e[6]=j):j=e[6],j}let F;e[7]!==a.avatar||e[8]!==a.handle?(F=(0,t.jsx)(X,{src:a.avatar,alt:a.handle,className:"object-cover"}),e[7]=a.avatar,e[8]=a.handle,e[9]=F):F=e[9];let m;e[10]!==a.handle?.[0]?(m=a.handle?.[0]?.toUpperCase(),e[10]=a.handle?.[0],e[11]=m):m=e[11];let S;e[12]!==m?(S=(0,t.jsx)(Y,{children:m}),e[12]=m,e[13]=S):S=e[13];let y;e[14]!==F||e[15]!==S?(y=(0,t.jsxs)(Q,{className:"size-9 border border-zinc-200 dark:border-zinc-700",children:[F,S]}),e[14]=F,e[15]=S,e[16]=y):y=e[16];let P;e[17]!==o?(P=j=>o(j.target.value),e[17]=o,e[18]=P):P=e[18];let i;e[19]!==d||e[20]!==P?(i=(0,t.jsx)("textarea",{id:"comment-input",className:"min-h-[60px] w-full resize-none bg-transparent text-base outline-none placeholder:text-zinc-500 dark:text-white",placeholder:"Post your reply...",value:d,onChange:P}),e[19]=d,e[20]=P,e[21]=i):i=e[21];let _;e[22]!==k||e[23]!==b?(_=b.length>0&&(0,t.jsx)("div",{className:"mt-2 mb-2 flex flex-wrap gap-2",children:b.map((j,I)=>(0,t.jsxs)("div",{className:"relative size-20 overflow-hidden rounded-xl border border-zinc-200 dark:border-zinc-800",children:[j.type.startsWith("image/")?(0,t.jsx)("img",{src:URL.createObjectURL(j),className:"size-full object-cover",alt:""}):(0,t.jsx)("div",{className:"flex size-full items-center justify-center bg-zinc-100 dark:bg-zinc-800",children:(0,t.jsx)(us,{size:20,className:"text-zinc-500"})}),(0,t.jsx)("button",{onClick:()=>k(I),className:"absolute right-1 top-1 rounded-full bg-black/60 p-1 text-white transition-colors hover:bg-black",children:(0,t.jsx)(le,{size:12})})]},I))}),e[22]=k,e[23]=b,e[24]=_):_=e[24];let A;e[25]===Symbol.for("react.memo_cache_sentinel")?(A=()=>r.current?.click(),e[25]=A):A=e[25];let L;e[26]===Symbol.for("react.memo_cache_sentinel")?(L=(0,t.jsx)("button",{type:"button",onClick:A,className:"rounded-full p-2 text-violet-600 transition-colors hover:bg-violet-50 dark:hover:bg-zinc-800",title:"Attach media",children:(0,t.jsx)(as,{size:20})}),e[26]=L):L=e[26];let C;e[27]!==u?(C=(0,t.jsxs)("div",{className:"flex gap-1 text-violet-600",children:[L,(0,t.jsx)("input",{type:"file",ref:r,onChange:u,multiple:!0,className:"hidden",accept:"image/*,video/*,application/pdf"})]}),e[27]=u,e[28]=C):C=e[28];const M=l||w;let T;e[29]!==d||e[30]!==b.length?(T=!d.trim()&&b.length===0,e[29]=d,e[30]=b.length,e[31]=T):T=e[31];let E;e[32]!==x||e[33]!==M||e[34]!==T?(E=(0,t.jsx)(Fs,{className:"min-w-[70px] !w-auto px-5 py-1.5 text-sm font-bold",onClick:x,loading:M,disabled:T,children:"Reply"}),e[32]=x,e[33]=M,e[34]=T,e[35]=E):E=e[35];let U;e[36]!==C||e[37]!==E?(U=(0,t.jsxs)("div",{className:"mt-2 flex items-center justify-between border-t border-zinc-100 pt-3 dark:border-zinc-800",children:[C,E]}),e[36]=C,e[37]=E,e[38]=U):U=e[38];let W;e[39]!==i||e[40]!==_||e[41]!==U?(W=(0,t.jsxs)("div",{className:"flex-1",children:[i,_,U]}),e[39]=i,e[40]=_,e[41]=U,e[42]=W):W=e[42];let z;return e[43]!==W||e[44]!==y?(z=(0,t.jsx)("div",{className:"border-y border-zinc-100 bg-zinc-50/30 p-4 dark:border-zinc-800 dark:bg-zinc-900/10",children:(0,t.jsxs)("div",{className:"flex gap-3",children:[y,W]})}),e[43]=W,e[44]=y,e[45]=z):z=e[45],z},St=n.memo(Ws),Us=H(),Bs=s=>{const e=(0,Us.c)(15),{file:a}=s;let d;e[0]===Symbol.for("react.memo_cache_sentinel")?(d=(0,t.jsx)("div",{className:"flex size-10 items-center justify-center rounded-xl bg-violet-100 text-violet-600 dark:bg-violet-900/30",children:(0,t.jsx)(Zt,{size:20})}),e[0]=d):d=e[0];let o;e[1]!==a.name?(o=(0,t.jsx)("div",{className:"truncate text-sm font-bold dark:text-white",children:a.name}),e[1]=a.name,e[2]=o):o=e[2];let x;e[3]!==a.size?(x=a.size!==void 0&&(0,t.jsxs)("div",{className:"text-xs uppercase text-zinc-500",children:[(a.size/1024/1024).toFixed(2)," MB"]}),e[3]=a.size,e[4]=x):x=e[4];let l;e[5]!==o||e[6]!==x?(l=(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[o,x]}),e[5]=o,e[6]=x,e[7]=l):l=e[7];let h;e[8]===Symbol.for("react.memo_cache_sentinel")?(h=(0,t.jsx)(Yt,{size:18}),e[8]=h):h=e[8];let g;e[9]!==a.name||e[10]!==a.url?(g=(0,t.jsx)("a",{href:a.url,download:a.name,className:"p-2 text-zinc-400 transition-colors hover:text-violet-600",onClick:qs,children:h}),e[9]=a.name,e[10]=a.url,e[11]=g):g=e[11];let w;return e[12]!==l||e[13]!==g?(w=(0,t.jsxs)("div",{className:"group mt-3 flex items-center gap-3 rounded-2xl border border-zinc-100 bg-zinc-50/50 p-3 transition-colors hover:border-violet-500/30 dark:border-zinc-800 dark:bg-zinc-900/10",children:[d,l,g]}),e[12]=l,e[13]=g,e[14]=w):w=e[14],w},Vs=Bs;function qs(s){return s.stopPropagation()}var Fa=H(),Hs=H(),Js=s=>{const e=(0,Hs.c)(30),{url:a}=s;let d,o;e[0]!==a?(d=["link-preview",a],o=()=>Ts(a),e[0]=a,e[1]=d,e[2]=o):(d=e[1],o=e[2]);const x=!!a;let l;e[3]!==d||e[4]!==o||e[5]!==x?(l={queryKey:d,queryFn:o,staleTime:864e5,enabled:x},e[3]=d,e[4]=o,e[5]=x,e[6]=l):l=e[6];const{data:h,isLoading:g,isError:w}=qt(l);if(g){let S;return e[7]===Symbol.for("react.memo_cache_sentinel")?(S=(0,t.jsx)("div",{className:"mt-3 flex h-24 animate-pulse items-center justify-center overflow-hidden rounded-2xl border border-zinc-100 bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-900/50",children:(0,t.jsx)(st,{className:"animate-spin text-zinc-300 dark:text-zinc-700",size:24})}),e[7]=S):S=e[7],S}if(w||!h||!h.title&&!h.image)return null;let v;e[8]!==h.image||e[9]!==h.title?(v=h.image&&(0,t.jsx)("div",{className:"aspect-[1.91/1] w-full overflow-hidden border-b border-zinc-100 bg-zinc-100 dark:border-zinc-800 dark:bg-zinc-900",children:(0,t.jsx)("img",{src:h.image,alt:h.title??void 0,className:"h-full w-full object-cover transition-transform duration-500 group-hover:scale-[1.02]",onError:Ks})}),e[8]=h.image,e[9]=h.title,e[10]=v):v=e[10];let b;e[11]===Symbol.for("react.memo_cache_sentinel")?(b=(0,t.jsx)(st,{size:12}),e[11]=b):b=e[11];let r;e[12]!==h.siteName?(r=(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs font-bold uppercase tracking-wider text-zinc-600",children:[b,(0,t.jsx)("span",{children:h.siteName})]}),e[12]=h.siteName,e[13]=r):r=e[13];let p;e[14]!==h.title?(p=(0,t.jsx)("div",{className:"line-clamp-2 text-[15px] font-bold leading-snug transition-colors group-hover:text-violet-700 dark:text-white",children:h.title}),e[14]=h.title,e[15]=p):p=e[15];let u;e[16]!==h.description?(u=h.description&&(0,t.jsx)("p",{className:"line-clamp-2 text-xs leading-relaxed text-zinc-600 dark:text-zinc-400",children:h.description}),e[16]=h.description,e[17]=u):u=e[17];let f;e[18]===Symbol.for("react.memo_cache_sentinel")?(f=(0,t.jsx)(Kt,{size:10}),e[18]=f):f=e[18];let k;e[19]!==a?(k=(0,t.jsxs)("div",{className:"flex items-center gap-1 pt-1 text-[11px] font-medium text-zinc-500",children:[f,(0,t.jsx)("span",{className:"truncate",children:a})]}),e[19]=a,e[20]=k):k=e[20];let F;e[21]!==k||e[22]!==r||e[23]!==p||e[24]!==u?(F=(0,t.jsxs)("div",{className:"space-y-1 p-3.5",children:[r,p,u,k]}),e[21]=k,e[22]=r,e[23]=p,e[24]=u,e[25]=F):F=e[25];let m;return e[26]!==F||e[27]!==v||e[28]!==a?(m=(0,t.jsxs)("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"group mt-3 flex flex-col overflow-hidden rounded-2xl border border-zinc-100 bg-white shadow-sm transition-all hover:bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-950 dark:hover:bg-zinc-900",onClick:Gs,children:[v,F]}),e[26]=F,e[27]=v,e[28]=a,e[29]=m):m=e[29],m},ft=Js;function Gs(s){return s.stopPropagation()}function Ks(s){return s.target.style.display="none"}var Qs=H(),Xs=s=>{const e=(0,Qs.c)(17),{src:a,poster:d}=s,o=(0,n.useRef)(null),{reportVisibility:x,unregister:l}=Cs(),{dataSaver:h}=$s(),g=(0,n.useId)();let w;e[0]===Symbol.for("react.memo_cache_sentinel")?(w={play:()=>{const S=o.current?.plyr;S&&(S.muted=!0,S.play().catch(Zs))},pause:()=>{o.current?.plyr?.pause()}},e[0]=w):w=e[0];const v=w;let b,r;e[1]!==h||e[2]!==g||e[3]!==x||e[4]!==l?(b=()=>{const S=new IntersectionObserver(P=>{const[i]=P;x(g,h?0:i.intersectionRatio,v)},{threshold:[0,.6]}),y=o.current?.elements?.container;return y&&S.observe(y),()=>{l(g),y&&S.unobserve(y)}},r=[g,x,l,v,h],e[1]=h,e[2]=g,e[3]=x,e[4]=l,e[5]=b,e[6]=r):(b=e[5],r=e[6]),(0,n.useEffect)(b,r);let p;e[7]!==a?(p=[{src:a,type:"video/mp4"}],e[7]=a,e[8]=p):p=e[8];let u;e[9]!==d||e[10]!==p?(u={type:"video",sources:p,poster:d},e[9]=d,e[10]=p,e[11]=u):u=e[11];let f;e[12]===Symbol.for("react.memo_cache_sentinel")?(f={controls:["play-large","play","progress","current-time","mute","volume","fullscreen"],settings:["quality","speed"],ratio:"16:9",clickToPlay:!0,hideControls:!0,resetOnEnd:!0},e[12]=f):f=e[12];let k;e[13]!==u?(k={source:u,options:f},e[13]=u,e[14]=k):k=e[14];const F=k;let m;return e[15]!==F?(m=(0,t.jsx)("div",{className:"w-full bg-black",onClick:ea,children:(0,t.jsx)(zt,{ref:o,...F})}),e[15]=F,e[16]=m):m=e[16],m},Ys=Xs;function Zs(){}function ea(s){return s.stopPropagation()}var ta=H(),sa=s=>{const e=(0,ta.c)(3),{items:a}=s,d=a===void 0?[]:a,{openLightbox:o}=Rs();if(!d||Array.isArray(d)&&d.length===0)return null;const x=Array.isArray(d)?d:[d],l=x.filter(ia),h=x.filter(na),g=p=>{const u=l.filter(la).map(ra),f=l[p];o(u,u.indexOf(f.url||f.src))},w="mt-2 space-y-2",v=l.length>0&&(0,t.jsx)("div",{className:`grid gap-2 overflow-hidden rounded-2xl border border-zinc-100 dark:border-zinc-800 ${l.length===1?"grid-cols-1":l.length===2?"aspect-[16/9] grid-cols-2":(l.length===3,"aspect-[16/9] grid-cols-2 grid-rows-2")}`,children:l.map((p,u)=>(0,t.jsx)("div",{className:`relative cursor-pointer overflow-hidden bg-zinc-100 dark:bg-zinc-900 ${l.length===3&&u===0?"row-span-2":""}
                                `,onClick:f=>{p.type==="image"&&(f.stopPropagation(),g(u))},children:p.type==="video"?(0,t.jsx)(Ys,{src:p.url,poster:p.poster||void 0}):(0,t.jsx)("img",{src:p.url||p.src,className:"size-full object-cover transition-transform duration-500 hover:scale-[1.02]",alt:"",loading:"lazy"})},u))}),b=h.map(oa);let r;return e[0]!==v||e[1]!==b?(r=(0,t.jsxs)("div",{className:w,children:[v,b]}),e[0]=v,e[1]=b,e[2]=r):r=e[2],r},aa=sa;function ia(s){return s.type==="image"||s.type==="video"}function na(s){return s.type==="file"}function la(s){return s.type==="image"}function ra(s){return s.url||s.src}function oa(s,e){return(0,t.jsx)(Vs,{file:s},e)}var ca=H(),da=s=>{const e=(0,ca.c)(18),{poll:a,onVote:d}=s,o=a.options.reduce(ma,0),[x,l]=(0,n.useState)(null);let h;e[0]!==d||e[1]!==x?(h=u=>{x||(l(u),d&&d(u))},e[0]=d,e[1]=x,e[2]=h):h=e[2];const g=h;let w;if(e[3]!==g||e[4]!==a.options||e[5]!==o||e[6]!==x){let u;e[8]!==g||e[9]!==o||e[10]!==x?(u=(f,k)=>{const F=o>0?Math.round((f.votes+(x===f.id?1:0))/(o+(x?1:0))*100):0,m=x===f.id;return(0,t.jsxs)("div",{onClick:S=>{S.stopPropagation(),g(f.id)},className:`relative h-10 w-full overflow-hidden rounded-xl border cursor-pointer ${m?"border-violet-500 dark:border-violet-500":"border-zinc-200 dark:border-zinc-700"}`,children:[x&&(0,t.jsx)("div",{className:"absolute left-0 top-0 h-full bg-zinc-200 transition-all duration-500 dark:bg-zinc-800",style:{width:`${F}%`}}),(0,t.jsxs)("div",{className:"absolute inset-0 z-10 flex items-center justify-between px-4",children:[(0,t.jsxs)("span",{className:`text-sm font-medium ${m?"font-bold text-violet-600":"text-zinc-700 dark:text-zinc-200"}`,children:[f.text," ",m&&(0,t.jsx)(Gt,{size:14,className:"mb-0.5 inline ml-1"})]}),x&&(0,t.jsxs)("span",{className:"text-sm font-bold text-zinc-900 dark:text-white",children:[F,"%"]})]})]},f.id||k)},e[8]=g,e[9]=o,e[10]=x,e[11]=u):u=e[11],w=a.options.map(u),e[3]=g,e[4]=a.options,e[5]=o,e[6]=x,e[7]=w}else w=e[7];const v=o+(x?1:0),b=x?"6 days left":"Click to vote";let r;e[12]!==v||e[13]!==b?(r=(0,t.jsxs)("div",{className:"pl-1 text-xs text-zinc-500 dark:text-zinc-400",children:[v," votes •"," ",b]}),e[12]=v,e[13]=b,e[14]=r):r=e[14];let p;return e[15]!==w||e[16]!==r?(p=(0,t.jsxs)("div",{className:"mt-3 space-y-2",children:[w,r]}),e[15]=w,e[16]=r,e[17]=p):p=e[17],p},gt=da;function ma(s,e){return s+e.votes}var Fe=({id:s,user:e,timeAgo:a,content:d,contentClass:o,media:x,quotedPost:l,stats:h,onClick:g,repostedBy:w,onUserClick:v,currentUser:b,showToast:r,poll:p,isDetail:u,initialComments:f,onDelete:k,onUpdate:F,isComment:m,onReply:S,community:y,parent_id:P,post_id:i})=>{const _=$e(),{liked:A,reposted:L,localStats:C,setLocalStats:M,handleLike:T,handleRepost:E}=Es(s,h,b,r||(()=>{})),{deletePost:U,updatePost:W}=Ps(),[z,j]=(0,n.useState)(f||[]),[I,B]=(0,n.useState)(""),[ee,te]=(0,n.useState)(!1),[$t,Re]=(0,n.useState)(!1),[Ie,Me]=(0,n.useState)(!1),[_t,Ae]=(0,n.useState)(!0),[ge,Te]=(0,n.useState)([]),[Pt,Ee]=(0,n.useState)(!1),[Le,re]=(0,n.useState)(!1),[be,oe]=(0,n.useState)(!1),[J,De]=(0,n.useState)(d),[ie,Oe]=(0,n.useState)(x||[]),[ce,de]=(0,n.useState)([]),[We,Ue]=(0,n.useState)(!1),[me,Rt]=(0,n.useState)(!1),[It,ve]=(0,n.useState)(!1),[je,xe]=(0,n.useState)(null),[Be,Ve]=(0,n.useState)(!1),[Mt,ze]=(0,n.useState)([]),[At,qe]=(0,n.useState)(!1),{ref:He,inView:Je}=Bt({threshold:.5,triggerOnce:!0});(0,n.useEffect)(()=>{if(Je&&!m){const c=setTimeout(()=>{fs(s).catch(console.error)},1500);return()=>clearTimeout(c)}},[Je,s,m]);const Ge=(0,n.useRef)(null),Ke=(0,n.useRef)(z);(0,n.useEffect)(()=>{Ke.current=z},[z]);const Tt=(0,n.useCallback)(async()=>{if(!(!s||!i||C.comments===0)){qe(!0);try{ze(await we(i,null,10,s)),Ve(!0)}catch(c){console.error("Failed to load replies:",c)}finally{qe(!1)}}},[s,i,C.comments]),Et=async()=>{const c=JSON.stringify(ie)!==JSON.stringify(x||[])||ce.length>0;if(!J.trim()||J===d&&!c){oe(!1);return}Ue(!0);try{const N=[];for(const R of ce){const D=await Ce(R);N.push(D)}const $=[...ie,...N];m?await ks(s,{content:J,media:$}):await W(s,{content:J,media:$}),de([]),oe(!1),r&&r(`${m?"Comment":"Post"} updated`),F&&F(s,J,$)}catch(N){console.error(`Failed to update ${m?"comment":"post"}:`,N),r&&r(`Failed to update ${m?"comment":"post"}`)}finally{Ue(!1)}},Qe=async c=>{c&&c.stopPropagation();try{m?await js(s):await U(s),r&&r(`${m?"Comment":"Post"} deleted successfully`),k&&k(s)}catch(N){console.error(`Failed to delete ${m?"comment":"post"}:`,N),r&&r(`Failed to delete ${m?"comment":"post"}`)}finally{re(!1)}},ue=(0,n.useCallback)(async(c=!1)=>{if(s){c?Me(!0):te(!0);try{const N=Ke.current,$=await we(s,c&&N.length>0?N[N.length-1].created_at:null,10);$.length<10?Ae(!1):Ae(!0),j(c?R=>[...R,...$]:$)}catch(N){console.error("Failed to load comments:",N)}finally{te(!1),Me(!1)}}},[s]);(0,n.useEffect)(()=>{u&&s&&ue()},[u,s,ue]);const Lt=async c=>{if(c.preventDefault(),!(!I.trim()&&ge.length===0||!b)){Re(!0),Ee(!0);try{const N=[];for(const $ of ge){const R=await Ce($);N.push(R)}await yt(s,b.id,I,N,je?.id),B(""),Te([]),xe(null),M($=>({...$,comments:($.comments||0)+1})),r&&r("Reply posted!"),ue()}catch(N){console.error("Failed to post comment:",N),r&&r("Failed to post reply.")}finally{Re(!1),Ee(!1)}}},Xe=({trigger:c})=>(0,t.jsxs)(zs,{children:[(0,t.jsx)(bs,{asChild:!0,onClick:N=>N.stopPropagation(),children:c}),(0,t.jsxs)(Ns,{align:"end",className:"w-48 rounded-xl border-zinc-100 bg-white dark:border-zinc-800 dark:bg-zinc-900",children:[(0,t.jsxs)(at,{children:[!m&&(0,t.jsxs)(ne,{className:"cursor-pointer gap-2 py-2.5",onClick:N=>{N.stopPropagation(),navigator.clipboard.writeText(`${window.location.origin}/post/${s}`),r&&r("Link copied")},children:[(0,t.jsx)(Ht,{size:16}),(0,t.jsx)("span",{children:"Copy link"})]}),!m&&(0,t.jsxs)(ne,{className:"cursor-pointer gap-2 py-2.5",onClick:N=>{N.stopPropagation(),r&&r("Post reported")},children:[(0,t.jsx)(Jt,{size:16}),(0,t.jsx)("span",{children:"Report post"})]}),!Ne&&(0,t.jsxs)(ne,{className:"cursor-pointer gap-2 py-2.5",onClick:N=>{N.stopPropagation(),r&&r("User blocked")},children:[(0,t.jsx)(is,{size:16}),(0,t.jsxs)("span",{children:["Block @",e.handle]})]}),Ne&&(0,t.jsxs)(ne,{onClick:N=>{N.stopPropagation(),oe(!0)},className:"cursor-pointer gap-2 py-2.5",children:[(0,t.jsx)(rs,{size:16}),"Edit Post"]})]}),Ne&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Is,{}),(0,t.jsx)(at,{children:(0,t.jsxs)(ne,{variant:"destructive",className:"cursor-pointer gap-2 py-2.5",onClick:N=>{N.stopPropagation(),re(!0)},children:[(0,t.jsx)(Xt,{size:16}),(0,t.jsx)("span",{children:"Delete post"})]})})]})]})]}),Ne=b?.handle===e.handle,Ye=c=>{if(!c)return null;const N=be?ie:c;return!N||Array.isArray(N)&&N.length===0?null:be?(0,t.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:[ie.map(($,R)=>(0,t.jsxs)("div",{className:"group relative aspect-square overflow-hidden rounded-xl border border-zinc-200 dark:border-zinc-800",children:[$.type==="video"?(0,t.jsx)("div",{className:"flex size-full items-center justify-center bg-zinc-100 dark:bg-zinc-900",children:(0,t.jsx)(tt,{size:24,className:"text-zinc-400"})}):(0,t.jsx)("img",{src:$.url||$.src,className:"size-full object-cover",alt:""}),(0,t.jsx)("button",{onClick:D=>{D.stopPropagation(),Oe(O=>O.filter((K,V)=>V!==R))},className:"absolute right-1.5 top-1.5 flex size-7 items-center justify-center rounded-full bg-black/60 text-white transition-colors hover:bg-black",children:(0,t.jsx)(le,{size:16})})]},`old-${R}`)),ce.map(($,R)=>(0,t.jsxs)("div",{className:"group relative aspect-square overflow-hidden rounded-xl border-2 border-dashed border-violet-500 bg-violet-50/10",children:[$.type.startsWith("image/")?(0,t.jsx)("img",{src:URL.createObjectURL($),className:"size-full object-cover",alt:""}):(0,t.jsx)("div",{className:"flex size-full items-center justify-center",children:(0,t.jsx)(tt,{size:24,className:"animate-pulse text-violet-500"})}),(0,t.jsx)("button",{onClick:D=>{D.stopPropagation(),de(O=>O.filter((K,V)=>V!==R))},className:"absolute right-1.5 top-1.5 flex size-7 items-center justify-center rounded-full bg-black/60 text-white transition-colors hover:bg-black",children:(0,t.jsx)(le,{size:16})}),(0,t.jsx)("div",{className:"absolute bottom-1 left-1 rounded bg-violet-600 px-1 text-[8px] font-bold text-white",children:"NEW"})]},`new-${R}`)),ie.length+ce.length<4&&(0,t.jsxs)("button",{onClick:$=>{$.stopPropagation(),Ge.current?.click()},className:"relative flex aspect-square flex-col items-center justify-center gap-1 rounded-xl border-2 border-dashed border-zinc-200 text-zinc-400 transition-all hover:border-violet-500 hover:bg-violet-50/5 hover:text-violet-500 dark:border-zinc-800",children:[(0,t.jsx)(ls,{size:20}),(0,t.jsx)("span",{className:"text-[10px] font-bold",children:"Add Media"})]})]}),(0,t.jsx)("input",{type:"file",ref:Ge,onChange:$=>{if($.target.files){const R=Array.from($.target.files);de(D=>[...D,...R])}},multiple:!0,className:"hidden",accept:"image/*,video/*"})]}):n.isValidElement(N)?N:(0,t.jsx)(aa,{items:N})},Ze=(c,N)=>{const $=typeof c=="string"&&Ss(c);if(be)return(0,t.jsxs)("div",{className:"mt-2 flex flex-col gap-2",onClick:R=>R.stopPropagation(),children:[(0,t.jsx)(As,{value:J,onChange:R=>De(R.target.value),className:`min-h-[100px] w-full rounded-xl border-zinc-200 bg-zinc-50 focus:ring-violet-500 dark:border-zinc-800 dark:bg-zinc-900 ${$?"font-bangla text-lg":"font-english"}`,autoFocus:!0}),(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>{oe(!1),De(d),Oe(x||[]),de([])},className:"px-4 py-1.5 text-sm font-bold text-zinc-500 transition-colors hover:text-zinc-700 dark:hover:text-zinc-300",children:"Cancel"}),(0,t.jsx)("button",{onClick:Et,disabled:We||!J.trim()||J===d,className:"rounded-full bg-violet-600 px-4 py-1.5 text-sm font-bold text-white transition-all hover:bg-violet-700 disabled:opacity-50 active:scale-95",children:We?"Saving...":"Save"})]})]});if(typeof c=="string"){const R=!u&&c.length>280,D=R&&!me?c.substring(0,280):c;return(0,t.jsxs)("div",{className:`whitespace-pre-line ${N||""} ${$?"font-bangla text-[1.15em] leading-relaxed":"font-english text-[1.05em]"}`,children:[(0,t.jsx)(_e,{options:{...Pe,render:({attributes:O,content:K})=>{const{href:V,...se}=O,et=window.location.origin;if(V.includes("internal.tag/")){const ae=decodeURIComponent(V.split("internal.tag/")[1]);return(0,t.jsxs)("span",{...se,className:q("cursor-pointer font-bold text-rose-600 hover:underline dark:text-rose-400 font-bangla",se.className),onClick:Ot=>{Ot.stopPropagation(),_(`/tags/${ae}`)},children:["#",ae]},K)}let he=null;return V.startsWith("/")?he=V:V.startsWith(et)&&(he=V.replace(et,"")),he?(0,t.jsx)("span",{...se,className:q("cursor-pointer font-medium text-violet-600 hover:underline dark:text-violet-400",se.className),onClick:ae=>{ae.stopPropagation(),_(he)},children:K},K):(0,t.jsx)("a",{href:V,...se,target:"_blank",rel:"noopener noreferrer",className:q("text-violet-600 hover:underline dark:text-violet-400",se.className),onClick:ae=>ae.stopPropagation(),children:K},K)}},children:typeof D=="string"?D.replace(/#([\u0980-\u09FF\w]+)/g,"https://internal.tag/$1"):D}),R&&!me&&"...",R&&(0,t.jsx)("button",{onClick:O=>{O.stopPropagation(),Rt(!me)},className:"ml-1 cursor-pointer font-bold text-rose-600 hover:underline dark:text-rose-400",children:me?"Show less":"See more"})]})}return c},Dt=(c,N)=>{xe(N?{handle:c,id:m?P||s:N}:null),B($=>{const R=`@${c} `;return $.includes(R)?$:R+$}),document.getElementById("comment-input")?.focus()};return u?(0,t.jsxs)("div",{className:"flex flex-col",ref:He,children:[(0,t.jsxs)("article",{className:"p-5 dark:bg-black",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-start gap-x-3",children:[(0,t.jsx)("button",{className:"shrink-0",onClick:()=>v&&v(e.handle),children:(0,t.jsxs)(Q,{className:"size-12 border border-zinc-200 dark:border-zinc-700",children:[(0,t.jsx)(X,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,t.jsx)(Y,{children:e.handle[0]?.toUpperCase()})]})}),(0,t.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col",children:[(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-x-1.5 leading-none",children:(0,t.jsxs)("div",{className:"flex min-w-0 max-w-full items-center gap-1.5",children:[(0,t.jsxs)("button",{className:"flex shrink-0 items-center gap-1 text-base font-bold text-zinc-900 hover:underline sm:text-lg dark:text-white",onClick:()=>v&&v(e.handle),children:[(0,t.jsx)("span",{className:"max-w-[200px] truncate sm:max-w-none",children:e.handle}),e.verified&&(0,t.jsx)(ct,{size:16,className:"text-blue-500"})]}),y&&(0,t.jsxs)("div",{className:"flex min-w-0 items-center gap-1 text-zinc-500",children:[(0,t.jsx)(rt,{size:14,className:"shrink-0 text-zinc-400"}),(0,t.jsxs)("button",{className:"flex items-center gap-1 text-[14px] font-bold text-zinc-900 hover:underline sm:text-[15px] dark:text-zinc-100",onClick:c=>{c.stopPropagation(),_(`/c/${y.handle}`)},children:[(0,t.jsxs)(Q,{className:"size-4 shrink-0 border border-zinc-200 bg-zinc-100 dark:border-zinc-700 dark:bg-zinc-800",children:[(0,t.jsx)(X,{src:y.avatar,alt:y.name,className:"object-cover"}),(0,t.jsx)(Y,{className:"text-[8px] font-bold text-zinc-500",children:y.name?.[0]?.toUpperCase()})]}),(0,t.jsx)("span",{className:"max-w-[200px] truncate sm:max-w-none",children:y.name})]})]})]})}),(0,t.jsxs)("span",{className:"text-xs font-medium text-zinc-500 sm:text-sm dark:text-zinc-400",children:["@",e.handle]})]})]}),(0,t.jsxs)("div",{className:"-mt-1 flex items-center gap-2",children:[(0,t.jsx)("span",{className:"whitespace-nowrap text-[13px] text-zinc-500 sm:text-sm dark:text-zinc-400",children:a||"Recent"}),(0,t.jsx)(Xe,{trigger:(0,t.jsx)("button",{"aria-label":"More options",className:"rounded-full p-2 text-zinc-500 transition-colors hover:bg-zinc-100 dark:hover:bg-zinc-800",children:(0,t.jsx)(ye,{size:20})})})]})]}),(0,t.jsx)("div",{className:"mt-4 whitespace-pre-line break-words text-lg leading-relaxed text-zinc-900 sm:text-xl sm:leading-8 dark:text-zinc-100",children:Ze(d,o)}),pe(d)&&(0,t.jsx)(ft,{url:pe(d)}),Ye(x),p&&(0,t.jsx)(gt,{poll:p}),l&&(0,t.jsx)("div",{className:"mt-4 overflow-hidden rounded-2xl border border-zinc-200 shadow-sm dark:border-zinc-700",children:(0,t.jsx)(bt,{...l})}),(0,t.jsxs)("div",{className:"mt-4 flex items-center gap-x-6 border-b border-zinc-100 pb-4 text-sm text-zinc-500 dark:border-zinc-800 dark:text-zinc-400",children:[(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:C.views||0})," ",(0,t.jsx)("span",{className:"opacity-70",children:"Views"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:C.likes||0})," ",(0,t.jsx)("span",{className:"opacity-70",children:"Likes"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:C.comments||0})," ",(0,t.jsx)("span",{className:"opacity-70",children:"Comments"})]})]}),(0,t.jsxs)("div",{className:"mt-4 flex w-full items-center justify-around py-1",children:[(0,t.jsx)(G,{icon:fe,label:"Like",type:"like",onClick:T,active:A}),!m&&(0,t.jsx)(G,{icon:ke,label:"Repost",type:"repost",onClick:E,active:L}),(0,t.jsx)(G,{icon:wt,label:"Comment",type:"comment",onClick:()=>document.getElementById("comment-input")?.focus()}),!m&&(0,t.jsx)(G,{icon:Se,label:"Share",type:"share",onClick:()=>ve(!0)})]})]}),je&&(0,t.jsxs)("div",{className:"flex items-center justify-between bg-zinc-50 px-5 py-2 dark:bg-zinc-900/50",children:[(0,t.jsxs)("span",{className:"text-sm text-zinc-500",children:["Replying to ",(0,t.jsxs)("span",{className:"font-bold text-violet-600",children:["@",je.handle]})]}),(0,t.jsx)("button",{onClick:()=>xe(null),className:"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200",children:(0,t.jsx)(le,{size:16})})]}),(0,t.jsx)(St,{currentUser:b,newComment:I,setNewComment:B,handleSubmitComment:Lt,loading:$t,selectedFiles:ge,setSelectedFiles:Te,isUploading:Pt}),(0,t.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:ee?(0,t.jsx)("div",{className:"flex justify-center p-8",children:(0,t.jsx)(Z,{className:"animate-spin text-violet-500"})}):(0,t.jsxs)(t.Fragment,{children:[_t&&z.length>0&&(0,t.jsxs)("button",{onClick:()=>ue(!0),disabled:Ie,className:"flex w-full items-center justify-center gap-2 py-3 text-sm font-bold text-violet-600 transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[Ie&&(0,t.jsx)(Z,{size:14,className:"animate-spin"}),"View more replies"]}),z.map(c=>(0,t.jsx)(Fe,{...c,isComment:!0,post_id:s,onReply:Dt,onUserClick:v,currentUser:b,showToast:r,onDelete:N=>j($=>$.filter(R=>R.id!==N)),onUpdate:(N,$,R)=>j(D=>D.map(O=>O.id===N?{...O,content:$,media:R}:O)),stats:{likes:c.stats?.likes||0,comments:c.stats?.comments||0,reposts:c.stats?.reposts||0},timeAgo:c.timeAgo||c.created_at},c.id))]})}),(0,t.jsx)(ut,{open:Le,onOpenChange:re,children:(0,t.jsxs)(xt,{onClick:c=>c.stopPropagation(),children:[(0,t.jsxs)(mt,{children:[(0,t.jsx)(pt,{children:"Are you absolutely sure?"}),(0,t.jsx)(ht,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,t.jsxs)(ot,{children:[(0,t.jsx)(lt,{onClick:c=>c.stopPropagation(),children:"Cancel"}),(0,t.jsx)(dt,{onClick:Qe,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]}):(0,t.jsxs)("article",{ref:He,onClick:g,className:`px-4 transition-all ${m?"py-2 bg-transparent hover:bg-zinc-50/30 dark:hover:bg-zinc-800/20":"py-4 border-b border-zinc-100 bg-white hover:bg-zinc-50/30 dark:border-zinc-800 dark:bg-black dark:hover:bg-white/[0.02]"} ${g?"cursor-pointer":""}`,children:[w&&(0,t.jsxs)("div",{className:"mb-2 ml-1 flex items-center space-x-1.5 text-[13px] font-semibold text-zinc-600",children:[(0,t.jsx)(ke,{size:14,className:"text-zinc-500"}),(0,t.jsxs)("span",{className:"flex cursor-pointer items-center text-zinc-700 hover:underline dark:text-zinc-300",onClick:c=>{c.stopPropagation(),v&&v(w.handle)},children:[w.handle," Reposted"]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-x-3",children:[(0,t.jsxs)("div",{className:"flex shrink-0 flex-col items-center self-stretch py-0.5",children:[(0,t.jsx)("div",{className:"cursor-pointer",onClick:c=>{c.stopPropagation(),v&&v(e.handle)},children:(0,t.jsxs)(Q,{className:`${m?"size-8":"size-10"} border-0 shadow-sm`,children:[(0,t.jsx)(X,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,t.jsx)(Y,{className:"text-xs",children:e.handle[0]?.toUpperCase()})]})}),(!m&&C.comments>0||m&&!P&&C.comments>0)&&(0,t.jsx)("div",{className:"mt-2 w-0.5 flex-1 rounded-full bg-zinc-100 dark:bg-zinc-800"})]}),(0,t.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-x-1.5 leading-none",children:(0,t.jsxs)("div",{className:"flex min-w-0 max-w-full items-center gap-1.5",children:[(0,t.jsxs)("button",{className:`flex shrink-0 items-center gap-1 ${m?"text-[14px]":"text-[15px]"} font-bold text-zinc-900 hover:underline dark:text-white`,onClick:c=>{c.stopPropagation(),v&&v(e.handle)},children:[(0,t.jsx)("span",{className:"max-w-[150px] truncate sm:max-w-none",children:e.handle}),e.verified&&(0,t.jsx)(ct,{size:m?12:14,className:"text-blue-500"})]}),y&&(0,t.jsxs)("div",{className:"flex min-w-0 items-center gap-1 text-zinc-500",children:[(0,t.jsx)(rt,{size:12,className:"shrink-0 text-zinc-400"}),(0,t.jsxs)("button",{className:"flex items-center gap-1 text-[13px] font-bold text-zinc-900 hover:underline dark:text-zinc-100",onClick:c=>{c.stopPropagation(),_(`/c/${y.handle}`)},children:[(0,t.jsxs)(Q,{className:"size-3.5 shrink-0 border border-zinc-200 bg-zinc-100 dark:border-zinc-700 dark:bg-zinc-800",children:[(0,t.jsx)(X,{src:y.avatar,alt:y.name,className:"object-cover"}),(0,t.jsx)(Y,{className:"text-[6px] font-bold text-zinc-500",children:y.name?.[0]?.toUpperCase()})]}),(0,t.jsx)("span",{className:"max-w-[150px] truncate sm:max-w-none",children:y.name})]})]})]})}),(0,t.jsxs)("div",{className:"-mt-1 flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-[12px] text-zinc-500 dark:text-zinc-400",children:a||"Recent"}),(0,t.jsx)(Xe,{trigger:(0,t.jsx)("button",{"aria-label":"More options",className:"rounded-full p-2 text-zinc-500 transition-colors hover:bg-zinc-100 group-hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:group-hover:bg-zinc-800/50",children:(0,t.jsx)(ye,{size:18})})})]})]}),(0,t.jsx)("div",{className:"mt-0.5 whitespace-pre-line break-words text-[15px] leading-relaxed text-zinc-900 dark:text-zinc-100",children:Ze(d,o)}),pe(d)&&(0,t.jsx)(ft,{url:pe(d)}),Ye(x),p&&(0,t.jsx)(gt,{poll:p}),l&&(0,t.jsx)("div",{className:"mt-3 overflow-hidden rounded-2xl border border-zinc-200 shadow-sm transition-all hover:bg-zinc-50 dark:border-zinc-800 dark:hover:bg-zinc-900",onClick:c=>{c.stopPropagation(),_(`/post/${l.id}`)},children:(0,t.jsx)(bt,{...l})}),(0,t.jsxs)("div",{className:`flex items-center gap-x-1 ${m?"mt-1.5":"mt-3"}`,children:[(0,t.jsx)(G,{icon:fe,size:m?16:18,type:"like",onClick:T,active:A}),(0,t.jsx)(G,{icon:jt,size:m?16:18,type:"comment",onClick:c=>{c?.stopPropagation(),S?S(e.handle,s):g&&g()}}),(0,t.jsx)(G,{icon:ke,size:m?16:18,type:"repost",onClick:E,active:L}),!m&&(0,t.jsx)(G,{icon:Se,type:"share",onClick:c=>{c?.stopPropagation(),ve(!0)}})]}),(C.comments>0||C.likes>0||(C.views||0)>0)&&(0,t.jsxs)("div",{className:`mt-1 flex items-center gap-x-1.5 px-0.5 ${m?"text-[12px]":"text-[14px]"} font-medium text-zinc-500 dark:text-zinc-400`,children:[(C.views||0)>0&&!m&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{className:"hover:underline",children:[C.views," ",C.views===1?"view":"views"]}),(C.comments>0||C.likes>0)&&(0,t.jsx)("span",{className:"opacity-50",children:"·"})]}),C.comments>0&&(0,t.jsxs)("button",{className:"hover:underline",onClick:c=>{c.stopPropagation(),Be?Ve(!1):Tt()},children:[C.comments," ",C.comments===1?"reply":"replies"]}),C.comments>0&&C.likes>0&&(0,t.jsx)("span",{className:"opacity-50",children:"·"}),C.likes>0&&(0,t.jsxs)("button",{className:"hover:underline",children:[C.likes," ",C.likes===1?"like":"likes"]})]}),Be&&(0,t.jsxs)("div",{className:"relative mt-2 space-y-0",children:[(0,t.jsx)("div",{className:"absolute left-[19px] top-0 bottom-4 w-0.5 bg-zinc-100 dark:bg-zinc-800"}),At?(0,t.jsx)("div",{className:"flex py-4 pl-12",children:(0,t.jsx)(Z,{size:18,className:"animate-spin text-violet-500"})}):(0,t.jsx)("div",{className:"flex flex-col",children:Mt.map(c=>(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute left-[19px] top-5 h-0.5 w-4 bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsx)("div",{className:"pl-6",children:(0,t.jsx)(Fe,{...c,isComment:!0,post_id:i,onReply:S,onUserClick:v,currentUser:b,showToast:r,onDelete:N=>ze($=>$.filter(R=>R.id!==N)),onUpdate:(N,$,R)=>ze(D=>D.map(O=>O.id===N?{...O,content:$,media:R}:O)),stats:{likes:c.stats?.likes||0,comments:c.stats?.comments||0,reposts:c.stats?.reposts||0},timeAgo:c.timeAgo||c.created_at})})]},c.id))})]})]})]}),(0,t.jsx)(Ft,{isOpen:It,onClose:()=>ve(!1),url:`${window.location.origin}/post/${s}`,title:"Share Post"}),(0,t.jsx)(ut,{open:Le,onOpenChange:re,children:(0,t.jsxs)(xt,{onClick:c=>c.stopPropagation(),children:[(0,t.jsxs)(mt,{children:[(0,t.jsx)(pt,{children:"Are you absolutely sure?"}),(0,t.jsx)(ht,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,t.jsxs)(ot,{children:[(0,t.jsx)(lt,{onClick:c=>c.stopPropagation(),children:"Cancel"}),(0,t.jsx)(dt,{onClick:Qe,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]})};function xa(s,e){return s.id===e.id&&s.content===e.content&&s.timeAgo===e.timeAgo&&s.user.id===e.user.id&&s.user.avatar===e.user.avatar&&s.stats.likes===e.stats.likes&&s.stats.comments===e.stats.comments&&s.stats.reposts===e.stats.reposts&&s.currentUser?.id===e.currentUser?.id&&JSON.stringify(s.media)===JSON.stringify(e.media)&&JSON.stringify(s.repostedBy)===JSON.stringify(e.repostedBy)}var ua=n.memo(Fe,xa),ha=H(),pa=s=>{const e=(0,ha.c)(30),{user:a,time:d,content:o}=s,x=$e();let l;e[0]!==a.avatar||e[1]!==a.handle?(l=(0,t.jsx)(X,{src:a.avatar,alt:a.handle}),e[0]=a.avatar,e[1]=a.handle,e[2]=l):l=e[2];let h;e[3]!==a.handle[0]?(h=a.handle[0]?.toUpperCase(),e[3]=a.handle[0],e[4]=h):h=e[4];let g;e[5]!==h?(g=(0,t.jsx)(Y,{children:h}),e[5]=h,e[6]=g):g=e[6];let w;e[7]!==l||e[8]!==g?(w=(0,t.jsxs)(Q,{className:"size-6",children:[l,g]}),e[7]=l,e[8]=g,e[9]=w):w=e[9];let v;e[10]!==a.handle?(v=(0,t.jsx)("span",{className:"text-sm font-semibold",children:a.handle}),e[10]=a.handle,e[11]=v):v=e[11];let b;e[12]!==w||e[13]!==v?(b=(0,t.jsxs)("div",{className:"flex items-center gap-x-2",children:[w,v]}),e[12]=w,e[13]=v,e[14]=b):b=e[14];let r;e[15]!==d?(r=(0,t.jsx)("span",{className:"text-xs text-zinc-500 sm:text-sm",children:d}),e[15]=d,e[16]=r):r=e[16];let p;e[17]!==b||e[18]!==r?(p=(0,t.jsxs)("div",{className:"mb-2 flex items-center justify-between gap-x-2",children:[b,r]}),e[17]=b,e[18]=r,e[19]=p):p=e[19];let u;e[20]!==x?(u={...Pe,render:m=>{const{attributes:S,content:y}=m,{href:P,...i}=S,_=window.location.origin;let A=null;return P.startsWith("/")?A=P:P.startsWith(_)&&(A=P.replace(_,"")),A?(0,t.jsx)("span",{...i,className:q("cursor-pointer font-medium text-violet-600 hover:underline dark:text-violet-400",i.className),onClick:L=>{L.stopPropagation(),x(A)},children:y},y):(0,t.jsx)("a",{href:P,...i,target:"_blank",rel:"noopener noreferrer",className:q("text-violet-600 hover:underline dark:text-violet-400",i.className),onClick:fa,children:y},y)}},e[20]=x,e[21]=u):u=e[21];let f;e[22]!==o?(f=(0,t.jsx)("p",{className:"whitespace-pre-line text-sm text-zinc-800 dark:text-zinc-300",children:o}),e[22]=o,e[23]=f):f=e[23];let k;e[24]!==f||e[25]!==u?(k=(0,t.jsx)(_e,{options:u,children:f}),e[24]=f,e[25]=u,e[26]=k):k=e[26];let F;return e[27]!==k||e[28]!==p?(F=(0,t.jsxs)("div",{className:"p-4",children:[p,k]}),e[27]=k,e[28]=p,e[29]=F):F=e[29],F},bt=pa;function fa(s){return s.stopPropagation()}var ga=n.memo(({reel:s,isActive:e,isMuted:a})=>{const d=$e(),{currentUser:o}=Ct(),{addToast:x}=kt(),l=(0,n.useRef)(null),[h,g]=(0,n.useState)(!1),[w,v]=(0,n.useState)(!1),[b,r]=(0,n.useState)(!1),[p,u]=(0,n.useState)(null),[f,k]=(0,n.useState)(!1),[F,m]=(0,n.useState)(s.stats?.likes||0),[S,y]=(0,n.useState)(!1),[P,i]=(0,n.useState)(0),_=(0,n.useRef)(null),A=(0,n.useMemo)(()=>Array.isArray(s.media)?s.media[0]?.src||s.media[0]?.url:s.media?.src||s.media?.url||s.url,[s.media,s.url]);(0,n.useEffect)(()=>{let z;const j=l.current?.plyr;return j&&(e?z=setTimeout(()=>{typeof j.play=="function"&&j.play().catch(()=>{j&&(j.muted=!0,j.play().catch(()=>{}))})},100):typeof j.pause=="function"&&j.pause()),()=>{z&&clearTimeout(z)}},[e]),(0,n.useEffect)(()=>{if(!o?.id||!e)return;(async()=>{try{const[j,I]=await Promise.all([vs(s.id,o.id),gs(o.id,s.user?.id)]);k(j),y(I)}catch(j){console.error("Failed to check interaction status:",j)}})()},[s.id,o?.id,e,s.user?.id]),(0,n.useEffect)(()=>{const z=l.current?.plyr;z&&(z.muted=a)},[a]),(0,n.useEffect)(()=>{const z=l.current?.plyr;if(!z||!e)return;const j=()=>{const I=z.currentTime,B=z.duration;B>0&&i(I/B*100)};if(typeof z.on=="function")return z.on("timeupdate",j),()=>{typeof z.off=="function"&&z.off("timeupdate",j)}},[e]),(0,n.useEffect)(()=>()=>{_.current&&clearTimeout(_.current)},[]);const L=z=>{const j=z.target;j.closest("button")||j.closest("a")||j.closest(".plyr__controls")||(_.current?(clearTimeout(_.current),_.current=null,M()):_.current=setTimeout(()=>{_.current=null,C()},250))},C=()=>{const z=l.current?.plyr;z&&(z.paused?(z.play().catch(()=>{}),u("play")):(z.pause(),u("pause")),setTimeout(()=>u(null),800))},M=async()=>{if(o&&(g(!0),setTimeout(()=>g(!1),1e3),!f)){k(!0),m(z=>z+1);try{await it(s.id,o.id)}catch{k(!1),m(z=>z-1)}}},T=async z=>{if(z.stopPropagation(),!o)return;const j=!f;k(j),m(I=>j?I+1:I-1);try{await it(s.id,o.id)}catch{k(!j),m(I=>j?I-1:I+1)}},E=async z=>{if(z.stopPropagation(),!o)return;const j=!S;y(j);try{await ys(o.id,s.user?.id)}catch{y(!j)}},U=z=>{z.stopPropagation(),r(!0)},W=(0,n.useMemo)(()=>({source:{type:"video",sources:[{src:A,type:"video/mp4"}]},options:{controls:[],loop:{active:!0},clickToPlay:!1,ratio:"9:16"}}),[A]);return(0,t.jsxs)("div",{"data-id":s.id,className:"reel-item relative flex h-[100dvh] w-full snap-start items-center justify-center overflow-hidden bg-black cursor-pointer",onClick:L,children:[(0,t.jsx)("div",{className:"flex h-full w-full max-w-[450px] items-center justify-center",children:(0,t.jsx)("div",{className:"w-full",children:(0,t.jsx)(zt,{ref:l,...W})})}),h&&(0,t.jsx)("div",{className:"pointer-events-none absolute inset-0 z-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-in zoom-in-50 fade-out fill-mode-forwards duration-500",children:(0,t.jsx)(fe,{size:120,fill:"white",className:"scale-125 text-white drop-shadow-[0_0_30px_rgba(255,255,255,0.4)]"})})}),p&&(0,t.jsx)("div",{className:"pointer-events-none absolute inset-0 z-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-in fade-in zoom-in-90 scale-100 animate-out zoom-out-110 fade-out fill-mode-forwards duration-500",children:(0,t.jsx)("div",{className:"rounded-full border border-white/20 bg-white/10 p-8 shadow-2xl backdrop-blur-md",children:p==="play"?(0,t.jsx)(ms,{size:50,fill:"white",className:"ml-1.5 text-white"}):(0,t.jsx)(ds,{size:50,fill:"white",className:"text-white"})})})}),(0,t.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-black/60"}),(0,t.jsxs)("div",{className:"pointer-events-none absolute bottom-6 left-4 right-16 text-white",children:[(0,t.jsxs)("div",{className:"pointer-events-auto mb-3 flex items-center gap-2",children:[(0,t.jsxs)(Vt,{to:`/u/${s.user?.handle}`,className:"flex items-center gap-2 transition-opacity hover:opacity-80",onClick:z=>z.stopPropagation(),children:[(0,t.jsxs)(Q,{className:"size-10 border-2 border-white",children:[(0,t.jsx)(X,{src:s.user?.avatar,alt:s.user?.handle,className:"object-cover"}),(0,t.jsx)(Y,{children:s.user?.handle?.[0]?.toUpperCase()})]}),(0,t.jsxs)("span",{className:"font-bold",children:["@",s.user?.handle]})]}),o?.id!==s.user?.id&&(0,t.jsx)("button",{className:`ml-2 flex items-center gap-1.5 rounded-full px-3 py-1.5 text-xs font-bold transition-all active:scale-95 ${S?"border border-white/50 bg-transparent text-white":"bg-white text-black hover:bg-zinc-200"}`,onClick:E,children:S?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ws,{size:14}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Following"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Ms,{size:14}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Follow"})]})})]}),(0,t.jsx)(_e,{options:{...Pe,render:({attributes:z,content:j})=>{const{href:I,...B}=z,ee=!I.startsWith("/")&&(I.startsWith("http")||I.startsWith("www"));return I.startsWith("/u/")||I.startsWith("/tags/")||I.startsWith("/c/")||I.startsWith("/explore")?(0,t.jsx)("span",{...B,className:"cursor-pointer font-bold text-white hover:underline",onClick:te=>{te.stopPropagation(),d(I)},children:j},j):(0,t.jsx)("a",{href:I,...B,className:"text-white hover:underline",target:ee?"_blank":void 0,rel:ee?"noopener noreferrer":void 0,onClick:te=>te.stopPropagation(),children:j},j)}},children:(0,t.jsx)("p",{className:"mb-3 line-clamp-2 text-sm",children:s.content})}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs opacity-90",children:[(0,t.jsx)(os,{size:14,className:"animate-spin-slow"}),(0,t.jsxs)("span",{children:["Original Audio - ",s.user?.handle]})]})]}),(0,t.jsxs)("div",{className:"absolute bottom-6 right-2 z-10 flex flex-col items-center gap-6",children:[(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)("button",{className:`rounded-full p-3 backdrop-blur-md transition-all active:scale-90 ${f?"bg-rose-500/20 text-rose-500":"bg-zinc-800/50 text-white hover:bg-zinc-700"}`,onClick:T,children:(0,t.jsx)(fe,{size:28,fill:f?"currentColor":"none"})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:F})]}),(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)("button",{className:"rounded-full bg-zinc-800/50 p-3 text-white backdrop-blur-md transition-colors hover:bg-zinc-700 active:scale-90",onClick:z=>{z.stopPropagation(),v(!0)},children:(0,t.jsx)(wt,{size:28})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:s.stats?.comments||0})]}),(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)("button",{className:"rounded-full bg-zinc-800/50 p-3 text-white backdrop-blur-md transition-colors hover:bg-zinc-700 active:scale-90",onClick:U,children:(0,t.jsx)(Se,{size:28})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:s.stats?.shares||0})]})]}),(0,t.jsx)("div",{className:"absolute bottom-0 left-0 z-50 h-[3px] w-full bg-white/20",children:(0,t.jsx)("div",{className:"h-full bg-white shadow-[0_0_8px_rgba(255,255,255,0.8)] transition-all duration-100 ease-linear",style:{width:`${P}%`}})}),(0,t.jsx)(va,{isOpen:w,onClose:()=>v(!1),reelId:s.id,currentUser:o,showToast:x}),(0,t.jsx)(Ft,{isOpen:b,onClose:()=>r(!1),url:`${window.location.origin}/reels?id=${s.id}`,title:"Share Reel"})]})},(s,e)=>s.isActive===e.isActive&&s.reel.id===e.reel.id&&s.isMuted===e.isMuted),$a=ga,ba=({isOpen:s,onClose:e,reelId:a,currentUser:d,showToast:o})=>{const[x,l]=(0,n.useState)([]),[h,g]=(0,n.useState)(!1),[w,v]=(0,n.useState)(!1),[b,r]=(0,n.useState)(""),[p,u]=(0,n.useState)([]),[f,k]=(0,n.useState)(!1),[F,m]=(0,n.useState)(!0),[S,y]=(0,n.useState)(!1),[P,i]=(0,n.useState)(null),_=(0,n.useRef)(x);(0,n.useEffect)(()=>{_.current=x},[x]);const A=(0,n.useCallback)(async(C=!1)=>{if(a){C?y(!0):g(!0);try{const M=_.current,T=await we(a,C&&M.length>0?M[M.length-1].created_at:null,10);T.length<10?m(!1):m(!0),l(C?E=>[...E,...T]:T)}catch(M){console.error("Failed to load comments:",M),o&&o("Failed to load comments","error")}finally{g(!1),y(!1)}}},[a,o]);(0,n.useEffect)(()=>{s&&a?A():(l([]),m(!0))},[s,a,A]);const L=async C=>{if(C.preventDefault(),!(!b.trim()&&p.length===0||!d)){v(!0),k(!0);try{const M=[];for(const T of p){const E=await Ce(T);M.push(E)}await yt(a,d.id,b,M,P?.id),r(""),u([]),i(null),o&&o("Reply posted!"),A()}catch(M){console.error("Failed to post comment:",M),o&&o("Failed to post reply.","error")}finally{v(!1),k(!1)}}};return(0,t.jsx)(Nt,{isOpen:s,onClose:e,title:"Comments",className:"max-sm:h-[95dvh] h-[85vh] overflow-hidden !p-0 sm:max-w-xl",children:(0,t.jsxs)("div",{className:"flex h-full flex-col overflow-hidden bg-white dark:bg-zinc-900",children:[(0,t.jsx)("div",{className:"mx-auto my-3 h-1.5 w-12 shrink-0 rounded-full bg-zinc-200 dark:bg-zinc-800 sm:hidden"}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto scroll-smooth scrollbar-thin scrollbar-thumb-zinc-200 dark:scrollbar-thumb-zinc-800",children:h?(0,t.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,t.jsx)(Z,{className:"animate-spin text-violet-500",size:32})}):x.length>0?(0,t.jsxs)("div",{className:"flex flex-col",children:[x.map(C=>(0,t.jsx)(ua,{...C,isComment:!0,post_id:a,currentUser:d,showToast:o,onReply:(M,T)=>{i(T?{handle:M,id:T}:null),r(E=>E.includes(`@${M}`)?E:E+`@${M} `)},onDelete:M=>l(T=>T.filter(E=>E.id!==M)),onUpdate:(M,T,E)=>l(U=>U.map(W=>W.id===M?{...W,content:T,media:E}:W))},C.id)),F&&(0,t.jsxs)("button",{onClick:()=>A(!0),disabled:S,className:"flex w-full items-center justify-center gap-2 py-6 text-sm font-bold text-violet-600 transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[S&&(0,t.jsx)(Z,{size:16,className:"animate-spin"}),"View more replies"]})]}):(0,t.jsxs)("div",{className:"flex h-full min-h-[300px] flex-col items-center justify-center p-8 text-center text-zinc-500",children:[(0,t.jsx)("div",{className:"mb-4 flex size-16 items-center justify-center rounded-full bg-zinc-100 dark:bg-zinc-900",children:(0,t.jsx)(jt,{size:32,className:"text-zinc-400"})}),(0,t.jsx)("p",{className:"text-lg font-bold dark:text-zinc-300",children:"No comments yet"}),(0,t.jsx)("p",{className:"text-sm dark:text-zinc-500",children:"Be the first to share what you think!"})]})}),(0,t.jsxs)("div",{className:"shrink-0 border-t border-zinc-100 bg-white pb-safe dark:border-zinc-800 dark:bg-zinc-900",children:[P&&(0,t.jsxs)("div",{className:"flex items-center justify-between border-b border-zinc-50 bg-zinc-50/50 px-4 py-2 dark:border-zinc-800/50 dark:bg-zinc-900/50",children:[(0,t.jsxs)("span",{className:"text-xs text-zinc-500",children:["Replying to ",(0,t.jsxs)("span",{className:"font-bold text-violet-600",children:["@",P.handle]})]}),(0,t.jsx)("button",{onClick:()=>i(null),className:"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200",children:(0,t.jsx)(le,{size:14})})]}),(0,t.jsx)(St,{currentUser:d,newComment:b,setNewComment:r,handleSubmitComment:L,loading:w,selectedFiles:p,setSelectedFiles:u,isUploading:f})]})]})})},va=ba,ja=({isOpen:s,onClose:e,url:a,title:d="Share"})=>{const[o,x]=(0,n.useState)(!1),[l,h]=(0,n.useState)(""),[g,w]=(0,n.useState)([]),[v,b]=(0,n.useState)(!1),[r,p]=(0,n.useState)(null),{addToast:u}=kt(),{currentUser:f}=Ct(),k=(0,n.useCallback)(async()=>{if(f){b(!0);try{w((await nt(f.id)).map(i=>i.user).filter(i=>i!==null).slice(0,5))}catch(i){console.error("Failed to fetch conversations:",i)}finally{b(!1)}}},[f?.id]);(0,n.useEffect)(()=>{s&&f?k():(h(""),w([]))},[s,f,k]);const F=(0,n.useCallback)(async()=>{if(f){b(!0);try{w((await nt(f.id)).map(i=>i.user).filter(i=>i!==null&&(i.name?.toLowerCase().includes(l.toLowerCase())||i.handle.toLowerCase().includes(l.toLowerCase()))))}catch(i){console.error("Search failed:",i)}finally{b(!1)}}},[l,f?.id]);(0,n.useEffect)(()=>{const i=setTimeout(()=>{l.trim()&&s?F():!l.trim()&&s&&k()},300);return()=>clearTimeout(i)},[l,s,F,k]);const m=async i=>{i&&i.stopPropagation();try{await navigator.clipboard.writeText(a),x(!0),u("Link copied to clipboard!","success"),setTimeout(()=>x(!1),2e3)}catch(_){console.error("Failed to copy:",_),u("Failed to copy link","error")}},S=async i=>{if(f){p(i.id);try{await ps(await _s(f.id,i.id),f.id,a,"text"),u(`Sent to ${i.name||i.handle}!`,"success")}catch(_){console.error("Failed to send message:",_),u("Failed to send message","error")}finally{p(null)}}},y=[{name:"X",icon:ns,color:"bg-black text-white",href:`https://twitter.com/intent/tweet?url=${encodeURIComponent(a)}`},{name:"Facebook",icon:es,color:"bg-[#1877F2] text-white",href:`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(a)}`},{name:"LinkedIn",icon:ss,color:"bg-[#0A66C2] text-white",href:`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(a)}`},{name:"WhatsApp",icon:cs,color:"bg-[#25D366] text-white",href:`https://wa.me/?text=${encodeURIComponent(a)}`},{name:"Email",icon:hs,color:"bg-zinc-600 text-white",href:`mailto:?body=${encodeURIComponent(a)}`}],P=async()=>{if(navigator.share)try{await navigator.share({title:d,url:a})}catch(i){i.name!=="AbortError"&&console.error("Native share failed:",i)}else m()};return(0,t.jsx)(Nt,{isOpen:s,onClose:e,title:d,className:"max-w-[420px] !p-0 overflow-hidden",children:(0,t.jsxs)("div",{className:"flex h-full flex-col bg-white dark:bg-zinc-900",children:[(0,t.jsx)("div",{className:"px-5 pb-2 pt-4",children:(0,t.jsxs)("div",{className:"group relative",children:[(0,t.jsx)(xs,{className:"absolute left-3 top-1/2 size-4 -translate-y-1/2 text-zinc-400 transition-colors group-focus-within:text-violet-500"}),(0,t.jsx)("input",{type:"text",placeholder:"Search people...",value:l,onChange:i=>h(i.target.value),className:"w-full rounded-xl border-none bg-zinc-100 py-2.5 pl-10 pr-4 text-sm transition-all focus:ring-2 focus:ring-violet-500/20 outline-none dark:bg-zinc-800/50"})]})}),(0,t.jsx)("div",{className:"no-scrollbar flex min-h-[100px] items-center gap-4 overflow-x-auto px-5 py-4",children:v?(0,t.jsx)("div",{className:"flex flex-1 justify-center",children:(0,t.jsx)(Z,{size:24,className:"animate-spin text-zinc-400"})}):g.length>0?g.map(i=>(0,t.jsxs)("button",{onClick:()=>S(i),disabled:r!==null,className:"group flex shrink-0 flex-col items-center gap-1.5 disabled:opacity-50",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"size-14 overflow-hidden rounded-full border-2 border-white shadow-sm transition-transform group-hover:scale-105 bg-zinc-100 dark:bg-zinc-800 dark:border-zinc-900",children:(0,t.jsx)("img",{src:i.avatar||`https://i.pravatar.cc/150?u=${i.id}`,alt:i.handle,className:"size-full object-cover"})}),r===i.id&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center rounded-full bg-black/40",children:(0,t.jsx)(Z,{size:16,className:"animate-spin text-white"})})]}),(0,t.jsx)("span",{className:"max-w-[60px] truncate text-[10px] font-medium text-zinc-500 dark:text-zinc-400",children:i.name?.split(" ")[0]||i.handle})]},i.id)):(0,t.jsx)("div",{className:"flex-1 py-2 text-center",children:(0,t.jsx)("span",{className:"text-xs text-zinc-400",children:"No people found"})})}),(0,t.jsx)("div",{className:"mx-5 h-px bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsxs)("div",{className:"grid grid-cols-5 gap-2 px-5 py-6",children:[y.map(i=>(0,t.jsxs)("a",{href:i.href,target:"_blank",rel:"noopener noreferrer",className:"group flex flex-col items-center gap-2",children:[(0,t.jsx)("div",{className:`size-12 ${i.color} flex items-center justify-center rounded-2xl shadow-md transition-all group-hover:-translate-y-1 group-hover:scale-110 group-hover:shadow-lg`,children:(0,t.jsx)(i.icon,{size:20,strokeWidth:2.5})}),(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-tighter text-zinc-500 dark:text-zinc-400",children:i.name})]},i.name)),(0,t.jsxs)("button",{onClick:P,className:"group flex flex-col items-center gap-2",children:[(0,t.jsx)("div",{className:"flex size-12 items-center justify-center rounded-2xl border border-zinc-200 bg-zinc-100 text-zinc-600 shadow-sm transition-all group-hover:-translate-y-1 group-hover:scale-110 dark:border-zinc-700 dark:bg-zinc-800 dark:text-zinc-300",children:(0,t.jsx)(ye,{size:20,strokeWidth:2.5})}),(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-tighter text-zinc-500 dark:text-zinc-400",children:"More"})]})]}),(0,t.jsx)("div",{className:"px-5 pb-6",children:(0,t.jsxs)("div",{className:"group relative",children:[(0,t.jsx)("input",{type:"text",readOnly:!0,value:a,className:"w-full rounded-2xl border border-zinc-200 bg-zinc-50 py-3.5 pl-4 pr-14 text-sm font-medium transition-colors focus:outline-none group-hover:border-zinc-300 dark:border-zinc-800 dark:bg-zinc-950 dark:group-hover:border-zinc-700"}),(0,t.jsx)("button",{onClick:m,className:`absolute right-1.5 top-1/2 flex -translate-y-1/2 items-center gap-2 rounded-xl h-10 px-4 text-xs font-bold shadow-sm transition-all active:scale-95 ${o?"bg-emerald-500 text-white":"bg-zinc-900 text-white hover:opacity-90 dark:bg-white dark:text-zinc-900"}`,children:o?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Qt,{size:14,strokeWidth:3}),(0,t.jsx)("span",{children:"Copied"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ts,{size:14,strokeWidth:3}),(0,t.jsx)("span",{children:"Copy"})]})})]})}),(0,t.jsx)("div",{className:"px-5 pb-5",children:(0,t.jsxs)("button",{onClick:e,className:"group relative flex w-full items-center justify-center overflow-hidden rounded-2xl bg-zinc-900 py-4 font-bold text-white transition-all hover:shadow-xl hover:shadow-zinc-900/10 active:scale-[0.98] dark:bg-white dark:text-zinc-900 dark:hover:shadow-white/10",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-zinc-500 to-zinc-600 opacity-0 transition-opacity duration-300 group-hover:opacity-100"}),(0,t.jsx)("div",{className:"relative flex items-center gap-2",children:(0,t.jsx)("span",{children:"Close"})})]})})]})})},Ft=ja;export{ua as n,$a as t};
