import{n as de}from"./rolldown-runtime-2JzG8er9.js";import{s as he,u as be,w as ue}from"./framework-pMVb9Z5_.js";import"./database-ApDMvJcm.js";import{Ut as G,bn as pe,jt as je,pt as re}from"./ui-libs-C0jnt0Gl.js";import{I as ge,Z as oe,c as ve,f as ze,l as Ne,n as ke,s as we,t as ye}from"./index-Be8osr5q.js";import{n as _e}from"./post-BLhYcG3-.js";import"./linkify-fXGRsD3N.js";import{c as Ce}from"./hooks-BkWyKt0E.js";var Me=he(),ce=de(ue(),1),t=de(be(),1),Pe=me=>{const e=(0,Me.c)(101),{onPostInCommunity:H}=me,[K,ne]=ce.useState(!1),[Q,ae]=ce.useState(!1),{community:s,loading:xe,isMember:n,userRole:fe,isJoining:a,communityPosts:J,loadingPosts:V,isFetchingMorePosts:T,hasMorePosts:W,handleJoinToggle:X,loadCommunityPosts:Y,currentUser:ee,addToast:te,navigate:l}=Ce(),q=fe==="admin",se=n&&(!s.isPrivate||q);if(xe){let i;return e[0]===Symbol.for("react.memo_cache_sentinel")?(i=(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)(G,{size:40,className:"animate-spin text-violet-500"})}),e[0]=i):i=e[0],i}if(!s){const i=`The community @${s?.handle||"unknown"} could not be found.`;let U;return e[1]!==i?(U=(0,t.jsx)("div",{className:"bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-[600px] flex items-center justify-center",children:(0,t.jsx)(ge,{title:"Community doesn't exist",message:i,icon:re})}),e[1]=i,e[2]=U):U=e[2],U}let r;e[3]!==l?(r=()=>l(-1),e[3]=l,e[4]=r):r=e[4];let L;e[5]===Symbol.for("react.memo_cache_sentinel")?(L=(0,t.jsx)(pe,{size:22}),e[5]=L):L=e[5];let o;e[6]!==r?(o=(0,t.jsx)("button",{onClick:r,className:"p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:L}),e[6]=r,e[7]=o):o=e[7];let c;e[8]!==s.name?(c=(0,t.jsx)("h5",{className:"text-lg font-bold dark:text-white leading-none",children:s.name}),e[8]=s.name,e[9]=c):c=e[9];let d;e[10]!==s.membersCount?(d=(0,t.jsxs)("span",{className:"text-xs text-zinc-500 mt-0.5",children:[s.membersCount," Members"]}),e[10]=s.membersCount,e[11]=d):d=e[11];let m;e[12]!==c||e[13]!==d?(m=(0,t.jsxs)("div",{className:"flex flex-col",children:[c,d]}),e[12]=c,e[13]=d,e[14]=m):m=e[14];let x;e[15]!==o||e[16]!==m?(x=(0,t.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-x-4",children:[o,m]})}),e[15]=o,e[16]=m,e[17]=x):x=e[17];let f;e[18]!==s.cover?(f=(0,t.jsx)("div",{className:"h-32 sm:h-52 bg-zinc-100 dark:bg-zinc-900 overflow-hidden relative",children:s.cover?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("img",{src:s.cover,className:"w-full h-full object-cover",alt:""}),(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 to-transparent"})]}):(0,t.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-violet-500/20 to-fuchsia-500/20"})}),e[18]=s.cover,e[19]=f):f=e[19];let h;e[20]!==s.avatar?(h=(0,t.jsx)("div",{className:"size-24 sm:size-32 rounded-3xl border-4 border-white dark:border-black bg-zinc-100 dark:bg-zinc-800 overflow-hidden shadow-xl",children:(0,t.jsx)("img",{src:s.avatar,className:"size-full object-cover",alt:""})}),e[20]=s.avatar,e[21]=h):h=e[21];let b;e[22]!==q?(b=q&&(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>ne(!0),className:"p-2 rounded-full border border-zinc-200 dark:border-zinc-800 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 transition-all active:scale-95 flex items-center justify-center size-10",title:"Edit Community",children:(0,t.jsx)(we,{size:20})}),(0,t.jsx)("button",{onClick:()=>ae(!0),className:"p-2 rounded-full border border-zinc-200 dark:border-zinc-800 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 transition-all active:scale-95 flex items-center justify-center size-10",title:"Settings",children:(0,t.jsx)(ze,{size:20})})]}),e[22]=q,e[23]=b):b=e[23];const ie=n?"outline":"default",le=`rounded-full font-bold px-4 h-10 transition-all flex items-center justify-center gap-2 ${n?"border-zinc-200 dark:border-zinc-800 hover:bg-rose-50 hover:text-rose-500 hover:border-rose-100 dark:hover:bg-rose-900/20":"bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 hover:scale-105"}`;let u;e[24]!==a||e[25]!==n?(u=a?(0,t.jsx)(G,{size:18,className:"animate-spin"}):n?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Ne,{size:18}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Joined"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ve,{size:18}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Join"})]}),e[24]=a,e[25]=n,e[26]=u):u=e[26];let p;e[27]!==X||e[28]!==a||e[29]!==ie||e[30]!==le||e[31]!==u?(p=(0,t.jsx)(oe,{variant:ie,onClick:X,disabled:a,className:le,children:u}),e[27]=X,e[28]=a,e[29]=ie,e[30]=le,e[31]=u,e[32]=p):p=e[32];let j;e[33]!==b||e[34]!==p?(j=(0,t.jsxs)("div",{className:"pb-1 flex gap-2",children:[b,p]}),e[33]=b,e[34]=p,e[35]=j):j=e[35];let g;e[36]!==j||e[37]!==h?(g=(0,t.jsxs)("div",{className:"flex justify-between items-end -mt-12 sm:-mt-16 mb-4 relative z-10",children:[h,j]}),e[36]=j,e[37]=h,e[38]=g):g=e[38];let v;e[39]!==s.name?(v=(0,t.jsx)("h1",{className:"text-2xl sm:text-3xl font-black dark:text-white tracking-tight leading-tight",children:s.name}),e[39]=s.name,e[40]=v):v=e[40];let z;e[41]!==s.handle?(z=(0,t.jsxs)("p",{className:"text-zinc-500 font-bold text-sm sm:text-base",children:["c/",s.handle]}),e[41]=s.handle,e[42]=z):z=e[42];let N;e[43]!==s.description?(N=s.description&&(0,t.jsx)("p",{className:"mt-4 text-[15px] sm:text-base dark:text-zinc-300 leading-relaxed max-w-2xl",children:s.description}),e[43]=s.description,e[44]=N):N=e[44];let k;e[45]!==s.membersCount?(k=(0,t.jsx)("span",{className:"text-base font-extrabold text-zinc-900 dark:text-white transition-colors",children:s.membersCount}),e[45]=s.membersCount,e[46]=k):k=e[46];let A;e[47]===Symbol.for("react.memo_cache_sentinel")?(A=(0,t.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400 font-medium",children:"Members"}),e[47]=A):A=e[47];let w;e[48]!==k?(w=(0,t.jsxs)("button",{className:"flex gap-x-1.5 group cursor-pointer items-baseline",children:[k,A]}),e[48]=k,e[49]=w):w=e[49];let y;e[50]!==s.postsCount?(y=(0,t.jsx)("span",{className:"text-base font-extrabold text-zinc-900 dark:text-white transition-colors",children:s.postsCount}),e[50]=s.postsCount,e[51]=y):y=e[51];let B;e[52]===Symbol.for("react.memo_cache_sentinel")?(B=(0,t.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400 font-medium",children:"Posts"}),e[52]=B):B=e[52];let _;e[53]!==y?(_=(0,t.jsxs)("button",{className:"flex gap-x-1.5 group cursor-pointer items-baseline",children:[y,B]}),e[53]=y,e[54]=_):_=e[54];let C;e[55]!==w||e[56]!==_?(C=(0,t.jsxs)("div",{className:"flex gap-4 sm:gap-6 text-sm pt-2 relative z-10",children:[w,_]}),e[55]=w,e[56]=_,e[57]=C):C=e[57];let M;e[58]!==v||e[59]!==z||e[60]!==N||e[61]!==C?(M=(0,t.jsxs)("div",{className:"space-y-1",children:[v,z,N,C]}),e[58]=v,e[59]=z,e[60]=N,e[61]=C,e[62]=M):M=e[62];let P;e[63]!==g||e[64]!==M?(P=(0,t.jsxs)("div",{className:"px-4 pb-6",children:[g,M]}),e[63]=g,e[64]=M,e[65]=P):P=e[65];let S;e[66]!==P||e[67]!==f?(S=(0,t.jsxs)("div",{className:"relative",children:[f,P]}),e[66]=P,e[67]=f,e[68]=S):S=e[68];let $;e[69]!==te||e[70]!==s.id||e[71]!==s.name||e[72]!==J||e[73]!==ee||e[74]!==W||e[75]!==T||e[76]!==Y||e[77]!==V||e[78]!==l?($=(0,t.jsx)("div",{className:"border-t border-zinc-100 dark:border-zinc-800",children:V?(0,t.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,t.jsx)(G,{className:"animate-spin text-violet-500",size:32})}):J.length>0?(0,t.jsxs)(t.Fragment,{children:[J.map(i=>(0,t.jsx)(_e,{currentUser:ee,showToast:te,...i,onClick:()=>l(`/post/${i.id}`),onUserClick:U=>l(`/u/${U}`)},i.feed_id||i.id)),W&&(0,t.jsx)("div",{className:"p-6 flex justify-center",children:(0,t.jsxs)(oe,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>Y(s.id,!0),disabled:T,children:[T&&(0,t.jsx)(G,{size:18,className:"animate-spin mr-2"}),"Load more"]})})]}):(0,t.jsxs)("div",{className:"p-20 text-center text-zinc-500 flex flex-col items-center gap-4",children:[(0,t.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full mb-2",children:(0,t.jsx)(re,{size:40,className:"text-zinc-300"})}),(0,t.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"No posts here yet"}),(0,t.jsxs)("p",{className:"text-sm max-w-[250px]",children:["Be the first to share something in ",s.name,"!"]})]})}),e[69]=te,e[70]=s.id,e[71]=s.name,e[72]=J,e[73]=ee,e[74]=W,e[75]=T,e[76]=Y,e[77]=V,e[78]=l,e[79]=$):$=e[79];let F;e[80]!==S||e[81]!==$||e[82]!==x?(F=(0,t.jsxs)("div",{className:"relative",children:[x,S,$]}),e[80]=S,e[81]=$,e[82]=x,e[83]=F):F=e[83];let I;e[84]!==se||e[85]!==s||e[86]!==H?(I=se&&(0,t.jsx)("button",{onClick:()=>H(s),className:"fixed bottom-20 right-5 md:hidden z-50 bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 size-12 rounded-full flex items-center justify-center shadow-2xl hover:scale-110 active:scale-90 transition-all cursor-pointer group",title:`Post to ${s.name}`,children:(0,t.jsx)(je,{size:28,className:"group-hover:rotate-90 transition-transform duration-300"})}),e[84]=se,e[85]=s,e[86]=H,e[87]=I):I=e[87];let R;e[88]===Symbol.for("react.memo_cache_sentinel")?(R=()=>ne(!1),e[88]=R):R=e[88];let E;e[89]!==s||e[90]!==K?(E=(0,t.jsx)(ke,{isOpen:K,onClose:R,community:s,onUpdate:Se}),e[89]=s,e[90]=K,e[91]=E):E=e[91];let Z;e[92]===Symbol.for("react.memo_cache_sentinel")?(Z=()=>ae(!1),e[92]=Z):Z=e[92];let O;e[93]!==s||e[94]!==Q?(O=(0,t.jsx)(ye,{isOpen:Q,onClose:Z,community:s}),e[93]=s,e[94]=Q,e[95]=O):O=e[95];let D;return e[96]!==F||e[97]!==I||e[98]!==E||e[99]!==O?(D=(0,t.jsxs)("div",{className:"border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen pb-20",children:[F,I,E,O]}),e[96]=F,e[97]=I,e[98]=E,e[99]=O,e[100]=D):D=e[100],D},qe=Pe;function Se(){window.location.reload()}export{qe as default};
