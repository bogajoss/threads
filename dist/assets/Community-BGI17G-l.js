import{a as xe}from"./rolldown-runtime-BaZ8gS7u.js";import{E as pe,c as je,d as ve}from"./framework-CsA6nn9m.js";import"./database-t9niRmCR.js";import{Rt as ce,Sn as K,tr as ge}from"./ui-libs-iJ4uMYcB.js";import{V as ze,a as Ne,d as ke,f as ye,h as _e,i as Ce,it as we,mt as de,nt as Me,rt as Se,u as Pe}from"./index-BB6J26uY.js";import{n as Fe}from"./post-DonDvaYL.js";import"./linkify-CDs92yJ8.js";import{c as Ie}from"./hooks-BdBygwrL.js";var Ee=je(),me=xe(pe(),1),s=xe(ve(),1),Oe=fe=>{const e=(0,Ee.c)(106),{onPostInCommunity:Q}=fe,[W,ne]=(0,me.useState)(!1),[X,oe]=(0,me.useState)(!1),{community:t,loading:he,isMember:r,userRole:be,isJoining:n,communityPosts:J,loadingPosts:Y,isFetchingMorePosts:q,hasMorePosts:Z,handleJoinToggle:ee,loadCommunityPosts:se,refetchCommunity:te,currentUser:a,addToast:ie,navigate:l}=Ie(),L=be==="admin",ae=r&&(!t?.isPrivate||L);if(he){let i;return e[0]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,s.jsx)(K,{size:40,className:"animate-spin text-violet-500"})}),e[0]=i):i=e[0],i}if(!t){let i;return e[1]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsx)("div",{className:"flex min-h-[600px] items-center justify-center overflow-hidden rounded-none bg-white dark:bg-black md:rounded-xl",children:(0,s.jsx)(ze,{title:"Community doesn't exist",message:"Try searching for another. The community could not be found.",icon:ce})}),e[1]=i):i=e[1],i}let o;e[2]!==l?(o=()=>l(-1),e[2]=l,e[3]=o):o=e[3];let B;e[4]===Symbol.for("react.memo_cache_sentinel")?(B=(0,s.jsx)(ge,{size:22}),e[4]=B):B=e[4];let c;e[5]!==o?(c=(0,s.jsx)("button",{onClick:o,className:"rounded-full p-1 transition-colors hover:bg-zinc-100 dark:text-white dark:hover:bg-zinc-800",children:B}),e[5]=o,e[6]=c):c=e[6];let d;e[7]!==t.name?(d=(0,s.jsx)("h5",{className:"text-lg font-bold leading-none dark:text-white",children:t.name}),e[7]=t.name,e[8]=d):d=e[8];let m;e[9]!==t.membersCount?(m=(0,s.jsxs)("span",{className:"mt-0.5 text-xs text-zinc-500",children:[t.membersCount," Members"]}),e[9]=t.membersCount,e[10]=m):m=e[10];let x;e[11]!==d||e[12]!==m?(x=(0,s.jsxs)("div",{className:"flex flex-col",children:[d,m]}),e[11]=d,e[12]=m,e[13]=x):x=e[13];let f;e[14]!==c||e[15]!==x?(f=(0,s.jsx)("div",{className:"sticky top-0 z-20 border-b border-zinc-100 bg-white/90 px-4 py-3 backdrop-blur-md dark:border-zinc-800 dark:bg-black/90",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4",children:[c,x]})}),e[14]=c,e[15]=x,e[16]=f):f=e[16];let h;e[17]!==t.cover?(h=(0,s.jsx)("div",{className:"relative h-32 overflow-hidden bg-zinc-100 dark:bg-zinc-900 sm:h-52",children:t.cover?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("img",{src:t.cover,className:"h-full w-full object-cover",alt:""}),(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 to-transparent"})]}):(0,s.jsx)("div",{className:"h-full w-full bg-gradient-to-br from-violet-500/20 to-fuchsia-500/20"})}),e[17]=t.cover,e[18]=h):h=e[18];let b;e[19]!==t.avatar?(b=(0,s.jsx)("div",{className:"size-24 overflow-hidden rounded-3xl border-4 border-white bg-zinc-100 shadow-xl dark:border-black dark:bg-zinc-800 sm:size-32",children:(0,s.jsx)("img",{src:t.avatar,className:"size-full object-cover",alt:""})}),e[19]=t.avatar,e[20]=b):b=e[20];let u;e[21]!==L?(u=L&&(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>ne(!0),className:"flex size-10 items-center justify-center rounded-full border border-zinc-200 text-zinc-700 transition-all hover:bg-zinc-50 active:scale-95 dark:border-zinc-800 dark:text-zinc-300 dark:hover:bg-zinc-900",title:"Edit Community",children:(0,s.jsx)(Pe,{size:20})}),(0,s.jsx)("button",{onClick:()=>oe(!0),className:"flex size-10 items-center justify-center rounded-full border border-zinc-200 text-zinc-700 transition-all hover:bg-zinc-50 active:scale-95 dark:border-zinc-800 dark:text-zinc-300 dark:hover:bg-zinc-900",title:"Settings",children:(0,s.jsx)(_e,{size:20})})]}),e[21]=L,e[22]=u):u=e[22];const le=r?"outline":"primary",re=`flex h-10 items-center justify-center gap-2 rounded-full px-4 font-bold transition-all ${r?"border-zinc-200 hover:border-rose-100 hover:bg-rose-50 hover:text-rose-500 dark:border-zinc-800 dark:hover:bg-rose-900/20":"bg-zinc-950 text-white hover:scale-105 dark:bg-white dark:text-zinc-950"}`;let p;e[23]!==n||e[24]!==r?(p=n?(0,s.jsx)(K,{size:18,className:"animate-spin"}):r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ye,{size:18}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Joined"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ke,{size:18}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Join"})]}),e[23]=n,e[24]=r,e[25]=p):p=e[25];let j;e[26]!==ee||e[27]!==n||e[28]!==le||e[29]!==re||e[30]!==p?(j=(0,s.jsx)(de,{variant:le,onClick:ee,disabled:n,className:re,children:p}),e[26]=ee,e[27]=n,e[28]=le,e[29]=re,e[30]=p,e[31]=j):j=e[31];let v;e[32]!==u||e[33]!==j?(v=(0,s.jsxs)("div",{className:"flex gap-2 pb-1",children:[u,j]}),e[32]=u,e[33]=j,e[34]=v):v=e[34];let g;e[35]!==v||e[36]!==b?(g=(0,s.jsxs)("div",{className:"relative z-10 -mt-12 mb-4 flex items-end justify-between sm:-mt-16",children:[b,v]}),e[35]=v,e[36]=b,e[37]=g):g=e[37];let z;e[38]!==t.name?(z=(0,s.jsx)("h1",{className:"text-2xl font-black leading-tight tracking-tight dark:text-white sm:text-3xl",children:t.name}),e[38]=t.name,e[39]=z):z=e[39];let N;e[40]!==t.handle?(N=(0,s.jsxs)("p",{className:"text-sm font-bold text-zinc-500 sm:text-base",children:["c/",t.handle]}),e[40]=t.handle,e[41]=N):N=e[41];let k;e[42]!==t.description?(k=t.description&&(0,s.jsx)("p",{className:"mt-4 max-w-2xl text-[15px] leading-relaxed dark:text-zinc-300 sm:text-base",children:t.description}),e[42]=t.description,e[43]=k):k=e[43];let y;e[44]!==t.membersCount?(y=(0,s.jsx)("span",{className:"text-base font-extrabold text-zinc-900 transition-colors dark:text-white",children:t.membersCount}),e[44]=t.membersCount,e[45]=y):y=e[45];let R;e[46]===Symbol.for("react.memo_cache_sentinel")?(R=(0,s.jsx)("span",{className:"font-medium text-zinc-500 dark:text-zinc-400",children:"Members"}),e[46]=R):R=e[46];let _;e[47]!==y?(_=(0,s.jsxs)("button",{className:"group flex cursor-pointer items-baseline gap-x-1.5",children:[y,R]}),e[47]=y,e[48]=_):_=e[48];let C;e[49]!==t.postsCount?(C=(0,s.jsx)("span",{className:"text-base font-extrabold text-zinc-900 transition-colors dark:text-white",children:t.postsCount}),e[49]=t.postsCount,e[50]=C):C=e[50];let V;e[51]===Symbol.for("react.memo_cache_sentinel")?(V=(0,s.jsx)("span",{className:"font-medium text-zinc-500 dark:text-zinc-400",children:"Posts"}),e[51]=V):V=e[51];let w;e[52]!==C?(w=(0,s.jsxs)("button",{className:"group flex cursor-pointer items-baseline gap-x-1.5",children:[C,V]}),e[52]=C,e[53]=w):w=e[53];let M;e[54]!==_||e[55]!==w?(M=(0,s.jsxs)("div",{className:"relative z-10 flex gap-4 pt-2 text-sm sm:gap-6",children:[_,w]}),e[54]=_,e[55]=w,e[56]=M):M=e[56];let S;e[57]!==z||e[58]!==N||e[59]!==k||e[60]!==M?(S=(0,s.jsxs)("div",{className:"space-y-1",children:[z,N,k,M]}),e[57]=z,e[58]=N,e[59]=k,e[60]=M,e[61]=S):S=e[61];let P;e[62]!==g||e[63]!==S?(P=(0,s.jsxs)("div",{className:"px-4 pb-6",children:[g,S]}),e[62]=g,e[63]=S,e[64]=P):P=e[64];let F;e[65]!==P||e[66]!==h?(F=(0,s.jsxs)("div",{className:"relative",children:[h,P]}),e[65]=P,e[66]=h,e[67]=F):F=e[67];let I;e[68]!==ae||e[69]!==t||e[70]!==a?.avatar||e[71]!==a?.handle||e[72]!==Q?(I=ae&&(0,s.jsx)("div",{className:"border-b border-zinc-100 p-4 dark:border-zinc-800",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)(Me,{className:"size-10 border border-zinc-200 dark:border-zinc-800",children:[(0,s.jsx)(we,{src:a?.avatar,alt:a?.handle,className:"object-cover"}),(0,s.jsx)(Se,{children:a?.handle?.[0]?.toUpperCase()})]}),(0,s.jsxs)("button",{onClick:()=>Q(t),className:"flex-1 rounded-2xl bg-zinc-100 px-5 py-3 text-left text-[15px] font-medium text-zinc-500 transition-all hover:bg-zinc-200/70 dark:bg-zinc-900/50 dark:hover:bg-zinc-900",children:["Share something in ",t.name,"..."]})]})}),e[68]=ae,e[69]=t,e[70]=a?.avatar,e[71]=a?.handle,e[72]=Q,e[73]=I):I=e[73];let E;e[74]!==ie||e[75]!==t.name||e[76]!==J||e[77]!==a||e[78]!==Z||e[79]!==q||e[80]!==se||e[81]!==Y||e[82]!==l?(E=Y?(0,s.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,s.jsx)(K,{className:"animate-spin text-violet-500",size:32})}):J.length>0?(0,s.jsxs)(s.Fragment,{children:[J.map(i=>(0,s.jsx)(Fe,{currentUser:a,showToast:ie,...i,onClick:()=>l(`/post/${i.id}`),onUserClick:ue=>l(`/u/${ue}`)},i.feed_id||i.id)),Z&&(0,s.jsx)("div",{className:"flex justify-center p-6",children:(0,s.jsxs)(de,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>se(),disabled:q,children:[q&&(0,s.jsx)(K,{size:18,className:"mr-2 animate-spin"}),"Load more"]})})]}):(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4 p-20 text-center text-zinc-500",children:[(0,s.jsx)("div",{className:"mb-2 rounded-full bg-zinc-50 p-6 dark:bg-zinc-900",children:(0,s.jsx)(ce,{size:40,className:"text-zinc-300"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"No posts here yet"}),(0,s.jsxs)("p",{className:"text-sm max-w-[250px]",children:["Be the first to share something in ",t.name,"!"]})]}),e[74]=ie,e[75]=t.name,e[76]=J,e[77]=a,e[78]=Z,e[79]=q,e[80]=se,e[81]=Y,e[82]=l,e[83]=E):E=e[83];let O;e[84]!==I||e[85]!==E?(O=(0,s.jsxs)("div",{className:"border-t border-zinc-100 dark:border-zinc-800",children:[I,E]}),e[84]=I,e[85]=E,e[86]=O):O=e[86];let $;e[87]!==F||e[88]!==O||e[89]!==f?($=(0,s.jsxs)("div",{className:"relative",children:[f,F,O]}),e[87]=F,e[88]=O,e[89]=f,e[90]=$):$=e[90];let D;e[91]===Symbol.for("react.memo_cache_sentinel")?(D=()=>ne(!1),e[91]=D):D=e[91];let A;e[92]!==te?(A=()=>{te()},e[92]=te,e[93]=A):A=e[93];let T;e[94]!==t||e[95]!==W||e[96]!==A?(T=(0,s.jsx)(Ne,{isOpen:W,onClose:D,community:t,onUpdate:A}),e[94]=t,e[95]=W,e[96]=A,e[97]=T):T=e[97];let G;e[98]===Symbol.for("react.memo_cache_sentinel")?(G=()=>oe(!1),e[98]=G):G=e[98];let U;e[99]!==t||e[100]!==X?(U=(0,s.jsx)(Ce,{isOpen:X,onClose:G,community:t}),e[99]=t,e[100]=X,e[101]=U):U=e[101];let H;return e[102]!==$||e[103]!==T||e[104]!==U?(H=(0,s.jsxs)("div",{className:"min-h-screen overflow-hidden rounded-none border-zinc-100 bg-white pb-20 dark:border-zinc-800 dark:bg-black md:rounded-xl",children:[$,T,U]}),e[102]=$,e[103]=T,e[104]=U,e[105]=H):H=e[105],H},Re=Oe;export{Re as default};
