import{n as kt}from"./rolldown-runtime-2JzG8er9.js";import{$ as hs,A as ps,At as _t,B as bs,Bt as gs,C as vs,Cn as ue,Ct,D as js,Dn as Ge,Dt as St,E as ys,En as _e,Et as Ze,F as ws,Ft as zs,G as Ns,Gt as ks,H as _s,Ht as Cs,I as Ss,It as $t,J as xe,Jt as Pt,K as $s,Kt as Ke,L as Ps,Lt,M as Ls,Mt as Ms,N as Is,Nt as Mt,O as Fs,On as Rs,Ot as Ue,P as Ts,Pt as It,Q as Os,Qt as Es,R as As,Rt as qs,S as Ds,Sn as Bs,St as Ws,T as Qs,Tn as qe,Tt as Ks,U as Vs,Ut as ct,V as Hs,Vt as Xe,W as Us,Wt as Ye,X as Ft,Xt as Js,Y as Gs,Yt as ge,Z as Zs,Zt as Fe,_ as Rt,_t as De,a as Xs,at as Tt,b as Ys,bn as Ot,bt as ea,c as ta,ct as Ne,d as sa,dt as aa,et as Et,f as ia,ft as ra,g as na,gt as et,h as la,ht as Je,i as oa,it as ca,j as da,jt as ma,k as ua,kn as fa,kt as xa,l as ha,lt as At,m as pa,mt as ba,n as ga,nt as qt,o as va,ot as ja,p as ya,pt as wa,q as Dt,qt as Q,r as za,rt as Na,s as ka,st as Ve,t as ze,tt as _a,u as Ca,ut as Sa,v as $a,vn as Pa,vt as oe,w as La,wn as Ma,wt as Ie,x as Ia,xn as dt,xt as Fa,y as Ra,yn as Ta,yt as Bt,z as Oa,zt as Ea}from"./framework-CtdM40cY.js";import{t as Aa}from"./query-PTvOV65x.js";import{t as qa}from"./database-DCcU4ujN.js";import{n as Da,r as Ba,t as Wa}from"./vendor-DyYlx6SC.js";/* empty css                 */(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function a(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=a(r);fetch(r.href,n)}})();var Qa=Rs(),w=kt(fa(),1),Ka="https://dbkcedktqhueqnulnosq.supabase.co",Va="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRia2NlZGt0cWh1ZXFudWxub3NxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg5NzE1NTQsImV4cCI6MjA4NDU0NzU1NH0.m_Tv-H7o5mL1Nac6TH-S1JkS1x7ZN1AK_4Mt1hZlkvU";const B=qa(Ka,Va),Ce=t=>t?{id:t.id,handle:t.username,name:t.display_name,avatar:t.avatar_url||"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm",cover:t.cover_url||"https://systemadminbd.com/uploads/675346dd55e0c7.43939630.png",verified:t.is_verified,bio:t.bio,location:t.location,website:t.website,follower_count:t.follower_count||0,following_count:t.following_count||0,lastSeen:t.last_seen_at}:null,Re=t=>t?{...t,stats:{comments:t.comments_count||0,likes:t.likes_count||0,mirrors:t.mirrors_count||0},user:Ce(t.user),timeAgo:new Date(t.created_at).toLocaleDateString()}:null,Ha=t=>t?{...t,user:t.actor?.username,avatar:t.actor?.avatar_url||"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm"}:null,Wt=t=>t?{...t,media:t.media_url,user:Ce(t.user)}:null,Ua=async(t,e={})=>{if(!t.type.startsWith("image/"))return t;const a={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0,initialQuality:.8,fileType:"image/webp",...e};try{const i=await Ba(t,a);return console.log(`Original size: ${(t.size/1024/1024).toFixed(2)} MB`),console.log(`Compressed size: ${(i.size/1024/1024).toFixed(2)} MB`),i}catch(i){return console.error("Image compression failed:",i),t}},Ja=(t,e=1)=>new Promise((a,i)=>{const r=document.createElement("video");r.preload="metadata",r.src=URL.createObjectURL(t),r.muted=!0,r.playsInline=!0,r.onloadedmetadata=()=>{r.currentTime=e},r.onseeked=()=>{const n=document.createElement("canvas");n.width=r.videoWidth,n.height=r.videoHeight,n.getContext("2d").drawImage(r,0,0,n.width,n.height),n.toBlob(l=>{const o=new File([l],"thumbnail.webp",{type:"image/webp"});URL.revokeObjectURL(r.src),a(o)},"image/webp",.7)},r.onerror=n=>i(n)}),ke=async(t,e="media",a=null)=>{let i=t,r=t.name.split(".").pop(),n=null;if(t.type.startsWith("image/")&&(i=await Ua(t),r="webp"),t.type.startsWith("video/"))try{a?n=(await ke(a,e)).url:n=(await ke(await Ja(t),e)).url}catch(u){console.error("Failed to handle video poster:",u)}const l=`${`${Math.random()}-${Date.now()}.${r}`}`,{data:o,error:c}=await B.storage.from(e).upload(l,i);if(c)throw c;const{data:{publicUrl:d}}=B.storage.from(e).getPublicUrl(o.path);return{url:d,poster:n,name:t.name,type:t.type.startsWith("image/")?"image":t.type.startsWith("video/")?"video":"file",size:i.size}},Ga=async(t=null,e=10)=>{let a=B.from("posts").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified,
                bio,
                location,
                website,
                follower_count,
                following_count
            )
        `).order("created_at",{ascending:!1}).limit(e);t&&(a=a.lt("created_at",t));const{data:i,error:r}=await a;if(r)throw r;return i.map(Re)},Za=async t=>{const{data:e,error:a}=await B.from("posts").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified,
                bio,
                location,
                website,
                follower_count,
                following_count
            )
        `).eq("id",t).single();if(a)throw a;return Re(e)},Xa=async({content:t,media:e=[],type:a="text",userId:i,poll:r=null,parentId:n=null})=>{const{data:l,error:o}=await B.from("posts").insert([{user_id:i,content:t,media:e,type:a,poll:r,parent_id:n,created_at:new Date().toISOString()}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `);if(o)throw o;return Re(l[0])},Ya=async t=>{const{error:e}=await B.from("posts").delete().eq("id",t);if(e)throw e},ei=async(t,e)=>{const{error:a}=await B.from("posts").update(e).eq("id",t);if(a)throw a},ti=async t=>{const{data:e,error:a}=await B.from("users").select("*").or(`username.ilike.%${t}%,display_name.ilike.%${t}%`).limit(5);if(a)throw a;return e.map(Ce)},Qt=async(t,e)=>{const{data:a}=await B.from("conversation_participants").select("conversation_id").eq("user_id",t),i=a.map(o=>o.conversation_id),{data:r}=await B.from("conversation_participants").select("conversation_id").eq("user_id",e).in("conversation_id",i).maybeSingle();if(r)return r.conversation_id;const{data:n,error:l}=await B.from("conversations").insert([{}]).select().single();if(l)throw l;return await B.from("conversation_participants").insert([{conversation_id:n.id,user_id:t},{conversation_id:n.id,user_id:e}]),n.id},si=async()=>{const{data:t,error:e}=await B.from("users").select("*");if(e)throw e;return t.reduce((a,i)=>{const r=Ce(i);return a[r.handle]=r,a},{})},ai=async t=>{const{data:e,error:a}=await B.from("users").select("*").eq("username",t).maybeSingle();if(a)throw a;return Ce(e)},ii=async(t,e)=>{const{error:a}=await B.from("users").update({display_name:e.name,username:e.handle,avatar_url:e.avatar,bio:e.bio,cover_url:e.cover,website:e.website,location:e.location}).eq("id",t);if(a)throw a},ri=async t=>{if(!t)return[];const{data:e,error:a}=await B.from("notifications").select(`
            *,
            actor:users!actor_id (
                username,
                avatar_url
            )
        `).eq("recipient_id",t).order("created_at",{ascending:!1});if(a)throw a;return e.map(Ha)},ni=async t=>{const{error:e}=await B.from("notifications").update({is_read:!0}).eq("recipient_id",t).eq("is_read",!1);if(e)throw e},li=async t=>{if(!t)return 0;const{count:e,error:a}=await B.from("notifications").select("*",{count:"exact",head:!0}).eq("recipient_id",t).eq("is_read",!1);if(a)throw a;return e||0},oi=async t=>{if(!t)return 0;const{count:e,error:a}=await B.from("messages").select("*",{count:"exact",head:!0}).eq("is_read",!1).neq("sender_id",t).in("conversation_id",(await B.from("conversation_participants").select("conversation_id").eq("user_id",t)).data?.map(i=>i.conversation_id)||[]);if(a)throw a;return e||0},ci=async(t,e)=>{if(!t||!e)return;const{error:a}=await B.from("messages").update({is_read:!0}).eq("conversation_id",t).neq("sender_id",e).eq("is_read",!1);if(a)throw a},di=async t=>{if(!t)return[];const{data:e,error:a}=await B.from("conversation_participants").select(`
            conversation:conversations (
                id,
                last_message_at,
                last_message_content,
                participants:conversation_participants (
                    user:users (
                        id,
                        username,
                        display_name,
                        avatar_url
                    )
                ),
                messages (
                    id,
                    is_read,
                    sender_id
                )
            )
        `).eq("user_id",t);if(a)throw console.error("Supabase Error in fetchConversations:",a.message),a;return e.map(i=>{const r=i.conversation,n=r.participants.find(o=>o.user?.id!==t)||r.participants[0],l=r.messages?.filter(o=>!o.is_read&&o.sender_id!==t).length||0;return{id:r.id,user:Ce(n?.user),lastMessage:r.last_message_content||"No messages yet",time:r.last_message_at?new Date(r.last_message_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",unread:l}})},mi=async t=>{const{data:e,error:a}=await B.from("messages").select("*").eq("conversation_id",t).order("created_at",{ascending:!0});if(a)throw a;return e},ui=async(t,e,a)=>{const{data:i}=await B.from("message_reactions").select("*").eq("message_id",t).eq("user_id",e).maybeSingle();return i?i.emoji===a?(await B.from("message_reactions").delete().eq("id",i.id),{action:"removed",emoji:a}):(await B.from("message_reactions").update({emoji:a}).eq("id",i.id),{action:"updated",emoji:a}):(await B.from("message_reactions").insert([{message_id:t,user_id:e,emoji:a}]),{action:"added",emoji:a})},fi=async(t,e,a,i="text",r=[],n=null)=>{const{data:l,error:o}=await B.from("messages").insert([{conversation_id:t,sender_id:e,content:a,type:i,media:r,reply_to_id:n}]).select();if(o)throw o;return l[0]},xi=async t=>{const{error:e}=await B.from("messages").delete().eq("id",t);if(e)throw e},hi=async t=>{const{data:e,error:a}=await B.from("posts").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `).eq("parent_id",t).order("created_at",{ascending:!0});if(a)throw a;return e.map(Re)},pi=async(t,e,a)=>{const{data:i,error:r}=await B.from("posts").insert([{parent_id:t,user_id:e,content:a,type:"text",created_at:new Date().toISOString()}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `);if(r)throw r;return Re(i[0])},bi=async(t,e)=>{const{data:a}=await B.from("likes").select("*").eq("post_id",t).eq("user_id",e).maybeSingle();return a?(await B.from("likes").delete().eq("post_id",t).eq("user_id",e),!1):(await B.from("likes").insert([{post_id:t,user_id:e}]),!0)},gi=async(t,e)=>{if(!e)return!1;const{data:a}=await B.from("likes").select("*").eq("post_id",t).eq("user_id",e).maybeSingle();return!!a},vi=async(t,e)=>{const{data:a}=await B.from("follows").select("*").eq("follower_id",t).eq("following_id",e).maybeSingle();return a?(await B.from("follows").delete().eq("follower_id",t).eq("following_id",e),!1):(await B.from("follows").insert([{follower_id:t,following_id:e}]),!0)},ji=async(t,e)=>{if(!t)return!1;const{data:a}=await B.from("follows").select("*").eq("follower_id",t).eq("following_id",e).maybeSingle();return!!a},yi=async t=>{const{data:e,error:a}=await B.from("users").select("follower_count, following_count").eq("id",t).maybeSingle();return a||!e?{followers:0,following:0}:{followers:e.follower_count||0,following:e.following_count||0}},wi=async()=>{const{data:t,error:e}=await B.from("stories").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `).gt("expires_at",new Date().toISOString()).order("created_at",{ascending:!1});if(e)throw e;return t.map(Wt)},zi=async(t,e,a="image")=>{const{data:i,error:r}=await B.from("stories").insert([{user_id:t,media_url:e,type:a,expires_at:new Date(Date.now()+864e5).toISOString()}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `);if(r)throw r;return Wt(i[0])},Ni=[{tag:"Lens",posts:"0"},{tag:"Web3",posts:"0"},{tag:"Art",posts:"0"}];var s=kt(Es(),1),Kt=(0,w.createContext)();const ki=({children:t})=>{const[e,a]=(0,w.useState)(null),[i,r]=(0,w.useState)(null),[n,l]=(0,w.useState)({}),[o,c]=(0,w.useState)(!0),d=async b=>{try{const{data:h,error:g}=await B.from("users").select("*").eq("id",b.id).maybeSingle();if(g)throw g;if(h){const v=Ce(h);a(v),l(z=>({...z,[v.handle]:v}))}else a({id:b.id,email:b.email,name:b.email.split("@")[0],handle:b.email.split("@")[0],avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm",verified:!1})}catch(h){console.error("Error fetching user profile:",h)}finally{c(!1)}};(0,w.useEffect)(()=>{if(!e?.id)return;const b=async()=>{await B.from("users").update({last_seen_at:new Date().toISOString()}).eq("id",e.id)};b();const h=setInterval(b,3e4),g=()=>{document.visibilityState==="visible"&&b()};return window.addEventListener("visibilitychange",g),window.addEventListener("beforeunload",b),()=>{clearInterval(h),window.removeEventListener("visibilitychange",g),window.removeEventListener("beforeunload",b)}},[e?.id]),(0,w.useEffect)(()=>{B.auth.getSession().then(({data:{session:h}})=>{h?d(h.user):c(!1)});const{data:{subscription:b}}=B.auth.onAuthStateChange((h,g)=>{g?d(g.user):(a(null),c(!1))});return()=>b.unsubscribe()},[]);const u=async({email:b,password:h})=>{const{data:g,error:v}=await B.auth.signInWithPassword({email:b,password:h});if(v)throw v;return r(null),g},m=async({email:b,password:h,username:g,name:v})=>{const{data:{user:z},error:_}=await B.auth.signUp({email:b,password:h,options:{data:{username:g.toLowerCase(),name:v}}});if(_)throw _;return r(null),z},f=async()=>{await B.auth.signOut(),a(null),r(null)},x=async b=>{e&&(await ii(e.id,b),await d(e))},p=async b=>{if(n[b])return n[b];const h=await ai(b);return h?(l(g=>({...g,[b]:h})),h):null};return(0,s.jsx)(Kt.Provider,{value:{currentUser:e,authMode:i,setAuthMode:r,profiles:n,login:u,signup:m,logout:f,updateProfile:x,getProfileByHandle:p,loading:o},children:!o&&t})},ce=()=>{const t=(0,w.useContext)(Kt);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t};var _i=Q(),Vt=(0,w.createContext)();const Ci=t=>{const e=(0,_i.c)(10),{children:a}=t,{currentUser:i}=ce();let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=new Set,e[0]=r):r=e[0];const[n,l]=(0,w.useState)(r);let o;e[1]!==i?(o=()=>{if(!i?.id)return;const f=B.channel("global_presence",{config:{presence:{key:i.id}}});return f.on("presence",{event:"sync"},()=>{const x=f.presenceState(),p=new Set;Object.keys(x).forEach(b=>p.add(b)),l(p)}).subscribe(async x=>{x==="SUBSCRIBED"&&await f.track({userId:i.id,online_at:new Date().toISOString()})}),()=>{B.removeChannel(f),l(new Set)}},e[1]=i,e[2]=o):o=e[2];const c=i?.id;let d;e[3]!==c?(d=[c],e[3]=c,e[4]=d):d=e[4],(0,w.useEffect)(o,d);let u;e[5]!==n?(u={onlineUsers:n},e[5]=n,e[6]=u):u=e[6];let m;return e[7]!==a||e[8]!==u?(m=(0,s.jsx)(Vt.Provider,{value:u,children:a}),e[7]=a,e[8]=u,e[9]=m):m=e[9],m},Ht=()=>{const t=(0,w.useContext)(Vt);if(!t)throw new Error("usePresence must be used within a PresenceProvider");return t};var Si=Q(),Ut=(0,w.createContext)();const $i=t=>{const e=(0,Si.c)(11),{children:a}=t,[i,r]=(0,w.useState)(Pi);let n,l;e[0]!==i?(n=()=>{localStorage.setItem("theme",i?"dark":"light"),i?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},l=[i],e[0]=i,e[1]=n,e[2]=l):(n=e[1],l=e[2]),(0,w.useEffect)(n,l);let o;e[3]!==i?(o=()=>r(!i),e[3]=i,e[4]=o):o=e[4];const c=o;let d;e[5]!==i||e[6]!==c?(d={darkMode:i,setDarkMode:r,toggleDarkMode:c},e[5]=i,e[6]=c,e[7]=d):d=e[7];let u;return e[8]!==a||e[9]!==d?(u=(0,s.jsx)(Ut.Provider,{value:d,children:a}),e[8]=a,e[9]=d,e[10]=u):u=e[10],u},tt=()=>{const t=(0,w.useContext)(Ut);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t};function Pi(){const t=localStorage.getItem("theme");return t==="dark"||!t&&window.matchMedia("(prefers-color-scheme: dark)").matches}var Li=Q(),Mi=t=>{const e=(0,Li.c)(7);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];const{theme:i}=$s(),r=i===void 0?"system":i;let n,l;e[2]===Symbol.for("react.memo_cache_sentinel")?(n={success:(0,s.jsx)(It,{className:"size-4"}),info:(0,s.jsx)(Fa,{className:"size-4"}),warning:(0,s.jsx)(Os,{className:"size-4"}),error:(0,s.jsx)(aa,{className:"size-4"}),loading:(0,s.jsx)(oe,{className:"size-4 animate-spin"})},l={"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)","--border-radius":"var(--radius)"},e[2]=n,e[3]=l):(n=e[2],l=e[3]);let o;return e[4]!==a||e[5]!==r?(o=(0,s.jsx)(ks,{theme:r,className:"toaster group",icons:n,style:l,...a}),e[4]=a,e[5]=r,e[6]=o):o=e[6],o},Ii=Q(),Jt=(0,w.createContext)();const Fi=t=>{const e=(0,Ii.c)(4),{children:a}=t,i=Ri;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r={addToast:i},e[0]=r):r=e[0];let n;e[1]===Symbol.for("react.memo_cache_sentinel")?(n=(0,s.jsx)(Mi,{position:"bottom-center",toastOptions:{className:"rounded-full font-bold"}}),e[1]=n):n=e[1];let l;return e[2]!==a?(l=(0,s.jsxs)(Jt.Provider,{value:r,children:[a,n]}),e[2]=a,e[3]=l):l=e[3],l},ye=()=>{const t=(0,w.useContext)(Jt);if(!t)throw new Error("useToast must be used within a ToastProvider");return t};function Ri(t,e){const a=e===void 0?"success":e;a==="error"?Ke.error(t):a==="info"?Ke.info(t):Ke.success(t)}var Gt=(0,w.createContext)();const Ti=({children:t})=>{const[e,a]=(0,w.useState)([]),[i,r]=(0,w.useState)(!0),[n,l]=(0,w.useState)(!0),[o,c]=(0,w.useState)(!1),d=async(h=!1)=>{h?c(!0):r(!0);try{const g=await Ga(h&&e.length>0?e[e.length-1].created_at:null,10);g.length<10?l(!1):l(!0),a(h?v=>[...v,...g]:g)}catch(g){console.error("Failed to load posts:",g)}finally{r(!1),c(!1)}},u=()=>{!n||o||d(!0)};(0,w.useEffect)(()=>{d()},[]);const m=async h=>{const g=await Xa(h);return d(),g},f=async h=>{await Ya(h),a(g=>g.filter(v=>v.id!==h))},x=async(h,g)=>{await ei(h,g),a(v=>v.map(z=>z.id===h?{...z,...g}:z))},p=h=>e.find(g=>g.id===h),b=(h,g="feed")=>{let v=e.filter(z=>!!(z.user?.handle===h||z.repostedBy&&z.repostedBy.handle===h));return g==="feed"?v.filter(z=>z.parent_id===null):g==="media"?v.filter(z=>z.parent_id===null&&(z.type==="video"||z.type==="image"||z.media?.length>0)):g==="replies"?v.filter(z=>z.parent_id!==null):v};return(0,s.jsx)(Gt.Provider,{value:{posts:e,setPosts:a,addPost:m,deletePost:f,updatePost:x,getPostById:p,getUserPosts:b,loading:i,hasMore:n,isFetchingNextPage:o,fetchNextPage:u,refreshPosts:()=>d(!1)},children:t})},Pe=()=>{const t=(0,w.useContext)(Gt);if(!t)throw new Error("usePosts must be used within a PostProvider");return t};var Oi=Q(),Zt=(0,w.createContext)();const Ei=t=>{const e=(0,Oi.c)(9),{children:a}=t;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i={isOpen:!1,images:[],currentIndex:0},e[0]=i):i=e[0];const[r,n]=(0,w.useState)(i);let l;e[1]===Symbol.for("react.memo_cache_sentinel")?(l=(p,b)=>{const h=b===void 0?0:b;n({isOpen:!0,images:Array.isArray(p)?p:[p],currentIndex:h})},e[1]=l):l=e[1];const o=l;let c;e[2]===Symbol.for("react.memo_cache_sentinel")?(c=()=>{n(Ai)},e[2]=c):c=e[2];const d=c;let u;e[3]===Symbol.for("react.memo_cache_sentinel")?(u=p=>{n(b=>({...b,currentIndex:p}))},e[3]=u):u=e[3];const m=u;let f;e[4]!==r?(f={...r,openLightbox:o,closeLightbox:d,setIndex:m},e[4]=r,e[5]=f):f=e[5];let x;return e[6]!==a||e[7]!==f?(x=(0,s.jsx)(Zt.Provider,{value:f,children:a}),e[6]=a,e[7]=f,e[8]=x):x=e[8],x},st=()=>{const t=(0,w.useContext)(Zt);if(!t)throw new Error("useLightbox must be used within a LightboxProvider");return t};function Ai(t){return{...t,isOpen:!1}}var qi=Q();const Xt=t=>{const e=(0,qi.c)(16),a=Fe(),i=t?.id;let r;e[0]!==i?(r=["unread_notifications_count",i],e[0]=i,e[1]=r):r=e[1];let n;e[2]!==t?.id?(n=()=>li(t?.id),e[2]=t?.id,e[3]=n):n=e[3];const l=!!t?.id;let o;e[4]!==r||e[5]!==n||e[6]!==l?(o={queryKey:r,queryFn:n,enabled:l},e[4]=r,e[5]=n,e[6]=l,e[7]=o):o=e[7];const{data:c}=ge(o),d=c===void 0?0:c;let u;e[8]!==t||e[9]!==a?(u=()=>{if(!t?.id)return;const p=B.channel(`unread_count:${t.id}`).on("postgres_changes",{event:"*",schema:"public",table:"notifications",filter:`recipient_id=eq.${t.id}`},()=>{a.invalidateQueries({queryKey:["unread_notifications_count",t.id]}),a.invalidateQueries({queryKey:["notifications",t.id]})}).subscribe();return()=>B.removeChannel(p)},e[8]=t,e[9]=a,e[10]=u):u=e[10];const m=t?.id;let f;e[11]!==a||e[12]!==m?(f=[m,a],e[11]=a,e[12]=m,e[13]=f):f=e[13],(0,w.useEffect)(u,f);let x;return e[14]!==d?(x={unreadCount:d},e[14]=d,e[15]=x):x=e[15],x};var Di=Q();const at=t=>{const e=(0,Di.c)(65),a=Fe();let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i={},e[0]=i):i=e[0];const[r,n]=(0,w.useState)(i),l=(0,w.useRef)(null),o=t?.id;let c;e[1]!==o?(c=["conversations",o],e[1]=o,e[2]=c):c=e[2];let d;e[3]!==t?.id?(d=()=>di(t?.id),e[3]=t?.id,e[4]=d):d=e[4];const u=!!t?.id;let m;e[5]!==c||e[6]!==d||e[7]!==u?(m={queryKey:c,queryFn:d,enabled:u},e[5]=c,e[6]=d,e[7]=u,e[8]=m):m=e[8];const{data:f,isLoading:x}=ge(m);let p;e[9]!==f?(p=f===void 0?[]:f,e[9]=f,e[10]=p):p=e[10];const b=p,h=t?.id;let g;e[11]!==h?(g=["unread_messages_count",h],e[11]=h,e[12]=g):g=e[12];let v;e[13]!==t?.id?(v=()=>oi(t?.id),e[13]=t?.id,e[14]=v):v=e[14];const z=!!t?.id;let _;e[15]!==v||e[16]!==z||e[17]!==g?(_={queryKey:g,queryFn:v,enabled:z},e[15]=v,e[16]=z,e[17]=g,e[18]=_):_=e[18];const{data:y}=ge(_),k=y===void 0?0:y,$=Bi;let S;e[19]===Symbol.for("react.memo_cache_sentinel")?(S=["reactions"],e[19]=S):S=e[19];const L=!!t?.id;let C;e[20]!==L?(C={queryKey:S,queryFn:$,enabled:L},e[20]=L,e[21]=C):C=e[21];const{data:M}=ge(C);let I;e[22]!==M?(I=M===void 0?[]:M,e[22]=M,e[23]=I):I=e[23];const O=I;let T;e[24]!==t||e[25]!==a?(T=()=>{if(!t?.id)return;const Z=B.channel(`user_messages:${t.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},ae=>{const D=ae.new;a.setQueryData(["messages",D.conversation_id],R=>R?R.find(ee=>ee.id===D.id)?R:[...R,D]:[D]),D.sender_id!==t.id&&a.invalidateQueries({queryKey:["unread_messages_count",t.id]}),a.invalidateQueries(["conversations",t.id]),n(R=>({...R,[D.conversation_id]:!1}))}).on("postgres_changes",{event:"DELETE",schema:"public",table:"messages"},ae=>{a.invalidateQueries({queryKey:["messages"]}),a.invalidateQueries({queryKey:["conversations",t.id]})}).on("postgres_changes",{event:"*",schema:"public",table:"message_reactions"},()=>{a.invalidateQueries({queryKey:["reactions"]})}).subscribe(),X=B.channel("chat_typing_shared").on("broadcast",{event:"typing"},ae=>{const{payload:D}=ae,{conversationId:R,isTyping:ee,userId:de}=D;de!==t.id&&n(ve=>({...ve,[R]:ee}))}).subscribe();return l.current=X,()=>{B.removeChannel(Z),B.removeChannel(X)}},e[24]=t,e[25]=a,e[26]=T):T=e[26];const W=t?.id;let q;e[27]!==a||e[28]!==W?(q=[W,a],e[27]=a,e[28]=W,e[29]=q):q=e[29],(0,w.useEffect)(T,q);let E;e[30]!==t?(E=Z=>{const{convId:X,text:ae,type:D,media:R,replyToId:ee}=Z,de=D===void 0?"text":D,ve=R===void 0?[]:R,Qe=ee===void 0?null:ee;return fi(X,t.id,ae,de,ve,Qe)},e[30]=t,e[31]=E):E=e[31];let j;e[32]!==t||e[33]!==a?(j=Z=>{a.setQueryData(["messages",Z.conversation_id],X=>X?X.find(ae=>ae.id===Z.id)?X:[...X,Z]:[Z]),a.invalidateQueries(["conversations",t.id])},e[32]=t,e[33]=a,e[34]=j):j=e[34];let N;e[35]!==E||e[36]!==j?(N={mutationFn:E,onSuccess:j},e[35]=E,e[36]=j,e[37]=N):N=e[37];const F=Pt(N);let P;e[38]!==t?(P=(Z,X)=>{l.current&&l.current.send({type:"broadcast",event:"typing",payload:{conversationId:Z,isTyping:X,userId:t.id}})},e[38]=t,e[39]=P):P=e[39];const A=P;let K;e[40]!==t||e[41]!==a?(K=async Z=>{!t?.id||!Z||(await ci(Z,t.id),a.invalidateQueries({queryKey:["unread_messages_count",t.id]}),a.invalidateQueries({queryKey:["conversations",t.id]}))},e[40]=t,e[41]=a,e[42]=K):K=e[42];const H=K;let V;e[43]!==t||e[44]!==a?(V=async(Z,X)=>{if(t?.id)try{await ui(Z,t.id,X),a.invalidateQueries({queryKey:["reactions"]})}catch(ae){console.error("Failed to toggle reaction:",ae)}},e[43]=t,e[44]=a,e[45]=V):V=e[45];const U=V;let G;e[46]!==a?(G=async Z=>{try{await xi(Z),a.invalidateQueries({queryKey:["messages"]})}catch(X){console.error("Failed to delete message:",X)}},e[46]=a,e[47]=G):G=e[47];const te=G;let se;e[48]!==t?.id?(se=(Z,X)=>{const ae=Z===void 0?[]:Z,D=X===void 0?[]:X;return ae.map(R=>({id:R.id,sender:R.sender_id===t?.id?"me":"them",text:R.content,type:R.type||"text",media:R.media||[],isRead:R.is_read,replyToId:R.reply_to_id,reactions:D.filter(ee=>ee.message_id===R.id),time:new Date(R.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}))},e[48]=t?.id,e[49]=se):se=e[49];const ie=se;let Y;e[50]!==F?(Y=(Z,X,ae,D,R)=>F.mutate({convId:Z,text:X,type:ae,media:D,replyToId:R}),e[50]=F,e[51]=Y):Y=e[51];let me;return e[52]!==O||e[53]!==b||e[54]!==ie||e[55]!==x||e[56]!==H||e[57]!==te||e[58]!==U||e[59]!==F.isPending||e[60]!==A||e[61]!==Y||e[62]!==r||e[63]!==k?(me={conversations:b,unreadCount:k,isConvLoading:x,sendMessage:Y,sendTypingStatus:A,typingStatus:r,markAsRead:H,formatMessages:ie,onToggleReaction:U,onDeleteMessage:te,allReactions:O,isSending:F.isPending},e[52]=O,e[53]=b,e[54]=ie,e[55]=x,e[56]=H,e[57]=te,e[58]=U,e[59]=F.isPending,e[60]=A,e[61]=Y,e[62]=r,e[63]=k,e[64]=me):me=e[64],me};async function Bi(){const{data:t}=await B.from("message_reactions").select("*");return t||[]}var Wi=Q(),Qi=t=>{const e=(0,Wi.c)(18),{onPostClick:a}=t,{currentUser:i}=ce(),{unreadCount:r}=Xt(i),{unreadCount:n}=at(i);let l,o,c,d,u;e[0]===Symbol.for("react.memo_cache_sentinel")?(l={id:"home",icon:Ct,path:"/"},o={id:"explore",icon:Mt,path:"/explore"},c={id:"reels",icon:Ze,path:"/reels"},d={id:"messages",icon:De,path:"/messages"},u={id:"notifications",icon:Xe,path:"/notifications"},e[0]=l,e[1]=o,e[2]=c,e[3]=d,e[4]=u):(l=e[0],o=e[1],c=e[2],d=e[3],u=e[4]);const m=i?`/u/${i.handle}`:"/explore";let f;e[5]!==m?(f=[l,o,c,d,u,{id:"profile",icon:Gs,path:m}],e[5]=m,e[6]=f):f=e[6];const x=f;let p;e[7]===Symbol.for("react.memo_cache_sentinel")?(p=(0,s.jsx)(Ta,{to:"/",className:"mb-8 hover:scale-110 transition-transform",children:(0,s.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",alt:"Logo",className:"size-8 rounded-lg"})}),e[7]=p):p=e[7];let b;e[8]!==n||e[9]!==x||e[10]!==r?(b=x.map(v=>(0,s.jsxs)(Ot,{to:v.path,className:Vi,children:[(0,s.jsx)(v.icon,{size:26,strokeWidth:2.5}),v.id==="notifications"&&r>0&&(0,s.jsx)("span",{className:"absolute top-2 right-2 size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"}),v.id==="messages"&&n>0&&(0,s.jsx)("span",{className:"absolute top-2 right-2 size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"})]},v.id)),e[8]=n,e[9]=x,e[10]=r,e[11]=b):b=e[11];let h;e[12]!==i||e[13]!==a?(h=i&&(0,s.jsx)("button",{onClick:a,className:"p-2.5 mt-2 rounded-xl text-white bg-zinc-950 dark:bg-white dark:text-zinc-950 hover:scale-110 active:scale-95 transition-all duration-200 shadow-lg cursor-pointer",title:"Create Post",children:(0,s.jsx)(Ne,{size:26,strokeWidth:2.5})}),e[12]=i,e[13]=a,e[14]=h):h=e[14];let g;return e[15]!==h||e[16]!==b?(g=(0,s.jsxs)("aside",{className:"sticky top-0 hidden md:flex h-screen w-[68px] flex-col items-center py-5 border-r border-zinc-100 dark:border-zinc-800 shrink-0 bg-white dark:bg-black transition-colors duration-200",children:[p,(0,s.jsxs)("nav",{className:"flex flex-col gap-y-4 w-full items-center",children:[b,h]})]}),e[15]=h,e[16]=b,e[17]=g):g=e[17],g},Ki=Qi;function Vi(t){const{isActive:e}=t;return`p-2.5 rounded-xl transition-all duration-200 border border-transparent relative ${e?"text-black dark:text-white bg-zinc-100 dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800":"text-zinc-500 hover:bg-zinc-50 dark:hover:bg-zinc-900"}`}var Hi=Q(),Ui=t=>{const e=(0,Hi.c)(13),{value:a,onChange:i,onClear:r,placeholder:n}=t,l=n===void 0?"Search...":n;let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=(0,s.jsx)(Tt,{size:18,className:"absolute left-4 top-1/2 -translate-y-1/2 text-zinc-400 group-focus-within:text-violet-500 transition-colors"}),e[0]=o):o=e[0];let c;e[1]!==i?(c=f=>i(f.target.value),e[1]=i,e[2]=c):c=e[2];let d;e[3]!==l||e[4]!==c||e[5]!==a?(d=(0,s.jsx)("input",{className:"w-full rounded-full border border-zinc-100 dark:border-zinc-800 bg-zinc-50 dark:bg-zinc-900/50 text-zinc-900 dark:text-white px-11 py-2.5 text-sm outline-none focus:border-violet-500 focus:ring-1 focus:ring-violet-500 transition-all",placeholder:l,value:a,onChange:c}),e[3]=l,e[4]=c,e[5]=a,e[6]=d):d=e[6];let u;e[7]!==r||e[8]!==a?(u=a&&(0,s.jsx)("button",{onClick:r,className:"absolute right-4 top-1/2 -translate-y-1/2 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 transition-colors",children:(0,s.jsx)(xe,{size:16})}),e[7]=r,e[8]=a,e[9]=u):u=e[9];let m;return e[10]!==d||e[11]!==u?(m=(0,s.jsxs)("div",{className:"relative group w-full",children:[o,d,u]}),e[10]=d,e[11]=u,e[12]=m):m=e[12],m},Ee=Ui,Ji=Q();function J(...t){return Wa(Da(t))}const Gi=()=>{const t=(0,Ji.c)(2),{pathname:e}=qe();let a;return t[0]!==e?(a=[e],t[0]=e,t[1]=a):a=t[1],(0,w.useEffect)(Yi,a),null},be=t=>typeof t!="string"?!1:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t),Zi=(t,e)=>{const a=document.createElement("canvas"),i=t.naturalWidth/t.width,r=t.naturalHeight/t.height;return a.width=e.width,a.height=e.height,a.getContext("2d").drawImage(t,e.x*i,e.y*r,e.width*i,e.height*r,0,0,e.width,e.height),new Promise((n,l)=>{a.toBlob(o=>{if(!o){l(new Error("Canvas is empty"));return}n(o)},"image/jpeg",1)})},Oe=t=>{if(!t)return"";const e=new Date-new Date(t),a=Math.floor(e/1e3),i=Math.floor(a/60),r=Math.floor(i/60),n=Math.floor(r/24);return a<60?"Just now":i<60?`${i}m ago`:r<24?`${r}h ago`:n<7?`${n}d ago`:new Date(t).toLocaleDateString()},Xi=t=>typeof t!="string"?!1:/[\u0980-\u09FF]/.test(t);function Yi(){window.scrollTo(0,0)}var er=Q(),tr=t=>{const e=(0,er.c)(9),{className:a}=t,{setAuthMode:i}=ce();let r;e[0]!==a?(r=J("border border-[--border] rounded-2xl p-8 flex flex-col items-center text-center gap-4 bg-[--card] shadow-sm",a),e[0]=a,e[1]=r):r=e[1];let n,l;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"size-16 rounded-full border-4 border-amber-400 border-t-transparent animate-spin duration-[3000ms]"}),(0,s.jsx)("span",{className:"absolute inset-0 flex items-center justify-center text-2xl",children:"ðŸ’«"})]}),l=(0,s.jsx)("h3",{className:"font-extrabold text-lg text-[--foreground] mt-2 leading-tight",children:"Get your Sysm account now!"}),e[2]=n,e[3]=l):(n=e[2],l=e[3]);let o;e[4]!==i?(o=(0,s.jsx)("button",{onClick:()=>i("signup"),className:"w-full bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 py-2.5 rounded-full font-black text-sm uppercase tracking-wider hover:opacity-90 active:scale-95 transition-all shadow-lg cursor-pointer",children:"Signup now"}),e[4]=i,e[5]=o):o=e[5];let c;return e[6]!==r||e[7]!==o?(c=(0,s.jsxs)("div",{className:r,children:[n,l,o]}),e[6]=r,e[7]=o,e[8]=c):c=e[8],c},Yt=tr,sr=Q(),ar=t=>{const e=(0,sr.c)(41),{trendingTopics:a}=t;let i;e[0]!==a?(i=a===void 0?[]:a,e[0]=a,e[1]=i):i=e[1];const r=i,{currentUser:n,setAuthMode:l}=ce(),{darkMode:o,toggleDarkMode:c}=tt(),[d,u]=(0,w.useState)("");let m;e[2]===Symbol.for("react.memo_cache_sentinel")?(m=["Â© 2026 Sysm","Terms","Privacy","Guidelines","Discord","Sysm","GitHub","Support","Status"],e[2]=m):m=e[2];const f=m;let x;e[3]!==o?(x=o?(0,s.jsx)(_a,{size:20}):(0,s.jsx)(wa,{size:20}),e[3]=o,e[4]=x):x=e[4];let p;e[5]!==x||e[6]!==c?(p=(0,s.jsx)("button",{onClick:c,className:"p-3 rounded-full bg-zinc-50 dark:bg-zinc-900 text-zinc-500 dark:text-zinc-400 border border-zinc-100 dark:border-zinc-800 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-all cursor-pointer",title:"Toggle Theme",children:x}),e[5]=x,e[6]=c,e[7]=p):p=e[7];const b=p;if(n){let C;e[8]===Symbol.for("react.memo_cache_sentinel")?(C=()=>u(""),e[8]=C):C=e[8];let M;e[9]!==d?(M=(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(Ee,{value:d,onChange:u,onClear:C})}),e[9]=d,e[10]=M):M=e[10];let I;e[11]!==M||e[12]!==b?(I=(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[M,b]}),e[11]=M,e[12]=b,e[13]=I):I=e[13];let O;e[14]===Symbol.for("react.memo_cache_sentinel")?(O=(0,s.jsx)("h3",{className:"font-extrabold text-xl mb-4 px-2 text-[--foreground]",children:"What's happening"}),e[14]=O):O=e[14];let T;e[15]!==r?(T=r.map(rr),e[15]=r,e[16]=T):T=e[16];let W;e[17]!==T?(W=(0,s.jsxs)("div",{className:"bg-zinc-50 dark:bg-zinc-900 rounded-2xl p-4 border border-[--border]",children:[O,(0,s.jsx)("div",{className:"flex flex-col gap-1",children:T})]}),e[17]=T,e[18]=W):W=e[18];let q;e[19]===Symbol.for("react.memo_cache_sentinel")?(q=(0,s.jsx)("div",{className:"flex flex-wrap gap-x-4 gap-y-2 px-2 text-[13px] text-zinc-500 font-medium pb-5",children:f.map(nr)}),e[19]=q):q=e[19];let E;return e[20]!==W||e[21]!==I?(E=(0,s.jsxs)("aside",{className:"sticky top-5 hidden w-[320px] shrink-0 flex-col gap-y-6 lg:flex overflow-y-auto max-h-screen",children:[I,W,q]}),e[20]=W,e[21]=I,e[22]=E):E=e[22],E}let h,g;e[23]!==l?(h=(0,s.jsx)("button",{onClick:()=>l("signup"),className:"flex-1 bg-[--card] border border-[--border] py-2.5 rounded-full font-bold text-[--foreground] hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors shadow-sm cursor-pointer",children:"Signup"}),g=()=>l("login"),e[23]=l,e[24]=h,e[25]=g):(h=e[24],g=e[25]);let v;e[26]===Symbol.for("react.memo_cache_sentinel")?(v=(0,s.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",alt:"",className:"size-4 rounded-sm"}),e[26]=v):v=e[26];let z;e[27]!==g?(z=(0,s.jsxs)("button",{onClick:g,className:"flex-1 bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 py-2.5 rounded-full font-bold flex items-center justify-center gap-2 hover:opacity-90 transition-opacity cursor-pointer",children:[v,"Login"]}),e[27]=g,e[28]=z):z=e[28];let _;e[29]!==h||e[30]!==z||e[31]!==b?(_=(0,s.jsxs)("div",{className:"flex gap-3",children:[h,z,b]}),e[29]=h,e[30]=z,e[31]=b,e[32]=_):_=e[32];let y;e[33]===Symbol.for("react.memo_cache_sentinel")?(y=()=>u(""),e[33]=y):y=e[33];let k;e[34]!==d?(k=(0,s.jsx)(Ee,{value:d,onChange:u,onClear:y}),e[34]=d,e[35]=k):k=e[35];let $;e[36]===Symbol.for("react.memo_cache_sentinel")?($=(0,s.jsx)(Yt,{}),e[36]=$):$=e[36];let S;e[37]===Symbol.for("react.memo_cache_sentinel")?(S=(0,s.jsx)("div",{className:"flex flex-wrap gap-x-4 gap-y-2 px-2 text-[13px] text-zinc-500 font-medium pb-5",children:f.map(lr)}),e[37]=S):S=e[37];let L;return e[38]!==_||e[39]!==k?(L=(0,s.jsxs)("aside",{className:"sticky top-5 hidden w-[350px] shrink-0 flex-col gap-y-6 lg:flex pr-4",children:[_,k,$,S]}),e[38]=_,e[39]=k,e[40]=L):L=e[40],L},ir=ar;function rr(t){return(0,s.jsxs)("div",{className:"px-3 py-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-xl cursor-pointer transition-colors group",children:[(0,s.jsx)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400 font-medium",children:"Trending"}),(0,s.jsxs)("div",{className:"font-bold text-[--foreground]",children:["#",t.tag]}),(0,s.jsxs)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:[t.posts," posts"]})]},t.tag)}function nr(t){return(0,s.jsx)("a",{href:"#",className:"hover:underline",children:t},t)}function lr(t){return(0,s.jsx)("a",{href:"#",className:"hover:underline",children:t},t)}var it=Q();function re(t){const e=(0,it.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=J("relative flex size-8 shrink-0 overflow-hidden rounded-full",a),e[3]=a,e[4]=r):r=e[4];let n;return e[5]!==i||e[6]!==r?(n=(0,s.jsx)(Ns,{"data-slot":"avatar",className:r,...i}),e[5]=i,e[6]=r,e[7]=n):n=e[7],n}function ne(t){const e=(0,it.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=J("aspect-square size-full",a),e[3]=a,e[4]=r):r=e[4];let n;return e[5]!==i||e[6]!==r?(n=(0,s.jsx)(Us,{"data-slot":"avatar-image",className:r,...i}),e[5]=i,e[6]=r,e[7]=n):n=e[7],n}function le(t){const e=(0,it.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=J("bg-muted flex size-full items-center justify-center rounded-full",a),e[3]=a,e[4]=r):r=e[4];let n;return e[5]!==i||e[6]!==r?(n=(0,s.jsx)(Vs,{"data-slot":"avatar-fallback",className:r,...i}),e[5]=i,e[6]=r,e[7]=n):n=e[7],n}var or=Q(),cr=t=>{const e=(0,or.c)(23),{handleProfileClick:a}=t,{currentUser:i}=ce(),{unreadCount:r}=Xt(i),{unreadCount:n}=at(i),l=qe();let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=[{id:"home",icon:Ct,path:"/"},{id:"explore",icon:Mt,path:"/explore"},{id:"reels",icon:Ze,path:"/reels"},{id:"messages",icon:De,path:"/messages"},{id:"notifications",icon:Xe,path:"/notifications"}],e[0]=o):o=e[0];const c=o;let d;e[1]!==n||e[2]!==r?(d=c.map(z=>(0,s.jsx)(Ot,{to:z.path,className:mr,children:_=>{const{isActive:y}=_;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(z.icon,{size:26,strokeWidth:y?2.5:2}),z.id==="notifications"&&r>0&&(0,s.jsx)("span",{className:"absolute top-3 right-[30%] size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"}),z.id==="messages"&&n>0&&(0,s.jsx)("span",{className:"absolute top-3 right-[30%] size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"})]})}},z.id)),e[1]=n,e[2]=r,e[3]=d):d=e[3];let u;e[4]!==i||e[5]!==a?(u=()=>{i&&a(i.handle)},e[4]=i,e[5]=a,e[6]=u):u=e[6];const m=`size-7 border-2 ${l.pathname.startsWith("/u/")?"border-black dark:border-white":"border-transparent opacity-70"}`,f=i?.avatar||"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm";let x;e[7]!==f?(x=(0,s.jsx)(ne,{src:f,alt:"Profile",className:"object-cover"}),e[7]=f,e[8]=x):x=e[8];let p;e[9]!==i?.handle?.[0]?(p=i?.handle?.[0]?.toUpperCase(),e[9]=i?.handle?.[0],e[10]=p):p=e[10];let b;e[11]!==p?(b=(0,s.jsx)(le,{children:p}),e[11]=p,e[12]=b):b=e[12];let h;e[13]!==m||e[14]!==x||e[15]!==b?(h=(0,s.jsxs)(re,{className:m,children:[x,b]}),e[13]=m,e[14]=x,e[15]=b,e[16]=h):h=e[16];let g;e[17]!==u||e[18]!==h?(g=(0,s.jsx)("button",{onClick:u,className:"flex-1 flex flex-col items-center justify-center h-full",children:h}),e[17]=u,e[18]=h,e[19]=g):g=e[19];let v;return e[20]!==g||e[21]!==d?(v=(0,s.jsxs)("nav",{className:"fixed bottom-0 left-0 right-0 z-[40] flex h-16 items-center border-t border-zinc-100 bg-white/90 pb-safe backdrop-blur-md dark:border-zinc-800 dark:bg-black/90 md:hidden",children:[d,g]}),e[20]=g,e[21]=d,e[22]=v):v=e[22],v},dr=cr;function mr(t){const{isActive:e}=t;return`flex flex-1 flex-col items-center justify-center h-full transition-all duration-200 relative ${e?"text-black dark:text-white":"text-zinc-400 opacity-70"}`}var ur=Q(),fr=()=>{const t=(0,ur.c)(5);let e,a;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,s.jsx)("img",{src:"https://systemadminbd.com/uploads/675346dd55e0c7.43939630.png",alt:"Welcome Banner",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-700"}),a=(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"}),t[0]=e,t[1]=a):(e=t[0],a=t[1]);let i;t[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsx)("h1",{className:"text-3xl sm:text-4xl font-black mb-1 drop-shadow-lg",children:"Welcome to Sysm"}),t[2]=i):i=t[2];let r;t[3]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsxs)("div",{className:"absolute bottom-6 left-8 text-white",children:[i,(0,s.jsxs)("p",{className:"text-sm sm:text-base font-medium opacity-90 tracking-wide drop-shadow-md",children:["a social network built by"," ",(0,s.jsx)("a",{href:"https://t.me/systemadminbd",target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:"@Systemadminbd"})]})]}),t[3]=r):r=t[3];let n;return t[4]===Symbol.for("react.memo_cache_sentinel")?(n=(0,s.jsxs)("div",{className:"relative w-full aspect-[21/9] sm:aspect-[2.5/1] rounded-3xl overflow-hidden mb-6 group cursor-pointer",children:[e,a,r,(0,s.jsx)("div",{className:"absolute bottom-4 right-8",children:(0,s.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",className:"size-12 animate-pulse opacity-80 rounded-xl",alt:""})})]}),t[4]=n):n=t[4],n},xr=fr,hr=Q(),pr=t=>{const e=(0,hr.c)(27),{onPostClick:a}=t,i=qe(),r=_e(),{darkMode:n}=tt(),l=i.pathname==="/";let o;e[0]!==i.pathname?(o=i.pathname.split("/").length>2&&i.pathname.startsWith("/messages"),e[0]=i.pathname,e[1]=o):o=e[1];const c=o;let d;e[2]!==r?(d=$=>{r(`/u/${$}`)},e[2]=r,e[3]=d):d=e[3];const u=d,m=`min-h-screen bg-[--background] text-[--foreground] font-sans selection:bg-violet-500 selection:text-white transition-colors duration-200 ${n?"dark":""}`;let f;e[4]!==a?(f=(0,s.jsx)(Ki,{onPostClick:a}),e[4]=a,e[5]=f):f=e[5];const x=!c&&"pb-24 md:pb-0";let p;e[6]!==x?(p=J("flex-1 flex justify-center gap-x-2 md:gap-x-8 py-0 md:py-5 px-0 md:px-4",x),e[6]=x,e[7]=p):p=e[7];let b;e[8]!==l?(b=l&&(0,s.jsx)(xr,{}),e[8]=l,e[9]=b):b=e[9];let h;e[10]===Symbol.for("react.memo_cache_sentinel")?(h=(0,s.jsx)("div",{className:"w-full",children:(0,s.jsx)(Bs,{})}),e[10]=h):h=e[10];let g;e[11]!==b?(g=(0,s.jsxs)("div",{className:"w-full flex flex-col flex-1",children:[b,h]}),e[11]=b,e[12]=g):g=e[12];let v;e[13]===Symbol.for("react.memo_cache_sentinel")?(v=(0,s.jsx)(ir,{trendingTopics:Ni}),e[13]=v):v=e[13];let z;e[14]!==p||e[15]!==g?(z=(0,s.jsxs)("div",{className:p,children:[g,v]}),e[14]=p,e[15]=g,e[16]=z):z=e[16];let _;e[17]!==z||e[18]!==f?(_=(0,s.jsxs)("div",{className:"flex justify-center w-full max-w-[1300px] mx-auto min-h-screen px-0 sm:px-0",children:[f,z]}),e[17]=z,e[18]=f,e[19]=_):_=e[19];let y;e[20]!==u||e[21]!==c?(y=!c&&(0,s.jsx)(dr,{handleProfileClick:u}),e[20]=u,e[21]=c,e[22]=y):y=e[22];let k;return e[23]!==_||e[24]!==y||e[25]!==m?(k=(0,s.jsxs)("div",{className:m,children:[_,y]}),e[23]=_,e[24]=y,e[25]=m,e[26]=k):k=e[26],k},br=pr,we=Q();function es(t){const e=(0,we.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(Hs,{"data-slot":"dialog",...a}),e[2]=a,e[3]=i):i=e[3],i}function gr(t){const e=(0,we.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(bs,{"data-slot":"dialog-portal",...a}),e[2]=a,e[3]=i):i=e[3],i}function vr(t){const e=(0,we.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=J("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),e[3]=a,e[4]=r):r=e[4];let n;return e[5]!==i||e[6]!==r?(n=(0,s.jsx)(Oa,{"data-slot":"dialog-overlay",className:r,...i}),e[5]=i,e[6]=r,e[7]=n):n=e[7],n}function ts(t){const e=(0,we.c)(15);let a,i,r,n;e[0]!==t?({className:i,children:a,showCloseButton:n,...r}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=r,e[4]=n):(a=e[1],i=e[2],r=e[3],n=e[4]);const l=n===void 0?!0:n;let o;e[5]===Symbol.for("react.memo_cache_sentinel")?(o=(0,s.jsx)(vr,{}),e[5]=o):o=e[5];let c;e[6]!==i?(c=J("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 outline-none sm:max-w-lg",i),e[6]=i,e[7]=c):c=e[7];let d;e[8]!==l?(d=l&&(0,s.jsxs)(Ss,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,s.jsx)(xe,{}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]}),e[8]=l,e[9]=d):d=e[9];let u;return e[10]!==a||e[11]!==r||e[12]!==c||e[13]!==d?(u=(0,s.jsxs)(gr,{"data-slot":"dialog-portal",children:[o,(0,s.jsxs)(Ps,{"data-slot":"dialog-content",className:c,...r,children:[a,d]})]}),e[10]=a,e[11]=r,e[12]=c,e[13]=d,e[14]=u):u=e[14],u}function ss(t){const e=(0,we.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=J("flex flex-col gap-2 text-center sm:text-left",a),e[3]=a,e[4]=r):r=e[4];let n;return e[5]!==i||e[6]!==r?(n=(0,s.jsx)("div",{"data-slot":"dialog-header",className:r,...i}),e[5]=i,e[6]=r,e[7]=n):n=e[7],n}function as(t){const e=(0,we.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=J("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),e[3]=a,e[4]=r):r=e[4];let n;return e[5]!==i||e[6]!==r?(n=(0,s.jsx)("div",{"data-slot":"dialog-footer",className:r,...i}),e[5]=i,e[6]=r,e[7]=n):n=e[7],n}function is(t){const e=(0,we.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=J("text-lg leading-none font-semibold",a),e[3]=a,e[4]=r):r=e[4];let n;return e[5]!==i||e[6]!==r?(n=(0,s.jsx)(_s,{"data-slot":"dialog-title",className:r,...i}),e[5]=i,e[6]=r,e[7]=n):n=e[7],n}function jr(t){const e=(0,we.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=J("text-muted-foreground text-sm",a),e[3]=a,e[4]=r):r=e[4];let n;return e[5]!==i||e[6]!==r?(n=(0,s.jsx)(As,{"data-slot":"dialog-description",className:r,...i}),e[5]=i,e[6]=r,e[7]=n):n=e[7],n}var yr=Q(),wr=t=>{const e=(0,yr.c)(20),{isOpen:a,onClose:i,title:r,children:n,footer:l,description:o,className:c}=t;let d;e[0]!==i?(d=g=>{g||i()},e[0]=i,e[1]=d):d=e[1];const u=d;let m;e[2]!==c?(m=J("sm:max-w-md max-h-[calc(100dvh-2rem)] flex flex-col p-0 gap-0 overflow-hidden bg-white dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800",c),e[2]=c,e[3]=m):m=e[3];let f;e[4]!==o||e[5]!==r?(f=r&&(0,s.jsxs)(ss,{className:"px-5 py-4 border-b border-zinc-100 dark:border-zinc-800 shrink-0",children:[(0,s.jsx)(is,{className:"text-xl font-bold",children:r}),o&&(0,s.jsx)(jr,{children:o})]}),e[4]=o,e[5]=r,e[6]=f):f=e[6];let x;e[7]!==n?(x=(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-5 min-h-0",children:n}),e[7]=n,e[8]=x):x=e[8];let p;e[9]!==l?(p=l&&(0,s.jsx)(as,{className:"px-5 py-4 border-t border-zinc-100 dark:border-zinc-800 shrink-0 bg-white dark:bg-zinc-900",children:l}),e[9]=l,e[10]=p):p=e[10];let b;e[11]!==m||e[12]!==f||e[13]!==x||e[14]!==p?(b=(0,s.jsxs)(ts,{className:m,children:[f,x,p]}),e[11]=m,e[12]=f,e[13]=x,e[14]=p,e[15]=b):b=e[15];let h;return e[16]!==u||e[17]!==a||e[18]!==b?(h=(0,s.jsx)(es,{open:a,onOpenChange:u,children:b}),e[16]=u,e[17]=a,e[18]=b,e[19]=h):h=e[19],h},rt=wr,zr=Q(),Nr=t=>{const e=(0,zr.c)(12);let a,i,r,n;e[0]!==t?({children:a,variant:r,className:n,...i}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=r,e[4]=n):(a=e[1],i=e[2],r=e[3],n=e[4]);const l=r===void 0?"primary":r,o=n===void 0?"":n;let c;e[5]===Symbol.for("react.memo_cache_sentinel")?(c={primary:"text-white hover:text-white bg-zinc-900 hover:bg-zinc-800 border border-zinc-900 dark:bg-white dark:text-black dark:border-white dark:hover:bg-zinc-200",secondary:"text-zinc-900 border border-zinc-300 hover:border-zinc-400 bg-transparent hover:bg-zinc-50 dark:text-white dark:border-zinc-700 dark:hover:border-zinc-600 dark:hover:bg-zinc-900",outline:"text-zinc-900 border border-zinc-300 hover:border-zinc-400 bg-white dark:bg-transparent dark:text-white dark:border-zinc-700 dark:hover:bg-zinc-900",danger:"text-white bg-red-500 hover:bg-red-600 border border-red-500",ghost:"text-zinc-500 hover:bg-zinc-100 dark:text-zinc-400 dark:hover:bg-zinc-800 border-transparent"},e[5]=c):c=e[5];const d=`rounded-full font-bold inline-flex items-center justify-center relative overflow-hidden px-4 py-1.5 transition-all duration-200 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:active:scale-100 touch-manipulation ${c[l]} ${o}`;let u;e[6]!==a?(u=(0,s.jsx)("div",{className:"flex items-center gap-x-1.5",children:a}),e[6]=a,e[7]=u):u=e[7];let m;return e[8]!==i||e[9]!==d||e[10]!==u?(m=(0,s.jsx)("button",{className:d,...i,children:u}),e[8]=i,e[9]=d,e[10]=u,e[11]=m):m=e[11],m},fe=Nr,kr=Q(),_r=t=>{const e=(0,kr.c)(33),{src:a,isOpen:i,onClose:r,onCropComplete:n,aspect:l,circular:o}=t,[c,d]=(0,w.useState)(),[u,m]=(0,w.useState)(null),f=(0,w.useRef)(null);let x;e[0]!==l?(x=I=>{const{width:O,height:T}=I.currentTarget;d(l?Ts(Is({unit:"%",width:90},l,O,T),O,T):{unit:"%",width:80,height:80,x:10,y:10})},e[0]=l,e[1]=x):x=e[1];const p=x;let b;e[2]!==u||e[3]!==r||e[4]!==n?(b=async()=>{if(u&&f.current)try{n(await Zi(f.current,u)),r()}catch(I){console.error("Error cropping image:",I)}},e[2]=u,e[3]=r,e[4]=n,e[5]=b):b=e[5];const h=b;let g;e[6]!==r?(g=I=>!I&&r(),e[6]=r,e[7]=g):g=e[7];let v;e[8]===Symbol.for("react.memo_cache_sentinel")?(v=(0,s.jsx)(ss,{className:"p-4 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)(is,{children:"Crop Image"})}),e[8]=v):v=e[8];let z,_;e[9]===Symbol.for("react.memo_cache_sentinel")?(z=I=>d(I),_=I=>m(I),e[9]=z,e[10]=_):(z=e[9],_=e[10]);let y;e[11]!==p||e[12]!==a?(y=(0,s.jsx)("img",{ref:f,src:a,alt:"Crop preview",onLoad:p,className:"max-h-[60vh] w-auto block"}),e[11]=p,e[12]=a,e[13]=y):y=e[13];let k;e[14]!==l||e[15]!==o||e[16]!==c||e[17]!==y?(k=(0,s.jsx)("div",{className:"p-6 flex items-center justify-center bg-zinc-100/50 dark:bg-zinc-950/50 min-h-[300px] max-h-[65vh] overflow-auto",children:(0,s.jsx)(ws,{crop:c,onChange:z,onComplete:_,aspect:l,circularCrop:o,className:"max-w-full shadow-2xl",children:y})}),e[14]=l,e[15]=o,e[16]=c,e[17]=y,e[18]=k):k=e[18];let $;e[19]!==r?($=(0,s.jsx)(fe,{variant:"outline",onClick:r,className:"!w-auto px-6",children:"Cancel"}),e[19]=r,e[20]=$):$=e[20];let S;e[21]!==h?(S=(0,s.jsx)(fe,{onClick:h,className:"!w-auto px-6",children:"Apply Crop"}),e[21]=h,e[22]=S):S=e[22];let L;e[23]!==S||e[24]!==$?(L=(0,s.jsxs)(as,{className:"p-4 bg-white dark:bg-zinc-900 border-t border-zinc-100 dark:border-zinc-800 flex flex-row justify-end gap-2",children:[$,S]}),e[23]=S,e[24]=$,e[25]=L):L=e[25];let C;e[26]!==L||e[27]!==k?(C=(0,s.jsxs)(ts,{className:"sm:max-w-2xl bg-white dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800 p-0 overflow-hidden",children:[v,k,L]}),e[26]=L,e[27]=k,e[28]=C):C=e[28];let M;return e[29]!==i||e[30]!==C||e[31]!==g?(M=(0,s.jsx)(es,{open:i,onOpenChange:g,children:C}),e[29]=i,e[30]=C,e[31]=g,e[32]=M):M=e[32],M},nt=_r,Cr=({isOpen:t,onClose:e})=>{const{currentUser:a}=ce(),{addPost:i}=Pe(),{addToast:r}=ye(),[n,l]=(0,w.useState)(""),[o,c]=(0,w.useState)([]),[d,u]=(0,w.useState)({}),[m,f]=(0,w.useState)(!1),[x,p]=(0,w.useState)({options:["",""],duration:"1 day"}),[b,h]=(0,w.useState)(!1),[g,v]=(0,w.useState)(null),[z,_]=(0,w.useState)(null),y=(0,w.useRef)(null),k=(0,w.useRef)(null),[$,S]=(0,w.useState)(null),L=j=>{const N=Array.from(j.target.files);c(F=>[...F,...N])},C=j=>{const N=j.target.files[0];N&&$!==null&&u(F=>({...F,[$]:N})),S(null)},M=j=>{c(F=>F.filter((P,A)=>A!==j));const N={...d};delete N[j],u(N)},I=j=>{const N=o[j],F=new FileReader;F.onload=()=>{v(F.result),_(j)},F.readAsDataURL(N)},O=j=>{const N=new File([j],`cropped-${Date.now()}.jpg`,{type:"image/jpeg"}),F=[...o];F[z]=N,c(F),v(null),_(null)},T=()=>{x.options.length<4&&p(j=>({...j,options:[...j.options,""]}))},W=j=>{p(N=>({...N,options:N.options.filter((F,P)=>P!==j)}))},q=(j,N)=>{const F=[...x.options];F[j]=N,p(P=>({...P,options:F}))},E=async j=>{if(j.preventDefault(),!(!n.trim()&&o.length===0||!a)){h(!0);try{const N=[];for(let P=0;P<o.length;P++){const A=o[P],K=await ke(A,"media",d[P]||null);N.push(K)}let F=null;m&&x.options.some(P=>P.trim())&&(F={options:x.options.filter(P=>P.trim()).map((P,A)=>({id:A+1,text:P,votes:0})),ends_at:new Date(Date.now()+1440*60*1e3).toISOString()}),await i({content:n,media:N,poll:F,type:N.length>0?N[0].type==="video"?"video":"image":F?"poll":"text",userId:a.id}),l(""),c([]),f(!1),p({options:["",""],duration:"1 day"}),e(),r("Post published!")}catch(N){console.error("Failed to create post:",N),r("Failed to publish post.")}finally{h(!1)}}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(rt,{isOpen:t,onClose:()=>!b&&e(),title:"Create Post",className:"sm:max-w-xl",footer:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,s.jsxs)("div",{className:"flex text-violet-600 gap-1",children:[(0,s.jsx)("button",{type:"button",onClick:()=>y.current?.click(),className:"p-2.5 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full transition-colors",title:"Attach media",children:(0,s.jsx)(Ws,{size:22})}),(0,s.jsx)("button",{type:"button",onClick:()=>f(!0),className:"p-2.5 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full transition-colors",title:"Add poll",children:(0,s.jsx)(gs,{size:22})}),(0,s.jsx)("button",{type:"button",className:"p-2.5 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full transition-colors",children:(0,s.jsx)(et,{size:22})}),(0,s.jsx)("input",{type:"file",ref:y,onChange:L,multiple:!0,className:"hidden",accept:"image/*,video/*,application/pdf"}),(0,s.jsx)("input",{type:"file",ref:k,onChange:C,className:"hidden",accept:"image/*"})]}),(0,s.jsx)(fe,{onClick:E,disabled:!n.trim()&&o.length===0||b,className:"px-8 py-2.5 min-w-[100px] text-base",children:b?(0,s.jsx)(oe,{size:18,className:"animate-spin"}):"Post"})]}),children:(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)(re,{className:"size-12 border border-zinc-200 dark:border-zinc-800",children:[(0,s.jsx)(ne,{src:a?.avatar,className:"object-cover"}),(0,s.jsx)(le,{children:a?.handle?.[0]?.toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("textarea",{className:"w-full bg-transparent border-none outline-none text-lg min-h-[120px] resize-none dark:text-white",placeholder:"What's happening?",autoFocus:!0,value:n,onChange:j=>l(j.target.value)}),m&&(0,s.jsxs)("div",{className:"mt-4 p-4 rounded-2xl border border-zinc-100 dark:border-zinc-800 space-y-3 bg-zinc-50/50 dark:bg-zinc-900/50",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsx)("span",{className:"text-sm font-bold opacity-60",children:"Poll"}),(0,s.jsx)("button",{type:"button",onClick:()=>f(!1),className:"text-zinc-500 hover:text-rose-500",children:(0,s.jsx)(xe,{size:18})})]}),x.options.map((j,N)=>(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{className:"flex-1 bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-xl px-4 py-2 text-sm outline-none focus:border-violet-500",placeholder:`Option ${N+1}`,value:j,onChange:F=>q(N,F.target.value)}),x.options.length>2&&(0,s.jsx)("button",{type:"button",onClick:()=>W(N),className:"p-2 text-rose-500 hover:bg-rose-50 dark:hover:bg-rose-900/20 rounded-lg transition-colors",children:(0,s.jsx)(Et,{size:16})})]},N)),x.options.length<4&&(0,s.jsx)("button",{type:"button",onClick:T,className:"text-sm font-bold text-violet-600 hover:bg-violet-50 dark:hover:bg-violet-900/20 px-3 py-1.5 rounded-lg transition-colors",children:"+ Add option"})]}),o.length>0&&(0,s.jsx)("div",{className:"mt-4 flex flex-wrap gap-2",children:o.map((j,N)=>(0,s.jsxs)("div",{className:"relative group size-24 rounded-xl overflow-hidden bg-zinc-100 dark:bg-zinc-800 border dark:border-zinc-700",children:[j.type.startsWith("image/")?(0,s.jsx)("img",{src:URL.createObjectURL(j),className:"size-full object-cover",alt:""}):(0,s.jsx)("div",{className:"size-full flex flex-col items-center justify-center text-zinc-500 bg-zinc-100 dark:bg-zinc-800",children:j.type.startsWith("video/")?(0,s.jsxs)(s.Fragment,{children:[d[N]?(0,s.jsx)("img",{src:URL.createObjectURL(d[N]),className:"size-full object-cover",alt:"Custom thumbnail"}):(0,s.jsx)(Ne,{size:24,className:"animate-pulse"}),(0,s.jsx)("button",{type:"button",onClick:()=>{S(N),k.current?.click()},className:"absolute inset-x-0 bottom-0 bg-black/60 text-white text-[10px] font-bold py-1 backdrop-blur-sm hover:bg-black transition-colors",children:d[N]?"Change Thumbnail":"Add Thumbnail"})]}):(0,s.jsx)(St,{size:24})}),(0,s.jsx)("button",{type:"button",onClick:()=>M(N),className:"absolute top-1 right-1 size-6 rounded-full bg-black/60 text-white flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)(xe,{size:14,strokeWidth:3})}),j.type.startsWith("image/")&&(0,s.jsx)("button",{type:"button",onClick:()=>I(N),className:"absolute bottom-1 right-1 size-6 rounded-full bg-black/60 text-white flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",title:"Crop image",children:(0,s.jsx)(ma,{size:14,strokeWidth:3})})]},N))})]})]})})}),g&&(0,s.jsx)(nt,{src:g,isOpen:!!g,onClose:()=>{v(null),_(null)},onCropComplete:O,aspect:void 0})]})},Sr=Cr,$r=Q(),rs=w.forwardRef((t,e)=>{const a=(0,$r.c)(20);let i,r,n,l,o;a[0]!==t?({className:i,label:r,type:o,textarea:l,...n}=t,a[0]=t,a[1]=i,a[2]=r,a[3]=n,a[4]=l,a[5]=o):(i=a[1],r=a[2],n=a[3],l=a[4],o=a[5]);const c=l?"textarea":"input";let d;a[6]!==r?(d=r&&(0,s.jsx)("label",{className:"text-sm font-bold text-zinc-500 dark:text-zinc-400 ml-1",children:r}),a[6]=r,a[7]=d):d=a[7];const u=l&&"min-h-[100px] resize-none";let m;a[8]!==i||a[9]!==u?(m=J("flex w-full rounded-xl border border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900 px-4 py-2.5 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-zinc-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:ring-offset-zinc-950 dark:text-white transition-all",u,i),a[8]=i,a[9]=u,a[10]=m):m=a[10];let f;a[11]!==c||a[12]!==n||a[13]!==e||a[14]!==m||a[15]!==o?(f=(0,s.jsx)(c,{type:o,className:m,ref:e,...n}),a[11]=c,a[12]=n,a[13]=e,a[14]=m,a[15]=o,a[16]=f):f=a[16];let x;return a[17]!==d||a[18]!==f?(x=(0,s.jsxs)("div",{className:"w-full space-y-1.5",children:[d,f]}),a[17]=d,a[18]=f,a[19]=x):x=a[19],x});rs.displayName="Input";var je=rs,Pr=({isOpen:t,onClose:e,editProfileData:a,setEditProfileData:i})=>{const{updateProfile:r}=ce(),{addToast:n}=ye(),[l,o]=(0,w.useState)(!1),[c,d]=(0,w.useState)(null),[u,m]=(0,w.useState)(null),[f,x]=(0,w.useState)(null),[p,b]=(0,w.useState)(null),h=(0,w.useRef)(null),g=(0,w.useRef)(null),v=(y,k)=>{const $=y.target.files[0];if($){const S=new FileReader;S.onload=()=>{x(S.result),b(k)},S.readAsDataURL($)}},z=y=>{const k=new File([y],`cropped-${Date.now()}.jpg`,{type:"image/jpeg"});p==="avatar"?d(k):m(k),x(null),b(null)},_=async()=>{o(!0);try{let y=a.avatar,k=a.cover;c&&(y=(await ke(c)).url),u&&(k=(await ke(u)).url),await r({...a,avatar:y,cover:k}),d(null),m(null),e(),n("Profile updated!")}catch(y){console.error("Failed to update profile:",y),n("Failed to update profile.","error")}finally{o(!1)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(rt,{isOpen:t,onClose:()=>!l&&e(),title:"Edit Profile",children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("input",{type:"file",ref:g,className:"hidden",accept:"image/*",onChange:y=>v(y,"cover")}),(0,s.jsx)("input",{type:"file",ref:h,className:"hidden",accept:"image/*",onChange:y=>v(y,"avatar")}),(0,s.jsxs)("div",{className:"relative h-32 bg-zinc-100 dark:bg-zinc-800 rounded-xl overflow-hidden group cursor-pointer",onClick:()=>g.current?.click(),children:[(u||a?.cover)&&(0,s.jsx)("img",{src:u?URL.createObjectURL(u):a.cover,className:"w-full h-full object-cover opacity-60",alt:""}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("div",{className:"bg-black/50 p-2 rounded-full text-white group-hover:scale-110 transition-transform",children:(0,s.jsx)(Ne,{size:20})})})]}),(0,s.jsx)("div",{className:"relative -mt-16 ml-4",children:(0,s.jsxs)("div",{className:"relative size-24 rounded-full border-4 border-white dark:border-black overflow-hidden group cursor-pointer shadow-lg bg-white dark:bg-black",onClick:()=>h.current?.click(),children:[(c||a?.avatar)&&(0,s.jsxs)(re,{className:"size-full opacity-60 rounded-none",children:[(0,s.jsx)(ne,{src:c?URL.createObjectURL(c):a.avatar,className:"object-cover"}),(0,s.jsx)(le,{children:a?.handle?.[0]?.toUpperCase()})]}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("div",{className:"bg-black/50 p-2 rounded-full text-white group-hover:scale-110 transition-transform",children:(0,s.jsx)(Ne,{size:16})})})]})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(je,{label:"Name",value:a?.name||"",onChange:y=>i({...a,name:y.target.value})}),(0,s.jsx)(je,{label:"Bio",textarea:!0,value:a?.bio||"",onChange:y=>i({...a,bio:y.target.value})}),(0,s.jsx)(je,{label:"Location",value:a?.location||"",onChange:y=>i({...a,location:y.target.value})}),(0,s.jsx)(je,{label:"Website",value:a?.website||"",onChange:y=>i({...a,website:y.target.value})})]}),(0,s.jsx)(fe,{className:"w-full py-3",disabled:l,onClick:_,children:l?(0,s.jsx)(oe,{size:24,className:"animate-spin text-white mx-auto"}):"Save changes"})]})}),f&&(0,s.jsx)(nt,{src:f,isOpen:!!f,onClose:()=>{x(null),b(null)},onCropComplete:z,aspect:p==="avatar"?1:p==="cover"?3/1:void 0,circular:p==="avatar"})]})},Lr=Pr,Mr=({isOpen:t,onClose:e})=>{const{currentUser:a}=ce(),{addToast:i}=ye(),r=Fe(),[n,l]=(0,w.useState)(null),[o,c]=(0,w.useState)(!1),[d,u]=(0,w.useState)(null),m=(0,w.useRef)(null),f=h=>{const g=h.target.files[0];g&&l(g)},x=()=>{if(!n)return;const h=new FileReader;h.onload=()=>{u(h.result)},h.readAsDataURL(n)},p=h=>{l(new File([h],`story-cropped-${Date.now()}.jpg`,{type:"image/jpeg"})),u(null)},b=async()=>{if(!(!n||!a)){c(!0);try{const h=await ke(n);await zi(a.id,h.url,h.type),l(null),e(),i("Story shared!"),r.invalidateQueries(["stories"])}catch(h){console.error("Failed to create story:",h),i("Failed to share story.")}finally{c(!1)}}};return(0,s.jsxs)(rt,{isOpen:t,onClose:()=>!o&&e(),title:"Add Story",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[n?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"relative aspect-[9/16] w-full max-w-[280px] mx-auto rounded-3xl overflow-hidden shadow-2xl border dark:border-zinc-800",children:[(0,s.jsx)("img",{src:URL.createObjectURL(n),className:"w-full h-full object-cover",alt:"Preview"}),(0,s.jsx)("button",{onClick:()=>l(null),className:"absolute top-4 right-4 p-2 bg-black/50 text-white rounded-full hover:bg-rose-500 transition-colors",title:"Remove",children:(0,s.jsx)(xe,{size:20})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-center gap-4 py-2 border-y border-zinc-100 dark:border-zinc-800 bg-zinc-50/50 dark:bg-zinc-900/50 rounded-2xl",children:[(0,s.jsxs)("button",{onClick:x,className:"flex flex-col items-center gap-1.5 p-3 rounded-xl hover:bg-white dark:hover:bg-zinc-800 transition-all text-zinc-600 dark:text-zinc-400 hover:text-violet-600 dark:hover:text-violet-400 group",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm group-hover:shadow-md transition-all",children:(0,s.jsx)(At,{size:20})}),(0,s.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Crop / Edit"})]}),(0,s.jsxs)("button",{className:"flex flex-col items-center gap-1.5 p-3 rounded-xl opacity-40 cursor-not-allowed text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm",children:(0,s.jsx)("svg",{size:20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:(0,s.jsx)("path",{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 21 3 22l1-4.5L17 3z"})})}),(0,s.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Text"})]}),(0,s.jsxs)("button",{className:"flex flex-col items-center gap-1.5 p-3 rounded-xl opacity-40 cursor-not-allowed text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm",children:(0,s.jsxs)("svg",{size:20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[(0,s.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,s.jsx)("path",{d:"M8 14s1.5 2 4 2 4-2 4-2"}),(0,s.jsx)("line",{x1:"9",y1:"9",x2:"9.01",y2:"9"}),(0,s.jsx)("line",{x1:"15",y1:"9",x2:"15.01",y2:"9"})]})}),(0,s.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Stickers"})]})]})]}):(0,s.jsxs)("div",{className:"py-10",children:[(0,s.jsxs)("div",{className:"relative w-full group",onClick:()=>m.current?.click(),children:[(0,s.jsx)("div",{className:"relative z-40 cursor-pointer group-hover:translate-x-8 group-hover:shadow-2xl group-hover:-translate-y-8 transition-all duration-500 bg-zinc-900 dark:bg-white flex items-center justify-center h-32 w-32 mx-auto rounded-xl border-4 border-white dark:border-zinc-900",children:(0,s.jsxs)("svg",{className:"h-8 w-8 text-white/60 dark:text-zinc-950/60",strokeLinejoin:"round",strokeLinecap:"round",strokeWidth:"2",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2"}),(0,s.jsx)("path",{d:"M7 9l5 -5l5 5"}),(0,s.jsx)("path",{d:"M12 4l0 12"})]})}),(0,s.jsx)("div",{className:"absolute border-2 opacity-0 group-hover:opacity-80 transition-all duration-300 border-dashed border-violet-500 inset-0 z-30 bg-transparent flex items-center justify-center h-32 w-32 mx-auto rounded-xl"})]}),(0,s.jsxs)("div",{className:"text-center mt-8",children:[(0,s.jsx)("p",{className:"font-bold dark:text-white",children:"Choose a photo"}),(0,s.jsx)("p",{className:"text-sm text-zinc-500",children:"Stories last for 24 hours"})]})]}),(0,s.jsx)("input",{type:"file",ref:m,onChange:f,className:"hidden",accept:"image/*"}),(0,s.jsx)(fe,{className:"w-full py-3 text-lg",disabled:!n||o,onClick:b,children:o?(0,s.jsx)(oe,{size:24,className:"animate-spin mx-auto"}):"Share story"})]}),d&&(0,s.jsx)(nt,{src:d,isOpen:!!d,onClose:()=>u(null),onCropComplete:p,aspect:9/16})]})},Ir=Mr,Fr=Q(),Rr=t=>{const e=(0,Fr.c)(21),{isPostModalOpen:a,setIsPostModalOpen:i,isEditProfileOpen:r,setIsEditProfileOpen:n,isStoryModalOpen:l,setIsStoryModalOpen:o,editProfileData:c,setEditProfileData:d}=t;let u;e[0]!==i?(u=()=>i(!1),e[0]=i,e[1]=u):u=e[1];let m;e[2]!==a||e[3]!==u?(m=(0,s.jsx)(Sr,{isOpen:a,onClose:u}),e[2]=a,e[3]=u,e[4]=m):m=e[4];let f;e[5]!==n?(f=()=>n(!1),e[5]=n,e[6]=f):f=e[6];let x;e[7]!==c||e[8]!==r||e[9]!==d||e[10]!==f?(x=(0,s.jsx)(Lr,{isOpen:r,onClose:f,editProfileData:c,setEditProfileData:d}),e[7]=c,e[8]=r,e[9]=d,e[10]=f,e[11]=x):x=e[11];let p;e[12]!==o?(p=()=>o(!1),e[12]=o,e[13]=p):p=e[13];let b;e[14]!==l||e[15]!==p?(b=(0,s.jsx)(Ir,{isOpen:l,onClose:p}),e[14]=l,e[15]=p,e[16]=b):b=e[16];let h;return e[17]!==m||e[18]!==x||e[19]!==b?(h=(0,s.jsxs)(s.Fragment,{children:[m,x,b]}),e[17]=m,e[18]=x,e[19]=b,e[20]=h):h=e[20],h},Tr=Rr,Or=Q(),Er=t=>{const e=(0,Or.c)(77),{story:a,onClose:i}=t,[r,n]=(0,w.useState)(0),[l,o]=(0,w.useState)(0),c=a.stories,d=c[r];let u;e[0]!==r||e[1]!==i||e[2]!==c.length?(u=()=>{r<c.length-1?(n(qr),o(0)):i()},e[0]=r,e[1]=i,e[2]=c.length,e[3]=u):u=e[3];const m=u;let f;e[4]!==r?(f=()=>{r>0&&(n(Dr),o(0))},e[4]=r,e[5]=f):f=e[5];const x=f;let p;e[6]!==m?(p=()=>{const V=setInterval(()=>{o(U=>U>=100?(m(),100):U+1)},50);return()=>clearInterval(V)},e[6]=m,e[7]=p):p=e[7];let b;e[8]!==r||e[9]!==m?(b=[m,r],e[8]=r,e[9]=m,e[10]=b):b=e[10],(0,w.useEffect)(p,b);let h;if(e[11]!==r||e[12]!==l||e[13]!==c){let V;e[15]!==r||e[16]!==l?(V=(U,G)=>(0,s.jsx)("div",{className:"flex-1 h-full bg-white/30 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full bg-white transition-all duration-100",style:{width:G<r?"100%":G===r?`${l}%`:"0%"}})},G),e[15]=r,e[16]=l,e[17]=V):V=e[17],h=c.map(V),e[11]=r,e[12]=l,e[13]=c,e[14]=h}else h=e[14];let g;e[18]!==h?(g=(0,s.jsx)("div",{className:"flex gap-1.5 h-0.5 w-full bg-transparent",children:h}),e[18]=h,e[19]=g):g=e[19];let v;e[20]!==a.user.avatar||e[21]!==a.user.handle?(v=(0,s.jsx)(ne,{src:a.user.avatar,alt:a.user.handle,className:"object-cover"}),e[20]=a.user.avatar,e[21]=a.user.handle,e[22]=v):v=e[22];let z;e[23]!==a.user.handle?.[0]?(z=a.user.handle?.[0]?.toUpperCase(),e[23]=a.user.handle?.[0],e[24]=z):z=e[24];let _;e[25]!==z?(_=(0,s.jsx)(le,{children:z}),e[25]=z,e[26]=_):_=e[26];let y;e[27]!==v||e[28]!==_?(y=(0,s.jsxs)(re,{className:"size-10 border border-white/20 shadow-sm",children:[v,_]}),e[27]=v,e[28]=_,e[29]=y):y=e[29];let k;e[30]!==a.user.handle?(k=(0,s.jsx)("span",{className:"text-white text-sm font-bold shadow-black drop-shadow-md",children:a.user.handle}),e[30]=a.user.handle,e[31]=k):k=e[31];let $;e[32]!==d.created_at?($=new Date(d.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),e[32]=d.created_at,e[33]=$):$=e[33];let S;e[34]!==$?(S=(0,s.jsx)("span",{className:"text-white/60 text-[10px] shadow-black drop-shadow-md",children:$}),e[34]=$,e[35]=S):S=e[35];let L;e[36]!==k||e[37]!==S?(L=(0,s.jsxs)("div",{className:"flex flex-col",children:[k,S]}),e[36]=k,e[37]=S,e[38]=L):L=e[38];let C;e[39]!==y||e[40]!==L?(C=(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[y,L]}),e[39]=y,e[40]=L,e[41]=C):C=e[41];let M;e[42]===Symbol.for("react.memo_cache_sentinel")?(M=(0,s.jsx)(xe,{size:24}),e[42]=M):M=e[42];let I;e[43]!==i?(I=(0,s.jsx)("button",{onClick:i,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors",children:M}),e[43]=i,e[44]=I):I=e[44];let O;e[45]!==C||e[46]!==I?(O=(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[C,I]}),e[45]=C,e[46]=I,e[47]=O):O=e[47];let T;e[48]!==O||e[49]!==g?(T=(0,s.jsxs)("div",{className:"absolute top-0 left-0 right-0 p-4 z-20 flex flex-col gap-4",children:[g,O]}),e[48]=O,e[49]=g,e[50]=T):T=e[50];let W;e[51]!==r||e[52]!==x?(W=r>0&&(0,s.jsx)("button",{onClick:V=>{V.stopPropagation(),x()},className:"absolute left-4 z-30 p-2 bg-black/20 hover:bg-black/40 rounded-full text-white backdrop-blur-md transition-all active:scale-90",children:(0,s.jsx)(Lt,{size:32})}),e[51]=r,e[52]=x,e[53]=W):W=e[53];let q;e[54]!==d.id||e[55]!==d.media?(q=(0,s.jsx)("div",{className:"relative w-full h-full flex items-center justify-center",children:(0,s.jsx)("img",{src:d.media,className:"max-w-full max-h-full object-contain rounded-xl shadow-2xl animate-in fade-in zoom-in-95 duration-300",alt:""},d.id)}),e[54]=d.id,e[55]=d.media,e[56]=q):q=e[56];let E;e[57]!==m?(E=V=>{V.stopPropagation(),m()},e[57]=m,e[58]=E):E=e[58];let j;e[59]===Symbol.for("react.memo_cache_sentinel")?(j=(0,s.jsx)($t,{size:32}),e[59]=j):j=e[59];let N;e[60]!==E?(N=(0,s.jsx)("button",{onClick:E,className:"absolute right-4 z-30 p-2 bg-black/20 hover:bg-black/40 rounded-full text-white backdrop-blur-md transition-all active:scale-90",children:j}),e[60]=E,e[61]=N):N=e[61];let F;e[62]!==x?(F=(0,s.jsx)("div",{className:"flex-1 cursor-w-resize",onClick:x}),e[62]=x,e[63]=F):F=e[63];let P;e[64]!==m?(P=(0,s.jsx)("div",{className:"flex-1 cursor-e-resize",onClick:m}),e[64]=m,e[65]=P):P=e[65];let A;e[66]!==F||e[67]!==P?(A=(0,s.jsxs)("div",{className:"absolute inset-0 flex z-20",children:[F,P]}),e[66]=F,e[67]=P,e[68]=A):A=e[68];let K;e[69]!==W||e[70]!==q||e[71]!==N||e[72]!==A?(K=(0,s.jsxs)("div",{className:"w-full h-full max-w-xl relative flex items-center justify-center p-2",children:[W,q,N,A]}),e[69]=W,e[70]=q,e[71]=N,e[72]=A,e[73]=K):K=e[73];let H;return e[74]!==T||e[75]!==K?(H=(0,s.jsxs)("div",{className:"fixed inset-0 z-[100] bg-black flex flex-col items-center justify-center animate-in fade-in duration-300",children:[T,K]}),e[74]=T,e[75]=K,e[76]=H):H=e[76],H},Ar=Er;function qr(t){return t+1}function Dr(t){return t-1}var Br=Q(),Wr=t=>{const e=(0,Br.c)(48),{images:a,currentIndex:i,onClose:r,onNavigate:n}=t,l=i===void 0?0:i;if(!a||a.length===0)return null;const o=a[l],c=a.length>1;let d;e[0]!==l||e[1]!==n?(d=O=>{O.stopPropagation(),n&&l>0&&n(l-1)},e[0]=l,e[1]=n,e[2]=d):d=e[2];const u=d;let m;e[3]!==l||e[4]!==a.length||e[5]!==n?(m=O=>{O.stopPropagation(),n&&l<a.length-1&&n(l+1)},e[3]=l,e[4]=a.length,e[5]=n,e[6]=m):m=e[6];const f=m;let x;e[7]!==o?(x=O=>{O.stopPropagation();const T=document.createElement("a");T.href=o,T.download=`image-${Date.now()}.jpg`,document.body.appendChild(T),T.click(),document.body.removeChild(T)},e[7]=o,e[8]=x):x=e[8];const p=x,b=c?`${l+1} / ${a.length}`:"";let h;e[9]!==b?(h=(0,s.jsx)("div",{className:"text-white font-medium",children:b}),e[9]=b,e[10]=h):h=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=(0,s.jsx)(_t,{size:22}),e[11]=g):g=e[11];let v;e[12]!==p?(v=(0,s.jsx)("button",{onClick:p,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors",title:"Download",children:g}),e[12]=p,e[13]=v):v=e[13];let z;e[14]===Symbol.for("react.memo_cache_sentinel")?(z=(0,s.jsx)(xe,{size:24}),e[14]=z):z=e[14];let _;e[15]!==r?(_=(0,s.jsx)("button",{onClick:r,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors",title:"Close",children:z}),e[15]=r,e[16]=_):_=e[16];let y;e[17]!==_||e[18]!==v?(y=(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[v,_]}),e[17]=_,e[18]=v,e[19]=y):y=e[19];let k;e[20]!==y||e[21]!==h?(k=(0,s.jsxs)("div",{className:"absolute top-0 left-0 right-0 p-4 z-20 flex items-center justify-between bg-gradient-to-b from-black/50 to-transparent",children:[h,y]}),e[20]=y,e[21]=h,e[22]=k):k=e[22];let $;e[23]!==l||e[24]!==u||e[25]!==c?($=c&&l>0&&(0,s.jsx)("button",{onClick:u,className:"absolute left-4 z-10 p-3 bg-white/10 hover:bg-white/20 rounded-full text-white backdrop-blur-md transition-all active:scale-90",children:(0,s.jsx)(Lt,{size:32})}),e[23]=l,e[24]=u,e[25]=c,e[26]=$):$=e[26];let S;e[27]!==o?(S=(0,s.jsx)("img",{src:o,className:"max-w-full max-h-full object-contain select-none shadow-2xl animate-in zoom-in-95 duration-300",alt:"",onClick:Kr}),e[27]=o,e[28]=S):S=e[28];let L;e[29]!==l||e[30]!==f||e[31]!==c||e[32]!==a.length?(L=c&&l<a.length-1&&(0,s.jsx)("button",{onClick:f,className:"absolute right-4 z-10 p-3 bg-white/10 hover:bg-white/20 rounded-full text-white backdrop-blur-md transition-all active:scale-90",children:(0,s.jsx)($t,{size:32})}),e[29]=l,e[30]=f,e[31]=c,e[32]=a.length,e[33]=L):L=e[33];let C;e[34]!==$||e[35]!==S||e[36]!==L?(C=(0,s.jsxs)("div",{className:"w-full h-full relative flex items-center justify-center p-4",children:[$,S,L]}),e[34]=$,e[35]=S,e[36]=L,e[37]=C):C=e[37];let M;e[38]!==l||e[39]!==c||e[40]!==a||e[41]!==n?(M=c&&(0,s.jsx)("div",{className:"absolute bottom-6 flex gap-2 p-2 bg-black/40 backdrop-blur-md rounded-2xl overflow-x-auto max-w-[90%] hide-scrollbar",onClick:Vr,children:a.map((O,T)=>(0,s.jsx)("button",{onClick:()=>n(T),className:`size-12 rounded-lg overflow-hidden border-2 transition-all shrink-0 ${T===l?"border-white scale-110":"border-transparent opacity-50 hover:opacity-100"}`,children:(0,s.jsx)("img",{src:O,className:"size-full object-cover",alt:""})},T))}),e[38]=l,e[39]=c,e[40]=a,e[41]=n,e[42]=M):M=e[42];let I;return e[43]!==r||e[44]!==k||e[45]!==C||e[46]!==M?(I=(0,s.jsxs)("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-sm flex flex-col items-center justify-center animate-in fade-in duration-300",onClick:r,children:[k,C,M]}),e[43]=r,e[44]=k,e[45]=C,e[46]=M,e[47]=I):I=e[47],I},Qr=Wr;function Kr(t){return t.stopPropagation()}function Vr(t){return t.stopPropagation()}var Hr=({type:t,onComplete:e,onSwitch:a})=>{const{login:i,signup:r}=ce(),{addToast:n}=ye(),[l,o]=(0,w.useState)({name:"",email:"",username:"",password:""}),[c,d]=(0,w.useState)(!1),[u,m]=(0,w.useState)(null),f=async x=>{x.preventDefault(),d(!0),m(null);try{t==="login"?(await i({email:l.email,password:l.password}),n("Welcome back!")):(await r({email:l.email,password:l.password,username:l.username,name:l.name}),n("Account created successfully!")),e()}catch(p){console.error("Auth error:",p),m(p.message||"Authentication failed. Please check your credentials."),n("Authentication failed!")}finally{d(!1)}};return(0,s.jsxs)("div",{className:"max-w-md mx-auto p-8 w-full animate-in fade-in slide-in-from-bottom-5 duration-300",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("div",{className:"flex justify-center mb-4",children:(0,s.jsx)("div",{className:"bg-black dark:bg-white dark:text-black text-white p-3 rounded-2xl shadow-lg",children:(0,s.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",alt:"Logo",className:"w-10 h-10 rounded-xl"})})}),(0,s.jsx)("h2",{className:"text-3xl font-extrabold mb-2 dark:text-white tracking-tight",children:t==="login"?"Welcome back!":"Join Sysm today"}),(0,s.jsx)("p",{className:"text-zinc-500 font-medium",children:"The decentralized social network"})]}),u&&(0,s.jsxs)("div",{className:"mb-6 p-4 bg-rose-50 dark:bg-rose-900/20 border border-rose-100 dark:border-rose-800 rounded-xl flex items-center gap-3 text-rose-600 dark:text-rose-400 text-sm",children:[(0,s.jsx)(zs,{size:18}),(0,s.jsx)("span",{children:u})]}),(0,s.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,s.jsx)(je,{label:"Email",type:"email",placeholder:"john@example.com",value:l.email,onChange:x=>o({...l,email:x.target.value}),required:!0}),t==="signup"&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(je,{label:"Name",placeholder:"John Doe",value:l.name,onChange:x=>o({...l,name:x.target.value}),required:!0}),(0,s.jsx)(je,{label:"Username",placeholder:"johndoe",value:l.username,onChange:x=>o({...l,username:x.target.value}),required:!0})]}),(0,s.jsx)(je,{label:"Password",type:"password",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",value:l.password,onChange:x=>o({...l,password:x.target.value}),required:!0}),(0,s.jsx)(fe,{type:"submit",className:"w-full justify-center py-3 mt-6 text-lg",disabled:c,children:c?(0,s.jsx)(oe,{size:24,className:"animate-spin"}):t==="login"?"Log in":"Sign up"})]}),(0,s.jsxs)("div",{className:"mt-8 text-center text-sm",children:[(0,s.jsx)("span",{className:"text-zinc-500",children:t==="login"?"Don't have an account?":"Already have an account?"}),(0,s.jsx)("button",{onClick:a,className:"font-bold ml-1 hover:underline dark:text-white",children:t==="login"?"Sign up":"Log in"})]})]})},Ur=Hr,Jr=Q(),Gr=t=>{const e=(0,Jr.c)(2),{children:a}=t;let i;return e[0]!==a?(i=(0,s.jsx)("div",{className:"w-full animate-in fade-in slide-in-from-bottom-2 duration-300 ease-out",children:a}),e[0]=a,e[1]=i):i=e[1],i},pe=Gr,Zr=Q(),Xr=t=>{const e=(0,Zr.c)(24),{user:a,onClick:i,isAddStory:r}=t,n=r===void 0?!1:r,l=`relative p-0.5 rounded-full ${n?"bg-transparent":"bg-gradient-to-tr from-yellow-400 via-pink-500 to-violet-600"}`;let o;e[0]!==a.avatar||e[1]!==a.handle?(o=(0,s.jsx)(ne,{src:a.avatar,alt:a.handle,className:"object-cover"}),e[0]=a.avatar,e[1]=a.handle,e[2]=o):o=e[2];let c;e[3]!==a.handle?.[0]?(c=a.handle?.[0]?.toUpperCase(),e[3]=a.handle?.[0],e[4]=c):c=e[4];let d;e[5]!==c?(d=(0,s.jsx)(le,{children:c}),e[5]=c,e[6]=d):d=e[6];let u;e[7]!==o||e[8]!==d?(u=(0,s.jsxs)(re,{className:"size-14 sm:size-16 border border-zinc-100 dark:border-zinc-800",children:[o,d]}),e[7]=o,e[8]=d,e[9]=u):u=e[9];let m;e[10]!==n?(m=n&&(0,s.jsx)("div",{className:"absolute bottom-0 right-0 bg-violet-600 border-2 border-white dark:border-black rounded-full p-1 text-white shadow-lg",children:(0,s.jsx)(Ne,{size:14,strokeWidth:3})}),e[10]=n,e[11]=m):m=e[11];let f;e[12]!==u||e[13]!==m?(f=(0,s.jsx)("div",{className:"bg-white dark:bg-black rounded-full p-0.5",children:(0,s.jsxs)("div",{className:"relative",children:[u,m]})}),e[12]=u,e[13]=m,e[14]=f):f=e[14];let x;e[15]!==l||e[16]!==f?(x=(0,s.jsx)("div",{className:l,children:f}),e[15]=l,e[16]=f,e[17]=x):x=e[17];const p=n?"Add Story":a.handle;let b;e[18]!==p?(b=(0,s.jsx)("span",{className:"text-[11px] font-semibold text-zinc-600 dark:text-zinc-400 truncate w-16 text-center leading-tight",children:p}),e[18]=p,e[19]=b):b=e[19];let h;return e[20]!==i||e[21]!==b||e[22]!==x?(h=(0,s.jsxs)("button",{onClick:i,className:"flex flex-col items-center gap-2 group shrink-0",children:[x,b]}),e[20]=i,e[21]=b,e[22]=x,e[23]=h):h=e[23],h},mt=Xr,Te=Q();function Yr(t){const e=(0,Te.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(ua,{"data-slot":"dropdown-menu",...a}),e[2]=a,e[3]=i):i=e[3],i}function en(t){const e=(0,Te.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(da,{"data-slot":"dropdown-menu-trigger",...a}),e[2]=a,e[3]=i):i=e[3],i}function tn(t){const e=(0,Te.c)(10);let a,i,r;e[0]!==t?({className:a,sideOffset:r,...i}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=r):(a=e[1],i=e[2],r=e[3]);const n=r===void 0?4:r;let l;e[4]!==a?(l=J("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",a),e[4]=a,e[5]=l):l=e[5];let o;return e[6]!==i||e[7]!==n||e[8]!==l?(o=(0,s.jsx)(Fs,{children:(0,s.jsx)(ys,{"data-slot":"dropdown-menu-content",sideOffset:n,className:l,...i})}),e[6]=i,e[7]=n,e[8]=l,e[9]=o):o=e[9],o}function Me(t){const e=(0,Te.c)(12);let a,i,r,n;e[0]!==t?({className:a,inset:i,variant:n,...r}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=r,e[4]=n):(a=e[1],i=e[2],r=e[3],n=e[4]);const l=n===void 0?"default":n;let o;e[5]!==a?(o=J("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),e[5]=a,e[6]=o):o=e[6];let c;return e[7]!==i||e[8]!==r||e[9]!==o||e[10]!==l?(c=(0,s.jsx)(js,{"data-slot":"dropdown-menu-item","data-inset":i,"data-variant":l,className:o,...r}),e[7]=i,e[8]=r,e[9]=o,e[10]=l,e[11]=c):c=e[11],c}function sn(t){const e=(0,Te.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=J("bg-border -mx-1 my-1 h-px",a),e[3]=a,e[4]=r):r=e[4];let n;return e[5]!==i||e[6]!==r?(n=(0,s.jsx)(ps,{"data-slot":"dropdown-menu-separator",className:r,...i}),e[5]=i,e[6]=r,e[7]=n):n=e[7],n}var he=Q();function ut(t){const e=(0,he.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(La,{"data-slot":"alert-dialog",...a}),e[2]=a,e[3]=i):i=e[3],i}function an(t){const e=(0,he.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(vs,{"data-slot":"alert-dialog-portal",...a}),e[2]=a,e[3]=i):i=e[3],i}function rn(t){const e=(0,he.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=J("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),e[3]=a,e[4]=r):r=e[4];let n;return e[5]!==i||e[6]!==r?(n=(0,s.jsx)(Ds,{"data-slot":"alert-dialog-overlay",className:r,...i}),e[5]=i,e[6]=r,e[7]=n):n=e[7],n}function ft(t){const e=(0,he.c)(9);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsx)(rn,{}),e[3]=r):r=e[3];let n;e[4]!==a?(n=J("bg-white dark:bg-zinc-950 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-2xl border border-zinc-100 dark:border-zinc-800 p-6 shadow-xl duration-200 sm:max-w-md",a),e[4]=a,e[5]=n):n=e[5];let l;return e[6]!==i||e[7]!==n?(l=(0,s.jsxs)(an,{children:[r,(0,s.jsx)(Ys,{"data-slot":"alert-dialog-content",className:n,...i})]}),e[6]=i,e[7]=n,e[8]=l):l=e[8],l}function xt(t){const e=(0,he.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=J("flex flex-col gap-2 text-center sm:text-left",a),e[3]=a,e[4]=r):r=e[4];let n;return e[5]!==i||e[6]!==r?(n=(0,s.jsx)("div",{"data-slot":"alert-dialog-header",className:r,...i}),e[5]=i,e[6]=r,e[7]=n):n=e[7],n}function ht(t){const e=(0,he.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=J("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),e[3]=a,e[4]=r):r=e[4];let n;return e[5]!==i||e[6]!==r?(n=(0,s.jsx)("div",{"data-slot":"alert-dialog-footer",className:r,...i}),e[5]=i,e[6]=r,e[7]=n):n=e[7],n}function pt(t){const e=(0,he.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=J("text-lg font-semibold",a),e[3]=a,e[4]=r):r=e[4];let n;return e[5]!==i||e[6]!==r?(n=(0,s.jsx)(Qs,{"data-slot":"alert-dialog-title",className:r,...i}),e[5]=i,e[6]=r,e[7]=n):n=e[7],n}function bt(t){const e=(0,he.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=J("text-muted-foreground text-sm",a),e[3]=a,e[4]=r):r=e[4];let n;return e[5]!==i||e[6]!==r?(n=(0,s.jsx)(Ia,{"data-slot":"alert-dialog-description",className:r,...i}),e[5]=i,e[6]=r,e[7]=n):n=e[7],n}function gt(t){const e=(0,he.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=J("inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-bold transition-all active:scale-95 bg-zinc-900 text-white hover:bg-zinc-800 dark:bg-white dark:text-black dark:hover:bg-zinc-200",a),e[3]=a,e[4]=r):r=e[4];let n;return e[5]!==i||e[6]!==r?(n=(0,s.jsx)($a,{className:r,...i}),e[5]=i,e[6]=r,e[7]=n):n=e[7],n}function vt(t){const e=(0,he.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=J("inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-bold border border-zinc-200 bg-white text-zinc-900 hover:bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-950 dark:text-zinc-50 dark:hover:bg-zinc-900",a),e[3]=a,e[4]=r):r=e[4];let n;return e[5]!==i||e[6]!==r?(n=(0,s.jsx)(Ra,{className:r,...i}),e[5]=i,e[6]=r,e[7]=n):n=e[7],n}var nn=Q();function ln(t){const e=(0,nn.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=J("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),e[3]=a,e[4]=r):r=e[4];let n;return e[5]!==i||e[6]!==r?(n=(0,s.jsx)("textarea",{"data-slot":"textarea",className:r,...i}),e[5]=i,e[6]=r,e[7]=n):n=e[7],n}var on=Q(),cn=()=>{const t=(0,on.c)(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,s.jsx)(Cs,{size:16,className:"fill-blue-500 text-white ml-1 inline-block shrink-0"}),t[0]=e):e=t[0],e},Ae=cn,dn=Q(),mn=t=>{const e=(0,dn.c)(18),{poll:a,onVote:i}=t,r=a.options.reduce(un,0),[n,l]=(0,w.useState)(null);let o;e[0]!==i||e[1]!==n?(o=p=>{n||(l(p),i&&i(p))},e[0]=i,e[1]=n,e[2]=o):o=e[2];const c=o;let d;if(e[3]!==c||e[4]!==a.options||e[5]!==r||e[6]!==n){let p;e[8]!==c||e[9]!==r||e[10]!==n?(p=(b,h)=>{const g=r>0?Math.round((b.votes+(n===b.id?1:0))/(r+(n?1:0))*100):0,v=n===b.id;return(0,s.jsxs)("div",{onClick:z=>{z.stopPropagation(),c(b.id)},className:`relative h-10 w-full rounded-xl overflow-hidden cursor-pointer border ${v?"border-violet-500 dark:border-violet-500":"border-zinc-200 dark:border-zinc-700"}`,children:[n&&(0,s.jsx)("div",{className:"absolute top-0 left-0 h-full bg-zinc-200 dark:bg-zinc-800 transition-all duration-500",style:{width:`${g}%`}}),(0,s.jsxs)("div",{className:"absolute inset-0 flex items-center justify-between px-4 z-10",children:[(0,s.jsxs)("span",{className:`font-medium text-sm ${v?"text-violet-600 font-bold":"text-zinc-700 dark:text-zinc-200"}`,children:[b.text," ",v&&(0,s.jsx)(It,{size:14,className:"inline ml-1 mb-0.5"})]}),n&&(0,s.jsxs)("span",{className:"text-sm font-bold text-zinc-900 dark:text-white",children:[g,"%"]})]})]},b.id||h)},e[8]=c,e[9]=r,e[10]=n,e[11]=p):p=e[11],d=a.options.map(p),e[3]=c,e[4]=a.options,e[5]=r,e[6]=n,e[7]=d}else d=e[7];const u=r+(n?1:0),m=n?"6 days left":"Click to vote";let f;e[12]!==u||e[13]!==m?(f=(0,s.jsxs)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400 pl-1",children:[u," votes â€¢"," ",m]}),e[12]=u,e[13]=m,e[14]=f):f=e[14];let x;return e[15]!==d||e[16]!==f?(x=(0,s.jsxs)("div",{className:"mt-3 space-y-2",children:[d,f]}),e[15]=d,e[16]=f,e[17]=x):x=e[17],x},jt=mn;function un(t,e){return t+e.votes}var fn=Q(),xn=t=>{const e=(0,fn.c)(23),{user:a,time:i,content:r}=t;let n;e[0]!==a.avatar||e[1]!==a.handle?(n=(0,s.jsx)(ne,{src:a.avatar,alt:a.handle}),e[0]=a.avatar,e[1]=a.handle,e[2]=n):n=e[2];let l;e[3]!==a.handle[0]?(l=a.handle[0]?.toUpperCase(),e[3]=a.handle[0],e[4]=l):l=e[4];let o;e[5]!==l?(o=(0,s.jsx)(le,{children:l}),e[5]=l,e[6]=o):o=e[6];let c;e[7]!==n||e[8]!==o?(c=(0,s.jsxs)(re,{className:"size-6",children:[n,o]}),e[7]=n,e[8]=o,e[9]=c):c=e[9];let d;e[10]!==a.handle?(d=(0,s.jsx)("span",{className:"font-semibold text-sm",children:a.handle}),e[10]=a.handle,e[11]=d):d=e[11];let u;e[12]!==i?(u=(0,s.jsxs)("span",{className:"text-zinc-500 text-sm",children:["â€¢ ",i]}),e[12]=i,e[13]=u):u=e[13];let m;e[14]!==c||e[15]!==d||e[16]!==u?(m=(0,s.jsxs)("div",{className:"flex items-center gap-x-2 mb-2",children:[c,d,u]}),e[14]=c,e[15]=d,e[16]=u,e[17]=m):m=e[17];let f;e[18]!==r?(f=(0,s.jsx)("p",{className:"text-sm text-zinc-800 dark:text-zinc-300 whitespace-pre-line",children:r}),e[18]=r,e[19]=f):f=e[19];let x;return e[20]!==m||e[21]!==f?(x=(0,s.jsxs)("div",{className:"p-4",children:[m,f]}),e[20]=m,e[21]=f,e[22]=x):x=e[22],x},yt=xn,hn=Q(),pn=t=>{const e=(0,hn.c)(17),{icon:a,count:i,onClick:r,active:n,activeColorClass:l}=t,o=l===void 0?"text-violet-600":l,c=a;let d;e[0]!==r?(d=v=>{v.stopPropagation(),r&&r(v)},e[0]=r,e[1]=d):d=e[1];const u=`group flex items-center gap-x-2 text-[13px] font-medium transition-all ${n?o:"text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-300"}`,m=`rounded-full p-2 transition-colors ${n?"bg-current/10":"group-hover:bg-zinc-100 dark:group-hover:bg-zinc-800"}`,f=n?2.5:2,x=n?"fill-current":"";let p;e[2]!==c||e[3]!==f||e[4]!==x?(p=(0,s.jsx)(c,{size:18,strokeWidth:f,className:x}),e[2]=c,e[3]=f,e[4]=x,e[5]=p):p=e[5];let b;e[6]!==m||e[7]!==p?(b=(0,s.jsx)("div",{className:m,children:p}),e[6]=m,e[7]=p,e[8]=b):b=e[8];let h;e[9]!==n||e[10]!==i?(h=i!=null&&(0,s.jsx)("span",{className:n?"font-bold":"",children:i||0}),e[9]=n,e[10]=i,e[11]=h):h=e[11];let g;return e[12]!==d||e[13]!==u||e[14]!==b||e[15]!==h?(g=(0,s.jsxs)("button",{onClick:d,className:u,children:[b,h]}),e[12]=d,e[13]=u,e[14]=b,e[15]=h,e[16]=g):g=e[16],g},Se=pn,bn=Q(),gn=t=>{const e=(0,bn.c)(12),{src:a,poster:i}=t,r=(0,w.useRef)(null);let n,l;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=()=>{const x=new IntersectionObserver(b=>{const[h]=b;r.current?.plyr&&(h.isIntersecting?r.current.plyr.play().catch(()=>{r.current.plyr.muted=!0,r.current.plyr.play()}):r.current.plyr.pause())},{threshold:.6}),p=r.current?.elements?.container;return p&&x.observe(p),()=>{p&&x.unobserve(p)}},l=[],e[0]=n,e[1]=l):(n=e[0],l=e[1]),(0,w.useEffect)(n,l);let o;e[2]!==a?(o=[{src:a,type:"video/mp4"}],e[2]=a,e[3]=o):o=e[3];let c;e[4]!==i||e[5]!==o?(c={type:"video",sources:o,poster:i},e[4]=i,e[5]=o,e[6]=c):c=e[6];let d;e[7]===Symbol.for("react.memo_cache_sentinel")?(d={controls:["play-large","play","progress","current-time","mute","volume","fullscreen"],settings:["quality","speed"],ratio:"16:9",clickToPlay:!0,hideControls:!0,resetOnEnd:!0},e[7]=d):d=e[7];let u;e[8]!==c?(u={source:c,options:d},e[8]=c,e[9]=u):u=e[9];const m=u;let f;return e[10]!==m?(f=(0,s.jsx)("div",{className:"mt-3 overflow-hidden rounded-2xl shadow-sm border border-zinc-100 dark:border-zinc-800 bg-black",onClick:jn,children:(0,s.jsx)(Rt,{ref:r,...m})}),e[10]=m,e[11]=f):f=e[11],f},vn=gn;function jn(t){return t.stopPropagation()}var yn=Q(),wn=t=>{const e=(0,yn.c)(17),{file:a}=t;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsx)("div",{className:"size-10 rounded-xl bg-violet-100 dark:bg-violet-900/30 flex items-center justify-center text-violet-600",children:(0,s.jsx)(St,{size:20})}),e[0]=i):i=e[0];let r;e[1]!==a.name?(r=(0,s.jsx)("div",{className:"text-sm font-bold truncate dark:text-white",children:a.name}),e[1]=a.name,e[2]=r):r=e[2];const n=a.size/1024/1024;let l;e[3]!==n?(l=n.toFixed(2),e[3]=n,e[4]=l):l=e[4];let o;e[5]!==l?(o=(0,s.jsxs)("div",{className:"text-xs text-zinc-500 uppercase",children:[l," MB"]}),e[5]=l,e[6]=o):o=e[6];let c;e[7]!==r||e[8]!==o?(c=(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[r,o]}),e[7]=r,e[8]=o,e[9]=c):c=e[9];let d;e[10]===Symbol.for("react.memo_cache_sentinel")?(d=(0,s.jsx)(_t,{size:18}),e[10]=d):d=e[10];let u;e[11]!==a.name||e[12]!==a.url?(u=(0,s.jsx)("a",{href:a.url,download:a.name,className:"p-2 text-zinc-400 hover:text-violet-600 transition-colors",onClick:Nn,children:d}),e[11]=a.name,e[12]=a.url,e[13]=u):u=e[13];let m;return e[14]!==c||e[15]!==u?(m=(0,s.jsxs)("div",{className:"mt-3 flex items-center gap-3 p-3 rounded-2xl border border-zinc-100 dark:border-zinc-800 bg-zinc-50/50 dark:bg-zinc-900/10 group hover:border-violet-500/30 transition-colors",children:[i,c,u]}),e[14]=c,e[15]=u,e[16]=m):m=e[16],m},zn=wn;function Nn(t){return t.stopPropagation()}var kn=Q(),_n=t=>{const e=(0,kn.c)(3),{items:a}=t,i=a===void 0?[]:a,{openLightbox:r}=st();if(!i||i.length===0)return null;const n=Array.isArray(i)?i:[i],l=n.filter(Sn),o=n.filter($n),c=x=>{const p=l.filter(Pn).map(Ln),b=l[x];r(p,p.indexOf(b.url||b.src))},d="mt-3 space-y-2",u=l.length>0&&(0,s.jsx)("div",{className:`grid gap-2 rounded-2xl overflow-hidden border border-zinc-100 dark:border-zinc-800 ${l.length===1?"grid-cols-1":l.length===2?"grid-cols-2 aspect-[16/9]":(l.length===3,"grid-cols-2 grid-rows-2 aspect-[16/9]")}`,children:l.map((x,p)=>(0,s.jsx)("div",{className:`relative overflow-hidden bg-zinc-100 dark:bg-zinc-900 cursor-pointer ${l.length===3&&p===0?"row-span-2":""}`,onClick:b=>{x.type==="image"&&(b.stopPropagation(),c(p))},children:x.type==="video"?(0,s.jsx)(vn,{src:x.url,poster:x.poster}):(0,s.jsx)("img",{src:x.url||x.src,className:"size-full object-cover hover:scale-[1.02] transition-transform duration-500",alt:"",loading:"lazy"})},p))}),m=o.map(Mn);let f;return e[0]!==u||e[1]!==m?(f=(0,s.jsxs)("div",{className:d,children:[u,m]}),e[0]=u,e[1]=m,e[2]=f):f=e[2],f},Cn=_n;function Sn(t){return t.type==="image"||t.type==="video"}function $n(t){return t.type==="file"}function Pn(t){return t.type==="image"}function Ln(t){return t.url||t.src}function Mn(t,e){return(0,s.jsx)(zn,{file:t},e)}var In=Q(),Fn=t=>{const e=(0,In.c)(6),{currentUser:a,newComment:i,setNewComment:r,handleSubmitComment:n,loading:l}=t;let o;return e[0]!==a||e[1]!==n||e[2]!==l||e[3]!==i||e[4]!==r?(o=a?(0,s.jsx)("div",{className:"p-4 border-y border-zinc-100 dark:border-zinc-800 bg-zinc-50/30 dark:bg-zinc-900/10",children:(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)(re,{className:"size-9 border border-zinc-200 dark:border-zinc-700",children:[(0,s.jsx)(ne,{src:a.avatar,alt:a.handle,className:"object-cover"}),(0,s.jsx)(le,{children:a.handle?.[0]?.toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("textarea",{id:"comment-input",className:"w-full bg-transparent outline-none text-base min-h-[60px] resize-none dark:text-white placeholder:text-zinc-500",placeholder:"Post your reply...",value:i,onChange:c=>r(c.target.value)}),(0,s.jsxs)("div",{className:"flex justify-between items-center mt-2 pt-3 border-t border-zinc-100 dark:border-zinc-800",children:[(0,s.jsxs)("div",{className:"flex text-violet-600 gap-1",children:[(0,s.jsx)("button",{className:"text-violet-600 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full p-2",children:(0,s.jsx)(Ne,{size:20})}),(0,s.jsx)("button",{className:"text-violet-600 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full p-2",children:(0,s.jsx)(et,{size:20})})]}),(0,s.jsx)(fe,{className:"!w-auto px-5 py-1.5 text-sm font-bold min-w-[70px]",onClick:n,disabled:!i.trim()||l,children:l?(0,s.jsx)(oe,{size:16,className:"animate-spin text-white mx-auto"}):"Reply"})]})]})]})}):(0,s.jsx)("div",{className:"p-6 text-center border-y border-zinc-100 dark:border-zinc-800 bg-zinc-50/30 dark:bg-zinc-900/10",children:(0,s.jsx)("p",{className:"text-zinc-500 text-sm",children:"Please login to join the conversation."})}),e[0]=a,e[1]=n,e[2]=l,e[3]=i,e[4]=r,e[5]=o):o=e[5],o},Rn=Fn;const Tn=(t,e,a,i)=>{const[r,n]=(0,w.useState)(!1),[l,o]=(0,w.useState)(!1),[c,d]=(0,w.useState)(e||{comments:0,likes:0,mirrors:0});return(0,w.useEffect)(()=>{a&&t&&be(t)&&be(a.id)&&gi(t,a.id).then(n).catch(()=>n(!1))},[t,a]),{liked:r,reposted:l,localStats:c,setLocalStats:d,handleLike:async f=>{if(f&&f.stopPropagation(),!a)return i("Please login to like!","error");if(!be(t)||!be(a.id)){const x=!r;n(x),d(p=>({...p,likes:x?(p.likes||0)+1:(p.likes||0)-1})),i(x?"Liked":"Unliked");return}try{const x=await bi(t,a.id);n(x),d(p=>({...p,likes:x?(p.likes||0)+1:(p.likes||0)-1})),i(x?"Liked":"Unliked")}catch(x){console.error("Failed to toggle like:",x),i("Failed to update like state","error")}},handleRepost:f=>{if(f&&f.stopPropagation(),!a)return i("Please login to repost!","error");o(!l),d(x=>({...x,mirrors:l?(x.mirrors||0)-1:(x.mirrors||0)+1})),i(l?"Removed repost":"Reposted")}}};var ns=({id:t,user:e,timeAgo:a,content:i,contentClass:r,media:n,quotedPost:l,stats:o,onClick:c,repostedBy:d,onUserClick:u,currentUser:m,showToast:f,poll:x,isDetail:p,initialComments:b,onDelete:h})=>{const{liked:g,reposted:v,localStats:z,setLocalStats:_,handleLike:y,handleRepost:k}=Tn(t,o,m,f),{deletePost:$,updatePost:S}=Pe(),[L,C]=(0,w.useState)(b||[]),[M,I]=(0,w.useState)(""),[O,T]=(0,w.useState)(!1),[W,q]=(0,w.useState)(!1),[E,j]=(0,w.useState)(!1),[N,F]=(0,w.useState)(!1),[P,A]=(0,w.useState)(i),[K,H]=(0,w.useState)(n||[]),[V,U]=(0,w.useState)(!1),G=async()=>{const D=JSON.stringify(K)!==JSON.stringify(n||[]);if(!P.trim()||P===i&&!D){F(!1);return}U(!0);try{await S(t,{content:P,media:K}),F(!1),f&&f("Post updated")}catch(R){console.error("Failed to update post:",R),f&&f("Failed to update post")}finally{U(!1)}},te=async D=>{D&&D.stopPropagation();try{await $(t),f&&f("Post deleted successfully"),h&&h(t)}catch(R){console.error("Failed to delete post:",R),f&&f("Failed to delete post")}finally{j(!1)}},se=(0,w.useCallback)(async()=>{if(t){T(!0);try{C(await hi(t))}catch(D){console.error("Failed to load comments:",D)}finally{T(!1)}}},[t]);(0,w.useEffect)(()=>{p&&t&&se()},[p,t,se]);const ie=async D=>{if(D.preventDefault(),!(!M.trim()||!m)){q(!0);try{await pi(t,m.id,M),I(""),_(R=>({...R,comments:(R.comments||0)+1})),f&&f("Reply posted!"),se()}catch(R){console.error("Failed to post comment:",R),f&&f("Failed to post reply.")}finally{q(!1)}}},Y=D=>{D.stopPropagation();const R=`${window.location.origin}/post/${t}`;navigator.clipboard.writeText(R),f&&f("Link copied to clipboard!")},me=({trigger:D})=>(0,s.jsxs)(Yr,{children:[(0,s.jsx)(en,{asChild:!0,onClick:R=>R.stopPropagation(),children:D}),(0,s.jsxs)(tn,{align:"end",className:"w-48 rounded-xl bg-white dark:bg-zinc-900 border-zinc-100 dark:border-zinc-800",children:[(0,s.jsxs)(Me,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5",onClick:Y,children:[(0,s.jsx)(Bt,{size:16}),(0,s.jsx)("span",{children:"Copy link to post"})]}),(0,s.jsxs)(Me,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5",onClick:R=>{R.stopPropagation(),f&&f("Post reported")},children:[(0,s.jsx)(Ks,{size:16}),(0,s.jsx)("span",{children:"Report post"})]}),!Z&&(0,s.jsxs)(Me,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5 text-rose-500 focus:text-rose-500",onClick:R=>{R.stopPropagation(),f&&f("User blocked")},children:[(0,s.jsx)(Zs,{size:16}),(0,s.jsxs)("span",{children:["Block @",e.handle]})]}),Z&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(sn,{className:"bg-zinc-100 dark:bg-zinc-800"}),(0,s.jsxs)(Me,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-900 py-2.5",onClick:R=>{R.stopPropagation(),F(!0)},children:[(0,s.jsx)(At,{size:16}),(0,s.jsx)("span",{children:"Edit post"})]}),(0,s.jsxs)(Me,{className:"gap-2 cursor-pointer focus:bg-rose-50 dark:focus:bg-rose-900/20 py-2.5 text-rose-500 focus:text-rose-500",onClick:R=>{R.stopPropagation(),j(!0)},children:[(0,s.jsx)(Et,{size:16}),(0,s.jsx)("span",{children:"Delete post"})]})]})]})]}),Z=m?.handle===e.handle,X=D=>{if(!D)return null;const R=N?K:D;return!R||Array.isArray(R)&&R.length===0?null:N?(0,s.jsx)("div",{className:"mt-3 grid gap-2 grid-cols-2 sm:grid-cols-3",children:R.map((ee,de)=>(0,s.jsxs)("div",{className:"relative aspect-square rounded-xl overflow-hidden border border-zinc-200 dark:border-zinc-800 group",children:[ee.type==="video"?(0,s.jsx)("div",{className:"size-full bg-zinc-100 dark:bg-zinc-900 flex items-center justify-center",children:(0,s.jsx)(Ze,{size:24,className:"text-zinc-400"})}):(0,s.jsx)("img",{src:ee.url||ee.src,className:"size-full object-cover",alt:""}),(0,s.jsx)("button",{onClick:ve=>{ve.stopPropagation(),H(Qe=>Qe.filter((lo,xs)=>xs!==de))},className:"absolute top-1.5 right-1.5 size-7 rounded-full bg-black/60 text-white flex items-center justify-center hover:bg-black transition-colors",children:(0,s.jsx)(xe,{size:16})})]},de))}):w.isValidElement(R)?R:(0,s.jsx)(Cn,{items:R})},ae=(D,R)=>{const ee=typeof D=="string"&&Xi(D);return N?(0,s.jsxs)("div",{className:"flex flex-col gap-2 mt-2",onClick:de=>de.stopPropagation(),children:[(0,s.jsx)(ln,{value:P,onChange:de=>A(de.target.value),className:`min-h-[100px] w-full bg-zinc-50 dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800 rounded-xl focus:ring-violet-500 ${ee?"font-bangla text-lg":"font-english"}`,autoFocus:!0}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)("button",{onClick:()=>{F(!1),A(i),H(n||[])},className:"px-4 py-1.5 text-sm font-bold text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-300 transition-colors",children:"Cancel"}),(0,s.jsx)("button",{onClick:G,disabled:V||!P.trim()||P===i,className:"px-4 py-1.5 text-sm font-bold bg-violet-600 text-white rounded-full hover:bg-violet-700 disabled:opacity-50 transition-all active:scale-95",children:V?"Saving...":"Save"})]})]}):typeof D=="string"?(0,s.jsx)("p",{className:`whitespace-pre-line ${R||""} ${ee?"font-bangla text-[1.15em] leading-relaxed":"font-english text-[1.05em]"}`,children:D}):D};return p?(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("article",{className:"p-5 dark:bg-black",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex items-start gap-x-3",children:[(0,s.jsx)("button",{className:"shrink-0",onClick:()=>u&&u(e.handle),children:(0,s.jsxs)(re,{className:"size-12 border border-zinc-200 dark:border-zinc-700",children:[(0,s.jsx)(ne,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,s.jsx)(le,{children:e.handle[0]?.toUpperCase()})]})}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("div",{className:"flex flex-wrap items-center gap-x-1",children:(0,s.jsxs)("button",{className:"font-bold hover:underline text-zinc-900 dark:text-white flex items-center gap-1 text-base",onClick:()=>u&&u(e.handle),children:[e.handle,e.verified&&(0,s.jsx)(Ae,{})]})}),(0,s.jsxs)("span",{className:"text-sm text-zinc-500 dark:text-zinc-400",children:["@",e.handle]})]})]}),(0,s.jsx)(me,{trigger:(0,s.jsx)("button",{className:"text-zinc-500 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full p-2 transition-colors",children:(0,s.jsx)(Ue,{size:20})})})]}),(0,s.jsx)("div",{className:"break-words text-zinc-900 dark:text-zinc-100 mt-4 text-xl leading-8 whitespace-pre-line",children:ae(i,r)}),X(n),x&&(0,s.jsx)(jt,{poll:x}),l&&(0,s.jsx)("div",{className:"mt-4 border border-zinc-200 dark:border-zinc-700 rounded-2xl overflow-hidden shadow-sm",children:(0,s.jsx)(yt,{...l})}),(0,s.jsx)("div",{className:"my-4 flex items-center text-zinc-500 dark:text-zinc-400 text-sm border-b border-zinc-100 dark:border-zinc-800 pb-4",children:a||"Recent"}),(0,s.jsxs)("div",{className:"border-b border-zinc-100 dark:border-zinc-800 pb-4 flex items-center gap-x-6 text-zinc-500 dark:text-zinc-400 text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,s.jsx)("span",{className:"font-bold text-black dark:text-white",children:z.likes||0})," ",(0,s.jsx)("span",{className:"opacity-70",children:"Likes"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,s.jsx)("span",{className:"font-bold text-black dark:text-white",children:z.comments||0})," ",(0,s.jsx)("span",{className:"opacity-70",children:"Comments"})]})]}),(0,s.jsxs)("div",{className:"mt-4 flex w-full items-center justify-around py-1",children:[(0,s.jsx)(Se,{icon:Ie,onClick:y,active:g,activeColorClass:"text-rose-500"}),(0,s.jsx)(Se,{icon:Ve,onClick:k,active:v,activeColorClass:"text-emerald-500"}),(0,s.jsx)(Se,{icon:Je,onClick:()=>document.getElementById("comment-input")?.focus()})]})]}),(0,s.jsx)(Rn,{currentUser:m,newComment:M,setNewComment:I,handleSubmitComment:ie,loading:W}),(0,s.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:O?(0,s.jsx)("div",{className:"p-8 flex justify-center",children:(0,s.jsx)(oe,{className:"animate-spin text-violet-500"})}):L.map(D=>(0,s.jsx)(ns,{...D,onUserClick:u,currentUser:m,showToast:f,onDelete:R=>C(ee=>ee.filter(de=>de.id!==R))},D.id))}),(0,s.jsx)(ut,{open:E,onOpenChange:j,children:(0,s.jsxs)(ft,{onClick:D=>D.stopPropagation(),children:[(0,s.jsxs)(xt,{children:[(0,s.jsx)(pt,{children:"Are you absolutely sure?"}),(0,s.jsx)(bt,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,s.jsxs)(ht,{children:[(0,s.jsx)(vt,{onClick:D=>D.stopPropagation(),children:"Cancel"}),(0,s.jsx)(gt,{onClick:te,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]}):(0,s.jsxs)("article",{onClick:c,className:`px-5 pt-4 pb-3 hover:bg-zinc-50/80 dark:hover:bg-zinc-900/40 transition-colors border-b border-zinc-100 dark:border-zinc-800 last:border-0 ${c?"cursor-pointer":""}`,children:[d&&(0,s.jsxs)("div",{className:"mb-2 flex items-center space-x-1.5 text-[13px] text-zinc-500 font-semibold ml-1",children:[(0,s.jsx)(Ve,{size:14,className:"text-zinc-400"}),(0,s.jsx)("span",{className:"hover:underline cursor-pointer flex items-center text-zinc-600 dark:text-zinc-400",onClick:D=>{D.stopPropagation(),u&&u(d.handle)},children:(0,s.jsx)("span",{className:"truncate max-w-[150px]",children:typeof d=="object"?d.name:d})}),(0,s.jsx)("span",{className:"text-zinc-400",children:"reposted"})]}),(0,s.jsxs)("div",{className:"flex items-start gap-x-3",children:[(0,s.jsx)("button",{className:"shrink-0 group",onClick:D=>{D.stopPropagation(),u&&u(e.handle)},children:(0,s.jsxs)(re,{className:"size-11 border border-zinc-200 dark:border-zinc-700 group-hover:brightness-95 transition-all",children:[(0,s.jsx)(ne,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,s.jsx)(le,{children:e.handle[0]?.toUpperCase()})]})}),(0,s.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,s.jsxs)("div",{className:"flex w-full items-start justify-between",children:[(0,s.jsx)("div",{className:"flex flex-col min-w-0",children:(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-x-1",children:[(0,s.jsxs)("button",{className:"font-bold hover:underline text-zinc-900 dark:text-white flex items-center gap-1 truncate text-[15px]",onClick:D=>{D.stopPropagation(),u&&u(e.handle)},children:[(0,s.jsx)("span",{className:"truncate",children:e.handle}),e.verified&&(0,s.jsx)(Ae,{})]}),(0,s.jsxs)("span",{className:"text-zinc-400 text-sm ml-1 whitespace-nowrap",children:["â€¢ ",a||"Recent"]})]})}),(0,s.jsx)(me,{trigger:(0,s.jsx)("button",{className:"text-zinc-400 hover:bg-zinc-100 hover:text-zinc-700 dark:hover:bg-zinc-800 dark:hover:text-zinc-200 rounded-full p-2 -mr-2 transition-colors",children:(0,s.jsx)(Ue,{size:18})})})]}),(0,s.jsxs)("div",{className:"break-words text-zinc-900 dark:text-zinc-100 mt-1 whitespace-pre-line text-[15px] leading-relaxed",children:[ae(i,r),X(n),x&&(0,s.jsx)(jt,{poll:x,onVote:()=>f&&f("Voted!")}),l&&(0,s.jsx)("div",{className:"mt-3 border border-zinc-200 dark:border-zinc-700 rounded-2xl overflow-hidden bg-white dark:bg-zinc-900 hover:bg-zinc-50 dark:hover:bg-zinc-800 transition-colors cursor-pointer",onClick:D=>D.stopPropagation(),children:(0,s.jsx)(yt,{...l})})]}),(0,s.jsx)("div",{className:"mt-3 flex w-full flex-wrap items-center justify-between gap-3 pr-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-6",children:[(0,s.jsx)(Se,{icon:Ie,count:z.likes,active:g,onClick:y,activeColorClass:"text-rose-500"}),(0,s.jsx)(Se,{icon:Ve,count:z.mirrors,active:v,onClick:k,activeColorClass:"text-emerald-500"}),(0,s.jsx)(Se,{icon:Je,count:z.comments,onClick:c})]})})]})]}),(0,s.jsx)(ut,{open:E,onOpenChange:j,children:(0,s.jsxs)(ft,{onClick:D=>D.stopPropagation(),children:[(0,s.jsxs)(xt,{children:[(0,s.jsx)(pt,{children:"Are you absolutely sure?"}),(0,s.jsx)(bt,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,s.jsxs)(ht,{children:[(0,s.jsx)(vt,{onClick:D=>D.stopPropagation(),children:"Cancel"}),(0,s.jsx)(gt,{onClick:te,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]})},Be=ns,On=Q(),En=()=>{const t=(0,On.c)(3);let e;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,s.jsx)("div",{className:"size-11 rounded-full bg-zinc-200 dark:bg-zinc-800 shrink-0"}),t[0]=e):e=t[0];let a;t[1]===Symbol.for("react.memo_cache_sentinel")?(a=(0,s.jsx)("div",{className:"h-4 bg-zinc-200 dark:bg-zinc-800 rounded w-1/3"}),t[1]=a):a=t[1];let i;return t[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsx)("div",{className:"px-5 pt-4 pb-3 border-b border-zinc-100 dark:border-zinc-800 animate-pulse",children:(0,s.jsxs)("div",{className:"flex items-start gap-x-3",children:[e,(0,s.jsxs)("div",{className:"flex-1 space-y-3",children:[a,(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"h-3 bg-zinc-200 dark:bg-zinc-800 rounded w-full"}),(0,s.jsx)("div",{className:"h-3 bg-zinc-200 dark:bg-zinc-800 rounded w-5/6"})]}),(0,s.jsx)("div",{className:"h-48 bg-zinc-200 dark:bg-zinc-800 rounded-xl w-full"})]})]})}),t[2]=i):i=t[2],i},lt=En,An=Q(),qn=t=>{const e=(0,An.c)(48),{onStoryClick:a,onAddStory:i}=t,{currentUser:r}=ce(),{posts:n,loading:l,hasMore:o,isFetchingNextPage:c,fetchNextPage:d}=Pe(),{addToast:u}=ye(),m=_e();let f;e[0]===Symbol.for("react.memo_cache_sentinel")?(f={threshold:.1},e[0]=f):f=e[0];const{ref:x,inView:p}=Ls(f);let b,h;e[1]!==d||e[2]!==o||e[3]!==p||e[4]!==c?(b=()=>{p&&o&&!c&&d()},h=[p,o,c,d],e[1]=d,e[2]=o,e[3]=p,e[4]=c,e[5]=b,e[6]=h):(b=e[5],h=e[6]),(0,w.useEffect)(b,h);let g;e[7]===Symbol.for("react.memo_cache_sentinel")?(g={queryKey:["stories"],queryFn:wi},e[7]=g):g=e[7];const{data:v,isLoading:z}=ge(g);let _;e[8]!==v?(_=v===void 0?[]:v,e[8]=v,e[9]=_):_=e[9];const y=_;let k;if(e[10]!==y){const A={};y.forEach(K=>{const H=K.user.id;A[H]||(A[H]={user:K.user,stories:[]}),A[H].stories.push(K)}),k=Object.values(A),e[10]=y,e[11]=k}else k=e[11];const $=k;let S;e[12]!==n?(S=n.filter(Bn),e[12]=n,e[13]=S):S=e[13];const L=S;let C;e[14]!==m?(C=A=>{m(`/post/${A}`)},e[14]=m,e[15]=C):C=e[15];const M=C;let I;e[16]!==m?(I=A=>{m(`/u/${A}`)},e[16]=m,e[17]=I):I=e[17];const O=I;if(l||z){let A;return e[18]===Symbol.for("react.memo_cache_sentinel")?(A=(0,s.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:[(0,s.jsxs)("div",{className:"flex gap-3 overflow-x-auto no-scrollbar py-4 px-4 bg-white dark:bg-black border-b border-zinc-100 dark:border-zinc-800",children:[(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"}),(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"}),(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"})]}),[1,2,3].map(Wn)]}),e[18]=A):A=e[18],A}let T;e[19]!==r||e[20]!==i?(T=r&&(0,s.jsx)(mt,{user:r,isAddStory:!0,onClick:i}),e[19]=r,e[20]=i,e[21]=T):T=e[21];let W;e[22]!==$||e[23]!==a?(W=$.map(A=>(0,s.jsx)(mt,{user:A.user,onClick:()=>a(A)},A.user.id)),e[22]=$,e[23]=a,e[24]=W):W=e[24];let q;e[25]!==T||e[26]!==W?(q=(0,s.jsxs)("div",{className:"flex gap-4 overflow-x-auto no-scrollbar py-4 px-4 bg-white dark:bg-black border-b border-zinc-100 dark:border-zinc-800",children:[T,W]}),e[25]=T,e[26]=W,e[27]=q):q=e[27];let E;e[28]!==r?(E=!r&&(0,s.jsx)("div",{className:"px-4 py-2 md:hidden",children:(0,s.jsx)(Yt,{className:"p-6"})}),e[28]=r,e[29]=E):E=e[29];let j;e[30]!==u||e[31]!==r||e[32]!==M||e[33]!==O||e[34]!==L?(j=L.length>0?L.map(A=>(0,s.jsx)(Be,{...A,currentUser:r,showToast:u,onClick:()=>M(A.id),onUserClick:O},A.id)):(0,s.jsxs)("div",{className:"p-20 text-center text-zinc-500",children:[(0,s.jsx)("p",{className:"text-lg font-medium",children:"No posts yet."}),(0,s.jsx)("p",{className:"text-sm",children:"Be the first to share something amazing!"})]}),e[30]=u,e[31]=r,e[32]=M,e[33]=O,e[34]=L,e[35]=j):j=e[35];let N;e[36]!==o||e[37]!==L.length||e[38]!==c||e[39]!==x?(N=L.length>0&&(0,s.jsx)("div",{ref:x,className:"py-8 flex justify-center",children:c?(0,s.jsx)(oe,{className:"animate-spin text-violet-500",size:24}):o?(0,s.jsx)("div",{className:"h-4"}):(0,s.jsx)("p",{className:"text-sm text-zinc-500 font-medium",children:"You've reached the end of the feed."})}),e[36]=o,e[37]=L.length,e[38]=c,e[39]=x,e[40]=N):N=e[40];let F;e[41]!==j||e[42]!==N?(F=(0,s.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm",children:[j,N]}),e[41]=j,e[42]=N,e[43]=F):F=e[43];let P;return e[44]!==q||e[45]!==E||e[46]!==F?(P=(0,s.jsxs)("div",{children:[q,E,F]}),e[44]=q,e[45]=E,e[46]=F,e[47]=P):P=e[47],P},Dn=qn;function Bn(t){return!t.parent_id}function Wn(t){return(0,s.jsx)(lt,{},t)}var Qn=Q(),Kn=t=>{const e=(0,Qn.c)(53),{profile:a,onUserClick:i,isCommunity:r}=t,n=r===void 0?!1:r,{onlineUsers:l}=Ht();let o;e[0]!==l||e[1]!==a.id?(o=l.has(a.id),e[0]=l,e[1]=a.id,e[2]=o):o=e[2];const c=o;let d;e[3]!==i||e[4]!==a.handle?(d=()=>i(a.handle),e[3]=i,e[4]=a.handle,e[5]=d):d=e[5];const u=`size-12 border border-zinc-200 dark:border-zinc-800 shadow-sm ${n?"rounded-2xl":""}`;let m;e[6]!==a.avatar||e[7]!==a.handle?(m=(0,s.jsx)(ne,{src:a.avatar,alt:a.handle,className:"object-cover"}),e[6]=a.avatar,e[7]=a.handle,e[8]=m):m=e[8];const f=n?"rounded-2xl":"";let x;e[9]!==a.handle?.[0]?(x=a.handle?.[0]?.toUpperCase(),e[9]=a.handle?.[0],e[10]=x):x=e[10];let p;e[11]!==f||e[12]!==x?(p=(0,s.jsx)(le,{className:f,children:x}),e[11]=f,e[12]=x,e[13]=p):p=e[13];let b;e[14]!==u||e[15]!==m||e[16]!==p?(b=(0,s.jsxs)(re,{className:u,children:[m,p]}),e[14]=u,e[15]=m,e[16]=p,e[17]=b):b=e[17];let h;e[18]!==n||e[19]!==c?(h=c&&!n&&(0,s.jsx)("span",{className:"absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full shadow-sm"}),e[18]=n,e[19]=c,e[20]=h):h=e[20];let g;e[21]!==h||e[22]!==b?(g=(0,s.jsxs)("div",{className:"relative",children:[b,h]}),e[21]=h,e[22]=b,e[23]=g):g=e[23];let v;e[24]!==a.name?(v=(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white group-hover:underline leading-none",children:a.name}),e[24]=a.name,e[25]=v):v=e[25];let z;e[26]!==a.verified?(z=a.verified&&(0,s.jsx)(Ae,{}),e[26]=a.verified,e[27]=z):z=e[27];let _;e[28]!==v||e[29]!==z?(_=(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[v,z]}),e[28]=v,e[29]=z,e[30]=_):_=e[30];let y;e[31]!==a.handle?(y=(0,s.jsxs)("span",{className:"text-sm text-zinc-500 mt-0.5",children:["@",a.handle]}),e[31]=a.handle,e[32]=y):y=e[32];let k;e[33]!==n||e[34]!==a.members?(k=n&&a.members&&(0,s.jsxs)("span",{className:"text-xs text-zinc-400 mt-1",children:[a.members," members"]}),e[33]=n,e[34]=a.members,e[35]=k):k=e[35];let $;e[36]!==n||e[37]!==a.followers?($=!n&&a.followers&&(0,s.jsxs)("span",{className:"text-xs text-zinc-400 mt-1",children:[a.followers," followers"]}),e[36]=n,e[37]=a.followers,e[38]=$):$=e[38];let S;e[39]!==_||e[40]!==y||e[41]!==k||e[42]!==$?(S=(0,s.jsxs)("div",{className:"flex flex-col",children:[_,y,k,$]}),e[39]=_,e[40]=y,e[41]=k,e[42]=$,e[43]=S):S=e[43];let L;e[44]!==g||e[45]!==S?(L=(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[g,S]}),e[44]=g,e[45]=S,e[46]=L):L=e[46];const C=n?"Join":"Follow";let M;e[47]!==C?(M=(0,s.jsx)(fe,{variant:"outline",className:"!w-auto !py-1.5 !px-4 text-sm font-bold rounded-full border-zinc-200 dark:border-zinc-700 hover:bg-zinc-100 dark:hover:bg-zinc-800",onClick:Vn,children:C}),e[47]=C,e[48]=M):M=e[48];let I;return e[49]!==L||e[50]!==M||e[51]!==d?(I=(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-zinc-100 dark:border-zinc-800 hover:bg-zinc-50 dark:hover:bg-zinc-900/40 transition-colors group cursor-pointer",onClick:d,children:[L,M]}),e[49]=L,e[50]=M,e[51]=d,e[52]=I):I=e[52],I},wt=Kn;function Vn(t){t.stopPropagation()}var We=Q();function ls(t){const e=(0,We.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=J("flex flex-col gap-2",a),e[3]=a,e[4]=r):r=e[4];let n;return e[5]!==i||e[6]!==r?(n=(0,s.jsx)(la,{"data-slot":"tabs",className:r,...i}),e[5]=i,e[6]=r,e[7]=n):n=e[7],n}function os(t){const e=(0,We.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=J("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",a),e[3]=a,e[4]=r):r=e[4];let n;return e[5]!==i||e[6]!==r?(n=(0,s.jsx)(pa,{"data-slot":"tabs-list",className:r,...i}),e[5]=i,e[6]=r,e[7]=n):n=e[7],n}function cs(t){const e=(0,We.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=J("inline-flex items-center justify-center gap-1.5 px-2 py-1 text-sm font-medium whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 outline-none focus:outline-none focus-visible:outline-none ring-0 focus:ring-0 focus-visible:ring-0 shadow-none data-[state=active]:shadow-none",a),e[3]=a,e[4]=r):r=e[4];let n;return e[5]!==i||e[6]!==r?(n=(0,s.jsx)(na,{"data-slot":"tabs-trigger",className:r,...i}),e[5]=i,e[6]=r,e[7]=n):n=e[7],n}function $e(t){const e=(0,We.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=J("flex-1 outline-none",a),e[3]=a,e[4]=r):r=e[4];let n;return e[5]!==i||e[6]!==r?(n=(0,s.jsx)(ya,{"data-slot":"tabs-content",className:r,...i}),e[5]=i,e[6]=r,e[7]=n):n=e[7],n}var Hn=Q(),Un=()=>{const t=(0,Hn.c)(50),{currentUser:e}=ce(),{posts:a,loading:i}=Pe(),{addToast:r}=ye(),n=_e(),[l,o]=(0,w.useState)("users"),[c,d]=(0,w.useState)("");let u;t[0]===Symbol.for("react.memo_cache_sentinel")?(u={queryKey:["profiles"],queryFn:si},t[0]=u):u=t[0];const{data:m,isLoading:f}=ge(u);let x;t[1]!==m?(x=m===void 0?{}:m,t[1]=m,t[2]=x):x=t[2];const p=x;let b;t[3]!==p||t[4]!==c?(b=Object.values(p).filter(Gn),c&&(b=b.filter(P=>P.name?.toLowerCase().includes(c.toLowerCase())||P.handle?.toLowerCase().includes(c.toLowerCase()))),t[3]=p,t[4]=c,t[5]=b):b=t[5];const h=b;let g;t[6]!==p||t[7]!==c?(g=Object.values(p).filter(Zn),c&&(g=g.filter(P=>P.name?.toLowerCase().includes(c.toLowerCase())||P.handle?.toLowerCase().includes(c.toLowerCase()))),t[6]=p,t[7]=c,t[8]=g):g=t[8];const v=g;let z;if(t[9]!==a||t[10]!==c){if(z=a.filter(Xn),c){let P;t[12]!==c?(P=A=>A.content?.toLowerCase().includes(c.toLowerCase()),t[12]=c,t[13]=P):P=t[13],z=z.filter(P)}t[9]=a,t[10]=c,t[11]=z}else z=t[11];const _=z;let y;t[14]!==n?(y=P=>{n(`/post/${P}`)},t[14]=n,t[15]=y):y=t[15];const k=y;let $;t[16]!==n?($=P=>{n(`/u/${P}`)},t[16]=n,t[17]=$):$=t[17];const S=$;if(i||f){let P;return t[18]===Symbol.for("react.memo_cache_sentinel")?(P=(0,s.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:[1,2,3].map(Yn)}),t[18]=P):P=t[18],P}let L;t[19]===Symbol.for("react.memo_cache_sentinel")?(L=()=>d(""),t[19]=L):L=t[19];const C=`Search ${l}...`;let M;t[20]!==c||t[21]!==C?(M=(0,s.jsx)("div",{className:"p-4",children:(0,s.jsx)(Ee,{value:c,onChange:d,onClear:L,placeholder:C})}),t[20]=c,t[21]=C,t[22]=M):M=t[22];let I;t[23]===Symbol.for("react.memo_cache_sentinel")?(I=(0,s.jsx)(os,{className:"w-full h-auto bg-transparent p-0 rounded-none justify-around px-5",children:["users","communities","reels"].map(el)}),t[23]=I):I=t[23];let O;t[24]!==M?(O=(0,s.jsxs)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-10 border-b border-zinc-100 dark:border-zinc-800",children:[M,I]}),t[24]=M,t[25]=O):O=t[25];let T;t[26]!==S||t[27]!==h?(T=h.length>0?h.map(P=>(0,s.jsx)(wt,{profile:P,onUserClick:S},P.handle)):(0,s.jsx)("div",{className:"p-20 text-center text-zinc-500",children:(0,s.jsx)("p",{className:"font-bold",children:"No users found"})}),t[26]=S,t[27]=h,t[28]=T):T=t[28];let W;t[29]!==T?(W=(0,s.jsx)($e,{value:"users",className:"m-0 border-none",children:(0,s.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:T})}),t[29]=T,t[30]=W):W=t[30];let q;t[31]!==v||t[32]!==S?(q=v.length>0?v.map(P=>(0,s.jsx)(wt,{profile:P,onUserClick:S,isCommunity:!0},P.handle)):(0,s.jsx)("div",{className:"p-20 text-center text-zinc-500",children:(0,s.jsx)("p",{className:"font-bold",children:"No communities found"})}),t[31]=v,t[32]=S,t[33]=q):q=t[33];let E;t[34]!==q?(E=(0,s.jsx)($e,{value:"communities",className:"m-0 border-none",children:(0,s.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:q})}),t[34]=q,t[35]=E):E=t[35];let j;t[36]!==r||t[37]!==e||t[38]!==k||t[39]!==S||t[40]!==_?(j=_.length>0?_.map(P=>(0,s.jsx)(Be,{...P,currentUser:e,showToast:r,onClick:()=>k(P.id),onUserClick:S},P.id)):(0,s.jsx)("div",{className:"p-20 text-center text-zinc-500",children:(0,s.jsx)("p",{className:"font-bold",children:"No reels found"})}),t[36]=r,t[37]=e,t[38]=k,t[39]=S,t[40]=_,t[41]=j):j=t[41];let N;t[42]!==j?(N=(0,s.jsx)($e,{value:"reels",className:"m-0 border-none",children:(0,s.jsx)("div",{children:j})}),t[42]=j,t[43]=N):N=t[43];let F;return t[44]!==l||t[45]!==W||t[46]!==E||t[47]!==N||t[48]!==O?(F=(0,s.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm",children:(0,s.jsxs)(ls,{value:l,onValueChange:o,className:"w-full",children:[O,W,E,N]})}),t[44]=l,t[45]=W,t[46]=E,t[47]=N,t[48]=O,t[49]=F):F=t[49],F},Jn=Un;function Gn(t){return t.type!=="community"}function Zn(t){return t.type==="community"}function Xn(t){return t.type==="video"}function Yn(t){return(0,s.jsx)(lt,{},t)}function el(t){return(0,s.jsx)(cs,{value:t,className:"relative py-4 px-2 text-sm font-semibold transition-all border-b-2 rounded-none whitespace-nowrap flex-1 text-center capitalize data-[state=active]:border-black dark:data-[state=active]:border-white data-[state=active]:text-black dark:data-[state=active]:text-white text-zinc-500 hover:text-zinc-800 dark:hover:text-zinc-300",children:t},t)}var tl=Q(),sl=t=>{const e=(0,tl.c)(56),{reel:a}=t,i=(0,w.useRef)(null),[r,n]=(0,w.useState)(!1),l=(0,w.useRef)(0),o=Array.isArray(a.media)?a.media[0]?.src||a.media[0]?.url:a.media?.src||a.media?.url||a.url;let c,d;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=()=>{const se=new IntersectionObserver(Y=>{const[me]=Y;i.current?.plyr&&(me.isIntersecting?i.current.plyr.play().catch(()=>{i.current.plyr.muted=!0,i.current.plyr.play()}):i.current.plyr.pause())},{threshold:.8}),ie=i.current?.elements?.container;return ie&&se.observe(ie),()=>{ie&&se.unobserve(ie)}},d=[],e[0]=c,e[1]=d):(c=e[0],d=e[1]),(0,w.useEffect)(c,d);let u;e[2]===Symbol.for("react.memo_cache_sentinel")?(u=()=>{const se=Date.now();se-l.current<300&&(n(!0),setTimeout(()=>n(!1),800)),l.current=se},e[2]=u):u=e[2];const m=u;let f;e[3]!==o?(f={type:"video",sources:[{src:o,type:"video/mp4"}]},e[3]=o,e[4]=f):f=e[4];let x;e[5]===Symbol.for("react.memo_cache_sentinel")?(x={controls:[],loop:{active:!0},clickToPlay:!0,ratio:"9:16"},e[5]=x):x=e[5];let p;e[6]!==f?(p={source:f,options:x},e[6]=f,e[7]=p):p=e[7];const b=p;let h;e[8]!==b?(h=(0,s.jsx)("div",{className:"w-full h-full max-w-[450px]",children:(0,s.jsx)(Rt,{ref:i,...b})}),e[8]=b,e[9]=h):h=e[9];let g;e[10]!==r?(g=r&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-50 animate-in zoom-in-50 fade-in duration-300",children:(0,s.jsx)(Ie,{size:100,fill:"white",className:"text-white drop-shadow-2xl scale-125"})}),e[10]=r,e[11]=g):g=e[11];let v;e[12]===Symbol.for("react.memo_cache_sentinel")?(v=(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-black/60 pointer-events-none"}),e[12]=v):v=e[12];const z=a.user?.avatar,_=a.user?.handle;let y;e[13]!==z||e[14]!==_?(y=(0,s.jsx)(ne,{src:z,alt:_,className:"object-cover"}),e[13]=z,e[14]=_,e[15]=y):y=e[15];let k;e[16]!==a.user?.handle?.[0]?(k=a.user?.handle?.[0]?.toUpperCase(),e[16]=a.user?.handle?.[0],e[17]=k):k=e[17];let $;e[18]!==k?($=(0,s.jsx)(le,{children:k}),e[18]=k,e[19]=$):$=e[19];let S;e[20]!==y||e[21]!==$?(S=(0,s.jsxs)(re,{className:"size-10 border-2 border-white",children:[y,$]}),e[20]=y,e[21]=$,e[22]=S):S=e[22];const L=a.user?.handle;let C;e[23]!==L?(C=(0,s.jsxs)("span",{className:"font-bold",children:["@",L]}),e[23]=L,e[24]=C):C=e[24];let M;e[25]===Symbol.for("react.memo_cache_sentinel")?(M=(0,s.jsx)("button",{className:"bg-white text-black text-xs font-bold px-3 py-1 rounded-full ml-2 hover:scale-105 active:scale-95 transition-all",children:"Follow"}),e[25]=M):M=e[25];let I;e[26]!==S||e[27]!==C?(I=(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3 pointer-events-auto",children:[S,C,M]}),e[26]=S,e[27]=C,e[28]=I):I=e[28];let O;e[29]!==a.content?(O=(0,s.jsx)("p",{className:"text-sm mb-3 line-clamp-2",children:a.content}),e[29]=a.content,e[30]=O):O=e[30];let T;e[31]===Symbol.for("react.memo_cache_sentinel")?(T=(0,s.jsx)(ra,{size:14,className:"animate-spin-slow"}),e[31]=T):T=e[31];const W=a.user?.handle;let q;e[32]!==W?(q=(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs opacity-90",children:[T,(0,s.jsxs)("span",{children:["Original Audio - ",W]})]}),e[32]=W,e[33]=q):q=e[33];let E;e[34]!==I||e[35]!==O||e[36]!==q?(E=(0,s.jsxs)("div",{className:"absolute bottom-20 left-4 right-16 text-white pointer-events-none",children:[I,O,q]}),e[34]=I,e[35]=O,e[36]=q,e[37]=E):E=e[37];let j;e[38]===Symbol.for("react.memo_cache_sentinel")?(j=(0,s.jsx)("button",{className:"p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90",children:(0,s.jsx)(Ie,{size:28})}),e[38]=j):j=e[38];const N=a.stats?.likes||0;let F;e[39]!==N?(F=(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[j,(0,s.jsx)("span",{className:"text-white text-xs font-bold",children:N})]}),e[39]=N,e[40]=F):F=e[40];let P;e[41]===Symbol.for("react.memo_cache_sentinel")?(P=(0,s.jsx)("button",{className:"p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90",children:(0,s.jsx)(Je,{size:28})}),e[41]=P):P=e[41];const A=a.stats?.comments||0;let K;e[42]!==A?(K=(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[P,(0,s.jsx)("span",{className:"text-white text-xs font-bold",children:A})]}),e[42]=A,e[43]=K):K=e[43];let H;e[44]===Symbol.for("react.memo_cache_sentinel")?(H=(0,s.jsx)("button",{className:"p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90",children:(0,s.jsx)(Na,{size:28})}),e[44]=H):H=e[44];const V=a.stats?.shares||0;let U;e[45]!==V?(U=(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[H,(0,s.jsx)("span",{className:"text-white text-xs font-bold",children:V})]}),e[45]=V,e[46]=U):U=e[46];let G;e[47]!==F||e[48]!==K||e[49]!==U?(G=(0,s.jsxs)("div",{className:"absolute bottom-20 right-2 flex flex-col items-center gap-6 z-10",children:[F,K,U]}),e[47]=F,e[48]=K,e[49]=U,e[50]=G):G=e[50];let te;return e[51]!==E||e[52]!==G||e[53]!==h||e[54]!==g?(te=(0,s.jsxs)("div",{className:"relative h-screen w-full bg-black snap-start flex items-center justify-center overflow-hidden",onClick:m,children:[h,g,v,E,G]}),e[51]=E,e[52]=G,e[53]=h,e[54]=g,e[55]=te):te=e[55],te},al=sl,il=Q(),rl=()=>{const t=(0,il.c)(10),{posts:e,loading:a}=Pe();let i,r,n;if(t[0]!==a||t[1]!==e){n=Symbol.for("react.early_return_sentinel");e:{const o=e.filter(ll);if(a){let c;t[5]===Symbol.for("react.memo_cache_sentinel")?(c=(0,s.jsx)("div",{className:"h-screen w-full flex items-center justify-center bg-black",children:(0,s.jsx)(oe,{size:40,className:"animate-spin text-white"})}),t[5]=c):c=t[5],n=c;break e}if(o.length===0){let c;t[6]===Symbol.for("react.memo_cache_sentinel")?(c=(0,s.jsx)("div",{className:"h-screen w-full flex flex-col items-center justify-center bg-black text-white gap-4",children:(0,s.jsx)("p",{className:"text-zinc-500",children:"No reels found."})}),t[6]=c):c=t[6],n=c;break e}i="h-screen w-full snap-y snap-mandatory overflow-y-auto no-scrollbar bg-black md:rounded-xl",r=o.map(ol)}t[0]=a,t[1]=e,t[2]=i,t[3]=r,t[4]=n}else i=t[2],r=t[3],n=t[4];if(n!==Symbol.for("react.early_return_sentinel"))return n;let l;return t[7]!==i||t[8]!==r?(l=(0,s.jsx)("div",{className:i,children:r}),t[7]=i,t[8]=r,t[9]=l):l=t[9],l},nl=rl;function ll(t){return t.type==="video"||t.category==="video"}function ol(t){return(0,s.jsx)(al,{reel:t},t.id)}var cl=Q();const ds=t=>{const e=(0,cl.c)(5);let a;e[0]!==t?(a=()=>Oe(t),e[0]=t,e[1]=a):a=e[1];const[i,r]=(0,w.useState)(a);let n,l;return e[2]!==t?(n=()=>{if(!t)return;const o=setTimeout(()=>{r(Oe(t))},0),c=setInterval(()=>{r(Oe(t))},6e4);return()=>{clearTimeout(o),clearInterval(c)}},l=[t],e[2]=t,e[3]=n,e[4]=l):(n=e[3],l=e[4]),(0,w.useEffect)(n,l),i};var dl=Q(),ml=t=>{const e=(0,dl.c)(50),{conv:a,selectedId:i,onSelect:r,onlineUsers:n}=t,l=ds(a.user?.lastSeen);let o;e[0]!==a.user?.id||e[1]!==n?(o=n.has(a.user?.id),e[0]=a.user?.id,e[1]=n,e[2]=o):o=e[2];const c=o;let d;e[3]!==a||e[4]!==r?(d=()=>r(a),e[3]=a,e[4]=r,e[5]=d):d=e[5];const u=`flex items-center gap-3 p-4 cursor-pointer transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900 ${i===a.id?"bg-zinc-50 dark:bg-zinc-900 border-r-2 border-violet-500":""}`,m=a.user?.avatar,f=a.user?.name;let x;e[6]!==m||e[7]!==f?(x=(0,s.jsx)(ne,{src:m,alt:f,className:"object-cover"}),e[6]=m,e[7]=f,e[8]=x):x=e[8];let p;e[9]!==a.user?.name?.[0]?(p=a.user?.name?.[0]?.toUpperCase(),e[9]=a.user?.name?.[0],e[10]=p):p=e[10];let b;e[11]!==p?(b=(0,s.jsx)(le,{children:p}),e[11]=p,e[12]=b):b=e[12];let h;e[13]!==x||e[14]!==b?(h=(0,s.jsxs)(re,{className:"size-12",children:[x,b]}),e[13]=x,e[14]=b,e[15]=h):h=e[15];let g;e[16]!==c?(g=c&&(0,s.jsx)("span",{className:"absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full"}),e[16]=c,e[17]=g):g=e[17];let v;e[18]!==g||e[19]!==h?(v=(0,s.jsxs)("div",{className:"relative",children:[h,g]}),e[18]=g,e[19]=h,e[20]=v):v=e[20];const z=a.user?.name;let _;e[21]!==z?(_=(0,s.jsx)("span",{className:"font-bold dark:text-white truncate",children:z}),e[21]=z,e[22]=_):_=e[22];let y;e[23]!==a.user?.lastSeen||e[24]!==c||e[25]!==l?(y=c?(0,s.jsx)("span",{className:"text-[10px] text-emerald-500 font-medium leading-none mb-1",children:"Online"}):a.user?.lastSeen&&(0,s.jsx)("span",{className:"text-[10px] text-zinc-500 font-medium leading-none mb-1",children:l}),e[23]=a.user?.lastSeen,e[24]=c,e[25]=l,e[26]=y):y=e[26];let k;e[27]!==_||e[28]!==y?(k=(0,s.jsxs)("div",{className:"flex flex-col min-w-0",children:[_,y]}),e[27]=_,e[28]=y,e[29]=k):k=e[29];let $;e[30]!==a.time?($=(0,s.jsx)("span",{className:"text-xs text-zinc-500 whitespace-nowrap ml-2",children:a.time}),e[30]=a.time,e[31]=$):$=e[31];let S;e[32]!==k||e[33]!==$?(S=(0,s.jsxs)("div",{className:"flex justify-between items-center mb-0.5",children:[k,$]}),e[32]=k,e[33]=$,e[34]=S):S=e[34];let L;e[35]!==a.lastMessage?(L=(0,s.jsx)("p",{className:"text-zinc-500 text-sm truncate pr-2",children:a.lastMessage}),e[35]=a.lastMessage,e[36]=L):L=e[36];let C;e[37]!==a.unread?(C=a.unread>0&&(0,s.jsx)("span",{className:"bg-violet-600 text-white text-[10px] font-bold size-5 rounded-full flex items-center justify-center shrink-0",children:a.unread}),e[37]=a.unread,e[38]=C):C=e[38];let M;e[39]!==L||e[40]!==C?(M=(0,s.jsxs)("div",{className:"flex-1 flex justify-between items-center",children:[L,C]}),e[39]=L,e[40]=C,e[41]=M):M=e[41];let I;e[42]!==S||e[43]!==M?(I=(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[S,M]}),e[42]=S,e[43]=M,e[44]=I):I=e[44];let O;return e[45]!==v||e[46]!==d||e[47]!==I||e[48]!==u?(O=(0,s.jsxs)("div",{onClick:d,className:u,children:[v,I]}),e[45]=v,e[46]=d,e[47]=I,e[48]=u,e[49]=O):O=e[49],O},ul=({conversations:t,userResults:e=[],onSelect:a,onStartNew:i,selectedId:r,searchQuery:n,onSearchChange:l,onlineUsers:o=new Set})=>(0,s.jsxs)("div",{className:"flex-1 flex flex-col min-w-0 bg-white dark:bg-black",children:[(0,s.jsx)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)(Ee,{value:n,onChange:l,onClear:()=>l(""),placeholder:"Search people or messages..."})}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[t.length>0&&(0,s.jsx)("div",{className:"py-2",children:t.map(c=>(0,s.jsx)(ml,{conv:c,selectedId:r,onSelect:a,onlineUsers:o},c.id))}),e.length>0&&(0,s.jsxs)("div",{className:"border-t border-zinc-100 dark:border-zinc-800",children:[(0,s.jsx)("div",{className:"px-4 py-3 text-xs font-bold text-zinc-500 uppercase tracking-wider",children:"People"}),e.map(c=>(0,s.jsxs)("div",{onClick:()=>i(c),className:"flex items-center gap-3 p-4 cursor-pointer transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[(0,s.jsxs)(re,{className:"size-12",children:[(0,s.jsx)(ne,{src:c.avatar,alt:c.name,className:"object-cover"}),(0,s.jsx)(le,{children:c.name?.[0]?.toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"font-bold dark:text-white truncate",children:c.name}),(0,s.jsxs)("div",{className:"text-zinc-500 text-sm truncate",children:["@",c.handle]})]}),(0,s.jsx)(Ft,{size:18,className:"text-violet-500"})]},c.id))]}),t.length===0&&e.length===0&&n&&(0,s.jsx)("div",{className:"p-8 text-center",children:(0,s.jsxs)("p",{className:"text-zinc-500 text-sm",children:['No conversations or people found for "',n,'"']})}),t.length===0&&!n&&(0,s.jsx)("div",{className:"p-8 text-center",children:(0,s.jsx)("p",{className:"text-zinc-500 text-sm",children:"No messages yet. Search for people to start a chat!"})})]})]}),fl=ul,xl=Q(),hl=t=>{const e=(0,xl.c)(7),{className:a}=t;let i;e[0]!==a?(i=J("flex items-center gap-1 px-1 py-1.5",a),e[0]=a,e[1]=i):i=e[1];let r,n,l;e[2]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsx)("div",{className:"size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse"}),n=(0,s.jsx)("div",{className:"size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse [animation-delay:0.2s]"}),l=(0,s.jsx)("div",{className:"size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse [animation-delay:0.4s]"}),e[2]=r,e[3]=n,e[4]=l):(r=e[2],n=e[3],l=e[4]);let o;return e[5]!==i?(o=(0,s.jsxs)("div",{className:i,children:[r,n,l]}),e[5]=i,e[6]=o):o=e[6],o},pl=hl,ot=Q();function ms(t){const e=(0,ot.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(sa,{"data-slot":"popover",...a}),e[2]=a,e[3]=i):i=e[3],i}function us(t){const e=(0,ot.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(ia,{"data-slot":"popover-trigger",...a}),e[2]=a,e[3]=i):i=e[3],i}function fs(t){const e=(0,ot.c)(12);let a,i,r,n;e[0]!==t?({className:a,align:r,sideOffset:n,...i}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=r,e[4]=n):(a=e[1],i=e[2],r=e[3],n=e[4]);const l=r===void 0?"center":r,o=n===void 0?4:n;let c;e[5]!==a?(c=J("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 rounded-md border p-4 shadow-md outline-hidden",a),e[5]=a,e[6]=c):c=e[6];let d;return e[7]!==l||e[8]!==i||e[9]!==o||e[10]!==c?(d=(0,s.jsx)(Ca,{children:(0,s.jsx)(ha,{"data-slot":"popover-content",align:l,sideOffset:o,className:c,...i})}),e[7]=l,e[8]=i,e[9]=o,e[10]=c,e[11]=d):d=e[11],d}var Le=Q();function bl(t){const e=(0,Le.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(va,{"data-slot":"context-menu",...a}),e[2]=a,e[3]=i):i=e[3],i}function gl(t){const e=(0,Le.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(ta,{"data-slot":"context-menu-trigger",...a}),e[2]=a,e[3]=i):i=e[3],i}function vl(t){const e=(0,Le.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=J("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",a),e[3]=a,e[4]=r):r=e[4];let n;return e[5]!==i||e[6]!==r?(n=(0,s.jsx)(Xs,{children:(0,s.jsx)(ga,{"data-slot":"context-menu-content",className:r,...i})}),e[5]=i,e[6]=r,e[7]=n):n=e[7],n}function He(t){const e=(0,Le.c)(12);let a,i,r,n;e[0]!==t?({className:a,inset:i,variant:n,...r}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=r,e[4]=n):(a=e[1],i=e[2],r=e[3],n=e[4]);const l=n===void 0?"default":n;let o;e[5]!==a?(o=J("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),e[5]=a,e[6]=o):o=e[6];let c;return e[7]!==i||e[8]!==r||e[9]!==o||e[10]!==l?(c=(0,s.jsx)(za,{"data-slot":"context-menu-item","data-inset":i,"data-variant":l,className:o,...r}),e[7]=i,e[8]=r,e[9]=o,e[10]=l,e[11]=c):c=e[11],c}function jl(t){const e=(0,Le.c)(10);let a,i,r;e[0]!==t?({className:a,inset:i,...r}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=r):(a=e[1],i=e[2],r=e[3]);let n;e[4]!==a?(n=J("text-foreground px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",a),e[4]=a,e[5]=n):n=e[5];let l;return e[6]!==i||e[7]!==r||e[8]!==n?(l=(0,s.jsx)(oa,{"data-slot":"context-menu-label","data-inset":i,className:n,...r}),e[6]=i,e[7]=r,e[8]=n,e[9]=l):l=e[9],l}function zt(t){const e=(0,Le.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=J("bg-border -mx-1 my-1 h-px",a),e[3]=a,e[4]=r):r=e[4];let n;return e[5]!==i||e[6]!==r?(n=(0,s.jsx)(ka,{"data-slot":"context-menu-separator",className:r,...i}),e[5]=i,e[6]=r,e[7]=n):n=e[7],n}var yl=Q(),wl=t=>{const e=(0,yl.c)(10),{onEmojiSelect:a,className:i}=t;let r;e[0]!==i?(r=J("isolate flex h-[350px] w-[320px] flex-col overflow-hidden rounded-xl border border-zinc-200 bg-white shadow-xl dark:border-zinc-800 dark:bg-zinc-950",i),e[0]=i,e[1]=r):r=e[1];let n;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,s.jsx)(ze.Search,{className:"z-10 mx-3 mt-3 appearance-none rounded-lg border-none bg-zinc-100 px-3 py-2 text-sm outline-none placeholder:text-zinc-500 focus:ring-1 focus:ring-violet-500 dark:bg-zinc-900 dark:text-white",placeholder:"Search emojis..."}),e[2]=n):n=e[2];let l,o;e[3]===Symbol.for("react.memo_cache_sentinel")?(l=(0,s.jsx)(ze.Loading,{className:"absolute inset-0 flex items-center justify-center text-zinc-400 text-sm dark:text-zinc-500",children:"Loadingâ€¦"}),o=(0,s.jsx)(ze.Empty,{className:"absolute inset-0 flex items-center justify-center text-zinc-400 text-sm dark:text-zinc-500",children:"No emoji found."}),e[3]=l,e[4]=o):(l=e[3],o=e[4]);let c,d;e[5]===Symbol.for("react.memo_cache_sentinel")?(c=(0,s.jsxs)(ze.Viewport,{className:"relative flex-1 outline-none no-scrollbar",children:[l,o,(0,s.jsx)(ze.List,{className:"select-none pb-2",components:{CategoryHeader:Nl,Row:kl,Emoji:_l}})]}),d=(0,s.jsx)(ze.ActiveEmoji,{children:Cl}),e[5]=c,e[6]=d):(c=e[5],d=e[6]);let u;return e[7]!==a||e[8]!==r?(u=(0,s.jsxs)(ze.Root,{onEmojiSelect:a,className:r,children:[n,c,d]}),e[7]=a,e[8]=r,e[9]=u):u=e[9],u},zl=wl;function Nl(t){const{category:e,...a}=t;return(0,s.jsx)("div",{className:"bg-white/80 px-4 pt-4 pb-1.5 font-bold text-zinc-500 text-[11px] uppercase tracking-wider backdrop-blur-sm dark:bg-zinc-950/80 dark:text-zinc-400",...a,children:e.label})}function kl(t){const{children:e,...a}=t;return(0,s.jsx)("div",{className:"scroll-my-1 px-2",...a,children:e})}function _l(t){const{emoji:e,...a}=t;return(0,s.jsx)("button",{className:"flex aspect-square size-9 items-center justify-center rounded-lg text-xl transition-colors hover:bg-zinc-100 data-[active]:bg-violet-500/10 data-[active]:text-violet-500 dark:hover:bg-zinc-900 dark:data-[active]:bg-violet-500/20",...a,children:e.emoji})}function Cl(t){const{emoji:e}=t;return(0,s.jsx)("div",{className:"flex items-center gap-3 border-t border-zinc-100 p-3 dark:border-zinc-800",children:e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"text-2xl",children:e.emoji}),(0,s.jsx)("span",{className:"text-xs font-bold text-zinc-600 dark:text-zinc-400 truncate",children:e.label.replace(/:/g,"").replace(/_/g," ")})]}):(0,s.jsx)("span",{className:"text-xs font-medium text-zinc-400",children:"Select an emoji..."})})}var Sl=Q(),$l=["â¤ï¸","ðŸ˜‚","ðŸ˜®","ðŸ˜¢","ðŸ™","ðŸ‘"],Pl=t=>{const e=(0,Sl.c)(6),{onSelect:a,currentReaction:i}=t;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsx)(us,{asChild:!0,children:(0,s.jsx)("button",{className:"p-1.5 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-300 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full transition-all active:scale-90",onClick:Ml,children:(0,s.jsx)(qt,{size:16})})}),e[0]=r):r=e[0];let n;e[1]!==i||e[2]!==a?(n=$l.map(o=>(0,s.jsx)("button",{onClick:()=>a(o),className:`text-xl p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full transition-all active:scale-125 ${i===o?"bg-zinc-100 dark:bg-zinc-800":""}`,children:o},o)),e[1]=i,e[2]=a,e[3]=n):n=e[3];let l;return e[4]!==n?(l=(0,s.jsxs)(ms,{children:[r,(0,s.jsx)(fs,{side:"top",align:"center",className:"w-fit p-1 rounded-full bg-white dark:bg-zinc-900 border border-zinc-100 dark:border-zinc-800 shadow-xl",onClick:Il,children:(0,s.jsx)("div",{className:"flex items-center gap-1",children:n})})]}),e[4]=n,e[5]=l):l=e[5],l},Ll=Pl;function Ml(t){return t.stopPropagation()}function Il(t){return t.stopPropagation()}var Fl=Q(),Rl=t=>{const e=(0,Fl.c)(10),{reactions:a,currentUser:i,onToggle:r}=t;let n;e[0]!==a?(n=a===void 0?[]:a,e[0]=a,e[1]=n):n=e[1];const l=n;let o;e[2]!==i?.id||e[3]!==l?(o={},l.forEach(m=>{o[m.emoji]||(o[m.emoji]={count:0,me:!1}),o[m.emoji].count=o[m.emoji].count+1,m.user_id===i?.id&&(o[m.emoji].me=!0)}),e[2]=i?.id,e[3]=l,e[4]=o):o=e[4];const c=o;if(l.length===0)return null;let d;e[5]!==c?(d=Object.entries(c),e[5]=c,e[6]=d):d=e[6];let u;return e[7]!==r||e[8]!==d?(u=(0,s.jsx)("div",{className:"flex flex-wrap gap-1 mt-1 px-2",children:d.map(m=>{const[f,x]=m;return(0,s.jsxs)("button",{onClick:p=>{p.stopPropagation(),r(f)},className:`flex items-center gap-1.5 px-2 py-0.5 rounded-full text-xs font-medium border transition-all active:scale-90 ${x.me?"bg-violet-50 border-violet-200 text-violet-600 dark:bg-violet-900/30 dark:border-violet-800 dark:text-violet-400":"bg-white border-zinc-100 text-zinc-600 dark:bg-zinc-900 dark:border-zinc-800 dark:text-zinc-400"}`,children:[(0,s.jsx)("span",{children:f}),x.count>1&&(0,s.jsx)("span",{children:x.count})]},f)})}),e[7]=r,e[8]=d,e[9]=u):u=e[9],u},Tl=Rl,Ol=["â¤ï¸","ðŸ˜‚","ðŸ˜®","ðŸ˜¢","ðŸ™","ðŸ‘"],El=({conversation:t,messages:e,onBack:a,onSendMessage:i,onToggleReaction:r,onDeleteMessage:n,currentUser:l,onTyping:o,isLoading:c,isTyping:d,isOnline:u})=>{const{openLightbox:m}=st(),[f,x]=(0,w.useState)(""),[p,b]=(0,w.useState)(!1),[h,g]=(0,w.useState)([]),[v,z]=(0,w.useState)(!1),[_,y]=(0,w.useState)(null),k=(0,w.useRef)(null),$=(0,w.useRef)(null),S=(0,w.useRef)(null),L=ds(t.user?.lastSeen);(0,w.useEffect)(()=>{$.current&&($.current.scrollTop=$.current.scrollHeight)},[e,d]);const C=j=>{const N=j.target.value;x(N),o&&(o(!0),S.current&&clearTimeout(S.current),S.current=setTimeout(()=>{o(!1)},2e3))},M=j=>{x(N=>N+j.emoji)},I=j=>{j.preventDefault(),!(!f.trim()&&h.length===0)&&(o&&(clearTimeout(S.current),o(!1)),i(t.id,f,h.length>0?"image":"text",h,_?.id),x(""),g([]),y(null))},O=async j=>{const N=Array.from(j.target.files);if(N.length!==0){b(!0);try{const F=await Promise.all(N.map(P=>ke(P)));g(P=>[...P,...F])}catch(F){console.error("Upload failed:",F)}finally{b(!1)}}},T=j=>{g(N=>N.filter(F=>F.url!==j))},W=j=>{!j.media||j.media.length===0||m(j.media.map(N=>N.url),0)},q=(0,w.useMemo)(()=>{const j=e.filter(N=>N.sender==="me");return j.length>0?j[j.length-1].id:null},[e]),E=j=>e.find(N=>N.id===j);return(0,s.jsxs)("div",{className:"flex-1 flex flex-col h-full bg-white dark:bg-black md:border-l md:border-zinc-100 dark:md:border-zinc-800",children:[(0,s.jsxs)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800 flex items-center justify-between shrink-0 bg-white/80 dark:bg-black/80 backdrop-blur-md sticky top-0 z-10",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("button",{onClick:a,className:"md:hidden p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:(0,s.jsx)(Ye,{size:20})}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)(re,{className:"size-10 border border-zinc-200 dark:border-zinc-700",children:[(0,s.jsx)(ne,{src:t.user.avatar,alt:t.user.name,className:"object-cover"}),(0,s.jsx)(le,{children:t.user.name?.[0]?.toUpperCase()})]}),u&&(0,s.jsx)("span",{className:"absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-bold dark:text-white",children:t.user.name}),u?(0,s.jsxs)("div",{className:"text-xs text-emerald-500 font-medium flex items-center gap-1",children:[(0,s.jsx)("span",{className:"size-1.5 bg-emerald-500 rounded-full animate-pulse"}),"Online"]}):(0,s.jsx)("div",{className:"text-xs text-zinc-500 font-medium",children:t.user.lastSeen?`Last seen ${L}`:"Offline"})]})]}),(0,s.jsx)("button",{className:"p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full dark:text-zinc-400",children:(0,s.jsx)(xa,{size:20})})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",ref:$,children:[(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsxs)("div",{className:"relative w-fit mx-auto",children:[(0,s.jsxs)(re,{className:"size-20 mx-auto mb-3 border-4 border-zinc-50 dark:border-zinc-900 shadow-sm",children:[(0,s.jsx)(ne,{src:t.user.avatar,alt:t.user.name,className:"object-cover"}),(0,s.jsx)(le,{className:"text-2xl font-bold",children:t.user.name?.[0]?.toUpperCase()})]}),u&&(0,s.jsx)("span",{className:"absolute bottom-4 right-1 size-5 bg-emerald-500 border-4 border-white dark:border-black rounded-full animate-in zoom-in duration-300"})]}),(0,s.jsx)("h4",{className:"font-bold dark:text-white text-lg",children:t.user.name}),(0,s.jsxs)("p",{className:"text-sm text-zinc-500",children:["@",t.user.handle]}),(0,s.jsxs)("p",{className:"text-xs text-zinc-400 mt-4 max-w-xs mx-auto",children:["This is the beginning of your direct message history with"," ",(0,s.jsxs)("span",{className:"font-bold",children:["@",t.user.handle]})]})]}),c&&e.length===0?(0,s.jsx)("div",{className:"flex justify-center p-8",children:(0,s.jsx)(oe,{className:"animate-spin text-violet-500",size:32})}):e.map(j=>(0,s.jsxs)(bl,{children:[(0,s.jsx)(gl,{asChild:!0,children:(0,s.jsxs)("div",{id:`msg-${j.id}`,className:`flex items-end gap-2 group ${j.sender==="me"?"flex-row-reverse":"flex-row"}`,children:[(0,s.jsxs)("div",{className:`max-w-[75%] p-1 rounded-2xl text-[15px] shadow-sm relative ${j.sender==="me"?"bg-violet-600 text-white rounded-tr-none":"bg-zinc-100 dark:bg-zinc-800 dark:text-white rounded-tl-none"}`,children:[j.replyToId&&(0,s.jsxs)("div",{className:`mb-2 p-2 rounded-lg border-l-4 text-xs truncate cursor-pointer ${j.sender==="me"?"bg-violet-500/50 border-violet-300 text-violet-100":"bg-zinc-200/50 dark:bg-zinc-700/50 border-zinc-400 dark:border-zinc-500 text-zinc-600 dark:text-zinc-300"}`,onClick:N=>{N.stopPropagation(),document.getElementById(`msg-${j.replyToId}`)?.scrollIntoView({behavior:"smooth",block:"center"})},children:[(0,s.jsx)("span",{className:"font-bold block mb-0.5",children:E(j.replyToId)?.sender==="me"?"You":t.user.name}),E(j.replyToId)?.text||"Media"]}),j.media?.length>0&&(0,s.jsx)("div",{className:"mb-2 grid gap-1 grid-cols-1 overflow-hidden rounded-lg cursor-pointer",onClick:()=>W(j),children:j.media.map((N,F)=>(0,s.jsx)("img",{src:N.url,alt:"",className:"max-h-60 w-full object-cover rounded-md hover:brightness-90 transition-all"},F))}),j.text&&(0,s.jsx)("p",{className:"m-0 leading-tight px-3 py-1",children:j.text}),j.reactions?.length>0&&(0,s.jsx)(Tl,{reactions:j.reactions,currentUser:l,onToggle:N=>r(j.id,N)}),(0,s.jsxs)("div",{className:`text-[10px] flex items-center justify-end gap-1 px-3 pb-1 ${j.sender==="me"?"text-violet-200":"text-zinc-400"}`,children:[j.time,j.sender==="me"&&j.id===q&&(0,s.jsx)("span",{className:"ml-0.5",children:j.isRead?(0,s.jsx)(Ea,{size:14,className:"text-white"}):(0,s.jsx)(qs,{size:14,className:"text-violet-200"})})]})]}),(0,s.jsx)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)(Ll,{onSelect:N=>r(j.id,N),currentReaction:j.reactions?.find(N=>N.user_id===l?.id)?.emoji})})]})}),(0,s.jsxs)(vl,{className:"w-64 rounded-xl bg-white dark:bg-zinc-950 border-zinc-100 dark:border-zinc-800 shadow-xl",children:[(0,s.jsx)(jl,{className:"text-xs text-zinc-500 font-bold px-3 py-2",children:"QUICK REACTION"}),(0,s.jsx)("div",{className:"flex items-center justify-between px-2 pb-2",children:Ol.map(N=>(0,s.jsx)("button",{onClick:()=>r(j.id,N),className:"text-xl p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full transition-all active:scale-125",children:N},N))}),(0,s.jsx)(zt,{className:"bg-zinc-100 dark:bg-zinc-800"}),(0,s.jsxs)(He,{className:"gap-3 px-3 py-2.5 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-900",onClick:()=>{navigator.clipboard.writeText(j.text)},children:[(0,s.jsx)(Ms,{size:16,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"font-medium",children:"Copy Text"})]}),(0,s.jsxs)(He,{className:"gap-3 px-3 py-2.5 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-900",onClick:()=>y(j),children:[(0,s.jsx)(ja,{size:16,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"font-medium",children:"Reply"})]}),(0,s.jsx)(zt,{className:"bg-zinc-100 dark:bg-zinc-800"}),(0,s.jsxs)(He,{className:"gap-3 px-3 py-2.5 cursor-pointer text-rose-500 focus:text-rose-500 focus:bg-rose-50 dark:focus:bg-rose-900/20",onClick:()=>n(j.id),children:[(0,s.jsx)(hs,{size:16}),(0,s.jsx)("span",{className:"font-medium",children:"Delete message"})]})]})]},j.id)),d&&(0,s.jsx)("div",{className:"flex justify-start animate-in fade-in slide-in-from-bottom-2 duration-300",children:(0,s.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-800/50 px-3 py-2 rounded-2xl rounded-tl-none border border-zinc-200/50 dark:border-zinc-700/30 shadow-sm",children:(0,s.jsx)(pl,{})})})]}),(0,s.jsxs)("div",{className:"p-4 border-t border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black shrink-0",children:[_&&(0,s.jsxs)("div",{className:"mb-3 p-3 bg-zinc-50 dark:bg-zinc-900 border border-zinc-100 dark:border-zinc-800 rounded-xl flex items-center justify-between animate-in slide-in-from-bottom-2 duration-200",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("span",{className:"text-xs font-bold text-violet-600 dark:text-violet-400 block mb-1",children:["Replying to"," ",_.sender==="me"?"yourself":t.user.name]}),(0,s.jsx)("p",{className:"text-sm text-zinc-500 truncate",children:_.text||"Media"})]}),(0,s.jsx)("button",{onClick:()=>y(null),className:"p-1 hover:bg-zinc-200 dark:hover:bg-zinc-800 rounded-full text-zinc-400 transition-colors",children:(0,s.jsx)(xe,{size:18})})]}),h.length>0&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 mb-3",children:[h.map(j=>(0,s.jsxs)("div",{className:"relative size-16 rounded-xl overflow-hidden border border-zinc-200 dark:border-zinc-800",children:[(0,s.jsx)("img",{src:j.url,className:"size-full object-cover",alt:""}),(0,s.jsx)("button",{type:"button",onClick:()=>T(j.url),className:"absolute top-1 right-1 bg-black/50 text-white rounded-full p-0.5 hover:bg-black transition-colors",children:(0,s.jsx)(xe,{size:12})})]},j.url)),p&&(0,s.jsx)("div",{className:"size-16 rounded-xl bg-zinc-100 dark:bg-zinc-900 flex items-center justify-center",children:(0,s.jsx)(oe,{className:"animate-spin text-violet-500",size:20})})]}),(0,s.jsxs)("form",{onSubmit:I,className:"flex items-center gap-2 bg-zinc-100 dark:bg-zinc-900 p-2 rounded-2xl border border-transparent focus-within:border-violet-500 transition-all",children:[(0,s.jsxs)(ms,{open:v,onOpenChange:z,children:[(0,s.jsx)(us,{asChild:!0,children:(0,s.jsx)("button",{type:"button",className:"p-2 text-zinc-500 hover:text-violet-600 transition-colors",children:(0,s.jsx)(qt,{size:20})})}),(0,s.jsx)(fs,{className:"w-fit p-0 border-none bg-transparent shadow-none",side:"top",align:"start",sideOffset:10,children:(0,s.jsx)(zl,{onEmojiSelect:j=>{M(j)}})})]}),(0,s.jsx)("input",{type:"text",className:"flex-1 bg-transparent border-none outline-none dark:text-white py-1 px-1",placeholder:"Start a new message",value:f,onChange:C}),(0,s.jsx)("input",{type:"file",ref:k,onChange:O,className:"hidden",multiple:!0,accept:"image/*"}),(0,s.jsx)("button",{type:"button",onClick:()=>k.current?.click(),className:"p-2 text-zinc-500 hover:text-violet-600 transition-colors",disabled:p,children:(0,s.jsx)(Sa,{size:20})}),(0,s.jsx)(fe,{type:"submit",className:"size-10 !p-0 rounded-xl",disabled:!f.trim()&&h.length===0||p,children:(0,s.jsx)(ca,{size:18})})]})]})]})},Al=El,ql=Q(),Dl=()=>{const t=(0,ql.c)(72),{id:e}=Ge(),a=_e(),{currentUser:i}=ce(),{onlineUsers:r}=Ht(),n=Fe(),[l,o]=(0,w.useState)("");let c;t[0]===Symbol.for("react.memo_cache_sentinel")?(c=[],t[0]=c):c=t[0];const[d,u]=(0,w.useState)(c),{conversations:m,isConvLoading:f,sendMessage:x,sendTypingStatus:p,typingStatus:b,markAsRead:h,formatMessages:g,onToggleReaction:v,allReactions:z}=at(i);let _;e:{if(!e||m.length===0){_=null;break e}let R;t[1]!==m||t[2]!==e?(R=m.find(ee=>ee.id===e)||null,t[1]=m,t[2]=e,t[3]=R):R=t[3],_=R}const y=_;let k,$;t[4]!==e||t[5]!==h?(k=()=>{e&&h(e)},$=[e,h],t[4]=e,t[5]=h,t[6]=k,t[7]=$):(k=t[6],$=t[7]),(0,w.useEffect)(k,$);let S;t[8]!==m||t[9]!==i?.id||t[10]!==l?(S=()=>{const R=setTimeout(async()=>{if(l.length>1){const ee=await ti(l),de=m.map(Bl);u(ee.filter(ve=>ve.id!==i?.id&&!de.includes(ve.id)))}else u([])},300);return()=>clearTimeout(R)},t[8]=m,t[9]=i?.id,t[10]=l,t[11]=S):S=t[11];const L=i?.id;let C;t[12]!==m||t[13]!==l||t[14]!==L?(C=[l,m,L],t[12]=m,t[13]=l,t[14]=L,t[15]=C):C=t[15],(0,w.useEffect)(S,C);let M;t[16]!==i||t[17]!==a||t[18]!==n?(M=async R=>{try{const ee=await Qt(i.id,R.id);n.invalidateQueries({queryKey:["conversations",i.id]}),o(""),a(`/messages/${ee}`)}catch(ee){console.error("Failed to start conversation:",ee)}},t[16]=i,t[17]=a,t[18]=n,t[19]=M):M=t[19];const I=M;let O;t[20]!==a?(O=R=>{a(`/messages/${R.id}`)},t[20]=a,t[21]=O):O=t[21];const T=O,W=y?.id;let q;t[22]!==W?(q=["messages",W],t[22]=W,t[23]=q):q=t[23];let E;t[24]!==y?.id?(E=()=>mi(y?.id),t[24]=y?.id,t[25]=E):E=t[25];const j=!!y?.id;let N;t[26]!==q||t[27]!==E||t[28]!==j?(N={queryKey:q,queryFn:E,enabled:j},t[26]=q,t[27]=E,t[28]=j,t[29]=N):N=t[29];const{data:F,isLoading:P}=ge(N);let A;t[30]!==F?(A=F===void 0?[]:F,t[30]=F,t[31]=A):A=t[31];const K=A;let H;t[32]!==z||t[33]!==K||t[34]!==g?(H=g(K,z),t[32]=z,t[33]=K,t[34]=g,t[35]=H):H=t[35];const V=H;if(!i){let R;return t[36]===Symbol.for("react.memo_cache_sentinel")?(R=(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-screen gap-4 p-8 text-center bg-white dark:bg-black md:rounded-xl md:border border-zinc-100 dark:border-zinc-800",children:[(0,s.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-900 p-4 rounded-full",children:(0,s.jsx)(Dt,{size:40,className:"text-zinc-400"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"Sign in to message others"}),(0,s.jsx)("p",{className:"text-zinc-500 max-w-xs",children:"Start decentralized conversations with anyone on the network."})]}),t[36]=R):R=t[36],R}if(f){let R;return t[37]===Symbol.for("react.memo_cache_sentinel")?(R=(0,s.jsx)("div",{className:"flex h-screen items-center justify-center bg-white dark:bg-black md:rounded-xl md:border border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)(oe,{className:"animate-spin text-violet-500",size:32})}),t[37]=R):R=t[37],R}let U;if(t[38]!==m||t[39]!==l){let R;t[41]!==l?(R=ee=>ee.user?.name?.toLowerCase().includes(l.toLowerCase())||ee.user?.handle?.toLowerCase().includes(l.toLowerCase())||ee.lastMessage?.toLowerCase().includes(l.toLowerCase()),t[41]=l,t[42]=R):R=t[42],U=m.filter(R),t[38]=m,t[39]=l,t[40]=U}else U=t[40];const G=U,te=y&&b[y.id];let se;t[43]!==r||t[44]!==y?(se=y&&r.has(y.user?.id),t[43]=r,t[44]=y,t[45]=se):se=t[45];const ie=se,Y=`w-full md:w-80 flex flex-col border-r border-zinc-100 dark:border-zinc-800 ${y?"hidden md:flex":"flex"}`;let me;t[46]===Symbol.for("react.memo_cache_sentinel")?(me=(0,s.jsx)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)("h2",{className:"text-xl font-bold dark:text-white",children:"Messages"})}),t[46]=me):me=t[46];let Z;t[47]!==G||t[48]!==T||t[49]!==I||t[50]!==e||t[51]!==l||t[52]!==r||t[53]!==d?(Z=(0,s.jsx)(fl,{conversations:G,userResults:d,onSelect:T,onStartNew:I,selectedId:e,searchQuery:l,onSearchChange:o,onlineUsers:r}),t[47]=G,t[48]=T,t[49]=I,t[50]=e,t[51]=l,t[52]=r,t[53]=d,t[54]=Z):Z=t[54];let X;t[55]!==Y||t[56]!==Z?(X=(0,s.jsxs)("div",{className:Y,children:[me,Z]}),t[55]=Y,t[56]=Z,t[57]=X):X=t[57];let ae;t[58]!==te||t[59]!==i||t[60]!==P||t[61]!==V||t[62]!==a||t[63]!==v||t[64]!==ie||t[65]!==y||t[66]!==x||t[67]!==p?(ae=y?(0,s.jsx)(Al,{conversation:y,messages:V,onBack:()=>a("/messages"),onSendMessage:x,onToggleReaction:v,currentUser:i,onTyping:R=>p(y.id,R),isLoading:P,isTyping:te,isOnline:ie}):(0,s.jsxs)("div",{className:"hidden md:flex flex-1 items-center justify-center text-zinc-500 flex-col gap-4",children:[(0,s.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full",children:(0,s.jsx)(De,{size:48,className:"text-zinc-300"})}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-zinc-900 dark:text-white",children:"Select a message"}),(0,s.jsx)("p",{children:"Choose from your existing conversations or start a new one."})]})]}),t[58]=te,t[59]=i,t[60]=P,t[61]=V,t[62]=a,t[63]=v,t[64]=ie,t[65]=y,t[66]=x,t[67]=p,t[68]=ae):ae=t[68];let D;return t[69]!==X||t[70]!==ae?(D=(0,s.jsxs)("div",{className:"flex h-screen bg-white dark:bg-black overflow-hidden md:rounded-xl md:border border-zinc-100 dark:border-zinc-800",children:[X,ae]}),t[69]=X,t[70]=ae,t[71]=D):D=t[71],D},Nt=Dl;function Bl(t){return t.user?.id}var Wl=Q(),Ql=()=>{const t=(0,Wl.c)(39),{currentUser:e}=ce(),a=Fe(),i=e?.id;let r;t[0]!==i?(r=["notifications",i],t[0]=i,t[1]=r):r=t[1];let n;t[2]!==e?.id?(n=()=>ri(e?.id),t[2]=e?.id,t[3]=n):n=t[3];const l=!!e?.id;let o;t[4]!==r||t[5]!==n||t[6]!==l?(o={queryKey:r,queryFn:n,enabled:l},t[4]=r,t[5]=n,t[6]=l,t[7]=o):o=t[7];const{data:c,isLoading:d}=ge(o);let u;t[8]!==c?(u=c===void 0?[]:c,t[8]=c,t[9]=u):u=t[9];const m=u;let f;t[10]!==e||t[11]!==a?(f=()=>{if(!e?.id)return;const C=B.channel(`user_notifications:${e.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`recipient_id=eq.${e.id}`},()=>{a.invalidateQueries({queryKey:["notifications",e.id]})}).subscribe();return()=>B.removeChannel(C)},t[10]=e,t[11]=a,t[12]=f):f=t[12];const x=e?.id;let p;t[13]!==a||t[14]!==x?(p=[x,a],t[13]=a,t[14]=x,t[15]=p):p=t[15],(0,w.useEffect)(f,p);let b;t[16]!==e?(b=()=>ni(e.id),t[16]=e,t[17]=b):b=t[17];let h;t[18]!==e||t[19]!==a?(h=()=>{a.invalidateQueries({queryKey:["notifications",e.id]})},t[18]=e,t[19]=a,t[20]=h):h=t[20];let g;t[21]!==b||t[22]!==h?(g={mutationFn:b,onSuccess:h},t[21]=b,t[22]=h,t[23]=g):g=t[23];const v=Pt(g);let z;t[24]!==e?.id||t[25]!==v||t[26]!==m?(z=()=>{e?.id&&m.some(Vl)&&v.mutate()},t[24]=e?.id,t[25]=v,t[26]=m,t[27]=z):z=t[27];const _=e?.id;let y;if(t[28]!==v||t[29]!==m||t[30]!==_?(y=[_,m,v],t[28]=v,t[29]=m,t[30]=_,t[31]=y):y=t[31],(0,w.useEffect)(z,y),d){let C;return t[32]===Symbol.for("react.memo_cache_sentinel")?(C=(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,s.jsx)(oe,{size:32,className:"animate-spin text-violet-500"})}),t[32]=C):C=t[32],C}if(!e){let C;return t[33]===Symbol.for("react.memo_cache_sentinel")?(C=(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[400px] gap-4 p-8 text-center",children:[(0,s.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-900 p-4 rounded-full",children:(0,s.jsx)(Dt,{size:40,className:"text-zinc-400"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"Sign in to see notifications"}),(0,s.jsx)("p",{className:"text-zinc-500 max-w-xs",children:"Join the conversation and keep track of who's engaging with your content."})]}),t[33]=C):C=t[33],C}const k=Hl;let $;t[34]===Symbol.for("react.memo_cache_sentinel")?($=(0,s.jsx)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800 sticky top-0 bg-white/80 dark:bg-black/80 backdrop-blur-md z-10",children:(0,s.jsx)("h2",{className:"text-xl font-bold dark:text-white",children:"Notifications"})}),t[34]=$):$=t[34];let S;t[35]!==m?(S=m.length>0?m.map(C=>(0,s.jsxs)("div",{className:`p-4 border-b border-zinc-100 dark:border-zinc-800 flex items-start gap-4 hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors cursor-pointer ${C.is_read?"":"bg-violet-50/30 dark:bg-violet-500/5"}`,children:[(0,s.jsx)("div",{className:"shrink-0 pt-1",children:k(C.type)}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-1",children:[(0,s.jsxs)(re,{className:"size-8",children:[(0,s.jsx)(ne,{src:C.avatar}),(0,s.jsx)(le,{children:C.user?.[0]?.toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex-1 flex justify-between items-center",children:[(0,s.jsxs)("span",{className:"font-bold text-sm dark:text-white truncate",children:["@",C.user]}),(0,s.jsx)("span",{className:"text-zinc-500 text-xs whitespace-nowrap",children:Oe(C.created_at)})]})]}),(0,s.jsxs)("p",{className:"text-zinc-600 dark:text-zinc-400 text-[15px] ml-11",children:[C.type==="like"&&"liked your post",C.type==="follow"&&"followed you",C.type==="mention"&&"mentioned you in a post",C.type==="comment"&&"commented on your post",C.type==="repost"&&"reposted your post"]})]}),!C.is_read&&(0,s.jsx)("div",{className:"size-2 rounded-full bg-violet-500 mt-2 shrink-0 shadow-[0_0_8px_rgba(139,92,246,0.5)]"})]},C.id)):(0,s.jsx)("div",{className:"p-16 text-center text-zinc-500",children:(0,s.jsx)("p",{className:"font-medium",children:"No notifications yet."})}),t[35]=m,t[36]=S):S=t[36];let L;return t[37]!==S?(L=(0,s.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm",children:[$,S]}),t[37]=S,t[38]=L):L=t[38],L},Kl=Ql;function Vl(t){return!t.is_read}function Hl(t){switch(t){case"like":return(0,s.jsx)(Ie,{size:20,className:"text-rose-500 fill-rose-500"});case"follow":return(0,s.jsx)(Ft,{size:20,className:"text-blue-500"});case"mention":return(0,s.jsx)(ct,{size:20,className:"text-emerald-500"});case"comment":return(0,s.jsx)(ba,{size:20,className:"text-violet-500"});case"repost":return(0,s.jsx)(ea,{size:20,className:"text-amber-500"});default:return(0,s.jsx)(ct,{size:20,className:"text-zinc-500"})}}const Ul=(t,e,a)=>{const i=t?.id,[r,n]=(0,w.useState)(!1),[l,o]=(0,w.useState)({followers:t?.followers||t?.follower_count||0,following:t?.following||t?.following_count||0}),[c,d]=(0,w.useState)(!1);return(0,w.useEffect)(()=>{t&&(o({followers:t.followers||t.follower_count||0,following:t.following||t.following_count||0}),i&&be(i)&&(yi(i).then(m=>{m&&o({followers:m.followers,following:m.following})}).catch(()=>{}),e&&be(e)&&ji(e,i).then(n).catch(()=>n(!1))))},[t,i,e]),{isFollowing:r,stats:l,loading:c,handleFollow:async()=>{if(!e)return a("Please login to follow!","error");if(e===i)return a("You cannot follow yourself!","error");if(!i||!be(i)||!be(e)){const m=!r;n(m),o(f=>{const x=typeof f.followers=="string"?parseInt(f.followers.replace(/,/g,"")):f.followers||0;return{...f,followers:m?x+1:Math.max(0,x-1)}}),a(m?"Followed":"Unfollowed");return}d(!0);try{const m=await vi(e,i);n(m),o(f=>({...f,followers:m?(f.followers||0)+1:Math.max(0,(f.followers||0)-1)})),a(m?"Followed":"Unfollowed")}catch(m){console.error("Failed to toggle follow:",m),a("Failed to update follow status","error")}finally{d(!1)}},setStats:o}};var Jl=({profile:t,currentUser:e,isCurrentUser:a,onEditProfile:i,showToast:r,isCommunity:n})=>{const{isFollowing:l,stats:o,loading:c,handleFollow:d}=Ul(t,e?.id,r),u=_e(),[m,f]=(0,w.useState)(!1),x=async()=>{if(!e){r("Please sign in to message users");return}f(!0);try{u(`/messages/${await Qt(e.id,t.id)}`)}catch(p){console.error("Failed to start conversation:",p),r("Failed to open chat")}finally{f(!1)}};return(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("div",{className:"relative h-32 sm:h-48 w-full bg-zinc-200 dark:bg-zinc-800",children:[t.cover&&(0,s.jsx)("img",{src:t.cover,className:"h-full w-full object-cover transition-opacity duration-500",alt:"Cover"}),(0,s.jsx)("div",{className:"absolute -bottom-12 sm:-bottom-16 left-4 sm:left-6",children:(0,s.jsx)("div",{className:"p-1 bg-white dark:bg-black rounded-full overflow-hidden shadow-xl ring-4 ring-white dark:ring-black relative",children:(0,s.jsxs)(re,{className:"size-24 sm:size-32",children:[(0,s.jsx)(ne,{src:t.avatar,alt:t.handle,className:"object-cover"}),(0,s.jsx)(le,{className:"text-4xl font-bold",children:t.handle?.[0]?.toUpperCase()})]})})})]}),(0,s.jsxs)("div",{className:"flex flex-col p-4 sm:p-6 pt-16 sm:pt-20 space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsx)("div",{className:"flex-1 min-w-0 pr-4"}),(0,s.jsx)("div",{className:"flex gap-2 shrink-0",children:a?(0,s.jsx)(fe,{variant:"secondary",onClick:()=>i(t),className:"text-sm px-5",children:"Edit profile"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:x,disabled:m,className:"rounded-full p-2 border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 dark:border-zinc-800 transition-colors disabled:opacity-50",children:m?(0,s.jsx)(oe,{size:20,className:"animate-spin"}):(0,s.jsx)(De,{size:20})}),(0,s.jsx)("button",{className:"rounded-full p-2 border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 dark:border-zinc-800 transition-colors",children:(0,s.jsx)(Xe,{size:20})}),(0,s.jsx)(fe,{variant:l?"secondary":"primary",onClick:d,className:"text-sm px-6 min-w-[100px]",disabled:c,children:c?(0,s.jsx)(oe,{size:16,className:"animate-spin mx-auto"}):l?"Following":"Follow"}),(0,s.jsx)("button",{className:"rounded-full p-2 hover:bg-zinc-100 text-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-800 transition-colors",children:(0,s.jsx)(Ue,{size:20})})]})})]}),(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsx)("div",{className:"flex items-center gap-1.5",children:(0,s.jsxs)("h3",{className:"text-xl sm:text-2xl font-extrabold truncate dark:text-white flex items-center gap-1",children:[t.name,t.verified&&(0,s.jsx)(Ae,{})]})}),!n&&(0,s.jsx)("div",{className:"flex items-center space-x-3",children:(0,s.jsxs)("span",{className:"text-zinc-500 font-medium text-sm px-1.5 py-0.5 -ml-1.5 rounded-md dark:text-zinc-400",children:["@",t.handle]})})]}),(0,s.jsx)("div",{className:"whitespace-pre-line text-zinc-900 dark:text-zinc-100 leading-relaxed text-sm sm:text-[15px]",children:t.bio}),(t.website||t.location)&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-x-5 gap-y-2 text-sm pt-1",children:[t.location&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)(et,{size:14}),(0,s.jsx)("span",{children:t.location})]}),t.website&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)(Bt,{size:14}),(0,s.jsx)("a",{href:`https://${t.website}`,target:"_blank",rel:"noreferrer",className:"text-violet-600 hover:underline font-semibold text-black dark:text-white",children:t.website})]})]}),(0,s.jsx)("div",{className:"flex gap-4 sm:gap-6 text-sm pt-2",children:n?(0,s.jsxs)("button",{className:"flex gap-x-1 hover:underline group",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white group-hover:text-violet-600",children:t.members}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Members"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{className:"flex gap-x-1 hover:underline group",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white group-hover:text-violet-600",children:o.following}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Following"})]}),(0,s.jsxs)("button",{className:"flex gap-x-1 hover:underline group",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white group-hover:text-violet-600",children:o.followers}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Followers"})]})]})})]})]})},Gl=Jl,Zl=Q(),Xl=t=>{const e=(0,Zl.c)(70),{onEditProfile:a}=t,{handle:i}=Ge(),r=_e(),{profiles:n,currentUser:l,getProfileByHandle:o}=ce(),{getUserPosts:c}=Pe(),{addToast:d}=ye(),[u,m]=(0,w.useState)("feed"),[f,x]=(0,w.useState)(!n[i]),[p,b]=(0,w.useState)(n[i]);let h,g;e[0]!==o||e[1]!==i||e[2]!==n?(h=()=>{(async()=>n[i]?b(n[i]):(x(!0),b(await o(i)),x(!1)))()},g=[i,n,o],e[0]=o,e[1]=i,e[2]=n,e[3]=h,e[4]=g):(h=e[3],g=e[4]),(0,w.useEffect)(h,g);let v;e[5]!==u||e[6]!==c||e[7]!==i?(v=c(i,u),e[5]=u,e[6]=c,e[7]=i,e[8]=v):v=e[8];const z=v;let _;e[9]!==r?(_=Y=>{r(`/post/${Y}`)},e[9]=r,e[10]=_):_=e[10];const y=_;let k;e[11]!==i||e[12]!==r?(k=Y=>{Y!==i&&r(`/u/${Y}`)},e[11]=i,e[12]=r,e[13]=k):k=e[13];const $=k;if(f){let Y;return e[14]===Symbol.for("react.memo_cache_sentinel")?(Y=(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)(oe,{size:40,className:"animate-spin text-violet-500"})}),e[14]=Y):Y=e[14],Y}let S;e[15]!==i||e[16]!==p?(S=p||{id:null,name:i,handle:i,avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm",cover:"https://systemadminbd.com/uploads/675346dd55e0c7.43939630.png",bio:"Profile not found",following:"0",followers:"0"},e[15]=i,e[16]=p,e[17]=S):S=e[17];const L=S;let C;e[18]!==d||e[19]!==l||e[20]!==y||e[21]!==$||e[22]!==z?(C=()=>z.length>0?z.map(Y=>(0,s.jsx)(Be,{currentUser:l,showToast:d,...Y,onClick:()=>y(Y.id),onUserClick:$},Y.id)):(0,s.jsxs)("div",{className:"p-16 text-center text-zinc-500 flex flex-col items-center gap-4",children:[(0,s.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-4 rounded-full",children:(0,s.jsx)(Tt,{size:32,className:"text-zinc-300"})}),(0,s.jsx)("p",{className:"font-medium",children:"No posts found"})]}),e[18]=d,e[19]=l,e[20]=y,e[21]=$,e[22]=z,e[23]=C):C=e[23];const M=C;let I;e[24]!==r?(I=()=>r(-1),e[24]=r,e[25]=I):I=e[25];let O;e[26]===Symbol.for("react.memo_cache_sentinel")?(O=(0,s.jsx)(Ye,{size:22}),e[26]=O):O=e[26];let T;e[27]!==I?(T=(0,s.jsx)("button",{onClick:I,className:"p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:O}),e[27]=I,e[28]=T):T=e[28];let W;e[29]!==L.name?(W=(0,s.jsx)("h5",{className:"text-lg font-bold dark:text-white leading-none",children:L.name}),e[29]=L.name,e[30]=W):W=e[30];let q;e[31]!==c||e[32]!==i?(q=c(i,"feed"),e[31]=c,e[32]=i,e[33]=q):q=e[33];let E;e[34]!==q.length?(E=(0,s.jsxs)("span",{className:"text-xs text-zinc-500 mt-0.5",children:[q.length," Posts"]}),e[34]=q.length,e[35]=E):E=e[35];let j;e[36]!==W||e[37]!==E?(j=(0,s.jsxs)("div",{className:"flex flex-col",children:[W,E]}),e[36]=W,e[37]=E,e[38]=j):j=e[38];let N;e[39]!==T||e[40]!==j?(N=(0,s.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3 md:hidden",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4",children:[T,j]})}),e[39]=T,e[40]=j,e[41]=N):N=e[41];const F=l?.handle===L.handle;let P;e[42]!==d||e[43]!==l||e[44]!==L||e[45]!==a||e[46]!==F?(P=(0,s.jsx)(Gl,{profile:L,currentUser:l,isCurrentUser:F,onEditProfile:a,showToast:d}),e[42]=d,e[43]=l,e[44]=L,e[45]=a,e[46]=F,e[47]=P):P=e[47];let A;e[48]===Symbol.for("react.memo_cache_sentinel")?(A=(0,s.jsx)("div",{className:"sticky top-[60px] md:top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-10 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)(os,{className:"w-full h-auto bg-transparent p-0 rounded-none justify-start px-2",children:["feed","replies","media"].map(eo)})}),e[48]=A):A=e[48];let K;e[49]!==M?(K=M(),e[49]=M,e[50]=K):K=e[50];let H;e[51]!==K?(H=(0,s.jsx)($e,{value:"feed",className:"m-0 border-none",children:K}),e[51]=K,e[52]=H):H=e[52];let V;e[53]!==M?(V=M(),e[53]=M,e[54]=V):V=e[54];let U;e[55]!==V?(U=(0,s.jsx)($e,{value:"replies",className:"m-0 border-none",children:V}),e[55]=V,e[56]=U):U=e[56];let G;e[57]!==M?(G=M(),e[57]=M,e[58]=G):G=e[58];let te;e[59]!==G?(te=(0,s.jsx)($e,{value:"media",className:"m-0 border-none",children:G}),e[59]=G,e[60]=te):te=e[60];let se;e[61]!==u||e[62]!==H||e[63]!==U||e[64]!==te?(se=(0,s.jsxs)(ls,{value:u,onValueChange:m,className:"w-full",children:[A,H,U,te]}),e[61]=u,e[62]=H,e[63]=U,e[64]=te,e[65]=se):se=e[65];let ie;return e[66]!==N||e[67]!==P||e[68]!==se?(ie=(0,s.jsx)("div",{className:"border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:(0,s.jsxs)("div",{className:"border-y md:border-b-0 border-zinc-100 dark:border-zinc-800",children:[N,P,se]})}),e[66]=N,e[67]=P,e[68]=se,e[69]=ie):ie=e[69],ie},Yl=Xl;function eo(t){return(0,s.jsx)(cs,{value:t,className:"flex-1 py-4 text-sm font-bold capitalize rounded-none border-b-2 data-[state=active]:border-black dark:data-[state=active]:border-white data-[state=active]:text-black dark:data-[state=active]:text-white text-zinc-500 transition-all hover:bg-zinc-50 dark:hover:bg-zinc-900",children:t==="feed"?"Posts":t},t)}var to=Q(),so=()=>{const t=(0,to.c)(34),{id:e}=Ge(),a=_e(),{currentUser:i}=ce(),{addToast:r}=ye();let n,l;t[0]!==e?(n=["post",e],l=async()=>{if(!be(e))throw new Error("Invalid post ID");return Za(e)},t[0]=e,t[1]=n,t[2]=l):(n=t[1],l=t[2]);const o=!!e;let c;t[3]!==n||t[4]!==l||t[5]!==o?(c={queryKey:n,queryFn:l,enabled:o,retry:!1},t[3]=n,t[4]=l,t[5]=o,t[6]=c):c=t[6];const{data:d,isLoading:u,isError:m}=ge(c);if(u){let k;return t[7]===Symbol.for("react.memo_cache_sentinel")?(k=(0,s.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:(0,s.jsx)(lt,{})}),t[7]=k):k=t[7],k}if(m||!d){let k;t[8]===Symbol.for("react.memo_cache_sentinel")?(k=(0,s.jsx)("p",{className:"text-zinc-500",children:"Post not found"}),t[8]=k):k=t[8];let $;return t[9]!==a?($=(0,s.jsxs)("div",{className:"p-10 text-center",children:[k,(0,s.jsx)("button",{onClick:()=>a(-1),className:"text-violet-500 mt-4 underline font-bold",children:"Go back"})]}),t[9]=a,t[10]=$):$=t[10],$}let f;t[11]!==a?(f=()=>a(-1),t[11]=a,t[12]=f):f=t[12];let x;t[13]===Symbol.for("react.memo_cache_sentinel")?(x=(0,s.jsx)(Ye,{size:20,strokeWidth:2.5}),t[13]=x):x=t[13];let p;t[14]!==f?(p=(0,s.jsx)("button",{onClick:f,className:"p-2 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:x}),t[14]=f,t[15]=p):p=t[15];let b;t[16]===Symbol.for("react.memo_cache_sentinel")?(b=(0,s.jsx)("h5",{className:"text-xl font-bold dark:text-white",children:"Post"}),t[16]=b):b=t[16];let h;t[17]!==p?(h=(0,s.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4",children:[p,b]})}),t[17]=p,t[18]=h):h=t[18];let g;t[19]!==d.comments?(g=d.comments||[],t[19]=d.comments,t[20]=g):g=t[20];let v,z;t[21]!==a?(v=k=>a(`/u/${k}`),z=()=>a(-1),t[21]=a,t[22]=v,t[23]=z):(v=t[22],z=t[23]);let _;t[24]!==r||t[25]!==i||t[26]!==d||t[27]!==v||t[28]!==z||t[29]!==g?(_=(0,s.jsx)(Be,{...d,isDetail:!0,currentUser:i,initialComments:g,showToast:r,onUserClick:v,onDelete:z}),t[24]=r,t[25]=i,t[26]=d,t[27]=v,t[28]=z,t[29]=g,t[30]=_):_=t[30];let y;return t[31]!==_||t[32]!==h?(y=(0,s.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm mb-20 animate-in slide-in-from-right-5 duration-300",children:(0,s.jsxs)("div",{className:"border-b border-zinc-100 dark:border-zinc-800",children:[h,_]})}),t[31]=_,t[32]=h,t[33]=y):y=t[33],y},ao=so,io=Q();function ro(){const t=(0,io.c)(49),e=qe(),{currentUser:a,authMode:i,setAuthMode:r}=ce(),{darkMode:n}=tt(),{isOpen:l,images:o,currentIndex:c,closeLightbox:d,setIndex:u}=st(),[m,f]=(0,w.useState)(!1),[x,p]=(0,w.useState)(!1),[b,h]=(0,w.useState)(!1);let g;t[0]===Symbol.for("react.memo_cache_sentinel")?(g={},t[0]=g):g=t[0];const[v,z]=(0,w.useState)(g),[_,y]=(0,w.useState)(null);if(i){const H=n?"dark":"";let V;t[1]!==r?(V=()=>r(null),t[1]=r,t[2]=V):V=t[2];let U;t[3]!==i||t[4]!==r?(U=()=>r(i==="login"?"signup":"login"),t[3]=i,t[4]=r,t[5]=U):U=t[5];let G;t[6]!==i||t[7]!==V||t[8]!==U?(G=(0,s.jsx)("div",{className:"min-h-screen bg-white dark:bg-black flex items-center justify-center p-4",children:(0,s.jsx)(pe,{children:(0,s.jsx)(Ur,{type:i,onComplete:V,onSwitch:U})})}),t[6]=i,t[7]=V,t[8]=U,t[9]=G):G=t[9];let te;return t[10]!==H||t[11]!==G?(te=(0,s.jsx)("div",{className:H,children:G}),t[10]=H,t[11]=G,t[12]=te):te=t[12],te}let k;t[13]===Symbol.for("react.memo_cache_sentinel")?(k=(0,s.jsx)(Gi,{}),t[13]=k):k=t[13];let $;t[14]===Symbol.for("react.memo_cache_sentinel")?($=(0,s.jsx)(br,{onPostClick:()=>f(!0)}),t[14]=$):$=t[14];let S;t[15]===Symbol.for("react.memo_cache_sentinel")?(S=(0,s.jsx)(ue,{path:"/",element:(0,s.jsx)(pe,{children:(0,s.jsx)(Dn,{onStoryClick:y,onAddStory:()=>h(!0)})})}),t[15]=S):S=t[15];let L;t[16]===Symbol.for("react.memo_cache_sentinel")?(L=(0,s.jsx)(ue,{path:"/home",element:(0,s.jsx)(dt,{to:"/",replace:!0})}),t[16]=L):L=t[16];let C;t[17]===Symbol.for("react.memo_cache_sentinel")?(C=(0,s.jsx)(ue,{path:"/explore",element:(0,s.jsx)(pe,{children:(0,s.jsx)(Jn,{})})}),t[17]=C):C=t[17];let M;t[18]===Symbol.for("react.memo_cache_sentinel")?(M=(0,s.jsx)(ue,{path:"/reels",element:(0,s.jsx)(pe,{children:(0,s.jsx)(nl,{})})}),t[18]=M):M=t[18];let I;t[19]===Symbol.for("react.memo_cache_sentinel")?(I=(0,s.jsx)(ue,{path:"/messages",element:(0,s.jsx)(pe,{children:(0,s.jsx)(Nt,{})})}),t[19]=I):I=t[19];let O;t[20]===Symbol.for("react.memo_cache_sentinel")?(O=(0,s.jsx)(ue,{path:"/messages/:id",element:(0,s.jsx)(pe,{children:(0,s.jsx)(Nt,{})})}),t[20]=O):O=t[20];let T;t[21]===Symbol.for("react.memo_cache_sentinel")?(T=(0,s.jsx)(ue,{path:"/notifications",element:(0,s.jsx)(pe,{children:(0,s.jsx)(Kl,{})})}),t[21]=T):T=t[21];let W;t[22]===Symbol.for("react.memo_cache_sentinel")?(W=(0,s.jsx)(ue,{path:"/post/:id",element:(0,s.jsx)(pe,{children:(0,s.jsx)(ao,{})})}),t[22]=W):W=t[22];let q;t[23]===Symbol.for("react.memo_cache_sentinel")?(q=(0,s.jsx)(ue,{path:"/u/:handle",element:(0,s.jsx)(pe,{children:(0,s.jsx)(Yl,{onEditProfile:H=>{z(H),p(!0)}})})}),t[23]=q):q=t[23];let E;t[24]===Symbol.for("react.memo_cache_sentinel")?(E=(0,s.jsxs)(ue,{element:$,children:[S,L,C,M,I,O,T,W,q,(0,s.jsx)(ue,{path:"*",element:(0,s.jsx)(dt,{to:"/explore"})})]}),t[24]=E):E=t[24];let j;t[25]!==e?(j=(0,s.jsx)(Ma,{location:e,children:E},e.pathname),t[25]=e,t[26]=j):j=t[26];let N;t[27]!==v||t[28]!==x||t[29]!==m||t[30]!==b?(N=(0,s.jsx)(Tr,{isPostModalOpen:m,setIsPostModalOpen:f,isEditProfileOpen:x,setIsEditProfileOpen:p,isStoryModalOpen:b,setIsStoryModalOpen:h,editProfileData:v,setEditProfileData:z}),t[27]=v,t[28]=x,t[29]=m,t[30]=b,t[31]=N):N=t[31];let F;t[32]!==_?(F=_&&(0,s.jsx)(Ar,{story:_,onClose:()=>y(null)}),t[32]=_,t[33]=F):F=t[33];let P;t[34]!==d||t[35]!==c||t[36]!==o||t[37]!==l||t[38]!==u?(P=l&&(0,s.jsx)(Qr,{images:o,currentIndex:c,onClose:d,onNavigate:u}),t[34]=d,t[35]=c,t[36]=o,t[37]=l,t[38]=u,t[39]=P):P=t[39];let A;t[40]!==a||t[41]!==e.pathname?(A=a&&e.pathname==="/"&&(0,s.jsx)("button",{onClick:()=>f(!0),className:"fixed bottom-20 right-5 md:hidden z-50 bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 size-12 rounded-full flex items-center justify-center shadow-2xl hover:scale-110 active:scale-90 transition-all cursor-pointer group",title:"Create Post",children:(0,s.jsx)(Ne,{size:28,className:"group-hover:rotate-90 transition-transform duration-300"})}),t[40]=a,t[41]=e.pathname,t[42]=A):A=t[42];let K;return t[43]!==j||t[44]!==N||t[45]!==F||t[46]!==P||t[47]!==A?(K=(0,s.jsxs)(s.Fragment,{children:[k,j,N,F,P,A]}),t[43]=j,t[44]=N,t[45]=F,t[46]=P,t[47]=A,t[48]=K):K=t[48],K}var no=new Aa;(0,Qa.createRoot)(document.getElementById("root")).render((0,s.jsx)(w.StrictMode,{children:(0,s.jsx)(Js,{client:no,children:(0,s.jsx)(Pa,{children:(0,s.jsx)($i,{children:(0,s.jsx)(ki,{children:(0,s.jsx)(Ci,{children:(0,s.jsx)(Ti,{children:(0,s.jsx)(Fi,{children:(0,s.jsx)(Ei,{children:(0,s.jsx)(ro,{})})})})})})})})})}));
