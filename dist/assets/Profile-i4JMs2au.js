import{n as oe}from"./rolldown-runtime-2JzG8er9.js";import{s as he,u as fe,w as pe,y as be}from"./framework-pMVb9Z5_.js";import"./database-ApDMvJcm.js";import{Dt as ue,Gt as j,Ht as je,Kt as ve,Nt as ge,Sn as ze,Tt as ke,Vt as Ne,an as we,mt as ye,yn as Ce}from"./ui-libs-Dldhg1Ot.js";import{$ as _e,C as Pe,D as Fe,H as ce,O as Se,Q as Me,S as Te,Z as Le,c as ne,l as $e,o as We,s as Ue,u as Ae,x as De,yt as Ee}from"./index-CDoqeRNb.js";import{n as Oe}from"./post-Cj3YiyFi.js";import{n as He,t as qe}from"./linkify-fXGRsD3N.js";import{c as Be}from"./hooks-gDAxiSvt.js";var Ie=he(),Ve=oe(pe(),1),s=oe(fe(),1),Ge=({profile:t,currentUser:e,isCurrentUser:G,onEditProfile:te,showToast:c,isCommunity:Z,onShowFollowers:K,onShowFollowing:o})=>{const{isFollowing:v,stats:g,loading:b,handleFollow:Q}=Te(t,e?.id,c),h=be(),[z,d]=(0,Ve.useState)(!1),x=async()=>{if(!e){c("Please sign in to message users");return}d(!0);try{h(`/messages/${await Ee(e.id,t.id)}`)}catch(i){console.error("Failed to start conversation:",i),c("Failed to open chat")}finally{d(!1)}};return(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("div",{className:"relative h-32 sm:h-48 w-full bg-zinc-200 dark:bg-zinc-800",children:[t.cover&&(0,s.jsx)("img",{src:t.cover,className:"h-full w-full object-cover transition-opacity duration-500",alt:"Cover"}),(0,s.jsx)("div",{className:"absolute -bottom-12 sm:-bottom-16 left-4 sm:left-6",children:(0,s.jsx)("div",{className:"p-1 bg-white dark:bg-black rounded-full overflow-hidden shadow-xl ring-4 ring-white dark:ring-black relative",children:(0,s.jsxs)(Le,{className:"size-24 sm:size-32",children:[(0,s.jsx)(_e,{src:t.avatar,alt:t.handle,className:"object-cover"}),(0,s.jsx)(Me,{className:"text-4xl font-bold",children:t.handle?.[0]?.toUpperCase()})]})})})]}),(0,s.jsxs)("div",{className:"flex flex-col p-4 sm:p-6 pt-16 sm:pt-20 space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsx)("div",{className:"flex-1 min-w-0 pr-4"}),(0,s.jsx)("div",{className:"flex gap-2 shrink-0",children:G?(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>te(t),className:"p-2 rounded-full border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 transition-all active:scale-95 flex items-center justify-center size-10",title:"Edit Profile",children:(0,s.jsx)(ge,{size:20})}),(0,s.jsx)("button",{onClick:()=>h("/settings"),className:"p-2 rounded-full border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 transition-all active:scale-95",title:"Settings",children:(0,s.jsx)(ke,{size:20})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:x,disabled:z,className:"rounded-full p-2 border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 dark:border-zinc-800 transition-colors disabled:opacity-50",children:z?(0,s.jsx)(j,{size:20,className:"animate-spin"}):(0,s.jsx)(je,{size:20})}),(0,s.jsx)("button",{className:"rounded-full p-2 border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 dark:border-zinc-800 transition-colors",children:(0,s.jsx)(Ce,{size:20})}),(0,s.jsx)(ce,{variant:v?"secondary":"primary",onClick:Q,className:"text-sm px-6 min-w-[100px]",disabled:b,children:b?(0,s.jsx)(j,{size:16,className:"animate-spin mx-auto"}):v?"Following":"Follow"}),(0,s.jsx)("button",{className:"rounded-full p-2 hover:bg-zinc-100 text-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-800 transition-colors",children:(0,s.jsx)(we,{size:20})})]})})]}),(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsx)("div",{className:"flex items-center gap-1.5",children:(0,s.jsxs)("h3",{className:"text-xl sm:text-2xl font-extrabold truncate dark:text-white flex items-center gap-1",children:[t.name,t.verified&&(0,s.jsx)(Pe,{})]})}),!Z&&(0,s.jsx)("div",{className:"flex items-center space-x-3",children:(0,s.jsxs)("span",{className:"text-zinc-500 font-medium text-sm px-1.5 py-0.5 -ml-1.5 rounded-md dark:text-zinc-400",children:["@",t.handle]})})]}),(0,s.jsx)("div",{className:"whitespace-pre-line text-zinc-900 dark:text-zinc-100 leading-relaxed text-sm sm:text-[15px]",children:(0,s.jsx)(He,{options:{...qe,render:({attributes:i,content:f})=>{const{href:l,...k}=i,n=!l.startsWith("/")&&(l.startsWith("http")||l.startsWith("www"));return l.startsWith("/u/")||l.startsWith("/tags/")||l.startsWith("/c/")||l.startsWith("/explore")?(0,s.jsx)("span",{...k,className:"text-rose-500 dark:text-rose-400 font-bold hover:underline cursor-pointer",onClick:X=>{X.stopPropagation(),h(l)},children:f},f):(0,s.jsx)("a",{href:l,...k,target:n?"_blank":void 0,rel:n?"noopener noreferrer":void 0,children:f},f)}},children:t.bio})}),(t.website||t.location)&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-x-5 gap-y-2 text-sm pt-1",children:[t.location&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)(Ne,{size:14}),(0,s.jsx)("span",{children:t.location})]}),t.website&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)(ve,{size:14}),(0,s.jsx)("a",{href:`https://${t.website}`,target:"_blank",rel:"noreferrer",className:"text-violet-600 hover:underline font-semibold text-black dark:text-white",children:t.website})]})]}),(0,s.jsx)("div",{className:"flex gap-4 sm:gap-6 text-sm pt-2 relative z-10",children:Z?(0,s.jsxs)("button",{className:"flex gap-x-1 group cursor-pointer",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white",children:t.members}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Members"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:i=>{i.preventDefault(),i.stopPropagation(),o()},className:"flex gap-x-1 group cursor-pointer",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white",children:g.following}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Following"})]}),(0,s.jsxs)("button",{onClick:i=>{i.preventDefault(),i.stopPropagation(),K()},className:"flex gap-x-1 group cursor-pointer",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white",children:g.followers}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Followers"})]})]})})]})]})},Ke=Ge,Qe=t=>{const e=(0,Ie.c)(89),{onEditProfile:G}=t,{handle:te,profile:c,loading:Z,setUserPosts:K,activeProfileTab:o,setActiveProfileTab:v,loadingPosts:g,isFetchingMorePosts:b,hasMorePosts:Q,filteredPosts:h,isFollowModalOpen:z,setIsFollowModalOpen:d,followModalType:x,followListData:i,isListLoading:f,isFetchingMoreFollows:l,hasMoreFollows:k,openFollowModal:n,handlePostClick:X,handleUserClick:ae,loadUserPosts:ie,currentUser:u,addToast:N,navigate:w}=Be();if(Z){let r;return e[0]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)(j,{size:40,className:"animate-spin text-violet-500"})}),e[0]=r):r=e[0],r}if(!c){const r=`Try searching for another. The user @${te} could not be found.`;let p;return e[1]!==r?(p=(0,s.jsx)("div",{className:"bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-[600px] flex items-center justify-center",children:(0,s.jsx)(Fe,{title:"Account doesn't exist",message:r,icon:ye})}),e[1]=r,e[2]=p):p=e[2],p}const a=c;let J;e[3]!==o||e[4]!==N||e[5]!==u||e[6]!==a.handle||e[7]!==h||e[8]!==X||e[9]!==ae||e[10]!==Q||e[11]!==b||e[12]!==ie||e[13]!==g||e[14]!==c||e[15]!==K?(J=r=>{const p=r===void 0?!1:r;return g?(0,s.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,s.jsx)(j,{className:"animate-spin text-violet-500",size:32})}):h.length>0?(0,s.jsxs)(s.Fragment,{children:[h.map(se=>(0,s.jsx)(Oe,{currentUser:u,showToast:N,...se,onClick:()=>X(se.id),onUserClick:ae,onDelete:de=>K(xe=>xe.filter(me=>me.id!==de))},se.feed_id||se.id)),Q&&(0,s.jsx)("div",{className:"p-6 flex justify-center",children:(0,s.jsxs)(ce,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>ie(c.id,!0),disabled:b,children:[b&&(0,s.jsx)(j,{size:18,className:"animate-spin mr-2"}),"Load more posts"]})})]}):p?null:(0,s.jsxs)("div",{className:"p-20 text-center text-zinc-500 flex flex-col items-center gap-4 animate-in fade-in duration-500",children:[(0,s.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full mb-2 ring-1 ring-zinc-100 dark:ring-zinc-800",children:(0,s.jsx)(ue,{size:40,className:"text-zinc-300 dark:text-zinc-700"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:o==="collections"?"No collections yet":"No posts yet"}),(0,s.jsx)("p",{className:"text-sm text-zinc-500 dark:text-zinc-400 max-w-[250px]",children:o==="collections"?"Saved posts and curated collections will appear here.":`When @${a.handle} shares posts, they will appear here.`})]})},e[3]=o,e[4]=N,e[5]=u,e[6]=a.handle,e[7]=h,e[8]=X,e[9]=ae,e[10]=Q,e[11]=b,e[12]=ie,e[13]=g,e[14]=c,e[15]=K,e[16]=J):J=e[16];const m=J;let y;e[17]!==w?(y=()=>w(-1),e[17]=w,e[18]=y):y=e[18];let R;e[19]===Symbol.for("react.memo_cache_sentinel")?(R=(0,s.jsx)(ze,{size:22}),e[19]=R):R=e[19];let C;e[20]!==y?(C=(0,s.jsx)("button",{onClick:y,className:"p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:R}),e[20]=y,e[21]=C):C=e[21];let _;e[22]!==a.name?(_=(0,s.jsx)("h5",{className:"text-lg font-bold dark:text-white leading-none",children:a.name}),e[22]=a.name,e[23]=_):_=e[23];const le=a.posts_count||0;let P;e[24]!==le?(P=(0,s.jsxs)("span",{className:"text-xs text-zinc-500 mt-0.5",children:[le," Posts"]}),e[24]=le,e[25]=P):P=e[25];let F;e[26]!==_||e[27]!==P?(F=(0,s.jsxs)("div",{className:"flex flex-col",children:[_,P]}),e[26]=_,e[27]=P,e[28]=F):F=e[28];let S;e[29]!==C||e[30]!==F?(S=(0,s.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3 md:hidden",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4",children:[C,F]})}),e[29]=C,e[30]=F,e[31]=S):S=e[31];const re=u?.handle===a.handle;let M,T;e[32]!==n?(M=()=>n("Followers"),T=()=>n("Following"),e[32]=n,e[33]=M,e[34]=T):(M=e[33],T=e[34]);let L;e[35]!==N||e[36]!==u||e[37]!==a||e[38]!==G||e[39]!==re||e[40]!==M||e[41]!==T?(L=(0,s.jsx)(Ke,{profile:a,currentUser:u,isCurrentUser:re,onEditProfile:G,showToast:N,onShowFollowers:M,onShowFollowing:T}),e[35]=N,e[36]=u,e[37]=a,e[38]=G,e[39]=re,e[40]=M,e[41]=T,e[42]=L):L=e[42];let Y;e[43]===Symbol.for("react.memo_cache_sentinel")?(Y=(0,s.jsx)("div",{className:"sticky top-[60px] md:top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-10 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)($e,{className:"w-full h-auto bg-transparent p-0 rounded-none justify-start px-2 overflow-x-auto hide-scrollbar",children:["feed","collections","media"].map(Xe)})}),e[43]=Y):Y=e[43];let $;e[44]!==m?($=m(),e[44]=m,e[45]=$):$=e[45];let W;e[46]!==$?(W=(0,s.jsx)(ne,{value:"feed",className:"m-0 border-none",children:$}),e[46]=$,e[47]=W):W=e[47];let U;e[48]!==a.id||e[49]!==a.name?(U=(0,s.jsx)(We,{name:a.name,number:a.id}),e[48]=a.id,e[49]=a.name,e[50]=U):U=e[50];let A;e[51]!==m?(A=m(!0),e[51]=m,e[52]=A):A=e[52];let D;e[53]!==U||e[54]!==A?(D=(0,s.jsxs)(ne,{value:"collections",className:"m-0 border-none",children:[U,A]}),e[53]=U,e[54]=A,e[55]=D):D=e[55];let E;e[56]!==m?(E=m(),e[56]=m,e[57]=E):E=e[57];let O;e[58]!==E?(O=(0,s.jsx)(ne,{value:"media",className:"m-0 border-none",children:E}),e[58]=E,e[59]=O):O=e[59];let H;e[60]!==o||e[61]!==v||e[62]!==W||e[63]!==D||e[64]!==O?(H=(0,s.jsxs)(Ue,{value:o,onValueChange:v,className:"w-full",children:[Y,W,D,O]}),e[60]=o,e[61]=v,e[62]=W,e[63]=D,e[64]=O,e[65]=H):H=e[65];let q;e[66]!==L||e[67]!==H||e[68]!==S?(q=(0,s.jsxs)("div",{className:"border-y md:border-b-0 border-zinc-100 dark:border-zinc-800",children:[S,L,H]}),e[66]=L,e[67]=H,e[68]=S,e[69]=q):q=e[69];let B;e[70]!==d?(B=()=>d(!1),e[70]=d,e[71]=B):B=e[71];let I;e[72]!==i||e[73]!==x||e[74]!==k||e[75]!==l||e[76]!==f||e[77]!==w||e[78]!==n||e[79]!==d?(I=(0,s.jsx)("div",{className:"min-h-[300px]",children:f?(0,s.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,s.jsx)(j,{className:"animate-spin text-violet-500",size:32})}):i.length>0?(0,s.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800 -mx-6",children:[i.map(r=>(0,s.jsx)(De,{profile:r,onUserClick:p=>{d(!1),w(`/u/${p}`)}},r.id)),k&&(0,s.jsx)("div",{className:"p-4 flex justify-center",children:(0,s.jsxs)(ce,{variant:"secondary",className:"w-full text-xs",onClick:()=>n(x,!0),disabled:l,children:[l?(0,s.jsx)(j,{size:14,className:"animate-spin mr-2"}):null,"Load more"]})})]}):(0,s.jsx)("div",{className:"flex flex-col items-center justify-center py-20 text-zinc-500",children:(0,s.jsxs)("p",{className:"font-medium",children:["No ",x.toLowerCase()," yet."]})})}),e[72]=i,e[73]=x,e[74]=k,e[75]=l,e[76]=f,e[77]=w,e[78]=n,e[79]=d,e[80]=I):I=e[80];let V;e[81]!==x||e[82]!==z||e[83]!==B||e[84]!==I?(V=(0,s.jsx)(Se,{isOpen:z,onClose:B,title:x,className:"sm:max-w-md",children:I}),e[81]=x,e[82]=z,e[83]=B,e[84]=I,e[85]=V):V=e[85];let ee;return e[86]!==q||e[87]!==V?(ee=(0,s.jsxs)("div",{className:"border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen pb-20",children:[q,V]}),e[86]=q,e[87]=V,e[88]=ee):ee=e[88],ee},is=Qe;function Xe(t){return(0,s.jsx)(Ae,{value:t,className:"flex-1 py-4 text-sm font-bold capitalize rounded-none border-b-2 data-[state=active]:border-black dark:data-[state=active]:border-white data-[state=active]:text-black dark:data-[state=active]:text-white text-zinc-500 transition-all hover:bg-zinc-50 dark:hover:bg-zinc-900 whitespace-nowrap px-4",children:t==="feed"?"Posts":t},t)}export{is as default};
