import{n as js}from"./rolldown-runtime-2JzG8er9.js";import{$ as Da,$n as Oa,$t as ws,A as qa,An as Wa,Ar as Ua,At as Ba,B as ys,Bn as zs,Bt as Va,Cn as Qa,Ct as Ja,D as Ha,Dn as ct,Dr as Wt,Dt as Ka,En as Ut,Er as Ya,Et as Xa,F as Za,Fn as Rt,Fr as ut,Ft as Ga,G as ei,Gn as Ns,Gt as ks,H as _s,Hn as Xe,Ht as et,I as ti,In as si,Ir as ai,It as ii,J as ni,Jn as ss,Jt as Et,K as ri,Kn as li,Kt as oi,L as Cs,Ln as Ss,Lr as ci,Lt as di,M as e0,Mn as mi,Mr as ui,Mt as fi,N as xi,Nn as Ps,Nr as ft,Nt as hi,O as pi,On as wt,Or as $s,Ot as gi,P as As,Pn as bi,Pr as je,Pt as vi,Q as ji,Qn as tt,Qt as wi,R as yi,Rn as zi,Rt as Ms,Sn as Fs,St as Ni,Tn as Rs,Tt as ki,U as Es,Un as Is,Ut as It,V as Ls,Vn as _i,Vt as Ci,W as Si,Wn as Ts,Wt as Pi,X as $i,Xn as Ai,Xt as Ds,Y as Mi,Yn as _t,Yt as Os,Z as Fi,Zn as Lt,Zt as qs,_n as Ri,_t as Ei,an as Ii,ar as Ct,at as Li,b as Ti,bn as Di,bt as Oi,cn as qi,ct as Wi,d as Ui,dn as Ws,dt as Bi,en as Vi,er as At,et as Qi,fn as Ji,ft as Hi,gn as yt,gt as Ki,hn as Yi,ht as Xi,in as Zi,ir as Gi,it as Ye,j as Us,jn as zt,jr as ke,jt as en,k as tn,kn as Nt,kr as as,kt as sn,l as an,ln as St,lt as nn,mn as Bs,mt as rn,n as xt,nn as ln,nr as Vs,nt as on,o as Qs,on as Mt,or as cn,ot as dn,pn as mn,pt as un,q as fn,qn as xn,qt as hn,rn as Bt,rr as Re,rt as pn,s as gn,sn as We,st as bn,t as vn,tn as Js,tr as Q,tt as jn,u as wn,un as yn,ut as zn,vn as Pt,vt as Nn,wn as Tt,wt as kn,x as _n,xn as oe,xt as Cn,y as is,yn as Sn,yt as Pn,z as $n,zn as Hs,zt as $e}from"./framework-DlYyAB7S.js";import{t as An}from"./query-nHmdVBDN.js";import{t as Mn}from"./database-BXMLJMrA.js";import{a as Fn,c as Rn,i as En,n as In,o as Ln,r as Tn,s as Dn,t as On}from"./vendor-CfnNWqW-.js";/* empty css                 */(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function a(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=a(n);fetch(n.href,r)}})();var qn=ai(),b=js(ci(),1),Wn="https://dbkcedktqhueqnulnosq.supabase.co",Un="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRia2NlZGt0cWh1ZXFudWxub3NxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg5NzE1NTQsImV4cCI6MjA4NDU0NzU1NH0.m_Tv-H7o5mL1Nac6TH-S1JkS1x7ZN1AK_4Mt1hZlkvU";const D=Mn(Wn,Un);var Bn=Q();function re(...t){return Dn(Rn(t))}const Vn=()=>{const t=(0,Bn.c)(2),{pathname:e}=ft();let a;return t[0]!==e?(a=[e],t[0]=e,t[1]=a):a=t[1],(0,b.useEffect)(Hn,a),null},Pe=t=>typeof t!="string"?!1:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t),Qn=(t,e)=>{const a=document.createElement("canvas"),i=t.naturalWidth/t.width,n=t.naturalHeight/t.height;a.width=e.width*i,a.height=e.height*n;const r=a.getContext("2d");return r.imageSmoothingEnabled=!0,r.imageSmoothingQuality="high",r.drawImage(t,e.x*i,e.y*n,e.width*i,e.height*n,0,0,e.width*i,e.height*n),new Promise((l,o)=>{a.toBlob(c=>{if(!c){o(new Error("Canvas is empty"));return}l(c)},"image/jpeg",.95)})},nt=t=>{if(!t)return"";const e=new Date-new Date(t),a=Math.floor(e/1e3),i=Math.floor(a/60),n=Math.floor(i/60),r=Math.floor(n/24);return a<60?"Just now":i<60?`${i}m ago`:n<24?`${n}h ago`:r<7?`${r}d ago`:new Date(t).toLocaleDateString(void 0,{day:"2-digit",month:"2-digit",year:"2-digit"})},Jn=t=>typeof t!="string"?!1:/[\u0980-\u09FF]/.test(t),vt=t=>{if(!t)return null;const e=t.match(/(https?:\/\/[^\s]+)/g);return e?e[0]:null};function Hn(){window.scrollTo(0,0)}const Qe=t=>t?{id:t.id,handle:t.username,name:t.display_name,avatar:t.avatar_url||"/default-avatar.webp",cover:t.cover_url||"/welcome-banner.webp",verified:t.is_verified,bio:t.bio,location:t.location,website:t.website,follower_count:t.follower_count||0,following_count:t.following_count||0,lastSeen:t.last_seen_at}:null,Je=t=>{if(!t)return null;const e=t.reposter_id||t.reposter_data?.id||t.reposted_by?.id,a=Math.random().toString(36).substring(2,9),i=`${t.feed_id||(e?`${t.id}-${e}`:`${t.id}-orig`)}-${a}`;return{...t,feed_id:i,stats:{comments:t.comments_count||0,likes:t.likes_count||0,mirrors:t.mirrors_count||0},user:Qe(t.author_data||t.user),community:t.community_data||t.communities?{...t.community_data||t.communities,avatar:(t.community_data||t.communities).avatar_url||(t.community_data||t.communities).avatar}:null,repostedBy:t.reposter_data?{handle:t.reposter_data.username,name:t.reposter_data.display_name,id:t.reposter_data.id}:t.reposted_by?{handle:t.reposted_by.username,name:t.reposted_by.display_name,id:t.reposted_by.id}:null,timeAgo:nt(t.created_at)}},Ks=t=>t?{...t,stats:{likes:t.likes_count||0},user:Qe(t.user),timeAgo:nt(t.created_at)}:null,Kn=t=>t?{...t,user:t.actor?.username,avatar:t.actor?.avatar_url||"/default-avatar.webp"}:null,Ys=t=>t?{...t,media:t.media_url,user:Qe(t.user)}:null,ht=t=>t?{id:t.id,handle:t.handle,name:t.name,description:t.description,avatar:t.avatar_url||"/default-avatar.webp",cover:t.cover_url||"/welcome-banner.webp",membersCount:t.members_count||0,postsCount:t.posts_count||0,isPrivate:t.is_private,createdAt:t.created_at,type:"community",creatorId:t.creator_id}:null,Yn=t=>t?{id:t.id,conversation_id:t.conversation_id,sender_id:t.sender_id,content:t.content,type:t.type||"text",media:t.media||[],reply_to_id:t.reply_to_id,is_read:t.is_read,created_at:t.created_at}:null,Xn=(t,e)=>{if(!t||!t.conversation)return null;const a=t.conversation,i=a.participants.find(r=>r.user?.id!==e)||a.participants[0],n=a.messages?.filter(r=>!r.is_read&&r.sender_id!==e).length||0;return{id:a.id,user:Qe(i?.user),lastMessage:a.last_message_content||"No messages yet",lastMessageAt:a.last_message_at,time:a.last_message_at?new Date(a.last_message_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",unread:n}},Zn=async(t,e=10)=>{const{data:a,error:i}=await D.from("users").select("*").or(`username.ilike.%${t}%,display_name.ilike.%${t}%`).limit(e);if(i)throw i;return a.map(Qe)},Xs=async(t,e="id")=>{let a=D.from("users").select("*");e==="id"?a=a.eq("id",t):a=a.ilike("username",t);const{data:i,error:n}=await a.maybeSingle();if(n)throw n;return i?Qe(i):null},Gn=t=>Xs(t,"username"),Ze=async t=>{if(!t)return;const{error:e}=await D.from("users").update({last_seen_at:new Date().toISOString()}).eq("id",t);if(e)throw e},er=async(t,e)=>{const a={display_name:e.name,username:e.handle,avatar_url:e.avatar,bio:e.bio,cover_url:e.cover,website:e.website,location:e.location};Object.keys(a).forEach(n=>a[n]===void 0&&delete a[n]);const{error:i}=await D.from("users").update(a).eq("id",t);if(i)throw i},Zs=async(t,e)=>{const{data:a}=await D.from("follows").select("*").eq("follower_id",t).eq("following_id",e).maybeSingle();return a?(await D.from("follows").delete().eq("follower_id",t).eq("following_id",e),!1):(await D.from("follows").insert([{follower_id:t,following_id:e}]),!0)},Gs=async(t,e)=>{if(!t)return!1;const{data:a}=await D.from("follows").select("*").eq("follower_id",t).eq("following_id",e).maybeSingle();return!!a},tr=async(t,e=null,a=10)=>{let i=D.from("follows").select(`
      created_at,
      user:users!follower_id (
        id,
        username,
        display_name,
        avatar_url,
        is_verified,
        bio
      )
    `).eq("following_id",t).order("created_at",{ascending:!1}).limit(a);e&&(i=i.lt("created_at",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(l=>({...Qe(l.user),followed_at:l.created_at}))},sr=async(t,e=null,a=10)=>{let i=D.from("follows").select(`
      created_at,
      user:users!following_id (
        id,
        username,
        display_name,
        avatar_url,
        is_verified,
        bio
      )
    `).eq("follower_id",t).order("created_at",{ascending:!1}).limit(a);e&&(i=i.lt("created_at",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(l=>({...Qe(l.user),followed_at:l.created_at}))},ar=async t=>{const{data:e,error:a}=await D.from("users").select("follower_count, following_count").eq("id",t).maybeSingle();return a||!e?{followers:0,following:0}:{followers:e.follower_count||0,following:e.following_count||0}},ir=async(t=null,e=10)=>{let a=D.from("unified_posts").select("*").order("sort_timestamp",{ascending:!1}).limit(e);t&&(a=a.lt("sort_timestamp",t));const{data:i,error:n}=await a;if(n)throw n;return i.map(Je)},nr=async t=>{const{data:e,error:a}=await D.from("posts").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified,
                bio,
                location,
                website,
                follower_count,
                following_count
            ),
            communities (
                id,
                handle,
                name,
                avatar_url
            ),
            quoted_post:posts!quoted_post_id (
                *,
                user:users!user_id (
                    id,
                    username,
                    display_name,
                    avatar_url,
                    is_verified
                )
            )
        `).eq("id",t).single();if(a)throw a;return Je(e)},rr=async(t,e=null,a=10)=>{let i=D.from("unified_posts").select("*").or(`user_id.eq.${t},reposter_id.eq.${t}`).order("sort_timestamp",{ascending:!1}).limit(a);e&&(i=i.lt("sort_timestamp",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(Je)},lr=async({content:t,media:e=[],type:a="text",userId:i,poll:n=null,parentId:r=null,communityId:l=null})=>{const{data:o,error:c}=await D.from("posts").insert([{user_id:i,content:t,media:e,type:a,poll:n,parent_id:r,community_id:l}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            ),
            communities:community_id (
                id,
                handle,
                name,
                avatar_url
            )
        `);if(c)throw c;return Je(o[0])},or=async t=>{const{error:e}=await D.from("posts").delete().eq("id",t);if(e)throw e},cr=async(t,e)=>{const{error:a}=await D.from("posts").update(e).eq("id",t);if(a)throw a},ea=async(t,e=null,a=10)=>{let i=D.from("comments").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `).eq("post_id",t).order("created_at",{ascending:!0}).limit(a);e&&(i=i.gt("created_at",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(Ks)},ta=async(t,e,a,i=[])=>{const{data:n,error:r}=await D.from("comments").insert([{post_id:t,user_id:e,content:a,media:i}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `);if(r)throw r;return Ks(n[0])},Dt=async(t,e)=>{const{data:a}=await D.from("likes").select("*").eq("post_id",t).eq("user_id",e).maybeSingle();return a?(await D.from("likes").delete().eq("post_id",t).eq("user_id",e),!1):(await D.from("likes").insert([{post_id:t,user_id:e}]),!0)},sa=async(t,e)=>{if(!e)return!1;const{data:a}=await D.from("likes").select("*").eq("post_id",t).eq("user_id",e).maybeSingle();return!!a},dr=async(t,e)=>{const{data:a}=await D.from("reposts").select("*").eq("post_id",t).eq("user_id",e).maybeSingle();return a?(await D.from("reposts").delete().eq("post_id",t).eq("user_id",e),!1):(await D.from("reposts").insert([{post_id:t,user_id:e}]),!0)},mr=async(t,e)=>{if(!e)return!1;const{data:a}=await D.from("reposts").select("*").eq("post_id",t).eq("user_id",e).maybeSingle();return!!a},Ot=async(t,e=null,a=10,i=!1)=>{let n=D.from("unified_posts").select("*").ilike("content",`%${t}%`);i&&(n=n.not("community_id","is",null).is("reposter_id",null)),n=n.order("sort_timestamp",{ascending:!1}).limit(a),e&&(n=n.lt("sort_timestamp",e));const{data:r,error:l}=await n;if(l)throw l;return r.map(Je)},ur=async(t=null,e=10)=>{let a=D.from("unified_posts").select("*").not("community_id","is",null).is("reposter_id",null).order("sort_timestamp",{ascending:!1}).limit(e);t&&(a=a.lt("sort_timestamp",t));const{data:i,error:n}=await a;if(n)throw n;return i.map(Je)},fr=async(t=null,e=10)=>{let a=D.from("unified_posts").select("*").eq("type","video").order("sort_timestamp",{ascending:!1}).limit(e);t&&(a=a.lt("sort_timestamp",t));const{data:i,error:n}=await a;if(n)throw n;return i.map(Je)},aa=async(t,e)=>{const{data:a}=await D.from("conversation_participants").select("conversation_id").eq("user_id",t),i=a.map(o=>o.conversation_id),{data:n}=await D.from("conversation_participants").select("conversation_id").eq("user_id",e).in("conversation_id",i).maybeSingle();if(n)return n.conversation_id;const{data:r,error:l}=await D.from("conversations").insert([{}]).select().single();if(l)throw l;return await D.from("conversation_participants").insert([{conversation_id:r.id,user_id:t},{conversation_id:r.id,user_id:e}]),r.id},xr=async t=>{if(!t)return 0;const{data:e}=await D.from("conversation_participants").select("conversation_id").eq("user_id",t),a=e?.map(r=>r.conversation_id)||[];if(a.length===0)return 0;const{count:i,error:n}=await D.from("messages").select("*",{count:"exact",head:!0}).eq("is_read",!1).neq("sender_id",t).in("conversation_id",a);if(n)throw n;return i||0},hr=async(t,e)=>{if(!t||!e)return;const{error:a}=await D.from("messages").update({is_read:!0}).eq("conversation_id",t).neq("sender_id",e).eq("is_read",!1);if(a)throw a},pr=async t=>{if(!t)return[];const{data:e,error:a}=await D.from("conversation_participants").select(`
            conversation:conversations (
                id,
                last_message_at,
                last_message_content,
                participants:conversation_participants (
                    user:users (
                        id,
                        username,
                        display_name,
                        avatar_url,
                        last_seen_at
                    )
                ),
                messages (
                    id,
                    is_read,
                    sender_id
                )
            )
        `).eq("user_id",t);if(a)throw a;return e.map(i=>Xn(i,t)).sort((i,n)=>i.lastMessageAt?n.lastMessageAt?new Date(n.lastMessageAt)-new Date(i.lastMessageAt):-1:1)},gr=async t=>{const{data:e,error:a}=await D.from("messages").select("*").eq("conversation_id",t).order("created_at",{ascending:!0});if(a)throw a;return e.map(Yn)},br=async()=>{const{data:t,error:e}=await D.from("message_reactions").select("*");if(e)throw e;return t||[]},vr=async(t,e,a)=>{const{data:i}=await D.from("message_reactions").select("*").eq("message_id",t).eq("user_id",e).maybeSingle();return i?i.emoji===a?(await D.from("message_reactions").delete().eq("id",i.id),{action:"removed",emoji:a}):(await D.from("message_reactions").update({emoji:a}).eq("id",i.id),{action:"updated",emoji:a}):(await D.from("message_reactions").insert([{message_id:t,user_id:e,emoji:a}]),{action:"added",emoji:a})},jr=async(t,e,a,i="text",n=[],r=null)=>{const{data:l,error:o}=await D.from("messages").insert([{conversation_id:t,sender_id:e,content:a,type:i,media:n,reply_to_id:r}]).select();if(o)throw o;return await D.from("conversations").update({last_message_at:new Date,last_message_content:i==="image"||n&&n.length>0?"Sent an image":a}).eq("id",t),l[0]},wr=async t=>{const{error:e}=await D.from("messages").delete().eq("id",t);if(e)throw e},yr=async(t,e=null,a=10)=>{if(!t)return[];let i=D.from("notifications").select(`
            *,
            actor:users!actor_id (
                username,
                avatar_url
            )
        `).eq("recipient_id",t).order("created_at",{ascending:!1}).limit(a);e&&(i=i.lt("created_at",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(Kn)},zr=async t=>{const{error:e}=await D.from("notifications").update({is_read:!0}).eq("recipient_id",t).eq("is_read",!1);if(e)throw e},Nr=async t=>{if(!t)return 0;const{count:e,error:a}=await D.from("notifications").select("*",{count:"exact",head:!0}).eq("recipient_id",t).eq("is_read",!1);if(a)throw a;return e||0},kr=async()=>{const{data:t,error:e}=await D.from("stories").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `).gt("expires_at",new Date().toISOString()).order("created_at",{ascending:!1});if(e)throw e;return t.map(Ys)},_r=async(t,e,a="image")=>{const{data:i,error:n}=await D.from("stories").insert([{user_id:t,media_url:e,type:a}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `);if(n)throw n;return Ys(i[0])},Cr=async(t=null,e=10)=>{let a=D.from("communities").select("*").order("created_at",{ascending:!1}).limit(e);t&&(a=a.lt("created_at",t));const{data:i,error:n}=await a;if(n)throw n;return i.map(ht)},Sr=async t=>{const{data:e,error:a}=await D.from("communities").select("*").eq("handle",t).single();if(a)throw a;return ht(e)},Pr=async(t,e=null,a=10)=>{let i=D.from("unified_posts").select("*").eq("community_id",t).is("reposter_id",null).order("sort_timestamp",{ascending:!1}).limit(a);e&&(i=i.lt("sort_timestamp",e));const{data:n,error:r}=await i;if(r)throw r;return n.map(Je)},ia=async(t,e)=>{const{data:a}=await D.from("community_members").select("*").eq("community_id",t).eq("user_id",e).maybeSingle();if(a){const{error:i}=await D.from("community_members").delete().eq("community_id",t).eq("user_id",e);if(i)throw i;return!1}else{const{error:i}=await D.from("community_members").insert([{community_id:t,user_id:e}]);if(i)throw i;return!0}},na=async(t,e)=>{if(!e)return null;const{data:a}=await D.from("community_members").select("*").eq("community_id",t).eq("user_id",e).maybeSingle();return a},$r=async t=>{if(!t)return[];const{data:e,error:a}=await D.from("community_members").select(`
      role,
      communities (*)
    `).eq("user_id",t);if(a)throw a;return e.map(i=>({...ht(i.communities),myRole:i.role}))},Ar=async t=>{const{data:e,error:a}=await D.from("communities").insert([t]).select().single();if(a)throw a;return ht(e)},Mr=async(t,e)=>{const{data:a,error:i}=await D.from("communities").update(e).eq("id",t).select().single();if(i)throw i;return ht(a)},Fr=async(t,e="")=>{let a=D.from("community_members").select(`
      role,
      user_id,
      users:user_id!inner (
        id,
        username,
        display_name,
        avatar_url,
        is_verified
      )
    `).eq("community_id",t);e&&(a=a.or(`username.ilike.%${e}%,display_name.ilike.%${e}%`,{foreignTable:"users"}));const{data:i,error:n}=await a.limit(20);if(n)throw n;return i.map(r=>({role:r.role,userId:r.user_id,user:r.users}))},Rr=async(t,e,a)=>{const{data:i,error:n}=await D.from("community_members").update({role:a}).eq("community_id",t).eq("user_id",e).select().single();if(n)throw n;return i},Er=async(t=5)=>{const{data:e,error:a}=await D.from("hashtags").select("*").order("usage_count",{ascending:!1}).limit(t);if(a)throw a;return e},Ir=async t=>{try{const e=`https://api.allorigins.win/raw?url=${encodeURIComponent(t)}`,a=await fetch(e);if(!a.ok)throw new Error("Failed to fetch preview");const i=await a.text(),n=new DOMParser().parseFromString(i,"text/html"),r=l=>n.querySelector(`meta[property="${l}"]`)?.getAttribute("content")||n.querySelector(`meta[name="${l}"]`)?.getAttribute("content");return{title:r("og:title")||n.title||t,description:r("og:description")||r("description")||"",image:r("og:image")||r("twitter:image")||"",siteName:r("og:site_name")||new URL(t).hostname,url:t}}catch(e){return console.error("Link preview error:",e),null}},Lr=async t=>{if(!t)return null;try{const{data:e}=await D.from("link_previews").select("*").eq("url",t).maybeSingle();if(e)return D.from("link_previews").update({last_used_at:new Date().toISOString()}).eq("url",t).then(()=>{}),{title:e.title,description:e.description,image:e.image,siteName:e.site_name,url:e.url};const a=await Ir(t);return a?(D.from("link_previews").insert([{url:a.url,title:a.title,description:a.description,image:a.image,site_name:a.siteName}]).then(({error:i})=>{i&&console.error("Cache save error:",i)}),a):null}catch(e){return console.error("Link preview cache error:",e),null}},Tr=async(t,e={})=>{if(!t.type.startsWith("image/"))return t;const a={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0,initialQuality:.8,fileType:"image/webp",...e};try{const i=await Ln(t,a);return console.log(`Original size: ${(t.size/1024/1024).toFixed(2)} MB`),console.log(`Compressed size: ${(i.size/1024/1024).toFixed(2)} MB`),i}catch(i){return console.error("Image compression failed:",i),t}},Dr=(t,e=1)=>new Promise((a,i)=>{const n=document.createElement("video");n.preload="metadata",n.src=URL.createObjectURL(t),n.muted=!0,n.playsInline=!0,n.onloadedmetadata=()=>{n.currentTime=e},n.onseeked=()=>{const r=document.createElement("canvas");r.width=n.videoWidth,r.height=n.videoHeight,r.getContext("2d").drawImage(n,0,0,r.width,r.height),r.toBlob(l=>{const o=new File([l],"thumbnail.webp",{type:"image/webp"});URL.revokeObjectURL(n.src),a(o)},"image/webp",.7)},n.onerror=r=>i(r)}),Ae=async(t,e="media",a=null)=>{let i=t,n=t.name.split(".").pop(),r=null;if(t.type.startsWith("image/")&&(i=await Tr(t),n="webp"),t.type.startsWith("video/"))try{a?r=(await Ae(a,e)).url:r=(await Ae(await Dr(t),e)).url}catch(u){console.error("Failed to handle video poster:",u)}const l=`${`${crypto.randomUUID()}.${n}`}`,{data:o,error:c}=await D.storage.from(e).upload(l,i);if(c)throw c;const{data:{publicUrl:f}}=D.storage.from(e).getPublicUrl(o.path);return{url:f,poster:r,name:t.name,type:t.type.startsWith("image/")?"image":t.type.startsWith("video/")?"video":"file",size:i.size}};var s=js(cn(),1),ra=(0,b.createContext)();const Or=({children:t})=>{const[e,a]=(0,b.useState)(null),[i,n]=(0,b.useState)(null),[r,l]=(0,b.useState)({}),[o,c]=(0,b.useState)(!0),f=async p=>{try{const g=await Xs(p.id);g?(a(g),l(v=>({...v,[g.handle.toLowerCase()]:g}))):a({id:p.id,email:p.email,name:p.email.split("@")[0],handle:p.email.split("@")[0],avatar:"/default-avatar.webp",verified:!1})}catch(g){console.error("Error fetching user profile:",g)}finally{c(!1)}};(0,b.useEffect)(()=>{if(!e?.id)return;Ze(e.id);const p=setInterval(()=>Ze(e.id),3e4),g=()=>{document.visibilityState==="visible"&&Ze(e.id)};return window.addEventListener("visibilitychange",g),window.addEventListener("beforeunload",()=>Ze(e.id)),()=>{clearInterval(p),window.removeEventListener("visibilitychange",g),window.removeEventListener("beforeunload",()=>Ze(e.id))}},[e?.id]),(0,b.useEffect)(()=>{D.auth.getSession().then(({data:{session:g}})=>{g?f(g.user):c(!1)});const{data:{subscription:p}}=D.auth.onAuthStateChange((g,v)=>{v?f(v.user):(a(null),c(!1))});return()=>p.unsubscribe()},[]);const u=async({email:p,password:g})=>{const{data:v,error:j}=await D.auth.signInWithPassword({email:p,password:g});if(j)throw j;return n(null),v},m=async({email:p,password:g,username:v,name:j})=>{const{data:{user:w},error:y}=await D.auth.signUp({email:p,password:g,options:{data:{username:v.toLowerCase(),name:j}}});if(y)throw y;return n(null),w},x=async()=>{await D.auth.signOut(),a(null),n(null)},h=async p=>{e&&(await er(e.id,p),await f(e))},d=async p=>{const g=p.toLowerCase();if(r[g])return r[g];const v=await Gn(p);return v?(l(j=>({...j,[g]:v})),v):null};return(0,s.jsx)(ra.Provider,{value:{currentUser:e,authMode:i,setAuthMode:n,profiles:r,login:u,signup:m,logout:x,updateProfile:h,getProfileByHandle:d,loading:o},children:!o&&t})},he=()=>{const t=(0,b.useContext)(ra);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t};var qr=Q(),la=(0,b.createContext)();const Wr=t=>{const e=(0,qr.c)(10),{children:a}=t,{currentUser:i}=he();let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=new Set,e[0]=n):n=e[0];const[r,l]=(0,b.useState)(n);let o;e[1]!==i?(o=()=>{if(!i?.id)return;const x=D.channel("global_presence",{config:{presence:{key:i.id}}});return x.on("presence",{event:"sync"},()=>{const h=x.presenceState(),d=new Set;Object.keys(h).forEach(p=>d.add(p)),l(d)}).subscribe(async h=>{h==="SUBSCRIBED"&&(await x.track({userId:i.id,online_at:new Date().toISOString()}),Ze(i.id))}),()=>{i?.id&&Ze(i.id),D.removeChannel(x),l(new Set)}},e[1]=i,e[2]=o):o=e[2];const c=i?.id;let f;e[3]!==c?(f=[c],e[3]=c,e[4]=f):f=e[4],(0,b.useEffect)(o,f);let u;e[5]!==r?(u={onlineUsers:r},e[5]=r,e[6]=u):u=e[6];let m;return e[7]!==a||e[8]!==u?(m=(0,s.jsx)(la.Provider,{value:u,children:a}),e[7]=a,e[8]=u,e[9]=m):m=e[9],m},oa=()=>{const t=(0,b.useContext)(la);if(!t)throw new Error("usePresence must be used within a PresenceProvider");return t};var Ur=Q(),ca=(0,b.createContext)();const Br=t=>{const e=(0,Ur.c)(19),{children:a}=t,[i,n]=(0,b.useState)(Vr),[r,l]=(0,b.useState)(Qr),[o,c]=(0,b.useState)(Jr);let f,u;e[0]!==i?(f=()=>{localStorage.setItem("theme",i?"dark":"light"),i?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},u=[i],e[0]=i,e[1]=f,e[2]=u):(f=e[1],u=e[2]),(0,b.useEffect)(f,u);let m,x;e[3]!==r?(m=()=>{localStorage.setItem("font-size",r),document.documentElement.style.setProperty("--app-font-size",{small:"14px",base:"16px",large:"18px"}[r])},x=[r],e[3]=r,e[4]=m,e[5]=x):(m=e[4],x=e[5]),(0,b.useEffect)(m,x);let h,d;e[6]!==o?(h=()=>{localStorage.setItem("data-saver",o)},d=[o],e[6]=o,e[7]=h,e[8]=d):(h=e[7],d=e[8]),(0,b.useEffect)(h,d);let p;e[9]!==i?(p=()=>n(!i),e[9]=i,e[10]=p):p=e[10];const g=p;let v;e[11]!==i||e[12]!==o||e[13]!==r||e[14]!==g?(v={darkMode:i,setDarkMode:n,toggleDarkMode:g,fontSize:r,setFontSize:l,dataSaver:o,setDataSaver:c},e[11]=i,e[12]=o,e[13]=r,e[14]=g,e[15]=v):v=e[15];let j;return e[16]!==a||e[17]!==v?(j=(0,s.jsx)(ca.Provider,{value:v,children:a}),e[16]=a,e[17]=v,e[18]=j):j=e[18],j},pt=()=>{const t=(0,b.useContext)(ca);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t};function Vr(){const t=localStorage.getItem("theme");return t==="dark"||!t&&window.matchMedia("(prefers-color-scheme: dark)").matches}function Qr(){return localStorage.getItem("font-size")||"base"}function Jr(){return localStorage.getItem("data-saver")==="true"}var Hr=Q(),Kr=t=>{const e=(0,Hr.c)(7);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];const{theme:i}=Ga(),n=i===void 0?"system":i;let r,l;e[2]===Symbol.for("react.memo_cache_sentinel")?(r={success:(0,s.jsx)(Hs,{className:"size-4"}),info:(0,s.jsx)(Tt,{className:"size-4"}),warning:(0,s.jsx)(hn,{className:"size-4"}),error:(0,s.jsx)(Ji,{className:"size-4"}),loading:(0,s.jsx)(oe,{className:"size-4 animate-spin"})},l={"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)","--border-radius":"var(--radius)"},e[2]=r,e[3]=l):(r=e[2],l=e[3]);let o;return e[4]!==a||e[5]!==n?(o=(0,s.jsx)(Oa,{theme:n,className:"toaster group",icons:r,style:l,...a}),e[4]=a,e[5]=n,e[6]=o):o=e[6],o},Yr=Q(),da=(0,b.createContext)();const Xr=t=>{const e=(0,Yr.c)(4),{children:a}=t,i=Zr;let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n={addToast:i},e[0]=n):n=e[0];let r;e[1]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsx)(Kr,{position:"bottom-center",toastOptions:{className:"rounded-full font-bold"}}),e[1]=r):r=e[1];let l;return e[2]!==a?(l=(0,s.jsxs)(da.Provider,{value:n,children:[a,r]}),e[2]=a,e[3]=l):l=e[3],l},ze=()=>{const t=(0,b.useContext)(da);if(!t)throw new Error("useToast must be used within a ToastProvider");return t};function Zr(t,e){const a=e===void 0?"success":e;a==="error"?At.error(t):a==="info"?At.info(t):At.success(t)}var ma=(0,b.createContext)();const Gr=({children:t})=>{const[e,a]=(0,b.useState)([]),[i,n]=(0,b.useState)(!0),[r,l]=(0,b.useState)(!0),[o,c]=(0,b.useState)(!1),f=(0,b.useRef)(e);(0,b.useEffect)(()=>{f.current=e},[e]);const u=(0,b.useCallback)(async(v=!1)=>{v?c(!0):n(!0);try{const j=f.current,w=await ir(v&&j.length>0?j[j.length-1].created_at:null,10);w.length<10?l(!1):l(!0),a(v?y=>[...y,...w]:w)}catch(j){console.error("Failed to load posts:",j)}finally{n(!1),c(!1)}},[]),m=()=>{!r||o||u(!0)};(0,b.useEffect)(()=>{u()},[u]);const x=async v=>{const j=await lr(v);return u(),j},h=async v=>{await or(v),a(j=>j.filter(w=>w.id!==v))},d=async(v,j)=>{await cr(v,j),a(w=>w.map(y=>y.id===v?{...y,...j}:y))},p=v=>e.find(j=>j.id===v),g=(v,j="feed")=>{let w=e.filter(y=>!!(y.user?.handle===v||y.repostedBy&&y.repostedBy.handle===v));return j==="feed"?w.filter(y=>y.parent_id===null):j==="media"?w.filter(y=>y.parent_id===null&&(y.type==="video"||y.type==="image"||y.media?.length>0)):w};return(0,s.jsx)(ma.Provider,{value:{posts:e,setPosts:a,addPost:x,deletePost:h,updatePost:d,getPostById:p,getUserPosts:g,loading:i,hasMore:r,isFetchingNextPage:o,fetchNextPage:m,refreshPosts:()=>u(!1)},children:t})},Vt=()=>{const t=(0,b.useContext)(ma);if(!t)throw new Error("usePosts must be used within a PostProvider");return t};var el=Q(),ua=(0,b.createContext)();const tl=t=>{const e=(0,el.c)(9),{children:a}=t;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i={isOpen:!1,images:[],currentIndex:0},e[0]=i):i=e[0];const[n,r]=(0,b.useState)(i);let l;e[1]===Symbol.for("react.memo_cache_sentinel")?(l=(d,p)=>{const g=p===void 0?0:p;r({isOpen:!0,images:Array.isArray(d)?d:[d],currentIndex:g})},e[1]=l):l=e[1];const o=l;let c;e[2]===Symbol.for("react.memo_cache_sentinel")?(c=()=>{r(sl)},e[2]=c):c=e[2];const f=c;let u;e[3]===Symbol.for("react.memo_cache_sentinel")?(u=d=>{r(p=>({...p,currentIndex:d}))},e[3]=u):u=e[3];const m=u;let x;e[4]!==n?(x={...n,openLightbox:o,closeLightbox:f,setIndex:m},e[4]=n,e[5]=x):x=e[5];let h;return e[6]!==a||e[7]!==x?(h=(0,s.jsx)(ua.Provider,{value:x,children:a}),e[6]=a,e[7]=x,e[8]=h):h=e[8],h},Qt=()=>{const t=(0,b.useContext)(ua);if(!t)throw new Error("useLightbox must be used within a LightboxProvider");return t};function sl(t){return{...t,isOpen:!1}}var al=Q(),fa=(0,b.createContext)();const il=t=>{const e=(0,al.c)(15),{children:a}=t,[i,n]=(0,b.useState)(null);let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=new Map,e[0]=r):r=e[0];const l=(0,b.useRef)(r);let o;e[1]!==i?(o=(p,g,v)=>{g===0?l.current.has(p)&&l.current.delete(p):l.current.set(p,{ratio:g,...v});let j=null,w=.5;for(const[y,N]of l.current.entries())N.ratio>w&&(w=N.ratio,j=y);j!==i&&n(j)},e[1]=i,e[2]=o):o=e[2];const c=o;let f,u;e[3]!==i?(f=()=>{l.current.forEach((p,g)=>{g===i?p.play():p.pause()})},u=[i],e[3]=i,e[4]=f,e[5]=u):(f=e[4],u=e[5]),(0,b.useEffect)(f,u);let m;e[6]!==i?(m=p=>{l.current.delete(p),i===p&&n(null)},e[6]=i,e[7]=m):m=e[7];const x=m;let h;e[8]!==i||e[9]!==c||e[10]!==x?(h={reportVisibility:c,unregister:x,activeVideoId:i},e[8]=i,e[9]=c,e[10]=x,e[11]=h):h=e[11];let d;return e[12]!==a||e[13]!==h?(d=(0,s.jsx)(fa.Provider,{value:h,children:a}),e[12]=a,e[13]=h,e[14]=d):d=e[14],d},nl=()=>{const t=(0,b.useContext)(fa);if(!t)throw new Error("useVideoPlayback must be used within a VideoPlaybackProvider");return t};var rl=Q();const xa=t=>{const e=(0,rl.c)(16),a=Ct(),i=t?.id;let n;e[0]!==i?(n=["unread_notifications_count",i],e[0]=i,e[1]=n):n=e[1];let r;e[2]!==t?.id?(r=()=>Nr(t?.id),e[2]=t?.id,e[3]=r):r=e[3];const l=!!t?.id;let o;e[4]!==n||e[5]!==r||e[6]!==l?(o={queryKey:n,queryFn:r,enabled:l},e[4]=n,e[5]=r,e[6]=l,e[7]=o):o=e[7];const{data:c}=Re(o),f=c===void 0?0:c;let u;e[8]!==t||e[9]!==a?(u=()=>{if(!t?.id)return;const d=D.channel(`unread_count:${t.id}`).on("postgres_changes",{event:"*",schema:"public",table:"notifications",filter:`recipient_id=eq.${t.id}`},()=>{a.invalidateQueries({queryKey:["unread_notifications_count",t.id]}),a.invalidateQueries({queryKey:["notifications",t.id]})}).subscribe();return()=>D.removeChannel(d)},e[8]=t,e[9]=a,e[10]=u):u=e[10];const m=t?.id;let x;e[11]!==a||e[12]!==m?(x=[m,a],e[11]=a,e[12]=m,e[13]=x):x=e[13],(0,b.useEffect)(u,x);let h;return e[14]!==f?(h={unreadCount:f},e[14]=f,e[15]=h):h=e[15],h};var ll=Q();const Jt=t=>{const e=(0,ll.c)(65),a=Ct();let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i={},e[0]=i):i=e[0];const[n,r]=(0,b.useState)(i),l=(0,b.useRef)(null),o=t?.id;let c;e[1]!==o?(c=["conversations",o],e[1]=o,e[2]=c):c=e[2];let f;e[3]!==t?.id?(f=()=>pr(t?.id),e[3]=t?.id,e[4]=f):f=e[4];const u=!!t?.id;let m;e[5]!==c||e[6]!==f||e[7]!==u?(m={queryKey:c,queryFn:f,enabled:u},e[5]=c,e[6]=f,e[7]=u,e[8]=m):m=e[8];const{data:x,isLoading:h}=Re(m);let d;e[9]!==x?(d=x===void 0?[]:x,e[9]=x,e[10]=d):d=e[10];const p=d,g=t?.id;let v;e[11]!==g?(v=["unread_messages_count",g],e[11]=g,e[12]=v):v=e[12];let j;e[13]!==t?.id?(j=()=>xr(t?.id),e[13]=t?.id,e[14]=j):j=e[14];const w=!!t?.id;let y;e[15]!==j||e[16]!==w||e[17]!==v?(y={queryKey:v,queryFn:j,enabled:w},e[15]=j,e[16]=w,e[17]=v,e[18]=y):y=e[18];const{data:N}=Re(y),_=N===void 0?0:N;let P;e[19]===Symbol.for("react.memo_cache_sentinel")?(P=["reactions"],e[19]=P):P=e[19];const M=!!t?.id;let k;e[20]!==M?(k={queryKey:P,queryFn:br,enabled:M},e[20]=M,e[21]=k):k=e[21];const{data:A}=Re(k);let S;e[22]!==A?(S=A===void 0?[]:A,e[22]=A,e[23]=S):S=e[23];const I=S;let L;e[24]!==t||e[25]!==a?(L=()=>{if(!t?.id)return;const q=D.channel(`user_messages:${t.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},Y=>{const ae=Y.new;a.setQueryData(["messages",ae.conversation_id],Z=>Z?Z.find(ce=>ce.id===ae.id)?Z:[...Z,ae]:[ae]),ae.sender_id!==t.id&&a.invalidateQueries({queryKey:["unread_messages_count",t.id]}),a.invalidateQueries(["conversations",t.id]),r(Z=>({...Z,[ae.conversation_id]:!1}))}).on("postgres_changes",{event:"DELETE",schema:"public",table:"messages"},Y=>{a.invalidateQueries({queryKey:["messages"]}),a.invalidateQueries({queryKey:["conversations",t.id]})}).on("postgres_changes",{event:"*",schema:"public",table:"message_reactions"},()=>{a.invalidateQueries({queryKey:["reactions"]})}).subscribe(),V=D.channel("chat_typing_shared").on("broadcast",{event:"typing"},Y=>{const{payload:ae}=Y,{conversationId:Z,isTyping:ce,userId:me}=ae;me!==t.id&&r(pe=>({...pe,[Z]:ce}))}).subscribe();return l.current=V,()=>{D.removeChannel(q),D.removeChannel(V)}},e[24]=t,e[25]=a,e[26]=L):L=e[26];const $=t?.id;let R;e[27]!==a||e[28]!==$?(R=[$,a],e[27]=a,e[28]=$,e[29]=R):R=e[29],(0,b.useEffect)(L,R);let E;e[30]!==t?(E=q=>{const{convId:V,text:Y,type:ae,media:Z,replyToId:ce}=q,me=ae===void 0?"text":ae,pe=Z===void 0?[]:Z,de=ce===void 0?null:ce;return jr(V,t.id,Y,me,pe,de)},e[30]=t,e[31]=E):E=e[31];let O;e[32]!==t||e[33]!==a?(O=q=>{a.setQueryData(["messages",q.conversation_id],V=>V?V.find(Y=>Y.id===q.id)?V:[...V,q]:[q]),a.invalidateQueries(["conversations",t.id])},e[32]=t,e[33]=a,e[34]=O):O=e[34];let F;e[35]!==E||e[36]!==O?(F={mutationFn:E,onSuccess:O},e[35]=E,e[36]=O,e[37]=F):F=e[37];const z=Vs(F);let C;e[38]!==t?(C=(q,V)=>{l.current&&l.current.send({type:"broadcast",event:"typing",payload:{conversationId:q,isTyping:V,userId:t.id}})},e[38]=t,e[39]=C):C=e[39];const T=C;let B;e[40]!==t||e[41]!==a?(B=async q=>{!t?.id||!q||(await hr(q,t.id),a.invalidateQueries({queryKey:["unread_messages_count",t.id]}),a.invalidateQueries({queryKey:["conversations",t.id]}))},e[40]=t,e[41]=a,e[42]=B):B=e[42];const W=B;let J;e[43]!==t||e[44]!==a?(J=async(q,V)=>{if(t?.id)try{await vr(q,t.id,V),a.invalidateQueries({queryKey:["reactions"]})}catch(Y){console.error("Failed to toggle reaction:",Y)}},e[43]=t,e[44]=a,e[45]=J):J=e[45];const K=J;let G;e[46]!==a?(G=async q=>{try{await wr(q),a.invalidateQueries({queryKey:["messages"]})}catch(V){console.error("Failed to delete message:",V)}},e[46]=a,e[47]=G):G=e[47];const ne=G;let se;e[48]!==t?.id?(se=(q,V)=>{const Y=q===void 0?[]:q,ae=V===void 0?[]:V;return Y.map(Z=>({id:Z.id,sender:Z.sender_id===t?.id?"me":"them",text:Z.content,type:Z.type||"text",media:Z.media||[],isRead:Z.is_read,replyToId:Z.reply_to_id,reactions:ae.filter(ce=>ce.message_id===Z.id),time:new Date(Z.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}))},e[48]=t?.id,e[49]=se):se=e[49];const le=se;let X;e[50]!==z?(X=(q,V,Y,ae,Z)=>z.mutate({convId:q,text:V,type:Y,media:ae,replyToId:Z}),e[50]=z,e[51]=X):X=e[51];let ee;return e[52]!==I||e[53]!==p||e[54]!==le||e[55]!==h||e[56]!==W||e[57]!==ne||e[58]!==K||e[59]!==z.isPending||e[60]!==T||e[61]!==X||e[62]!==n||e[63]!==_?(ee={conversations:p,unreadCount:_,isConvLoading:h,sendMessage:X,sendTypingStatus:T,typingStatus:n,markAsRead:W,formatMessages:le,onToggleReaction:K,onDeleteMessage:ne,allReactions:I,isSending:z.isPending},e[52]=I,e[53]=p,e[54]=le,e[55]=h,e[56]=W,e[57]=ne,e[58]=K,e[59]=z.isPending,e[60]=T,e[61]=X,e[62]=n,e[63]=_,e[64]=ee):ee=e[64],ee};var Ht=Q();function ge(t){const e=(0,Ht.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=re("relative flex size-8 shrink-0 overflow-hidden rounded-full",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(vi,{"data-slot":"avatar",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function be(t){const e=(0,Ht.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=re("aspect-square size-full",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(hi,{"data-slot":"avatar-image",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function ve(t){const e=(0,Ht.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=re("bg-muted flex size-full items-center justify-center rounded-full",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(fi,{"data-slot":"avatar-fallback",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var ol=Q(),cl=t=>{const e=(0,ol.c)(23),{handleProfileClick:a}=t,{currentUser:i}=he(),{unreadCount:n}=xa(i),{unreadCount:r}=Jt(i),l=ft();let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=[{id:"home",icon:Ut,path:"/"},{id:"community",icon:et,path:"/community"},{id:"reels",icon:zt,path:"/reels"},{id:"messages",icon:Pt,path:"/messages"},{id:"notifications",icon:_t,path:"/notifications"}],e[0]=o):o=e[0];const c=o;let f;e[1]!==r||e[2]!==n?(f=c.map(w=>(0,s.jsx)($s,{to:w.path,className:ml,children:y=>{const{isActive:N}=y;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(w.icon,{size:26,strokeWidth:N?2.5:2}),w.id==="notifications"&&n>0&&(0,s.jsx)("span",{className:"absolute top-3 right-[30%] size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"}),w.id==="messages"&&r>0&&(0,s.jsx)("span",{className:"absolute top-3 right-[30%] size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"})]})}},w.id)),e[1]=r,e[2]=n,e[3]=f):f=e[3];let u;e[4]!==i||e[5]!==a?(u=()=>{i&&a(i.handle)},e[4]=i,e[5]=a,e[6]=u):u=e[6];const m=`size-7 border-2 ${l.pathname.startsWith("/u/")?"border-black dark:border-white":"border-transparent opacity-70"}`,x=i?.avatar||"/default-avatar.webp";let h;e[7]!==x?(h=(0,s.jsx)(be,{src:x,alt:"Profile",className:"object-cover"}),e[7]=x,e[8]=h):h=e[8];let d;e[9]!==i?.handle?.[0]?(d=i?.handle?.[0]?.toUpperCase(),e[9]=i?.handle?.[0],e[10]=d):d=e[10];let p;e[11]!==d?(p=(0,s.jsx)(ve,{children:d}),e[11]=d,e[12]=p):p=e[12];let g;e[13]!==m||e[14]!==h||e[15]!==p?(g=(0,s.jsxs)(ge,{className:m,children:[h,p]}),e[13]=m,e[14]=h,e[15]=p,e[16]=g):g=e[16];let v;e[17]!==u||e[18]!==g?(v=(0,s.jsx)("button",{onClick:u,className:"flex-1 flex flex-col items-center justify-center h-full",children:g}),e[17]=u,e[18]=g,e[19]=v):v=e[19];let j;return e[20]!==v||e[21]!==f?(j=(0,s.jsxs)("nav",{className:"fixed bottom-0 left-0 right-0 z-[40] flex h-16 items-center border-t border-zinc-100 bg-white/90 pb-safe backdrop-blur-md dark:border-zinc-800 dark:bg-black/90 md:hidden",children:[f,v]}),e[20]=v,e[21]=f,e[22]=j):j=e[22],j},dl=cl;function ml(t){const{isActive:e}=t;return`flex flex-1 flex-col items-center justify-center h-full transition-all duration-200 relative ${e?"text-black dark:text-white":"text-zinc-400 opacity-70"}`}var ul=Q(),fl=()=>{const t=(0,ul.c)(5);let e,a;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,s.jsx)("img",{src:"/welcome-banner.webp",alt:"Welcome Banner",fetchpriority:"high",loading:"eager",decoding:"async",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-700"}),a=(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"}),t[0]=e,t[1]=a):(e=t[0],a=t[1]);let i;t[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsx)("h1",{className:"text-3xl sm:text-4xl font-black mb-1 drop-shadow-lg",children:"Welcome to Sysm"}),t[2]=i):i=t[2];let n;t[3]===Symbol.for("react.memo_cache_sentinel")?(n=(0,s.jsxs)("div",{className:"absolute bottom-6 left-8 text-white",children:[i,(0,s.jsxs)("p",{className:"text-sm sm:text-base font-medium opacity-90 tracking-wide drop-shadow-md",children:["a social network built by"," ",(0,s.jsx)("a",{href:"https://t.me/systemadminbd",target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:"@Systemadminbd"})]})]}),t[3]=n):n=t[3];let r;return t[4]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsxs)("div",{className:"relative w-full aspect-[21/9] sm:aspect-[2.5/1] rounded-3xl overflow-hidden mb-6 group cursor-pointer",children:[e,a,n,(0,s.jsx)("div",{className:"absolute bottom-4 right-8",children:(0,s.jsx)("img",{src:"/logo.webp",className:"size-12 animate-pulse opacity-80 rounded-xl",alt:"",loading:"lazy",decoding:"async"})})]}),t[4]=r):r=t[4],r},xl=fl,hl=Q(),pl=t=>{const e=(0,hl.c)(26),{onPostClick:a}=t,i=ft(),n=je(),{darkMode:r}=pt(),l=i.pathname==="/";let o;e[0]!==i.pathname?(o=i.pathname.startsWith("/reels")||i.pathname.startsWith("/messages")&&i.pathname.split("/").length>2,e[0]=i.pathname,e[1]=o):o=e[1];const c=o;let f;e[2]!==n?(f=N=>{n(`/u/${N}`)},e[2]=n,e[3]=f):f=e[3];const u=f,m=`min-h-screen bg-[--background] text-[--foreground] font-sans selection:bg-violet-500 selection:text-white transition-colors duration-200 ${r?"dark":""}`;let x;e[4]!==a?(x=(0,s.jsx)(yl,{onPostClick:a}),e[4]=a,e[5]=x):x=e[5];let h;e[6]!==l?(h=l&&(0,s.jsx)("div",{className:"w-full max-w-full overflow-hidden",children:(0,s.jsx)(xl,{})}),e[6]=l,e[7]=h):h=e[7];let d;e[8]===Symbol.for("react.memo_cache_sentinel")?(d=(0,s.jsx)("div",{className:"w-full",children:(0,s.jsx)(Ua,{})}),e[8]=d):d=e[8];let p;e[9]!==h?(p=(0,s.jsxs)("div",{className:"flex flex-col flex-1 w-0 overflow-x-hidden",children:[h,d]}),e[9]=h,e[10]=p):p=e[10];let g;e[11]!==i.pathname?(g=!i.pathname.startsWith("/messages")&&(0,s.jsx)(So,{}),e[11]=i.pathname,e[12]=g):g=e[12];let v;e[13]!==p||e[14]!==g?(v=(0,s.jsxs)("div",{className:"flex-1 flex justify-center gap-x-2 md:gap-x-8 py-0 md:py-5 px-0 md:px-4",children:[p,g]}),e[13]=p,e[14]=g,e[15]=v):v=e[15];let j;e[16]!==x||e[17]!==v?(j=(0,s.jsxs)("div",{className:"flex justify-center w-full max-w-[1300px] mx-auto min-h-screen px-0 sm:px-0",children:[x,v]}),e[16]=x,e[17]=v,e[18]=j):j=e[18];let w;e[19]!==u||e[20]!==c?(w=!c&&(0,s.jsx)(dl,{handleProfileClick:u}),e[19]=u,e[20]=c,e[21]=w):w=e[21];let y;return e[22]!==j||e[23]!==w||e[24]!==m?(y=(0,s.jsxs)("div",{className:m,children:[j,w]}),e[22]=j,e[23]=w,e[24]=m,e[25]=y):y=e[25],y},gl=pl,bl=Q(),vl=t=>{const e=(0,bl.c)(2),{children:a}=t;let i;return e[0]!==a?(i=(0,s.jsx)("div",{className:"w-full animate-in fade-in slide-in-from-bottom-2 duration-300 ease-out",children:a}),e[0]=a,e[1]=i):i=e[1],i},Ce=vl,jl=Q(),wl=t=>{const e=(0,jl.c)(18),{onPostClick:a}=t,{currentUser:i}=he(),{unreadCount:n}=xa(i),{unreadCount:r}=Jt(i);let l,o,c,f,u;e[0]===Symbol.for("react.memo_cache_sentinel")?(l={id:"home",icon:Ut,path:"/"},o={id:"community",icon:et,path:"/community"},c={id:"reels",icon:zt,path:"/reels"},f={id:"messages",icon:Pt,path:"/messages"},u={id:"notifications",icon:_t,path:"/notifications"},e[0]=l,e[1]=o,e[2]=c,e[3]=f,e[4]=u):(l=e[0],o=e[1],c=e[2],f=e[3],u=e[4]);const m=i?`/u/${i.handle}`:"/community";let x;e[5]!==m?(x=[l,o,c,f,u,{id:"profile",icon:It,path:m}],e[5]=m,e[6]=x):x=e[6];const h=x;let d;e[7]===Symbol.for("react.memo_cache_sentinel")?(d=(0,s.jsx)(Wt,{to:"/",className:"mb-8 hover:scale-110 transition-transform",children:(0,s.jsx)("img",{src:"/logo.webp",alt:"Logo",className:"size-8 rounded-lg"})}),e[7]=d):d=e[7];let p;e[8]!==r||e[9]!==h||e[10]!==n?(p=h.map(j=>(0,s.jsxs)($s,{to:j.path,className:zl,children:[(0,s.jsx)(j.icon,{size:26,strokeWidth:2.5}),j.id==="notifications"&&n>0&&(0,s.jsx)("span",{className:"absolute top-2 right-2 size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"}),j.id==="messages"&&r>0&&(0,s.jsx)("span",{className:"absolute top-2 right-2 size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"})]},j.id)),e[8]=r,e[9]=h,e[10]=n,e[11]=p):p=e[11];let g;e[12]!==i||e[13]!==a?(g=i&&(0,s.jsx)("button",{onClick:a,className:"p-2.5 mt-2 rounded-xl text-white bg-zinc-950 dark:bg-white dark:text-zinc-950 hover:scale-110 active:scale-95 transition-all duration-200 shadow-lg cursor-pointer",title:"Create Post",children:(0,s.jsx)(We,{size:26,strokeWidth:2.5})}),e[12]=i,e[13]=a,e[14]=g):g=e[14];let v;return e[15]!==g||e[16]!==p?(v=(0,s.jsxs)("aside",{className:"sticky top-0 hidden md:flex h-screen w-[68px] flex-col items-center py-5 border-r border-zinc-100 dark:border-zinc-800 shrink-0 bg-white dark:bg-black transition-colors duration-200",children:[d,(0,s.jsxs)("nav",{className:"flex flex-col gap-y-4 w-full items-center",children:[p,g]})]}),e[15]=g,e[16]=p,e[17]=v):v=e[17],v},yl=wl;function zl(t){const{isActive:e}=t;return`p-2.5 rounded-xl transition-all duration-200 border border-transparent relative ${e?"text-black dark:text-white bg-zinc-100 dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800":"text-zinc-500 hover:bg-zinc-50 dark:hover:bg-zinc-900"}`}var Ee=Q();function ns(t){const e=(0,Ee.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(kn,{"data-slot":"alert-dialog",...a}),e[2]=a,e[3]=i):i=e[3],i}function Nl(t){const e=(0,Ee.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(Ja,{"data-slot":"alert-dialog-portal",...a}),e[2]=a,e[3]=i):i=e[3],i}function kl(t){const e=(0,Ee.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=re("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(Ni,{"data-slot":"alert-dialog-overlay",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function rs(t){const e=(0,Ee.c)(9);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]===Symbol.for("react.memo_cache_sentinel")?(n=(0,s.jsx)(kl,{}),e[3]=n):n=e[3];let r;e[4]!==a?(r=re("bg-white dark:bg-zinc-950 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-2xl border border-zinc-100 dark:border-zinc-800 p-6 shadow-xl duration-200 sm:max-w-md",a),e[4]=a,e[5]=r):r=e[5];let l;return e[6]!==i||e[7]!==r?(l=(0,s.jsxs)(Nl,{children:[n,(0,s.jsx)(Oi,{"data-slot":"alert-dialog-content","aria-describedby":void 0,className:r,...i})]}),e[6]=i,e[7]=r,e[8]=l):l=e[8],l}function ls(t){const e=(0,Ee.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=re("flex flex-col gap-2 text-center sm:text-left",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)("div",{"data-slot":"alert-dialog-header",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function os(t){const e=(0,Ee.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=re("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)("div",{"data-slot":"alert-dialog-footer",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function cs(t){const e=(0,Ee.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=re("text-lg font-semibold",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(ki,{"data-slot":"alert-dialog-title",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function ds(t){const e=(0,Ee.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=re("text-muted-foreground text-sm",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(Cn,{"data-slot":"alert-dialog-description",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function ms(t){const e=(0,Ee.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=re("inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-bold transition-all active:scale-95 bg-zinc-900 text-white hover:bg-zinc-800 dark:bg-white dark:text-black dark:hover:bg-zinc-200",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(Nn,{className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function us(t){const e=(0,Ee.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=re("inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-bold border border-zinc-200 bg-white text-zinc-900 hover:bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-950 dark:text-zinc-50 dark:hover:bg-zinc-900",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(Pn,{className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var _l=Q(),Cl=t=>{const e=(0,_l.c)(12);let a,i,n,r;e[0]!==t?({children:a,variant:n,className:r,...i}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n,e[4]=r):(a=e[1],i=e[2],n=e[3],r=e[4]);const l=n===void 0?"primary":n,o=r===void 0?"":r;let c;e[5]===Symbol.for("react.memo_cache_sentinel")?(c={primary:"text-white hover:text-white bg-zinc-900 hover:bg-zinc-800 border border-zinc-900 dark:bg-white dark:text-black dark:border-white dark:hover:bg-zinc-200",secondary:"text-zinc-900 border border-zinc-300 hover:border-zinc-400 bg-transparent hover:bg-zinc-50 dark:text-white dark:border-zinc-700 dark:hover:border-zinc-600 dark:hover:bg-zinc-900",outline:"text-zinc-900 border border-zinc-300 hover:border-zinc-400 bg-white dark:bg-transparent dark:text-white dark:border-zinc-700 dark:hover:bg-zinc-900",danger:"text-white bg-red-500 hover:bg-red-600 border border-red-500",ghost:"text-zinc-500 hover:bg-zinc-100 dark:text-zinc-400 dark:hover:bg-zinc-800 border-transparent"},e[5]=c):c=e[5];const f=`rounded-full font-bold inline-flex items-center justify-center relative overflow-hidden px-4 py-1.5 transition-all duration-200 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:active:scale-100 touch-manipulation ${c[l]} ${o}`;let u;e[6]!==a?(u=(0,s.jsx)("div",{className:"flex items-center gap-x-1.5",children:a}),e[6]=a,e[7]=u):u=e[7];let m;return e[8]!==i||e[9]!==f||e[10]!==u?(m=(0,s.jsx)("button",{className:f,...i,children:u}),e[8]=i,e[9]=f,e[10]=u,e[11]=m):m=e[11],m},ue=Cl,rt=Q();function Sl(t){const e=(0,rt.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(Xi,{"data-slot":"context-menu",...a}),e[2]=a,e[3]=i):i=e[3],i}function Pl(t){const e=(0,rt.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(Ei,{"data-slot":"context-menu-trigger",...a}),e[2]=a,e[3]=i):i=e[3],i}function $l(t){const e=(0,rt.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=re("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(rn,{children:(0,s.jsx)(Bi,{"data-slot":"context-menu-content",className:n,...i})}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function Ft(t){const e=(0,rt.c)(12);let a,i,n,r;e[0]!==t?({className:a,inset:i,variant:r,...n}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n,e[4]=r):(a=e[1],i=e[2],n=e[3],r=e[4]);const l=r===void 0?"default":r;let o;e[5]!==a?(o=re("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),e[5]=a,e[6]=o):o=e[6];let c;return e[7]!==i||e[8]!==n||e[9]!==o||e[10]!==l?(c=(0,s.jsx)(Hi,{"data-slot":"context-menu-item","data-inset":i,"data-variant":l,className:o,...n}),e[7]=i,e[8]=n,e[9]=o,e[10]=l,e[11]=c):c=e[11],c}function Al(t){const e=(0,rt.c)(10);let a,i,n;e[0]!==t?({className:a,inset:i,...n}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n):(a=e[1],i=e[2],n=e[3]);let r;e[4]!==a?(r=re("text-foreground px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",a),e[4]=a,e[5]=r):r=e[5];let l;return e[6]!==i||e[7]!==n||e[8]!==r?(l=(0,s.jsx)(un,{"data-slot":"context-menu-label","data-inset":i,className:r,...n}),e[6]=i,e[7]=n,e[8]=r,e[9]=l):l=e[9],l}function fs(t){const e=(0,rt.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=re("bg-border -mx-1 my-1 h-px",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(Ki,{"data-slot":"context-menu-separator",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var He=Q();function ha(t){const e=(0,He.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(Ba,{"data-slot":"dialog",...a}),e[2]=a,e[3]=i):i=e[3],i}function Ml(t){const e=(0,He.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(sn,{"data-slot":"dialog-portal",...a}),e[2]=a,e[3]=i):i=e[3],i}function Fl(t){const e=(0,He.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=re("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(gi,{"data-slot":"dialog-overlay",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function pa(t){const e=(0,He.c)(11);let a,i,n;e[0]!==t?({className:i,children:a,...n}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n):(a=e[1],i=e[2],n=e[3]);let r;e[4]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsx)(Fl,{}),e[4]=r):r=e[4];let l;e[5]!==i?(l=re("bg-white dark:bg-zinc-950 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-2xl border border-zinc-100 dark:border-zinc-800 p-6 shadow-xl duration-200 sm:max-w-md",i),e[5]=i,e[6]=l):l=e[6];let o;return e[7]!==a||e[8]!==n||e[9]!==l?(o=(0,s.jsxs)(Ml,{children:[r,(0,s.jsx)(Xa,{"data-slot":"alert-dialog-content","aria-describedby":void 0,className:l,...n,children:a})]}),e[7]=a,e[8]=n,e[9]=l,e[10]=o):o=e[10],o}function ga(t){const e=(0,He.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=re("flex flex-col gap-2 text-center sm:text-left",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)("div",{"data-slot":"dialog-header",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function ba(t){const e=(0,He.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=re("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)("div",{"data-slot":"dialog-footer",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function va(t){const e=(0,He.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=re("text-lg leading-none font-semibold",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(en,{"data-slot":"dialog-title",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function Rl(t){const e=(0,He.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=re("text-muted-foreground text-sm",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(Ka,{"data-slot":"dialog-description",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var gt=Q();function ja(t){const e=(0,gt.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(Wi,{"data-slot":"dropdown-menu",...a}),e[2]=a,e[3]=i):i=e[3],i}function wa(t){const e=(0,gt.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(zn,{"data-slot":"dropdown-menu-trigger",...a}),e[2]=a,e[3]=i):i=e[3],i}function ya(t){const e=(0,gt.c)(10);let a,i,n;e[0]!==t?({className:a,sideOffset:n,...i}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n):(a=e[1],i=e[2],n=e[3]);const r=n===void 0?4:n;let l;e[4]!==a?(l=re("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",a),e[4]=a,e[5]=l):l=e[5];let o;return e[6]!==i||e[7]!==r||e[8]!==l?(o=(0,s.jsx)(bn,{children:(0,s.jsx)(Li,{"data-slot":"dropdown-menu-content",sideOffset:r,className:l,...i})}),e[6]=i,e[7]=r,e[8]=l,e[9]=o):o=e[9],o}function Ge(t){const e=(0,gt.c)(12);let a,i,n,r;e[0]!==t?({className:a,inset:i,variant:r,...n}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n,e[4]=r):(a=e[1],i=e[2],n=e[3],r=e[4]);const l=r===void 0?"default":r;let o;e[5]!==a?(o=re("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),e[5]=a,e[6]=o):o=e[6];let c;return e[7]!==i||e[8]!==n||e[9]!==o||e[10]!==l?(c=(0,s.jsx)(dn,{"data-slot":"dropdown-menu-item","data-inset":i,"data-variant":l,className:o,...n}),e[7]=i,e[8]=n,e[9]=o,e[10]=l,e[11]=c):c=e[11],c}function El(t){const e=(0,gt.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=re("bg-border -mx-1 my-1 h-px",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(nn,{"data-slot":"dropdown-menu-separator",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var Il=Q(),Ll=t=>{const e=(0,Il.c)(10),{onEmojiSelect:a,className:i}=t;let n;e[0]!==i?(n=re("isolate flex h-[350px] w-[320px] flex-col overflow-hidden rounded-xl border border-zinc-200 bg-white shadow-xl dark:border-zinc-800 dark:bg-zinc-950",i),e[0]=i,e[1]=n):n=e[1];let r;e[2]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsx)(Ye.Search,{className:"z-10 mx-3 mt-3 appearance-none rounded-lg border-none bg-zinc-100 px-3 py-2 text-sm outline-none placeholder:text-zinc-500 focus:ring-1 focus:ring-violet-500 dark:bg-zinc-900 dark:text-white",placeholder:"Search emojis..."}),e[2]=r):r=e[2];let l,o;e[3]===Symbol.for("react.memo_cache_sentinel")?(l=(0,s.jsx)(Ye.Loading,{className:"absolute inset-0 flex items-center justify-center text-zinc-400 text-sm dark:text-zinc-500",children:"Loading"}),o=(0,s.jsx)(Ye.Empty,{className:"absolute inset-0 flex items-center justify-center text-zinc-400 text-sm dark:text-zinc-500",children:"No emoji found."}),e[3]=l,e[4]=o):(l=e[3],o=e[4]);let c,f;e[5]===Symbol.for("react.memo_cache_sentinel")?(c=(0,s.jsxs)(Ye.Viewport,{className:"relative flex-1 outline-none no-scrollbar",children:[l,o,(0,s.jsx)(Ye.List,{className:"select-none pb-2",components:{CategoryHeader:Dl,Row:Ol,Emoji:ql}})]}),f=(0,s.jsx)(Ye.ActiveEmoji,{children:Wl}),e[5]=c,e[6]=f):(c=e[5],f=e[6]);let u;return e[7]!==a||e[8]!==n?(u=(0,s.jsxs)(Ye.Root,{onEmojiSelect:a,className:n,children:[r,c,f]}),e[7]=a,e[8]=n,e[9]=u):u=e[9],u},Tl=Ll;function Dl(t){const{category:e,...a}=t;return(0,s.jsx)("div",{className:"bg-white/80 px-4 pt-4 pb-1.5 font-bold text-zinc-500 text-[11px] uppercase tracking-wider backdrop-blur-sm dark:bg-zinc-950/80 dark:text-zinc-400",...a,children:e.label})}function Ol(t){const{children:e,...a}=t;return(0,s.jsx)("div",{className:"scroll-my-1 px-2",...a,children:e})}function ql(t){const{emoji:e,...a}=t;return(0,s.jsx)("button",{className:"flex aspect-square size-9 items-center justify-center rounded-lg text-xl transition-colors hover:bg-zinc-100 data-[active]:bg-violet-500/10 data-[active]:text-violet-500 dark:hover:bg-zinc-900 dark:data-[active]:bg-violet-500/20",...a,children:e.emoji})}function Wl(t){const{emoji:e}=t;return(0,s.jsx)("div",{className:"flex items-center gap-3 border-t border-zinc-100 p-3 dark:border-zinc-800",children:e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"text-2xl",children:e.emoji}),(0,s.jsx)("span",{className:"text-xs font-bold text-zinc-600 dark:text-zinc-400 truncate",children:e.label.replace(/:/g,"").replace(/_/g," ")})]}):(0,s.jsx)("span",{className:"text-xs font-medium text-zinc-400",children:"Select an emoji..."})})}var Ul=Q(),Bl=t=>{const e=(0,Ul.c)(33),{src:a,isOpen:i,onClose:n,onCropComplete:r,aspect:l,circular:o}=t,[c,f]=(0,b.useState)(),[u,m]=(0,b.useState)(null),x=(0,b.useRef)(null);let h;e[0]!==l?(h=I=>{const{width:L,height:$}=I.currentTarget;f(l?on(jn({unit:"%",width:100},l,L,$),L,$):{unit:"%",width:100,height:100,x:0,y:0})},e[0]=l,e[1]=h):h=e[1];const d=h;let p;e[2]!==u||e[3]!==n||e[4]!==r?(p=async()=>{if(u&&x.current)try{r(await Qn(x.current,u)),n()}catch(I){console.error("Error cropping image:",I)}},e[2]=u,e[3]=n,e[4]=r,e[5]=p):p=e[5];const g=p;let v;e[6]!==n?(v=I=>!I&&n(),e[6]=n,e[7]=v):v=e[7];let j;e[8]===Symbol.for("react.memo_cache_sentinel")?(j=(0,s.jsx)(ga,{className:"p-4 shrink-0",children:(0,s.jsx)(va,{children:"Crop Image"})}),e[8]=j):j=e[8];let w,y;e[9]===Symbol.for("react.memo_cache_sentinel")?(w=I=>f(I),y=(I,L)=>m(L),e[9]=w,e[10]=y):(w=e[9],y=e[10]);let N;e[11]!==d||e[12]!==a?(N=(0,s.jsx)("img",{ref:x,src:a,alt:"Crop preview",onLoad:d,className:"max-h-[60vh] w-auto block"}),e[11]=d,e[12]=a,e[13]=N):N=e[13];let _;e[14]!==l||e[15]!==o||e[16]!==c||e[17]!==N?(_=(0,s.jsx)("div",{className:"p-6 flex items-center justify-center bg-zinc-100/50 dark:bg-zinc-950/50 min-h-[300px] max-h-[65vh] overflow-auto",children:(0,s.jsx)(pn,{crop:c,onChange:w,onComplete:y,aspect:l,circularCrop:o,className:"max-w-full shadow-2xl",children:N})}),e[14]=l,e[15]=o,e[16]=c,e[17]=N,e[18]=_):_=e[18];let P;e[19]!==n?(P=(0,s.jsx)(ue,{variant:"outline",onClick:n,className:"!w-auto px-6",children:"Cancel"}),e[19]=n,e[20]=P):P=e[20];let M;e[21]!==g?(M=(0,s.jsx)(ue,{onClick:g,className:"!w-auto px-6",children:"Apply Crop"}),e[21]=g,e[22]=M):M=e[22];let k;e[23]!==M||e[24]!==P?(k=(0,s.jsxs)(ba,{className:"p-4 bg-white dark:bg-zinc-900 shrink-0 flex flex-row justify-end gap-2",children:[P,M]}),e[23]=M,e[24]=P,e[25]=k):k=e[25];let A;e[26]!==k||e[27]!==_?(A=(0,s.jsxs)(pa,{className:"sm:max-w-2xl bg-white dark:bg-zinc-900 p-0 overflow-hidden",children:[j,_,k]}),e[26]=k,e[27]=_,e[28]=A):A=e[28];let S;return e[29]!==i||e[30]!==A||e[31]!==v?(S=(0,s.jsx)(ha,{open:i,onOpenChange:v,children:A}),e[29]=i,e[30]=A,e[31]=v,e[32]=S):S=e[32],S},Vl=Bl,Ql=Q(),Jl=t=>{const e=(0,Ql.c)(105),{images:a,currentIndex:i,onClose:n,onNavigate:r}=t,l=i===void 0?0:i,[o,c]=(0,b.useState)(1);let f;e[0]===Symbol.for("react.memo_cache_sentinel")?(f={x:0,y:0},e[0]=f):f=e[0];const[u,m]=(0,b.useState)(f),[x,h]=(0,b.useState)(!1);let d;e[1]===Symbol.for("react.memo_cache_sentinel")?(d={x:0,y:0},e[1]=d):d=e[1];const[p,g]=(0,b.useState)(d),[v,j]=(0,b.useState)(null),[w,y]=(0,b.useState)(null),N=(0,b.useRef)(null),_=(0,b.useRef)(null);let P;e[2]===Symbol.for("react.memo_cache_sentinel")?(P=()=>c(Kl),e[2]=P):P=e[2];const M=P;let k;e[3]===Symbol.for("react.memo_cache_sentinel")?(k=()=>{c(U=>{const ie=Math.max(U-.5,1);return ie===1&&m({x:0,y:0}),ie})},e[3]=k):k=e[3];const A=k;let S;e[4]===Symbol.for("react.memo_cache_sentinel")?(S=()=>{c(1),m({x:0,y:0})},e[4]=S):S=e[4];const I=S;let L;e[5]!==l||e[6]!==r?(L=()=>{l>0&&(I(),r(l-1))},e[5]=l,e[6]=r,e[7]=L):L=e[7];const $=L;let R;e[8]!==l||e[9]!==a?.length||e[10]!==r?(R=()=>{l<(a?.length||0)-1&&(I(),r(l+1))},e[8]=l,e[9]=a?.length,e[10]=r,e[11]=R):R=e[11],a?.length;const E=R;let O;e[12]!==E||e[13]!==$||e[14]!==n?(O=()=>{const U=ie=>{ie.key==="Escape"&&n(),ie.key==="ArrowLeft"&&$(),ie.key==="ArrowRight"&&E()};return window.addEventListener("keydown",U),()=>window.removeEventListener("keydown",U)},e[12]=E,e[13]=$,e[14]=n,e[15]=O):O=e[15];let F;if(e[16]!==l||e[17]!==E||e[18]!==$||e[19]!==n?(F=[l,n,$,E],e[16]=l,e[17]=E,e[18]=$,e[19]=n,e[20]=F):F=e[20],(0,b.useEffect)(O,F),!a||a.length===0)return null;const z=a[l],C=a.length>1;let T;e[21]!==u.x||e[22]!==u.y||e[23]!==o?(T=U=>{o>1&&(h(!0),g({x:U.clientX-u.x,y:U.clientY-u.y}))},e[21]=u.x,e[22]=u.y,e[23]=o,e[24]=T):T=e[24];const B=T;let W;e[25]!==p||e[26]!==x||e[27]!==o?(W=U=>{x&&o>1&&m({x:U.clientX-p.x,y:U.clientY-p.y})},e[25]=p,e[26]=x,e[27]=o,e[28]=W):W=e[28];const J=W;let K;e[29]===Symbol.for("react.memo_cache_sentinel")?(K=()=>h(!1),e[29]=K):K=e[29];const G=K;let ne;e[30]!==u.x||e[31]!==u.y||e[32]!==o?(ne=U=>{U.touches.length===1?(j({x:U.touches[0].clientX,y:U.touches[0].clientY,time:Date.now()}),o>1&&(h(!0),g({x:U.touches[0].clientX-u.x,y:U.touches[0].clientY-u.y}))):U.touches.length===2&&y(Math.hypot(U.touches[0].clientX-U.touches[1].clientX,U.touches[0].clientY-U.touches[1].clientY))},e[30]=u.x,e[31]=u.y,e[32]=o,e[33]=ne):ne=e[33];const se=ne;let le;e[34]!==p||e[35]!==w||e[36]!==x||e[37]!==o?(le=U=>{if(U.touches.length===1)x&&o>1&&m({x:U.touches[0].clientX-p.x,y:U.touches[0].clientY-p.y});else if(U.touches.length===2&&w){const ie=Math.hypot(U.touches[0].clientX-U.touches[1].clientX,U.touches[0].clientY-U.touches[1].clientY);c(Math.min(Math.max(o*(ie/w),1),4)),y(ie)}},e[34]=p,e[35]=w,e[36]=x,e[37]=o,e[38]=le):le=e[38];const X=le;let ee;e[39]!==E||e[40]!==$||e[41]!==o||e[42]!==v?(ee=U=>{if(U.touches.length<2&&y(null),h(!1),v&&o===1){const ie={x:U.changedTouches[0].clientX,y:U.changedTouches[0].clientY},Me=ie.x-v.x,qe=ie.y-v.y,Ve=Date.now()-v.time;Math.abs(Me)>50&&Math.abs(qe)<50&&Ve<300&&(Me>0?$():E())}j(null)},e[39]=E,e[40]=$,e[41]=o,e[42]=v,e[43]=ee):ee=e[43];const q=ee;let V;e[44]!==z?(V=U=>{U.stopPropagation();const ie=document.createElement("a");ie.href=z,ie.download=`sysm-${Date.now()}.jpg`,document.body.appendChild(ie),ie.click(),document.body.removeChild(ie)},e[44]=z,e[45]=V):V=e[45];const Y=V,ae=C?`${l+1} / ${a.length}`:"Image View";let Z;e[46]!==ae?(Z=(0,s.jsx)("div",{className:"flex flex-col",children:(0,s.jsx)("span",{className:"text-white font-bold text-lg drop-shadow-md",children:ae})}),e[46]=ae,e[47]=Z):Z=e[47];let ce;e[48]===Symbol.for("react.memo_cache_sentinel")?(ce=(0,s.jsx)("button",{onClick:A,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors hidden sm:block",children:(0,s.jsx)(ii,{size:20})}),e[48]=ce):ce=e[48];let me;e[49]===Symbol.for("react.memo_cache_sentinel")?(me=(0,s.jsx)("button",{onClick:M,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors hidden sm:block",children:(0,s.jsx)(di,{size:20})}),e[49]=me):me=e[49];let pe;e[50]===Symbol.for("react.memo_cache_sentinel")?(pe=(0,s.jsx)("button",{onClick:I,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors",children:(0,s.jsx)(Zi,{size:20})}),e[50]=pe):pe=e[50];let de;e[51]===Symbol.for("react.memo_cache_sentinel")?(de=(0,s.jsx)(Ss,{size:20}),e[51]=de):de=e[51];let fe;e[52]!==Y?(fe=(0,s.jsx)("button",{onClick:Y,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors",children:de}),e[52]=Y,e[53]=fe):fe=e[53];let we;e[54]===Symbol.for("react.memo_cache_sentinel")?(we=(0,s.jsx)("div",{className:"w-px h-6 bg-white/20 mx-1 hidden sm:block"}),e[54]=we):we=e[54];let Ne;e[55]===Symbol.for("react.memo_cache_sentinel")?(Ne=(0,s.jsx)($e,{size:24}),e[55]=Ne):Ne=e[55];let xe;e[56]!==n?(xe=(0,s.jsx)("button",{onClick:n,className:"text-white p-2 bg-white/10 hover:bg-white/20 rounded-full transition-all",children:Ne}),e[56]=n,e[57]=xe):xe=e[57];let ye;e[58]!==fe||e[59]!==xe?(ye=(0,s.jsxs)("div",{className:"flex items-center gap-1 sm:gap-3",onClick:Yl,children:[ce,me,pe,fe,we,xe]}),e[58]=fe,e[59]=xe,e[60]=ye):ye=e[60];let Ie;e[61]!==Z||e[62]!==ye?(Ie=(0,s.jsxs)("div",{className:"absolute top-0 left-0 right-0 p-4 z-20 flex items-center justify-between bg-gradient-to-b from-black/60 to-transparent",children:[Z,ye]}),e[61]=Z,e[62]=ye,e[63]=Ie):Ie=e[63];let Se;e[64]!==l||e[65]!==$||e[66]!==C||e[67]!==o?(Se=C&&l>0&&o===1&&(0,s.jsx)("button",{onClick:U=>{U.stopPropagation(),$()},className:"absolute left-6 z-10 p-4 bg-white/5 hover:bg-white/10 rounded-full text-white backdrop-blur-sm transition-all active:scale-90 hidden md:flex",children:(0,s.jsx)(Is,{size:32})}),e[64]=l,e[65]=$,e[66]=C,e[67]=o,e[68]=Se):Se=e[68];const lt=`translate(${u.x}px, ${u.y}px) scale(${o})`;let Ue;e[69]!==lt?(Ue={transform:lt},e[69]=lt,e[70]=Ue):Ue=e[70];let Le;e[71]!==z?(Le=(0,s.jsx)("img",{ref:_,src:z,className:"max-w-[95vw] max-h-[85vh] object-contain select-none shadow-2xl rounded-sm",alt:"",draggable:!1}),e[71]=z,e[72]=Le):Le=e[72];let Te;e[73]!==B||e[74]!==Ue||e[75]!==Le?(Te=(0,s.jsx)("div",{className:"relative transition-transform duration-200 ease-out cursor-grab active:cursor-grabbing",style:Ue,onMouseDown:B,onClick:Xl,children:Le}),e[73]=B,e[74]=Ue,e[75]=Le,e[76]=Te):Te=e[76];let De;e[77]!==l||e[78]!==E||e[79]!==C||e[80]!==a.length||e[81]!==o?(De=C&&l<a.length-1&&o===1&&(0,s.jsx)("button",{onClick:U=>{U.stopPropagation(),E()},className:"absolute right-6 z-10 p-4 bg-white/5 hover:bg-white/10 rounded-full text-white backdrop-blur-sm transition-all active:scale-90 hidden md:flex",children:(0,s.jsx)(Xe,{size:32})}),e[77]=l,e[78]=E,e[79]=C,e[80]=a.length,e[81]=o,e[82]=De):De=e[82];let Oe;e[83]!==Se||e[84]!==Te||e[85]!==De?(Oe=(0,s.jsxs)("div",{className:"w-full h-full relative flex items-center justify-center",children:[Se,Te,De]}),e[83]=Se,e[84]=Te,e[85]=De,e[86]=Oe):Oe=e[86];let Be;e[87]!==l||e[88]!==C||e[89]!==a||e[90]!==r?(Be=C&&(0,s.jsx)("div",{className:"absolute bottom-8 flex gap-3 p-3 bg-black/40 backdrop-blur-xl rounded-2xl border border-white/10 overflow-x-auto max-w-[90%] hide-scrollbar",onClick:Zl,children:a.map((U,ie)=>(0,s.jsx)("button",{onClick:()=>{I(),r(ie)},className:`size-14 rounded-xl overflow-hidden border-2 transition-all shrink-0 ${ie===l?"border-violet-500 scale-110 shadow-lg shadow-violet-500/20":"border-transparent opacity-40 hover:opacity-100"}`,children:(0,s.jsx)("img",{src:U,className:"size-full object-cover",alt:""})},ie))}),e[87]=l,e[88]=C,e[89]=a,e[90]=r,e[91]=Be):Be=e[91];let H;e[92]!==C||e[93]!==o?(H=o===1&&C&&(0,s.jsx)("div",{className:"absolute bottom-4 text-white/30 text-[10px] uppercase tracking-widest font-bold md:hidden",children:"Swipe to navigate"}),e[92]=C,e[93]=o,e[94]=H):H=e[94];let te;return e[95]!==J||e[96]!==q||e[97]!==X||e[98]!==se||e[99]!==n||e[100]!==Ie||e[101]!==Oe||e[102]!==Be||e[103]!==H?(te=(0,s.jsxs)("div",{ref:N,className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-md flex flex-col items-center justify-center overflow-hidden touch-none",onMouseMove:J,onMouseUp:G,onMouseLeave:G,onTouchStart:se,onTouchMove:X,onTouchEnd:q,onClick:n,children:[Ie,Oe,Be,H]}),e[95]=J,e[96]=q,e[97]=X,e[98]=se,e[99]=n,e[100]=Ie,e[101]=Oe,e[102]=Be,e[103]=H,e[104]=te):te=e[104],te},Hl=Jl;function Kl(t){return Math.min(t+.5,4)}function Yl(t){return t.stopPropagation()}function Xl(t){return t.stopPropagation()}function Zl(t){return t.stopPropagation()}var Gl=Q(),za=b.forwardRef((t,e)=>{const a=(0,Gl.c)(20);let i,n,r,l,o;a[0]!==t?({className:i,label:n,type:o,textarea:l,...r}=t,a[0]=t,a[1]=i,a[2]=n,a[3]=r,a[4]=l,a[5]=o):(i=a[1],n=a[2],r=a[3],l=a[4],o=a[5]);const c=l?"textarea":"input";let f;a[6]!==n?(f=n&&(0,s.jsx)("label",{className:"text-sm font-bold text-zinc-500 dark:text-zinc-400 ml-1",children:n}),a[6]=n,a[7]=f):f=a[7];const u=l&&"min-h-[100px] resize-none";let m;a[8]!==i||a[9]!==u?(m=re("flex w-full rounded-xl border border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900 px-4 py-2.5 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-zinc-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:ring-offset-zinc-950 dark:text-white transition-all",u,i),a[8]=i,a[9]=u,a[10]=m):m=a[10];let x;a[11]!==c||a[12]!==r||a[13]!==e||a[14]!==m||a[15]!==o?(x=(0,s.jsx)(c,{type:o,className:m,ref:e,...r}),a[11]=c,a[12]=r,a[13]=e,a[14]=m,a[15]=o,a[16]=x):x=a[16];let h;return a[17]!==f||a[18]!==x?(h=(0,s.jsxs)("div",{className:"w-full space-y-1.5",children:[f,x]}),a[17]=f,a[18]=x,a[19]=h):h=a[19],h});za.displayName="Input";var Fe=za,eo=Q(),to=t=>{const e=(0,eo.c)(20),{isOpen:a,onClose:i,title:n,children:r,footer:l,description:o,className:c}=t;let f;e[0]!==i?(f=v=>{v||i()},e[0]=i,e[1]=f):f=e[1];const u=f;let m;e[2]!==c?(m=re("sm:max-w-md max-h-[calc(100dvh-2rem)] flex flex-col p-0 gap-0 overflow-hidden bg-white dark:bg-zinc-900",c),e[2]=c,e[3]=m):m=e[3];let x;e[4]!==o||e[5]!==n?(x=n&&(0,s.jsxs)(ga,{className:"px-5 py-4 shrink-0",children:[(0,s.jsx)(va,{className:"text-xl font-bold",children:n}),o&&(0,s.jsx)(Rl,{children:o})]}),e[4]=o,e[5]=n,e[6]=x):x=e[6];let h;e[7]!==r?(h=(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-5 min-h-0",children:r}),e[7]=r,e[8]=h):h=e[8];let d;e[9]!==l?(d=l&&(0,s.jsx)(ba,{className:"px-5 py-4 shrink-0 bg-white dark:bg-zinc-900",children:l}),e[9]=l,e[10]=d):d=e[10];let p;e[11]!==m||e[12]!==x||e[13]!==h||e[14]!==d?(p=(0,s.jsxs)(pa,{className:m,children:[x,h,d]}),e[11]=m,e[12]=x,e[13]=h,e[14]=d,e[15]=p):p=e[15];let g;return e[16]!==u||e[17]!==a||e[18]!==p?(g=(0,s.jsx)(ha,{open:a,onOpenChange:u,children:p}),e[16]=u,e[17]=a,e[18]=p,e[19]=g):g=e[19],g},Ke=to,so=Q(),ao=t=>{const e=(0,so.c)(20),{title:a,message:i,icon:n,showHome:r,showBack:l}=t,o=a===void 0?"Not Found":a,c=i===void 0?"The content you are looking for doesn't exist or has been removed.":i,f=n===void 0?zs:n,u=r===void 0?!0:r,m=l===void 0?!0:l,x=je(),h=f;let d;e[0]!==h?(d=(0,s.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-900 p-6 rounded-full mb-6",children:(0,s.jsx)(h,{size:48,className:"text-zinc-400 dark:text-zinc-600"})}),e[0]=h,e[1]=d):d=e[1];let p;e[2]!==o?(p=(0,s.jsx)("h2",{className:"text-2xl font-black mb-2 dark:text-white",children:o}),e[2]=o,e[3]=p):p=e[3];let g;e[4]!==c?(g=(0,s.jsx)("p",{className:"text-zinc-500 dark:text-zinc-400 max-w-xs mb-8 leading-relaxed",children:c}),e[4]=c,e[5]=g):g=e[5];let v;e[6]!==x||e[7]!==m?(v=m&&(0,s.jsxs)(ue,{variant:"secondary",onClick:()=>x(-1),className:"rounded-full px-6",children:[(0,s.jsx)(tt,{size:18,className:"mr-2"}),"Go Back"]}),e[6]=x,e[7]=m,e[8]=v):v=e[8];let j;e[9]!==x||e[10]!==u?(j=u&&(0,s.jsxs)(ue,{onClick:()=>x("/"),className:"bg-zinc-900 dark:bg-white text-white dark:text-zinc-900 rounded-full px-6",children:[(0,s.jsx)(Ut,{size:18,className:"mr-2"}),"Home"]}),e[9]=x,e[10]=u,e[11]=j):j=e[11];let w;e[12]!==j||e[13]!==v?(w=(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-center gap-3",children:[v,j]}),e[12]=j,e[13]=v,e[14]=w):w=e[14];let y;return e[15]!==w||e[16]!==d||e[17]!==p||e[18]!==g?(y=(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[400px] p-8 text-center animate-in fade-in zoom-in-95 duration-300",children:[d,p,g,w]}),e[15]=w,e[16]=d,e[17]=p,e[18]=g,e[19]=y):y=e[19],y},Kt=ao,Yt=Q();function Na(t){const e=(0,Yt.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(Da,{"data-slot":"popover",...a}),e[2]=a,e[3]=i):i=e[3],i}function ka(t){const e=(0,Yt.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let i;return e[2]!==a?(i=(0,s.jsx)(Qi,{"data-slot":"popover-trigger",...a}),e[2]=a,e[3]=i):i=e[3],i}function _a(t){const e=(0,Yt.c)(12);let a,i,n,r;e[0]!==t?({className:a,align:n,sideOffset:r,...i}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n,e[4]=r):(a=e[1],i=e[2],n=e[3],r=e[4]);const l=n===void 0?"center":n,o=r===void 0?4:r;let c;e[5]!==a?(c=re("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 rounded-md border p-4 shadow-md outline-hidden",a),e[5]=a,e[6]=c):c=e[6];let f;return e[7]!==l||e[8]!==i||e[9]!==o||e[10]!==c?(f=(0,s.jsx)(ji,{children:(0,s.jsx)(Fi,{"data-slot":"popover-content",align:l,sideOffset:o,className:c,...i})}),e[7]=l,e[8]=i,e[9]=o,e[10]=c,e[11]=f):f=e[11],f}var io=Q(),no=()=>{const t=(0,io.c)(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,s.jsx)(Ai,{size:16,className:"fill-blue-500 text-white ml-1 inline-block shrink-0"}),t[0]=e):e=t[0],e},dt=no;const Ca=(t,e,a)=>{const i=t?.id,[n,r]=(0,b.useState)(!1),[l,o]=(0,b.useState)({followers:t?.followers||t?.follower_count||0,following:t?.following||t?.following_count||0}),[c,f]=(0,b.useState)(!1);return(0,b.useEffect)(()=>{t&&(o({followers:t.followers||t.follower_count||0,following:t.following||t.following_count||0}),i&&Pe(i)&&(ar(i).then(m=>{m&&o({followers:m.followers,following:m.following})}).catch(()=>{}),e&&Pe(e)?Gs(e,i).then(r).catch(()=>r(!1)):r(!1)))},[t,i,e]),{isFollowing:n,stats:l,loading:c,handleFollow:async()=>{if(!e)return a("Please login to follow!","error");if(e===i)return a("You cannot follow yourself!","error");if(!i||!Pe(i)||!Pe(e)){const m=!n;r(m),o(x=>{const h=typeof x.followers=="string"?parseInt(x.followers.replace(/,/g,"")):x.followers||0;return{...x,followers:m?h+1:Math.max(0,h-1)}}),a(m?"Followed":"Unfollowed");return}f(!0);try{const m=await Zs(e,i);r(m),o(x=>({...x,followers:m?(x.followers||0)+1:Math.max(0,(x.followers||0)-1)})),a(m?"Followed":"Unfollowed")}catch(m){console.error("Failed to toggle follow:",m),a("Failed to update follow status","error")}finally{f(!1)}},setStats:o}};var ro=({profile:t,onUserClick:e,isCommunity:a=!1})=>{const{onlineUsers:i}=oa(),{currentUser:n}=he(),{addToast:r}=ze(),l=i.has(t.id),[o,c]=(0,b.useState)(!1),[f,u]=(0,b.useState)(a),{isFollowing:m,loading:x,handleFollow:h}=Ca(a?null:t,n?.id,r);(0,b.useEffect)(()=>{a&&n&&t.id?na(t.id,n.id).then(c).finally(()=>u(!1)):u(!1)},[a,n,t.id]);const d=async v=>{if(v.stopPropagation(),!n)return r("Please login to join communities","error");u(!0);try{const j=await ia(t.id,n.id);c(j),r(j?`Joined ${t.name}`:`Left ${t.name}`)}catch{r("Failed to update membership","error")}finally{u(!1)}},p=n?.id===t.id,g=a?f:x;return(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-zinc-100 dark:border-zinc-800 hover:bg-zinc-50 dark:hover:bg-zinc-900/40 transition-colors group cursor-pointer",onClick:()=>e(t.handle),children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)(ge,{className:`size-12 border border-zinc-200 dark:border-zinc-800 shadow-sm ${a?"rounded-2xl":""}`,children:[(0,s.jsx)(be,{src:t.avatar,alt:t.handle,className:"object-cover"}),(0,s.jsx)(ve,{className:a?"rounded-2xl":"",children:t.handle?.[0]?.toUpperCase()})]}),l&&!a&&(0,s.jsx)("span",{className:"absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full shadow-sm"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white leading-none",children:t.name}),t.verified&&(0,s.jsx)(dt,{})]}),(0,s.jsxs)("span",{className:"text-sm text-zinc-500 mt-0.5",children:["@",t.handle]}),a&&(0,s.jsxs)("span",{className:"text-xs text-zinc-400 mt-1",children:[t.membersCount||0," members"]}),!a&&t.followers&&(0,s.jsxs)("span",{className:"text-xs text-zinc-400 mt-1",children:[t.followers," followers"]})]})]}),!p&&(0,s.jsx)(ue,{variant:a?o?"secondary":"outline":m?"secondary":"outline",className:"!w-auto !py-1.5 !px-4 text-sm font-bold rounded-full border-zinc-200 dark:border-zinc-700 hover:bg-zinc-100 dark:hover:bg-zinc-800",onClick:a?d:v=>{v.stopPropagation(),h()},disabled:g,children:g?(0,s.jsx)(oe,{size:14,className:"animate-spin"}):a?o?"Joined":"Join":m?"Following":"Follow"})]})},Sa=ro,Pa=Q();function xs(t){const e=(0,Pa.c)(14);let a,i,n;e[0]!==t?({className:i,children:a,...n}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n):(a=e[1],i=e[2],n=e[3]);let r;e[4]!==i?(r=re("relative",i),e[4]=i,e[5]=r):r=e[5];let l;e[6]!==a?(l=(0,s.jsx)($i,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:a}),e[6]=a,e[7]=l):l=e[7];let o,c;e[8]===Symbol.for("react.memo_cache_sentinel")?(o=(0,s.jsx)(qt,{}),c=(0,s.jsx)(ri,{}),e[8]=o,e[9]=c):(o=e[8],c=e[9]);let f;return e[10]!==n||e[11]!==r||e[12]!==l?(f=(0,s.jsxs)(fn,{"data-slot":"scroll-area",className:r,...n,children:[l,o,c]}),e[10]=n,e[11]=r,e[12]=l,e[13]=f):f=e[13],f}function qt(t){const e=(0,Pa.c)(13);let a,i,n;e[0]!==t?({className:a,orientation:n,...i}=t,e[0]=t,e[1]=a,e[2]=i,e[3]=n):(a=e[1],i=e[2],n=e[3]);const r=n===void 0?"vertical":n,l=r==="vertical"&&"h-full w-2.5 border-l border-l-transparent",o=r==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent";let c;e[4]!==a||e[5]!==l||e[6]!==o?(c=re("flex touch-none p-px transition-colors select-none",l,o,a),e[4]=a,e[5]=l,e[6]=o,e[7]=c):c=e[7];let f;e[8]===Symbol.for("react.memo_cache_sentinel")?(f=(0,s.jsx)(Mi,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"}),e[8]=f):f=e[8];let u;return e[9]!==r||e[10]!==i||e[11]!==c?(u=(0,s.jsx)(ni,{"data-slot":"scroll-area-scrollbar",orientation:r,className:c,...i,children:f}),e[9]=r,e[10]=i,e[11]=c,e[12]=u):u=e[12],u}var lo=Q(),oo=t=>{const e=(0,lo.c)(13),{value:a,onChange:i,onClear:n,placeholder:r}=t,l=r===void 0?"Search...":r;let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=(0,s.jsx)(Bt,{size:18,className:"absolute left-4 top-1/2 -translate-y-1/2 text-zinc-400 group-focus-within:text-violet-500 transition-colors"}),e[0]=o):o=e[0];let c;e[1]!==i?(c=x=>i(x.target.value),e[1]=i,e[2]=c):c=e[2];let f;e[3]!==l||e[4]!==c||e[5]!==a?(f=(0,s.jsx)("input",{className:"w-full rounded-full border border-zinc-100 dark:border-zinc-800 bg-zinc-50 dark:bg-zinc-900/50 text-zinc-900 dark:text-white px-11 py-2.5 text-sm outline-none focus:border-violet-500 focus:ring-1 focus:ring-violet-500 transition-all",placeholder:l,value:a,onChange:c}),e[3]=l,e[4]=c,e[5]=a,e[6]=f):f=e[6];let u;e[7]!==n||e[8]!==a?(u=a&&(0,s.jsx)("button",{onClick:n,className:"absolute right-4 top-1/2 -translate-y-1/2 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 transition-colors",children:(0,s.jsx)($e,{size:16})}),e[7]=n,e[8]=a,e[9]=u):u=e[9];let m;return e[10]!==f||e[11]!==u?(m=(0,s.jsxs)("div",{className:"relative group w-full",children:[o,f,u]}),e[10]=f,e[11]=u,e[12]=m):m=e[12],m},kt=oo,st=Q(),co=$n;var mo=Si,$a=b.forwardRef((t,e)=>{const a=(0,st.c)(12);let i,n,r;a[0]!==t?({className:n,children:i,...r}=t,a[0]=t,a[1]=i,a[2]=n,a[3]=r):(i=a[1],n=a[2],r=a[3]);let l;a[4]!==n?(l=re("flex h-9 w-full items-center justify-between rounded-md border border-zinc-200 bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-white placeholder:text-zinc-500 focus:outline-none focus:ring-1 focus:ring-zinc-950 disabled:cursor-not-allowed disabled:opacity-50 dark:border-zinc-800 dark:ring-offset-zinc-950 dark:focus:ring-zinc-300 [&>span]:line-clamp-1",n),a[4]=n,a[5]=l):l=a[5];let o;a[6]===Symbol.for("react.memo_cache_sentinel")?(o=(0,s.jsx)(xi,{asChild:!0,children:(0,s.jsx)(Ts,{className:"h-4 w-4 opacity-50"})}),a[6]=o):o=a[6];let c;return a[7]!==i||a[8]!==r||a[9]!==e||a[10]!==l?(c=(0,s.jsxs)(Es,{ref:e,className:l,...r,children:[i,o]}),a[7]=i,a[8]=r,a[9]=e,a[10]=l,a[11]=c):c=a[11],c});$a.displayName=Es.displayName;var Aa=b.forwardRef((t,e)=>{const a=(0,st.c)(10);let i,n;a[0]!==t?({className:i,...n}=t,a[0]=t,a[1]=i,a[2]=n):(i=a[1],n=a[2]);let r;a[3]!==i?(r=re("flex cursor-default items-center justify-center py-1",i),a[3]=i,a[4]=r):r=a[4];let l;a[5]===Symbol.for("react.memo_cache_sentinel")?(l=(0,s.jsx)(_i,{className:"h-4 w-4"}),a[5]=l):l=a[5];let o;return a[6]!==n||a[7]!==e||a[8]!==r?(o=(0,s.jsx)(Ls,{ref:e,className:r,...n,children:l}),a[6]=n,a[7]=e,a[8]=r,a[9]=o):o=a[9],o});Aa.displayName=Ls.displayName;var Ma=b.forwardRef((t,e)=>{const a=(0,st.c)(10);let i,n;a[0]!==t?({className:i,...n}=t,a[0]=t,a[1]=i,a[2]=n):(i=a[1],n=a[2]);let r;a[3]!==i?(r=re("flex cursor-default items-center justify-center py-1",i),a[3]=i,a[4]=r):r=a[4];let l;a[5]===Symbol.for("react.memo_cache_sentinel")?(l=(0,s.jsx)(Ts,{className:"h-4 w-4"}),a[5]=l):l=a[5];let o;return a[6]!==n||a[7]!==e||a[8]!==r?(o=(0,s.jsx)(ys,{ref:e,className:r,...n,children:l}),a[6]=n,a[7]=e,a[8]=r,a[9]=o):o=a[9],o});Ma.displayName=ys.displayName;var Fa=b.forwardRef((t,e)=>{const a=(0,st.c)(21);let i,n,r,l;a[0]!==t?({className:n,children:i,position:l,...r}=t,a[0]=t,a[1]=i,a[2]=n,a[3]=r,a[4]=l):(i=a[1],n=a[2],r=a[3],l=a[4]);const o=l===void 0?"popper":l,c=o==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1";let f;a[5]!==n||a[6]!==c?(f=re("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-zinc-200 bg-white text-zinc-950 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-zinc-800 dark:bg-zinc-950 dark:text-zinc-50",c,n),a[5]=n,a[6]=c,a[7]=f):f=a[7];let u;a[8]===Symbol.for("react.memo_cache_sentinel")?(u=(0,s.jsx)(Aa,{}),a[8]=u):u=a[8];const m=o==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]";let x;a[9]!==m?(x=re("p-1",m),a[9]=m,a[10]=x):x=a[10];let h;a[11]!==i||a[12]!==x?(h=(0,s.jsx)(ei,{className:x,children:i}),a[11]=i,a[12]=x,a[13]=h):h=a[13];let d;a[14]===Symbol.for("react.memo_cache_sentinel")?(d=(0,s.jsx)(Ma,{}),a[14]=d):d=a[14];let p;return a[15]!==o||a[16]!==r||a[17]!==e||a[18]!==f||a[19]!==h?(p=(0,s.jsx)(yi,{children:(0,s.jsxs)(Us,{ref:e,className:f,position:o,...r,children:[u,h,d]})}),a[15]=o,a[16]=r,a[17]=e,a[18]=f,a[19]=h,a[20]=p):p=a[20],p});Fa.displayName=Us.displayName;var uo=b.forwardRef((t,e)=>{const a=(0,st.c)(9);let i,n;a[0]!==t?({className:i,...n}=t,a[0]=t,a[1]=i,a[2]=n):(i=a[1],n=a[2]);let r;a[3]!==i?(r=re("px-2 py-1.5 text-sm font-semibold",i),a[3]=i,a[4]=r):r=a[4];let l;return a[5]!==n||a[6]!==e||a[7]!==r?(l=(0,s.jsx)(Cs,{ref:e,className:r,...n}),a[5]=n,a[6]=e,a[7]=r,a[8]=l):l=a[8],l});uo.displayName=Cs.displayName;var jt=b.forwardRef((t,e)=>{const a=(0,st.c)(14);let i,n,r;a[0]!==t?({className:n,children:i,...r}=t,a[0]=t,a[1]=i,a[2]=n,a[3]=r):(i=a[1],n=a[2],r=a[3]);let l;a[4]!==n?(l=re("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-zinc-100 focus:text-zinc-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-zinc-800 dark:focus:text-zinc-50",n),a[4]=n,a[5]=l):l=a[5];let o;a[6]===Symbol.for("react.memo_cache_sentinel")?(o=(0,s.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(Za,{children:(0,s.jsx)(Ns,{className:"h-4 w-4"})})}),a[6]=o):o=a[6];let c;a[7]!==i?(c=(0,s.jsx)(ti,{children:i}),a[7]=i,a[8]=c):c=a[8];let f;return a[9]!==r||a[10]!==e||a[11]!==l||a[12]!==c?(f=(0,s.jsxs)(As,{ref:e,className:l,...r,children:[o,c]}),a[9]=r,a[10]=e,a[11]=l,a[12]=c,a[13]=f):f=a[13],f});jt.displayName=As.displayName;var fo=b.forwardRef((t,e)=>{const a=(0,st.c)(9);let i,n;a[0]!==t?({className:i,...n}=t,a[0]=t,a[1]=i,a[2]=n):(i=a[1],n=a[2]);let r;a[3]!==i?(r=re("-mx-1 my-1 h-px bg-zinc-100 dark:bg-zinc-800",i),a[3]=i,a[4]=r):r=a[4];let l;return a[5]!==n||a[6]!==e||a[7]!==r?(l=(0,s.jsx)(_s,{ref:e,className:r,...n}),a[5]=n,a[6]=e,a[7]=r,a[8]=l):l=a[8],l});fo.displayName=_s.displayName;var xo=Q(),ho=t=>{const e=(0,xo.c)(9),{className:a}=t,{setAuthMode:i}=he();let n;e[0]!==a?(n=re("border border-[--border] rounded-2xl p-8 flex flex-col items-center text-center gap-4 bg-[--card] shadow-sm",a),e[0]=a,e[1]=n):n=e[1];let r,l;e[2]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"size-16 rounded-full border-4 border-amber-400 border-t-transparent animate-spin duration-[3000ms]"}),(0,s.jsx)("span",{className:"absolute inset-0 flex items-center justify-center text-2xl",children:""})]}),l=(0,s.jsx)("h3",{className:"font-extrabold text-lg text-[--foreground] mt-2 leading-tight",children:"Get your Sysm account now!"}),e[2]=r,e[3]=l):(r=e[2],l=e[3]);let o;e[4]!==i?(o=(0,s.jsx)("button",{onClick:()=>i("signup"),className:"w-full bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 py-2.5 rounded-full font-black text-sm uppercase tracking-wider hover:opacity-90 active:scale-95 transition-all shadow-lg cursor-pointer",children:"Signup now"}),e[4]=i,e[5]=o):o=e[5];let c;return e[6]!==n||e[7]!==o?(c=(0,s.jsxs)("div",{className:n,children:[r,l,o]}),e[6]=n,e[7]=o,e[8]=c):c=e[8],c},Ra=ho,po=Q(),go=()=>{const t=(0,po.c)(3);let e;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,s.jsx)("div",{className:"size-11 rounded-full bg-zinc-200 dark:bg-zinc-800 shrink-0"}),t[0]=e):e=t[0];let a;t[1]===Symbol.for("react.memo_cache_sentinel")?(a=(0,s.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,s.jsx)("div",{className:"h-4 bg-zinc-200 dark:bg-zinc-800 rounded w-1/3"}),(0,s.jsx)("div",{className:"h-4 bg-zinc-200 dark:bg-zinc-800 rounded w-16"})]}),t[1]=a):a=t[1];let i;return t[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsx)("div",{className:"px-5 pt-4 pb-3 border-b border-zinc-100 dark:border-zinc-800 animate-pulse",children:(0,s.jsxs)("div",{className:"flex items-start gap-x-3",children:[e,(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[a,(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"h-3 bg-zinc-200 dark:bg-zinc-800 rounded w-full"}),(0,s.jsx)("div",{className:"h-3 bg-zinc-200 dark:bg-zinc-800 rounded w-5/6"})]}),(0,s.jsx)("div",{className:"h-48 bg-zinc-200 dark:bg-zinc-800 rounded-xl w-full mt-3"})]})]})}),t[2]=i):i=t[2],i},Xt=go,$t=Q();function Zt(t){const e=(0,$t.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=re("flex flex-col gap-2",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(tn,{"data-slot":"tabs",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function Gt(t){const e=(0,$t.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=re("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(pi,{"data-slot":"tabs-list",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function mt(t){const e=(0,$t.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=re("inline-flex items-center justify-center gap-1.5 px-2 py-1 text-sm font-medium whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 outline-none focus:outline-none focus-visible:outline-none ring-0 focus:ring-0 focus-visible:ring-0 shadow-none data-[state=active]:shadow-none",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(qa,{"data-slot":"tabs-trigger",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}function ot(t){const e=(0,$t.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=re("flex-1 outline-none",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)(Ha,{"data-slot":"tabs-content",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var bo=Q(),vo=t=>{const e=(0,bo.c)(18),{name:a,number:i}=t,n=a===void 0?"BRUCE WAYNE":a,r=i===void 0?"9759 2484 5269 6576":i;let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=(0,s.jsx)("style",{children:`
        .credit-card-container {
          perspective: 1000px;
          width: 240px;
          height: 154px;
        }
        .credit-card-inner {
          position: relative;
          width: 100%;
          height: 100%;
          text-align: center;
          transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
          transform-style: preserve-3d;
          cursor: pointer;
        }
        .credit-card-container:hover .credit-card-inner {
          transform: rotateY(180deg);
        }
        .credit-card-front, .credit-card-back {
          position: absolute;
          width: 100%;
          height: 100%;
          -webkit-backface-visibility: hidden;
          backface-visibility: hidden;
          border-radius: 1rem;
          display: flex;
          flex-direction: column;
          justify-content: center;
          background-color: #171717;
          box-shadow: 0 2px 2px rgba(0,0,0,0.4), 0 7px 13px -3px rgba(0,0,0,0.3), inset 0 -1px 0 rgba(0,0,0,0.2);
          color: white;
          overflow: hidden;
        }
        .credit-card-back {
          transform: rotateY(180deg);
        }
      `}),e[0]=l):l=e[0];let o;e[1]===Symbol.for("react.memo_cache_sentinel")?(o=(0,s.jsx)("p",{className:"absolute text-[0.5em] font-bold tracking-[.2em] top-[2em] left-[18.6em]",children:"VICTIMCARD"}),e[1]=o):o=e[1];let c;e[2]===Symbol.for("react.memo_cache_sentinel")?(c=(0,s.jsxs)("svg",{className:"absolute top-[6.8em] left-[11.7em]",xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 48 48",children:[(0,s.jsx)("path",{fill:"#ff9800",d:"M32 10A14 14 0 1 0 32 38A14 14 0 1 0 32 10Z"}),(0,s.jsx)("path",{fill:"#d50000",d:"M16 10A14 14 0 1 0 16 38A14 14 0 1 0 16 10Z"}),(0,s.jsx)("path",{fill:"#ff3d00",d:"M18,24c0,4.755,2.376,8.95,6,11.48c3.624-2.53,6-6.725,6-11.48s-2.376-8.95-6-11.48 C20.376,15.05,18,19.245,18,24z"})]}),e[2]=c):c=e[2];let f;e[3]===Symbol.for("react.memo_cache_sentinel")?(f=(0,s.jsx)("svg",{version:"1.1",className:"absolute top-[2.3em] left-[1.5em]",width:"30px",height:"30px",viewBox:"0 0 50 50",children:(0,s.jsx)("image",{width:"50",height:"50",x:"0",y:"0",href:`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAABGdBTUEAALGPC/xhBQAAACBjSFJN
                AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAB6VBMVEUAAACNcTiVeUKVeUOY
                fEaafEeUeUSYfEWZfEaykleyklaXe0SWekSZZjOYfEWYe0WXfUWXe0WcgEicfkiXe0SVekSXekSW
                ekKYe0a9nF67m12ZfUWUeEaXfESVekOdgEmVeUWWekSniU+VeUKVeUOrjFKYfEWliE6WeESZe0GS
                e0WYfES7ml2Xe0WXeESUeEOWfEWcf0eWfESXe0SXfEWYekSVeUKXfEWxklawkVaZfEWWekOUekOW
                ekSYfESZe0eXekWYfEWZe0WZe0eVeUSWeETAnmDCoWLJpmbxy4P1zoXwyoLIpWbjvXjivnjgu3bf
                u3beunWvkFWxkle/nmDivXiWekTnwXvkwHrCoWOuj1SXe0TEo2TDo2PlwHratnKZfEbQrWvPrWua
                fUfbt3PJp2agg0v0zYX0zYSfgkvKp2frxX7mwHrlv3rsxn/yzIPgvHfduXWXe0XuyIDzzISsjVO1
                lVm0lFitjVPzzIPqxX7duna0lVncuHTLqGjvyIHeuXXxyYGZfUayk1iyk1e2lln1zYTEomO2llrb
                tnOafkjFpGSbfkfZtXLhvHfkv3nqxH3mwXujhU3KqWizlFilh06khk2fgkqsjlPHpWXJp2erjVOh
                g0yWe0SliE+XekShhEvAn2D///+gx8TWAAAARnRSTlMACVCTtsRl7Pv7+vxkBab7pZv5+ZlL/UnU
                /f3SJCVe+Fx39naA9/75XSMh0/3SSkia+pil/KRj7Pr662JPkrbP7OLQ0JFOijI1MwAAAAFiS0dE
                orDd34wAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfnAg0IDx2lsiuJAAACLElEQVRIx2Ng
                GAXkAUYmZhZWPICFmYkRVQcbOwenmzse4MbFzc6DpIGXj8PD04sA8PbhF+CFaxEU8iWkAQT8hEVg
                OkTF/InR4eUVICYO1SIhCRMLDAoKDvFDVhUaEhwUFAjjSUlDdMiEhcOEItzdI6OiYxA6YqODIt3d
                I2DcuDBZsBY5eVTr4xMSYcyk5BRUOXkFsBZFJTQnp6alQxgZmVloUkrKYC0qqmji2WE5EEZuWB6a
                lKoKdi35YQUQRkFYPpFaCouKIYzi6EDitJSUlsGY5RWVRGjJLyxNy4ZxqtIqqvOxaVELQwZFZdkI
                JVU1RSiSalAt6rUwUBdWG1CP6pT6gNqwOrgCdQyHNYR5YQFhDXj8MiK1IAeyN6aORiyBjByVTc0F
                qBoKWpqwRCVSgilOaY2OaUPw29qjOzqLvTAchpos47u6EZyYnngUSRwpuTe6D+6qaFQdOPNLRzOM
                1dzhRZyW+CZouHk3dWLXglFcFIflQhj9YWjJGlZcaKAVSvjyPrRQ0oQVKDAQHlYFYUwIm4gqExGm
                BSkutaVQJeomwViTJqPK6OhCy2Q9sQBk8cY0DxjTJw0lAQWK6cOKfgNhpKK7ZMpUeF3jPa28BCET
                amiEqJKM+X1gxvWXpoUjVIVPnwErw71nmpgiqiQGBjNzbgs3j1nus+fMndc+Cwm0T52/oNR9lsdC
              S24ra7Tq1cbWjpXV3sHRCb1idXZ0sGdltXNxRateRwHRAACYHutzk/2I5QAAACV0RVh0ZGF0ZTpj
              cmVhdGUAMjAyMy0wMi0xM1QwODoxNToyOSswMDowMEUnN7UAAAAldEVYdGRhdGU6bW9kaWZ5ADIw
              MjMtMDItMTNUMDg6MTU6MjkrMDA6MDA0eo8JAAAAKHRFWHRkYXRlOnRpbWVzdGFtcAAyMDIzLTAy
              LTEzVDA4OjE1OjI5KzAwOjAwY2+u1gAAAABJRU5ErkJggg==`})}),e[3]=f):f=e[3];let u;e[4]===Symbol.for("react.memo_cache_sentinel")?(u=(0,s.jsx)("svg",{version:"1.1",className:"absolute top-[3.5em] left-[12.4em]",width:"20px",height:"20px",viewBox:"0 0 50 50",children:(0,s.jsx)("image",{width:"50",height:"50",x:"0",y:"0",href:`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAQAAAC0NkA6AAAABGdBTUEAALGPC/xhBQAAACBjSFJN
                AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAJcEhZ
                cwAACxMAAAsTAQCanBgAAAAHdElNRQfnAg0IEzgIwaKTAAADDklEQVRYw+1XS0iUURQ+f5qPyjQf
                lGRFEEFK76koKGxRbWyVVLSOgsCgwjZBJJYuKogSIoOonUK4q3U0WVBWFPZYiIE6kuArG3VGzK/F
                fPeMM/MLt99/NuHdfPd888/57jn3nvsQWWj/VcMlvMMd5KRTogqx9iCdIjUUmcGR9ImUYowyP3xN
                GQJoRLVaZ2DaZf8kyjEJALhI28ELioyiwC+Rc3QZwRYyO/DH51hQgWm6DMIh10KmD4u9O16K49it
                VoPOAmcGAWWOepXIRScAoJZ2Frro8oN+EyTT6lWkkg6msZfMSR35QTJmjU0g15tIGSJ08ZZMJkJk
                HpNZgSkyXosS13TkJpZ62mPIJvOSzC1bp8vRhhCakEk7G9/o4gmZdbpsTcKu0m63FbnBP9Qrc15z
                bkbemfgNDtEOI8NO5L5O9VYyRYgmJayZ9nPaxZrSjW4+F6Uw9yQqIiIZwhp2huQTf6OIvCZyGM6g
                DJBZbyXifJXr7FZjGXsdxADxI7HUJFB6iWvsIhFpkoiIiGTJfjJfiCuJg2ZEspq9EHGVpYgzKqwJ
                qSAOEwuJQ/pxPvE3cYltJCLdxBLiSKKIE5HxJKcTRNeadxfhDiuYw44zVs1dxKwRk/uCxIiQkxKB
                sSctRVAge9g1E15EHE6yRUaJecRxcWlukdRIbGFOSZCMWQA/iWauIP3slREHXPyliqBcrrD71Amz
                Z+rD1Mt2Yr8TZc/UR4/YtFnbijnHi3UrN9vKQ9rPaJf867ZiaqDB+czeKYmd3pNa6fuI75MiC0uX
                XSR5aEMf7s7a6r/PudVXkjFb/SsrCRfROk0Fx6+H1i9kkTGn/E1vEmt1m089fh+RKdQ5O+xNJPUi
                cUIjO0Dm7HwvErEr0YxeibL1StSh37STafE4I7zcBdRq1DiOkdmlTJVnkQTBTS7X1FYyvfO4piaI
                nKbDCDaT2anLudYXCRFsQBgAcIF2/Okwgvz5+Z4tsw118dzruvIvjhTB+HOuWy8UvovEH6beitBK
                xDyxm9MmISKCWrzB7bSlaqGlsf0FC0gMjzTg6GgAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDIt
                MTNUMDg6MTk6NTYrMDA6MDCjlq7LAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTAyLTEzVDA4OjE5
              OjU2KzAwOjAw0ssWdwAAACh0RVh0ZGF0ZTp0aW1lc3RhbXAAMjAyMy0wMi0xM1QwODoxOTo1Nisw
              MDowMIXeN6gAAAAASUVORK5CYII=`})}),e[4]=u):u=e[4];let m;e[5]!==r?(m=(0,s.jsx)("p",{className:"absolute text-[.6em] font-bold top-[8.3em] left-[1.6em] uppercase tracking-wider",children:r}),e[5]=r,e[6]=m):m=e[6];let x;e[7]===Symbol.for("react.memo_cache_sentinel")?(x=(0,s.jsx)("p",{className:"absolute text-[0.5em] font-bold top-[13.6em] left-[3.2em]",children:"1 2 / 2 4"}),e[7]=x):x=e[7];let h;e[8]!==n?(h=(0,s.jsx)("p",{className:"absolute text-[0.5em] font-bold top-[16.1em] left-[2em] uppercase tracking-tighter truncate w-[160px] text-left",children:n}),e[8]=n,e[9]=h):h=e[9];let d;e[10]!==h||e[11]!==m?(d=(0,s.jsxs)("div",{className:"credit-card-front",children:[o,c,f,u,m,x,h]}),e[10]=h,e[11]=m,e[12]=d):d=e[12];let p,g;e[13]===Symbol.for("react.memo_cache_sentinel")?(p=(0,s.jsx)("div",{className:"absolute w-full h-[1.5em] top-[2.4em] bg-black bg-[repeating-linear-gradient(45deg,#303030,#303030_10px,#202020_10px,#202020_20px)] left-0"}),g=(0,s.jsx)("div",{className:"absolute w-[8em] h-[0.8em] top-[5em] left-[0.8em] bg-white rounded-[2.5px]"}),e[13]=p,e[14]=g):(p=e[13],g=e[14]);let v;e[15]===Symbol.for("react.memo_cache_sentinel")?(v=(0,s.jsxs)("div",{className:"credit-card-back",children:[p,g,(0,s.jsx)("div",{className:"absolute w-[4.1em] h-[0.8em] top-[5em] left-[10em] bg-white rounded-[2.5px]",children:(0,s.jsx)("p",{className:"text-black font-bold text-center m-[.2em] text-[0.5em]",children:"***"})})]}),e[15]=v):v=e[15];let j;return e[16]!==d?(j=(0,s.jsxs)(s.Fragment,{children:[l,(0,s.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,s.jsx)("div",{className:"credit-card-container",children:(0,s.jsxs)("div",{className:"credit-card-inner",children:[d,v]})})})]}),e[16]=d,e[17]=j):j=e[17],j},jo=vo,wo=Q();function yo(t){const e=(0,wo.c)(8);let a,i;e[0]!==t?({className:a,...i}=t,e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let n;e[3]!==a?(n=re("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),e[3]=a,e[4]=n):n=e[4];let r;return e[5]!==i||e[6]!==n?(r=(0,s.jsx)("textarea",{"data-slot":"textarea",className:n,...i}),e[5]=i,e[6]=n,e[7]=r):r=e[7],r}var zo=Q(),No=t=>{const e=(0,zo.c)(7),{className:a}=t;let i;e[0]!==a?(i=re("flex items-center gap-1 px-1 py-1.5",a),e[0]=a,e[1]=i):i=e[1];let n,r,l;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,s.jsx)("div",{className:"size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse"}),r=(0,s.jsx)("div",{className:"size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse [animation-delay:0.2s]"}),l=(0,s.jsx)("div",{className:"size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse [animation-delay:0.4s]"}),e[2]=n,e[3]=r,e[4]=l):(n=e[2],r=e[3],l=e[4]);let o;return e[5]!==i?(o=(0,s.jsxs)("div",{className:i,children:[n,r,l]}),e[5]=i,e[6]=o):o=e[6],o},ko=No,_o=Q(),Co=()=>{const t=(0,_o.c)(48),{currentUser:e,setAuthMode:a}=he(),{darkMode:i,toggleDarkMode:n}=pt(),[r,l]=(0,b.useState)(""),o=je();let c;t[0]===Symbol.for("react.memo_cache_sentinel")?(c={queryKey:["trending-hashtags"],queryFn:Po,staleTime:3e5,refetchInterval:6e4},t[0]=c):c=t[0];const{data:f}=Re(c);let u;t[1]!==f?(u=f===void 0?[]:f,t[1]=f,t[2]=u):u=t[2];const m=u;let x;t[3]===Symbol.for("react.memo_cache_sentinel")?(x=[" 2026 Sysm","Terms","Privacy","Guidelines","Discord","Sysm","GitHub","Support","Status"],t[3]=x):x=t[3];const h=x;let d;t[4]!==i?(d=i?(0,s.jsx)(Ds,{size:20}):(0,s.jsx)(Bs,{size:20}),t[4]=i,t[5]=d):d=t[5];let p;t[6]!==d||t[7]!==n?(p=(0,s.jsx)("button",{onClick:n,className:"p-3 rounded-full bg-zinc-50 dark:bg-zinc-900 text-zinc-500 dark:text-zinc-400 border border-zinc-100 dark:border-zinc-800 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-all cursor-pointer",title:"Toggle Theme",children:d}),t[6]=d,t[7]=n,t[8]=p):p=t[8];const g=p;if(e){let S;t[9]===Symbol.for("react.memo_cache_sentinel")?(S=()=>l(""),t[9]=S):S=t[9];let I;t[10]!==r?(I=(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(kt,{value:r,onChange:l,onClear:S})}),t[10]=r,t[11]=I):I=t[11];let L;t[12]!==I||t[13]!==g?(L=(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[I,g]}),t[12]=I,t[13]=g,t[14]=L):L=t[14];let $;t[15]===Symbol.for("react.memo_cache_sentinel")?($=(0,s.jsx)("h3",{className:"font-extrabold text-xl mb-4 px-2 text-[--foreground]",children:"What's happening"}),t[15]=$):$=t[15];let R;if(t[16]!==o||t[17]!==m){let C;t[19]!==o?(C=T=>(0,s.jsxs)("div",{onClick:()=>o(`/tags/${T.name.replace(/^#/,"")}`),className:"px-3 py-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-xl cursor-pointer transition-colors group",children:[(0,s.jsx)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400 font-medium",children:"Trending"}),(0,s.jsxs)("div",{className:"font-bold text-[--foreground]",children:["#",T.name.replace(/^#/,"")]}),(0,s.jsxs)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:[T.usage_count," posts"]})]},T.id),t[19]=o,t[20]=C):C=t[20],R=m.map(C),t[16]=o,t[17]=m,t[18]=R}else R=t[18];let E;t[21]!==m.length?(E=m.length===0&&(0,s.jsx)("p",{className:"text-sm text-zinc-500 px-2",children:"No trends yet"}),t[21]=m.length,t[22]=E):E=t[22];let O;t[23]!==R||t[24]!==E?(O=(0,s.jsxs)("div",{className:"bg-zinc-50 dark:bg-zinc-900 rounded-2xl p-4 border border-[--border]",children:[$,(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[R,E]})]}),t[23]=R,t[24]=E,t[25]=O):O=t[25];let F;t[26]===Symbol.for("react.memo_cache_sentinel")?(F=(0,s.jsx)("div",{className:"flex flex-wrap gap-x-4 gap-y-2 px-2 text-[13px] text-zinc-500 font-medium pb-5",children:h.map($o)}),t[26]=F):F=t[26];let z;return t[27]!==O||t[28]!==L?(z=(0,s.jsxs)("aside",{className:"sticky top-5 hidden w-[320px] shrink-0 flex-col gap-y-6 lg:flex overflow-y-auto max-h-screen",children:[L,O,F]}),t[27]=O,t[28]=L,t[29]=z):z=t[29],z}let v,j;t[30]!==a?(v=(0,s.jsx)("button",{onClick:()=>a("signup"),className:"flex-1 bg-[--card] border border-[--border] py-2.5 rounded-full font-bold text-[--foreground] hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors shadow-sm cursor-pointer",children:"Signup"}),j=()=>a("login"),t[30]=a,t[31]=v,t[32]=j):(v=t[31],j=t[32]);let w;t[33]===Symbol.for("react.memo_cache_sentinel")?(w=(0,s.jsx)("img",{src:"/logo.webp",alt:"",className:"size-4 rounded-sm"}),t[33]=w):w=t[33];let y;t[34]!==j?(y=(0,s.jsxs)("button",{onClick:j,className:"flex-1 bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 py-2.5 rounded-full font-bold flex items-center justify-center gap-2 hover:opacity-90 transition-opacity cursor-pointer",children:[w,"Login"]}),t[34]=j,t[35]=y):y=t[35];let N;t[36]!==v||t[37]!==y||t[38]!==g?(N=(0,s.jsxs)("div",{className:"flex gap-3",children:[v,y,g]}),t[36]=v,t[37]=y,t[38]=g,t[39]=N):N=t[39];let _;t[40]===Symbol.for("react.memo_cache_sentinel")?(_=()=>l(""),t[40]=_):_=t[40];let P;t[41]!==r?(P=(0,s.jsx)(kt,{value:r,onChange:l,onClear:_}),t[41]=r,t[42]=P):P=t[42];let M;t[43]===Symbol.for("react.memo_cache_sentinel")?(M=(0,s.jsx)(Ra,{}),t[43]=M):M=t[43];let k;t[44]===Symbol.for("react.memo_cache_sentinel")?(k=(0,s.jsx)("div",{className:"flex flex-wrap gap-x-4 gap-y-2 px-2 text-[13px] text-zinc-500 font-medium pb-5",children:h.map(Ao)}),t[44]=k):k=t[44];let A;return t[45]!==N||t[46]!==P?(A=(0,s.jsxs)("aside",{className:"sticky top-5 hidden w-[350px] shrink-0 flex-col gap-y-6 lg:flex pr-4",children:[N,P,M,k]}),t[45]=N,t[46]=P,t[47]=A):A=t[47],A},So=Co;function Po(){return Er(5)}function $o(t){return(0,s.jsx)("a",{href:"#",className:"hover:underline",children:t},t)}function Ao(t){return(0,s.jsx)("a",{href:"#",className:"hover:underline",children:t},t)}var n0=Q(),Mo=({isOpen:t,onClose:e})=>{const{currentUser:a}=he(),{addToast:i}=ze(),n=je(),[r,l]=(0,b.useState)({name:"",handle:"",description:"",isPrivate:!1}),[o,c]=(0,b.useState)(!1),f=async u=>{if(u.preventDefault(),!(!r.name||!r.handle||!a)){c(!0);try{const m=await Ar({name:r.name,handle:r.handle.toLowerCase().replace(/[^a-z0-9_]/g,""),description:r.description,is_private:r.isPrivate,creator_id:a.id}),{error:x}=await D.from("community_members").insert([{community_id:m.id,user_id:a.id,role:"admin"}]);if(x)throw x;i(`Community "${m.name}" created!`),e(),n(`/c/${m.handle}`)}catch(m){console.error(m),i(m.message||"Failed to create community","error")}finally{c(!1)}}};return(0,s.jsx)(Ke,{isOpen:t,onClose:()=>!o&&e(),title:"Create Community",className:"sm:max-w-md",children:(0,s.jsxs)("form",{onSubmit:f,className:"space-y-5",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center p-6 bg-zinc-50 dark:bg-zinc-900 rounded-2xl border-2 border-dashed border-zinc-200 dark:border-zinc-800",children:[(0,s.jsx)("div",{className:"size-20 rounded-2xl bg-white dark:bg-black flex items-center justify-center shadow-sm mb-3",children:(0,s.jsx)(et,{size:32,className:"text-violet-600"})}),(0,s.jsx)("p",{className:"text-xs font-medium text-zinc-500 text-center max-w-[200px]",children:"Communities are where people with shared interests connect."})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("label",{className:"text-sm font-bold ml-1",children:"Community Name"}),(0,s.jsx)("input",{type:"text",required:!0,className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all",placeholder:"e.g. Photography Enthusiasts",value:r.name,onChange:u=>l({...r,name:u.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("label",{className:"text-sm font-bold ml-1",children:"Handle"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-zinc-500 font-medium",children:"c/"}),(0,s.jsx)("input",{type:"text",required:!0,className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl pl-8 pr-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all",placeholder:"photography",value:r.handle,onChange:u=>l({...r,handle:u.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"")})})]})]}),(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("label",{className:"text-sm font-bold ml-1",children:"Description (Optional)"}),(0,s.jsx)("textarea",{className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all min-h-[100px] resize-none",placeholder:"What is this community about?",value:r.description,onChange:u=>l({...r,description:u.target.value})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-zinc-50 dark:bg-zinc-900 rounded-xl border border-zinc-200 dark:border-zinc-800",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-sm font-bold",children:"Private Community"}),(0,s.jsx)("span",{className:"text-[10px] text-zinc-500",children:"Only Admins can post in private communities"})]}),(0,s.jsx)("input",{type:"checkbox",className:"size-5 rounded-md accent-violet-600 cursor-pointer",checked:r.isPrivate,onChange:u=>l({...r,isPrivate:u.target.checked})})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,s.jsx)(ue,{type:"button",variant:"outline",className:"flex-1",onClick:e,disabled:o,children:"Cancel"}),(0,s.jsx)(ue,{type:"submit",className:"flex-1",disabled:o||!r.name||!r.handle,children:o?(0,s.jsx)(oe,{size:18,className:"animate-spin"}):"Create"})]})]})})},Fo=Mo,Ro=Q(),Eo=t=>{const e=(0,Ro.c)(33),{id:a,file:i,index:n,total:r,onRemove:l,onAddThumbnail:o,customThumbnail:c}=t;let f;e[0]!==a?(f={id:a},e[0]=a,e[1]=f):f=e[1];const{attributes:u,listeners:m,setNodeRef:x,transform:h,transition:d,isDragging:p}=Fn(f);let g;e[2]!==h?(g=_n.Transform.toString(h),e[2]=h,e[3]=g):g=e[3];const v=p?50:"auto",j=p?.5:1;let w;e[4]!==g||e[5]!==v||e[6]!==j||e[7]!==d?(w={transform:g,transition:d,zIndex:v,opacity:j},e[4]=g,e[5]=v,e[6]=j,e[7]=d,e[8]=w):w=e[8];const y=w,N=`relative group overflow-hidden bg-zinc-100 dark:bg-zinc-800 rounded-2xl border border-zinc-100 dark:border-zinc-800 shadow-sm transition-shadow ${r===3&&n===0?"row-span-2":""} ${p?"shadow-xl ring-2 ring-violet-500":""}`;let _;e[9]!==c||e[10]!==i?(_=i.type.startsWith("image/")?(0,s.jsx)("img",{src:URL.createObjectURL(i),className:"size-full object-cover pointer-events-none",alt:""}):(0,s.jsx)("div",{className:"size-full flex flex-col items-center justify-center text-zinc-500 gap-2 pointer-events-none",children:i.type.startsWith("video/")?(0,s.jsx)(s.Fragment,{children:c?(0,s.jsx)("img",{src:URL.createObjectURL(c),className:"size-full object-cover opacity-60",alt:"Custom thumbnail"}):(0,s.jsx)("div",{className:"size-10 rounded-full bg-black/20 flex items-center justify-center backdrop-blur-sm",children:(0,s.jsx)(We,{size:20,className:"text-zinc-400"})})}):(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,s.jsx)(Ps,{size:24}),(0,s.jsx)("span",{className:"text-[10px] font-bold truncate max-w-[100px] px-2",children:i.name})]})}),e[9]=c,e[10]=i,e[11]=_):_=e[11];let P;e[12]!==u||e[13]!==m||e[14]!==_?(P=(0,s.jsx)("div",{...u,...m,className:"size-full cursor-grab active:cursor-grabbing",children:_}),e[12]=u,e[13]=m,e[14]=_,e[15]=P):P=e[15];let M;e[16]!==c||e[17]!==i.type||e[18]!==o?(M=i.type.startsWith("video/")&&(0,s.jsx)("button",{type:"button",onClick:o,className:"absolute inset-x-0 bottom-0 bg-black/60 text-white text-[10px] font-bold py-2 backdrop-blur-md hover:bg-black/80 transition-colors z-10",children:c?"Change Cover":"Add Cover"}),e[16]=c,e[17]=i.type,e[18]=o,e[19]=M):M=e[19];let k;e[20]!==a||e[21]!==l?(k=()=>l(a),e[20]=a,e[21]=l,e[22]=k):k=e[22];let A;e[23]===Symbol.for("react.memo_cache_sentinel")?(A=(0,s.jsx)($e,{size:14,strokeWidth:2.5}),e[23]=A):A=e[23];let S;e[24]!==k?(S=(0,s.jsx)("button",{type:"button",onClick:k,className:"absolute top-2 right-2 p-1.5 rounded-full bg-black/50 text-white hover:bg-rose-500 transition-colors backdrop-blur-md z-20",children:A}),e[24]=k,e[25]=S):S=e[25];let I;return e[26]!==x||e[27]!==y||e[28]!==S||e[29]!==N||e[30]!==P||e[31]!==M?(I=(0,s.jsxs)("div",{ref:x,style:y,className:N,children:[P,M,S]}),e[26]=x,e[27]=y,e[28]=S,e[29]=N,e[30]=P,e[31]=M,e[32]=I):I=e[32],I},Io=({isOpen:t,onClose:e,initialCommunity:a})=>{const{currentUser:i}=he(),{addPost:n}=Vt(),{addToast:r}=ze(),[l,o]=(0,b.useState)(""),[c,f]=(0,b.useState)([]),[u,m]=(0,b.useState)({}),[x,h]=(0,b.useState)(!1),[d,p]=(0,b.useState)({options:["",""],duration:"1 day"}),[g,v]=(0,b.useState)(!1),[j,w]=(0,b.useState)(null),y=Ti(is(wn,{activationConstraint:{distance:8}}),is(an,{coordinateGetter:En}));(0,b.useEffect)(()=>{w(a||null)},[a,t]);const{data:N=[]}=Re({queryKey:["user-communities",i?.id],queryFn:()=>$r(i?.id),enabled:!!i?.id}),_=(0,b.useRef)(null),P=(0,b.useRef)(null),[M,k]=(0,b.useState)(null),A=F=>{const z=Array.from(F.target.files).map(C=>({id:Math.random().toString(36).substring(2,11),file:C}));f(C=>[...C,...z])},S=F=>{const z=F.target.files[0];z&&M!==null&&m(C=>({...C,[M]:z})),k(null)},I=F=>{f(C=>C.filter(T=>T.id!==F));const z={...u};delete z[F],m(z)},L=F=>{const{active:z,over:C}=F;C&&z.id!==C.id&&f(T=>In(T,T.findIndex(B=>B.id===z.id),T.findIndex(B=>B.id===C.id)))},$=()=>{d.options.length<4&&p(F=>({...F,options:[...F.options,""]}))},R=F=>{p(z=>({...z,options:z.options.filter((C,T)=>T!==F)}))},E=(F,z)=>{const C=[...d.options];C[F]=z,p(T=>({...T,options:C}))},O=async F=>{if(F.preventDefault(),!(!l.trim()&&c.length===0||!i)){v(!0);try{const z=[];for(let T=0;T<c.length;T++){const B=c[T],W=u[B.id]||null,J=await Ae(B.file,"media",W);z.push(J)}let C=null;x&&d.options.some(T=>T.trim())&&(C={options:d.options.filter(T=>T.trim()).map((T,B)=>({id:B+1,text:T,votes:0})),ends_at:new Date(Date.now()+1440*60*1e3).toISOString()}),await n({content:l,media:z,poll:C,type:z.length>0?z[0].type==="video"?"video":"image":C?"poll":"text",userId:i.id,communityId:j?.id||null}),o(""),f([]),h(!1),p({options:["",""],duration:"1 day"}),w(null),e(),r("Post published!")}catch(z){console.error("Failed to create post:",z),r("Failed to publish post.","error")}finally{v(!1)}}};return(0,s.jsx)(Ke,{isOpen:t,onClose:()=>!g&&e(),title:"Create Post",className:"sm:max-w-[600px] p-0 overflow-hidden gap-0",footer:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full pt-2",children:[(0,s.jsxs)("div",{className:"flex gap-1",children:[(0,s.jsx)("button",{type:"button",onClick:()=>_.current?.click(),className:"p-2 text-violet-600 hover:bg-violet-50 dark:text-violet-400 dark:hover:bg-violet-900/20 rounded-full transition-all active:scale-95",title:"Attach media",children:(0,s.jsx)(Rs,{size:20})}),(0,s.jsx)("button",{type:"button",onClick:()=>h(!x),className:`p-2 rounded-full transition-all active:scale-95 ${x?"bg-violet-50 text-violet-600 dark:bg-violet-900/20 dark:text-violet-400":"text-violet-600 hover:bg-violet-50 dark:text-violet-400 dark:hover:bg-violet-900/20"}`,title:"Add poll",children:(0,s.jsx)(xn,{size:20})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"h-6 w-px bg-zinc-200 dark:bg-zinc-800"}),(0,s.jsx)(ue,{onClick:O,disabled:!l.trim()&&c.length===0||g,className:"rounded-full px-6 h-9 text-sm font-bold bg-zinc-900 dark:bg-white text-white dark:text-zinc-950 hover:opacity-90 disabled:opacity-50 transition-all shadow-md active:scale-95",children:g?(0,s.jsx)(oe,{size:16,className:"animate-spin"}):"Post"})]}),(0,s.jsx)("input",{type:"file",ref:_,onChange:A,multiple:!0,className:"hidden",accept:"image/*,video/*,application/pdf"}),(0,s.jsx)("input",{type:"file",ref:P,onChange:S,className:"hidden",accept:"image/*"})]}),children:(0,s.jsxs)("div",{className:"flex flex-col gap-4 p-1",children:[(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsxs)(ge,{className:"size-10 border border-zinc-100 dark:border-zinc-800 shadow-sm shrink-0",children:[(0,s.jsx)(be,{src:i?.avatar,className:"object-cover"}),(0,s.jsx)(ve,{children:i?.handle?.[0]?.toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,s.jsx)("span",{className:"font-bold text-sm text-zinc-900 dark:text-zinc-100 truncate",children:i?.name}),(0,s.jsxs)(ja,{children:[(0,s.jsx)(wa,{asChild:!0,children:(0,s.jsx)("button",{className:"flex items-center gap-1.5 px-2.5 py-1 rounded-full border border-zinc-200 dark:border-zinc-700 bg-white dark:bg-zinc-900 text-xs font-bold text-zinc-600 dark:text-zinc-300 hover:bg-zinc-50 dark:hover:bg-zinc-800 transition-all group",children:j?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(et,{size:12,className:"text-violet-500"}),(0,s.jsx)("span",{className:"max-w-[100px] truncate",children:j.name})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Nt,{size:12,className:"text-zinc-400 group-hover:text-violet-500 transition-colors"}),(0,s.jsx)("span",{children:"Everyone"})]})})}),(0,s.jsxs)(ya,{align:"start",className:"w-60 p-1.5 rounded-xl shadow-xl border-zinc-100 dark:border-zinc-800",children:[(0,s.jsxs)(Ge,{onClick:()=>w(null),className:"gap-3 py-2 px-3 rounded-lg cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800",children:[(0,s.jsx)("div",{className:"size-8 rounded-full bg-zinc-100 dark:bg-zinc-800 flex items-center justify-center shrink-0",children:(0,s.jsx)(Nt,{size:16,className:"text-zinc-500"})}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"font-bold text-sm",children:"Everyone"}),(0,s.jsx)("span",{className:"text-[11px] text-zinc-500",children:"Public feed"})]})]}),N.length>0&&(0,s.jsx)("div",{className:"h-px bg-zinc-100 dark:bg-zinc-800 my-1 mx-2"}),(0,s.jsx)("div",{className:"max-h-[200px] overflow-y-auto",children:N.filter(F=>!F.isPrivate||F.myRole==="admin").map(F=>(0,s.jsxs)(Ge,{onClick:()=>w(F),className:"gap-3 py-2 px-3 rounded-lg cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800",children:[(0,s.jsxs)(ge,{className:"size-8 border border-zinc-100 dark:border-zinc-700",children:[(0,s.jsx)(be,{src:F.avatar}),(0,s.jsx)(ve,{children:F.name[0]})]}),(0,s.jsxs)("div",{className:"flex flex-col min-w-0",children:[(0,s.jsx)("span",{className:"font-bold text-sm truncate",children:F.name}),(0,s.jsx)("span",{className:"text-[11px] text-zinc-500",children:"Community"})]})]},F.id))})]})]})]}),(0,s.jsx)("textarea",{className:"w-full bg-transparent border-none outline-none text-lg min-h-[100px] max-h-[400px] resize-none dark:text-zinc-100 placeholder:text-zinc-400 font-medium leading-relaxed",placeholder:"What's on your mind?",autoFocus:!0,value:l,onChange:F=>{o(F.target.value),F.target.style.height="auto",F.target.style.height=F.target.scrollHeight+"px"}})]})]}),(0,s.jsxs)("div",{className:"pl-[52px]",children:[c.length>0&&(0,s.jsx)("div",{className:"mb-4 animate-in fade-in zoom-in-95 duration-200",children:(0,s.jsx)(gn,{sensors:y,collisionDetection:Ui,onDragEnd:L,children:(0,s.jsx)(On,{items:c.map(F=>F.id),strategy:Tn,children:(0,s.jsx)("div",{className:`grid gap-2 rounded-2xl overflow-hidden border border-zinc-100 dark:border-zinc-800 shadow-sm ${c.length===1?"grid-cols-1":"grid-cols-2 aspect-[16/9]"}`,children:c.map((F,z)=>(0,s.jsx)(Eo,{id:F.id,file:F.file,index:z,total:c.length,onRemove:I,customThumbnail:u[F.id],onAddThumbnail:()=>{k(F.id),P.current?.click()}},F.id))})})})}),x&&(0,s.jsxs)("div",{className:"mb-4 p-4 rounded-xl border border-violet-100 dark:border-violet-900/30 bg-violet-50/30 dark:bg-violet-900/10 space-y-3 animate-in slide-in-from-top-2 duration-200",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center px-1",children:[(0,s.jsx)("span",{className:"text-xs font-bold text-violet-600 dark:text-violet-400 uppercase tracking-wider",children:"Poll Options"}),(0,s.jsx)("button",{type:"button",onClick:()=>h(!1),className:"text-zinc-400 hover:text-rose-500 transition-colors",children:(0,s.jsx)($e,{size:16})})]}),(0,s.jsx)("div",{className:"space-y-2",children:d.options.map((F,z)=>(0,s.jsxs)("div",{className:"flex gap-2 group",children:[(0,s.jsxs)("div",{className:"flex-1 relative",children:[(0,s.jsx)("input",{className:"w-full bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-lg pl-4 pr-10 py-2.5 text-sm outline-none focus:border-violet-500 focus:ring-2 focus:ring-violet-500/10 transition-all font-medium placeholder:font-normal",placeholder:`Option ${z+1}`,value:F,autoFocus:z===d.options.length-1,onChange:C=>E(z,C.target.value)}),(0,s.jsxs)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-[10px] font-bold text-zinc-300 pointer-events-none",children:[F.length,"/25"]})]}),d.options.length>2&&(0,s.jsx)("button",{type:"button",onClick:()=>R(z),className:"p-2.5 text-zinc-400 hover:text-rose-500 hover:bg-rose-50 dark:hover:bg-rose-900/20 rounded-lg transition-colors",children:(0,s.jsx)(Os,{size:18})})]},z))}),d.options.length<4&&(0,s.jsx)("button",{type:"button",onClick:$,className:"w-full py-2.5 text-sm font-bold text-violet-600 dark:text-violet-400 hover:bg-violet-100 dark:hover:bg-violet-900/30 rounded-lg border border-dashed border-violet-200 dark:border-violet-800 transition-all",children:"+ Add option"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 pt-1 px-1",children:[(0,s.jsx)("span",{className:"text-[10px] font-medium text-zinc-500",children:"Poll ends in"}),(0,s.jsxs)("select",{className:"bg-transparent text-[10px] font-bold text-zinc-700 dark:text-zinc-300 outline-none cursor-pointer hover:text-violet-600",value:d.duration,onChange:F=>p({...d,duration:F.target.value}),children:[(0,s.jsx)("option",{value:"1 day",children:"1 day"}),(0,s.jsx)("option",{value:"3 days",children:"3 days"}),(0,s.jsx)("option",{value:"7 days",children:"7 days"})]})]})]})]})]})})},Lo=Io,To=({isOpen:t,onClose:e})=>{const{currentUser:a}=he(),{addToast:i}=ze(),n=Ct(),[r,l]=(0,b.useState)(null),[o,c]=(0,b.useState)(!1),[f,u]=(0,b.useState)(null),m=(0,b.useRef)(null),x=g=>{const v=g.target.files[0];v&&l(v)},h=()=>{if(!r)return;const g=new FileReader;g.onload=()=>{u(g.result)},g.readAsDataURL(r)},d=g=>{l(new File([g],`story-cropped-${Date.now()}.jpg`,{type:"image/jpeg"})),u(null)},p=async()=>{if(!(!r||!a)){c(!0);try{const g=await Ae(r);await _r(a.id,g.url,g.type),l(null),e(),i("Story shared!"),n.invalidateQueries(["stories"])}catch(g){console.error("Failed to create story:",g),i("Failed to share story.")}finally{c(!1)}}};return(0,s.jsxs)(Ke,{isOpen:t,onClose:()=>!o&&e(),title:"Add Story",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[r?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"relative aspect-[9/16] w-full max-w-[280px] mx-auto rounded-3xl overflow-hidden shadow-2xl",children:[(0,s.jsx)("img",{src:URL.createObjectURL(r),className:"w-full h-full object-cover",alt:"Preview"}),(0,s.jsx)("button",{onClick:()=>l(null),className:"absolute top-4 right-4 p-2 bg-black/50 text-white rounded-full hover:bg-rose-500 transition-colors",title:"Remove",children:(0,s.jsx)($e,{size:20})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-center gap-4 py-2 bg-zinc-50/50 dark:bg-zinc-900/50 rounded-2xl",children:[(0,s.jsxs)("button",{onClick:h,className:"flex flex-col items-center gap-1.5 p-3 rounded-xl hover:bg-white dark:hover:bg-zinc-800 transition-all text-zinc-600 dark:text-zinc-400 hover:text-violet-600 dark:hover:text-violet-400 group",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm group-hover:shadow-md transition-all",children:(0,s.jsx)(St,{size:20})}),(0,s.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Crop / Edit"})]}),(0,s.jsxs)("button",{className:"flex flex-col items-center gap-1.5 p-3 rounded-xl opacity-40 cursor-not-allowed text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm",children:(0,s.jsx)("svg",{size:20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:(0,s.jsx)("path",{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 21 3 22l1-4.5L17 3z"})})}),(0,s.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Text"})]}),(0,s.jsxs)("button",{className:"flex flex-col items-center gap-1.5 p-3 rounded-xl opacity-40 cursor-not-allowed text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm",children:(0,s.jsxs)("svg",{size:20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[(0,s.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,s.jsx)("path",{d:"M8 14s1.5 2 4 2 4-2 4-2"}),(0,s.jsx)("line",{x1:"9",y1:"9",x2:"9.01",y2:"9"}),(0,s.jsx)("line",{x1:"15",y1:"9",x2:"15.01",y2:"9"})]})}),(0,s.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Stickers"})]})]})]}):(0,s.jsxs)("div",{className:"py-10",children:[(0,s.jsxs)("div",{className:"relative w-full group",onClick:()=>m.current?.click(),children:[(0,s.jsx)("div",{className:"relative z-40 cursor-pointer group-hover:translate-x-8 group-hover:shadow-2xl group-hover:-translate-y-8 transition-all duration-500 bg-zinc-900 dark:bg-white flex items-center justify-center h-32 w-32 mx-auto rounded-xl border-4 border-white dark:border-zinc-900",children:(0,s.jsxs)("svg",{className:"h-8 w-8 text-white/60 dark:text-zinc-950/60",strokeLinejoin:"round",strokeLinecap:"round",strokeWidth:"2",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2"}),(0,s.jsx)("path",{d:"M7 9l5 -5l5 5"}),(0,s.jsx)("path",{d:"M12 4l0 12"})]})}),(0,s.jsx)("div",{className:"absolute border-2 opacity-0 group-hover:opacity-80 transition-all duration-300 border-dashed border-violet-500 inset-0 z-30 bg-transparent flex items-center justify-center h-32 w-32 mx-auto rounded-xl"})]}),(0,s.jsxs)("div",{className:"text-center mt-8",children:[(0,s.jsx)("p",{className:"font-bold dark:text-white",children:"Choose a photo"}),(0,s.jsx)("p",{className:"text-sm text-zinc-500",children:"Stories last for 24 hours"})]})]}),(0,s.jsx)("input",{type:"file",ref:m,onChange:x,className:"hidden",accept:"image/*"}),(0,s.jsx)(ue,{className:"w-full py-3 text-lg",disabled:!r||o,onClick:p,children:o?(0,s.jsx)(oe,{size:24,className:"animate-spin mx-auto"}):"Share story"})]}),f&&(0,s.jsx)(Vl,{src:f,isOpen:!!f,onClose:()=>u(null),onCropComplete:d,aspect:9/16})]})},Do=To;function Oo({isOpen:t,onClose:e,community:a,onUpdate:i}){const{addToast:n}=ze(),[r,l]=(0,b.useState)({name:"",handle:"",description:"",avatar:"",cover:"",isPrivate:!1}),[o,c]=(0,b.useState)(!1),f=(0,b.useRef)(null),u=(0,b.useRef)(null);(0,b.useEffect)(()=>{a&&t&&l({name:a.name||"",handle:a.handle||"",description:a.description||"",avatar:a.avatar||"",cover:a.cover||"",isPrivate:a.isPrivate||!1})},[a,t]);const m=(d,p)=>{const g=d.target.files[0];g&&x(g,p)},x=async(d,p)=>{c(!0);try{const g=await Ae(d);l(v=>({...v,[p]:g.url})),n(`${p.charAt(0).toUpperCase()+p.slice(1)} uploaded!`)}catch{n(`Failed to upload ${p}`,"error")}finally{c(!1)}},h=async d=>{if(d.preventDefault(),!(!r.name||!r.handle||!a)){c(!0);try{const p=await Mr(a.id,{name:r.name,handle:r.handle.toLowerCase().replace(/[^a-z0-9_]/g,""),description:r.description,avatar_url:r.avatar,cover_url:r.cover,is_private:r.isPrivate});n("Community updated successfully!"),i&&i(p),e()}catch(p){console.error(p),n(p.message||"Failed to update community","error")}finally{c(!1)}}};return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(Ke,{isOpen:t,onClose:()=>!o&&e(),title:"Edit Community",className:"sm:max-w-xl",children:[(0,s.jsxs)("div",{className:"space-y-6 max-h-[85vh] overflow-y-auto px-1",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("div",{className:"h-32 sm:h-40 bg-zinc-100 dark:bg-zinc-900 rounded-xl overflow-hidden relative group",children:[r.cover&&(0,s.jsx)("img",{src:r.cover,className:"w-full h-full object-cover",alt:""}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black/20 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)("button",{onClick:()=>u.current?.click(),className:"p-3 bg-black/60 text-white rounded-full hover:bg-black transition-all",children:(0,s.jsx)(ss,{size:20})})})]}),(0,s.jsx)("div",{className:"absolute -bottom-8 left-6",children:(0,s.jsxs)("div",{className:"relative group size-20 sm:size-24 rounded-2xl border-4 border-white dark:border-black bg-zinc-100 dark:bg-zinc-800 overflow-hidden shadow-lg",children:[(0,s.jsx)("img",{src:r.avatar,className:"size-full object-cover",alt:""}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)("button",{onClick:()=>f.current?.click(),className:"text-white p-2",children:(0,s.jsx)(ss,{size:18})})})]})})]}),(0,s.jsx)("div",{className:"pt-6",children:(0,s.jsxs)("form",{onSubmit:h,className:"space-y-5",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("label",{className:"text-sm font-bold ml-1",children:"Community Name"}),(0,s.jsx)("input",{type:"text",required:!0,className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all font-medium",value:r.name,onChange:d=>l({...r,name:d.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("label",{className:"text-sm font-bold ml-1",children:"Handle"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-zinc-500 font-medium text-sm",children:"c/"}),(0,s.jsx)("input",{type:"text",required:!0,className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl pl-8 pr-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all font-medium text-sm",value:r.handle,onChange:d=>l({...r,handle:d.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"")})})]})]}),(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("label",{className:"text-sm font-bold ml-1",children:"Description"}),(0,s.jsx)("textarea",{className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-4 py-2.5 outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all min-h-[100px] resize-none font-medium",placeholder:"What is this community about?",value:r.description,onChange:d=>l({...r,description:d.target.value})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-zinc-50 dark:bg-zinc-900 rounded-xl border border-zinc-200 dark:border-zinc-800",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-sm font-bold",children:"Private Community"}),(0,s.jsx)("span",{className:"text-[10px] text-zinc-500",children:"Only Admins can post in private communities"})]}),(0,s.jsx)("input",{type:"checkbox",className:"size-5 rounded-md accent-violet-600 cursor-pointer",checked:r.isPrivate,onChange:d=>l({...r,isPrivate:d.target.checked})})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 pt-6 py-2",children:[(0,s.jsx)(ue,{type:"button",variant:"outline",className:"flex-1 rounded-xl h-11 font-bold",onClick:e,disabled:o,children:"Cancel"}),(0,s.jsx)(ue,{type:"submit",className:"flex-1 rounded-xl h-11 font-bold bg-zinc-900 dark:bg-white text-white dark:text-black hover:bg-zinc-800 dark:hover:bg-zinc-200 transition-all active:scale-95",disabled:o||!r.name,children:o?(0,s.jsx)(oe,{size:18,className:"animate-spin"}):"Save Changes"})]})]})})]}),(0,s.jsx)("input",{type:"file",ref:f,className:"hidden",accept:"image/*",onChange:d=>m(d,"avatar")}),(0,s.jsx)("input",{type:"file",ref:u,className:"hidden",accept:"image/*",onChange:d=>m(d,"cover")})]})})}var qo=({isOpen:t,onClose:e,editProfileData:a,setEditProfileData:i})=>{const{updateProfile:n}=he(),{addToast:r}=ze(),[l,o]=(0,b.useState)(!1),[c,f]=(0,b.useState)(null),[u,m]=(0,b.useState)(null),x=(0,b.useRef)(null),h=(0,b.useRef)(null),d=(g,v)=>{const j=g.target.files[0];j&&(v==="avatar"?f(j):m(j))},p=async()=>{o(!0);try{let g=a.avatar,v=a.cover;c&&(g=(await Ae(c)).url),u&&(v=(await Ae(u)).url),await n({...a,avatar:g,cover:v}),f(null),m(null),e(),r("Profile updated!")}catch(g){console.error("Failed to update profile:",g),r("Failed to update profile.","error")}finally{o(!1)}};return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(Ke,{isOpen:t,onClose:()=>!l&&e(),title:"Edit Profile",children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("input",{type:"file",ref:h,className:"hidden",accept:"image/*",onChange:g=>d(g,"cover")}),(0,s.jsx)("input",{type:"file",ref:x,className:"hidden",accept:"image/*",onChange:g=>d(g,"avatar")}),(0,s.jsxs)("div",{className:"relative h-32 bg-zinc-100 dark:bg-zinc-800 rounded-xl overflow-hidden group cursor-pointer",onClick:()=>h.current?.click(),children:[(u||a?.cover)&&(0,s.jsx)("img",{src:u?URL.createObjectURL(u):a.cover,className:"w-full h-full object-cover opacity-60",alt:""}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("div",{className:"bg-black/50 p-2 rounded-full text-white group-hover:scale-110 transition-transform",children:(0,s.jsx)(We,{size:20})})})]}),(0,s.jsx)("div",{className:"relative -mt-16 ml-4",children:(0,s.jsxs)("div",{className:"relative size-24 rounded-full border-4 border-white dark:border-black overflow-hidden group cursor-pointer shadow-lg bg-white dark:bg-black",onClick:()=>x.current?.click(),children:[(c||a?.avatar)&&(0,s.jsxs)(ge,{className:"size-full opacity-60 rounded-none",children:[(0,s.jsx)(be,{src:c?URL.createObjectURL(c):a.avatar,className:"object-cover"}),(0,s.jsx)(ve,{children:a?.handle?.[0]?.toUpperCase()})]}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("div",{className:"bg-black/50 p-2 rounded-full text-white group-hover:scale-110 transition-transform",children:(0,s.jsx)(We,{size:16})})})]})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(Fe,{label:"Name",value:a?.name||"",onChange:g=>i({...a,name:g.target.value})}),(0,s.jsx)(Fe,{label:"Bio",textarea:!0,value:a?.bio||"",onChange:g=>i({...a,bio:g.target.value})}),(0,s.jsx)(Fe,{label:"Location",value:a?.location||"",onChange:g=>i({...a,location:g.target.value})}),(0,s.jsx)(Fe,{label:"Website",value:a?.website||"",onChange:g=>i({...a,website:g.target.value})})]}),(0,s.jsx)(ue,{className:"w-full py-3",disabled:l,onClick:p,children:l?(0,s.jsx)(oe,{size:24,className:"animate-spin text-white mx-auto"}):"Save changes"})]})})})},Wo=qo;function Uo({isOpen:t,onClose:e,community:a}){const{addToast:i}=ze(),{currentUser:n}=he(),[r,l]=(0,b.useState)([]),[o,c]=(0,b.useState)(!1),[f,u]=(0,b.useState)(""),[m,x]=(0,b.useState)("members"),[h,d]=(0,b.useState)(!1),p=n?.id===a?.creatorId,g=(0,b.useCallback)(async(N="")=>{if(a?.id){c(!0),d(!0);try{l(await Fr(a.id,N))}catch(_){console.error("Failed to load members:",_),i("Failed to load members","error")}finally{c(!1)}}},[a?.id,i]);(0,b.useEffect)(()=>{t&&a?.id?g(""):(u(""),l([]),d(!1))},[t,a?.id,g]),(0,b.useEffect)(()=>{if(f.length>=2){const N=setTimeout(()=>{g(f)},500);return()=>clearTimeout(N)}else f.length===0&&h&&g("")},[f,g,h]);const v=async(N,_)=>{try{const P=_==="admin"?"member":"admin";await Rr(a.id,N,P),l(M=>M.map(k=>k.userId===N?{...k,role:P}:k)),i(`Role updated to ${P}`)}catch{i("Failed to update role","error")}},j=(0,b.useMemo)(()=>r.filter(N=>N.role==="admin"||N.userId===a.creatorId),[r,a.creatorId]),w=(0,b.useMemo)(()=>r.filter(N=>N.role!=="admin"&&N.userId!==a.creatorId),[r,a.creatorId]),y=N=>o?(0,s.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,s.jsx)(oe,{className:"animate-spin text-violet-500",size:32})}):N.length>0?(0,s.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800/50",children:N.map(_=>(0,s.jsxs)("div",{className:"p-4 flex items-center justify-between hover:bg-white dark:hover:bg-zinc-800/50 transition-colors",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)(ge,{className:"size-10 border border-zinc-200 dark:border-zinc-700 shadow-sm",children:[(0,s.jsx)(be,{src:_.user.avatar_url}),(0,s.jsx)(ve,{children:_.user.username?.[0]?.toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex flex-col min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("span",{className:"text-sm font-bold truncate max-w-[140px] dark:text-white",children:_.user.display_name}),_.user.is_verified&&(0,s.jsx)(dt,{})]}),(0,s.jsxs)("span",{className:"text-xs text-zinc-500 font-medium",children:["@",_.user.username]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[_.userId===a.creatorId?(0,s.jsx)("span",{className:"text-[10px] font-black px-3 py-1 bg-zinc-200 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 rounded-full tracking-wider",children:"OWNER"}):p&&(0,s.jsx)("button",{onClick:()=>v(_.userId,_.role),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-full text-[11px] font-bold transition-all ${_.role==="admin"?"bg-rose-50 text-rose-600 hover:bg-rose-100 dark:bg-rose-950/20 dark:text-rose-400":"bg-zinc-100 text-zinc-600 hover:bg-zinc-200 dark:bg-zinc-800 dark:text-zinc-400 dark:hover:bg-zinc-700"}`,children:_.role==="admin"?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ws,{size:14}),"Admin"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(It,{size:14}),"Make Admin"]})}),!p&&_.role==="admin"&&_.userId!==a.creatorId&&(0,s.jsx)("span",{className:"text-[10px] font-black px-3 py-1 bg-violet-50 dark:bg-violet-900/20 text-violet-600 dark:text-violet-400 rounded-full tracking-wider",children:"ADMIN"})]})]},_.userId))}):(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-center px-6",children:[(0,s.jsx)("div",{className:"size-12 rounded-full bg-zinc-100 dark:bg-zinc-800 flex items-center justify-center mb-3",children:(0,s.jsx)(It,{size:24,className:"text-zinc-400"})}),(0,s.jsxs)("p",{className:"text-sm font-bold dark:text-white",children:["No ",m," found"]}),(0,s.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"Try a different search term"})]});return(0,s.jsx)(Ke,{isOpen:t,onClose:e,title:"Manage Members",className:"sm:max-w-md",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(Bt,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-zinc-400",size:18}),(0,s.jsx)("input",{type:"text",placeholder:"Search members...",className:"w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl pl-10 pr-4 py-2.5 text-sm outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all font-medium",value:f,onChange:N=>u(N.target.value)})]}),(0,s.jsxs)(Zt,{value:m,onValueChange:x,className:"w-full",children:[(0,s.jsxs)(Gt,{className:"w-full bg-zinc-100 dark:bg-zinc-900 p-1 rounded-xl h-11",children:[(0,s.jsxs)(mt,{value:"members",className:"flex-1 rounded-lg font-bold data-[state=active]:bg-white dark:data-[state=active]:bg-zinc-800 dark:text-zinc-400 dark:data-[state=active]:text-white",children:["Members (",w.length,")"]}),(0,s.jsxs)(mt,{value:"admins",className:"flex-1 rounded-lg font-bold data-[state=active]:bg-white dark:data-[state=active]:bg-zinc-800 dark:text-zinc-400 dark:data-[state=active]:text-white",children:["Admins (",j.length,")"]})]}),(0,s.jsxs)("div",{className:"mt-4 bg-zinc-50 dark:bg-zinc-900 rounded-2xl border border-zinc-100 dark:border-zinc-800 overflow-hidden min-h-[300px] max-h-[400px] overflow-y-auto",children:[(0,s.jsx)(ot,{value:"members",className:"m-0",children:y(w)}),(0,s.jsx)(ot,{value:"admins",className:"m-0",children:y(j)})]})]})]})})}var Bo=Q(),Vo=t=>{const e=(0,Bo.c)(22),{isPostModalOpen:a,setIsPostModalOpen:i,isEditProfileOpen:n,setIsEditProfileOpen:r,isStoryModalOpen:l,setIsStoryModalOpen:o,editProfileData:c,setEditProfileData:f,postCommunity:u}=t;let m;e[0]!==i?(m=()=>i(!1),e[0]=i,e[1]=m):m=e[1];let x;e[2]!==a||e[3]!==u||e[4]!==m?(x=(0,s.jsx)(Lo,{isOpen:a,onClose:m,initialCommunity:u}),e[2]=a,e[3]=u,e[4]=m,e[5]=x):x=e[5];let h;e[6]!==r?(h=()=>r(!1),e[6]=r,e[7]=h):h=e[7];let d;e[8]!==c||e[9]!==n||e[10]!==f||e[11]!==h?(d=(0,s.jsx)(Wo,{isOpen:n,onClose:h,editProfileData:c,setEditProfileData:f}),e[8]=c,e[9]=n,e[10]=f,e[11]=h,e[12]=d):d=e[12];let p;e[13]!==o?(p=()=>o(!1),e[13]=o,e[14]=p):p=e[14];let g;e[15]!==l||e[16]!==p?(g=(0,s.jsx)(Do,{isOpen:l,onClose:p}),e[15]=l,e[16]=p,e[17]=g):g=e[17];let v;return e[18]!==x||e[19]!==d||e[20]!==g?(v=(0,s.jsxs)(s.Fragment,{children:[x,d,g]}),e[18]=x,e[19]=d,e[20]=g,e[21]=v):v=e[21],v},Qo=Vo,Jo=Q(),Ho=t=>{const e=(0,Jo.c)(91),{story:a,onClose:i}=t,[n,r]=(0,b.useState)(0),[l,o]=(0,b.useState)(0),[c,f]=(0,b.useState)(!1),u=a.stories,m=u[n];let x;e[0]!==n||e[1]!==i||e[2]!==u.length||e[3]!==a.user.id?(x=()=>{n<u.length-1?(r(Yo),o(0)):i(a.user.id)},e[0]=n,e[1]=i,e[2]=u.length,e[3]=a.user.id,e[4]=x):x=e[4];const h=x;let d;e[5]!==n?(d=()=>{n>0&&(r(Xo),o(0))},e[5]=n,e[6]=d):d=e[6];const p=d;let g;e[7]===Symbol.for("react.memo_cache_sentinel")?(g=Y=>{Y.stopPropagation(),f(Zo)},e[7]=g):g=e[7];const v=g;let j;e[8]!==h||e[9]!==c?(j=()=>{if(c)return;const Y=setInterval(()=>{o(ae=>ae>=100?(h(),100):ae+1)},50);return()=>clearInterval(Y)},e[8]=h,e[9]=c,e[10]=j):j=e[10];let w;e[11]!==n||e[12]!==h||e[13]!==c?(w=[h,n,c],e[11]=n,e[12]=h,e[13]=c,e[14]=w):w=e[14],(0,b.useEffect)(j,w);let y;if(e[15]!==n||e[16]!==l||e[17]!==u){let Y;e[19]!==n||e[20]!==l?(Y=(ae,Z)=>(0,s.jsx)("div",{className:"flex-1 h-full bg-white/30 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full bg-white transition-all duration-100",style:{width:Z<n?"100%":Z===n?`${l}%`:"0%"}})},Z),e[19]=n,e[20]=l,e[21]=Y):Y=e[21],y=u.map(Y),e[15]=n,e[16]=l,e[17]=u,e[18]=y}else y=e[18];let N;e[22]!==y?(N=(0,s.jsx)("div",{className:"flex gap-1.5 h-0.5 w-full bg-transparent",children:y}),e[22]=y,e[23]=N):N=e[23];const _=`/u/${a.user.handle}`;let P;e[24]!==a.user.avatar||e[25]!==a.user.handle?(P=(0,s.jsx)(be,{src:a.user.avatar,alt:a.user.handle,className:"object-cover"}),e[24]=a.user.avatar,e[25]=a.user.handle,e[26]=P):P=e[26];let M;e[27]!==a.user.handle?.[0]?(M=a.user.handle?.[0]?.toUpperCase(),e[27]=a.user.handle?.[0],e[28]=M):M=e[28];let k;e[29]!==M?(k=(0,s.jsx)(ve,{children:M}),e[29]=M,e[30]=k):k=e[30];let A;e[31]!==k||e[32]!==P?(A=(0,s.jsxs)(ge,{className:"size-10 border border-white/20 shadow-sm",children:[P,k]}),e[31]=k,e[32]=P,e[33]=A):A=e[33];let S;e[34]!==a.user.handle?(S=(0,s.jsx)("span",{className:"text-white text-sm font-bold shadow-black drop-shadow-md",children:a.user.handle}),e[34]=a.user.handle,e[35]=S):S=e[35];let I;e[36]!==m.created_at?(I=new Date(m.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),e[36]=m.created_at,e[37]=I):I=e[37];let L;e[38]!==I?(L=(0,s.jsx)("span",{className:"text-white/60 text-[10px] shadow-black drop-shadow-md",children:I}),e[38]=I,e[39]=L):L=e[39];let $;e[40]!==S||e[41]!==L?($=(0,s.jsxs)("div",{className:"flex flex-col",children:[S,L]}),e[40]=S,e[41]=L,e[42]=$):$=e[42];let R;e[43]!==A||e[44]!==$||e[45]!==_?(R=(0,s.jsxs)(Wt,{to:_,className:"flex items-center gap-3 hover:opacity-80 transition-opacity",onClick:Go,children:[A,$]}),e[43]=A,e[44]=$,e[45]=_,e[46]=R):R=e[46];let E;e[47]!==i||e[48]!==a.user.id?(E=()=>i(a.user.id),e[47]=i,e[48]=a.user.id,e[49]=E):E=e[49];let O;e[50]===Symbol.for("react.memo_cache_sentinel")?(O=(0,s.jsx)($e,{size:24}),e[50]=O):O=e[50];let F;e[51]!==E?(F=(0,s.jsx)("button",{onClick:E,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors",children:O}),e[51]=E,e[52]=F):F=e[52];let z;e[53]!==R||e[54]!==F?(z=(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[R,F]}),e[53]=R,e[54]=F,e[55]=z):z=e[55];let C;e[56]!==z||e[57]!==N?(C=(0,s.jsxs)("div",{className:"absolute top-0 left-0 right-0 p-4 z-20 flex flex-col gap-4",children:[N,z]}),e[56]=z,e[57]=N,e[58]=C):C=e[58];let T;e[59]!==n||e[60]!==p?(T=n>0&&(0,s.jsx)("button",{onClick:Y=>{Y.stopPropagation(),p()},className:"absolute left-4 z-30 p-2 bg-black/20 hover:bg-black/40 rounded-full text-white backdrop-blur-md transition-all active:scale-90",children:(0,s.jsx)(Is,{size:32})}),e[59]=n,e[60]=p,e[61]=T):T=e[61];let B;e[62]!==m.id||e[63]!==m.media?(B=(0,s.jsx)("img",{src:m.media,className:"max-w-full max-h-full object-contain rounded-xl shadow-2xl animate-in fade-in zoom-in-95 duration-300",alt:""},m.id),e[62]=m.id,e[63]=m.media,e[64]=B):B=e[64];let W;e[65]!==c?(W=c&&(0,s.jsx)("div",{className:"absolute inset-0 z-10 flex items-center justify-center pointer-events-none",children:(0,s.jsx)("div",{className:"px-4 py-2 bg-black/40 rounded-full text-white text-xs font-bold backdrop-blur-md border border-white/10 animate-in fade-in zoom-in duration-200",children:"PAUSED"})}),e[65]=c,e[66]=W):W=e[66];let J;e[67]!==B||e[68]!==W?(J=(0,s.jsxs)("div",{className:"relative w-full h-full flex items-center justify-center",children:[B,W]}),e[67]=B,e[68]=W,e[69]=J):J=e[69];let K;e[70]!==h?(K=Y=>{Y.stopPropagation(),h()},e[70]=h,e[71]=K):K=e[71];let G;e[72]===Symbol.for("react.memo_cache_sentinel")?(G=(0,s.jsx)(Xe,{size:32}),e[72]=G):G=e[72];let ne;e[73]!==K?(ne=(0,s.jsx)("button",{onClick:K,className:"absolute right-4 z-30 p-2 bg-black/20 hover:bg-black/40 rounded-full text-white backdrop-blur-md transition-all active:scale-90",children:G}),e[73]=K,e[74]=ne):ne=e[74];let se;e[75]!==p?(se=(0,s.jsx)("div",{className:"w-[30%] cursor-w-resize",onClick:p}),e[75]=p,e[76]=se):se=e[76];let le;e[77]===Symbol.for("react.memo_cache_sentinel")?(le=(0,s.jsx)("div",{className:"w-[40%] cursor-pointer flex items-center justify-center",onClick:v}),e[77]=le):le=e[77];let X;e[78]!==h?(X=(0,s.jsx)("div",{className:"w-[30%] cursor-e-resize",onClick:h}),e[78]=h,e[79]=X):X=e[79];let ee;e[80]!==se||e[81]!==X?(ee=(0,s.jsxs)("div",{className:"absolute inset-0 flex z-20",children:[se,le,X]}),e[80]=se,e[81]=X,e[82]=ee):ee=e[82];let q;e[83]!==T||e[84]!==J||e[85]!==ne||e[86]!==ee?(q=(0,s.jsxs)("div",{className:"w-full h-full max-w-xl relative flex items-center justify-center p-2",children:[T,J,ne,ee]}),e[83]=T,e[84]=J,e[85]=ne,e[86]=ee,e[87]=q):q=e[87];let V;return e[88]!==C||e[89]!==q?(V=(0,s.jsxs)("div",{className:"fixed inset-0 z-[100] bg-black flex flex-col items-center justify-center animate-in fade-in duration-300",children:[C,q]}),e[88]=C,e[89]=q,e[90]=V):V=e[90],V},Ko=Ho;function Yo(t){return t+1}function Xo(t){return t-1}function Zo(t){return!t}function Go(t){return t.stopPropagation()}var ec=({type:t,onComplete:e,onSwitch:a})=>{const{login:i,signup:n}=he(),{addToast:r}=ze(),[l,o]=(0,b.useState)({name:"",email:"",username:"",password:""}),[c,f]=(0,b.useState)(!1),[u,m]=(0,b.useState)(null),x=async h=>{h.preventDefault(),f(!0),m(null);try{t==="login"?(await i({email:l.email,password:l.password}),r("Welcome back!"),e()):(await n({email:l.email,password:l.password,username:l.username,name:l.name}),r("Confirm Your Email","info"),a())}catch(d){console.error("Auth error:",d),m(d.message||"Authentication failed. Please check your credentials."),r("Authentication failed!")}finally{f(!1)}};return(0,s.jsxs)("div",{className:"max-w-md mx-auto p-8 w-full animate-in fade-in slide-in-from-bottom-5 duration-300",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("div",{className:"flex justify-center mb-4",children:(0,s.jsx)("div",{className:"bg-black dark:bg-white dark:text-black text-white p-3 rounded-2xl shadow-lg",children:(0,s.jsx)("img",{src:"/logo.webp",alt:"Logo",className:"size-16 rounded-2xl shadow-xl border-2 border-zinc-100 dark:border-zinc-800"})})}),(0,s.jsx)("h2",{className:"text-3xl font-extrabold mb-2 dark:text-white tracking-tight",children:t==="login"?"Welcome back!":"Join Sysm today"}),(0,s.jsx)("p",{className:"text-zinc-500 font-medium",children:"The decentralized social network"})]}),u&&(0,s.jsxs)("div",{className:"mb-6 p-4 bg-rose-50 dark:bg-rose-900/20 border border-rose-100 dark:border-rose-800 rounded-xl flex items-center gap-3 text-rose-600 dark:text-rose-400 text-sm",children:[(0,s.jsx)(zs,{size:18}),(0,s.jsx)("span",{children:u})]}),(0,s.jsxs)("form",{onSubmit:x,className:"space-y-4",children:[(0,s.jsx)(Fe,{label:"Email",type:"email",placeholder:"john@example.com",value:l.email,onChange:h=>o({...l,email:h.target.value}),required:!0}),t==="signup"&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Fe,{label:"Name",placeholder:"John Doe",value:l.name,onChange:h=>o({...l,name:h.target.value}),required:!0}),(0,s.jsx)(Fe,{label:"Username",placeholder:"johndoe",value:l.username,onChange:h=>{const d=h.target.value.replace(/[^a-zA-Z0-9_]/g,"");o({...l,username:d})},required:!0})]}),(0,s.jsx)(Fe,{label:"Password",type:"password",placeholder:"",value:l.password,onChange:h=>o({...l,password:h.target.value}),required:!0}),(0,s.jsx)(ue,{type:"submit",className:"w-full justify-center py-3 mt-6 text-lg",disabled:c,children:c?(0,s.jsx)(oe,{size:24,className:"animate-spin"}):t==="login"?"Log in":"Sign up"})]}),(0,s.jsxs)("div",{className:"mt-8 text-center text-sm",children:[(0,s.jsx)("span",{className:"text-zinc-500",children:t==="login"?"Don't have an account?":"Already have an account?"}),(0,s.jsx)("button",{onClick:a,className:"font-bold ml-1 hover:underline dark:text-white",children:t==="login"?"Sign up":"Log in"})]})]})},tc=ec,sc=Q(),ac=t=>{const e=(0,sc.c)(20),{icon:a,count:i,label:n,onClick:r,active:l,activeColorClass:o}=t,c=o===void 0?"text-violet-600":o,f=a;let u;e[0]!==r?(u=y=>{y.stopPropagation(),r&&r(y)},e[0]=r,e[1]=u):u=e[1];const m=`group flex items-center gap-x-1 sm:gap-x-1.5 text-[12px] sm:text-[13px] font-bold transition-all py-1.5 px-2 -ml-2 rounded-xl active:scale-95 ${l?c:"text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-300"}`,x=`rounded-full p-2 transition-colors ${l?"":"group-hover:bg-zinc-100 dark:group-hover:bg-zinc-800"}`,h=l?2.5:2,d=l?"fill-current":"";let p;e[2]!==f||e[3]!==h||e[4]!==d?(p=(0,s.jsx)(f,{size:18,strokeWidth:h,className:d}),e[2]=f,e[3]=h,e[4]=d,e[5]=p):p=e[5];let g;e[6]!==x||e[7]!==p?(g=(0,s.jsx)("div",{className:x,children:p}),e[6]=x,e[7]=p,e[8]=g):g=e[8];let v;e[9]!==n?(v=n&&(0,s.jsx)("span",{className:"hidden xs:inline",children:n}),e[9]=n,e[10]=v):v=e[10];let j;e[11]!==l||e[12]!==i?(j=i!=null&&(0,s.jsx)("span",{className:l?"font-bold":"",children:i||0}),e[11]=l,e[12]=i,e[13]=j):j=e[13];let w;return e[14]!==j||e[15]!==u||e[16]!==m||e[17]!==g||e[18]!==v?(w=(0,s.jsxs)("button",{onClick:u,className:m,children:[g,v,j]}),e[14]=j,e[15]=u,e[16]=m,e[17]=g,e[18]=v,e[19]=w):w=e[19],w},it=ac,ic=Q(),nc=t=>{const e=(0,ic.c)(51),{currentUser:a,newComment:i,setNewComment:n,handleSubmitComment:r,loading:l,selectedFiles:o,setSelectedFiles:c,isUploading:f}=t;let u;e[0]!==o?(u=o===void 0?[]:o,e[0]=o,e[1]=u):u=e[1];const m=u,x=(0,b.useRef)(null);let h;e[2]!==c?(h=O=>{const F=Array.from(O.target.files);c&&c(z=>[...z,...F])},e[2]=c,e[3]=h):h=e[3];const d=h;let p;e[4]!==c?(p=O=>{c&&c(F=>F.filter((z,C)=>C!==O))},e[4]=c,e[5]=p):p=e[5];const g=p;if(!a){let O;return e[6]===Symbol.for("react.memo_cache_sentinel")?(O=(0,s.jsx)("div",{className:"p-6 text-center border-y border-zinc-100 dark:border-zinc-800 bg-zinc-50/30 dark:bg-zinc-900/10",children:(0,s.jsx)("p",{className:"text-zinc-500 text-sm",children:"Please login to join the conversation."})}),e[6]=O):O=e[6],O}let v;e[7]!==a.avatar||e[8]!==a.handle?(v=(0,s.jsx)(be,{src:a.avatar,alt:a.handle,className:"object-cover"}),e[7]=a.avatar,e[8]=a.handle,e[9]=v):v=e[9];let j;e[10]!==a.handle?.[0]?(j=a.handle?.[0]?.toUpperCase(),e[10]=a.handle?.[0],e[11]=j):j=e[11];let w;e[12]!==j?(w=(0,s.jsx)(ve,{children:j}),e[12]=j,e[13]=w):w=e[13];let y;e[14]!==v||e[15]!==w?(y=(0,s.jsxs)(ge,{className:"size-9 border border-zinc-200 dark:border-zinc-700",children:[v,w]}),e[14]=v,e[15]=w,e[16]=y):y=e[16];let N;e[17]!==n?(N=O=>n(O.target.value),e[17]=n,e[18]=N):N=e[18];let _;e[19]!==i||e[20]!==N?(_=(0,s.jsx)("textarea",{id:"comment-input",className:"w-full bg-transparent outline-none text-base min-h-[60px] resize-none dark:text-white placeholder:text-zinc-500",placeholder:"Post your reply...",value:i,onChange:N}),e[19]=i,e[20]=N,e[21]=_):_=e[21];let P;e[22]!==g||e[23]!==m?(P=m.length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mt-2 mb-2",children:m.map((O,F)=>(0,s.jsxs)("div",{className:"relative size-20 rounded-xl overflow-hidden border border-zinc-200 dark:border-zinc-800",children:[O.type.startsWith("image/")?(0,s.jsx)("img",{src:URL.createObjectURL(O),className:"size-full object-cover",alt:""}):(0,s.jsx)("div",{className:"size-full flex items-center justify-center bg-zinc-100 dark:bg-zinc-800",children:(0,s.jsx)(Ws,{size:20,className:"text-zinc-500"})}),(0,s.jsx)("button",{onClick:()=>g(F),className:"absolute top-1 right-1 bg-black/60 text-white rounded-full p-1 hover:bg-black transition-colors",children:(0,s.jsx)($e,{size:12})})]},F))}),e[22]=g,e[23]=m,e[24]=P):P=e[24];let M;e[25]===Symbol.for("react.memo_cache_sentinel")?(M=()=>x.current?.click(),e[25]=M):M=e[25];let k;e[26]===Symbol.for("react.memo_cache_sentinel")?(k=(0,s.jsx)("button",{type:"button",onClick:M,className:"text-violet-600 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full p-2 transition-colors",title:"Attach media",children:(0,s.jsx)(Rs,{size:20})}),e[26]=k):k=e[26];let A;e[27]!==d?(A=(0,s.jsxs)("div",{className:"flex text-violet-600 gap-1",children:[k,(0,s.jsx)("input",{type:"file",ref:x,onChange:d,multiple:!0,className:"hidden",accept:"image/*,video/*,application/pdf"})]}),e[27]=d,e[28]=A):A=e[28];let S;e[29]!==f||e[30]!==l||e[31]!==i||e[32]!==m.length?(S=!i.trim()&&m.length===0||l||f,e[29]=f,e[30]=l,e[31]=i,e[32]=m.length,e[33]=S):S=e[33];let I;e[34]!==f||e[35]!==l?(I=l||f?(0,s.jsx)(oe,{size:16,className:"animate-spin text-white mx-auto"}):"Reply",e[34]=f,e[35]=l,e[36]=I):I=e[36];let L;e[37]!==r||e[38]!==S||e[39]!==I?(L=(0,s.jsx)(ue,{className:"!w-auto px-5 py-1.5 text-sm font-bold min-w-[70px]",onClick:r,disabled:S,children:I}),e[37]=r,e[38]=S,e[39]=I,e[40]=L):L=e[40];let $;e[41]!==A||e[42]!==L?($=(0,s.jsxs)("div",{className:"flex justify-between items-center mt-2 pt-3 border-t border-zinc-100 dark:border-zinc-800",children:[A,L]}),e[41]=A,e[42]=L,e[43]=$):$=e[43];let R;e[44]!==_||e[45]!==P||e[46]!==$?(R=(0,s.jsxs)("div",{className:"flex-1",children:[_,P,$]}),e[44]=_,e[45]=P,e[46]=$,e[47]=R):R=e[47];let E;return e[48]!==R||e[49]!==y?(E=(0,s.jsx)("div",{className:"p-4 border-y border-zinc-100 dark:border-zinc-800 bg-zinc-50/30 dark:bg-zinc-900/10",children:(0,s.jsxs)("div",{className:"flex gap-3",children:[y,R]})}),e[48]=R,e[49]=y,e[50]=E):E=e[50],E},Ea=nc,rc=Q(),lc=t=>{const e=(0,rc.c)(17),{file:a}=t;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsx)("div",{className:"size-10 rounded-xl bg-violet-100 dark:bg-violet-900/30 flex items-center justify-center text-violet-600",children:(0,s.jsx)(Ps,{size:20})}),e[0]=i):i=e[0];let n;e[1]!==a.name?(n=(0,s.jsx)("div",{className:"text-sm font-bold truncate dark:text-white",children:a.name}),e[1]=a.name,e[2]=n):n=e[2];const r=a.size/1024/1024;let l;e[3]!==r?(l=r.toFixed(2),e[3]=r,e[4]=l):l=e[4];let o;e[5]!==l?(o=(0,s.jsxs)("div",{className:"text-xs text-zinc-500 uppercase",children:[l," MB"]}),e[5]=l,e[6]=o):o=e[6];let c;e[7]!==n||e[8]!==o?(c=(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[n,o]}),e[7]=n,e[8]=o,e[9]=c):c=e[9];let f;e[10]===Symbol.for("react.memo_cache_sentinel")?(f=(0,s.jsx)(Ss,{size:18}),e[10]=f):f=e[10];let u;e[11]!==a.name||e[12]!==a.url?(u=(0,s.jsx)("a",{href:a.url,download:a.name,className:"p-2 text-zinc-400 hover:text-violet-600 transition-colors",onClick:cc,children:f}),e[11]=a.name,e[12]=a.url,e[13]=u):u=e[13];let m;return e[14]!==c||e[15]!==u?(m=(0,s.jsxs)("div",{className:"mt-3 flex items-center gap-3 p-3 rounded-2xl border border-zinc-100 dark:border-zinc-800 bg-zinc-50/50 dark:bg-zinc-900/10 group hover:border-violet-500/30 transition-colors",children:[i,c,u]}),e[14]=c,e[15]=u,e[16]=m):m=e[16],m},oc=lc;function cc(t){return t.stopPropagation()}var r0=Q(),dc=Q(),mc=t=>{const e=(0,dc.c)(30),{url:a}=t;let i,n;e[0]!==a?(i=["link-preview",a],n=()=>Lr(a),e[0]=a,e[1]=i,e[2]=n):(i=e[1],n=e[2]);const r=!!a;let l;e[3]!==i||e[4]!==n||e[5]!==r?(l={queryKey:i,queryFn:n,staleTime:864e5,enabled:r},e[3]=i,e[4]=n,e[5]=r,e[6]=l):l=e[6];const{data:o,isLoading:c,isError:f}=Re(l);if(c){let w;return e[7]===Symbol.for("react.memo_cache_sentinel")?(w=(0,s.jsx)("div",{className:"mt-3 rounded-2xl border border-zinc-100 dark:border-zinc-800 overflow-hidden animate-pulse bg-zinc-50 dark:bg-zinc-900/50 h-24 flex items-center justify-center",children:(0,s.jsx)(Nt,{className:"text-zinc-300 dark:text-zinc-700 animate-spin",size:24})}),e[7]=w):w=e[7],w}if(f||!o||!o.title&&!o.image)return null;let u;e[8]!==o.image||e[9]!==o.title?(u=o.image&&(0,s.jsx)("div",{className:"w-full aspect-[1.91/1] overflow-hidden bg-zinc-100 dark:bg-zinc-900 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)("img",{src:o.image,alt:o.title,className:"w-full h-full object-cover group-hover:scale-[1.02] transition-transform duration-500",onError:fc})}),e[8]=o.image,e[9]=o.title,e[10]=u):u=e[10];let m;e[11]===Symbol.for("react.memo_cache_sentinel")?(m=(0,s.jsx)(Nt,{size:12}),e[11]=m):m=e[11];let x;e[12]!==o.siteName?(x=(0,s.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-zinc-500 font-bold uppercase tracking-wider",children:[m,(0,s.jsx)("span",{children:o.siteName})]}),e[12]=o.siteName,e[13]=x):x=e[13];let h;e[14]!==o.title?(h=(0,s.jsx)("h4",{className:"font-bold text-[15px] line-clamp-2 dark:text-white leading-snug group-hover:text-violet-600 transition-colors",children:o.title}),e[14]=o.title,e[15]=h):h=e[15];let d;e[16]!==o.description?(d=o.description&&(0,s.jsx)("p",{className:"text-xs text-zinc-500 dark:text-zinc-400 line-clamp-2 leading-relaxed",children:o.description}),e[16]=o.description,e[17]=d):d=e[17];let p;e[18]===Symbol.for("react.memo_cache_sentinel")?(p=(0,s.jsx)(bi,{size:10}),e[18]=p):p=e[18];let g;e[19]!==a?(g=(0,s.jsxs)("div",{className:"pt-1 flex items-center gap-1 text-[11px] text-zinc-400 font-medium",children:[p,(0,s.jsx)("span",{className:"truncate",children:a})]}),e[19]=a,e[20]=g):g=e[20];let v;e[21]!==g||e[22]!==x||e[23]!==h||e[24]!==d?(v=(0,s.jsxs)("div",{className:"p-3.5 space-y-1",children:[x,h,d,g]}),e[21]=g,e[22]=x,e[23]=h,e[24]=d,e[25]=v):v=e[25];let j;return e[26]!==v||e[27]!==u||e[28]!==a?(j=(0,s.jsxs)("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"mt-3 flex flex-col rounded-2xl border border-zinc-100 dark:border-zinc-800 overflow-hidden bg-white dark:bg-zinc-950 hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-all group shadow-sm",onClick:uc,children:[u,v]}),e[26]=v,e[27]=u,e[28]=a,e[29]=j):j=e[29],j},hs=mc;function uc(t){return t.stopPropagation()}function fc(t){return t.target.style.display="none"}var xc=Q(),hc=t=>{const e=(0,xc.c)(17),{src:a,poster:i}=t,n=(0,b.useRef)(null),{reportVisibility:r,unregister:l}=nl(),{dataSaver:o}=pt(),c=(0,b.useId)();let f;e[0]===Symbol.for("react.memo_cache_sentinel")?(f={play:()=>{const w=n.current?.plyr;w&&(w.muted=!0,w.play().catch(gc))},pause:()=>{n.current?.plyr?.pause()}},e[0]=f):f=e[0];const u=f;let m,x;e[1]!==o||e[2]!==c||e[3]!==r||e[4]!==l?(m=()=>{const w=new IntersectionObserver(N=>{const[_]=N;r(c,o?0:_.intersectionRatio,u)},{threshold:[0,.6]}),y=n.current?.elements?.container;return y&&w.observe(y),()=>{l(c),y&&w.unobserve(y)}},x=[c,r,l,u,o],e[1]=o,e[2]=c,e[3]=r,e[4]=l,e[5]=m,e[6]=x):(m=e[5],x=e[6]),(0,b.useEffect)(m,x);let h;e[7]!==a?(h=[{src:a,type:"video/mp4"}],e[7]=a,e[8]=h):h=e[8];let d;e[9]!==i||e[10]!==h?(d={type:"video",sources:h,poster:i},e[9]=i,e[10]=h,e[11]=d):d=e[11];let p;e[12]===Symbol.for("react.memo_cache_sentinel")?(p={controls:["play-large","play","progress","current-time","mute","volume","fullscreen"],settings:["quality","speed"],ratio:"16:9",clickToPlay:!0,hideControls:!0,resetOnEnd:!0},e[12]=p):p=e[12];let g;e[13]!==d?(g={source:d,options:p},e[13]=d,e[14]=g):g=e[14];const v=g;let j;return e[15]!==v?(j=(0,s.jsx)("div",{className:"mt-3 overflow-hidden rounded-2xl shadow-sm border border-zinc-100 dark:border-zinc-800 bg-black",onClick:bc,children:(0,s.jsx)(Qs,{ref:n,...v})}),e[15]=v,e[16]=j):j=e[16],j},pc=hc;function gc(){}function bc(t){return t.stopPropagation()}var vc=Q(),jc=t=>{const e=(0,vc.c)(3),{items:a}=t,i=a===void 0?[]:a,{openLightbox:n}=Qt();if(!i||i.length===0)return null;const r=Array.isArray(i)?i:[i],l=r.filter(yc),o=r.filter(zc),c=h=>{const d=l.filter(Nc).map(kc),p=l[h];n(d,d.indexOf(p.url||p.src))},f="mt-3 space-y-2",u=l.length>0&&(0,s.jsx)("div",{className:`grid gap-2 rounded-2xl overflow-hidden border border-zinc-100 dark:border-zinc-800 ${l.length===1?"grid-cols-1":l.length===2?"grid-cols-2 aspect-[16/9]":(l.length===3,"grid-cols-2 grid-rows-2 aspect-[16/9]")}`,children:l.map((h,d)=>(0,s.jsx)("div",{className:`relative overflow-hidden bg-zinc-100 dark:bg-zinc-900 cursor-pointer ${l.length===3&&d===0?"row-span-2":""}`,onClick:p=>{h.type==="image"&&(p.stopPropagation(),c(d))},children:h.type==="video"?(0,s.jsx)(pc,{src:h.url,poster:h.poster}):(0,s.jsx)("img",{src:h.url||h.src,className:"size-full object-cover hover:scale-[1.02] transition-transform duration-500",alt:"",loading:"lazy"})},d))}),m=o.map(_c);let x;return e[0]!==u||e[1]!==m?(x=(0,s.jsxs)("div",{className:f,children:[u,m]}),e[0]=u,e[1]=m,e[2]=x):x=e[2],x},wc=jc;function yc(t){return t.type==="image"||t.type==="video"}function zc(t){return t.type==="file"}function Nc(t){return t.type==="image"}function kc(t){return t.url||t.src}function _c(t,e){return(0,s.jsx)(oc,{file:t},e)}var Cc=Q(),Sc=t=>{const e=(0,Cc.c)(18),{poll:a,onVote:i}=t,n=a.options.reduce(Pc,0),[r,l]=(0,b.useState)(null);let o;e[0]!==i||e[1]!==r?(o=d=>{r||(l(d),i&&i(d))},e[0]=i,e[1]=r,e[2]=o):o=e[2];const c=o;let f;if(e[3]!==c||e[4]!==a.options||e[5]!==n||e[6]!==r){let d;e[8]!==c||e[9]!==n||e[10]!==r?(d=(p,g)=>{const v=n>0?Math.round((p.votes+(r===p.id?1:0))/(n+(r?1:0))*100):0,j=r===p.id;return(0,s.jsxs)("div",{onClick:w=>{w.stopPropagation(),c(p.id)},className:`relative h-10 w-full rounded-xl overflow-hidden cursor-pointer border ${j?"border-violet-500 dark:border-violet-500":"border-zinc-200 dark:border-zinc-700"}`,children:[r&&(0,s.jsx)("div",{className:"absolute top-0 left-0 h-full bg-zinc-200 dark:bg-zinc-800 transition-all duration-500",style:{width:`${v}%`}}),(0,s.jsxs)("div",{className:"absolute inset-0 flex items-center justify-between px-4 z-10",children:[(0,s.jsxs)("span",{className:`font-medium text-sm ${j?"text-violet-600 font-bold":"text-zinc-700 dark:text-zinc-200"}`,children:[p.text," ",j&&(0,s.jsx)(Hs,{size:14,className:"inline ml-1 mb-0.5"})]}),r&&(0,s.jsxs)("span",{className:"text-sm font-bold text-zinc-900 dark:text-white",children:[v,"%"]})]})]},p.id||g)},e[8]=c,e[9]=n,e[10]=r,e[11]=d):d=e[11],f=a.options.map(d),e[3]=c,e[4]=a.options,e[5]=n,e[6]=r,e[7]=f}else f=e[7];const u=n+(r?1:0),m=r?"6 days left":"Click to vote";let x;e[12]!==u||e[13]!==m?(x=(0,s.jsxs)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400 pl-1",children:[u," votes "," ",m]}),e[12]=u,e[13]=m,e[14]=x):x=e[14];let h;return e[15]!==f||e[16]!==x?(h=(0,s.jsxs)("div",{className:"mt-3 space-y-2",children:[f,x]}),e[15]=f,e[16]=x,e[17]=h):h=e[17],h},ps=Sc;function Pc(t,e){return t+e.votes}const bt={formatHref:(t,e)=>e==="mention"?`/u/${t.substring(1)}`:e==="hashtag"?`/tags/${t.substring(1)}`:t,attributes:{onClick:t=>t.stopPropagation(),className:"text-rose-500 dark:text-rose-400 font-bold hover:underline cursor-pointer"},target:(t,e)=>e==="url"?"_blank":null,rel:(t,e)=>e==="url"?"noopener noreferrer":null},$c=(t,e,a,i)=>{const[n,r]=(0,b.useState)(!1),[l,o]=(0,b.useState)(!1),[c,f]=(0,b.useState)(e||{comments:0,likes:0,mirrors:0});return(0,b.useEffect)(()=>{a&&t&&Pe(t)&&Pe(a.id)&&(sa(t,a.id).then(r).catch(()=>r(!1)),mr(t,a.id).then(o).catch(()=>o(!1)))},[t,a]),{liked:n,reposted:l,localStats:c,setLocalStats:f,handleLike:async x=>{if(x&&x.stopPropagation(),!a)return i("Please login to like!","error");if(!Pe(t)||!Pe(a.id)){const h=!n;r(h),f(d=>({...d,likes:h?(d.likes||0)+1:(d.likes||0)-1}));return}try{const h=await Dt(t,a.id);r(h),f(d=>({...d,likes:h?(d.likes||0)+1:(d.likes||0)-1}))}catch(h){console.error("Failed to toggle like:",h)}},handleRepost:async x=>{if(x&&x.stopPropagation(),!a)return i("Please login to repost!","error");if(!Pe(t)||!Pe(a.id)){const h=!l;o(h),f(d=>({...d,mirrors:h?(d.mirrors||0)+1:(d.mirrors||0)-1}));return}try{const h=await dr(t,a.id);o(h),f(d=>({...d,mirrors:h?(d.mirrors||0)+1:(d.mirrors||0)-1})),i(h?"Reposted!":"Removed repost")}catch(h){console.error("Failed to toggle repost:",h),i("Failed to update repost","error")}}}};var Ac=Q();const Ia=t=>{const e=(0,Ac.c)(5);let a;e[0]!==t?(a=()=>nt(t),e[0]=t,e[1]=a):a=e[1];const[i,n]=(0,b.useState)(a);let r,l;return e[2]!==t?(r=()=>{if(!t)return;const o=setTimeout(()=>{n(nt(t))},0),c=setInterval(()=>{n(nt(t))},6e4);return()=>{clearTimeout(o),clearInterval(c)}},l=[t],e[2]=t,e[3]=r,e[4]=l):(r=e[3],l=e[4]),(0,b.useEffect)(r,l),i},Mc=()=>{const{handle:t}=ut(),e=je(),{profiles:a,currentUser:i,getProfileByHandle:n}=he(),{addToast:r}=ze(),[l,o]=(0,b.useState)(a[t?.toLowerCase()]),[c,f]=(0,b.useState)(!l),[u,m]=(0,b.useState)([]),[x,h]=(0,b.useState)("feed"),[d,p]=(0,b.useState)(!0),[g,v]=(0,b.useState)(!1),[j,w]=(0,b.useState)(!0),y=(0,b.useRef)(u);(0,b.useEffect)(()=>{y.current=u},[u]);const[N,_]=(0,b.useState)(!1),[P,M]=(0,b.useState)("Followers"),[k,A]=(0,b.useState)([]),[S,I]=(0,b.useState)(!1),[L,$]=(0,b.useState)(!1),[R,E]=(0,b.useState)(!0),O=(0,b.useRef)(k);(0,b.useEffect)(()=>{O.current=k},[k]);const F=(0,b.useCallback)(async(W,J=!1)=>{if(W){J?v(!0):p(!0);try{const K=y.current,G=await rr(W,J&&K.length>0?K[K.length-1].created_at:null,10);G.length<10?w(!1):w(!0),m(J?ne=>[...ne,...G]:G)}catch(K){console.error("Failed to fetch user posts:",K)}finally{p(!1),v(!1)}}},[]),z=async(W,J=!1)=>{const K=l?.id;if(K){J?$(!0):(M(W),_(!0),I(!0),A([]));try{const G=O.current,ne=J&&G.length>0?G[G.length-1].followed_at:null,se=W==="Followers"?await tr(K,ne,10):await sr(K,ne,10);se.length<10?E(!1):E(!0),A(J?le=>[...le,...se]:se)}catch(G){console.error(`Failed to fetch ${W}:`,G),r(`Failed to load ${W}`)}finally{I(!1),$(!1)}}};(0,b.useEffect)(()=>{(async()=>{let J=a[t?.toLowerCase()];J?o(J):(f(!0),J=await n(t),o(J),f(!1)),J?.id&&F(J.id)})()},[t,a,n,F]);const C=(0,b.useMemo)(()=>x==="feed"?u.filter(W=>W.community_id===null&&W.parent_id===null):x==="media"?u.filter(W=>W.community_id===null&&W.parent_id===null&&(W.type==="video"||W.type==="image"||W.media&&W.media.length>0)):x==="collections"?[]:u,[u,x]);return{handle:t,profile:l,loading:c,userPosts:u,setUserPosts:m,activeProfileTab:x,setActiveProfileTab:h,loadingPosts:d,isFetchingMorePosts:g,hasMorePosts:j,filteredPosts:C,isFollowModalOpen:N,setIsFollowModalOpen:_,followModalType:P,followListData:k,isListLoading:S,isFetchingMoreFollows:L,hasMoreFollows:R,openFollowModal:z,handlePostClick:W=>{e(`/post/${W}`)},handleUserClick:W=>{W!==t&&e(`/u/${W}`)},loadUserPosts:F,currentUser:i,addToast:r,navigate:e}},Fc=()=>{const{handle:t}=ut(),e=je(),{currentUser:a}=he(),{addToast:i}=ze(),[n,r]=(0,b.useState)(null),[l,o]=(0,b.useState)(!0),[c,f]=(0,b.useState)(!1),[u,m]=(0,b.useState)(null),[x,h]=(0,b.useState)(!1),[d,p]=(0,b.useState)([]),[g,v]=(0,b.useState)(!0),[j,w]=(0,b.useState)(!1),[y,N]=(0,b.useState)(!0),_=(0,b.useRef)(d);(0,b.useEffect)(()=>{_.current=d},[d]);const P=(0,b.useCallback)(async(k,A=!1)=>{if(k){A?w(!0):v(!0);try{const S=_.current,I=await Pr(k,A&&S.length>0?S[S.length-1].sort_timestamp:null,10);I.length<10?N(!1):N(!0),p(A?L=>[...L,...I]:I)}catch(S){console.error("Failed to fetch community posts:",S)}finally{v(!1),w(!1)}}},[]);return(0,b.useEffect)(()=>{(async()=>{o(!0);try{const A=await Sr(t);if(r(A),A?.id&&(P(A.id),a)){const S=await na(A.id,a.id);f(!!S),m(S?.role||null)}}catch{}finally{o(!1)}})()},[t,a,P]),{community:n,loading:l,isMember:c,userRole:u,isJoining:x,communityPosts:d,loadingPosts:g,isFetchingMorePosts:j,hasMorePosts:y,handleJoinToggle:async()=>{if(!a)return i("Please login to join communities","error");h(!0);try{const k=await ia(n.id,a.id);f(k),m(k?"member":null),r(A=>({...A,membersCount:k?A.membersCount+1:A.membersCount-1})),i(k?`Joined ${n.name}`:`Left ${n.name}`)}catch{i("Failed to update membership","error")}finally{h(!1)}},loadCommunityPosts:P,currentUser:a,addToast:i,navigate:e}},Rc=()=>{const{currentUser:t}=he(),e=je(),a=ft(),i=new URLSearchParams(a.search),n=i.get("q")||"",r=i.get("tab")||(n?"posts":"communities"),[l,o]=(0,b.useState)(n),[c,f]=(0,b.useState)(r),[u,m]=(0,b.useState)(!1),[x,h]=(0,b.useState)([]),[d,p]=(0,b.useState)(!0),[g,v]=(0,b.useState)(!1),[j,w]=(0,b.useState)(!0),y=(0,b.useRef)(x),[N,_]=(0,b.useState)([]),[P,M]=(0,b.useState)(!1),[k,A]=(0,b.useState)(!1),[S,I]=(0,b.useState)(!0),L=(0,b.useRef)(N);(0,b.useEffect)(()=>{y.current=x},[x]),(0,b.useEffect)(()=>{L.current=N},[N]),(0,b.useEffect)(()=>{n!==l&&(o(n),n&&f("posts"))},[n]);const $=(0,b.useCallback)(async(z=!1)=>{z?v(!0):p(!0);try{const C=y.current,T=await Cr(z&&C.length>0?C[C.length-1].createdAt:null,10);T.length<10?w(!1):w(!0),h(z?B=>[...B,...T]:T)}catch(C){console.error("Failed to fetch communities:",C)}finally{p(!1),v(!1)}},[]),R=(0,b.useCallback)(async(z=!1)=>{z?A(!0):M(!0);try{const C=L.current,T=z&&C.length>0?C[C.length-1].sort_timestamp||C[C.length-1].sortTimestamp:null;let B;l?B=await Ot(l,T,10,!0):B=await ur(T,10),B.length<10?I(!1):I(!0),_(z?W=>[...W,...B]:B)}catch(C){console.error("Failed to load posts:",C)}finally{M(!1),A(!1)}},[l]);(0,b.useEffect)(()=>{$()},[$]),(0,b.useEffect)(()=>{R()},[l,R]);const E=(0,b.useMemo)(()=>{let z=x;return l&&(z=z.filter(C=>C.name?.toLowerCase().includes(l.toLowerCase())||C.handle?.toLowerCase().includes(l.toLowerCase()))),z},[x,l]);return{currentUser:t,searchQuery:l,setSearchQuery:z=>{o(z)},activeTab:c,setActiveTab:f,isCreateModalOpen:u,setIsCreateModalOpen:m,communitiesData:x,isCommunitiesLoading:d,isFetchingMoreCommunities:g,hasMoreCommunities:j,postsData:N,isPostsLoading:P,isFetchingMorePosts:k,hasMorePosts:S,filteredCommunities:E,handleCommunityClick:z=>{e(`/c/${z}`)},loadCommunities:$,loadPosts:R,navigate:e}};var Ec=Q();const Ic=()=>{const t=(0,Ec.c)(28),{currentUser:e}=he(),{posts:a,loading:i,hasMore:n,isFetchingNextPage:r,fetchNextPage:l}=Vt(),{addToast:o}=ze(),c=je();let f;t[0]===Symbol.for("react.memo_cache_sentinel")?(f={threshold:.1},t[0]=f):f=t[0];const{ref:u,inView:m}=vn(f);let x,h;t[1]!==l||t[2]!==n||t[3]!==m||t[4]!==r?(x=()=>{m&&n&&!r&&l()},h=[m,n,r,l],t[1]=l,t[2]=n,t[3]=m,t[4]=r,t[5]=x,t[6]=h):(x=t[5],h=t[6]),(0,b.useEffect)(x,h);let d;t[7]===Symbol.for("react.memo_cache_sentinel")?(d={queryKey:["stories"],queryFn:kr},t[7]=d):d=t[7];const{data:p,isLoading:g}=Re(d);let v;t[8]!==p?(v=p===void 0?[]:p,t[8]=p,t[9]=v):v=t[9];const j=v;let w;if(t[10]!==j){const S={};j.forEach(I=>{if(!I.user)return;const L=I.user.id;S[L]||(S[L]={user:I.user,stories:[]}),S[L].stories.push(I)}),w=Object.values(S),t[10]=j,t[11]=w}else w=t[11];const y=w,N=a;let _;t[12]!==c?(_=S=>{c(`/post/${S}`)},t[12]=c,t[13]=_):_=t[13];const P=_;let M;t[14]!==c?(M=S=>{c(`/u/${S}`)},t[14]=c,t[15]=M):M=t[15];const k=M;let A;return t[16]!==o||t[17]!==e||t[18]!==y||t[19]!==P||t[20]!==k||t[21]!==n||t[22]!==N||t[23]!==r||t[24]!==i||t[25]!==g||t[26]!==u?(A={currentUser:e,homePosts:N,groupedStories:y,isPostsLoading:i,isStoriesLoading:g,hasMore:n,isFetchingNextPage:r,addToast:o,ref:u,handlePostClick:P,handleUserClick:k},t[16]=o,t[17]=e,t[18]=y,t[19]=P,t[20]=k,t[21]=n,t[22]=N,t[23]=r,t[24]=i,t[25]=g,t[26]=u,t[27]=A):A=t[27],A};var Lc=Q();const Tc=()=>{const t=(0,Lc.c)(64),{id:e}=ut(),a=je(),{currentUser:i}=he(),{onlineUsers:n}=oa(),r=Ct(),[l,o]=(0,b.useState)("");let c;t[0]===Symbol.for("react.memo_cache_sentinel")?(c=[],t[0]=c):c=t[0];const[f,u]=(0,b.useState)(c),{conversations:m,isConvLoading:x,sendMessage:h,sendTypingStatus:d,typingStatus:p,markAsRead:g,formatMessages:v,onToggleReaction:j,allReactions:w}=Jt(i);let y;e:{if(!e||m.length===0){y=null;break e}let q;t[1]!==m||t[2]!==e?(q=m.find(V=>V.id===e)||null,t[1]=m,t[2]=e,t[3]=q):q=t[3],y=q}const N=y;let _,P;t[4]!==e||t[5]!==g?(_=()=>{e&&g(e)},P=[e,g],t[4]=e,t[5]=g,t[6]=_,t[7]=P):(_=t[6],P=t[7]),(0,b.useEffect)(_,P);let M;t[8]!==m||t[9]!==i?.id||t[10]!==l?(M=()=>{const q=setTimeout(async()=>{if(l.length>1){const V=await Zn(l),Y=m.map(Dc);u(V.filter(ae=>ae.id!==i?.id&&!Y.includes(ae.id)))}else u([])},300);return()=>clearTimeout(q)},t[8]=m,t[9]=i?.id,t[10]=l,t[11]=M):M=t[11];const k=i?.id;let A;t[12]!==m||t[13]!==l||t[14]!==k?(A=[l,m,k],t[12]=m,t[13]=l,t[14]=k,t[15]=A):A=t[15],(0,b.useEffect)(M,A);let S;t[16]!==i||t[17]!==a||t[18]!==r?(S=async q=>{try{const V=await aa(i.id,q.id);r.invalidateQueries({queryKey:["conversations",i.id]}),o(""),a(`/messages/${V}`)}catch(V){console.error("Failed to start conversation:",V)}},t[16]=i,t[17]=a,t[18]=r,t[19]=S):S=t[19];const I=S;let L;t[20]!==a?(L=q=>{a(`/messages/${q.id}`)},t[20]=a,t[21]=L):L=t[21];const $=L,R=N?.id;let E;t[22]!==R?(E=["messages",R],t[22]=R,t[23]=E):E=t[23];let O;t[24]!==N?.id?(O=()=>gr(N?.id),t[24]=N?.id,t[25]=O):O=t[25];const F=!!N?.id;let z;t[26]!==E||t[27]!==O||t[28]!==F?(z={queryKey:E,queryFn:O,enabled:F},t[26]=E,t[27]=O,t[28]=F,t[29]=z):z=t[29];const{data:C,isLoading:T}=Re(z);let B;t[30]!==C?(B=C===void 0?[]:C,t[30]=C,t[31]=B):B=t[31];const W=B;let J;t[32]!==w||t[33]!==W||t[34]!==v?(J=v(W,w),t[32]=w,t[33]=W,t[34]=v,t[35]=J):J=t[35];const K=J;let G;if(t[36]!==m||t[37]!==l){let q;t[39]!==l?(q=V=>V.user?.name?.toLowerCase().includes(l.toLowerCase())||V.user?.handle?.toLowerCase().includes(l.toLowerCase())||V.lastMessage?.toLowerCase().includes(l.toLowerCase()),t[39]=l,t[40]=q):q=t[40],G=m.filter(q),t[36]=m,t[37]=l,t[38]=G}else G=t[38];const ne=G,se=N&&p[N.id];let le;t[41]!==n||t[42]!==N?(le=N&&n.has(N.user?.id),t[41]=n,t[42]=N,t[43]=le):le=t[43];const X=le;let ee;return t[44]!==m||t[45]!==se||t[46]!==i||t[47]!==ne||t[48]!==$||t[49]!==I||t[50]!==e||t[51]!==x||t[52]!==T||t[53]!==K||t[54]!==l||t[55]!==a||t[56]!==j||t[57]!==n||t[58]!==X||t[59]!==N||t[60]!==h||t[61]!==d||t[62]!==f?(ee={id:e,currentUser:i,onlineUsers:n,msgSearchQuery:l,setMsgSearchQuery:o,userSearchResults:f,conversations:m,filteredConversations:ne,selectedConversation:N,localMessages:K,isConvLoading:x,isMsgLoading:T,currentIsTyping:se,otherUserIsOnline:X,handleStartConversation:I,handleSelectConversation:$,sendMessage:h,sendTypingStatus:d,onToggleReaction:j,navigate:a},t[44]=m,t[45]=se,t[46]=i,t[47]=ne,t[48]=$,t[49]=I,t[50]=e,t[51]=x,t[52]=T,t[53]=K,t[54]=l,t[55]=a,t[56]=j,t[57]=n,t[58]=X,t[59]=N,t[60]=h,t[61]=d,t[62]=f,t[63]=ee):ee=t[63],ee};function Dc(t){return t.user?.id}const Oc=()=>{const{currentUser:t}=he(),e=je(),[a,i]=(0,b.useState)([]),[n,r]=(0,b.useState)(!0),[l,o]=(0,b.useState)(!1),[c,f]=(0,b.useState)(!0),u=(0,b.useRef)(a);(0,b.useEffect)(()=>{u.current=a},[a]);const m=(0,b.useCallback)(async(d=!1)=>{if(t?.id){d?o(!0):r(!0);try{const p=u.current,g=d&&p.length>0?p[p.length-1].created_at:null,v=await yr(t.id,g,10);v.length<10?f(!1):f(!0),i(d?j=>[...j,...v]:v)}catch(p){console.error("Failed to fetch notifications:",p)}finally{r(!1),o(!1)}}},[t?.id]);(0,b.useEffect)(()=>{m()},[m]),(0,b.useEffect)(()=>{if(!t?.id)return;const d=D.channel(`user_notifications:${t.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`recipient_id=eq.${t.id}`},()=>{m()}).subscribe();return()=>D.removeChannel(d)},[t?.id,m]);const x=Vs({mutationFn:()=>zr(t.id),onSuccess:()=>{i(d=>d.map(p=>({...p,is_read:!0})))}}),h=d=>{d.type==="follow"?e(`/u/${d.user}`):d.post_id&&e(`/post/${d.post_id}`)};return(0,b.useEffect)(()=>{t?.id&&a.some(d=>!d.is_read)&&x.mutate()},[t?.id,a,x]),{currentUser:t,notifications:a,isLoading:n,isFetchingMore:l,hasMore:c,loadNotifications:m,handleNotificationClick:h,navigate:e}};var qc=Q();const Wc=()=>{const t=(0,qc.c)(20),{id:e}=ut(),a=je(),{currentUser:i}=he(),{addToast:n}=ze();let r,l;t[0]!==e?(r=["post",e],l=async()=>{if(!Pe(e))throw new Error("Invalid post ID");return nr(e)},t[0]=e,t[1]=r,t[2]=l):(r=t[1],l=t[2]);const o=!!e;let c;t[3]!==r||t[4]!==l||t[5]!==o?(c={queryKey:r,queryFn:l,enabled:o,retry:!1},t[3]=r,t[4]=l,t[5]=o,t[6]=c):c=t[6];const{data:f,isLoading:u,isError:m}=Re(c);let x;t[7]!==a?(x=v=>{a(`/u/${v}`)},t[7]=a,t[8]=x):x=t[8];const h=x;let d;t[9]!==a?(d=()=>{a(-1)},t[9]=a,t[10]=d):d=t[10];const p=d;let g;return t[11]!==n||t[12]!==i||t[13]!==p||t[14]!==h||t[15]!==m||t[16]!==u||t[17]!==a||t[18]!==f?(g={post:f,isLoading:u,isError:m,currentUser:i,addToast:n,navigate:a,handleUserClick:h,handleDelete:p},t[11]=n,t[12]=i,t[13]=p,t[14]=h,t[15]=m,t[16]=u,t[17]=a,t[18]=f,t[19]=g):g=t[19],g},Uc=()=>{const t=je(),e=(0,b.useRef)(null),[a,i]=(0,b.useState)([]),[n,r]=(0,b.useState)(!0),[l,o]=(0,b.useState)(!1),[c,f]=(0,b.useState)(null),[u,m]=(0,b.useState)(!0),[x,h]=(0,b.useState)(!0),d=(0,b.useCallback)(async(v=null)=>{try{const j=await fr(v);j.length<10&&m(!1),v?i(w=>[...w,...j]):(i(j),j.length>0&&!c&&f(j[0].id))}catch(j){console.error("Error fetching reels:",j)}finally{r(!1),o(!1)}},[c]);(0,b.useEffect)(()=>{d()},[d]);const p=(0,b.useCallback)(()=>{if(!e.current||l||!u)return;const{scrollTop:v,scrollHeight:j,clientHeight:w}=e.current;if(v+w>=j-800){o(!0);const y=a[a.length-1];d(y?.sort_timestamp||y?.created_at)}},[a,l,u,d]);return(0,b.useEffect)(()=>{const v=e.current;if(v)return v.addEventListener("scroll",p),()=>v.removeEventListener("scroll",p)},[p]),(0,b.useEffect)(()=>{if(a.length===0)return;const v={root:e.current,threshold:.6},j=y=>{y.forEach(N=>{N.isIntersecting&&f(N.target.dataset.id)})},w=new IntersectionObserver(j,v);return document.querySelectorAll(".reel-item").forEach(y=>w.observe(y)),()=>w.disconnect()},[a]),{reels:a,loading:n,loadingMore:l,activeReelId:c,hasMore:u,isMuted:x,containerRef:e,navigate:t,toggleMute:()=>{h(!x)},loadReels:d}};var La=({id:t,user:e,timeAgo:a,content:i,contentClass:n,media:r,quotedPost:l,stats:o,onClick:c,repostedBy:f,onUserClick:u,currentUser:m,showToast:x,poll:h,isDetail:d,initialComments:p,onDelete:g,isComment:v,onReply:j,community:w})=>{const y=je(),{liked:N,reposted:_,localStats:P,setLocalStats:M,handleLike:k,handleRepost:A}=$c(t,o,m,x),{deletePost:S,updatePost:I}=Vt(),[L,$]=(0,b.useState)(p||[]),[R,E]=(0,b.useState)(""),[O,F]=(0,b.useState)(!1),[z,C]=(0,b.useState)(!1),[T,B]=(0,b.useState)(!1),[W,J]=(0,b.useState)(!0),[K,G]=(0,b.useState)([]),[ne,se]=(0,b.useState)(!1),[le,X]=(0,b.useState)(!1),[ee,q]=(0,b.useState)(!1),[V,Y]=(0,b.useState)(i),[ae,Z]=(0,b.useState)(r||[]),[ce,me]=(0,b.useState)([]),[pe,de]=(0,b.useState)(!1),[fe,we]=(0,b.useState)(!1),Ne=(0,b.useRef)(null),xe=(0,b.useRef)(L);(0,b.useEffect)(()=>{xe.current=L},[L]);const ye=async()=>{const H=JSON.stringify(ae)!==JSON.stringify(r||[])||ce.length>0;if(!V.trim()||V===i&&!H){q(!1);return}de(!0);try{const te=[];for(const U of ce){const ie=await Ae(U);te.push(ie)}await I(t,{content:V,media:[...ae,...te]}),me([]),q(!1),x&&x("Post updated")}catch(te){console.error("Failed to update post:",te),x&&x("Failed to update post")}finally{de(!1)}},Ie=async H=>{H&&H.stopPropagation();try{await S(t),x&&x("Post deleted successfully"),g&&g(t)}catch(te){console.error("Failed to delete post:",te),x&&x("Failed to delete post")}finally{X(!1)}},Se=(0,b.useCallback)(async(H=!1)=>{if(t){H?B(!0):F(!0);try{const te=xe.current,U=await ea(t,H&&te.length>0?te[te.length-1].created_at:null,10);U.length<10?J(!1):J(!0),$(H?ie=>[...ie,...U]:U)}catch(te){console.error("Failed to load comments:",te)}finally{F(!1),B(!1)}}},[t]);(0,b.useEffect)(()=>{d&&t&&Se()},[d,t,Se]);const lt=async H=>{if(H.preventDefault(),!(!R.trim()&&K.length===0||!m)){C(!0),se(!0);try{const te=[];for(const U of K){const ie=await Ae(U);te.push(ie)}await ta(t,m.id,R,te),E(""),G([]),M(U=>({...U,comments:(U.comments||0)+1})),x&&x("Reply posted!"),Se()}catch(te){console.error("Failed to post comment:",te),x&&x("Failed to post reply.")}finally{C(!1),se(!1)}}},Ue=H=>{H.stopPropagation();const te=`${window.location.origin}/post/${t}`;navigator.clipboard.writeText(te),x&&x("Link copied to clipboard!")},Le=({trigger:H})=>(0,s.jsxs)(ja,{children:[(0,s.jsx)(wa,{asChild:!0,onClick:te=>te.stopPropagation(),children:H}),(0,s.jsxs)(ya,{align:"end",className:"w-48 rounded-xl bg-white dark:bg-zinc-900 border-zinc-100 dark:border-zinc-800",children:[(0,s.jsxs)(Ge,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5",onClick:Ue,children:[(0,s.jsx)(Fs,{size:16}),(0,s.jsx)("span",{children:"Copy link to post"})]}),!v&&(0,s.jsxs)(Ge,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5",onClick:te=>{te.stopPropagation(),x&&x("Post reported")},children:[(0,s.jsx)(Wa,{size:16}),(0,s.jsx)("span",{children:"Report post"})]}),!Te&&(0,s.jsxs)(Ge,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5 text-rose-500 focus:text-rose-500",onClick:te=>{te.stopPropagation(),x&&x("User blocked")},children:[(0,s.jsx)(oi,{size:16}),(0,s.jsxs)("span",{children:["Block @",e.handle]})]}),Te&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(El,{className:"bg-zinc-100 dark:bg-zinc-800"}),(0,s.jsxs)(Ge,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-900 py-2.5",onClick:te=>{te.stopPropagation(),q(!0)},children:[(0,s.jsx)(St,{size:16}),(0,s.jsx)("span",{children:"Edit post"})]}),(0,s.jsxs)(Ge,{className:"gap-2 cursor-pointer focus:bg-rose-50 dark:focus:bg-rose-900/20 py-2.5 text-rose-500 focus:text-rose-500",onClick:te=>{te.stopPropagation(),X(!0)},children:[(0,s.jsx)(Os,{size:16}),(0,s.jsx)("span",{children:"Delete post"})]})]})]})]}),Te=m?.handle===e.handle,De=H=>{if(!H)return null;const te=ee?ae:H;return!te||Array.isArray(te)&&te.length===0?null:ee?(0,s.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,s.jsxs)("div",{className:"grid gap-2 grid-cols-2 sm:grid-cols-3",children:[ae.map((U,ie)=>(0,s.jsxs)("div",{className:"relative aspect-square rounded-xl overflow-hidden border border-zinc-200 dark:border-zinc-800 group",children:[U.type==="video"?(0,s.jsx)("div",{className:"size-full bg-zinc-100 dark:bg-zinc-900 flex items-center justify-center",children:(0,s.jsx)(zt,{size:24,className:"text-zinc-400"})}):(0,s.jsx)("img",{src:U.url||U.src,className:"size-full object-cover",alt:""}),(0,s.jsx)("button",{onClick:Me=>{Me.stopPropagation(),Z(qe=>qe.filter((Ve,_e)=>_e!==ie))},className:"absolute top-1.5 right-1.5 size-7 rounded-full bg-black/60 text-white flex items-center justify-center hover:bg-black transition-colors",children:(0,s.jsx)($e,{size:16})})]},`old-${ie}`)),ce.map((U,ie)=>(0,s.jsxs)("div",{className:"relative aspect-square rounded-xl overflow-hidden border-2 border-dashed border-violet-500 bg-violet-50/10 group",children:[U.type.startsWith("image/")?(0,s.jsx)("img",{src:URL.createObjectURL(U),className:"size-full object-cover",alt:""}):(0,s.jsx)("div",{className:"size-full flex items-center justify-center",children:(0,s.jsx)(zt,{size:24,className:"text-violet-500 animate-pulse"})}),(0,s.jsx)("button",{onClick:Me=>{Me.stopPropagation(),me(qe=>qe.filter((Ve,_e)=>_e!==ie))},className:"absolute top-1.5 right-1.5 size-7 rounded-full bg-black/60 text-white flex items-center justify-center hover:bg-black transition-colors",children:(0,s.jsx)($e,{size:16})}),(0,s.jsx)("div",{className:"absolute bottom-1 left-1 bg-violet-600 text-white text-[8px] font-bold px-1 rounded",children:"NEW"})]},`new-${ie}`)),ae.length+ce.length<4&&(0,s.jsxs)("button",{onClick:U=>{U.stopPropagation(),Ne.current?.click()},className:"relative aspect-square rounded-xl border-2 border-dashed border-zinc-200 dark:border-zinc-800 flex flex-col items-center justify-center gap-1 text-zinc-400 hover:text-violet-500 hover:border-violet-500 hover:bg-violet-50/5 transition-all",children:[(0,s.jsx)(We,{size:20}),(0,s.jsx)("span",{className:"text-[10px] font-bold",children:"Add Media"})]})]}),(0,s.jsx)("input",{type:"file",ref:Ne,onChange:U=>{const ie=Array.from(U.target.files);me(Me=>[...Me,...ie])},multiple:!0,className:"hidden",accept:"image/*,video/*"})]}):b.isValidElement(te)?te:(0,s.jsx)(wc,{items:te})},Oe=(H,te)=>{const U=typeof H=="string"&&Jn(H);if(ee)return(0,s.jsxs)("div",{className:"flex flex-col gap-2 mt-2",onClick:ie=>ie.stopPropagation(),children:[(0,s.jsx)(yo,{value:V,onChange:ie=>Y(ie.target.value),className:`min-h-[100px] w-full bg-zinc-50 dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800 rounded-xl focus:ring-violet-500 ${U?"font-bangla text-lg":"font-english"}`,autoFocus:!0}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)("button",{onClick:()=>{q(!1),Y(i),Z(r||[]),me([])},className:"px-4 py-1.5 text-sm font-bold text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-300 transition-colors",children:"Cancel"}),(0,s.jsx)("button",{onClick:ye,disabled:pe||!V.trim()||V===i,className:"px-4 py-1.5 text-sm font-bold bg-violet-600 text-white rounded-full hover:bg-violet-700 disabled:opacity-50 transition-all active:scale-95",children:pe?"Saving...":"Save"})]})]});if(typeof H=="string"){const ie=!d&&H.length>280,Me=ie&&!fe?H.substring(0,280):H;return(0,s.jsxs)("div",{className:`whitespace-pre-line ${te||""} ${U?"font-bangla text-[1.15em] leading-relaxed":"font-english text-[1.05em]"}`,children:[(0,s.jsx)(xt,{options:{...bt,render:({attributes:qe,content:Ve})=>{const{href:_e,...es}=qe,ts=!_e.startsWith("/")&&(_e.startsWith("http")||_e.startsWith("www"));return _e.startsWith("/u/")||_e.startsWith("/tags/")||_e.startsWith("/c/")||_e.startsWith("/explore")?(0,s.jsx)("span",{...es,onClick:Ta=>{Ta.stopPropagation(),y(_e)},children:Ve},Ve):(0,s.jsx)("a",{href:_e,...es,target:ts?"_blank":void 0,rel:ts?"noopener noreferrer":void 0,children:Ve},Ve)}},children:Me}),ie&&!fe&&"...",ie&&(0,s.jsx)("button",{onClick:qe=>{qe.stopPropagation(),we(!fe)},className:"ml-1 text-rose-500 dark:text-rose-400 font-bold hover:underline cursor-pointer",children:fe?"Show less":"See more"})]})}return H},Be=H=>{E(te=>{const U=`@${H} `;return te.includes(U)?te:te+U}),document.getElementById("comment-input")?.focus()};return d?(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("article",{className:"p-5 dark:bg-black",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex items-start gap-x-3",children:[(0,s.jsx)("button",{className:"shrink-0",onClick:()=>u&&u(e.handle),children:(0,s.jsxs)(ge,{className:"size-12 border border-zinc-200 dark:border-zinc-700",children:[(0,s.jsx)(be,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,s.jsx)(ve,{children:e.handle[0]?.toUpperCase()})]})}),(0,s.jsxs)("div",{className:"flex flex-col min-w-0 flex-1",children:[(0,s.jsx)("div",{className:"flex flex-wrap items-center gap-x-1.5 leading-none",children:(0,s.jsxs)("div",{className:"flex items-center gap-1.5 min-w-0 max-w-full",children:[(0,s.jsxs)("button",{className:"font-bold text-base sm:text-lg hover:underline text-zinc-900 dark:text-white flex items-center gap-1 shrink-0",onClick:()=>u&&u(e.handle),children:[(0,s.jsx)("span",{className:"max-w-[200px] sm:max-w-none truncate",children:e.handle}),e.verified&&(0,s.jsx)(dt,{})]}),w&&(0,s.jsxs)("div",{className:"flex items-center gap-1 min-w-0 text-zinc-500",children:[(0,s.jsx)("span",{className:"text-zinc-400 font-medium shrink-0 text-xs sm:text-sm",children:">"}),(0,s.jsxs)("button",{className:"flex items-center gap-1 font-bold text-zinc-900 dark:text-zinc-100 hover:underline text-[14px] sm:text-[15px]",onClick:H=>{H.stopPropagation(),y(`/c/${w.handle}`)},children:[(0,s.jsxs)(ge,{className:"size-4 bg-zinc-100 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 shrink-0",children:[(0,s.jsx)(be,{src:w.avatar,alt:w.name,className:"object-cover"}),(0,s.jsx)(ve,{className:"text-[8px] font-bold text-zinc-500",children:w.name?.[0]?.toUpperCase()})]}),(0,s.jsx)("span",{className:"truncate max-w-[200px] sm:max-w-none",children:w.name})]})]})]})}),(0,s.jsxs)("span",{className:"text-xs sm:text-sm text-zinc-500 dark:text-zinc-400 font-medium",children:["@",e.handle]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 -mt-1",children:[(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400 text-[13px] sm:text-sm whitespace-nowrap",children:a||"Recent"}),(0,s.jsx)(Le,{trigger:(0,s.jsx)("button",{className:"text-zinc-500 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full p-2 transition-colors",children:(0,s.jsx)(Rt,{size:20})})})]})]}),(0,s.jsx)("div",{className:"break-words text-zinc-900 dark:text-zinc-100 mt-4 text-lg sm:text-xl leading-relaxed sm:leading-8 whitespace-pre-line",children:Oe(i,n)}),vt(i)&&(0,s.jsx)(hs,{url:vt(i)}),De(r),h&&(0,s.jsx)(ps,{poll:h}),l&&(0,s.jsx)("div",{className:"mt-4 border border-zinc-200 dark:border-zinc-700 rounded-2xl overflow-hidden shadow-sm",children:(0,s.jsx)(gs,{...l})}),(0,s.jsxs)("div",{className:"border-b border-zinc-100 dark:border-zinc-800 pb-4 mt-4 flex items-center gap-x-6 text-zinc-500 dark:text-zinc-400 text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,s.jsx)("span",{className:"font-bold text-black dark:text-white",children:P.likes||0})," ",(0,s.jsx)("span",{className:"opacity-70",children:"Likes"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,s.jsx)("span",{className:"font-bold text-black dark:text-white",children:P.comments||0})," ",(0,s.jsx)("span",{className:"opacity-70",children:"Comments"})]})]}),(0,s.jsxs)("div",{className:"mt-4 flex w-full items-center justify-around py-1",children:[(0,s.jsx)(it,{icon:ct,label:"Like",onClick:k,active:N,activeColorClass:"text-rose-500"}),!v&&(0,s.jsx)(it,{icon:Mt,label:"Repost",onClick:A,active:_,activeColorClass:"text-emerald-500"}),(0,s.jsx)(it,{icon:yt,label:"Comment",onClick:()=>document.getElementById("comment-input")?.focus()})]})]}),(0,s.jsx)(Ea,{currentUser:m,newComment:R,setNewComment:E,handleSubmitComment:lt,loading:z,selectedFiles:K,setSelectedFiles:G,isUploading:ne}),(0,s.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:O?(0,s.jsx)("div",{className:"p-8 flex justify-center",children:(0,s.jsx)(oe,{className:"animate-spin text-violet-500"})}):(0,s.jsxs)(s.Fragment,{children:[W&&L.length>0&&(0,s.jsxs)("button",{onClick:()=>Se(!0),disabled:T,className:"w-full py-3 text-sm font-bold text-violet-600 hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors flex items-center justify-center gap-2",children:[T&&(0,s.jsx)(oe,{size:14,className:"animate-spin"}),"View more replies"]}),L.map(H=>(0,s.jsx)(La,{...H,isComment:!0,onReply:Be,onUserClick:u,currentUser:m,showToast:x,onDelete:te=>$(U=>U.filter(ie=>ie.id!==te))},H.id))]})}),(0,s.jsx)(ns,{open:le,onOpenChange:X,children:(0,s.jsxs)(rs,{onClick:H=>H.stopPropagation(),children:[(0,s.jsxs)(ls,{children:[(0,s.jsx)(cs,{children:"Are you absolutely sure?"}),(0,s.jsx)(ds,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,s.jsxs)(os,{children:[(0,s.jsx)(us,{onClick:H=>H.stopPropagation(),children:"Cancel"}),(0,s.jsx)(ms,{onClick:Ie,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]}):(0,s.jsxs)("article",{onClick:c,className:`p-4 transition-all ${v?"bg-transparent border-b border-zinc-100/50 dark:border-zinc-800/50 hover:bg-zinc-50/50 dark:hover:bg-zinc-800/30 last:border-0":"mb-4 bg-white dark:bg-black rounded-xl hover:shadow-md"} ${c?"cursor-pointer":""}`,children:[f&&(0,s.jsxs)("div",{className:"mb-2 flex items-center space-x-1.5 text-[13px] text-zinc-500 font-semibold ml-1",children:[(0,s.jsx)(Mt,{size:14,className:"text-zinc-400"}),(0,s.jsx)("span",{className:"hover:underline cursor-pointer flex items-center text-zinc-600 dark:text-zinc-400",onClick:H=>{H.stopPropagation(),u&&u(f.handle)},children:(0,s.jsx)("span",{className:"truncate max-w-[150px]",children:typeof f=="object"?f.name:f})}),(0,s.jsx)("span",{className:"text-zinc-400",children:"reposted"})]}),(0,s.jsxs)("div",{className:"flex items-start gap-x-3",children:[(0,s.jsx)("button",{className:"shrink-0 group",onClick:H=>{H.stopPropagation(),u&&u(e.handle)},children:(0,s.jsxs)(ge,{className:"size-11 border border-zinc-200 dark:border-zinc-700 group-hover:brightness-95 transition-all",children:[(0,s.jsx)(be,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,s.jsx)(ve,{children:e.handle[0]?.toUpperCase()})]})}),(0,s.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,s.jsxs)("div",{className:"flex w-full items-start justify-between",children:[(0,s.jsx)("div",{className:"flex flex-col min-w-0 flex-1",children:(0,s.jsx)("div",{className:"flex flex-wrap items-center gap-x-1.5 leading-none",children:(0,s.jsxs)("div",{className:"flex items-center gap-1.5 min-w-0 max-w-full",children:[(0,s.jsxs)("button",{className:"font-bold text-[15px] hover:underline text-zinc-900 dark:text-white flex items-center gap-1 shrink-0",onClick:H=>{H.stopPropagation(),u&&u(e.handle)},children:[(0,s.jsx)("span",{className:"truncate max-w-[160px] sm:max-w-none",children:e.handle}),e.verified&&(0,s.jsx)(dt,{})]}),w&&(0,s.jsxs)("div",{className:"flex items-center gap-1 min-w-0 text-zinc-500",children:[(0,s.jsx)("span",{className:"text-zinc-400 font-medium shrink-0 text-xs sm:text-sm",children:">"}),(0,s.jsxs)("button",{className:"flex items-center gap-1 font-bold text-zinc-900 dark:text-zinc-100 hover:underline text-[14px] sm:text-[15px] min-w-0",onClick:H=>{H.stopPropagation(),y(`/c/${w.handle}`)},children:[(0,s.jsxs)(ge,{className:"size-4 bg-zinc-100 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 shrink-0",children:[(0,s.jsx)(be,{src:w.avatar,alt:w.name,className:"object-cover"}),(0,s.jsx)(ve,{className:"text-[8px] font-bold text-zinc-500",children:w.name?.[0]?.toUpperCase()})]}),(0,s.jsx)("span",{className:"truncate max-w-[160px] md:max-w-none",children:w.name})]})]})]})})}),(0,s.jsxs)("div",{className:"flex items-center gap-2 -mt-1",children:[(0,s.jsx)("span",{className:"text-zinc-400 text-[13px] sm:text-sm whitespace-nowrap",children:a||"Recent"}),(0,s.jsx)(Le,{trigger:(0,s.jsx)("button",{className:"text-zinc-400 hover:bg-zinc-100 hover:text-zinc-700 dark:hover:bg-zinc-800 dark:hover:text-zinc-200 rounded-full p-2 -mr-2 transition-colors",children:(0,s.jsx)(Rt,{size:18})})})]})]}),(0,s.jsxs)("div",{className:"break-words text-zinc-900 dark:text-zinc-100 mt-1 whitespace-pre-line text-sm sm:text-[15px] leading-relaxed",children:[Oe(i,n),vt(i)&&(0,s.jsx)(hs,{url:vt(i)}),De(r),h&&(0,s.jsx)(ps,{poll:h,onVote:()=>x&&x("Voted!")}),l&&(0,s.jsx)("div",{className:"mt-3 border border-zinc-200 dark:border-zinc-700 rounded-2xl overflow-hidden bg-white dark:bg-zinc-900 hover:bg-zinc-50 dark:hover:bg-zinc-800 transition-colors cursor-pointer",onClick:H=>H.stopPropagation(),children:(0,s.jsx)(gs,{...l})})]}),(0,s.jsx)("div",{className:"mt-3 flex w-full flex-wrap items-center justify-between gap-3 pr-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-6 sm:gap-x-8",children:[(0,s.jsx)(it,{icon:ct,label:"Like",count:P.likes,active:N,onClick:k,activeColorClass:"text-rose-500"}),!v&&(0,s.jsx)(it,{icon:Mt,label:"Repost",count:P.mirrors,active:_,onClick:A,activeColorClass:"text-emerald-500"}),(0,s.jsx)(it,{icon:yt,label:"Comment",count:P.comments,onClick:H=>{v&&j?(H.stopPropagation(),j(e.handle)):c&&c(H)}})]})})]})]}),(0,s.jsx)(ns,{open:le,onOpenChange:X,children:(0,s.jsxs)(rs,{onClick:H=>H.stopPropagation(),children:[(0,s.jsxs)(ls,{children:[(0,s.jsx)(cs,{children:"Are you absolutely sure?"}),(0,s.jsx)(ds,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,s.jsxs)(os,{children:[(0,s.jsx)(us,{onClick:H=>H.stopPropagation(),children:"Cancel"}),(0,s.jsx)(ms,{onClick:Ie,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]})},at=La,Bc=Q(),Vc=t=>{const e=(0,Bc.c)(30),{user:a,time:i,content:n}=t,r=je();let l;e[0]!==a.avatar||e[1]!==a.handle?(l=(0,s.jsx)(be,{src:a.avatar,alt:a.handle}),e[0]=a.avatar,e[1]=a.handle,e[2]=l):l=e[2];let o;e[3]!==a.handle[0]?(o=a.handle[0]?.toUpperCase(),e[3]=a.handle[0],e[4]=o):o=e[4];let c;e[5]!==o?(c=(0,s.jsx)(ve,{children:o}),e[5]=o,e[6]=c):c=e[6];let f;e[7]!==l||e[8]!==c?(f=(0,s.jsxs)(ge,{className:"size-6",children:[l,c]}),e[7]=l,e[8]=c,e[9]=f):f=e[9];let u;e[10]!==a.handle?(u=(0,s.jsx)("span",{className:"font-semibold text-sm",children:a.handle}),e[10]=a.handle,e[11]=u):u=e[11];let m;e[12]!==f||e[13]!==u?(m=(0,s.jsxs)("div",{className:"flex items-center gap-x-2",children:[f,u]}),e[12]=f,e[13]=u,e[14]=m):m=e[14];let x;e[15]!==i?(x=(0,s.jsx)("span",{className:"text-zinc-500 text-xs sm:text-sm",children:i}),e[15]=i,e[16]=x):x=e[16];let h;e[17]!==m||e[18]!==x?(h=(0,s.jsxs)("div",{className:"flex items-center justify-between gap-x-2 mb-2",children:[m,x]}),e[17]=m,e[18]=x,e[19]=h):h=e[19];let d;e[20]!==r?(d={...bt,render:j=>{const{attributes:w,content:y}=j,{href:N,..._}=w,P=!N.startsWith("/")&&(N.startsWith("http")||N.startsWith("www"));return N.startsWith("/u/")||N.startsWith("/tags/")||N.startsWith("/c/")||N.startsWith("/explore")?(0,s.jsx)("span",{..._,onClick:M=>{M.stopPropagation(),r(N)},children:y},y):(0,s.jsx)("a",{href:N,..._,target:P?"_blank":void 0,rel:P?"noopener noreferrer":void 0,onClick:Qc,children:y},y)}},e[20]=r,e[21]=d):d=e[21];let p;e[22]!==n?(p=(0,s.jsx)("p",{className:"text-sm text-zinc-800 dark:text-zinc-300 whitespace-pre-line",children:n}),e[22]=n,e[23]=p):p=e[23];let g;e[24]!==p||e[25]!==d?(g=(0,s.jsx)(xt,{options:d,children:p}),e[24]=p,e[25]=d,e[26]=g):g=e[26];let v;return e[27]!==g||e[28]!==h?(v=(0,s.jsxs)("div",{className:"p-4",children:[h,g]}),e[27]=g,e[28]=h,e[29]=v):v=e[29],v},gs=Vc;function Qc(t){return t.stopPropagation()}var Jc=b.memo(({reel:t,isActive:e,isMuted:a})=>{const i=je(),{currentUser:n}=he(),{addToast:r}=ze(),l=(0,b.useRef)(null),[o,c]=(0,b.useState)(!1),[f,u]=(0,b.useState)(!1),[m,x]=(0,b.useState)(null),[h,d]=(0,b.useState)(!1),[p,g]=(0,b.useState)(t.stats?.likes||0),[v,j]=(0,b.useState)(!1),[w,y]=(0,b.useState)(0),N=(0,b.useRef)(null),_=(0,b.useMemo)(()=>Array.isArray(t.media)?t.media[0]?.src||t.media[0]?.url:t.media?.src||t.media?.url||t.url,[t.media,t.url]);(0,b.useEffect)(()=>{let $;const R=l.current?.plyr;return R&&(e?$=setTimeout(()=>{typeof R.play=="function"&&R.play().catch(()=>{R&&(R.muted=!0,R.play().catch(()=>{}))})},100):typeof R.pause=="function"&&R.pause()),()=>{$&&clearTimeout($)}},[e]),(0,b.useEffect)(()=>{if(!n?.id||!e)return;(async()=>{try{const[R,E]=await Promise.all([sa(t.id,n.id),Gs(n.id,t.user?.id)]);d(R),j(E)}catch(R){console.error("Failed to check interaction status:",R)}})()},[t.id,n?.id,e,t.user?.id]),(0,b.useEffect)(()=>{const $=l.current?.plyr;$&&($.muted=a)},[a]),(0,b.useEffect)(()=>{const $=l.current?.plyr;if(!$||!e)return;const R=()=>{const E=$.currentTime,O=$.duration;O>0&&y(E/O*100)};if(typeof $.on=="function")return $.on("timeupdate",R),()=>{typeof $.off=="function"&&$.off("timeupdate",R)}},[e]);const P=$=>{$.target.closest("button")||$.target.closest("a")||(N.current?(clearTimeout(N.current),N.current=null,k()):N.current=setTimeout(()=>{N.current=null,M()},200))},M=()=>{const $=l.current?.plyr;$&&($.paused?($.play().catch(()=>{}),x("play")):($.pause(),x("pause")),setTimeout(()=>x(null),500))},k=async()=>{if(n&&(c(!0),setTimeout(()=>c(!1),800),!h)){d(!0),g($=>$+1);try{await Dt(t.id,n.id)}catch{d(!1),g($=>$-1)}}},A=async $=>{if($.stopPropagation(),!n)return;const R=!h;d(R),g(E=>R?E+1:E-1);try{await Dt(t.id,n.id)}catch{d(!R),g(E=>R?E-1:E+1)}},S=async $=>{if($.stopPropagation(),!n)return;const R=!v;j(R);try{await Zs(n.id,t.user?.id)}catch{j(!R)}},I=$=>{$.stopPropagation();const R=`${window.location.origin}/reels?id=${t.id}`;navigator.clipboard.writeText(R),r("Link copied to clipboard!")},L=(0,b.useMemo)(()=>({source:{type:"video",sources:[{src:_,type:"video/mp4"}]},options:{controls:[],loop:{active:!0},clickToPlay:!0,ratio:"9:16"}}),[_]);return(0,s.jsxs)("div",{"data-id":t.id,className:"reel-item relative h-screen w-full bg-black snap-start flex items-center justify-center overflow-hidden cursor-pointer",onClick:P,children:[(0,s.jsx)("div",{className:"w-full h-full max-w-[450px]",children:(0,s.jsx)(Qs,{ref:l,...L})}),o&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-50",children:(0,s.jsx)("div",{className:"animate-in zoom-in-50 fade-out fill-mode-forwards duration-500",children:(0,s.jsx)(ct,{size:120,fill:"white",className:"text-white drop-shadow-[0_0_30px_rgba(255,255,255,0.4)] scale-125"})})}),m&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-50",children:(0,s.jsx)("div",{className:"animate-in fade-in zoom-in-90 scale-100 animate-out zoom-out-110 fade-out fill-mode-forwards duration-500",children:(0,s.jsx)("div",{className:"p-8 bg-white/10 backdrop-blur-md rounded-full border border-white/20 shadow-2xl",children:m==="play"?(0,s.jsx)(qi,{size:50,fill:"white",className:"text-white ml-1.5"}):(0,s.jsx)(yn,{size:50,fill:"white",className:"text-white"})})})}),(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-black/60 pointer-events-none"}),(0,s.jsxs)("div",{className:"absolute bottom-20 left-4 right-16 text-white pointer-events-none",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3 pointer-events-auto",children:[(0,s.jsxs)(Wt,{to:`/u/${t.user?.handle}`,className:"flex items-center gap-2 hover:opacity-80 transition-opacity",onClick:$=>$.stopPropagation(),children:[(0,s.jsxs)(ge,{className:"size-10 border-2 border-white",children:[(0,s.jsx)(be,{src:t.user?.avatar,alt:t.user?.handle,className:"object-cover"}),(0,s.jsx)(ve,{children:t.user?.handle?.[0]?.toUpperCase()})]}),(0,s.jsxs)("span",{className:"font-bold",children:["@",t.user?.handle]})]}),n?.id!==t.user?.id&&(0,s.jsx)("button",{className:`text-xs font-bold px-4 py-1.5 rounded-full ml-2 transition-all active:scale-95 ${v?"bg-transparent border border-white/50 text-white":"bg-white text-black hover:bg-zinc-200"}`,onClick:S,children:v?"Following":"Follow"})]}),(0,s.jsx)(xt,{options:{...bt,render:({attributes:$,content:R})=>{const{href:E,...O}=$,F=!E.startsWith("/")&&(E.startsWith("http")||E.startsWith("www"));return E.startsWith("/u/")||E.startsWith("/tags/")||E.startsWith("/c/")||E.startsWith("/explore")?(0,s.jsx)("span",{...O,className:"text-white font-bold hover:underline cursor-pointer",onClick:z=>{z.stopPropagation(),i(E)},children:R},R):(0,s.jsx)("a",{href:E,...O,className:"text-white hover:underline",target:F?"_blank":void 0,rel:F?"noopener noreferrer":void 0,onClick:z=>z.stopPropagation(),children:R},R)}},children:(0,s.jsx)("p",{className:"text-sm mb-3 line-clamp-2",children:t.content})}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs opacity-90",children:[(0,s.jsx)(mn,{size:14,className:"animate-spin-slow"}),(0,s.jsxs)("span",{children:["Original Audio - ",t.user?.handle]})]})]}),(0,s.jsxs)("div",{className:"absolute bottom-20 right-2 flex flex-col items-center gap-6 z-10",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1 pointer-events-auto",children:[(0,s.jsx)("button",{className:`p-3 rounded-full backdrop-blur-md transition-all active:scale-90 ${h?"bg-rose-500/20 text-rose-500":"bg-zinc-800/50 text-white hover:bg-zinc-700"}`,onClick:A,children:(0,s.jsx)(ct,{size:28,fill:h?"currentColor":"none"})}),(0,s.jsx)("span",{className:"text-white text-xs font-bold",children:p})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1 pointer-events-auto",children:[(0,s.jsx)("button",{className:"p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90",onClick:$=>{$.stopPropagation(),u(!0)},children:(0,s.jsx)(yt,{size:28})}),(0,s.jsx)("span",{className:"text-white text-xs font-bold",children:t.stats?.comments||0})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1 pointer-events-auto",children:[(0,s.jsx)("button",{className:"p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90",onClick:I,children:(0,s.jsx)(Vi,{size:28})}),(0,s.jsx)("span",{className:"text-white text-xs font-bold",children:t.stats?.shares||0})]})]}),(0,s.jsx)("div",{className:"absolute bottom-0 left-0 w-full h-[3px] bg-white/20 z-50",children:(0,s.jsx)("div",{className:"h-full bg-white transition-all duration-100 ease-linear shadow-[0_0_8px_rgba(255,255,255,0.8)]",style:{width:`${w}%`}})}),(0,s.jsx)(Yc,{isOpen:f,onClose:()=>u(!1),reelId:t.id,currentUser:n,showToast:r})]})},(t,e)=>t.isActive===e.isActive&&t.reel.id===e.reel.id&&t.isMuted===e.isMuted),Hc=Jc,Kc=({isOpen:t,onClose:e,reelId:a,currentUser:i,showToast:n})=>{const[r,l]=(0,b.useState)([]),[o,c]=(0,b.useState)(!1),[f,u]=(0,b.useState)(!1),[m,x]=(0,b.useState)(""),[h,d]=(0,b.useState)([]),[p,g]=(0,b.useState)(!1),[v,j]=(0,b.useState)(!0),[w,y]=(0,b.useState)(!1),N=(0,b.useRef)(r);(0,b.useEffect)(()=>{N.current=r},[r]);const _=(0,b.useCallback)(async(M=!1)=>{if(a){M?y(!0):c(!0);try{const k=N.current,A=await ea(a,M&&k.length>0?k[k.length-1].created_at:null,10);A.length<10?j(!1):j(!0),l(M?S=>[...S,...A]:A)}catch(k){console.error("Failed to load comments:",k),n&&n("Failed to load comments","error")}finally{c(!1),y(!1)}}},[a,n]);(0,b.useEffect)(()=>{t&&a?_():(l([]),j(!0))},[t,a,_]);const P=async M=>{if(M.preventDefault(),!(!m.trim()&&h.length===0||!i)){u(!0),g(!0);try{const k=[];for(const A of h){const S=await Ae(A);k.push(S)}await ta(a,i.id,m,k),x(""),d([]),n&&n("Reply posted!"),_()}catch(k){console.error("Failed to post comment:",k),n&&n("Failed to post reply.","error")}finally{u(!1),g(!1)}}};return(0,s.jsx)(Ke,{isOpen:t,onClose:e,className:"max-sm:h-[95dvh] sm:max-w-xl h-[85vh] flex flex-col !p-0",children:(0,s.jsxs)("div",{className:"flex flex-col h-full overflow-hidden bg-white dark:bg-zinc-900",children:[(0,s.jsxs)("div",{className:"px-5 py-4 border-b border-zinc-100 dark:border-zinc-800 flex items-center justify-center shrink-0 relative bg-white dark:bg-zinc-900",children:[(0,s.jsx)("h2",{className:"text-base font-bold dark:text-white",children:"Comments"}),(0,s.jsx)("div",{className:"absolute right-5 w-8 h-1 bg-zinc-200 dark:bg-zinc-800 rounded-full sm:hidden top-2 transform -translate-y-1/2 left-1/2 -translate-x-1/2"})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-zinc-200 dark:scrollbar-thumb-zinc-800",children:o?(0,s.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,s.jsx)(oe,{className:"animate-spin text-violet-500",size:32})}):r.length>0?(0,s.jsxs)("div",{className:"flex flex-col",children:[r.map(M=>(0,s.jsx)(at,{...M,isComment:!0,currentUser:i,showToast:n,onDelete:k=>l(A=>A.filter(S=>S.id!==k))},M.id)),v&&(0,s.jsxs)("button",{onClick:()=>_(!0),disabled:w,className:"w-full py-6 text-sm font-bold text-violet-600 hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors flex items-center justify-center gap-2",children:[w&&(0,s.jsx)(oe,{size:16,className:"animate-spin"}),"View more replies"]})]}):(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full min-h-[300px] text-center text-zinc-500 p-8",children:[(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 flex items-center justify-center mb-4",children:(0,s.jsx)(yt,{size:32,className:"text-zinc-400"})}),(0,s.jsx)("p",{className:"font-bold text-lg dark:text-zinc-300",children:"No comments yet"}),(0,s.jsx)("p",{className:"text-sm dark:text-zinc-500",children:"Be the first to share what you think!"})]})}),(0,s.jsx)("div",{className:"bg-white dark:bg-zinc-900 shrink-0",children:(0,s.jsx)(Ea,{currentUser:i,newComment:m,setNewComment:x,handleSubmitComment:P,loading:f,selectedFiles:h,setSelectedFiles:d,isUploading:p})})]})})},Yc=Kc,Xc=Q(),Zc=t=>{const e=(0,Xc.c)(101),{onPostInCommunity:a}=t,[i,n]=b.useState(!1),[r,l]=b.useState(!1),{community:o,loading:c,isMember:f,userRole:u,isJoining:m,communityPosts:x,loadingPosts:h,isFetchingMorePosts:d,hasMorePosts:p,handleJoinToggle:g,loadCommunityPosts:v,currentUser:j,addToast:w,navigate:y}=Fc(),N=u==="admin",_=f&&(!o.isPrivate||N);if(c){let xe;return e[0]===Symbol.for("react.memo_cache_sentinel")?(xe=(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)(oe,{size:40,className:"animate-spin text-violet-500"})}),e[0]=xe):xe=e[0],xe}if(!o){const xe=`The community @${o?.handle||"unknown"} could not be found.`;let ye;return e[1]!==xe?(ye=(0,s.jsx)("div",{className:"bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-[600px] flex items-center justify-center",children:(0,s.jsx)(Kt,{title:"Community doesn't exist",message:xe,icon:et})}),e[1]=xe,e[2]=ye):ye=e[2],ye}let P;e[3]!==y?(P=()=>y(-1),e[3]=y,e[4]=P):P=e[4];let M;e[5]===Symbol.for("react.memo_cache_sentinel")?(M=(0,s.jsx)(tt,{size:22}),e[5]=M):M=e[5];let k;e[6]!==P?(k=(0,s.jsx)("button",{onClick:P,className:"p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:M}),e[6]=P,e[7]=k):k=e[7];let A;e[8]!==o.name?(A=(0,s.jsx)("h5",{className:"text-lg font-bold dark:text-white leading-none",children:o.name}),e[8]=o.name,e[9]=A):A=e[9];let S;e[10]!==o.membersCount?(S=(0,s.jsxs)("span",{className:"text-xs text-zinc-500 mt-0.5",children:[o.membersCount," Members"]}),e[10]=o.membersCount,e[11]=S):S=e[11];let I;e[12]!==A||e[13]!==S?(I=(0,s.jsxs)("div",{className:"flex flex-col",children:[A,S]}),e[12]=A,e[13]=S,e[14]=I):I=e[14];let L;e[15]!==k||e[16]!==I?(L=(0,s.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4",children:[k,I]})}),e[15]=k,e[16]=I,e[17]=L):L=e[17];let $;e[18]!==o.cover?($=(0,s.jsx)("div",{className:"h-32 sm:h-52 bg-zinc-100 dark:bg-zinc-900 overflow-hidden relative",children:o.cover?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("img",{src:o.cover,className:"w-full h-full object-cover",alt:""}),(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 to-transparent"})]}):(0,s.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-violet-500/20 to-fuchsia-500/20"})}),e[18]=o.cover,e[19]=$):$=e[19];let R;e[20]!==o.avatar?(R=(0,s.jsx)("div",{className:"size-24 sm:size-32 rounded-3xl border-4 border-white dark:border-black bg-zinc-100 dark:bg-zinc-800 overflow-hidden shadow-xl",children:(0,s.jsx)("img",{src:o.avatar,className:"size-full object-cover",alt:""})}),e[20]=o.avatar,e[21]=R):R=e[21];let E;e[22]!==N?(E=N&&(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>n(!0),className:"p-2 rounded-full border border-zinc-200 dark:border-zinc-800 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 transition-all active:scale-95 flex items-center justify-center size-10",title:"Edit Community",children:(0,s.jsx)(St,{size:20})}),(0,s.jsx)("button",{onClick:()=>l(!0),className:"p-2 rounded-full border border-zinc-200 dark:border-zinc-800 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 transition-all active:scale-95 flex items-center justify-center size-10",title:"Manage Members",children:(0,s.jsx)(Js,{size:20})})]}),e[22]=N,e[23]=E):E=e[23];const O=f?"outline":"default",F=`rounded-full font-bold px-8 h-10 transition-all ${f?"border-zinc-200 dark:border-zinc-800 hover:bg-rose-50 hover:text-rose-500 hover:border-rose-100 dark:hover:bg-rose-900/20":"bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 hover:scale-105"}`;let z;e[24]!==m||e[25]!==f?(z=m?(0,s.jsx)(oe,{size:18,className:"animate-spin"}):f?"Joined":"Join",e[24]=m,e[25]=f,e[26]=z):z=e[26];let C;e[27]!==g||e[28]!==m||e[29]!==O||e[30]!==F||e[31]!==z?(C=(0,s.jsx)(ue,{variant:O,onClick:g,disabled:m,className:F,children:z}),e[27]=g,e[28]=m,e[29]=O,e[30]=F,e[31]=z,e[32]=C):C=e[32];let T;e[33]!==E||e[34]!==C?(T=(0,s.jsxs)("div",{className:"pb-1 flex gap-2",children:[E,C]}),e[33]=E,e[34]=C,e[35]=T):T=e[35];let B;e[36]!==T||e[37]!==R?(B=(0,s.jsxs)("div",{className:"flex justify-between items-end -mt-12 sm:-mt-16 mb-4 relative z-10",children:[R,T]}),e[36]=T,e[37]=R,e[38]=B):B=e[38];let W;e[39]!==o.name?(W=(0,s.jsx)("h1",{className:"text-2xl sm:text-3xl font-black dark:text-white tracking-tight leading-tight",children:o.name}),e[39]=o.name,e[40]=W):W=e[40];let J;e[41]!==o.handle?(J=(0,s.jsxs)("p",{className:"text-zinc-500 font-bold text-sm sm:text-base",children:["c/",o.handle]}),e[41]=o.handle,e[42]=J):J=e[42];let K;e[43]!==o.description?(K=o.description&&(0,s.jsx)("p",{className:"mt-4 text-[15px] sm:text-base dark:text-zinc-300 leading-relaxed max-w-2xl",children:o.description}),e[43]=o.description,e[44]=K):K=e[44];let G;e[45]!==o.membersCount?(G=(0,s.jsx)("span",{className:"text-base font-extrabold text-zinc-900 dark:text-white transition-colors",children:o.membersCount}),e[45]=o.membersCount,e[46]=G):G=e[46];let ne;e[47]===Symbol.for("react.memo_cache_sentinel")?(ne=(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400 font-medium",children:"Members"}),e[47]=ne):ne=e[47];let se;e[48]!==G?(se=(0,s.jsxs)("button",{className:"flex gap-x-1.5 group cursor-pointer items-baseline",children:[G,ne]}),e[48]=G,e[49]=se):se=e[49];let le;e[50]!==o.postsCount?(le=(0,s.jsx)("span",{className:"text-base font-extrabold text-zinc-900 dark:text-white transition-colors",children:o.postsCount}),e[50]=o.postsCount,e[51]=le):le=e[51];let X;e[52]===Symbol.for("react.memo_cache_sentinel")?(X=(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400 font-medium",children:"Posts"}),e[52]=X):X=e[52];let ee;e[53]!==le?(ee=(0,s.jsxs)("button",{className:"flex gap-x-1.5 group cursor-pointer items-baseline",children:[le,X]}),e[53]=le,e[54]=ee):ee=e[54];let q;e[55]!==se||e[56]!==ee?(q=(0,s.jsxs)("div",{className:"flex gap-4 sm:gap-6 text-sm pt-2 relative z-10",children:[se,ee]}),e[55]=se,e[56]=ee,e[57]=q):q=e[57];let V;e[58]!==W||e[59]!==J||e[60]!==K||e[61]!==q?(V=(0,s.jsxs)("div",{className:"space-y-1",children:[W,J,K,q]}),e[58]=W,e[59]=J,e[60]=K,e[61]=q,e[62]=V):V=e[62];let Y;e[63]!==B||e[64]!==V?(Y=(0,s.jsxs)("div",{className:"px-4 pb-6",children:[B,V]}),e[63]=B,e[64]=V,e[65]=Y):Y=e[65];let ae;e[66]!==Y||e[67]!==$?(ae=(0,s.jsxs)("div",{className:"relative",children:[$,Y]}),e[66]=Y,e[67]=$,e[68]=ae):ae=e[68];let Z;e[69]!==w||e[70]!==o.id||e[71]!==o.name||e[72]!==x||e[73]!==j||e[74]!==p||e[75]!==d||e[76]!==v||e[77]!==h||e[78]!==y?(Z=(0,s.jsx)("div",{className:"border-t border-zinc-100 dark:border-zinc-800",children:h?(0,s.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,s.jsx)(oe,{className:"animate-spin text-violet-500",size:32})}):x.length>0?(0,s.jsxs)(s.Fragment,{children:[x.map(xe=>(0,s.jsx)(at,{currentUser:j,showToast:w,...xe,onClick:()=>y(`/post/${xe.id}`),onUserClick:ye=>y(`/u/${ye}`)},xe.feed_id||xe.id)),p&&(0,s.jsx)("div",{className:"p-6 flex justify-center",children:(0,s.jsxs)(ue,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>v(o.id,!0),disabled:d,children:[d&&(0,s.jsx)(oe,{size:18,className:"animate-spin mr-2"}),"Load more"]})})]}):(0,s.jsxs)("div",{className:"p-20 text-center text-zinc-500 flex flex-col items-center gap-4",children:[(0,s.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full mb-2",children:(0,s.jsx)(et,{size:40,className:"text-zinc-300"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"No posts here yet"}),(0,s.jsxs)("p",{className:"text-sm max-w-[250px]",children:["Be the first to share something in ",o.name,"!"]})]})}),e[69]=w,e[70]=o.id,e[71]=o.name,e[72]=x,e[73]=j,e[74]=p,e[75]=d,e[76]=v,e[77]=h,e[78]=y,e[79]=Z):Z=e[79];let ce;e[80]!==ae||e[81]!==Z||e[82]!==L?(ce=(0,s.jsxs)("div",{className:"relative",children:[L,ae,Z]}),e[80]=ae,e[81]=Z,e[82]=L,e[83]=ce):ce=e[83];let me;e[84]!==_||e[85]!==o||e[86]!==a?(me=_&&(0,s.jsx)("button",{onClick:()=>a(o),className:"fixed bottom-20 right-5 md:hidden z-50 bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 size-12 rounded-full flex items-center justify-center shadow-2xl hover:scale-110 active:scale-90 transition-all cursor-pointer group",title:`Post to ${o.name}`,children:(0,s.jsx)(We,{size:28,className:"group-hover:rotate-90 transition-transform duration-300"})}),e[84]=_,e[85]=o,e[86]=a,e[87]=me):me=e[87];let pe;e[88]===Symbol.for("react.memo_cache_sentinel")?(pe=()=>n(!1),e[88]=pe):pe=e[88];let de;e[89]!==o||e[90]!==i?(de=(0,s.jsx)(Oo,{isOpen:i,onClose:pe,community:o,onUpdate:ed}),e[89]=o,e[90]=i,e[91]=de):de=e[91];let fe;e[92]===Symbol.for("react.memo_cache_sentinel")?(fe=()=>l(!1),e[92]=fe):fe=e[92];let we;e[93]!==o||e[94]!==r?(we=(0,s.jsx)(Uo,{isOpen:r,onClose:fe,community:o}),e[93]=o,e[94]=r,e[95]=we):we=e[95];let Ne;return e[96]!==ce||e[97]!==me||e[98]!==de||e[99]!==we?(Ne=(0,s.jsxs)("div",{className:"border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen pb-20",children:[ce,me,de,we]}),e[96]=ce,e[97]=me,e[98]=de,e[99]=we,e[100]=Ne):Ne=e[100],Ne},Gc=Zc;function ed(){window.location.reload()}var td=Q(),sd=()=>{const t=(0,td.c)(51),{addToast:e}=ze(),{currentUser:a,searchQuery:i,setSearchQuery:n,activeTab:r,setActiveTab:l,isCreateModalOpen:o,setIsCreateModalOpen:c,communitiesData:f,isCommunitiesLoading:u,isFetchingMoreCommunities:m,hasMoreCommunities:x,postsData:h,isPostsLoading:d,isFetchingMorePosts:p,hasMorePosts:g,filteredCommunities:v,handleCommunityClick:j,loadCommunities:w,loadPosts:y,navigate:N}=Rc();if((u||d)&&!f.length&&!h.length){let C;return t[0]===Symbol.for("react.memo_cache_sentinel")?(C=(0,s.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:[1,2,3].map(id)}),t[0]=C):C=t[0],C}let _;t[1]!==n?(_=()=>n(""),t[1]=n,t[2]=_):_=t[2];let P;t[3]!==i||t[4]!==n||t[5]!==_?(P=(0,s.jsx)(kt,{value:i,onChange:n,onClear:_,placeholder:"Search communities or posts...",className:"flex-1"}),t[3]=i,t[4]=n,t[5]=_,t[6]=P):P=t[6];let M;t[7]!==a||t[8]!==c?(M=a&&(0,s.jsx)("button",{onClick:()=>c(!0),className:"size-11 rounded-xl bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 flex items-center justify-center hover:scale-105 active:scale-95 transition-all shadow-sm shrink-0",title:"Create Community",children:(0,s.jsx)(We,{size:22,strokeWidth:3})}),t[7]=a,t[8]=c,t[9]=M):M=t[9];let k;t[10]!==P||t[11]!==M?(k=(0,s.jsxs)("div",{className:"p-4 flex gap-2",children:[P,M]}),t[10]=P,t[11]=M,t[12]=k):k=t[12];let A;t[13]===Symbol.for("react.memo_cache_sentinel")?(A=(0,s.jsxs)(mt,{value:"communities",className:"h-full rounded-none border-b-2 border-transparent data-[state=active]:border-violet-600 data-[state=active]:bg-transparent px-2 font-bold text-zinc-500 data-[state=active]:text-zinc-950 dark:data-[state=active]:text-white transition-all gap-2",children:[(0,s.jsx)(et,{size:18}),"Communities"]}),t[13]=A):A=t[13];let S;t[14]===Symbol.for("react.memo_cache_sentinel")?(S=(0,s.jsxs)(Gt,{className:"w-full h-12 bg-transparent p-0 rounded-none border-none gap-8 px-4",children:[A,(0,s.jsxs)(mt,{value:"posts",className:"h-full rounded-none border-b-2 border-transparent data-[state=active]:border-violet-600 data-[state=active]:bg-transparent px-2 font-bold text-zinc-500 data-[state=active]:text-zinc-950 dark:data-[state=active]:text-white transition-all gap-2",children:[(0,s.jsx)(wt,{size:18}),"Posts"]})]}),t[14]=S):S=t[14];let I;t[15]!==r||t[16]!==l?(I=(0,s.jsx)("div",{className:"px-1 border-t border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)(Zt,{value:r,onValueChange:l,className:"w-full",children:S})}),t[15]=r,t[16]=l,t[17]=I):I=t[17];let L;t[18]!==k||t[19]!==I?(L=(0,s.jsxs)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-10 border-b border-zinc-100 dark:border-zinc-800",children:[k,I]}),t[18]=k,t[19]=I,t[20]=L):L=t[20];let $;t[21]!==r||t[22]!==v||t[23]!==j||t[24]!==x||t[25]!==m||t[26]!==w?($=r==="communities"&&(0,s.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:[v.length>0?v.map(C=>(0,s.jsx)(Sa,{profile:C,onUserClick:j,isCommunity:!0},C.handle)):(0,s.jsx)("div",{className:"p-20 text-center text-zinc-500",children:(0,s.jsx)("p",{className:"font-bold",children:"No communities found"})}),x&&v.length>0&&(0,s.jsx)("div",{className:"p-6 flex justify-center border-t border-zinc-100 dark:border-zinc-800",children:(0,s.jsxs)(ue,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>w(!0),disabled:m,children:[m&&(0,s.jsx)(oe,{size:18,className:"animate-spin mr-2"}),"Load more"]})})]}),t[21]=r,t[22]=v,t[23]=j,t[24]=x,t[25]=m,t[26]=w,t[27]=$):$=t[27];let R;t[28]!==r||t[29]!==e||t[30]!==a||t[31]!==g||t[32]!==p||t[33]!==d||t[34]!==y||t[35]!==N||t[36]!==h||t[37]!==i?(R=r==="posts"&&(0,s.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:h.length>0?(0,s.jsxs)(s.Fragment,{children:[h.map(C=>(0,s.jsx)(at,{currentUser:a,showToast:e,...C,onClick:()=>N(`/post/${C.id}`),onUserClick:T=>N(`/u/${T}`)},C.feed_id||C.id)),g&&(0,s.jsx)("div",{className:"p-6 flex justify-center border-t border-zinc-100 dark:border-zinc-800",children:(0,s.jsxs)(ue,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>y(!0),disabled:p,children:[p&&(0,s.jsx)(oe,{size:18,className:"animate-spin mr-2"}),"Load more"]})})]}):d?(0,s.jsx)("div",{className:"p-20 flex justify-center",children:(0,s.jsx)(oe,{className:"animate-spin text-violet-500",size:32})}):(0,s.jsxs)("div",{className:"p-20 text-center text-zinc-500 flex flex-col items-center gap-3",children:[(0,s.jsx)("div",{className:"p-4 bg-zinc-50 dark:bg-zinc-900 rounded-full",children:(0,s.jsx)(wt,{size:32,className:"text-zinc-300"})}),(0,s.jsx)("p",{className:"font-bold",children:i?`No posts found matching "${i}"`:"No posts found"})]})}),t[28]=r,t[29]=e,t[30]=a,t[31]=g,t[32]=p,t[33]=d,t[34]=y,t[35]=N,t[36]=h,t[37]=i,t[38]=R):R=t[38];let E;t[39]!==$||t[40]!==R?(E=(0,s.jsxs)("div",{className:"min-h-screen",children:[$,R]}),t[39]=$,t[40]=R,t[41]=E):E=t[41];let O;t[42]!==c?(O=()=>c(!1),t[42]=c,t[43]=O):O=t[43];let F;t[44]!==o||t[45]!==O?(F=(0,s.jsx)(Fo,{isOpen:o,onClose:O}),t[44]=o,t[45]=O,t[46]=F):F=t[46];let z;return t[47]!==E||t[48]!==F||t[49]!==L?(z=(0,s.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen pb-20 shadow-sm",children:[L,E,F]}),t[47]=E,t[48]=F,t[49]=L,t[50]=z):z=t[50],z},ad=sd;function id(t){return(0,s.jsx)(Xt,{},t)}var nd=Q(),rd=t=>{const e=(0,nd.c)(24),{user:a,onClick:i,isAddStory:n,isSeen:r}=t,l=n===void 0?!1:n,o=`relative p-0.5 rounded-full ${l?"bg-transparent":r!==void 0&&r?"bg-zinc-200 dark:bg-zinc-800":"bg-gradient-to-tr from-yellow-400 via-pink-500 to-violet-600"}`;let c;e[0]!==a.avatar||e[1]!==a.handle?(c=(0,s.jsx)(be,{src:a.avatar,alt:a.handle,className:"object-cover"}),e[0]=a.avatar,e[1]=a.handle,e[2]=c):c=e[2];let f;e[3]!==a.handle?.[0]?(f=a.handle?.[0]?.toUpperCase(),e[3]=a.handle?.[0],e[4]=f):f=e[4];let u;e[5]!==f?(u=(0,s.jsx)(ve,{children:f}),e[5]=f,e[6]=u):u=e[6];let m;e[7]!==c||e[8]!==u?(m=(0,s.jsxs)(ge,{className:"size-14 sm:size-16 border border-zinc-100 dark:border-zinc-800",children:[c,u]}),e[7]=c,e[8]=u,e[9]=m):m=e[9];let x;e[10]!==l?(x=l&&(0,s.jsx)("div",{className:"absolute bottom-0 right-0 bg-violet-600 border-2 border-white dark:border-black rounded-full p-1 text-white shadow-lg",children:(0,s.jsx)(We,{size:14,strokeWidth:3})}),e[10]=l,e[11]=x):x=e[11];let h;e[12]!==m||e[13]!==x?(h=(0,s.jsx)("div",{className:"bg-white dark:bg-black rounded-full p-0.5",children:(0,s.jsxs)("div",{className:"relative",children:[m,x]})}),e[12]=m,e[13]=x,e[14]=h):h=e[14];let d;e[15]!==o||e[16]!==h?(d=(0,s.jsx)("div",{className:o,children:h}),e[15]=o,e[16]=h,e[17]=d):d=e[17];const p=l?"Add Story":a.handle;let g;e[18]!==p?(g=(0,s.jsx)("span",{className:"text-[11px] font-semibold text-zinc-600 dark:text-zinc-400 truncate w-16 text-center leading-tight",children:p}),e[18]=p,e[19]=g):g=e[19];let v;return e[20]!==i||e[21]!==d||e[22]!==g?(v=(0,s.jsxs)("button",{onClick:i,className:"flex flex-col items-center gap-2 group shrink-0",children:[d,g]}),e[20]=i,e[21]=d,e[22]=g,e[23]=v):v=e[23],v},bs=rd,ld=Q(),od=t=>{const e=(0,ld.c)(35),{onStoryClick:a,onAddStory:i}=t,{currentUser:n,homePosts:r,groupedStories:l,isPostsLoading:o,isStoriesLoading:c,hasMore:f,isFetchingNextPage:u,addToast:m,ref:x,handlePostClick:h,handleUserClick:d}=Ic();if(o||c){let k;return e[0]===Symbol.for("react.memo_cache_sentinel")?(k=(0,s.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:[(0,s.jsxs)(xs,{className:"w-full whitespace-nowrap border-b border-zinc-100 dark:border-zinc-800",children:[(0,s.jsxs)("div",{className:"flex w-max gap-3 py-4 px-4",children:[(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"}),(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"}),(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"})]}),(0,s.jsx)(qt,{orientation:"horizontal",className:"hidden"})]}),[1,2,3].map(dd)]}),e[0]=k):k=e[0],k}let p;e[1]!==n||e[2]!==i?(p=n&&(0,s.jsx)(bs,{user:n,isAddStory:!0,onClick:i}),e[1]=n,e[2]=i,e[3]=p):p=e[3];let g;if(e[4]!==l||e[5]!==a){let k;e[7]!==a?(k=A=>{const S=JSON.parse(localStorage.getItem("seenStories")||"[]").includes(A.user.id);return(0,s.jsx)(bs,{user:A.user,isSeen:S,onClick:()=>a(A)},A.user.id)},e[7]=a,e[8]=k):k=e[8],g=l.map(k),e[4]=l,e[5]=a,e[6]=g}else g=e[6];let v;e[9]!==p||e[10]!==g?(v=(0,s.jsxs)("div",{className:"flex w-max gap-4 py-4 px-4",children:[p,g]}),e[9]=p,e[10]=g,e[11]=v):v=e[11];let j;e[12]===Symbol.for("react.memo_cache_sentinel")?(j=(0,s.jsx)(qt,{orientation:"horizontal",className:"hidden"}),e[12]=j):j=e[12];let w;e[13]!==v?(w=(0,s.jsxs)(xs,{className:"w-full border-b border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black",children:[v,j]}),e[13]=v,e[14]=w):w=e[14];let y;e[15]!==n?(y=!n&&(0,s.jsx)("div",{className:"px-4 py-2 md:hidden",children:(0,s.jsx)(Ra,{className:"p-6"})}),e[15]=n,e[16]=y):y=e[16];let N;e[17]!==m||e[18]!==n||e[19]!==h||e[20]!==d||e[21]!==r?(N=r.length>0?r.map(k=>(0,s.jsx)(at,{...k,currentUser:n,showToast:m,onClick:()=>h(k.id),onUserClick:d},k.feed_id||k.id)):(0,s.jsxs)("div",{className:"p-20 text-center text-zinc-500",children:[(0,s.jsx)("p",{className:"text-lg font-medium",children:"No posts yet."}),(0,s.jsx)("p",{className:"text-sm",children:"Be the first to share something amazing!"})]}),e[17]=m,e[18]=n,e[19]=h,e[20]=d,e[21]=r,e[22]=N):N=e[22];let _;e[23]!==f||e[24]!==r.length||e[25]!==u||e[26]!==x?(_=r.length>0&&(0,s.jsx)("div",{ref:x,className:"py-8 flex justify-center",children:u?(0,s.jsx)(oe,{className:"animate-spin text-violet-500",size:24}):f?(0,s.jsx)("div",{className:"h-4"}):(0,s.jsx)("p",{className:"text-sm text-zinc-500 font-medium",children:"You've reached the end of the feed."})}),e[23]=f,e[24]=r.length,e[25]=u,e[26]=x,e[27]=_):_=e[27];let P;e[28]!==N||e[29]!==_?(P=(0,s.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen pb-20 shadow-sm",children:[N,_]}),e[28]=N,e[29]=_,e[30]=P):P=e[30];let M;return e[31]!==w||e[32]!==y||e[33]!==P?(M=(0,s.jsxs)("div",{className:"w-full max-w-full overflow-hidden",children:[w,y,P]}),e[31]=w,e[32]=y,e[33]=P,e[34]=M):M=e[34],M},cd=od;function dd(t){return(0,s.jsx)(Xt,{},t)}var md=Q(),ud=t=>{const e=(0,md.c)(55),{conv:a,selectedId:i,onSelect:n,onlineUsers:r}=t,l=je(),o=Ia(a.user?.lastSeen);let c;e[0]!==a.user?.id||e[1]!==r?(c=r.has(a.user?.id),e[0]=a.user?.id,e[1]=r,e[2]=c):c=e[2];const f=c;let u;e[3]!==a.user||e[4]!==l?(u=O=>{O.stopPropagation(),a.user?.handle&&l(`/u/${a.user.handle}`)},e[3]=a.user,e[4]=l,e[5]=u):u=e[5];const m=u;let x;e[6]!==a||e[7]!==n?(x=()=>n(a),e[6]=a,e[7]=n,e[8]=x):x=e[8];const h=`flex items-center gap-3 p-4 cursor-pointer transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900 ${i===a.id?"bg-zinc-50 dark:bg-zinc-900 border-r-2 border-violet-500":""}`,d=a.user?.avatar,p=a.user?.name;let g;e[9]!==d||e[10]!==p?(g=(0,s.jsx)(be,{src:d,alt:p,className:"object-cover"}),e[9]=d,e[10]=p,e[11]=g):g=e[11];let v;e[12]!==a.user?.name?.[0]?(v=a.user?.name?.[0]?.toUpperCase(),e[12]=a.user?.name?.[0],e[13]=v):v=e[13];let j;e[14]!==v?(j=(0,s.jsx)(ve,{children:v}),e[14]=v,e[15]=j):j=e[15];let w;e[16]!==g||e[17]!==j?(w=(0,s.jsxs)(ge,{className:"size-12 group-hover:brightness-90 transition-all",children:[g,j]}),e[16]=g,e[17]=j,e[18]=w):w=e[18];let y;e[19]!==f?(y=f&&(0,s.jsx)("span",{className:"absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full"}),e[19]=f,e[20]=y):y=e[20];let N;e[21]!==m||e[22]!==w||e[23]!==y?(N=(0,s.jsxs)("div",{className:"relative group",onClick:m,children:[w,y]}),e[21]=m,e[22]=w,e[23]=y,e[24]=N):N=e[24];const _=a.user?.name;let P;e[25]!==m||e[26]!==_?(P=(0,s.jsx)("span",{onClick:m,className:"font-bold dark:text-white truncate cursor-pointer",children:_}),e[25]=m,e[26]=_,e[27]=P):P=e[27];let M;e[28]!==a.user?.lastSeen||e[29]!==f||e[30]!==o?(M=f?(0,s.jsx)("span",{className:"text-[10px] text-emerald-500 font-medium leading-none mb-1",children:"Online"}):a.user?.lastSeen&&(0,s.jsx)("span",{className:"text-[10px] text-zinc-500 font-medium leading-none mb-1",children:o}),e[28]=a.user?.lastSeen,e[29]=f,e[30]=o,e[31]=M):M=e[31];let k;e[32]!==P||e[33]!==M?(k=(0,s.jsxs)("div",{className:"flex flex-col min-w-0",children:[P,M]}),e[32]=P,e[33]=M,e[34]=k):k=e[34];let A;e[35]!==a.time?(A=(0,s.jsx)("span",{className:"text-xs text-zinc-500 whitespace-nowrap ml-2",children:a.time}),e[35]=a.time,e[36]=A):A=e[36];let S;e[37]!==k||e[38]!==A?(S=(0,s.jsxs)("div",{className:"flex justify-between items-center mb-0.5",children:[k,A]}),e[37]=k,e[38]=A,e[39]=S):S=e[39];let I;e[40]!==a.lastMessage?(I=(0,s.jsx)("p",{className:"text-zinc-500 text-sm truncate pr-2",children:a.lastMessage}),e[40]=a.lastMessage,e[41]=I):I=e[41];let L;e[42]!==a.unread?(L=a.unread>0&&(0,s.jsx)("span",{className:"bg-violet-600 text-white text-[10px] font-bold size-5 rounded-full flex items-center justify-center shrink-0",children:a.unread}),e[42]=a.unread,e[43]=L):L=e[43];let $;e[44]!==I||e[45]!==L?($=(0,s.jsxs)("div",{className:"flex-1 flex justify-between items-center",children:[I,L]}),e[44]=I,e[45]=L,e[46]=$):$=e[46];let R;e[47]!==S||e[48]!==$?(R=(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[S,$]}),e[47]=S,e[48]=$,e[49]=R):R=e[49];let E;return e[50]!==N||e[51]!==R||e[52]!==x||e[53]!==h?(E=(0,s.jsxs)("div",{onClick:x,className:h,children:[N,R]}),e[50]=N,e[51]=R,e[52]=x,e[53]=h,e[54]=E):E=e[54],E},fd=({conversations:t,userResults:e=[],onSelect:a,onStartNew:i,selectedId:n,searchQuery:r,onSearchChange:l,onlineUsers:o=new Set})=>(0,s.jsxs)("div",{className:"flex-1 flex flex-col min-w-0 bg-white dark:bg-black",children:[(0,s.jsx)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)(kt,{value:r,onChange:l,onClear:()=>l(""),placeholder:"Search people or messages..."})}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[t.length>0&&(0,s.jsx)("div",{className:"py-2",children:t.filter(c=>c.lastMessage!=="No messages yet"||c.id===n).map(c=>(0,s.jsx)(ud,{conv:c,selectedId:n,onSelect:a,onlineUsers:o},c.id))}),e.length>0&&(0,s.jsxs)("div",{className:"border-t border-zinc-100 dark:border-zinc-800",children:[(0,s.jsx)("div",{className:"px-4 py-3 text-xs font-bold text-zinc-500 uppercase tracking-wider",children:"People"}),e.map(c=>(0,s.jsxs)("div",{onClick:()=>i(c),className:"flex items-center gap-3 p-4 cursor-pointer transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[(0,s.jsxs)(ge,{className:"size-12",children:[(0,s.jsx)(be,{src:c.avatar,alt:c.name,className:"object-cover"}),(0,s.jsx)(ve,{children:c.name?.[0]?.toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"font-bold dark:text-white truncate",children:c.name}),(0,s.jsxs)("div",{className:"text-zinc-500 text-sm truncate",children:["@",c.handle]})]}),(0,s.jsx)(ks,{size:18,className:"text-violet-500"})]},c.id))]}),t.length===0&&e.length===0&&r&&(0,s.jsx)("div",{className:"p-8 text-center",children:(0,s.jsxs)("p",{className:"text-zinc-500 text-sm",children:['No conversations or people found for "',r,'"']})}),t.length===0&&!r&&(0,s.jsx)("div",{className:"p-8 text-center",children:(0,s.jsx)("p",{className:"text-zinc-500 text-sm",children:"No messages yet. Search for people to start a chat!"})})]})]}),xd=fd,hd=Q(),pd=["","","","","",""],gd=t=>{const e=(0,hd.c)(6),{onSelect:a,currentReaction:i}=t;let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,s.jsx)(ka,{asChild:!0,children:(0,s.jsx)("button",{className:"p-1.5 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-300 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full transition-all active:scale-90",onClick:vd,children:(0,s.jsx)(qs,{size:16})})}),e[0]=n):n=e[0];let r;e[1]!==i||e[2]!==a?(r=pd.map(o=>(0,s.jsx)("button",{onClick:()=>a(o),className:`text-xl p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full transition-all active:scale-125 ${i===o?"bg-zinc-100 dark:bg-zinc-800":""}`,children:o},o)),e[1]=i,e[2]=a,e[3]=r):r=e[3];let l;return e[4]!==r?(l=(0,s.jsxs)(Na,{children:[n,(0,s.jsx)(_a,{side:"top",align:"center",className:"w-fit p-1 rounded-full bg-white dark:bg-zinc-900 border border-zinc-100 dark:border-zinc-800 shadow-xl",onClick:jd,children:(0,s.jsx)("div",{className:"flex items-center gap-1",children:r})})]}),e[4]=r,e[5]=l):l=e[5],l},bd=gd;function vd(t){return t.stopPropagation()}function jd(t){return t.stopPropagation()}var wd=Q(),yd=t=>{const e=(0,wd.c)(10),{reactions:a,currentUser:i,onToggle:n}=t;let r;e[0]!==a?(r=a===void 0?[]:a,e[0]=a,e[1]=r):r=e[1];const l=r;let o;e[2]!==i?.id||e[3]!==l?(o={},l.forEach(m=>{o[m.emoji]||(o[m.emoji]={count:0,me:!1}),o[m.emoji].count=o[m.emoji].count+1,m.user_id===i?.id&&(o[m.emoji].me=!0)}),e[2]=i?.id,e[3]=l,e[4]=o):o=e[4];const c=o;if(l.length===0)return null;let f;e[5]!==c?(f=Object.entries(c),e[5]=c,e[6]=f):f=e[6];let u;return e[7]!==n||e[8]!==f?(u=(0,s.jsx)("div",{className:"flex flex-wrap gap-1 mt-1 px-2",children:f.map(m=>{const[x,h]=m;return(0,s.jsxs)("button",{onClick:d=>{d.stopPropagation(),n(x)},className:`flex items-center gap-1.5 px-2 py-0.5 rounded-full text-xs font-medium border transition-all active:scale-90 ${h.me?"bg-violet-50 border-violet-200 text-violet-600 dark:bg-violet-900/30 dark:border-violet-800 dark:text-violet-400":"bg-white border-zinc-100 text-zinc-600 dark:bg-zinc-900 dark:border-zinc-800 dark:text-zinc-400"}`,children:[(0,s.jsx)("span",{children:x}),h.count>1&&(0,s.jsx)("span",{children:h.count})]},x)})}),e[7]=n,e[8]=f,e[9]=u):u=e[9],u},zd=yd,Nd=["","","","","",""],kd=({conversation:t,messages:e,onBack:a,onSendMessage:i,onToggleReaction:n,onDeleteMessage:r,currentUser:l,onTyping:o,isLoading:c,isTyping:f,isOnline:u})=>{const m=je(),{openLightbox:x}=Qt(),[h,d]=(0,b.useState)(""),[p,g]=(0,b.useState)(!1),[v,j]=(0,b.useState)([]),[w,y]=(0,b.useState)(!1),[N,_]=(0,b.useState)(null),P=(0,b.useRef)(null),M=(0,b.useRef)(null),k=(0,b.useRef)(null),A=Ia(t.user?.lastSeen);(0,b.useEffect)(()=>{M.current&&(M.current.scrollTop=M.current.scrollHeight)},[e,f]);const S=z=>{const C=z.target.value;d(C),o&&(o(!0),k.current&&clearTimeout(k.current),k.current=setTimeout(()=>{o(!1)},2e3))},I=z=>{d(C=>C+z.emoji)},L=z=>{z.preventDefault(),!(!h.trim()&&v.length===0)&&(o&&(clearTimeout(k.current),o(!1)),i(t.id,h,v.length>0?"image":"text",v,N?.id),d(""),j([]),_(null))},$=async z=>{const C=Array.from(z.target.files);if(C.length!==0){g(!0);try{const T=await Promise.all(C.map(B=>Ae(B)));j(B=>[...B,...T])}catch(T){console.error("Upload failed:",T)}finally{g(!1)}}},R=z=>{j(C=>C.filter(T=>T.url!==z))},E=z=>{!z.media||z.media.length===0||x(z.media.map(C=>C.url),0)},O=(0,b.useMemo)(()=>{const z=e.filter(C=>C.sender==="me");return z.length>0?z[z.length-1].id:null},[e]),F=z=>e.find(C=>C.id===z);return(0,s.jsxs)("div",{className:"flex-1 flex flex-col h-full min-w-0 bg-white dark:bg-black md:border-l md:border-zinc-100 dark:md:border-zinc-800",children:[(0,s.jsxs)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800 flex items-center justify-between shrink-0 bg-white/80 dark:bg-black/80 backdrop-blur-md sticky top-0 z-10",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("button",{onClick:a,className:"md:hidden p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:(0,s.jsx)(tt,{size:20})}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)(ge,{className:"size-10 border border-zinc-200 dark:border-zinc-700",children:[(0,s.jsx)(be,{src:t.user.avatar,alt:t.user.name,className:"object-cover"}),(0,s.jsx)(ve,{children:t.user.name?.[0]?.toUpperCase()})]}),u&&(0,s.jsx)("span",{className:"absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-bold dark:text-white",children:t.user.name}),u?(0,s.jsxs)("div",{className:"text-xs text-emerald-500 font-medium flex items-center gap-1",children:[(0,s.jsx)("span",{className:"size-1.5 bg-emerald-500 rounded-full animate-pulse"}),"Online"]}):(0,s.jsx)("div",{className:"text-xs text-zinc-500 font-medium",children:t.user.lastSeen?`Last seen ${A}`:"Offline"})]})]}),(0,s.jsx)("button",{className:"p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full dark:text-zinc-400",children:(0,s.jsx)(si,{size:20})})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",ref:M,children:[(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsxs)("div",{className:"relative w-fit mx-auto",children:[(0,s.jsxs)(ge,{className:"size-20 mx-auto mb-3 border-4 border-zinc-50 dark:border-zinc-900 shadow-sm",children:[(0,s.jsx)(be,{src:t.user.avatar,alt:t.user.name,className:"object-cover"}),(0,s.jsx)(ve,{className:"text-2xl font-bold",children:t.user.name?.[0]?.toUpperCase()})]}),u&&(0,s.jsx)("span",{className:"absolute bottom-4 right-1 size-5 bg-emerald-500 border-4 border-white dark:border-black rounded-full animate-in zoom-in duration-300"})]}),(0,s.jsx)("h4",{className:"font-bold dark:text-white text-lg",children:t.user.name}),(0,s.jsxs)("p",{className:"text-sm text-zinc-500",children:["@",t.user.handle]}),(0,s.jsxs)("p",{className:"text-xs text-zinc-400 mt-4 max-w-xs mx-auto",children:["This is the beginning of your direct message history with"," ",(0,s.jsxs)("span",{className:"font-bold",children:["@",t.user.handle]})]})]}),c&&e.length===0?(0,s.jsx)("div",{className:"flex justify-center p-8",children:(0,s.jsx)(oe,{className:"animate-spin text-violet-500",size:32})}):e.map(z=>(0,s.jsxs)(Sl,{children:[(0,s.jsx)(Pl,{asChild:!0,children:(0,s.jsxs)("div",{id:`msg-${z.id}`,className:`flex items-end gap-2 group ${z.sender==="me"?"flex-row-reverse":"flex-row"}`,children:[(0,s.jsxs)("div",{className:`max-w-[75%] p-1 rounded-2xl text-[15px] shadow-sm relative ${z.sender==="me"?"bg-violet-600 text-white rounded-tr-none":"bg-zinc-100 dark:bg-zinc-800 dark:text-white rounded-tl-none"}`,children:[z.replyToId&&(0,s.jsxs)("div",{className:`mb-2 p-2 rounded-lg border-l-4 text-xs truncate cursor-pointer ${z.sender==="me"?"bg-violet-500/50 border-violet-300 text-violet-100":"bg-zinc-200/50 dark:bg-zinc-700/50 border-zinc-400 dark:border-zinc-500 text-zinc-600 dark:text-zinc-300"}`,onClick:C=>{C.stopPropagation(),document.getElementById(`msg-${z.replyToId}`)?.scrollIntoView({behavior:"smooth",block:"center"})},children:[(0,s.jsx)("span",{className:"font-bold block mb-0.5",children:F(z.replyToId)?.sender==="me"?"You":t.user.name}),F(z.replyToId)?.text||"Media"]}),z.media?.length>0&&(0,s.jsx)("div",{className:"mb-2 grid gap-1 grid-cols-1 overflow-hidden rounded-lg cursor-pointer",onClick:()=>E(z),children:z.media.map((C,T)=>(0,s.jsx)("img",{src:C.url,alt:"",className:"max-h-60 w-full object-cover rounded-md hover:brightness-90 transition-all"},T))}),z.text&&(0,s.jsx)("div",{className:"m-0 leading-tight px-3 py-1 whitespace-pre-line break-words",children:(0,s.jsx)(xt,{options:{...bt,render:({attributes:C,content:T})=>{const{href:B,...W}=C,J=!B.startsWith("/")&&(B.startsWith("http")||B.startsWith("www"));return B.startsWith("/u/")||B.startsWith("/tags/")||B.startsWith("/c/")||B.startsWith("/explore")?(0,s.jsx)("span",{...W,className:`underline decoration-2 underline-offset-2 cursor-pointer transition-opacity break-all ${z.sender==="me"?"text-white":"text-rose-500 dark:text-rose-400"}`,onClick:K=>{K.stopPropagation(),m(B)},children:T},T):(0,s.jsx)("a",{href:B,...W,className:`underline decoration-2 underline-offset-2 hover:opacity-80 transition-opacity break-all ${z.sender==="me"?"text-white":""}`,target:J?"_blank":void 0,rel:J?"noopener noreferrer":void 0,onClick:K=>K.stopPropagation(),children:T},T)}},children:z.text})}),z.reactions?.length>0&&(0,s.jsx)(zd,{reactions:z.reactions,currentUser:l,onToggle:C=>n(z.id,C)}),(0,s.jsxs)("div",{className:`text-[10px] flex items-center justify-end gap-1 px-3 pb-1 ${z.sender==="me"?"text-violet-200":"text-zinc-400"}`,children:[z.time,z.sender==="me"&&z.id===O&&(0,s.jsx)("span",{className:"ml-0.5",children:z.isRead?(0,s.jsx)(li,{size:14,className:"text-white"}):(0,s.jsx)(Ns,{size:14,className:"text-violet-200"})})]})]}),(0,s.jsx)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)(bd,{onSelect:C=>n(z.id,C),currentReaction:z.reactions?.find(C=>C.user_id===l?.id)?.emoji})})]})}),(0,s.jsxs)($l,{className:"w-64 rounded-xl bg-white dark:bg-zinc-950 border-zinc-100 dark:border-zinc-800 shadow-xl",children:[(0,s.jsx)(Al,{className:"text-xs text-zinc-500 font-bold px-3 py-2",children:"QUICK REACTION"}),(0,s.jsx)("div",{className:"flex items-center justify-between px-2 pb-2",children:Nd.map(C=>(0,s.jsx)("button",{onClick:()=>n(z.id,C),className:"text-xl p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full transition-all active:scale-125",children:C},C))}),(0,s.jsx)(fs,{className:"bg-zinc-100 dark:bg-zinc-800"}),(0,s.jsxs)(Ft,{className:"gap-3 px-3 py-2.5 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-900",onClick:()=>{navigator.clipboard.writeText(z.text)},children:[(0,s.jsx)(zi,{size:16,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"font-medium",children:"Copy Text"})]}),(0,s.jsxs)(Ft,{className:"gap-3 px-3 py-2.5 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-900",onClick:()=>_(z),children:[(0,s.jsx)(Ii,{size:16,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"font-medium",children:"Reply"})]}),(0,s.jsx)(fs,{className:"bg-zinc-100 dark:bg-zinc-800"}),(0,s.jsxs)(Ft,{className:"gap-3 px-3 py-2.5 cursor-pointer text-rose-500 focus:text-rose-500 focus:bg-rose-50 dark:focus:bg-rose-900/20",onClick:()=>r(z.id),children:[(0,s.jsx)(Et,{size:16}),(0,s.jsx)("span",{className:"font-medium",children:"Delete message"})]})]})]},z.id)),f&&(0,s.jsx)("div",{className:"flex justify-start animate-in fade-in slide-in-from-bottom-2 duration-300",children:(0,s.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-800/50 px-3 py-2 rounded-2xl rounded-tl-none border border-zinc-200/50 dark:border-zinc-700/30 shadow-sm",children:(0,s.jsx)(ko,{})})})]}),(0,s.jsxs)("div",{className:"p-4 border-t border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black shrink-0",children:[N&&(0,s.jsxs)("div",{className:"mb-3 p-3 bg-zinc-50 dark:bg-zinc-900 border border-zinc-100 dark:border-zinc-800 rounded-xl flex items-center justify-between animate-in slide-in-from-bottom-2 duration-200",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("span",{className:"text-xs font-bold text-violet-600 dark:text-violet-400 block mb-1",children:["Replying to"," ",N.sender==="me"?"yourself":t.user.name]}),(0,s.jsx)("p",{className:"text-sm text-zinc-500 truncate",children:N.text||"Media"})]}),(0,s.jsx)("button",{onClick:()=>_(null),className:"p-1 hover:bg-zinc-200 dark:hover:bg-zinc-800 rounded-full text-zinc-400 transition-colors",children:(0,s.jsx)($e,{size:18})})]}),v.length>0&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 mb-3",children:[v.map(z=>(0,s.jsxs)("div",{className:"relative size-16 rounded-xl overflow-hidden border border-zinc-200 dark:border-zinc-800",children:[(0,s.jsx)("img",{src:z.url,className:"size-full object-cover",alt:""}),(0,s.jsx)("button",{type:"button",onClick:()=>R(z.url),className:"absolute top-1 right-1 bg-black/50 text-white rounded-full p-0.5 hover:bg-black transition-colors",children:(0,s.jsx)($e,{size:12})})]},z.url)),p&&(0,s.jsx)("div",{className:"size-16 rounded-xl bg-zinc-100 dark:bg-zinc-900 flex items-center justify-center",children:(0,s.jsx)(oe,{className:"animate-spin text-violet-500",size:20})})]}),(0,s.jsxs)("form",{onSubmit:L,className:"flex items-center gap-2 bg-zinc-100 dark:bg-zinc-900 p-2 rounded-2xl border border-transparent focus-within:border-violet-500 transition-all",children:[(0,s.jsxs)(Na,{open:w,onOpenChange:y,children:[(0,s.jsx)(ka,{asChild:!0,children:(0,s.jsx)("button",{type:"button",className:"p-2 text-zinc-500 hover:text-violet-600 transition-colors",children:(0,s.jsx)(qs,{size:20})})}),(0,s.jsx)(_a,{className:"w-fit p-0 border-none bg-transparent shadow-none",side:"top",align:"start",sideOffset:10,children:(0,s.jsx)(Tl,{onEmojiSelect:z=>{I(z)}})})]}),(0,s.jsx)("input",{type:"text",className:"flex-1 min-w-0 bg-transparent border-none outline-none dark:text-white py-1 px-1",placeholder:"Start a new message",value:h,onChange:S}),(0,s.jsx)("input",{type:"file",ref:P,onChange:$,className:"hidden",multiple:!0,accept:"image/*"}),(0,s.jsx)("button",{type:"button",onClick:()=>P.current?.click(),className:"p-2 text-zinc-500 hover:text-violet-600 transition-colors",disabled:p,children:(0,s.jsx)(Ws,{size:20})}),(0,s.jsx)(ue,{type:"submit",className:"size-10 !p-0 rounded-xl",disabled:!h.trim()&&v.length===0||p,children:(0,s.jsx)(ln,{size:18})})]})]})]})},_d=kd,Cd=Q(),Sd=()=>{const t=(0,Cd.c)(30),{id:e,currentUser:a,onlineUsers:i,msgSearchQuery:n,setMsgSearchQuery:r,userSearchResults:l,filteredConversations:o,selectedConversation:c,localMessages:f,isConvLoading:u,isMsgLoading:m,currentIsTyping:x,otherUserIsOnline:h,handleStartConversation:d,handleSelectConversation:p,sendMessage:g,sendTypingStatus:v,onToggleReaction:j,navigate:w}=Tc();if(!a){let S;return t[0]===Symbol.for("react.memo_cache_sentinel")?(S=(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-screen gap-4 p-8 text-center bg-white dark:bg-black md:rounded-xl md:border border-zinc-100 dark:border-zinc-800",children:[(0,s.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-900 p-4 rounded-full",children:(0,s.jsx)(Ms,{size:40,className:"text-zinc-400"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"Sign in to message others"}),(0,s.jsx)("p",{className:"text-zinc-500 max-w-xs",children:"Start decentralized conversations with anyone on the network."})]}),t[0]=S):S=t[0],S}if(u){let S;return t[1]===Symbol.for("react.memo_cache_sentinel")?(S=(0,s.jsx)("div",{className:"flex h-screen items-center justify-center bg-white dark:bg-black md:rounded-xl md:border border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)(oe,{className:"animate-spin text-violet-500",size:32})}),t[1]=S):S=t[1],S}const y=`flex ${e?"h-[100dvh]":"h-[calc(100dvh-4rem)]"} md:h-[calc(100vh-2rem)] bg-white dark:bg-black overflow-hidden md:rounded-xl md:border border-zinc-100 dark:border-zinc-800`,N=`w-full md:w-80 flex flex-col border-r border-zinc-100 dark:border-zinc-800 ${c?"hidden md:flex":"flex"}`;let _;t[2]===Symbol.for("react.memo_cache_sentinel")?(_=(0,s.jsx)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)("h2",{className:"text-xl font-bold dark:text-white",children:"Messages"})}),t[2]=_):_=t[2];let P;t[3]!==o||t[4]!==p||t[5]!==d||t[6]!==e||t[7]!==n||t[8]!==i||t[9]!==r||t[10]!==l?(P=(0,s.jsx)(xd,{conversations:o,userResults:l,onSelect:p,onStartNew:d,selectedId:e,searchQuery:n,onSearchChange:r,onlineUsers:i}),t[3]=o,t[4]=p,t[5]=d,t[6]=e,t[7]=n,t[8]=i,t[9]=r,t[10]=l,t[11]=P):P=t[11];let M;t[12]!==N||t[13]!==P?(M=(0,s.jsxs)("div",{className:N,children:[_,P]}),t[12]=N,t[13]=P,t[14]=M):M=t[14];let k;t[15]!==x||t[16]!==a||t[17]!==m||t[18]!==f||t[19]!==w||t[20]!==j||t[21]!==h||t[22]!==c||t[23]!==g||t[24]!==v?(k=c?(0,s.jsx)(_d,{conversation:c,messages:f,onBack:()=>w("/messages"),onSendMessage:g,onToggleReaction:j,currentUser:a,onTyping:S=>v(c.id,S),isLoading:m,isTyping:x,isOnline:h}):(0,s.jsxs)("div",{className:"hidden md:flex flex-1 items-center justify-center text-zinc-500 flex-col gap-4",children:[(0,s.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full",children:(0,s.jsx)(Pt,{size:48,className:"text-zinc-300"})}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-zinc-900 dark:text-white",children:"Select a message"}),(0,s.jsx)("p",{children:"Choose from your existing conversations or start a new one."})]})]}),t[15]=x,t[16]=a,t[17]=m,t[18]=f,t[19]=w,t[20]=j,t[21]=h,t[22]=c,t[23]=g,t[24]=v,t[25]=k):k=t[25];let A;return t[26]!==y||t[27]!==M||t[28]!==k?(A=(0,s.jsxs)("div",{className:y,children:[M,k]}),t[26]=y,t[27]=M,t[28]=k,t[29]=A):A=t[29],A},vs=Sd,Pd=Q(),$d=()=>{const t=(0,Pd.c)(18),{currentUser:e,notifications:a,isLoading:i,isFetchingMore:n,hasMore:r,loadNotifications:l,handleNotificationClick:o}=Oc();if(i){let d;return t[0]===Symbol.for("react.memo_cache_sentinel")?(d=(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,s.jsx)(oe,{size:32,className:"animate-spin text-violet-500"})}),t[0]=d):d=t[0],d}if(!e){let d;return t[1]===Symbol.for("react.memo_cache_sentinel")?(d=(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[400px] gap-4 p-8 text-center",children:[(0,s.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-900 p-4 rounded-full",children:(0,s.jsx)(Lt,{size:40,className:"text-zinc-400"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"Sign in to see notifications"}),(0,s.jsx)("p",{className:"text-zinc-500 max-w-xs",children:"Join the conversation and keep track of who's engaging with your content."})]}),t[1]=d):d=t[1],d}const c=Md;let f;t[2]===Symbol.for("react.memo_cache_sentinel")?(f=(0,s.jsx)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800 sticky top-0 bg-white/80 dark:bg-black/80 backdrop-blur-md z-10",children:(0,s.jsx)("h2",{className:"text-xl font-bold dark:text-white",children:"Notifications"})}),t[2]=f):f=t[2];let u;t[3]!==o||t[4]!==a?(u=a.length>0?a.map(d=>(0,s.jsxs)("div",{onClick:()=>o(d),className:`p-4 border-b border-zinc-100 dark:border-zinc-800 flex items-start gap-4 hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors cursor-pointer ${d.is_read?"":"bg-violet-50/30 dark:bg-violet-500/5"}`,children:[(0,s.jsx)("div",{className:"shrink-0 pt-1",children:c(d.type)}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-1",children:[(0,s.jsxs)(ge,{className:"size-8",children:[(0,s.jsx)(be,{src:d.avatar}),(0,s.jsx)(ve,{children:d.user?.[0]?.toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex-1 flex justify-between items-center",children:[(0,s.jsxs)("span",{className:"font-bold text-sm dark:text-white truncate",children:["@",d.user]}),(0,s.jsx)("span",{className:"text-zinc-500 text-xs whitespace-nowrap",children:nt(d.created_at)})]})]}),(0,s.jsxs)("p",{className:"text-zinc-600 dark:text-zinc-400 text-[15px] ml-11",children:[d.type==="like"&&"liked your post",d.type==="follow"&&"followed you",d.type==="mention"&&"mentioned you in a post",d.type==="comment"&&"commented on your post",d.type==="repost"&&"reposted your post"]})]}),!d.is_read&&(0,s.jsx)("div",{className:"size-2 rounded-full bg-violet-500 mt-2 shrink-0 shadow-[0_0_8px_rgba(139,92,246,0.5)]"})]},d.id)):(0,s.jsx)("div",{className:"p-16 text-center text-zinc-500",children:(0,s.jsx)("p",{className:"font-medium",children:"No notifications yet."})}),t[3]=o,t[4]=a,t[5]=u):u=t[5];let m;t[6]!==r||t[7]!==n||t[8]!==l||t[9]!==a.length?(m=a.length>0&&r&&(0,s.jsx)("div",{className:"p-6 flex justify-center border-t border-zinc-100 dark:border-zinc-800",children:(0,s.jsxs)(ue,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>l(!0),disabled:n,children:[n?(0,s.jsx)(oe,{size:18,className:"animate-spin mr-2"}):null,"Load more"]})}),t[6]=r,t[7]=n,t[8]=l,t[9]=a.length,t[10]=m):m=t[10];let x;t[11]!==r||t[12]!==a.length?(x=a.length>0&&!r&&(0,s.jsx)("div",{className:"p-8 text-center text-zinc-500 text-sm",children:"You've caught up with everything!"}),t[11]=r,t[12]=a.length,t[13]=x):x=t[13];let h;return t[14]!==u||t[15]!==m||t[16]!==x?(h=(0,s.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen pb-20 shadow-sm",children:[f,u,m,x]}),t[14]=u,t[15]=m,t[16]=x,t[17]=h):h=t[17],h},Ad=$d;function Md(t){switch(t){case"like":return(0,s.jsx)(ct,{size:20,className:"text-rose-500 fill-rose-500"});case"follow":return(0,s.jsx)(ks,{size:20,className:"text-blue-500"});case"mention":return(0,s.jsx)(Lt,{size:20,className:"text-emerald-500"});case"comment":return(0,s.jsx)(Yi,{size:20,className:"text-violet-500"});case"repost":return(0,s.jsx)(Qa,{size:20,className:"text-amber-500"});default:return(0,s.jsx)(Lt,{size:20,className:"text-zinc-500"})}}var Fd=Q(),Rd=()=>{const t=(0,Fd.c)(22),{post:e,isLoading:a,isError:i,currentUser:n,addToast:r,navigate:l,handleUserClick:o,handleDelete:c}=Wc();if(a){let v;return t[0]===Symbol.for("react.memo_cache_sentinel")?(v=(0,s.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:(0,s.jsx)(Xt,{})}),t[0]=v):v=t[0],v}if(i||!e){let v;return t[1]===Symbol.for("react.memo_cache_sentinel")?(v=(0,s.jsx)("div",{className:"bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-[600px] flex items-center justify-center",children:(0,s.jsx)(Kt,{title:"Post not found",message:"The post you are looking for doesn't exist. It may have been deleted by the author.",icon:mi})}),t[1]=v):v=t[1],v}let f;t[2]!==l?(f=()=>l(-1),t[2]=l,t[3]=f):f=t[3];let u;t[4]===Symbol.for("react.memo_cache_sentinel")?(u=(0,s.jsx)(tt,{size:20,strokeWidth:2.5}),t[4]=u):u=t[4];let m;t[5]!==f?(m=(0,s.jsx)("button",{onClick:f,className:"p-2 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:u}),t[5]=f,t[6]=m):m=t[6];let x;t[7]===Symbol.for("react.memo_cache_sentinel")?(x=(0,s.jsx)("h5",{className:"text-xl font-bold dark:text-white",children:"Post"}),t[7]=x):x=t[7];let h;t[8]!==m?(h=(0,s.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4",children:[m,x]})}),t[8]=m,t[9]=h):h=t[9];let d;t[10]!==e.comments?(d=e.comments||[],t[10]=e.comments,t[11]=d):d=t[11];let p;t[12]!==r||t[13]!==n||t[14]!==c||t[15]!==o||t[16]!==e||t[17]!==d?(p=(0,s.jsx)(at,{...e,isDetail:!0,currentUser:n,initialComments:d,showToast:r,onUserClick:o,onDelete:c}),t[12]=r,t[13]=n,t[14]=c,t[15]=o,t[16]=e,t[17]=d,t[18]=p):p=t[18];let g;return t[19]!==h||t[20]!==p?(g=(0,s.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen pb-16 shadow-sm animate-in slide-in-from-right-5 duration-300",children:(0,s.jsxs)("div",{className:"border-b border-zinc-100 dark:border-zinc-800",children:[h,p]})}),t[19]=h,t[20]=p,t[21]=g):g=t[21],g},Ed=Rd,Id=({profile:t,currentUser:e,isCurrentUser:a,onEditProfile:i,showToast:n,isCommunity:r,onShowFollowers:l,onShowFollowing:o})=>{const{isFollowing:c,stats:f,loading:u,handleFollow:m}=Ca(t,e?.id,n),x=je(),[h,d]=(0,b.useState)(!1),p=async()=>{if(!e){n("Please sign in to message users");return}d(!0);try{x(`/messages/${await aa(e.id,t.id)}`)}catch(g){console.error("Failed to start conversation:",g),n("Failed to open chat")}finally{d(!1)}};return(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("div",{className:"relative h-32 sm:h-48 w-full bg-zinc-200 dark:bg-zinc-800",children:[t.cover&&(0,s.jsx)("img",{src:t.cover,className:"h-full w-full object-cover transition-opacity duration-500",alt:"Cover"}),(0,s.jsx)("div",{className:"absolute -bottom-12 sm:-bottom-16 left-4 sm:left-6",children:(0,s.jsx)("div",{className:"p-1 bg-white dark:bg-black rounded-full overflow-hidden shadow-xl ring-4 ring-white dark:ring-black relative",children:(0,s.jsxs)(ge,{className:"size-24 sm:size-32",children:[(0,s.jsx)(be,{src:t.avatar,alt:t.handle,className:"object-cover"}),(0,s.jsx)(ve,{className:"text-4xl font-bold",children:t.handle?.[0]?.toUpperCase()})]})})})]}),(0,s.jsxs)("div",{className:"flex flex-col p-4 sm:p-6 pt-16 sm:pt-20 space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsx)("div",{className:"flex-1 min-w-0 pr-4"}),(0,s.jsx)("div",{className:"flex gap-2 shrink-0",children:a?(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>i(t),className:"p-2 rounded-full border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 transition-all active:scale-95 flex items-center justify-center size-10",title:"Edit Profile",children:(0,s.jsx)(St,{size:20})}),(0,s.jsx)("button",{onClick:()=>x("/settings"),className:"p-2 rounded-full border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 transition-all active:scale-95",title:"Settings",children:(0,s.jsx)(Js,{size:20})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:p,disabled:h,className:"rounded-full p-2 border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 dark:border-zinc-800 transition-colors disabled:opacity-50",children:h?(0,s.jsx)(oe,{size:20,className:"animate-spin"}):(0,s.jsx)(Pt,{size:20})}),(0,s.jsx)("button",{className:"rounded-full p-2 border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 dark:border-zinc-800 transition-colors",children:(0,s.jsx)(_t,{size:20})}),(0,s.jsx)(ue,{variant:c?"secondary":"primary",onClick:m,className:"text-sm px-6 min-w-[100px]",disabled:u,children:u?(0,s.jsx)(oe,{size:16,className:"animate-spin mx-auto"}):c?"Following":"Follow"}),(0,s.jsx)("button",{className:"rounded-full p-2 hover:bg-zinc-100 text-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-800 transition-colors",children:(0,s.jsx)(Rt,{size:20})})]})})]}),(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsx)("div",{className:"flex items-center gap-1.5",children:(0,s.jsxs)("h3",{className:"text-xl sm:text-2xl font-extrabold truncate dark:text-white flex items-center gap-1",children:[t.name,t.verified&&(0,s.jsx)(dt,{})]})}),!r&&(0,s.jsx)("div",{className:"flex items-center space-x-3",children:(0,s.jsxs)("span",{className:"text-zinc-500 font-medium text-sm px-1.5 py-0.5 -ml-1.5 rounded-md dark:text-zinc-400",children:["@",t.handle]})})]}),(0,s.jsx)("div",{className:"whitespace-pre-line text-zinc-900 dark:text-zinc-100 leading-relaxed text-sm sm:text-[15px]",children:(0,s.jsx)(xt,{options:{...bt,render:({attributes:g,content:v})=>{const{href:j,...w}=g,y=!j.startsWith("/")&&(j.startsWith("http")||j.startsWith("www"));return j.startsWith("/u/")||j.startsWith("/tags/")||j.startsWith("/c/")||j.startsWith("/explore")?(0,s.jsx)("span",{...w,className:"text-rose-500 dark:text-rose-400 font-bold hover:underline cursor-pointer",onClick:N=>{N.stopPropagation(),x(j)},children:v},v):(0,s.jsx)("a",{href:j,...w,target:y?"_blank":void 0,rel:y?"noopener noreferrer":void 0,children:v},v)}},children:t.bio})}),(t.website||t.location)&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-x-5 gap-y-2 text-sm pt-1",children:[t.location&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)(Ri,{size:14}),(0,s.jsx)("span",{children:t.location})]}),t.website&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)(Fs,{size:14}),(0,s.jsx)("a",{href:`https://${t.website}`,target:"_blank",rel:"noreferrer",className:"text-violet-600 hover:underline font-semibold text-black dark:text-white",children:t.website})]})]}),(0,s.jsx)("div",{className:"flex gap-4 sm:gap-6 text-sm pt-2 relative z-10",children:r?(0,s.jsxs)("button",{className:"flex gap-x-1 group cursor-pointer",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white",children:t.members}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Members"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:g=>{g.preventDefault(),g.stopPropagation(),o()},className:"flex gap-x-1 group cursor-pointer",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white",children:f.following}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Following"})]}),(0,s.jsxs)("button",{onClick:g=>{g.preventDefault(),g.stopPropagation(),l()},className:"flex gap-x-1 group cursor-pointer",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white",children:f.followers}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Followers"})]})]})})]})]})},Ld=Id,Td=Q(),Dd=t=>{const e=(0,Td.c)(89),{onEditProfile:a}=t,{handle:i,profile:n,loading:r,setUserPosts:l,activeProfileTab:o,setActiveProfileTab:c,loadingPosts:f,isFetchingMorePosts:u,hasMorePosts:m,filteredPosts:x,isFollowModalOpen:h,setIsFollowModalOpen:d,followModalType:p,followListData:g,isListLoading:v,isFetchingMoreFollows:j,hasMoreFollows:w,openFollowModal:y,handlePostClick:N,handleUserClick:_,loadUserPosts:P,currentUser:M,addToast:k,navigate:A}=Mc();if(r){let de;return e[0]===Symbol.for("react.memo_cache_sentinel")?(de=(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)(oe,{size:40,className:"animate-spin text-violet-500"})}),e[0]=de):de=e[0],de}if(!n){const de=`Try searching for another. The user @${i} could not be found.`;let fe;return e[1]!==de?(fe=(0,s.jsx)("div",{className:"bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-[600px] flex items-center justify-center",children:(0,s.jsx)(Kt,{title:"Account doesn't exist",message:de,icon:Pi})}),e[1]=de,e[2]=fe):fe=e[2],fe}const S=n;let I;e[3]!==o||e[4]!==k||e[5]!==M||e[6]!==S.handle||e[7]!==x||e[8]!==N||e[9]!==_||e[10]!==m||e[11]!==u||e[12]!==P||e[13]!==f||e[14]!==n||e[15]!==l?(I=de=>{const fe=de===void 0?!1:de;return f?(0,s.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,s.jsx)(oe,{className:"animate-spin text-violet-500",size:32})}):x.length>0?(0,s.jsxs)(s.Fragment,{children:[x.map(we=>(0,s.jsx)(at,{currentUser:M,showToast:k,...we,onClick:()=>N(we.id),onUserClick:_,onDelete:Ne=>l(xe=>xe.filter(ye=>ye.id!==Ne))},we.feed_id||we.id)),m&&(0,s.jsx)("div",{className:"p-6 flex justify-center",children:(0,s.jsxs)(ue,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>P(n.id,!0),disabled:u,children:[u&&(0,s.jsx)(oe,{size:18,className:"animate-spin mr-2"}),"Load more posts"]})})]}):fe?null:(0,s.jsxs)("div",{className:"p-20 text-center text-zinc-500 flex flex-col items-center gap-4 animate-in fade-in duration-500",children:[(0,s.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full mb-2 ring-1 ring-zinc-100 dark:ring-zinc-800",children:(0,s.jsx)(Bt,{size:40,className:"text-zinc-300 dark:text-zinc-700"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:o==="collections"?"No collections yet":"No posts yet"}),(0,s.jsx)("p",{className:"text-sm text-zinc-500 dark:text-zinc-400 max-w-[250px]",children:o==="collections"?"Saved posts and curated collections will appear here.":`When @${S.handle} shares posts, they will appear here.`})]})},e[3]=o,e[4]=k,e[5]=M,e[6]=S.handle,e[7]=x,e[8]=N,e[9]=_,e[10]=m,e[11]=u,e[12]=P,e[13]=f,e[14]=n,e[15]=l,e[16]=I):I=e[16];const L=I;let $;e[17]!==A?($=()=>A(-1),e[17]=A,e[18]=$):$=e[18];let R;e[19]===Symbol.for("react.memo_cache_sentinel")?(R=(0,s.jsx)(tt,{size:22}),e[19]=R):R=e[19];let E;e[20]!==$?(E=(0,s.jsx)("button",{onClick:$,className:"p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:R}),e[20]=$,e[21]=E):E=e[21];let O;e[22]!==S.name?(O=(0,s.jsx)("h5",{className:"text-lg font-bold dark:text-white leading-none",children:S.name}),e[22]=S.name,e[23]=O):O=e[23];const F=S.posts_count||0;let z;e[24]!==F?(z=(0,s.jsxs)("span",{className:"text-xs text-zinc-500 mt-0.5",children:[F," Posts"]}),e[24]=F,e[25]=z):z=e[25];let C;e[26]!==O||e[27]!==z?(C=(0,s.jsxs)("div",{className:"flex flex-col",children:[O,z]}),e[26]=O,e[27]=z,e[28]=C):C=e[28];let T;e[29]!==E||e[30]!==C?(T=(0,s.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3 md:hidden",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4",children:[E,C]})}),e[29]=E,e[30]=C,e[31]=T):T=e[31];const B=M?.handle===S.handle;let W,J;e[32]!==y?(W=()=>y("Followers"),J=()=>y("Following"),e[32]=y,e[33]=W,e[34]=J):(W=e[33],J=e[34]);let K;e[35]!==k||e[36]!==M||e[37]!==S||e[38]!==a||e[39]!==B||e[40]!==W||e[41]!==J?(K=(0,s.jsx)(Ld,{profile:S,currentUser:M,isCurrentUser:B,onEditProfile:a,showToast:k,onShowFollowers:W,onShowFollowing:J}),e[35]=k,e[36]=M,e[37]=S,e[38]=a,e[39]=B,e[40]=W,e[41]=J,e[42]=K):K=e[42];let G;e[43]===Symbol.for("react.memo_cache_sentinel")?(G=(0,s.jsx)("div",{className:"sticky top-[60px] md:top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-10 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)(Gt,{className:"w-full h-auto bg-transparent p-0 rounded-none justify-start px-2 overflow-x-auto hide-scrollbar",children:["feed","collections","media"].map(qd)})}),e[43]=G):G=e[43];let ne;e[44]!==L?(ne=L(),e[44]=L,e[45]=ne):ne=e[45];let se;e[46]!==ne?(se=(0,s.jsx)(ot,{value:"feed",className:"m-0 border-none",children:ne}),e[46]=ne,e[47]=se):se=e[47];let le;e[48]!==S.id||e[49]!==S.name?(le=(0,s.jsx)(jo,{name:S.name,number:S.id}),e[48]=S.id,e[49]=S.name,e[50]=le):le=e[50];let X;e[51]!==L?(X=L(!0),e[51]=L,e[52]=X):X=e[52];let ee;e[53]!==le||e[54]!==X?(ee=(0,s.jsxs)(ot,{value:"collections",className:"m-0 border-none",children:[le,X]}),e[53]=le,e[54]=X,e[55]=ee):ee=e[55];let q;e[56]!==L?(q=L(),e[56]=L,e[57]=q):q=e[57];let V;e[58]!==q?(V=(0,s.jsx)(ot,{value:"media",className:"m-0 border-none",children:q}),e[58]=q,e[59]=V):V=e[59];let Y;e[60]!==o||e[61]!==c||e[62]!==se||e[63]!==ee||e[64]!==V?(Y=(0,s.jsxs)(Zt,{value:o,onValueChange:c,className:"w-full",children:[G,se,ee,V]}),e[60]=o,e[61]=c,e[62]=se,e[63]=ee,e[64]=V,e[65]=Y):Y=e[65];let ae;e[66]!==K||e[67]!==Y||e[68]!==T?(ae=(0,s.jsxs)("div",{className:"border-y md:border-b-0 border-zinc-100 dark:border-zinc-800",children:[T,K,Y]}),e[66]=K,e[67]=Y,e[68]=T,e[69]=ae):ae=e[69];let Z;e[70]!==d?(Z=()=>d(!1),e[70]=d,e[71]=Z):Z=e[71];let ce;e[72]!==g||e[73]!==p||e[74]!==w||e[75]!==j||e[76]!==v||e[77]!==A||e[78]!==y||e[79]!==d?(ce=(0,s.jsx)("div",{className:"min-h-[300px]",children:v?(0,s.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,s.jsx)(oe,{className:"animate-spin text-violet-500",size:32})}):g.length>0?(0,s.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800 -mx-6",children:[g.map(de=>(0,s.jsx)(Sa,{profile:de,onUserClick:fe=>{d(!1),A(`/u/${fe}`)}},de.id)),w&&(0,s.jsx)("div",{className:"p-4 flex justify-center",children:(0,s.jsxs)(ue,{variant:"secondary",className:"w-full text-xs",onClick:()=>y(p,!0),disabled:j,children:[j?(0,s.jsx)(oe,{size:14,className:"animate-spin mr-2"}):null,"Load more"]})})]}):(0,s.jsx)("div",{className:"flex flex-col items-center justify-center py-20 text-zinc-500",children:(0,s.jsxs)("p",{className:"font-medium",children:["No ",p.toLowerCase()," yet."]})})}),e[72]=g,e[73]=p,e[74]=w,e[75]=j,e[76]=v,e[77]=A,e[78]=y,e[79]=d,e[80]=ce):ce=e[80];let me;e[81]!==p||e[82]!==h||e[83]!==Z||e[84]!==ce?(me=(0,s.jsx)(Ke,{isOpen:h,onClose:Z,title:p,className:"sm:max-w-md",children:ce}),e[81]=p,e[82]=h,e[83]=Z,e[84]=ce,e[85]=me):me=e[85];let pe;return e[86]!==ae||e[87]!==me?(pe=(0,s.jsxs)("div",{className:"border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen pb-20",children:[ae,me]}),e[86]=ae,e[87]=me,e[88]=pe):pe=e[88],pe},Od=Dd;function qd(t){return(0,s.jsx)(mt,{value:t,className:"flex-1 py-4 text-sm font-bold capitalize rounded-none border-b-2 data-[state=active]:border-black dark:data-[state=active]:border-white data-[state=active]:text-black dark:data-[state=active]:text-white text-zinc-500 transition-all hover:bg-zinc-50 dark:hover:bg-zinc-900 whitespace-nowrap px-4",children:t==="feed"?"Posts":t},t)}var Wd=Q(),Ud=()=>{const t=(0,Wd.c)(34),{reels:e,loading:a,loadingMore:i,activeReelId:n,isMuted:r,containerRef:l,navigate:o,toggleMute:c}=Uc();if(a){let w;return t[0]===Symbol.for("react.memo_cache_sentinel")?(w=(0,s.jsx)("div",{className:"h-[100dvh] w-full flex items-center justify-center bg-black",children:(0,s.jsx)(oe,{size:40,className:"animate-spin text-white"})}),t[0]=w):w=t[0],w}if(e.length===0){let w;t[1]===Symbol.for("react.memo_cache_sentinel")?(w=(0,s.jsx)("p",{className:"text-zinc-500",children:"No reels found."}),t[1]=w):w=t[1];let y;return t[2]!==o?(y=(0,s.jsxs)("div",{className:"h-[100dvh] w-full flex flex-col items-center justify-center bg-black text-white gap-4",children:[w,(0,s.jsx)("button",{onClick:()=>o(-1),className:"px-4 py-2 bg-white text-black rounded-full text-sm font-bold",children:"Go Back"})]}),t[2]=o,t[3]=y):y=t[3],y}let f;t[4]!==o?(f=()=>o(-1),t[4]=o,t[5]=f):f=t[5];let u;t[6]===Symbol.for("react.memo_cache_sentinel")?(u=(0,s.jsx)(tt,{size:24,strokeWidth:2.5}),t[6]=u):u=t[6];let m;t[7]!==f?(m=(0,s.jsx)("button",{onClick:f,className:"absolute top-6 left-6 z-50 p-2.5 bg-black/20 hover:bg-black/40 text-white backdrop-blur-md rounded-full transition-all active:scale-90 border border-white/10 shadow-xl",title:"Back",children:u}),t[7]=f,t[8]=m):m=t[8];const x=r?"Unmute":"Mute";let h;t[9]!==r?(h=r?(0,s.jsx)(Va,{size:24,strokeWidth:2.5}):(0,s.jsx)(Ci,{size:24,strokeWidth:2.5}),t[9]=r,t[10]=h):h=t[10];let d;t[11]!==x||t[12]!==h||t[13]!==c?(d=(0,s.jsx)("button",{onClick:c,className:"absolute top-6 right-6 z-50 p-2.5 bg-black/20 hover:bg-black/40 text-white backdrop-blur-md rounded-full transition-all active:scale-90 border border-white/10 shadow-xl",title:x,children:h}),t[11]=x,t[12]=h,t[13]=c,t[14]=d):d=t[14];let p;if(t[15]!==n||t[16]!==r||t[17]!==e||t[18]!==c){let w;t[20]!==n||t[21]!==r||t[22]!==c?(w=y=>(0,s.jsx)(Hc,{reel:y,isActive:n===y.id,isMuted:r,onToggleMute:c},y.feed_id||y.id),t[20]=n,t[21]=r,t[22]=c,t[23]=w):w=t[23],p=e.map(w),t[15]=n,t[16]=r,t[17]=e,t[18]=c,t[19]=p}else p=t[19];let g;t[24]!==i?(g=i&&(0,s.jsx)("div",{className:"h-screen w-full flex items-center justify-center bg-black snap-start",children:(0,s.jsx)(oe,{size:40,className:"animate-spin text-white"})}),t[24]=i,t[25]=g):g=t[25];let v;t[26]!==l||t[27]!==p||t[28]!==g?(v=(0,s.jsxs)("div",{ref:l,className:"h-full w-full snap-y snap-mandatory overflow-y-auto no-scrollbar scroll-smooth",children:[p,g]}),t[26]=l,t[27]=p,t[28]=g,t[29]=v):v=t[29];let j;return t[30]!==m||t[31]!==d||t[32]!==v?(j=(0,s.jsxs)("div",{className:"h-[100dvh] w-full bg-black md:rounded-xl relative overflow-hidden",children:[m,d,v]}),t[30]=m,t[31]=d,t[32]=v,t[33]=j):j=t[33],j},Bd=Ud,Vd=()=>{const{currentUser:t,logout:e}=he(),{darkMode:a,toggleDarkMode:i,fontSize:n,setFontSize:r,dataSaver:l,setDataSaver:o}=pt(),{addToast:c}=ze(),[f,u]=(0,b.useState)(!1),[m,x]=(0,b.useState)({newPassword:"",confirmPassword:""}),[h,d]=(0,b.useState)(!1),p=async()=>{try{await e(),c("Logged out successfully")}catch(_){console.error("Logout error:",_),c("Failed to logout")}},g=async _=>{if(_.preventDefault(),m.newPassword!==m.confirmPassword){c("Passwords do not match","error");return}if(m.newPassword.length<6){c("Password must be at least 6 characters","error");return}d(!0);try{const{error:P}=await D.auth.updateUser({password:m.newPassword});if(P)throw P;c("Password updated successfully!"),u(!1),x({newPassword:"",confirmPassword:""})}catch(P){console.error("Password update error:",P),c(P.message||"Failed to update password","error")}finally{d(!1)}},v=async()=>{if(t?.email){d(!0);try{const{error:_}=await D.auth.resetPasswordForEmail(t.email,{redirectTo:`${window.location.origin}/settings?type=recovery`});if(_)throw _;c("Password reset email sent!")}catch(_){console.error("Reset password error:",_),c(_.message||"Failed to send reset email","error")}finally{d(!1)}}},j=()=>{["seenStories","font-size","data-saver","theme"].forEach(_=>localStorage.removeItem(_)),c("Cache cleared! Reloading..."),setTimeout(()=>window.location.reload(),1500)},w=async()=>{d(!0);try{const _={user:{id:t.id,handle:t.handle,name:t.name,email:t.email},exportDate:new Date().toISOString(),note:"This is a mock export of your Sysm data."},P=new Blob([JSON.stringify(_,null,2)],{type:"application/json"}),M=URL.createObjectURL(P),k=document.createElement("a");k.href=M,k.download=`sysm-data-${t.handle}.json`,k.click(),URL.revokeObjectURL(M),c("Data export started!")}catch{c("Failed to export data","error")}finally{d(!1)}},y=()=>{window.confirm("Are you absolutely sure? This will permanently delete your account and all associated data. This action is irreversible.")&&(c("Account deletion request submitted. Logging out..."),setTimeout(p,2e3))},N=()=>{window.prompt("Please describe the bug you found:")&&c("Bug reported! Thank you for your feedback.")};return t?(0,s.jsxs)("div",{className:"flex flex-col min-h-screen bg-white dark:bg-black md:rounded-xl md:border border-zinc-100 dark:border-zinc-800",children:[(0,s.jsx)("div",{className:"sticky top-0 z-10 bg-white/80 dark:bg-black/80 backdrop-blur-md p-4 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)("h2",{className:"text-xl font-bold dark:text-white",children:"Settings"})}),(0,s.jsxs)("div",{className:"p-4 space-y-6 max-w-2xl mx-auto w-full pb-20 mt-4",children:[(0,s.jsxs)("section",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-sm font-bold text-zinc-500 uppercase tracking-wider px-2",children:"Account Security"}),(0,s.jsxs)("div",{className:"bg-zinc-50 dark:bg-zinc-900 rounded-2xl overflow-hidden divide-y divide-zinc-200 dark:divide-zinc-800",children:[(0,s.jsxs)("button",{onClick:()=>u(!f),className:"w-full px-4 py-4 flex items-center gap-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[(0,s.jsx)(Di,{size:20,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"flex-1 font-medium dark:text-zinc-200",children:"Change Password"}),(0,s.jsx)(Xe,{size:16,className:"text-zinc-400"})]}),f&&(0,s.jsxs)("form",{onSubmit:g,className:"p-4 space-y-3 bg-white dark:bg-black animate-in fade-in slide-in-from-top-2",children:[(0,s.jsx)(Fe,{type:"password",placeholder:"New Password",value:m.newPassword,onChange:_=>x({...m,newPassword:_.target.value})}),(0,s.jsx)(Fe,{type:"password",placeholder:"Confirm Password",value:m.confirmPassword,onChange:_=>x({...m,confirmPassword:_.target.value})}),(0,s.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,s.jsx)(ue,{type:"button",variant:"secondary",onClick:()=>u(!1),children:"Cancel"}),(0,s.jsx)(ue,{type:"submit",disabled:h,children:h?"Saving...":"Update Password"})]})]}),(0,s.jsxs)("button",{onClick:v,className:"w-full px-4 py-4 flex items-center gap-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[(0,s.jsx)(ws,{size:20,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"flex-1 font-medium dark:text-zinc-200",children:"Reset via Email"}),(0,s.jsx)(Xe,{size:16,className:"text-zinc-400"})]})]})]}),(0,s.jsxs)("section",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-sm font-bold text-zinc-500 uppercase tracking-wider px-2",children:"Display & Typography"}),(0,s.jsxs)("div",{className:"bg-zinc-50 dark:bg-zinc-900 rounded-2xl overflow-hidden divide-y divide-zinc-200 dark:divide-zinc-800",children:[(0,s.jsxs)("button",{onClick:i,className:"w-full px-4 py-4 flex items-center gap-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[a?(0,s.jsx)(Bs,{size:20,className:"text-violet-500"}):(0,s.jsx)(Ds,{size:20,className:"text-amber-500"}),(0,s.jsx)("span",{className:"flex-1 font-medium dark:text-zinc-200",children:"Dark Mode"}),(0,s.jsx)("div",{className:`w-10 h-6 rounded-full relative transition-colors ${a?"bg-violet-600":"bg-zinc-300"}`,children:(0,s.jsx)("div",{className:`absolute top-1 size-4 bg-white rounded-full transition-all ${a?"left-5":"left-1"}`})})]}),(0,s.jsxs)("div",{className:"px-4 py-4 flex items-center justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(wi,{size:20,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"font-medium dark:text-zinc-200",children:"Font Size"})]}),(0,s.jsxs)(co,{value:n,onValueChange:r,children:[(0,s.jsx)($a,{className:"w-[140px] bg-zinc-100 dark:bg-zinc-800 border-none font-bold text-violet-600 dark:text-violet-400 capitalize transition-all hover:bg-zinc-200 dark:hover:bg-zinc-700",children:(0,s.jsx)(mo,{placeholder:"Select"})}),(0,s.jsxs)(Fa,{className:"bg-white dark:bg-zinc-900 border-zinc-100 dark:border-zinc-800 shadow-2xl rounded-xl p-1",children:[(0,s.jsx)(jt,{value:"small",className:"py-2.5 rounded-lg focus:bg-zinc-50 dark:focus:bg-zinc-800 focus:text-violet-600 font-medium cursor-pointer",children:"Small"}),(0,s.jsx)(jt,{value:"base",className:"py-2.5 rounded-lg focus:bg-zinc-50 dark:focus:bg-zinc-800 focus:text-violet-600 font-medium cursor-pointer",children:"Default"}),(0,s.jsx)(jt,{value:"large",className:"py-2.5 rounded-lg focus:bg-zinc-50 dark:focus:bg-zinc-800 focus:text-violet-600 font-medium cursor-pointer",children:"Large"})]})]})]})]})]}),(0,s.jsxs)("section",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-sm font-bold text-zinc-500 uppercase tracking-wider px-2",children:"Data & Storage"}),(0,s.jsxs)("div",{className:"bg-zinc-50 dark:bg-zinc-900 rounded-2xl overflow-hidden divide-y divide-zinc-200 dark:divide-zinc-800",children:[(0,s.jsxs)("button",{onClick:()=>o(!l),className:"w-full px-4 py-4 flex items-center gap-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[(0,s.jsx)(Ms,{size:20,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"flex-1 font-medium dark:text-zinc-200",children:"Data Saver"}),(0,s.jsx)("div",{className:`w-10 h-6 rounded-full relative transition-colors ${l?"bg-emerald-600":"bg-zinc-300"}`,children:(0,s.jsx)("div",{className:`absolute top-1 size-4 bg-white rounded-full transition-all ${l?"left-5":"left-1"}`})})]}),(0,s.jsxs)("button",{onClick:j,className:"w-full px-4 py-4 flex items-center gap-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[(0,s.jsx)(Et,{size:20,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"flex-1 font-medium dark:text-zinc-200",children:"Clear Local Cache"}),(0,s.jsx)(Xe,{size:16,className:"text-zinc-400"})]}),(0,s.jsxs)("button",{onClick:w,className:"w-full px-4 py-4 flex items-center gap-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[(0,s.jsx)(Tt,{size:20,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"flex-1 font-medium dark:text-zinc-200",children:"Download My Data (Export)"}),(0,s.jsx)(Xe,{size:16,className:"text-zinc-400"})]})]})]}),(0,s.jsxs)("section",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-sm font-bold text-zinc-500 uppercase tracking-wider px-2",children:"Support"}),(0,s.jsxs)("div",{className:"bg-zinc-50 dark:bg-zinc-900 rounded-2xl overflow-hidden divide-y divide-zinc-200 dark:divide-zinc-800",children:[(0,s.jsxs)("button",{onClick:N,className:"w-full px-4 py-4 flex items-center gap-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[(0,s.jsx)(_t,{size:20,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"flex-1 font-medium dark:text-zinc-200",children:"Report a Bug"}),(0,s.jsx)(Xe,{size:16,className:"text-zinc-400"})]}),(0,s.jsxs)("div",{className:"px-4 py-4 flex items-center gap-3",children:[(0,s.jsx)(Tt,{size:20,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"flex-1 font-medium dark:text-zinc-200",children:"Version"}),(0,s.jsx)("span",{className:"text-zinc-500",children:"1.0.0 (Beta)"})]})]})]}),(0,s.jsx)("section",{className:"space-y-4 pt-4",children:(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsxs)("button",{onClick:p,className:"w-full bg-zinc-100 dark:bg-zinc-900 text-zinc-900 dark:text-zinc-100 p-4 rounded-2xl font-bold flex items-center justify-center gap-2 hover:bg-zinc-200 dark:hover:bg-zinc-800 transition-colors shadow-sm",children:[(0,s.jsx)(Sn,{size:20}),"Log Out"]}),(0,s.jsxs)("button",{onClick:y,className:"w-full bg-rose-50 dark:bg-rose-900/10 text-rose-600 dark:text-rose-500 p-4 rounded-2xl font-bold flex items-center justify-center gap-2 border border-rose-100 dark:border-rose-900/20 hover:bg-rose-100 dark:hover:bg-rose-900/40 transition-colors",children:[(0,s.jsx)(Et,{size:20}),"Delete Account Permanently"]})]})}),(0,s.jsx)("div",{className:"text-center text-xs text-zinc-400 py-4 pb-10",children:"Sysm  2026. Decentralized & Open Source."})]})]}):(0,s.jsx)("div",{className:"flex flex-col items-center justify-center p-10 text-center",children:(0,s.jsx)("p",{className:"text-zinc-500",children:"Please login to view settings."})})},Qd=Vd,Jd=()=>{const{tag:t}=ut(),e=je(),{currentUser:a}=he(),{addToast:i}=ze(),[n,r]=(0,b.useState)([]),[l,o]=(0,b.useState)(!0),[c,f]=(0,b.useState)(!1),[u,m]=(0,b.useState)(!0);(0,b.useEffect)(()=>{t&&(async()=>{o(!0);try{const d=await Ot(`#${t}`,null,10);r(d),m(d.length>=10)}catch(d){console.error("Failed to load hashtag posts:",d),i("Failed to load posts","error")}finally{o(!1)}})()},[t,i]);const x=async()=>{if(!(c||!u)){f(!0);try{const h=n[n.length-1],d=h?h.sortTimestamp:null,p=await Ot(`#${t}`,d,10);p.length<10&&m(!1),r(g=>[...g,...p])}catch(h){console.error("Failed to load more posts:",h)}finally{f(!1)}}};return(0,s.jsx)("div",{className:"border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen pb-20",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,s.jsx)("button",{onClick:()=>e(-1),className:"p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:(0,s.jsx)(tt,{size:22})}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("h5",{className:"text-lg font-bold dark:text-white leading-none",children:["#",t]}),(0,s.jsx)("span",{className:"text-xs text-zinc-500 mt-0.5",children:"Hashtag"})]})]})}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"h-32 sm:h-40 bg-gradient-to-r from-violet-500/10 to-fuchsia-500/10 overflow-hidden relative",children:(0,s.jsx)("div",{className:"absolute inset-0 bg-grid-white/[0.02] bg-[size:20px_20px]"})}),(0,s.jsxs)("div",{className:"px-4 pb-6",children:[(0,s.jsx)("div",{className:"flex justify-between items-end -mt-10 mb-4 relative z-10",children:(0,s.jsx)("div",{className:"size-20 sm:size-24 rounded-2xl border-4 border-white dark:border-black bg-zinc-100 dark:bg-zinc-800 flex items-center justify-center shadow-xl",children:(0,s.jsx)(wt,{size:40,className:"text-zinc-400"})})}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("h1",{className:"text-2xl sm:text-3xl font-black dark:text-white tracking-tight leading-tight",children:["#",t]}),(0,s.jsxs)("p",{className:"text-zinc-500 text-sm sm:text-base",children:["Posts tagged with #",t]})]})]})]}),(0,s.jsx)("div",{className:"border-t border-zinc-100 dark:border-zinc-800",children:l?(0,s.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,s.jsx)(oe,{className:"animate-spin text-violet-500",size:32})}):n.length>0?(0,s.jsxs)(s.Fragment,{children:[n.map(h=>(0,s.jsx)(at,{currentUser:a,showToast:i,...h,onClick:()=>e(`/post/${h.id}`),onUserClick:d=>e(`/u/${d}`)},h.feed_id||h.id)),u&&(0,s.jsx)("div",{className:"p-6 flex justify-center",children:(0,s.jsxs)(ue,{variant:"secondary",className:"w-full max-w-xs",onClick:x,disabled:c,children:[c&&(0,s.jsx)(oe,{size:18,className:"animate-spin mr-2"}),"Load more"]})})]}):(0,s.jsxs)("div",{className:"p-20 text-center text-zinc-500 flex flex-col items-center gap-4",children:[(0,s.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full mb-2",children:(0,s.jsx)(wt,{size:40,className:"text-zinc-300"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"No posts found"}),(0,s.jsxs)("p",{className:"text-sm max-w-[250px]",children:["Be the first to post with #",t,"!"]})]})})]})})},Hd=Jd,Kd=Q();function Yd(){const t=(0,Kd.c)(54),e=ft(),{currentUser:a,authMode:i,setAuthMode:n}=he(),{darkMode:r}=pt(),{isOpen:l,images:o,currentIndex:c,closeLightbox:f,setIndex:u}=Qt(),[m,x]=(0,b.useState)(!1),[h,d]=(0,b.useState)(!1),[p,g]=(0,b.useState)(!1);let v;t[0]===Symbol.for("react.memo_cache_sentinel")?(v={},t[0]=v):v=t[0];const[j,w]=(0,b.useState)(v),[y,N]=(0,b.useState)(null),[_,P]=(0,b.useState)(null);if(i){const X=r?"dark":"";let ee;t[1]!==n?(ee=()=>n(null),t[1]=n,t[2]=ee):ee=t[2];let q;t[3]!==i||t[4]!==n?(q=()=>n(i==="login"?"signup":"login"),t[3]=i,t[4]=n,t[5]=q):q=t[5];let V;t[6]!==i||t[7]!==ee||t[8]!==q?(V=(0,s.jsx)("div",{className:"min-h-screen bg-white dark:bg-black flex items-center justify-center p-4",children:(0,s.jsx)(Ce,{children:(0,s.jsx)(tc,{type:i,onComplete:ee,onSwitch:q})})}),t[6]=i,t[7]=ee,t[8]=q,t[9]=V):V=t[9];let Y;return t[10]!==X||t[11]!==V?(Y=(0,s.jsx)("div",{className:X,children:V}),t[10]=X,t[11]=V,t[12]=Y):Y=t[12],Y}let M;t[13]===Symbol.for("react.memo_cache_sentinel")?(M=(0,s.jsx)(Vn,{}),t[13]=M):M=t[13];let k;t[14]===Symbol.for("react.memo_cache_sentinel")?(k=(0,s.jsx)(gl,{onPostClick:()=>x(!0)}),t[14]=k):k=t[14];let A;t[15]===Symbol.for("react.memo_cache_sentinel")?(A=(0,s.jsx)(ke,{path:"/",element:(0,s.jsx)(Ce,{children:(0,s.jsx)(cd,{onStoryClick:P,onAddStory:()=>g(!0)})})}),t[15]=A):A=t[15];let S;t[16]===Symbol.for("react.memo_cache_sentinel")?(S=(0,s.jsx)(ke,{path:"/home",element:(0,s.jsx)(as,{to:"/",replace:!0})}),t[16]=S):S=t[16];let I;t[17]===Symbol.for("react.memo_cache_sentinel")?(I=(0,s.jsx)(ke,{path:"/community",element:(0,s.jsx)(Ce,{children:(0,s.jsx)(ad,{})})}),t[17]=I):I=t[17];let L;t[18]===Symbol.for("react.memo_cache_sentinel")?(L=(0,s.jsx)(ke,{path:"/reels",element:(0,s.jsx)(Ce,{children:(0,s.jsx)(Bd,{})})}),t[18]=L):L=t[18];let $;t[19]===Symbol.for("react.memo_cache_sentinel")?($=(0,s.jsx)(ke,{path:"/messages",element:(0,s.jsx)(Ce,{children:(0,s.jsx)(vs,{})})}),t[19]=$):$=t[19];let R;t[20]===Symbol.for("react.memo_cache_sentinel")?(R=(0,s.jsx)(ke,{path:"/settings",element:(0,s.jsx)(Ce,{children:(0,s.jsx)(Qd,{})})}),t[20]=R):R=t[20];let E;t[21]===Symbol.for("react.memo_cache_sentinel")?(E=(0,s.jsx)(ke,{path:"/messages/:id",element:(0,s.jsx)(Ce,{children:(0,s.jsx)(vs,{})})}),t[21]=E):E=t[21];let O;t[22]===Symbol.for("react.memo_cache_sentinel")?(O=(0,s.jsx)(ke,{path:"/notifications",element:(0,s.jsx)(Ce,{children:(0,s.jsx)(Ad,{})})}),t[22]=O):O=t[22];let F;t[23]===Symbol.for("react.memo_cache_sentinel")?(F=(0,s.jsx)(ke,{path:"/post/:id",element:(0,s.jsx)(Ce,{children:(0,s.jsx)(Ed,{})})}),t[23]=F):F=t[23];let z;t[24]===Symbol.for("react.memo_cache_sentinel")?(z=(0,s.jsx)(ke,{path:"/c/:handle",element:(0,s.jsx)(Ce,{children:(0,s.jsx)(Gc,{onPostInCommunity:X=>{N(X),x(!0)}})})}),t[24]=z):z=t[24];let C;t[25]===Symbol.for("react.memo_cache_sentinel")?(C=(0,s.jsx)(ke,{path:"/tags/:tag",element:(0,s.jsx)(Ce,{children:(0,s.jsx)(Hd,{})})}),t[25]=C):C=t[25];let T;t[26]===Symbol.for("react.memo_cache_sentinel")?(T=(0,s.jsx)(ke,{path:"/u/:handle",element:(0,s.jsx)(Ce,{children:(0,s.jsx)(Od,{onEditProfile:X=>{w(X),d(!0)}})})}),t[26]=T):T=t[26];let B;t[27]===Symbol.for("react.memo_cache_sentinel")?(B=(0,s.jsxs)(ke,{element:k,children:[A,S,I,L,$,R,E,O,F,z,C,T,(0,s.jsx)(ke,{path:"*",element:(0,s.jsx)(as,{to:"/community"})})]}),t[27]=B):B=t[27];let W;t[28]!==e?(W=(0,s.jsx)(ui,{location:e,children:B},e.pathname),t[28]=e,t[29]=W):W=t[29];let J;t[30]===Symbol.for("react.memo_cache_sentinel")?(J=X=>{x(X),X||N(null)},t[30]=J):J=t[30];let K;t[31]!==j||t[32]!==h||t[33]!==m||t[34]!==p||t[35]!==y?(K=(0,s.jsx)(Qo,{isPostModalOpen:m,setIsPostModalOpen:J,isEditProfileOpen:h,setIsEditProfileOpen:d,isStoryModalOpen:p,setIsStoryModalOpen:g,editProfileData:j,setEditProfileData:w,postCommunity:y}),t[31]=j,t[32]=h,t[33]=m,t[34]=p,t[35]=y,t[36]=K):K=t[36];let G;t[37]!==_?(G=_&&(0,s.jsx)(Ko,{story:_,onClose:X=>{if(X){const ee=JSON.parse(localStorage.getItem("seenStories")||"[]");ee.includes(X)||localStorage.setItem("seenStories",JSON.stringify([...ee,X]))}P(null)}}),t[37]=_,t[38]=G):G=t[38];let ne;t[39]!==f||t[40]!==c||t[41]!==o||t[42]!==l||t[43]!==u?(ne=l&&(0,s.jsx)(Hl,{images:o,currentIndex:c,onClose:f,onNavigate:u}),t[39]=f,t[40]=c,t[41]=o,t[42]=l,t[43]=u,t[44]=ne):ne=t[44];let se;t[45]!==a||t[46]!==e.pathname?(se=a&&e.pathname==="/"&&(0,s.jsx)("button",{onClick:()=>x(!0),className:"fixed bottom-20 right-5 md:hidden z-50 bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 size-12 rounded-full flex items-center justify-center shadow-2xl hover:scale-110 active:scale-90 transition-all cursor-pointer group",title:"Create Post",children:(0,s.jsx)(We,{size:28,className:"group-hover:rotate-90 transition-transform duration-300"})}),t[45]=a,t[46]=e.pathname,t[47]=se):se=t[47];let le;return t[48]!==W||t[49]!==K||t[50]!==G||t[51]!==ne||t[52]!==se?(le=(0,s.jsxs)(il,{children:[M,W,K,G,ne,se]}),t[48]=W,t[49]=K,t[50]=G,t[51]=ne,t[52]=se,t[53]=le):le=t[53],le}var Xd=new An;(0,qn.createRoot)(document.getElementById("root")).render((0,s.jsx)(b.StrictMode,{children:(0,s.jsx)(Gi,{client:Xd,children:(0,s.jsx)(Ya,{children:(0,s.jsx)(Br,{children:(0,s.jsx)(Or,{children:(0,s.jsx)(Wr,{children:(0,s.jsx)(Gr,{children:(0,s.jsx)(Xr,{children:(0,s.jsx)(tl,{children:(0,s.jsx)(Yd,{})})})})})})})})})}));
