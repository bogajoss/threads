import{a as he}from"./rolldown-runtime-BaZ8gS7u.js";import{c as pe,s as ue}from"./animations-Kp4r2r5F.js";import{_ as be,c as je}from"./framework-BjssErrK.js";import"./database-CdmW3A7f.js";import{Nn as ge,Nt as ve,Pn as ne,Qt as ke,Vn as le,Xt as oe,lr as ze,or as we,sr as re,vn as Ne}from"./ui-libs-BDc7wvDc.js";import"./media-libs-DyQ6Lt1T.js";import{Ct as te,F as ye,G as ce,Gt as Fe,I as _e,Jt as ie,K as Ce,Kt as Pe,L as Me,N as Se,P as Te,Q as Ie,Qt as Le,St as de,Tt as $e,V as De,W as We,Wt as Ue,Yt as Ae,Z as Be,_ as Oe,bt as Ee,c as qe,ht as Ge,lt as Qe,mt as xe,q as Re,rn as Ve,ut as He,wt as Ke,xt as Xe,z as Je}from"./index-CZ2mVuNB.js";import"./VideoPlayer-CCeTLazY.js";import{n as Ye}from"./post-DFcsWhhx.js";import{t as Ze}from"./text-processing-43DOFg7x.js";import{t as es}from"./linkify-BbNKDFfD.js";import{n as ae,t as ss}from"./actionsheet-BJNNTeTG.js";import{t as fe}from"./skeleton-profile-D2m0QTCL.js";var ts=je(),me=he(pe(),1),s=he(ue(),1),as=({profile:e,currentUser:j,isCurrentUser:E,onEditProfile:Y,isCommunity:c,onShowFollowers:q,onShowFollowing:G})=>{const{addToast:o}=Le(),f=be(),{openReport:p}=Ae(),[g,x]=(0,me.useState)(!1),[m,d]=(0,me.useState)(!1),Q=qe("(min-width: 1024px)"),{isFollowing:u,stats:v,loading:b,handleFollow:R}=He(e||{},j?.id);if(!e)return(0,s.jsx)(fe,{});const V=async()=>{if(!j){o("Please sign in to message users","info");return}x(!0);try{f(`/m/${await Ve(j.id,e.id)}`)}catch(i){console.error("Failed to start conversation:",i),o("Failed to open chat","error")}finally{x(!1)}};return(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("div",{className:"relative h-32 w-full bg-zinc-200 dark:bg-zinc-800 sm:h-48",children:[e.cover&&(0,s.jsx)("img",{src:e.cover,className:"h-full w-full object-cover transition-opacity duration-500",alt:"Cover"}),(0,s.jsx)("div",{className:"absolute -bottom-12 left-4 sm:-bottom-16 sm:left-6",children:(0,s.jsx)("div",{className:"relative rounded-full bg-white p-1 shadow-xl ring-4 ring-white dark:bg-black dark:ring-black",children:(0,s.jsxs)(Ue,{className:"size-24 sm:size-32",children:[(0,s.jsx)(Pe,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,s.jsx)(Fe,{className:"text-4xl font-bold",children:e.handle?.[0]?.toUpperCase()})]})})})]}),(0,s.jsxs)("div",{className:"flex flex-col space-y-4 p-4 pt-16 sm:p-6 sm:pt-20",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsx)("div",{className:"min-w-0 flex-1 pr-4"}),(0,s.jsx)("div",{className:"flex shrink-0 gap-2",children:E?(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>Y?.(e),className:"flex size-10 items-center justify-center rounded-full border border-zinc-200 text-zinc-700 transition-all hover:bg-zinc-50 active:scale-95 dark:border-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-900",title:"Edit Profile",children:(0,s.jsx)(Se,{size:20})}),(0,s.jsx)("button",{onClick:()=>f("/settings"),className:"rounded-full border border-zinc-200 p-2 text-zinc-700 transition-all hover:bg-zinc-50 active:scale-95 dark:border-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-900",title:"Settings",children:(0,s.jsx)(Je,{size:20})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:V,disabled:g,className:"rounded-full border border-zinc-200 p-2 text-zinc-700 transition-colors hover:bg-zinc-50 disabled:opacity-50 dark:border-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-900",children:g?(0,s.jsx)("span",{className:"animate-pulse",children:"..."}):(0,s.jsx)(Ne,{size:20})}),(0,s.jsx)("button",{className:"rounded-full border border-zinc-200 p-2 text-zinc-700 transition-colors hover:bg-zinc-50 dark:border-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-900",children:(0,s.jsx)(we,{size:20})}),(0,s.jsx)(ie,{variant:u?"secondary":"primary",onClick:R,className:"flex min-w-0 items-center gap-2 px-4 text-sm sm:min-w-[100px]",disabled:b,children:b?(0,s.jsx)("span",{className:"mx-auto animate-pulse",children:"..."}):u?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ye,{size:18}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Following"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Te,{size:18}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Follow"})]})}),Q?(0,s.jsxs)(Ee,{children:[(0,s.jsx)($e,{asChild:!0,children:(0,s.jsx)("button",{className:"rounded-full p-2 text-zinc-700 transition-colors hover:bg-zinc-100 dark:text-zinc-300 dark:hover:bg-zinc-800",children:(0,s.jsx)(le,{size:20})})}),(0,s.jsxs)(Xe,{align:"end",className:"w-48",children:[(0,s.jsxs)(de,{children:[(0,s.jsxs)(te,{className:"cursor-pointer gap-2",onClick:()=>{navigator.clipboard.writeText(window.location.href),o("Profile link copied!")},children:[(0,s.jsx)(oe,{size:16}),"Share Profile"]}),(0,s.jsxs)(te,{className:"cursor-pointer gap-2",onClick:()=>p(c?"community":"user",e.id),children:[(0,s.jsx)(ne,{size:16}),"Report ",c?"community":"user"]})]}),(0,s.jsx)(Ke,{}),(0,s.jsx)(de,{children:(0,s.jsxs)(te,{variant:"destructive",className:"cursor-pointer gap-2",onClick:()=>o("User blocked","info"),children:[(0,s.jsx)(re,{size:16}),"Block user"]})})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:()=>d(!0),className:"rounded-full p-2 text-zinc-700 transition-colors hover:bg-zinc-100 dark:text-zinc-300 dark:hover:bg-zinc-800",children:(0,s.jsx)(le,{size:20})}),(0,s.jsxs)(ss,{isOpen:m,onClose:()=>d(!1),children:[(0,s.jsx)(ae,{icon:(0,s.jsx)(oe,{size:18}),onClick:()=>{navigator.clipboard.writeText(window.location.href),o("Profile link copied!"),d(!1)},children:"Share Profile"}),(0,s.jsxs)(ae,{icon:(0,s.jsx)(ne,{size:18}),onClick:()=>{p(c?"community":"user",e.id),d(!1)},children:["Report ",c?"community":"user"]}),(0,s.jsx)(ae,{variant:"destructive",icon:(0,s.jsx)(re,{size:18}),onClick:()=>{o("User blocked","info"),d(!1)},children:"Block user"})]})]})]})})]}),(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsxs)("div",{className:"mt-1 flex items-center gap-1.5",children:[(0,s.jsx)("h1",{className:"text-xl font-extrabold text-zinc-900 dark:text-zinc-100",children:e.name}),e.verified&&(0,s.jsx)(De,{size:20,className:"text-blue-500"}),e.isBanned&&(0,s.jsxs)("span",{className:"flex items-center gap-1 rounded-full bg-rose-100 px-2 py-0.5 text-[10px] font-black uppercase tracking-wider text-rose-600 dark:bg-rose-500/10 dark:text-rose-500",children:[(0,s.jsx)(ge,{size:10}),"Banned"]})]}),!c&&(0,s.jsx)("div",{className:"flex items-center space-x-3",children:(0,s.jsxs)("span",{className:"-ml-1.5 rounded-md px-1.5 py-0.5 text-sm font-medium text-zinc-500 dark:text-zinc-400",children:["@",e.handle]})})]}),(0,s.jsx)("div",{className:"whitespace-pre-line text-sm leading-relaxed text-zinc-900 dark:text-zinc-100 sm:text-[15px]",children:(0,s.jsx)(Ze,{options:{...es,render:({attributes:i,content:h})=>{const{href:a,...l}=i,r=!a.startsWith("/")&&(a.startsWith("http")||a.startsWith("www"));return a.startsWith("/u/")||a.startsWith("/tags/")||a.startsWith("/c/")||a.startsWith("/explore")?(0,s.jsx)("span",{...l,className:"cursor-pointer font-bold text-rose-500 hover:underline dark:text-rose-400",onClick:k=>{k.stopPropagation(),f(a)},children:h},h):(0,s.jsx)("a",{href:a,...l,target:r?"_blank":void 0,rel:r?"noopener noreferrer":void 0,children:h},h)}},children:e.bio})}),(e.website||e.location)&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-x-5 gap-y-2 pt-1 text-sm",children:[e.location&&(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(Me,{size:14}),e.location]}),e.website&&(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(_e,{size:14}),(0,s.jsx)("a",{href:`https://${e.website}`,target:"_blank",rel:"noreferrer",className:"font-semibold text-black hover:underline dark:text-white",children:e.website})]})]}),(0,s.jsx)("div",{className:"relative z-10 flex gap-4 pt-2 text-sm sm:gap-6",children:c?(0,s.jsxs)("button",{className:"group flex cursor-pointer gap-x-1",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white",children:e.members}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Members"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:i=>{i.preventDefault(),i.stopPropagation(),G()},className:"group flex cursor-pointer gap-x-1",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white",children:v.following}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Following"})]}),(0,s.jsxs)("button",{onClick:i=>{i.preventDefault(),i.stopPropagation(),q()},className:"group flex cursor-pointer gap-x-1",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white",children:v.followers}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Followers"})]})]})})]})]})},rs=as,is=()=>{const e=(0,ts.c)(80),{handle:j,profile:E,loading:Y,activeProfileTab:c,setActiveProfileTab:q,loadingPosts:G,isFetchingMorePosts:o,hasMorePosts:f,filteredPosts:p,isFollowModalOpen:g,setIsFollowModalOpen:x,followModalType:m,followListData:d,isListLoading:Q,isFetchingMoreFollows:u,hasMoreFollows:v,openFollowModal:b,fetchNextFollows:R,handlePostClick:V,handleUserClick:i,loadUserPosts:h,currentUser:a,navigate:l}=Oe();if(Y){let t;return e[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,s.jsx)(fe,{}),e[0]=t):t=e[0],t}if(!E){const t=`Try searching for another. The user @${j} could not be found.`;let n;return e[1]!==t?(n=(0,s.jsx)("div",{className:"flex min-h-[600px] items-center justify-center overflow-hidden rounded-none border-zinc-100 bg-white dark:bg-black md:rounded-xl",children:(0,s.jsx)(xe,{title:"Account doesn't exist",message:t,icon:ve})}),e[1]=t,e[2]=n):n=e[2],n}if(E.isBanned){const t=`The user @${j} has been suspended for violating our community guidelines.`;let n;return e[3]!==t?(n=(0,s.jsx)("div",{className:"flex min-h-[600px] items-center justify-center overflow-hidden rounded-none border-zinc-100 bg-white dark:bg-black md:rounded-xl",children:(0,s.jsx)(xe,{title:"This account is banned",message:t,icon:re})}),e[3]=t,e[4]=n):n=e[4],n}const r=E;let k;e[5]!==a||e[6]!==r.handle||e[7]!==p||e[8]!==V||e[9]!==i||e[10]!==f||e[11]!==o||e[12]!==h||e[13]!==G?(k=t=>{const n=t===void 0?!1:t;return G?(0,s.jsx)("div",{className:"flex flex-col",children:[1,2,3].map(ns)}):p.length>0?(0,s.jsxs)(s.Fragment,{children:[p.map(J=>(0,s.jsx)(Ye,{currentUser:a,...J,onClick:()=>V(J.id),onUserClick:i},J.feed_id||J.id)),f&&(0,s.jsx)("div",{className:"flex justify-center p-6",children:(0,s.jsxs)(ie,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>h(),disabled:o,children:[o&&(0,s.jsx)("span",{className:"mr-2 animate-pulse",children:"..."}),"Load more posts"]})})]}):n?null:(0,s.jsxs)("div",{className:"flex animate-in fade-in flex-col items-center gap-4 p-20 text-center text-zinc-500 duration-500",children:[(0,s.jsx)("div",{className:"mb-2 rounded-full bg-zinc-50 p-6 ring-1 ring-zinc-100 dark:bg-zinc-900 dark:ring-zinc-800",children:(0,s.jsx)(ke,{size:40,className:"text-zinc-300 dark:text-zinc-700"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"No posts yet"}),(0,s.jsxs)("p",{className:"max-w-[250px] text-sm text-zinc-500 dark:text-zinc-400",children:["When @",r.handle," shares posts, they will appear here."]})]})},e[5]=a,e[6]=r.handle,e[7]=p,e[8]=V,e[9]=i,e[10]=f,e[11]=o,e[12]=h,e[13]=G,e[14]=k):k=e[14];const z=k;let w;e[15]!==l?(w=()=>l(-1),e[15]=l,e[16]=w):w=e[16];let H;e[17]===Symbol.for("react.memo_cache_sentinel")?(H=(0,s.jsx)(ze,{size:22}),e[17]=H):H=e[17];let N;e[18]!==w?(N=(0,s.jsx)("button",{onClick:w,className:"rounded-full p-1 transition-colors hover:bg-zinc-100 dark:text-white dark:hover:bg-zinc-800",children:H}),e[18]=w,e[19]=N):N=e[19];let y;e[20]!==r.name?(y=(0,s.jsx)("h5",{className:"text-lg font-bold leading-none dark:text-white",children:r.name}),e[20]=r.name,e[21]=y):y=e[21];const Z=r.follower_count||0;let F;e[22]!==Z?(F=(0,s.jsxs)("span",{className:"mt-0.5 text-xs text-zinc-500",children:[Z," Followers"]}),e[22]=Z,e[23]=F):F=e[23];let _;e[24]!==y||e[25]!==F?(_=(0,s.jsxs)("div",{className:"flex flex-col",children:[y,F]}),e[24]=y,e[25]=F,e[26]=_):_=e[26];let C;e[27]!==N||e[28]!==_?(C=(0,s.jsx)("div",{className:"sticky top-0 z-20 border-b border-zinc-100 bg-white/90 p-4 py-3 backdrop-blur-md dark:border-zinc-800 dark:bg-black/90 md:hidden",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4",children:[N,_]})}),e[27]=N,e[28]=_,e[29]=C):C=e[29];const ee=a?.handle===r.handle;let P;e[30]!==l?(P=()=>l("/edit-profile"),e[30]=l,e[31]=P):P=e[31];let M,S;e[32]!==b?(M=()=>b("Followers"),S=()=>b("Following"),e[32]=b,e[33]=M,e[34]=S):(M=e[33],S=e[34]);let T;e[35]!==a||e[36]!==r||e[37]!==P||e[38]!==M||e[39]!==S||e[40]!==ee?(T=(0,s.jsx)(rs,{profile:r,currentUser:a,isCurrentUser:ee,onEditProfile:P,onShowFollowers:M,onShowFollowing:S}),e[35]=a,e[36]=r,e[37]=P,e[38]=M,e[39]=S,e[40]=ee,e[41]=T):T=e[41];let K;e[42]===Symbol.for("react.memo_cache_sentinel")?(K=(0,s.jsx)("div",{className:"sticky top-[60px] z-10 border-b border-zinc-100 bg-white/90 backdrop-blur-md dark:border-zinc-800 dark:bg-black/90 md:top-0",children:(0,s.jsx)(Ce,{className:"hide-scrollbar h-auto w-full justify-start overflow-x-auto rounded-none bg-transparent p-0 px-2",children:["feed","media"].map(ls)})}),e[42]=K):K=e[42];let I;e[43]!==z?(I=z(),e[43]=z,e[44]=I):I=e[44];let L;e[45]!==I?(L=(0,s.jsx)(ce,{value:"feed",className:"m-0 border-none",children:I}),e[45]=I,e[46]=L):L=e[46];let $;e[47]!==z?($=z(),e[47]=z,e[48]=$):$=e[48];let D;e[49]!==$?(D=(0,s.jsx)(ce,{value:"media",className:"m-0 border-none",children:$}),e[49]=$,e[50]=D):D=e[50];let W;e[51]!==c||e[52]!==q||e[53]!==L||e[54]!==D?(W=(0,s.jsxs)(We,{value:c,onValueChange:q,className:"w-full",children:[K,L,D]}),e[51]=c,e[52]=q,e[53]=L,e[54]=D,e[55]=W):W=e[55];let U;e[56]!==T||e[57]!==W||e[58]!==C?(U=(0,s.jsxs)("div",{className:"border-y border-zinc-100 dark:border-zinc-800 md:border-b-0",children:[C,T,W]}),e[56]=T,e[57]=W,e[58]=C,e[59]=U):U=e[59];let A;e[60]!==x?(A=()=>x(!1),e[60]=x,e[61]=A):A=e[61];const se=m==="Followers"?`People who follow @${r.handle}`:`People @${r.handle} follows`;let B;e[62]!==R||e[63]!==d||e[64]!==m||e[65]!==v||e[66]!==u||e[67]!==Q||e[68]!==l||e[69]!==x?(B=(0,s.jsx)("div",{className:"flex max-h-[75vh] flex-col overflow-y-auto",children:(0,s.jsx)("div",{className:"min-h-[300px]",children:Q?(0,s.jsx)("div",{className:"flex flex-col",children:[1,2,3,4,5].map(os)}):d.length>0?(0,s.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:[d.map(t=>(0,s.jsx)(Qe,{profile:t,onUserClick:n=>{x(!1),l(`/u/${n}`)}},t.id)),v&&(0,s.jsx)("div",{className:"flex justify-center p-4",children:(0,s.jsxs)(ie,{variant:"secondary",className:"w-full text-xs",onClick:()=>R(),disabled:u,children:[u?(0,s.jsx)("span",{className:"mr-2 animate-pulse",children:"..."}):null,"Load more"]})})]}):(0,s.jsx)("div",{className:"flex flex-col items-center justify-center py-20 text-zinc-500",children:(0,s.jsxs)("p",{className:"font-medium",children:["No ",m.toLowerCase()," yet."]})})})}),e[62]=R,e[63]=d,e[64]=m,e[65]=v,e[66]=u,e[67]=Q,e[68]=l,e[69]=x,e[70]=B):B=e[70];let O;e[71]!==m||e[72]!==g||e[73]!==A||e[74]!==se||e[75]!==B?(O=(0,s.jsx)(Ge,{isOpen:g,onClose:A,title:m,description:se,className:"sm:max-w-md",children:B}),e[71]=m,e[72]=g,e[73]=A,e[74]=se,e[75]=B,e[76]=O):O=e[76];let X;return e[77]!==U||e[78]!==O?(X=(0,s.jsxs)("div",{className:"min-h-screen overflow-hidden rounded-none border-zinc-100 bg-white pb-20 dark:bg-black dark:border-zinc-800 md:rounded-xl",children:[U,O]}),e[77]=U,e[78]=O,e[79]=X):X=e[79],X},zs=is;function ns(e){return(0,s.jsx)(Ie,{},e)}function ls(e){return(0,s.jsx)(Re,{value:e,className:"flex-1 whitespace-nowrap rounded-none border-b-2 px-4 py-4 text-sm font-bold capitalize text-zinc-500 transition-all data-[state=active]:border-black data-[state=active]:text-black dark:data-[state=active]:border-white dark:data-[state=active]:text-white",children:e==="feed"?"Posts":e},e)}function os(e){return(0,s.jsx)(Be,{},e)}export{zs as default};
