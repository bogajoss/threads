import{n as Ht}from"./rolldown-runtime-2JzG8er9.js";import{$ as be,$t as lt,A as Hs,An as ve,At as De,B as Qs,Bt as Qt,C as Vs,Ct as Ge,D as Us,Dn as Vt,Dt as Ks,E as Js,En as Gs,Et as Xs,F as Zs,Fn as Ys,Ft as ot,G as ea,Gt as ta,H as sa,Ht as Ut,I as aa,In as la,It as ia,J as ra,Jt as ut,K as na,Kt as oa,L as ca,Lt as Kt,M as da,Mn as Xe,Mt as Ue,N as ma,Nn as we,Nt as ua,O as fa,On as $t,Ot as Jt,P as xa,Pn as ft,Pt as Gt,Q as ha,Qt as pa,R as ba,Rt as ga,S as Xt,St as Zt,T as va,Tn as ja,Tt as Yt,U as wa,Ut as es,V as ya,Vt as ts,W as Na,Wt as ss,X as za,Xt as it,Y as ka,Yt as _a,Z as Ca,Zt as Be,_ as Sa,_t as $a,a as Pa,an as Fa,at as Ma,b as La,bt as Ra,c as Ia,ct as as,d as Ea,dt as ls,en as W,et as Ta,f as qa,ft as Aa,g as Oa,gt as is,h as Da,ht as rs,i as Ba,in as Ze,it as Wa,j as Ha,jn as Qa,jt as Va,k as Ua,kn as Ka,kt as xt,l as Ja,lt as Ga,m as Xa,mt as Re,n as Za,nn as Le,nt as ns,o as Ya,ot as os,p as el,pt as rt,q as tl,qt as sl,r as al,rn as ll,rt as il,s as rl,st as nl,t as Fe,tn as cs,tt as ol,u as cl,ut as dl,v as ml,vt as ul,w as fl,wt as re,x as xl,xt as ct,y as hl,yt as pl,z as bl,zt as gl}from"./framework-BYwzpKN_.js";import{t as vl}from"./query-DROIHJC-.js";import{t as jl}from"./database-DCcU4ujN.js";import{n as wl,r as yl,t as Nl}from"./vendor-DyYlx6SC.js";/* empty css                 */(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))l(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const n of r.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&l(n)}).observe(document,{childList:!0,subtree:!0});function a(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(i){if(i.ep)return;i.ep=!0;const r=a(i);fetch(i.href,r)}})();var zl=Ys(),g=Ht(la(),1),kl="https://dbkcedktqhueqnulnosq.supabase.co",_l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRia2NlZGt0cWh1ZXFudWxub3NxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg5NzE1NTQsImV4cCI6MjA4NDU0NzU1NH0.m_Tv-H7o5mL1Nac6TH-S1JkS1x7ZN1AK_4Mt1hZlkvU";const T=jl(kl,_l),ke=t=>t?{id:t.id,handle:t.username,name:t.display_name,avatar:t.avatar_url||"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm",cover:t.cover_url||"https://systemadminbd.com/uploads/675346dd55e0c7.43939630.png",verified:t.is_verified,bio:t.bio,location:t.location,website:t.website,follower_count:t.follower_count||0,following_count:t.following_count||0,lastSeen:t.last_seen_at}:null,Ye=t=>{if(!t)return null;const e=t.reposter_id||t.reposter_data?.id||t.reposted_by?.id,a=t.feed_id||(e?`${t.id}-${e}`:`${t.id}-orig`);return{...t,feed_id:a,stats:{comments:t.comments_count||0,likes:t.likes_count||0,mirrors:t.mirrors_count||0},user:ke(t.author_data||t.user),repostedBy:t.reposter_data?{handle:t.reposter_data.username,name:t.reposter_data.display_name,id:t.reposter_data.id}:t.reposted_by?{handle:t.reposted_by.username,name:t.reposted_by.display_name,id:t.reposted_by.id}:null,timeAgo:new Date(t.created_at).toLocaleDateString()}},ht=t=>t?{...t,stats:{likes:t.likes_count||0},user:ke(t.user),timeAgo:new Date(t.created_at).toLocaleDateString()}:null,Cl=t=>t?{...t,user:t.actor?.username,avatar:t.actor?.avatar_url||"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm"}:null,ds=t=>t?{...t,media:t.media_url,user:ke(t.user)}:null,Sl=async(t,e=10)=>{const{data:a,error:l}=await T.from("users").select("*").or(`username.ilike.%${t}%,display_name.ilike.%${t}%`).limit(e);if(l)throw l;return a.map(ke)},$l=async(t=null,e=10)=>{let a=T.from("users").select("*").order("created_at",{ascending:!1}).limit(e);t&&(a=a.lt("created_at",t));const{data:l,error:i}=await a;if(i)throw i;return l.map(ke)},ms=async(t,e="id")=>{const{data:a,error:l}=await T.from("users").select("*").eq(e==="id"?"id":"username",t).maybeSingle();if(l)throw l;return a?ke(a):null},Pl=t=>ms(t,"username"),Me=async t=>{if(!t)return;const{error:e}=await T.from("users").update({last_seen_at:new Date().toISOString()}).eq("id",t);e&&console.error("Error updating last seen:",e)},Fl=async(t,e)=>{const a={display_name:e.name,username:e.handle,avatar_url:e.avatar,bio:e.bio,cover_url:e.cover,website:e.website,location:e.location};Object.keys(a).forEach(i=>a[i]===void 0&&delete a[i]);const{error:l}=await T.from("users").update(a).eq("id",t);if(l)throw l},Ml=async(t,e)=>{const{data:a}=await T.from("follows").select("*").eq("follower_id",t).eq("following_id",e).maybeSingle();return a?(await T.from("follows").delete().eq("follower_id",t).eq("following_id",e),!1):(await T.from("follows").insert([{follower_id:t,following_id:e}]),!0)},Ll=async(t,e)=>{if(!t)return!1;const{data:a}=await T.from("follows").select("*").eq("follower_id",t).eq("following_id",e).maybeSingle();return!!a},Rl=async(t,e=null,a=10)=>{let l=T.from("follows").select(`
      created_at,
      user:users!follower_id (
        id,
        username,
        display_name,
        avatar_url,
        is_verified,
        bio
      )
    `).eq("following_id",t).order("created_at",{ascending:!1}).limit(a);e&&(l=l.lt("created_at",e));const{data:i,error:r}=await l;if(r)throw r;return i.map(n=>({...ke(n.user),followed_at:n.created_at}))},Il=async(t,e=null,a=10)=>{let l=T.from("follows").select(`
      created_at,
      user:users!following_id (
        id,
        username,
        display_name,
        avatar_url,
        is_verified,
        bio
      )
    `).eq("follower_id",t).order("created_at",{ascending:!1}).limit(a);e&&(l=l.lt("created_at",e));const{data:i,error:r}=await l;if(r)throw r;return i.map(n=>({...ke(n.user),followed_at:n.created_at}))},El=async t=>{const{data:e,error:a}=await T.from("users").select("follower_count, following_count").eq("id",t).maybeSingle();return a||!e?{followers:0,following:0}:{followers:e.follower_count||0,following:e.following_count||0}},Tl=async(t=null,e=10)=>{let a=T.from("unified_posts").select("*").order("sort_timestamp",{ascending:!1}).limit(e);t&&(a=a.lt("sort_timestamp",t));const{data:l,error:i}=await a;if(i)throw i;return l.map(Ye)},ql=async t=>{const{data:e,error:a}=await T.from("posts").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified,
                bio,
                location,
                website,
                follower_count,
                following_count
            ),
            quoted_post:posts!quoted_post_id (
                *,
                user:users!user_id (
                    id,
                    username,
                    display_name,
                    avatar_url,
                    is_verified
                )
            )
        `).eq("id",t).single();if(a)throw a;return Ye(e)},Al=async(t,e=null,a=10)=>{let l=T.from("unified_posts").select("*").or(`user_id.eq.${t},reposter_id.eq.${t}`).order("sort_timestamp",{ascending:!1}).limit(a);e&&(l=l.lt("sort_timestamp",e));const{data:i,error:r}=await l;if(r)throw r;return i.map(Ye)},Ol=async(t,e=null,a=10)=>{let l=T.from("comments").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `).eq("user_id",t).order("created_at",{ascending:!1}).limit(a);e&&(l=l.lt("created_at",e));const{data:i,error:r}=await l;if(r)throw r;return i.map(ht)},Dl=async({content:t,media:e=[],type:a="text",userId:l,poll:i=null,parentId:r=null})=>{const{data:n,error:o}=await T.from("posts").insert([{user_id:l,content:t,media:e,type:a,poll:i,parent_id:r}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `);if(o)throw o;return Ye(n[0])},Bl=async t=>{const{error:e}=await T.from("posts").delete().eq("id",t);if(e)throw e},Wl=async(t,e)=>{const{error:a}=await T.from("posts").update(e).eq("id",t);if(a)throw a},Hl=async(t,e=null,a=10)=>{let l=T.from("comments").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `).eq("post_id",t).order("created_at",{ascending:!0}).limit(a);e&&(l=l.gt("created_at",e));const{data:i,error:r}=await l;if(r)throw r;return i.map(ht)},Ql=async(t,e,a,l=[])=>{const{data:i,error:r}=await T.from("comments").insert([{post_id:t,user_id:e,content:a,media:l}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `);if(r)throw r;return ht(i[0])},Vl=async(t,e)=>{const{data:a}=await T.from("likes").select("*").eq("post_id",t).eq("user_id",e).maybeSingle();return a?(await T.from("likes").delete().eq("post_id",t).eq("user_id",e),!1):(await T.from("likes").insert([{post_id:t,user_id:e}]),!0)},Ul=async(t,e)=>{if(!e)return!1;const{data:a}=await T.from("likes").select("*").eq("post_id",t).eq("user_id",e).maybeSingle();return!!a},Kl=async(t,e)=>{const{data:a}=await T.from("reposts").select("*").eq("post_id",t).eq("user_id",e).maybeSingle();return a?(await T.from("reposts").delete().eq("post_id",t).eq("user_id",e),!1):(await T.from("reposts").insert([{post_id:t,user_id:e}]),!0)},Jl=async(t,e)=>{if(!e)return!1;const{data:a}=await T.from("reposts").select("*").eq("post_id",t).eq("user_id",e).maybeSingle();return!!a},us=async(t,e)=>{const{data:a}=await T.from("conversation_participants").select("conversation_id").eq("user_id",t),l=a.map(o=>o.conversation_id),{data:i}=await T.from("conversation_participants").select("conversation_id").eq("user_id",e).in("conversation_id",l).maybeSingle();if(i)return i.conversation_id;const{data:r,error:n}=await T.from("conversations").insert([{}]).select().single();if(n)throw n;return await T.from("conversation_participants").insert([{conversation_id:r.id,user_id:t},{conversation_id:r.id,user_id:e}]),r.id},Gl=async t=>{if(!t)return 0;const{data:e}=await T.from("conversation_participants").select("conversation_id").eq("user_id",t),a=e?.map(r=>r.conversation_id)||[];if(a.length===0)return 0;const{count:l,error:i}=await T.from("messages").select("*",{count:"exact",head:!0}).eq("is_read",!1).neq("sender_id",t).in("conversation_id",a);if(i)throw i;return l||0},Xl=async(t,e)=>{if(!t||!e)return;const{error:a}=await T.from("messages").update({is_read:!0}).eq("conversation_id",t).neq("sender_id",e).eq("is_read",!1);if(a)throw a},Zl=async t=>{if(!t)return[];const{data:e,error:a}=await T.from("conversation_participants").select(`
            conversation:conversations (
                id,
                last_message_at,
                last_message_content,
                participants:conversation_participants (
                    user:users (
                        id,
                        username,
                        display_name,
                        avatar_url
                    )
                ),
                messages (
                    id,
                    is_read,
                    sender_id
                )
            )
        `).eq("user_id",t);if(a)throw a;return e.map(l=>{const i=l.conversation,r=i.participants.find(o=>o.user?.id!==t)||i.participants[0],n=i.messages?.filter(o=>!o.is_read&&o.sender_id!==t).length||0;return{id:i.id,user:ke(r?.user),lastMessage:i.last_message_content||"No messages yet",time:i.last_message_at?new Date(i.last_message_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",unread:n}})},Yl=async t=>{const{data:e,error:a}=await T.from("messages").select("*").eq("conversation_id",t).order("created_at",{ascending:!0});if(a)throw a;return e},ei=async()=>{const{data:t,error:e}=await T.from("message_reactions").select("*");if(e)throw e;return t||[]},ti=async(t,e,a)=>{const{data:l}=await T.from("message_reactions").select("*").eq("message_id",t).eq("user_id",e).maybeSingle();return l?l.emoji===a?(await T.from("message_reactions").delete().eq("id",l.id),{action:"removed",emoji:a}):(await T.from("message_reactions").update({emoji:a}).eq("id",l.id),{action:"updated",emoji:a}):(await T.from("message_reactions").insert([{message_id:t,user_id:e,emoji:a}]),{action:"added",emoji:a})},si=async(t,e,a,l="text",i=[],r=null)=>{const{data:n,error:o}=await T.from("messages").insert([{conversation_id:t,sender_id:e,content:a,type:l,media:i,reply_to_id:r}]).select();if(o)throw o;return n[0]},ai=async t=>{const{error:e}=await T.from("messages").delete().eq("id",t);if(e)throw e},li=async(t,e=null,a=10)=>{if(!t)return[];let l=T.from("notifications").select(`
            *,
            actor:users!actor_id (
                username,
                avatar_url
            )
        `).eq("recipient_id",t).order("created_at",{ascending:!1}).limit(a);e&&(l=l.lt("created_at",e));const{data:i,error:r}=await l;if(r)throw r;return i.map(Cl)},ii=async t=>{const{error:e}=await T.from("notifications").update({is_read:!0}).eq("recipient_id",t).eq("is_read",!1);if(e)throw e},ri=async t=>{if(!t)return 0;const{count:e,error:a}=await T.from("notifications").select("*",{count:"exact",head:!0}).eq("recipient_id",t).eq("is_read",!1);if(a)throw a;return e||0},ni=async()=>{const{data:t,error:e}=await T.from("stories").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `).gt("expires_at",new Date().toISOString()).order("created_at",{ascending:!1});if(e)throw e;return t.map(ds)},oi=async(t,e,a="image")=>{const{data:l,error:i}=await T.from("stories").insert([{user_id:t,media_url:e,type:a}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `);if(i)throw i;return ds(l[0])},ci=async(t,e={})=>{if(!t.type.startsWith("image/"))return t;const a={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0,initialQuality:.8,fileType:"image/webp",...e};try{const l=await yl(t,a);return console.log(`Original size: ${(t.size/1024/1024).toFixed(2)} MB`),console.log(`Compressed size: ${(l.size/1024/1024).toFixed(2)} MB`),l}catch(l){return console.error("Image compression failed:",l),t}},di=(t,e=1)=>new Promise((a,l)=>{const i=document.createElement("video");i.preload="metadata",i.src=URL.createObjectURL(t),i.muted=!0,i.playsInline=!0,i.onloadedmetadata=()=>{i.currentTime=e},i.onseeked=()=>{const r=document.createElement("canvas");r.width=i.videoWidth,r.height=i.videoHeight,r.getContext("2d").drawImage(i,0,0,r.width,r.height),r.toBlob(n=>{const o=new File([n],"thumbnail.webp",{type:"image/webp"});URL.revokeObjectURL(i.src),a(o)},"image/webp",.7)},i.onerror=r=>l(r)}),ze=async(t,e="media",a=null)=>{let l=t,i=t.name.split(".").pop(),r=null;if(t.type.startsWith("image/")&&(l=await ci(t),i="webp"),t.type.startsWith("video/"))try{a?r=(await ze(a,e)).url:r=(await ze(await di(t),e)).url}catch(m){console.error("Failed to handle video poster:",m)}const n=`${`${crypto.randomUUID()}.${i}`}`,{data:o,error:c}=await T.storage.from(e).upload(n,l);if(c)throw c;const{data:{publicUrl:d}}=T.storage.from(e).getPublicUrl(o.path);return{url:d,poster:r,name:t.name,type:t.type.startsWith("image/")?"image":t.type.startsWith("video/")?"video":"file",size:l.size}},mi=[{tag:"Lens",posts:"0"},{tag:"Web3",posts:"0"},{tag:"Art",posts:"0"}];var s=Ht(Fa(),1),fs=(0,g.createContext)();const ui=({children:t})=>{const[e,a]=(0,g.useState)(null),[l,i]=(0,g.useState)(null),[r,n]=(0,g.useState)({}),[o,c]=(0,g.useState)(!0),d=async h=>{try{const b=await ms(h.id);b?(a(b),n(v=>({...v,[b.handle]:b}))):a({id:h.id,email:h.email,name:h.email.split("@")[0],handle:h.email.split("@")[0],avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm",verified:!1})}catch(b){console.error("Error fetching user profile:",b)}finally{c(!1)}};(0,g.useEffect)(()=>{if(!e?.id)return;Me(e.id);const h=setInterval(()=>Me(e.id),3e4),b=()=>{document.visibilityState==="visible"&&Me(e.id)};return window.addEventListener("visibilitychange",b),window.addEventListener("beforeunload",()=>Me(e.id)),()=>{clearInterval(h),window.removeEventListener("visibilitychange",b),window.removeEventListener("beforeunload",()=>Me(e.id))}},[e?.id]),(0,g.useEffect)(()=>{T.auth.getSession().then(({data:{session:b}})=>{b?d(b.user):c(!1)});const{data:{subscription:h}}=T.auth.onAuthStateChange((b,v)=>{v?d(v.user):(a(null),c(!1))});return()=>h.unsubscribe()},[]);const m=async({email:h,password:b})=>{const{data:v,error:j}=await T.auth.signInWithPassword({email:h,password:b});if(j)throw j;return i(null),v},u=async({email:h,password:b,username:v,name:j})=>{const{data:{user:k},error:N}=await T.auth.signUp({email:h,password:b,options:{data:{username:v.toLowerCase(),name:j}}});if(N)throw N;return i(null),k},f=async()=>{await T.auth.signOut(),a(null),i(null)},x=async h=>{e&&(await Fl(e.id,h),await d(e))},p=async h=>{if(r[h])return r[h];const b=await Pl(h);return b?(n(v=>({...v,[h]:b})),b):null};return(0,s.jsx)(fs.Provider,{value:{currentUser:e,authMode:l,setAuthMode:i,profiles:r,login:m,signup:u,logout:f,updateProfile:x,getProfileByHandle:p,loading:o},children:!o&&t})},he=()=>{const t=(0,g.useContext)(fs);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t};var fi=W(),xs=(0,g.createContext)();const xi=t=>{const e=(0,fi.c)(10),{children:a}=t,{currentUser:l}=he();let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=new Set,e[0]=i):i=e[0];const[r,n]=(0,g.useState)(i);let o;e[1]!==l?(o=()=>{if(!l?.id)return;const f=T.channel("global_presence",{config:{presence:{key:l.id}}});return f.on("presence",{event:"sync"},()=>{const x=f.presenceState(),p=new Set;Object.keys(x).forEach(h=>p.add(h)),n(p)}).subscribe(async x=>{x==="SUBSCRIBED"&&(await f.track({userId:l.id,online_at:new Date().toISOString()}),Me(l.id))}),()=>{l?.id&&Me(l.id),T.removeChannel(f),n(new Set)}},e[1]=l,e[2]=o):o=e[2];const c=l?.id;let d;e[3]!==c?(d=[c],e[3]=c,e[4]=d):d=e[4],(0,g.useEffect)(o,d);let m;e[5]!==r?(m={onlineUsers:r},e[5]=r,e[6]=m):m=e[6];let u;return e[7]!==a||e[8]!==m?(u=(0,s.jsx)(xs.Provider,{value:m,children:a}),e[7]=a,e[8]=m,e[9]=u):u=e[9],u},hs=()=>{const t=(0,g.useContext)(xs);if(!t)throw new Error("usePresence must be used within a PresenceProvider");return t};var hi=W(),ps=(0,g.createContext)();const pi=t=>{const e=(0,hi.c)(11),{children:a}=t,[l,i]=(0,g.useState)(bi);let r,n;e[0]!==l?(r=()=>{localStorage.setItem("theme",l?"dark":"light"),l?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},n=[l],e[0]=l,e[1]=r,e[2]=n):(r=e[1],n=e[2]),(0,g.useEffect)(r,n);let o;e[3]!==l?(o=()=>i(!l),e[3]=l,e[4]=o):o=e[4];const c=o;let d;e[5]!==l||e[6]!==c?(d={darkMode:l,setDarkMode:i,toggleDarkMode:c},e[5]=l,e[6]=c,e[7]=d):d=e[7];let m;return e[8]!==a||e[9]!==d?(m=(0,s.jsx)(ps.Provider,{value:d,children:a}),e[8]=a,e[9]=d,e[10]=m):m=e[10],m},pt=()=>{const t=(0,g.useContext)(ps);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t};function bi(){const t=localStorage.getItem("theme");return t==="dark"||!t&&window.matchMedia("(prefers-color-scheme: dark)").matches}var gi=W(),vi=t=>{const e=(0,gi.c)(7);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];const{theme:l}=Ca(),i=l===void 0?"system":l;let r,n;e[2]===Symbol.for("react.memo_cache_sentinel")?(r={success:(0,s.jsx)(ts,{className:"size-4"}),info:(0,s.jsx)(Ks,{className:"size-4"}),warning:(0,s.jsx)(Wa,{className:"size-4"}),error:(0,s.jsx)($a,{className:"size-4"}),loading:(0,s.jsx)(re,{className:"size-4 animate-spin"})},n={"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)","--border-radius":"var(--radius)"},e[2]=r,e[3]=n):(r=e[2],n=e[3]);let o;return e[4]!==a||e[5]!==i?(o=(0,s.jsx)(pa,{theme:i,className:"toaster group",icons:r,style:n,...a}),e[4]=a,e[5]=i,e[6]=o):o=e[6],o},ji=W(),bs=(0,g.createContext)();const wi=t=>{const e=(0,ji.c)(4),{children:a}=t,l=yi;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i={addToast:l},e[0]=i):i=e[0];let r;e[1]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsx)(vi,{position:"bottom-center",toastOptions:{className:"rounded-full font-bold"}}),e[1]=r):r=e[1];let n;return e[2]!==a?(n=(0,s.jsxs)(bs.Provider,{value:i,children:[a,r]}),e[2]=a,e[3]=n):n=e[3],n},_e=()=>{const t=(0,g.useContext)(bs);if(!t)throw new Error("useToast must be used within a ToastProvider");return t};function yi(t,e){const a=e===void 0?"success":e;a==="error"?lt.error(t):a==="info"?lt.info(t):lt.success(t)}var gs=(0,g.createContext)();const Ni=({children:t})=>{const[e,a]=(0,g.useState)([]),[l,i]=(0,g.useState)(!0),[r,n]=(0,g.useState)(!0),[o,c]=(0,g.useState)(!1),d=(0,g.useRef)(e);(0,g.useEffect)(()=>{d.current=e},[e]);const m=(0,g.useCallback)(async(v=!1)=>{v?c(!0):i(!0);try{const j=d.current,k=await Tl(v&&j.length>0?j[j.length-1].created_at:null,10);k.length<10?n(!1):n(!0),a(v?N=>[...N,...k]:k)}catch(j){console.error("Failed to load posts:",j)}finally{i(!1),c(!1)}},[]),u=()=>{!r||o||m(!0)};(0,g.useEffect)(()=>{m()},[m]);const f=async v=>{const j=await Dl(v);return m(),j},x=async v=>{await Bl(v),a(j=>j.filter(k=>k.id!==v))},p=async(v,j)=>{await Wl(v,j),a(k=>k.map(N=>N.id===v?{...N,...j}:N))},h=v=>e.find(j=>j.id===v),b=(v,j="feed")=>{let k=e.filter(N=>!!(N.user?.handle===v||N.repostedBy&&N.repostedBy.handle===v));return j==="feed"?k.filter(N=>N.parent_id===null):j==="media"?k.filter(N=>N.parent_id===null&&(N.type==="video"||N.type==="image"||N.media?.length>0)):k};return(0,s.jsx)(gs.Provider,{value:{posts:e,setPosts:a,addPost:f,deletePost:x,updatePost:p,getPostById:h,getUserPosts:b,loading:l,hasMore:r,isFetchingNextPage:o,fetchNextPage:u,refreshPosts:()=>m(!1)},children:t})},We=()=>{const t=(0,g.useContext)(gs);if(!t)throw new Error("usePosts must be used within a PostProvider");return t};var zi=W(),vs=(0,g.createContext)();const ki=t=>{const e=(0,zi.c)(9),{children:a}=t;let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l={isOpen:!1,images:[],currentIndex:0},e[0]=l):l=e[0];const[i,r]=(0,g.useState)(l);let n;e[1]===Symbol.for("react.memo_cache_sentinel")?(n=(p,h)=>{const b=h===void 0?0:h;r({isOpen:!0,images:Array.isArray(p)?p:[p],currentIndex:b})},e[1]=n):n=e[1];const o=n;let c;e[2]===Symbol.for("react.memo_cache_sentinel")?(c=()=>{r(_i)},e[2]=c):c=e[2];const d=c;let m;e[3]===Symbol.for("react.memo_cache_sentinel")?(m=p=>{r(h=>({...h,currentIndex:p}))},e[3]=m):m=e[3];const u=m;let f;e[4]!==i?(f={...i,openLightbox:o,closeLightbox:d,setIndex:u},e[4]=i,e[5]=f):f=e[5];let x;return e[6]!==a||e[7]!==f?(x=(0,s.jsx)(vs.Provider,{value:f,children:a}),e[6]=a,e[7]=f,e[8]=x):x=e[8],x},bt=()=>{const t=(0,g.useContext)(vs);if(!t)throw new Error("useLightbox must be used within a LightboxProvider");return t};function _i(t){return{...t,isOpen:!1}}var Ci=W();const js=t=>{const e=(0,Ci.c)(16),a=Ze(),l=t?.id;let i;e[0]!==l?(i=["unread_notifications_count",l],e[0]=l,e[1]=i):i=e[1];let r;e[2]!==t?.id?(r=()=>ri(t?.id),e[2]=t?.id,e[3]=r):r=e[3];const n=!!t?.id;let o;e[4]!==i||e[5]!==r||e[6]!==n?(o={queryKey:i,queryFn:r,enabled:n},e[4]=i,e[5]=r,e[6]=n,e[7]=o):o=e[7];const{data:c}=Le(o),d=c===void 0?0:c;let m;e[8]!==t||e[9]!==a?(m=()=>{if(!t?.id)return;const p=T.channel(`unread_count:${t.id}`).on("postgres_changes",{event:"*",schema:"public",table:"notifications",filter:`recipient_id=eq.${t.id}`},()=>{a.invalidateQueries({queryKey:["unread_notifications_count",t.id]}),a.invalidateQueries({queryKey:["notifications",t.id]})}).subscribe();return()=>T.removeChannel(p)},e[8]=t,e[9]=a,e[10]=m):m=e[10];const u=t?.id;let f;e[11]!==a||e[12]!==u?(f=[u,a],e[11]=a,e[12]=u,e[13]=f):f=e[13],(0,g.useEffect)(m,f);let x;return e[14]!==d?(x={unreadCount:d},e[14]=d,e[15]=x):x=e[15],x};var Si=W();const gt=t=>{const e=(0,Si.c)(65),a=Ze();let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l={},e[0]=l):l=e[0];const[i,r]=(0,g.useState)(l),n=(0,g.useRef)(null),o=t?.id;let c;e[1]!==o?(c=["conversations",o],e[1]=o,e[2]=c):c=e[2];let d;e[3]!==t?.id?(d=()=>Zl(t?.id),e[3]=t?.id,e[4]=d):d=e[4];const m=!!t?.id;let u;e[5]!==c||e[6]!==d||e[7]!==m?(u={queryKey:c,queryFn:d,enabled:m},e[5]=c,e[6]=d,e[7]=m,e[8]=u):u=e[8];const{data:f,isLoading:x}=Le(u);let p;e[9]!==f?(p=f===void 0?[]:f,e[9]=f,e[10]=p):p=e[10];const h=p,b=t?.id;let v;e[11]!==b?(v=["unread_messages_count",b],e[11]=b,e[12]=v):v=e[12];let j;e[13]!==t?.id?(j=()=>Gl(t?.id),e[13]=t?.id,e[14]=j):j=e[14];const k=!!t?.id;let N;e[15]!==j||e[16]!==k||e[17]!==v?(N={queryKey:v,queryFn:j,enabled:k},e[15]=j,e[16]=k,e[17]=v,e[18]=N):N=e[18];const{data:w}=Le(N),_=w===void 0?0:w;let S;e[19]===Symbol.for("react.memo_cache_sentinel")?(S=["reactions"],e[19]=S):S=e[19];const z=!!t?.id;let $;e[20]!==z?($={queryKey:S,queryFn:ei,enabled:z},e[20]=z,e[21]=$):$=e[21];const{data:P}=Le($);let F;e[22]!==P?(F=P===void 0?[]:P,e[22]=P,e[23]=F):F=e[23];const M=F;let L;e[24]!==t||e[25]!==a?(L=()=>{if(!t?.id)return;const Z=T.channel(`user_messages:${t.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},A=>{const Q=A.new;a.setQueryData(["messages",Q.conversation_id],H=>H?H.find(ae=>ae.id===Q.id)?H:[...H,Q]:[Q]),Q.sender_id!==t.id&&a.invalidateQueries({queryKey:["unread_messages_count",t.id]}),a.invalidateQueries(["conversations",t.id]),r(H=>({...H,[Q.conversation_id]:!1}))}).on("postgres_changes",{event:"DELETE",schema:"public",table:"messages"},A=>{a.invalidateQueries({queryKey:["messages"]}),a.invalidateQueries({queryKey:["conversations",t.id]})}).on("postgres_changes",{event:"*",schema:"public",table:"message_reactions"},()=>{a.invalidateQueries({queryKey:["reactions"]})}).subscribe(),ee=T.channel("chat_typing_shared").on("broadcast",{event:"typing"},A=>{const{payload:Q}=A,{conversationId:H,isTyping:ae,userId:J}=Q;J!==t.id&&r(ne=>({...ne,[H]:ae}))}).subscribe();return n.current=ee,()=>{T.removeChannel(Z),T.removeChannel(ee)}},e[24]=t,e[25]=a,e[26]=L):L=e[26];const R=t?.id;let O;e[27]!==a||e[28]!==R?(O=[R,a],e[27]=a,e[28]=R,e[29]=O):O=e[29],(0,g.useEffect)(L,O);let q;e[30]!==t?(q=Z=>{const{convId:ee,text:A,type:Q,media:H,replyToId:ae}=Z,J=Q===void 0?"text":Q,ne=H===void 0?[]:H,Ce=ae===void 0?null:ae;return si(ee,t.id,A,J,ne,Ce)},e[30]=t,e[31]=q):q=e[31];let I;e[32]!==t||e[33]!==a?(I=Z=>{a.setQueryData(["messages",Z.conversation_id],ee=>ee?ee.find(A=>A.id===Z.id)?ee:[...ee,Z]:[Z]),a.invalidateQueries(["conversations",t.id])},e[32]=t,e[33]=a,e[34]=I):I=e[34];let y;e[35]!==q||e[36]!==I?(y={mutationFn:q,onSuccess:I},e[35]=q,e[36]=I,e[37]=y):y=e[37];const C=cs(y);let E;e[38]!==t?(E=(Z,ee)=>{n.current&&n.current.send({type:"broadcast",event:"typing",payload:{conversationId:Z,isTyping:ee,userId:t.id}})},e[38]=t,e[39]=E):E=e[39];const D=E;let U;e[40]!==t||e[41]!==a?(U=async Z=>{!t?.id||!Z||(await Xl(Z,t.id),a.invalidateQueries({queryKey:["unread_messages_count",t.id]}),a.invalidateQueries({queryKey:["conversations",t.id]}))},e[40]=t,e[41]=a,e[42]=U):U=e[42];const B=U;let Y;e[43]!==t||e[44]!==a?(Y=async(Z,ee)=>{if(t?.id)try{await ti(Z,t.id,ee),a.invalidateQueries({queryKey:["reactions"]})}catch(A){console.error("Failed to toggle reaction:",A)}},e[43]=t,e[44]=a,e[45]=Y):Y=e[45];const G=Y;let te;e[46]!==a?(te=async Z=>{try{await ai(Z),a.invalidateQueries({queryKey:["messages"]})}catch(ee){console.error("Failed to delete message:",ee)}},e[46]=a,e[47]=te):te=e[47];const se=te;let ie;e[48]!==t?.id?(ie=(Z,ee)=>{const A=Z===void 0?[]:Z,Q=ee===void 0?[]:ee;return A.map(H=>({id:H.id,sender:H.sender_id===t?.id?"me":"them",text:H.content,type:H.type||"text",media:H.media||[],isRead:H.is_read,replyToId:H.reply_to_id,reactions:Q.filter(ae=>ae.message_id===H.id),time:new Date(H.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}))},e[48]=t?.id,e[49]=ie):ie=e[49];const de=ie;let ce;e[50]!==C?(ce=(Z,ee,A,Q,H)=>C.mutate({convId:Z,text:ee,type:A,media:Q,replyToId:H}),e[50]=C,e[51]=ce):ce=e[51];let me;return e[52]!==M||e[53]!==h||e[54]!==de||e[55]!==x||e[56]!==B||e[57]!==se||e[58]!==G||e[59]!==C.isPending||e[60]!==D||e[61]!==ce||e[62]!==i||e[63]!==_?(me={conversations:h,unreadCount:_,isConvLoading:x,sendMessage:ce,sendTypingStatus:D,typingStatus:i,markAsRead:B,formatMessages:de,onToggleReaction:G,onDeleteMessage:se,allReactions:M,isSending:C.isPending},e[52]=M,e[53]=h,e[54]=de,e[55]=x,e[56]=B,e[57]=se,e[58]=G,e[59]=C.isPending,e[60]=D,e[61]=ce,e[62]=i,e[63]=_,e[64]=me):me=e[64],me};var $i=W(),Pi=t=>{const e=(0,$i.c)(18),{onPostClick:a}=t,{currentUser:l}=he(),{unreadCount:i}=js(l),{unreadCount:r}=gt(l);let n,o,c,d,m;e[0]===Symbol.for("react.memo_cache_sentinel")?(n={id:"home",icon:xt,path:"/"},o={id:"explore",icon:Qt,path:"/explore"},c={id:"reels",icon:Ue,path:"/reels"},d={id:"messages",icon:Ge,path:"/messages"},m={id:"notifications",icon:ut,path:"/notifications"},e[0]=n,e[1]=o,e[2]=c,e[3]=d,e[4]=m):(n=e[0],o=e[1],c=e[2],d=e[3],m=e[4]);const u=l?`/u/${l.handle}`:"/explore";let f;e[5]!==u?(f=[n,o,c,d,m,{id:"profile",icon:Ta,path:u}],e[5]=u,e[6]=f):f=e[6];const x=f;let p;e[7]===Symbol.for("react.memo_cache_sentinel")?(p=(0,s.jsx)(Gs,{to:"/",className:"mb-8 hover:scale-110 transition-transform",children:(0,s.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",alt:"Logo",className:"size-8 rounded-lg"})}),e[7]=p):p=e[7];let h;e[8]!==r||e[9]!==x||e[10]!==i?(h=x.map(j=>(0,s.jsxs)(Vt,{to:j.path,className:Mi,children:[(0,s.jsx)(j.icon,{size:26,strokeWidth:2.5}),j.id==="notifications"&&i>0&&(0,s.jsx)("span",{className:"absolute top-2 right-2 size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"}),j.id==="messages"&&r>0&&(0,s.jsx)("span",{className:"absolute top-2 right-2 size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"})]},j.id)),e[8]=r,e[9]=x,e[10]=i,e[11]=h):h=e[11];let b;e[12]!==l||e[13]!==a?(b=l&&(0,s.jsx)("button",{onClick:a,className:"p-2.5 mt-2 rounded-xl text-white bg-zinc-950 dark:bg-white dark:text-zinc-950 hover:scale-110 active:scale-95 transition-all duration-200 shadow-lg cursor-pointer",title:"Create Post",children:(0,s.jsx)(Re,{size:26,strokeWidth:2.5})}),e[12]=l,e[13]=a,e[14]=b):b=e[14];let v;return e[15]!==b||e[16]!==h?(v=(0,s.jsxs)("aside",{className:"sticky top-0 hidden md:flex h-screen w-[68px] flex-col items-center py-5 border-r border-zinc-100 dark:border-zinc-800 shrink-0 bg-white dark:bg-black transition-colors duration-200",children:[p,(0,s.jsxs)("nav",{className:"flex flex-col gap-y-4 w-full items-center",children:[h,b]})]}),e[15]=b,e[16]=h,e[17]=v):v=e[17],v},Fi=Pi;function Mi(t){const{isActive:e}=t;return`p-2.5 rounded-xl transition-all duration-200 border border-transparent relative ${e?"text-black dark:text-white bg-zinc-100 dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800":"text-zinc-500 hover:bg-zinc-50 dark:hover:bg-zinc-900"}`}var Li=W(),Ri=t=>{const e=(0,Li.c)(13),{value:a,onChange:l,onClear:i,placeholder:r}=t,n=r===void 0?"Search...":r;let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=(0,s.jsx)(ls,{size:18,className:"absolute left-4 top-1/2 -translate-y-1/2 text-zinc-400 group-focus-within:text-violet-500 transition-colors"}),e[0]=o):o=e[0];let c;e[1]!==l?(c=f=>l(f.target.value),e[1]=l,e[2]=c):c=e[2];let d;e[3]!==n||e[4]!==c||e[5]!==a?(d=(0,s.jsx)("input",{className:"w-full rounded-full border border-zinc-100 dark:border-zinc-800 bg-zinc-50 dark:bg-zinc-900/50 text-zinc-900 dark:text-white px-11 py-2.5 text-sm outline-none focus:border-violet-500 focus:ring-1 focus:ring-violet-500 transition-all",placeholder:n,value:a,onChange:c}),e[3]=n,e[4]=c,e[5]=a,e[6]=d):d=e[6];let m;e[7]!==i||e[8]!==a?(m=a&&(0,s.jsx)("button",{onClick:i,className:"absolute right-4 top-1/2 -translate-y-1/2 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 transition-colors",children:(0,s.jsx)(be,{size:16})}),e[7]=i,e[8]=a,e[9]=m):m=e[9];let u;return e[10]!==d||e[11]!==m?(u=(0,s.jsxs)("div",{className:"relative group w-full",children:[o,d,m]}),e[10]=d,e[11]=m,e[12]=u):u=e[12],u},Ke=Ri,Ii=W();function X(...t){return Nl(wl(t))}const Ei=()=>{const t=(0,Ii.c)(2),{pathname:e}=Xe();let a;return t[0]!==e?(a=[e],t[0]=e,t[1]=a):a=t[1],(0,g.useEffect)(Ai,a),null},je=t=>typeof t!="string"?!1:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t),Ti=(t,e)=>{const a=document.createElement("canvas"),l=t.naturalWidth/t.width,i=t.naturalHeight/t.height;a.width=e.width*l,a.height=e.height*i;const r=a.getContext("2d");return r.imageSmoothingEnabled=!0,r.imageSmoothingQuality="high",r.drawImage(t,e.x*l,e.y*i,e.width*l,e.height*i,0,0,e.width*l,e.height*i),new Promise((n,o)=>{a.toBlob(c=>{if(!c){o(new Error("Canvas is empty"));return}n(c)},"image/jpeg",.95)})},Ve=t=>{if(!t)return"";const e=new Date-new Date(t),a=Math.floor(e/1e3),l=Math.floor(a/60),i=Math.floor(l/60),r=Math.floor(i/24);return a<60?"Just now":l<60?`${l}m ago`:i<24?`${i}h ago`:r<7?`${r}d ago`:new Date(t).toLocaleDateString()},qi=t=>typeof t!="string"?!1:/[\u0980-\u09FF]/.test(t);function Ai(){window.scrollTo(0,0)}var Oi=W(),Di=t=>{const e=(0,Oi.c)(9),{className:a}=t,{setAuthMode:l}=he();let i;e[0]!==a?(i=X("border border-[--border] rounded-2xl p-8 flex flex-col items-center text-center gap-4 bg-[--card] shadow-sm",a),e[0]=a,e[1]=i):i=e[1];let r,n;e[2]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"size-16 rounded-full border-4 border-amber-400 border-t-transparent animate-spin duration-[3000ms]"}),(0,s.jsx)("span",{className:"absolute inset-0 flex items-center justify-center text-2xl",children:"ðŸ’«"})]}),n=(0,s.jsx)("h3",{className:"font-extrabold text-lg text-[--foreground] mt-2 leading-tight",children:"Get your Sysm account now!"}),e[2]=r,e[3]=n):(r=e[2],n=e[3]);let o;e[4]!==l?(o=(0,s.jsx)("button",{onClick:()=>l("signup"),className:"w-full bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 py-2.5 rounded-full font-black text-sm uppercase tracking-wider hover:opacity-90 active:scale-95 transition-all shadow-lg cursor-pointer",children:"Signup now"}),e[4]=l,e[5]=o):o=e[5];let c;return e[6]!==i||e[7]!==o?(c=(0,s.jsxs)("div",{className:i,children:[r,n,o]}),e[6]=i,e[7]=o,e[8]=c):c=e[8],c},ws=Di,Bi=W(),Wi=t=>{const e=(0,Bi.c)(41),{trendingTopics:a}=t;let l;e[0]!==a?(l=a===void 0?[]:a,e[0]=a,e[1]=l):l=e[1];const i=l,{currentUser:r,setAuthMode:n}=he(),{darkMode:o,toggleDarkMode:c}=pt(),[d,m]=(0,g.useState)("");let u;e[2]===Symbol.for("react.memo_cache_sentinel")?(u=["Â© 2026 Sysm","Terms","Privacy","Guidelines","Discord","Sysm","GitHub","Support","Status"],e[2]=u):u=e[2];const f=u;let x;e[3]!==o?(x=o?(0,s.jsx)(nl,{size:20}):(0,s.jsx)(pl,{size:20}),e[3]=o,e[4]=x):x=e[4];let p;e[5]!==x||e[6]!==c?(p=(0,s.jsx)("button",{onClick:c,className:"p-3 rounded-full bg-zinc-50 dark:bg-zinc-900 text-zinc-500 dark:text-zinc-400 border border-zinc-100 dark:border-zinc-800 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-all cursor-pointer",title:"Toggle Theme",children:x}),e[5]=x,e[6]=c,e[7]=p):p=e[7];const h=p;if(r){let P;e[8]===Symbol.for("react.memo_cache_sentinel")?(P=()=>m(""),e[8]=P):P=e[8];let F;e[9]!==d?(F=(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(Ke,{value:d,onChange:m,onClear:P})}),e[9]=d,e[10]=F):F=e[10];let M;e[11]!==F||e[12]!==h?(M=(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[F,h]}),e[11]=F,e[12]=h,e[13]=M):M=e[13];let L;e[14]===Symbol.for("react.memo_cache_sentinel")?(L=(0,s.jsx)("h3",{className:"font-extrabold text-xl mb-4 px-2 text-[--foreground]",children:"What's happening"}),e[14]=L):L=e[14];let R;e[15]!==i?(R=i.map(Qi),e[15]=i,e[16]=R):R=e[16];let O;e[17]!==R?(O=(0,s.jsxs)("div",{className:"bg-zinc-50 dark:bg-zinc-900 rounded-2xl p-4 border border-[--border]",children:[L,(0,s.jsx)("div",{className:"flex flex-col gap-1",children:R})]}),e[17]=R,e[18]=O):O=e[18];let q;e[19]===Symbol.for("react.memo_cache_sentinel")?(q=(0,s.jsx)("div",{className:"flex flex-wrap gap-x-4 gap-y-2 px-2 text-[13px] text-zinc-500 font-medium pb-5",children:f.map(Vi)}),e[19]=q):q=e[19];let I;return e[20]!==O||e[21]!==M?(I=(0,s.jsxs)("aside",{className:"sticky top-5 hidden w-[320px] shrink-0 flex-col gap-y-6 lg:flex overflow-y-auto max-h-screen",children:[M,O,q]}),e[20]=O,e[21]=M,e[22]=I):I=e[22],I}let b,v;e[23]!==n?(b=(0,s.jsx)("button",{onClick:()=>n("signup"),className:"flex-1 bg-[--card] border border-[--border] py-2.5 rounded-full font-bold text-[--foreground] hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors shadow-sm cursor-pointer",children:"Signup"}),v=()=>n("login"),e[23]=n,e[24]=b,e[25]=v):(b=e[24],v=e[25]);let j;e[26]===Symbol.for("react.memo_cache_sentinel")?(j=(0,s.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",alt:"",className:"size-4 rounded-sm"}),e[26]=j):j=e[26];let k;e[27]!==v?(k=(0,s.jsxs)("button",{onClick:v,className:"flex-1 bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 py-2.5 rounded-full font-bold flex items-center justify-center gap-2 hover:opacity-90 transition-opacity cursor-pointer",children:[j,"Login"]}),e[27]=v,e[28]=k):k=e[28];let N;e[29]!==b||e[30]!==k||e[31]!==h?(N=(0,s.jsxs)("div",{className:"flex gap-3",children:[b,k,h]}),e[29]=b,e[30]=k,e[31]=h,e[32]=N):N=e[32];let w;e[33]===Symbol.for("react.memo_cache_sentinel")?(w=()=>m(""),e[33]=w):w=e[33];let _;e[34]!==d?(_=(0,s.jsx)(Ke,{value:d,onChange:m,onClear:w}),e[34]=d,e[35]=_):_=e[35];let S;e[36]===Symbol.for("react.memo_cache_sentinel")?(S=(0,s.jsx)(ws,{}),e[36]=S):S=e[36];let z;e[37]===Symbol.for("react.memo_cache_sentinel")?(z=(0,s.jsx)("div",{className:"flex flex-wrap gap-x-4 gap-y-2 px-2 text-[13px] text-zinc-500 font-medium pb-5",children:f.map(Ui)}),e[37]=z):z=e[37];let $;return e[38]!==N||e[39]!==_?($=(0,s.jsxs)("aside",{className:"sticky top-5 hidden w-[350px] shrink-0 flex-col gap-y-6 lg:flex pr-4",children:[N,_,S,z]}),e[38]=N,e[39]=_,e[40]=$):$=e[40],$},Hi=Wi;function Qi(t){return(0,s.jsxs)("div",{className:"px-3 py-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-xl cursor-pointer transition-colors group",children:[(0,s.jsx)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400 font-medium",children:"Trending"}),(0,s.jsxs)("div",{className:"font-bold text-[--foreground]",children:["#",t.tag]}),(0,s.jsxs)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:[t.posts," posts"]})]},t.tag)}function Vi(t){return(0,s.jsx)("a",{href:"#",className:"hover:underline",children:t},t)}function Ui(t){return(0,s.jsx)("a",{href:"#",className:"hover:underline",children:t},t)}var vt=W();function ue(t){const e=(0,vt.c)(8);let a,l;e[0]!==t?({className:a,...l}=t,e[0]=t,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let i;e[3]!==a?(i=X("relative flex size-8 shrink-0 overflow-hidden rounded-full",a),e[3]=a,e[4]=i):i=e[4];let r;return e[5]!==l||e[6]!==i?(r=(0,s.jsx)(za,{"data-slot":"avatar",className:i,...l}),e[5]=l,e[6]=i,e[7]=r):r=e[7],r}function fe(t){const e=(0,vt.c)(8);let a,l;e[0]!==t?({className:a,...l}=t,e[0]=t,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let i;e[3]!==a?(i=X("aspect-square size-full",a),e[3]=a,e[4]=i):i=e[4];let r;return e[5]!==l||e[6]!==i?(r=(0,s.jsx)(ka,{"data-slot":"avatar-image",className:i,...l}),e[5]=l,e[6]=i,e[7]=r):r=e[7],r}function xe(t){const e=(0,vt.c)(8);let a,l;e[0]!==t?({className:a,...l}=t,e[0]=t,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let i;e[3]!==a?(i=X("bg-muted flex size-full items-center justify-center rounded-full",a),e[3]=a,e[4]=i):i=e[4];let r;return e[5]!==l||e[6]!==i?(r=(0,s.jsx)(ra,{"data-slot":"avatar-fallback",className:i,...l}),e[5]=l,e[6]=i,e[7]=r):r=e[7],r}var Ki=W(),Ji=t=>{const e=(0,Ki.c)(23),{handleProfileClick:a}=t,{currentUser:l}=he(),{unreadCount:i}=js(l),{unreadCount:r}=gt(l),n=Xe();let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=[{id:"home",icon:xt,path:"/"},{id:"explore",icon:Qt,path:"/explore"},{id:"reels",icon:Ue,path:"/reels"},{id:"messages",icon:Ge,path:"/messages"},{id:"notifications",icon:ut,path:"/notifications"}],e[0]=o):o=e[0];const c=o;let d;e[1]!==r||e[2]!==i?(d=c.map(k=>(0,s.jsx)(Vt,{to:k.path,className:Xi,children:N=>{const{isActive:w}=N;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(k.icon,{size:26,strokeWidth:w?2.5:2}),k.id==="notifications"&&i>0&&(0,s.jsx)("span",{className:"absolute top-3 right-[30%] size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"}),k.id==="messages"&&r>0&&(0,s.jsx)("span",{className:"absolute top-3 right-[30%] size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"})]})}},k.id)),e[1]=r,e[2]=i,e[3]=d):d=e[3];let m;e[4]!==l||e[5]!==a?(m=()=>{l&&a(l.handle)},e[4]=l,e[5]=a,e[6]=m):m=e[6];const u=`size-7 border-2 ${n.pathname.startsWith("/u/")?"border-black dark:border-white":"border-transparent opacity-70"}`,f=l?.avatar||"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm";let x;e[7]!==f?(x=(0,s.jsx)(fe,{src:f,alt:"Profile",className:"object-cover"}),e[7]=f,e[8]=x):x=e[8];let p;e[9]!==l?.handle?.[0]?(p=l?.handle?.[0]?.toUpperCase(),e[9]=l?.handle?.[0],e[10]=p):p=e[10];let h;e[11]!==p?(h=(0,s.jsx)(xe,{children:p}),e[11]=p,e[12]=h):h=e[12];let b;e[13]!==u||e[14]!==x||e[15]!==h?(b=(0,s.jsxs)(ue,{className:u,children:[x,h]}),e[13]=u,e[14]=x,e[15]=h,e[16]=b):b=e[16];let v;e[17]!==m||e[18]!==b?(v=(0,s.jsx)("button",{onClick:m,className:"flex-1 flex flex-col items-center justify-center h-full",children:b}),e[17]=m,e[18]=b,e[19]=v):v=e[19];let j;return e[20]!==v||e[21]!==d?(j=(0,s.jsxs)("nav",{className:"fixed bottom-0 left-0 right-0 z-[40] flex h-16 items-center border-t border-zinc-100 bg-white/90 pb-safe backdrop-blur-md dark:border-zinc-800 dark:bg-black/90 md:hidden",children:[d,v]}),e[20]=v,e[21]=d,e[22]=j):j=e[22],j},Gi=Ji;function Xi(t){const{isActive:e}=t;return`flex flex-1 flex-col items-center justify-center h-full transition-all duration-200 relative ${e?"text-black dark:text-white":"text-zinc-400 opacity-70"}`}var Zi=W(),Yi=()=>{const t=(0,Zi.c)(5);let e,a;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,s.jsx)("img",{src:"https://systemadminbd.com/uploads/675346dd55e0c7.43939630.png",alt:"Welcome Banner",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-700"}),a=(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"}),t[0]=e,t[1]=a):(e=t[0],a=t[1]);let l;t[2]===Symbol.for("react.memo_cache_sentinel")?(l=(0,s.jsx)("h1",{className:"text-3xl sm:text-4xl font-black mb-1 drop-shadow-lg",children:"Welcome to Sysm"}),t[2]=l):l=t[2];let i;t[3]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsxs)("div",{className:"absolute bottom-6 left-8 text-white",children:[l,(0,s.jsxs)("p",{className:"text-sm sm:text-base font-medium opacity-90 tracking-wide drop-shadow-md",children:["a social network built by"," ",(0,s.jsx)("a",{href:"https://t.me/systemadminbd",target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:"@Systemadminbd"})]})]}),t[3]=i):i=t[3];let r;return t[4]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsxs)("div",{className:"relative w-full aspect-[21/9] sm:aspect-[2.5/1] rounded-3xl overflow-hidden mb-6 group cursor-pointer",children:[e,a,i,(0,s.jsx)("div",{className:"absolute bottom-4 right-8",children:(0,s.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",className:"size-12 animate-pulse opacity-80 rounded-xl",alt:""})})]}),t[4]=r):r=t[4],r},er=Yi,tr=W(),sr=t=>{const e=(0,tr.c)(27),{onPostClick:a}=t,l=Xe(),i=we(),{darkMode:r}=pt(),n=l.pathname==="/";let o;e[0]!==l.pathname?(o=l.pathname.startsWith("/reels")||l.pathname.startsWith("/messages")&&l.pathname.split("/").length>2,e[0]=l.pathname,e[1]=o):o=e[1];const c=o;let d;e[2]!==i?(d=S=>{i(`/u/${S}`)},e[2]=i,e[3]=d):d=e[3];const m=d,u=`min-h-screen bg-[--background] text-[--foreground] font-sans selection:bg-violet-500 selection:text-white transition-colors duration-200 ${r?"dark":""}`;let f;e[4]!==a?(f=(0,s.jsx)(Fi,{onPostClick:a}),e[4]=a,e[5]=f):f=e[5];const x=!c&&"pb-24 md:pb-0";let p;e[6]!==x?(p=X("flex-1 flex justify-center gap-x-2 md:gap-x-8 py-0 md:py-5 px-0 md:px-4",x),e[6]=x,e[7]=p):p=e[7];let h;e[8]!==n?(h=n&&(0,s.jsx)("div",{className:"w-full max-w-full overflow-hidden",children:(0,s.jsx)(er,{})}),e[8]=n,e[9]=h):h=e[9];let b;e[10]===Symbol.for("react.memo_cache_sentinel")?(b=(0,s.jsx)("div",{className:"w-full",children:(0,s.jsx)(Ka,{})}),e[10]=b):b=e[10];let v;e[11]!==h?(v=(0,s.jsxs)("div",{className:"flex flex-col flex-1 w-0 overflow-x-hidden",children:[h,b]}),e[11]=h,e[12]=v):v=e[12];let j;e[13]===Symbol.for("react.memo_cache_sentinel")?(j=(0,s.jsx)(Hi,{trendingTopics:mi}),e[13]=j):j=e[13];let k;e[14]!==p||e[15]!==v?(k=(0,s.jsxs)("div",{className:p,children:[v,j]}),e[14]=p,e[15]=v,e[16]=k):k=e[16];let N;e[17]!==k||e[18]!==f?(N=(0,s.jsxs)("div",{className:"flex justify-center w-full max-w-[1300px] mx-auto min-h-screen px-0 sm:px-0",children:[f,k]}),e[17]=k,e[18]=f,e[19]=N):N=e[19];let w;e[20]!==m||e[21]!==c?(w=!c&&(0,s.jsx)(Gi,{handleProfileClick:m}),e[20]=m,e[21]=c,e[22]=w):w=e[22];let _;return e[23]!==N||e[24]!==w||e[25]!==u?(_=(0,s.jsxs)("div",{className:u,children:[N,w]}),e[23]=N,e[24]=w,e[25]=u,e[26]=_):_=e[26],_},ar=sr,$e=W();function ys(t){const e=(0,$e.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let l;return e[2]!==a?(l=(0,s.jsx)(na,{"data-slot":"dialog",...a}),e[2]=a,e[3]=l):l=e[3],l}function lr(t){const e=(0,$e.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let l;return e[2]!==a?(l=(0,s.jsx)(ea,{"data-slot":"dialog-portal",...a}),e[2]=a,e[3]=l):l=e[3],l}function ir(t){const e=(0,$e.c)(8);let a,l;e[0]!==t?({className:a,...l}=t,e[0]=t,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let i;e[3]!==a?(i=X("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),e[3]=a,e[4]=i):i=e[4];let r;return e[5]!==l||e[6]!==i?(r=(0,s.jsx)(Na,{"data-slot":"dialog-overlay",className:i,...l}),e[5]=l,e[6]=i,e[7]=r):r=e[7],r}function Ns(t){const e=(0,$e.c)(15);let a,l,i,r;e[0]!==t?({className:l,children:a,showCloseButton:r,...i}=t,e[0]=t,e[1]=a,e[2]=l,e[3]=i,e[4]=r):(a=e[1],l=e[2],i=e[3],r=e[4]);const n=r===void 0?!0:r;let o;e[5]===Symbol.for("react.memo_cache_sentinel")?(o=(0,s.jsx)(ir,{}),e[5]=o):o=e[5];let c;e[6]!==l?(c=X("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg p-6 shadow-lg duration-200 outline-none sm:max-w-lg",l),e[6]=l,e[7]=c):c=e[7];let d;e[8]!==n?(d=n&&(0,s.jsxs)(ya,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,s.jsx)(be,{}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]}),e[8]=n,e[9]=d):d=e[9];let m;return e[10]!==a||e[11]!==i||e[12]!==c||e[13]!==d?(m=(0,s.jsxs)(lr,{"data-slot":"dialog-portal",children:[o,(0,s.jsxs)(sa,{"data-slot":"dialog-content",className:c,...i,children:[a,d]})]}),e[10]=a,e[11]=i,e[12]=c,e[13]=d,e[14]=m):m=e[14],m}function zs(t){const e=(0,$e.c)(8);let a,l;e[0]!==t?({className:a,...l}=t,e[0]=t,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let i;e[3]!==a?(i=X("flex flex-col gap-2 text-center sm:text-left",a),e[3]=a,e[4]=i):i=e[4];let r;return e[5]!==l||e[6]!==i?(r=(0,s.jsx)("div",{"data-slot":"dialog-header",className:i,...l}),e[5]=l,e[6]=i,e[7]=r):r=e[7],r}function ks(t){const e=(0,$e.c)(8);let a,l;e[0]!==t?({className:a,...l}=t,e[0]=t,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let i;e[3]!==a?(i=X("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),e[3]=a,e[4]=i):i=e[4];let r;return e[5]!==l||e[6]!==i?(r=(0,s.jsx)("div",{"data-slot":"dialog-footer",className:i,...l}),e[5]=l,e[6]=i,e[7]=r):r=e[7],r}function _s(t){const e=(0,$e.c)(8);let a,l;e[0]!==t?({className:a,...l}=t,e[0]=t,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let i;e[3]!==a?(i=X("text-lg leading-none font-semibold",a),e[3]=a,e[4]=i):i=e[4];let r;return e[5]!==l||e[6]!==i?(r=(0,s.jsx)(tl,{"data-slot":"dialog-title",className:i,...l}),e[5]=l,e[6]=i,e[7]=r):r=e[7],r}function rr(t){const e=(0,$e.c)(8);let a,l;e[0]!==t?({className:a,...l}=t,e[0]=t,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let i;e[3]!==a?(i=X("text-muted-foreground text-sm",a),e[3]=a,e[4]=i):i=e[4];let r;return e[5]!==l||e[6]!==i?(r=(0,s.jsx)(wa,{"data-slot":"dialog-description",className:i,...l}),e[5]=l,e[6]=i,e[7]=r):r=e[7],r}var nr=W(),or=t=>{const e=(0,nr.c)(20),{isOpen:a,onClose:l,title:i,children:r,footer:n,description:o,className:c}=t;let d;e[0]!==l?(d=v=>{v||l()},e[0]=l,e[1]=d):d=e[1];const m=d;let u;e[2]!==c?(u=X("sm:max-w-md max-h-[calc(100dvh-2rem)] flex flex-col p-0 gap-0 overflow-hidden bg-white dark:bg-zinc-900",c),e[2]=c,e[3]=u):u=e[3];let f;e[4]!==o||e[5]!==i?(f=i&&(0,s.jsxs)(zs,{className:"px-5 py-4 shrink-0",children:[(0,s.jsx)(_s,{className:"text-xl font-bold",children:i}),o&&(0,s.jsx)(rr,{children:o})]}),e[4]=o,e[5]=i,e[6]=f):f=e[6];let x;e[7]!==r?(x=(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-5 min-h-0",children:r}),e[7]=r,e[8]=x):x=e[8];let p;e[9]!==n?(p=n&&(0,s.jsx)(ks,{className:"px-5 py-4 shrink-0 bg-white dark:bg-zinc-900",children:n}),e[9]=n,e[10]=p):p=e[10];let h;e[11]!==u||e[12]!==f||e[13]!==x||e[14]!==p?(h=(0,s.jsxs)(Ns,{className:u,children:[f,x,p]}),e[11]=u,e[12]=f,e[13]=x,e[14]=p,e[15]=h):h=e[15];let b;return e[16]!==m||e[17]!==a||e[18]!==h?(b=(0,s.jsx)(ys,{open:a,onOpenChange:m,children:h}),e[16]=m,e[17]=a,e[18]=h,e[19]=b):b=e[19],b},et=or,cr=W(),dr=t=>{const e=(0,cr.c)(12);let a,l,i,r;e[0]!==t?({children:a,variant:i,className:r,...l}=t,e[0]=t,e[1]=a,e[2]=l,e[3]=i,e[4]=r):(a=e[1],l=e[2],i=e[3],r=e[4]);const n=i===void 0?"primary":i,o=r===void 0?"":r;let c;e[5]===Symbol.for("react.memo_cache_sentinel")?(c={primary:"text-white hover:text-white bg-zinc-900 hover:bg-zinc-800 border border-zinc-900 dark:bg-white dark:text-black dark:border-white dark:hover:bg-zinc-200",secondary:"text-zinc-900 border border-zinc-300 hover:border-zinc-400 bg-transparent hover:bg-zinc-50 dark:text-white dark:border-zinc-700 dark:hover:border-zinc-600 dark:hover:bg-zinc-900",outline:"text-zinc-900 border border-zinc-300 hover:border-zinc-400 bg-white dark:bg-transparent dark:text-white dark:border-zinc-700 dark:hover:bg-zinc-900",danger:"text-white bg-red-500 hover:bg-red-600 border border-red-500",ghost:"text-zinc-500 hover:bg-zinc-100 dark:text-zinc-400 dark:hover:bg-zinc-800 border-transparent"},e[5]=c):c=e[5];const d=`rounded-full font-bold inline-flex items-center justify-center relative overflow-hidden px-4 py-1.5 transition-all duration-200 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:active:scale-100 touch-manipulation ${c[n]} ${o}`;let m;e[6]!==a?(m=(0,s.jsx)("div",{className:"flex items-center gap-x-1.5",children:a}),e[6]=a,e[7]=m):m=e[7];let u;return e[8]!==l||e[9]!==d||e[10]!==m?(u=(0,s.jsx)("button",{className:d,...l,children:m}),e[8]=l,e[9]=d,e[10]=m,e[11]=u):u=e[11],u},pe=dr,mr=W(),ur=t=>{const e=(0,mr.c)(33),{src:a,isOpen:l,onClose:i,onCropComplete:r,aspect:n,circular:o}=t,[c,d]=(0,g.useState)(),[m,u]=(0,g.useState)(null),f=(0,g.useRef)(null);let x;e[0]!==n?(x=M=>{const{width:L,height:R}=M.currentTarget;d(n?bl(ba({unit:"%",width:100},n,L,R),L,R):{unit:"%",width:100,height:100,x:0,y:0})},e[0]=n,e[1]=x):x=e[1];const p=x;let h;e[2]!==m||e[3]!==i||e[4]!==r?(h=async()=>{if(m&&f.current)try{r(await Ti(f.current,m)),i()}catch(M){console.error("Error cropping image:",M)}},e[2]=m,e[3]=i,e[4]=r,e[5]=h):h=e[5];const b=h;let v;e[6]!==i?(v=M=>!M&&i(),e[6]=i,e[7]=v):v=e[7];let j;e[8]===Symbol.for("react.memo_cache_sentinel")?(j=(0,s.jsx)(zs,{className:"p-4 shrink-0",children:(0,s.jsx)(_s,{children:"Crop Image"})}),e[8]=j):j=e[8];let k,N;e[9]===Symbol.for("react.memo_cache_sentinel")?(k=M=>d(M),N=(M,L)=>u(L),e[9]=k,e[10]=N):(k=e[9],N=e[10]);let w;e[11]!==p||e[12]!==a?(w=(0,s.jsx)("img",{ref:f,src:a,alt:"Crop preview",onLoad:p,className:"max-h-[60vh] w-auto block"}),e[11]=p,e[12]=a,e[13]=w):w=e[13];let _;e[14]!==n||e[15]!==o||e[16]!==c||e[17]!==w?(_=(0,s.jsx)("div",{className:"p-6 flex items-center justify-center bg-zinc-100/50 dark:bg-zinc-950/50 min-h-[300px] max-h-[65vh] overflow-auto",children:(0,s.jsx)(Qs,{crop:c,onChange:k,onComplete:N,aspect:n,circularCrop:o,className:"max-w-full shadow-2xl",children:w})}),e[14]=n,e[15]=o,e[16]=c,e[17]=w,e[18]=_):_=e[18];let S;e[19]!==i?(S=(0,s.jsx)(pe,{variant:"outline",onClick:i,className:"!w-auto px-6",children:"Cancel"}),e[19]=i,e[20]=S):S=e[20];let z;e[21]!==b?(z=(0,s.jsx)(pe,{onClick:b,className:"!w-auto px-6",children:"Apply Crop"}),e[21]=b,e[22]=z):z=e[22];let $;e[23]!==z||e[24]!==S?($=(0,s.jsxs)(ks,{className:"p-4 bg-white dark:bg-zinc-900 shrink-0 flex flex-row justify-end gap-2",children:[S,z]}),e[23]=z,e[24]=S,e[25]=$):$=e[25];let P;e[26]!==$||e[27]!==_?(P=(0,s.jsxs)(Ns,{className:"sm:max-w-2xl bg-white dark:bg-zinc-900 p-0 overflow-hidden",children:[j,_,$]}),e[26]=$,e[27]=_,e[28]=P):P=e[28];let F;return e[29]!==l||e[30]!==P||e[31]!==v?(F=(0,s.jsx)(ys,{open:l,onOpenChange:v,children:P}),e[29]=l,e[30]=P,e[31]=v,e[32]=F):F=e[32],F},jt=ur,fr=({isOpen:t,onClose:e})=>{const{currentUser:a}=he(),{addPost:l}=We(),{addToast:i}=_e(),[r,n]=(0,g.useState)(""),[o,c]=(0,g.useState)([]),[d,m]=(0,g.useState)({}),[u,f]=(0,g.useState)(!1),[x,p]=(0,g.useState)({options:["",""],duration:"1 day"}),[h,b]=(0,g.useState)(!1),[v,j]=(0,g.useState)(null),[k,N]=(0,g.useState)(null),w=(0,g.useRef)(null),_=(0,g.useRef)(null),[S,z]=(0,g.useState)(null),$=y=>{const C=Array.from(y.target.files);c(E=>[...E,...C])},P=y=>{const C=y.target.files[0];C&&S!==null&&m(E=>({...E,[S]:C})),z(null)},F=y=>{c(E=>E.filter((D,U)=>U!==y));const C={...d};delete C[y],m(C)},M=y=>{const C=o[y],E=new FileReader;E.onload=()=>{j(E.result),N(y)},E.readAsDataURL(C)},L=y=>{const C=new File([y],`cropped-${Date.now()}.jpg`,{type:"image/jpeg"}),E=[...o];E[k]=C,c(E),j(null),N(null)},R=()=>{x.options.length<4&&p(y=>({...y,options:[...y.options,""]}))},O=y=>{p(C=>({...C,options:C.options.filter((E,D)=>D!==y)}))},q=(y,C)=>{const E=[...x.options];E[y]=C,p(D=>({...D,options:E}))},I=async y=>{if(y.preventDefault(),!(!r.trim()&&o.length===0||!a)){b(!0);try{const C=[];for(let D=0;D<o.length;D++){const U=o[D],B=await ze(U,"media",d[D]||null);C.push(B)}let E=null;u&&x.options.some(D=>D.trim())&&(E={options:x.options.filter(D=>D.trim()).map((D,U)=>({id:U+1,text:D,votes:0})),ends_at:new Date(Date.now()+1440*60*1e3).toISOString()}),await l({content:r,media:C,poll:E,type:C.length>0?C[0].type==="video"?"video":"image":E?"poll":"text",userId:a.id}),n(""),c([]),f(!1),p({options:["",""],duration:"1 day"}),e(),i("Post published!")}catch(C){console.error("Failed to create post:",C),i("Failed to publish post.")}finally{b(!1)}}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(et,{isOpen:t,onClose:()=>!h&&e(),title:"Create Post",className:"sm:max-w-xl",footer:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,s.jsxs)("div",{className:"flex text-violet-600 gap-1",children:[(0,s.jsx)("button",{type:"button",onClick:()=>w.current?.click(),className:"p-2.5 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full transition-colors",title:"Attach media",children:(0,s.jsx)(Jt,{size:22})}),(0,s.jsx)("button",{type:"button",onClick:()=>f(!0),className:"p-2.5 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full transition-colors",title:"Add poll",children:(0,s.jsx)(sl,{size:22})}),(0,s.jsx)("button",{type:"button",className:"p-2.5 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full transition-colors",children:(0,s.jsx)(Zt,{size:22})}),(0,s.jsx)("input",{type:"file",ref:w,onChange:$,multiple:!0,className:"hidden",accept:"image/*,video/*,application/pdf"}),(0,s.jsx)("input",{type:"file",ref:_,onChange:P,className:"hidden",accept:"image/*"})]}),(0,s.jsx)(pe,{onClick:I,disabled:!r.trim()&&o.length===0||h,className:"px-8 py-2.5 min-w-[100px] text-base",children:h?(0,s.jsx)(re,{size:18,className:"animate-spin"}):"Post"})]}),children:(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)(ue,{className:"size-12 border border-zinc-200 dark:border-zinc-800",children:[(0,s.jsx)(fe,{src:a?.avatar,className:"object-cover"}),(0,s.jsx)(xe,{children:a?.handle?.[0]?.toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("textarea",{className:"w-full bg-transparent border-none outline-none text-lg min-h-[120px] resize-none dark:text-white",placeholder:"What's happening?",autoFocus:!0,value:r,onChange:y=>n(y.target.value)}),u&&(0,s.jsxs)("div",{className:"mt-4 p-4 rounded-2xl space-y-3 bg-zinc-50/50 dark:bg-zinc-900/50",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsx)("span",{className:"text-sm font-bold opacity-60",children:"Poll"}),(0,s.jsx)("button",{type:"button",onClick:()=>f(!1),className:"text-zinc-500 hover:text-rose-500",children:(0,s.jsx)(be,{size:18})})]}),x.options.map((y,C)=>(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{className:"flex-1 bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-xl px-4 py-2 text-sm outline-none focus:border-violet-500",placeholder:`Option ${C+1}`,value:y,onChange:E=>q(C,E.target.value)}),x.options.length>2&&(0,s.jsx)("button",{type:"button",onClick:()=>O(C),className:"p-2 text-rose-500 hover:bg-rose-50 dark:hover:bg-rose-900/20 rounded-lg transition-colors",children:(0,s.jsx)(os,{size:16})})]},C)),x.options.length<4&&(0,s.jsx)("button",{type:"button",onClick:R,className:"text-sm font-bold text-violet-600 hover:bg-violet-50 dark:hover:bg-violet-900/20 px-3 py-1.5 rounded-lg transition-colors",children:"+ Add option"})]}),o.length>0&&(0,s.jsx)("div",{className:"mt-4 flex flex-wrap gap-2",children:o.map((y,C)=>(0,s.jsxs)("div",{className:"relative group size-24 rounded-xl overflow-hidden bg-zinc-100 dark:bg-zinc-800 shadow-sm",children:[y.type.startsWith("image/")?(0,s.jsx)("img",{src:URL.createObjectURL(y),className:"size-full object-cover",alt:""}):(0,s.jsx)("div",{className:"size-full flex flex-col items-center justify-center text-zinc-500 bg-zinc-100 dark:bg-zinc-800",children:y.type.startsWith("video/")?(0,s.jsxs)(s.Fragment,{children:[d[C]?(0,s.jsx)("img",{src:URL.createObjectURL(d[C]),className:"size-full object-cover",alt:"Custom thumbnail"}):(0,s.jsx)(Re,{size:24,className:"animate-pulse"}),(0,s.jsx)("button",{type:"button",onClick:()=>{z(C),_.current?.click()},className:"absolute inset-x-0 bottom-0 bg-black/60 text-white text-[10px] font-bold py-1 backdrop-blur-sm hover:bg-black transition-colors",children:d[C]?"Change Thumbnail":"Add Thumbnail"})]}):(0,s.jsx)(Gt,{size:24})}),(0,s.jsx)("button",{type:"button",onClick:()=>F(C),className:"absolute top-1 right-1 size-6 rounded-full bg-black/60 text-white flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)(be,{size:14,strokeWidth:3})}),y.type.startsWith("image/")&&(0,s.jsx)("button",{type:"button",onClick:()=>M(C),className:"absolute bottom-1 right-1 size-6 rounded-full bg-black/60 text-white flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",title:"Crop image",children:(0,s.jsx)(ga,{size:14,strokeWidth:3})})]},C))})]})]})})}),v&&(0,s.jsx)(jt,{src:v,isOpen:!!v,onClose:()=>{j(null),N(null)},onCropComplete:L,aspect:void 0})]})},xr=fr,hr=W(),Cs=g.forwardRef((t,e)=>{const a=(0,hr.c)(20);let l,i,r,n,o;a[0]!==t?({className:l,label:i,type:o,textarea:n,...r}=t,a[0]=t,a[1]=l,a[2]=i,a[3]=r,a[4]=n,a[5]=o):(l=a[1],i=a[2],r=a[3],n=a[4],o=a[5]);const c=n?"textarea":"input";let d;a[6]!==i?(d=i&&(0,s.jsx)("label",{className:"text-sm font-bold text-zinc-500 dark:text-zinc-400 ml-1",children:i}),a[6]=i,a[7]=d):d=a[7];const m=n&&"min-h-[100px] resize-none";let u;a[8]!==l||a[9]!==m?(u=X("flex w-full rounded-xl border border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900 px-4 py-2.5 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-zinc-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:ring-offset-zinc-950 dark:text-white transition-all",m,l),a[8]=l,a[9]=m,a[10]=u):u=a[10];let f;a[11]!==c||a[12]!==r||a[13]!==e||a[14]!==u||a[15]!==o?(f=(0,s.jsx)(c,{type:o,className:u,ref:e,...r}),a[11]=c,a[12]=r,a[13]=e,a[14]=u,a[15]=o,a[16]=f):f=a[16];let x;return a[17]!==d||a[18]!==f?(x=(0,s.jsxs)("div",{className:"w-full space-y-1.5",children:[d,f]}),a[17]=d,a[18]=f,a[19]=x):x=a[19],x});Cs.displayName="Input";var Se=Cs,pr=({isOpen:t,onClose:e,editProfileData:a,setEditProfileData:l})=>{const{updateProfile:i}=he(),{addToast:r}=_e(),[n,o]=(0,g.useState)(!1),[c,d]=(0,g.useState)(null),[m,u]=(0,g.useState)(null),[f,x]=(0,g.useState)(null),[p,h]=(0,g.useState)(null),b=(0,g.useRef)(null),v=(0,g.useRef)(null),j=(w,_)=>{const S=w.target.files[0];if(S){const z=new FileReader;z.onload=()=>{x(z.result),h(_)},z.readAsDataURL(S)}},k=w=>{const _=new File([w],`cropped-${Date.now()}.jpg`,{type:"image/jpeg"});p==="avatar"?d(_):u(_),x(null),h(null)},N=async()=>{o(!0);try{let w=a.avatar,_=a.cover;c&&(w=(await ze(c)).url),m&&(_=(await ze(m)).url),await i({...a,avatar:w,cover:_}),d(null),u(null),e(),r("Profile updated!")}catch(w){console.error("Failed to update profile:",w),r("Failed to update profile.","error")}finally{o(!1)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(et,{isOpen:t,onClose:()=>!n&&e(),title:"Edit Profile",children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("input",{type:"file",ref:v,className:"hidden",accept:"image/*",onChange:w=>j(w,"cover")}),(0,s.jsx)("input",{type:"file",ref:b,className:"hidden",accept:"image/*",onChange:w=>j(w,"avatar")}),(0,s.jsxs)("div",{className:"relative h-32 bg-zinc-100 dark:bg-zinc-800 rounded-xl overflow-hidden group cursor-pointer",onClick:()=>v.current?.click(),children:[(m||a?.cover)&&(0,s.jsx)("img",{src:m?URL.createObjectURL(m):a.cover,className:"w-full h-full object-cover opacity-60",alt:""}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("div",{className:"bg-black/50 p-2 rounded-full text-white group-hover:scale-110 transition-transform",children:(0,s.jsx)(Re,{size:20})})})]}),(0,s.jsx)("div",{className:"relative -mt-16 ml-4",children:(0,s.jsxs)("div",{className:"relative size-24 rounded-full border-4 border-white dark:border-black overflow-hidden group cursor-pointer shadow-lg bg-white dark:bg-black",onClick:()=>b.current?.click(),children:[(c||a?.avatar)&&(0,s.jsxs)(ue,{className:"size-full opacity-60 rounded-none",children:[(0,s.jsx)(fe,{src:c?URL.createObjectURL(c):a.avatar,className:"object-cover"}),(0,s.jsx)(xe,{children:a?.handle?.[0]?.toUpperCase()})]}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("div",{className:"bg-black/50 p-2 rounded-full text-white group-hover:scale-110 transition-transform",children:(0,s.jsx)(Re,{size:16})})})]})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(Se,{label:"Name",value:a?.name||"",onChange:w=>l({...a,name:w.target.value})}),(0,s.jsx)(Se,{label:"Bio",textarea:!0,value:a?.bio||"",onChange:w=>l({...a,bio:w.target.value})}),(0,s.jsx)(Se,{label:"Location",value:a?.location||"",onChange:w=>l({...a,location:w.target.value})}),(0,s.jsx)(Se,{label:"Website",value:a?.website||"",onChange:w=>l({...a,website:w.target.value})})]}),(0,s.jsx)(pe,{className:"w-full py-3",disabled:n,onClick:N,children:n?(0,s.jsx)(re,{size:24,className:"animate-spin text-white mx-auto"}):"Save changes"})]})}),f&&(0,s.jsx)(jt,{src:f,isOpen:!!f,onClose:()=>{x(null),h(null)},onCropComplete:k,aspect:p==="avatar"?1:p==="cover"?3/1:void 0,circular:p==="avatar"})]})},br=pr,gr=({isOpen:t,onClose:e})=>{const{currentUser:a}=he(),{addToast:l}=_e(),i=Ze(),[r,n]=(0,g.useState)(null),[o,c]=(0,g.useState)(!1),[d,m]=(0,g.useState)(null),u=(0,g.useRef)(null),f=b=>{const v=b.target.files[0];v&&n(v)},x=()=>{if(!r)return;const b=new FileReader;b.onload=()=>{m(b.result)},b.readAsDataURL(r)},p=b=>{n(new File([b],`story-cropped-${Date.now()}.jpg`,{type:"image/jpeg"})),m(null)},h=async()=>{if(!(!r||!a)){c(!0);try{const b=await ze(r);await oi(a.id,b.url,b.type),n(null),e(),l("Story shared!"),i.invalidateQueries(["stories"])}catch(b){console.error("Failed to create story:",b),l("Failed to share story.")}finally{c(!1)}}};return(0,s.jsxs)(et,{isOpen:t,onClose:()=>!o&&e(),title:"Add Story",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[r?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"relative aspect-[9/16] w-full max-w-[280px] mx-auto rounded-3xl overflow-hidden shadow-2xl",children:[(0,s.jsx)("img",{src:URL.createObjectURL(r),className:"w-full h-full object-cover",alt:"Preview"}),(0,s.jsx)("button",{onClick:()=>n(null),className:"absolute top-4 right-4 p-2 bg-black/50 text-white rounded-full hover:bg-rose-500 transition-colors",title:"Remove",children:(0,s.jsx)(be,{size:20})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-center gap-4 py-2 bg-zinc-50/50 dark:bg-zinc-900/50 rounded-2xl",children:[(0,s.jsxs)("button",{onClick:x,className:"flex flex-col items-center gap-1.5 p-3 rounded-xl hover:bg-white dark:hover:bg-zinc-800 transition-all text-zinc-600 dark:text-zinc-400 hover:text-violet-600 dark:hover:text-violet-400 group",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm group-hover:shadow-md transition-all",children:(0,s.jsx)(rs,{size:20})}),(0,s.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Crop / Edit"})]}),(0,s.jsxs)("button",{className:"flex flex-col items-center gap-1.5 p-3 rounded-xl opacity-40 cursor-not-allowed text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm",children:(0,s.jsx)("svg",{size:20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:(0,s.jsx)("path",{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 21 3 22l1-4.5L17 3z"})})}),(0,s.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Text"})]}),(0,s.jsxs)("button",{className:"flex flex-col items-center gap-1.5 p-3 rounded-xl opacity-40 cursor-not-allowed text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm",children:(0,s.jsxs)("svg",{size:20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[(0,s.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,s.jsx)("path",{d:"M8 14s1.5 2 4 2 4-2 4-2"}),(0,s.jsx)("line",{x1:"9",y1:"9",x2:"9.01",y2:"9"}),(0,s.jsx)("line",{x1:"15",y1:"9",x2:"15.01",y2:"9"})]})}),(0,s.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Stickers"})]})]})]}):(0,s.jsxs)("div",{className:"py-10",children:[(0,s.jsxs)("div",{className:"relative w-full group",onClick:()=>u.current?.click(),children:[(0,s.jsx)("div",{className:"relative z-40 cursor-pointer group-hover:translate-x-8 group-hover:shadow-2xl group-hover:-translate-y-8 transition-all duration-500 bg-zinc-900 dark:bg-white flex items-center justify-center h-32 w-32 mx-auto rounded-xl border-4 border-white dark:border-zinc-900",children:(0,s.jsxs)("svg",{className:"h-8 w-8 text-white/60 dark:text-zinc-950/60",strokeLinejoin:"round",strokeLinecap:"round",strokeWidth:"2",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2"}),(0,s.jsx)("path",{d:"M7 9l5 -5l5 5"}),(0,s.jsx)("path",{d:"M12 4l0 12"})]})}),(0,s.jsx)("div",{className:"absolute border-2 opacity-0 group-hover:opacity-80 transition-all duration-300 border-dashed border-violet-500 inset-0 z-30 bg-transparent flex items-center justify-center h-32 w-32 mx-auto rounded-xl"})]}),(0,s.jsxs)("div",{className:"text-center mt-8",children:[(0,s.jsx)("p",{className:"font-bold dark:text-white",children:"Choose a photo"}),(0,s.jsx)("p",{className:"text-sm text-zinc-500",children:"Stories last for 24 hours"})]})]}),(0,s.jsx)("input",{type:"file",ref:u,onChange:f,className:"hidden",accept:"image/*"}),(0,s.jsx)(pe,{className:"w-full py-3 text-lg",disabled:!r||o,onClick:h,children:o?(0,s.jsx)(re,{size:24,className:"animate-spin mx-auto"}):"Share story"})]}),d&&(0,s.jsx)(jt,{src:d,isOpen:!!d,onClose:()=>m(null),onCropComplete:p,aspect:9/16})]})},vr=gr,jr=W(),wr=t=>{const e=(0,jr.c)(21),{isPostModalOpen:a,setIsPostModalOpen:l,isEditProfileOpen:i,setIsEditProfileOpen:r,isStoryModalOpen:n,setIsStoryModalOpen:o,editProfileData:c,setEditProfileData:d}=t;let m;e[0]!==l?(m=()=>l(!1),e[0]=l,e[1]=m):m=e[1];let u;e[2]!==a||e[3]!==m?(u=(0,s.jsx)(xr,{isOpen:a,onClose:m}),e[2]=a,e[3]=m,e[4]=u):u=e[4];let f;e[5]!==r?(f=()=>r(!1),e[5]=r,e[6]=f):f=e[6];let x;e[7]!==c||e[8]!==i||e[9]!==d||e[10]!==f?(x=(0,s.jsx)(br,{isOpen:i,onClose:f,editProfileData:c,setEditProfileData:d}),e[7]=c,e[8]=i,e[9]=d,e[10]=f,e[11]=x):x=e[11];let p;e[12]!==o?(p=()=>o(!1),e[12]=o,e[13]=p):p=e[13];let h;e[14]!==n||e[15]!==p?(h=(0,s.jsx)(vr,{isOpen:n,onClose:p}),e[14]=n,e[15]=p,e[16]=h):h=e[16];let b;return e[17]!==u||e[18]!==x||e[19]!==h?(b=(0,s.jsxs)(s.Fragment,{children:[u,x,h]}),e[17]=u,e[18]=x,e[19]=h,e[20]=b):b=e[20],b},yr=wr,Nr=W(),zr=t=>{const e=(0,Nr.c)(77),{story:a,onClose:l}=t,[i,r]=(0,g.useState)(0),[n,o]=(0,g.useState)(0),c=a.stories,d=c[i];let m;e[0]!==i||e[1]!==l||e[2]!==c.length?(m=()=>{i<c.length-1?(r(_r),o(0)):l()},e[0]=i,e[1]=l,e[2]=c.length,e[3]=m):m=e[3];const u=m;let f;e[4]!==i?(f=()=>{i>0&&(r(Cr),o(0))},e[4]=i,e[5]=f):f=e[5];const x=f;let p;e[6]!==u?(p=()=>{const G=setInterval(()=>{o(te=>te>=100?(u(),100):te+1)},50);return()=>clearInterval(G)},e[6]=u,e[7]=p):p=e[7];let h;e[8]!==i||e[9]!==u?(h=[u,i],e[8]=i,e[9]=u,e[10]=h):h=e[10],(0,g.useEffect)(p,h);let b;if(e[11]!==i||e[12]!==n||e[13]!==c){let G;e[15]!==i||e[16]!==n?(G=(te,se)=>(0,s.jsx)("div",{className:"flex-1 h-full bg-white/30 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full bg-white transition-all duration-100",style:{width:se<i?"100%":se===i?`${n}%`:"0%"}})},se),e[15]=i,e[16]=n,e[17]=G):G=e[17],b=c.map(G),e[11]=i,e[12]=n,e[13]=c,e[14]=b}else b=e[14];let v;e[18]!==b?(v=(0,s.jsx)("div",{className:"flex gap-1.5 h-0.5 w-full bg-transparent",children:b}),e[18]=b,e[19]=v):v=e[19];let j;e[20]!==a.user.avatar||e[21]!==a.user.handle?(j=(0,s.jsx)(fe,{src:a.user.avatar,alt:a.user.handle,className:"object-cover"}),e[20]=a.user.avatar,e[21]=a.user.handle,e[22]=j):j=e[22];let k;e[23]!==a.user.handle?.[0]?(k=a.user.handle?.[0]?.toUpperCase(),e[23]=a.user.handle?.[0],e[24]=k):k=e[24];let N;e[25]!==k?(N=(0,s.jsx)(xe,{children:k}),e[25]=k,e[26]=N):N=e[26];let w;e[27]!==j||e[28]!==N?(w=(0,s.jsxs)(ue,{className:"size-10 border border-white/20 shadow-sm",children:[j,N]}),e[27]=j,e[28]=N,e[29]=w):w=e[29];let _;e[30]!==a.user.handle?(_=(0,s.jsx)("span",{className:"text-white text-sm font-bold shadow-black drop-shadow-md",children:a.user.handle}),e[30]=a.user.handle,e[31]=_):_=e[31];let S;e[32]!==d.created_at?(S=new Date(d.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),e[32]=d.created_at,e[33]=S):S=e[33];let z;e[34]!==S?(z=(0,s.jsx)("span",{className:"text-white/60 text-[10px] shadow-black drop-shadow-md",children:S}),e[34]=S,e[35]=z):z=e[35];let $;e[36]!==_||e[37]!==z?($=(0,s.jsxs)("div",{className:"flex flex-col",children:[_,z]}),e[36]=_,e[37]=z,e[38]=$):$=e[38];let P;e[39]!==w||e[40]!==$?(P=(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[w,$]}),e[39]=w,e[40]=$,e[41]=P):P=e[41];let F;e[42]===Symbol.for("react.memo_cache_sentinel")?(F=(0,s.jsx)(be,{size:24}),e[42]=F):F=e[42];let M;e[43]!==l?(M=(0,s.jsx)("button",{onClick:l,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors",children:F}),e[43]=l,e[44]=M):M=e[44];let L;e[45]!==P||e[46]!==M?(L=(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[P,M]}),e[45]=P,e[46]=M,e[47]=L):L=e[47];let R;e[48]!==L||e[49]!==v?(R=(0,s.jsxs)("div",{className:"absolute top-0 left-0 right-0 p-4 z-20 flex flex-col gap-4",children:[v,L]}),e[48]=L,e[49]=v,e[50]=R):R=e[50];let O;e[51]!==i||e[52]!==x?(O=i>0&&(0,s.jsx)("button",{onClick:G=>{G.stopPropagation(),x()},className:"absolute left-4 z-30 p-2 bg-black/20 hover:bg-black/40 rounded-full text-white backdrop-blur-md transition-all active:scale-90",children:(0,s.jsx)(ss,{size:32})}),e[51]=i,e[52]=x,e[53]=O):O=e[53];let q;e[54]!==d.id||e[55]!==d.media?(q=(0,s.jsx)("div",{className:"relative w-full h-full flex items-center justify-center",children:(0,s.jsx)("img",{src:d.media,className:"max-w-full max-h-full object-contain rounded-xl shadow-2xl animate-in fade-in zoom-in-95 duration-300",alt:""},d.id)}),e[54]=d.id,e[55]=d.media,e[56]=q):q=e[56];let I;e[57]!==u?(I=G=>{G.stopPropagation(),u()},e[57]=u,e[58]=I):I=e[58];let y;e[59]===Symbol.for("react.memo_cache_sentinel")?(y=(0,s.jsx)(es,{size:32}),e[59]=y):y=e[59];let C;e[60]!==I?(C=(0,s.jsx)("button",{onClick:I,className:"absolute right-4 z-30 p-2 bg-black/20 hover:bg-black/40 rounded-full text-white backdrop-blur-md transition-all active:scale-90",children:y}),e[60]=I,e[61]=C):C=e[61];let E;e[62]!==x?(E=(0,s.jsx)("div",{className:"flex-1 cursor-w-resize",onClick:x}),e[62]=x,e[63]=E):E=e[63];let D;e[64]!==u?(D=(0,s.jsx)("div",{className:"flex-1 cursor-e-resize",onClick:u}),e[64]=u,e[65]=D):D=e[65];let U;e[66]!==E||e[67]!==D?(U=(0,s.jsxs)("div",{className:"absolute inset-0 flex z-20",children:[E,D]}),e[66]=E,e[67]=D,e[68]=U):U=e[68];let B;e[69]!==O||e[70]!==q||e[71]!==C||e[72]!==U?(B=(0,s.jsxs)("div",{className:"w-full h-full max-w-xl relative flex items-center justify-center p-2",children:[O,q,C,U]}),e[69]=O,e[70]=q,e[71]=C,e[72]=U,e[73]=B):B=e[73];let Y;return e[74]!==R||e[75]!==B?(Y=(0,s.jsxs)("div",{className:"fixed inset-0 z-[100] bg-black flex flex-col items-center justify-center animate-in fade-in duration-300",children:[R,B]}),e[74]=R,e[75]=B,e[76]=Y):Y=e[76],Y},kr=zr;function _r(t){return t+1}function Cr(t){return t-1}var Sr=W(),$r=t=>{const e=(0,Sr.c)(48),{images:a,currentIndex:l,onClose:i,onNavigate:r}=t,n=l===void 0?0:l;if(!a||a.length===0)return null;const o=a[n],c=a.length>1;let d;e[0]!==n||e[1]!==r?(d=L=>{L.stopPropagation(),r&&n>0&&r(n-1)},e[0]=n,e[1]=r,e[2]=d):d=e[2];const m=d;let u;e[3]!==n||e[4]!==a.length||e[5]!==r?(u=L=>{L.stopPropagation(),r&&n<a.length-1&&r(n+1)},e[3]=n,e[4]=a.length,e[5]=r,e[6]=u):u=e[6];const f=u;let x;e[7]!==o?(x=L=>{L.stopPropagation();const R=document.createElement("a");R.href=o,R.download=`image-${Date.now()}.jpg`,document.body.appendChild(R),R.click(),document.body.removeChild(R)},e[7]=o,e[8]=x):x=e[8];const p=x,h=c?`${n+1} / ${a.length}`:"";let b;e[9]!==h?(b=(0,s.jsx)("div",{className:"text-white font-medium",children:h}),e[9]=h,e[10]=b):b=e[10];let v;e[11]===Symbol.for("react.memo_cache_sentinel")?(v=(0,s.jsx)(Kt,{size:22}),e[11]=v):v=e[11];let j;e[12]!==p?(j=(0,s.jsx)("button",{onClick:p,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors",title:"Download",children:v}),e[12]=p,e[13]=j):j=e[13];let k;e[14]===Symbol.for("react.memo_cache_sentinel")?(k=(0,s.jsx)(be,{size:24}),e[14]=k):k=e[14];let N;e[15]!==i?(N=(0,s.jsx)("button",{onClick:i,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors",title:"Close",children:k}),e[15]=i,e[16]=N):N=e[16];let w;e[17]!==N||e[18]!==j?(w=(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[j,N]}),e[17]=N,e[18]=j,e[19]=w):w=e[19];let _;e[20]!==w||e[21]!==b?(_=(0,s.jsxs)("div",{className:"absolute top-0 left-0 right-0 p-4 z-20 flex items-center justify-between bg-gradient-to-b from-black/50 to-transparent",children:[b,w]}),e[20]=w,e[21]=b,e[22]=_):_=e[22];let S;e[23]!==n||e[24]!==m||e[25]!==c?(S=c&&n>0&&(0,s.jsx)("button",{onClick:m,className:"absolute left-4 z-10 p-3 bg-white/10 hover:bg-white/20 rounded-full text-white backdrop-blur-md transition-all active:scale-90",children:(0,s.jsx)(ss,{size:32})}),e[23]=n,e[24]=m,e[25]=c,e[26]=S):S=e[26];let z;e[27]!==o?(z=(0,s.jsx)("img",{src:o,className:"max-w-full max-h-full object-contain select-none shadow-2xl animate-in zoom-in-95 duration-300",alt:"",onClick:Fr}),e[27]=o,e[28]=z):z=e[28];let $;e[29]!==n||e[30]!==f||e[31]!==c||e[32]!==a.length?($=c&&n<a.length-1&&(0,s.jsx)("button",{onClick:f,className:"absolute right-4 z-10 p-3 bg-white/10 hover:bg-white/20 rounded-full text-white backdrop-blur-md transition-all active:scale-90",children:(0,s.jsx)(es,{size:32})}),e[29]=n,e[30]=f,e[31]=c,e[32]=a.length,e[33]=$):$=e[33];let P;e[34]!==S||e[35]!==z||e[36]!==$?(P=(0,s.jsxs)("div",{className:"w-full h-full relative flex items-center justify-center p-4",children:[S,z,$]}),e[34]=S,e[35]=z,e[36]=$,e[37]=P):P=e[37];let F;e[38]!==n||e[39]!==c||e[40]!==a||e[41]!==r?(F=c&&(0,s.jsx)("div",{className:"absolute bottom-6 flex gap-2 p-2 bg-black/40 backdrop-blur-md rounded-2xl overflow-x-auto max-w-[90%] hide-scrollbar",onClick:Mr,children:a.map((L,R)=>(0,s.jsx)("button",{onClick:()=>r(R),className:`size-12 rounded-lg overflow-hidden border-2 transition-all shrink-0 ${R===n?"border-white scale-110":"border-transparent opacity-50 hover:opacity-100"}`,children:(0,s.jsx)("img",{src:L,className:"size-full object-cover",alt:""})},R))}),e[38]=n,e[39]=c,e[40]=a,e[41]=r,e[42]=F):F=e[42];let M;return e[43]!==i||e[44]!==_||e[45]!==P||e[46]!==F?(M=(0,s.jsxs)("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-sm flex flex-col items-center justify-center animate-in fade-in duration-300",onClick:i,children:[_,P,F]}),e[43]=i,e[44]=_,e[45]=P,e[46]=F,e[47]=M):M=e[47],M},Pr=$r;function Fr(t){return t.stopPropagation()}function Mr(t){return t.stopPropagation()}var Lr=({type:t,onComplete:e,onSwitch:a})=>{const{login:l,signup:i}=he(),{addToast:r}=_e(),[n,o]=(0,g.useState)({name:"",email:"",username:"",password:""}),[c,d]=(0,g.useState)(!1),[m,u]=(0,g.useState)(null),f=async x=>{x.preventDefault(),d(!0),u(null);try{t==="login"?(await l({email:n.email,password:n.password}),r("Welcome back!")):(await i({email:n.email,password:n.password,username:n.username,name:n.name}),r("Account created successfully!")),e()}catch(p){console.error("Auth error:",p),u(p.message||"Authentication failed. Please check your credentials."),r("Authentication failed!")}finally{d(!1)}};return(0,s.jsxs)("div",{className:"max-w-md mx-auto p-8 w-full animate-in fade-in slide-in-from-bottom-5 duration-300",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("div",{className:"flex justify-center mb-4",children:(0,s.jsx)("div",{className:"bg-black dark:bg-white dark:text-black text-white p-3 rounded-2xl shadow-lg",children:(0,s.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",alt:"Logo",className:"w-10 h-10 rounded-xl"})})}),(0,s.jsx)("h2",{className:"text-3xl font-extrabold mb-2 dark:text-white tracking-tight",children:t==="login"?"Welcome back!":"Join Sysm today"}),(0,s.jsx)("p",{className:"text-zinc-500 font-medium",children:"The decentralized social network"})]}),m&&(0,s.jsxs)("div",{className:"mb-6 p-4 bg-rose-50 dark:bg-rose-900/20 border border-rose-100 dark:border-rose-800 rounded-xl flex items-center gap-3 text-rose-600 dark:text-rose-400 text-sm",children:[(0,s.jsx)(Ut,{size:18}),(0,s.jsx)("span",{children:m})]}),(0,s.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,s.jsx)(Se,{label:"Email",type:"email",placeholder:"john@example.com",value:n.email,onChange:x=>o({...n,email:x.target.value}),required:!0}),t==="signup"&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Se,{label:"Name",placeholder:"John Doe",value:n.name,onChange:x=>o({...n,name:x.target.value}),required:!0}),(0,s.jsx)(Se,{label:"Username",placeholder:"johndoe",value:n.username,onChange:x=>o({...n,username:x.target.value}),required:!0})]}),(0,s.jsx)(Se,{label:"Password",type:"password",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",value:n.password,onChange:x=>o({...n,password:x.target.value}),required:!0}),(0,s.jsx)(pe,{type:"submit",className:"w-full justify-center py-3 mt-6 text-lg",disabled:c,children:c?(0,s.jsx)(re,{size:24,className:"animate-spin"}):t==="login"?"Log in":"Sign up"})]}),(0,s.jsxs)("div",{className:"mt-8 text-center text-sm",children:[(0,s.jsx)("span",{className:"text-zinc-500",children:t==="login"?"Don't have an account?":"Already have an account?"}),(0,s.jsx)("button",{onClick:a,className:"font-bold ml-1 hover:underline dark:text-white",children:t==="login"?"Sign up":"Log in"})]})]})},Rr=Lr,Ir=W(),Er=t=>{const e=(0,Ir.c)(2),{children:a}=t;let l;return e[0]!==a?(l=(0,s.jsx)("div",{className:"w-full animate-in fade-in slide-in-from-bottom-2 duration-300 ease-out",children:a}),e[0]=a,e[1]=l):l=e[1],l},Ne=Er,Tr=W(),qr=t=>{const e=(0,Tr.c)(24),{user:a,onClick:l,isAddStory:i}=t,r=i===void 0?!1:i,n=`relative p-0.5 rounded-full ${r?"bg-transparent":"bg-gradient-to-tr from-yellow-400 via-pink-500 to-violet-600"}`;let o;e[0]!==a.avatar||e[1]!==a.handle?(o=(0,s.jsx)(fe,{src:a.avatar,alt:a.handle,className:"object-cover"}),e[0]=a.avatar,e[1]=a.handle,e[2]=o):o=e[2];let c;e[3]!==a.handle?.[0]?(c=a.handle?.[0]?.toUpperCase(),e[3]=a.handle?.[0],e[4]=c):c=e[4];let d;e[5]!==c?(d=(0,s.jsx)(xe,{children:c}),e[5]=c,e[6]=d):d=e[6];let m;e[7]!==o||e[8]!==d?(m=(0,s.jsxs)(ue,{className:"size-14 sm:size-16 border border-zinc-100 dark:border-zinc-800",children:[o,d]}),e[7]=o,e[8]=d,e[9]=m):m=e[9];let u;e[10]!==r?(u=r&&(0,s.jsx)("div",{className:"absolute bottom-0 right-0 bg-violet-600 border-2 border-white dark:border-black rounded-full p-1 text-white shadow-lg",children:(0,s.jsx)(Re,{size:14,strokeWidth:3})}),e[10]=r,e[11]=u):u=e[11];let f;e[12]!==m||e[13]!==u?(f=(0,s.jsx)("div",{className:"bg-white dark:bg-black rounded-full p-0.5",children:(0,s.jsxs)("div",{className:"relative",children:[m,u]})}),e[12]=m,e[13]=u,e[14]=f):f=e[14];let x;e[15]!==n||e[16]!==f?(x=(0,s.jsx)("div",{className:n,children:f}),e[15]=n,e[16]=f,e[17]=x):x=e[17];const p=r?"Add Story":a.handle;let h;e[18]!==p?(h=(0,s.jsx)("span",{className:"text-[11px] font-semibold text-zinc-600 dark:text-zinc-400 truncate w-16 text-center leading-tight",children:p}),e[18]=p,e[19]=h):h=e[19];let b;return e[20]!==l||e[21]!==h||e[22]!==x?(b=(0,s.jsxs)("button",{onClick:l,className:"flex flex-col items-center gap-2 group shrink-0",children:[x,h]}),e[20]=l,e[21]=h,e[22]=x,e[23]=b):b=e[23],b},Pt=qr,He=W();function Ar(t){const e=(0,He.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let l;return e[2]!==a?(l=(0,s.jsx)(xa,{"data-slot":"dropdown-menu",...a}),e[2]=a,e[3]=l):l=e[3],l}function Or(t){const e=(0,He.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let l;return e[2]!==a?(l=(0,s.jsx)(aa,{"data-slot":"dropdown-menu-trigger",...a}),e[2]=a,e[3]=l):l=e[3],l}function Dr(t){const e=(0,He.c)(10);let a,l,i;e[0]!==t?({className:a,sideOffset:i,...l}=t,e[0]=t,e[1]=a,e[2]=l,e[3]=i):(a=e[1],l=e[2],i=e[3]);const r=i===void 0?4:i;let n;e[4]!==a?(n=X("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",a),e[4]=a,e[5]=n):n=e[5];let o;return e[6]!==l||e[7]!==r||e[8]!==n?(o=(0,s.jsx)(ma,{children:(0,s.jsx)(Ha,{"data-slot":"dropdown-menu-content",sideOffset:r,className:n,...l})}),e[6]=l,e[7]=r,e[8]=n,e[9]=o):o=e[9],o}function Oe(t){const e=(0,He.c)(12);let a,l,i,r;e[0]!==t?({className:a,inset:l,variant:r,...i}=t,e[0]=t,e[1]=a,e[2]=l,e[3]=i,e[4]=r):(a=e[1],l=e[2],i=e[3],r=e[4]);const n=r===void 0?"default":r;let o;e[5]!==a?(o=X("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),e[5]=a,e[6]=o):o=e[6];let c;return e[7]!==l||e[8]!==i||e[9]!==o||e[10]!==n?(c=(0,s.jsx)(da,{"data-slot":"dropdown-menu-item","data-inset":l,"data-variant":n,className:o,...i}),e[7]=l,e[8]=i,e[9]=o,e[10]=n,e[11]=c):c=e[11],c}function Br(t){const e=(0,He.c)(8);let a,l;e[0]!==t?({className:a,...l}=t,e[0]=t,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let i;e[3]!==a?(i=X("bg-border -mx-1 my-1 h-px",a),e[3]=a,e[4]=i):i=e[4];let r;return e[5]!==l||e[6]!==i?(r=(0,s.jsx)(Zs,{"data-slot":"dropdown-menu-separator",className:i,...l}),e[5]=l,e[6]=i,e[7]=r):r=e[7],r}var ye=W();function Ft(t){const e=(0,ye.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let l;return e[2]!==a?(l=(0,s.jsx)(Ua,{"data-slot":"alert-dialog",...a}),e[2]=a,e[3]=l):l=e[3],l}function Wr(t){const e=(0,ye.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let l;return e[2]!==a?(l=(0,s.jsx)(fa,{"data-slot":"alert-dialog-portal",...a}),e[2]=a,e[3]=l):l=e[3],l}function Hr(t){const e=(0,ye.c)(8);let a,l;e[0]!==t?({className:a,...l}=t,e[0]=t,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let i;e[3]!==a?(i=X("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),e[3]=a,e[4]=i):i=e[4];let r;return e[5]!==l||e[6]!==i?(r=(0,s.jsx)(Us,{"data-slot":"alert-dialog-overlay",className:i,...l}),e[5]=l,e[6]=i,e[7]=r):r=e[7],r}function Mt(t){const e=(0,ye.c)(9);let a,l;e[0]!==t?({className:a,...l}=t,e[0]=t,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let i;e[3]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsx)(Hr,{}),e[3]=i):i=e[3];let r;e[4]!==a?(r=X("bg-white dark:bg-zinc-950 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-2xl border border-zinc-100 dark:border-zinc-800 p-6 shadow-xl duration-200 sm:max-w-md",a),e[4]=a,e[5]=r):r=e[5];let n;return e[6]!==l||e[7]!==r?(n=(0,s.jsxs)(Wr,{children:[i,(0,s.jsx)(va,{"data-slot":"alert-dialog-content",className:r,...l})]}),e[6]=l,e[7]=r,e[8]=n):n=e[8],n}function Lt(t){const e=(0,ye.c)(8);let a,l;e[0]!==t?({className:a,...l}=t,e[0]=t,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let i;e[3]!==a?(i=X("flex flex-col gap-2 text-center sm:text-left",a),e[3]=a,e[4]=i):i=e[4];let r;return e[5]!==l||e[6]!==i?(r=(0,s.jsx)("div",{"data-slot":"alert-dialog-header",className:i,...l}),e[5]=l,e[6]=i,e[7]=r):r=e[7],r}function Rt(t){const e=(0,ye.c)(8);let a,l;e[0]!==t?({className:a,...l}=t,e[0]=t,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let i;e[3]!==a?(i=X("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),e[3]=a,e[4]=i):i=e[4];let r;return e[5]!==l||e[6]!==i?(r=(0,s.jsx)("div",{"data-slot":"alert-dialog-footer",className:i,...l}),e[5]=l,e[6]=i,e[7]=r):r=e[7],r}function It(t){const e=(0,ye.c)(8);let a,l;e[0]!==t?({className:a,...l}=t,e[0]=t,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let i;e[3]!==a?(i=X("text-lg font-semibold",a),e[3]=a,e[4]=i):i=e[4];let r;return e[5]!==l||e[6]!==i?(r=(0,s.jsx)(Hs,{"data-slot":"alert-dialog-title",className:i,...l}),e[5]=l,e[6]=i,e[7]=r):r=e[7],r}function Et(t){const e=(0,ye.c)(8);let a,l;e[0]!==t?({className:a,...l}=t,e[0]=t,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let i;e[3]!==a?(i=X("text-muted-foreground text-sm",a),e[3]=a,e[4]=i):i=e[4];let r;return e[5]!==l||e[6]!==i?(r=(0,s.jsx)(Js,{"data-slot":"alert-dialog-description",className:i,...l}),e[5]=l,e[6]=i,e[7]=r):r=e[7],r}function Tt(t){const e=(0,ye.c)(8);let a,l;e[0]!==t?({className:a,...l}=t,e[0]=t,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let i;e[3]!==a?(i=X("inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-bold transition-all active:scale-95 bg-zinc-900 text-white hover:bg-zinc-800 dark:bg-white dark:text-black dark:hover:bg-zinc-200",a),e[3]=a,e[4]=i):i=e[4];let r;return e[5]!==l||e[6]!==i?(r=(0,s.jsx)(Vs,{className:i,...l}),e[5]=l,e[6]=i,e[7]=r):r=e[7],r}function qt(t){const e=(0,ye.c)(8);let a,l;e[0]!==t?({className:a,...l}=t,e[0]=t,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let i;e[3]!==a?(i=X("inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-bold border border-zinc-200 bg-white text-zinc-900 hover:bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-950 dark:text-zinc-50 dark:hover:bg-zinc-900",a),e[3]=a,e[4]=i):i=e[4];let r;return e[5]!==l||e[6]!==i?(r=(0,s.jsx)(fl,{className:i,...l}),e[5]=l,e[6]=i,e[7]=r):r=e[7],r}var Qr=W();function Vr(t){const e=(0,Qr.c)(8);let a,l;e[0]!==t?({className:a,...l}=t,e[0]=t,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let i;e[3]!==a?(i=X("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),e[3]=a,e[4]=i):i=e[4];let r;return e[5]!==l||e[6]!==i?(r=(0,s.jsx)("textarea",{"data-slot":"textarea",className:i,...l}),e[5]=l,e[6]=i,e[7]=r):r=e[7],r}var Ur=W(),Kr=()=>{const t=(0,Ur.c)(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,s.jsx)(_a,{size:16,className:"fill-blue-500 text-white ml-1 inline-block shrink-0"}),t[0]=e):e=t[0],e},Je=Kr,Jr=W(),Gr=t=>{const e=(0,Jr.c)(18),{poll:a,onVote:l}=t,i=a.options.reduce(Xr,0),[r,n]=(0,g.useState)(null);let o;e[0]!==l||e[1]!==r?(o=p=>{r||(n(p),l&&l(p))},e[0]=l,e[1]=r,e[2]=o):o=e[2];const c=o;let d;if(e[3]!==c||e[4]!==a.options||e[5]!==i||e[6]!==r){let p;e[8]!==c||e[9]!==i||e[10]!==r?(p=(h,b)=>{const v=i>0?Math.round((h.votes+(r===h.id?1:0))/(i+(r?1:0))*100):0,j=r===h.id;return(0,s.jsxs)("div",{onClick:k=>{k.stopPropagation(),c(h.id)},className:`relative h-10 w-full rounded-xl overflow-hidden cursor-pointer border ${j?"border-violet-500 dark:border-violet-500":"border-zinc-200 dark:border-zinc-700"}`,children:[r&&(0,s.jsx)("div",{className:"absolute top-0 left-0 h-full bg-zinc-200 dark:bg-zinc-800 transition-all duration-500",style:{width:`${v}%`}}),(0,s.jsxs)("div",{className:"absolute inset-0 flex items-center justify-between px-4 z-10",children:[(0,s.jsxs)("span",{className:`font-medium text-sm ${j?"text-violet-600 font-bold":"text-zinc-700 dark:text-zinc-200"}`,children:[h.text," ",j&&(0,s.jsx)(ts,{size:14,className:"inline ml-1 mb-0.5"})]}),r&&(0,s.jsxs)("span",{className:"text-sm font-bold text-zinc-900 dark:text-white",children:[v,"%"]})]})]},h.id||b)},e[8]=c,e[9]=i,e[10]=r,e[11]=p):p=e[11],d=a.options.map(p),e[3]=c,e[4]=a.options,e[5]=i,e[6]=r,e[7]=d}else d=e[7];const m=i+(r?1:0),u=r?"6 days left":"Click to vote";let f;e[12]!==m||e[13]!==u?(f=(0,s.jsxs)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400 pl-1",children:[m," votes â€¢"," ",u]}),e[12]=m,e[13]=u,e[14]=f):f=e[14];let x;return e[15]!==d||e[16]!==f?(x=(0,s.jsxs)("div",{className:"mt-3 space-y-2",children:[d,f]}),e[15]=d,e[16]=f,e[17]=x):x=e[17],x},At=Gr;function Xr(t,e){return t+e.votes}var Zr=W(),Yr=t=>{const e=(0,Zr.c)(23),{user:a,time:l,content:i}=t;let r;e[0]!==a.avatar||e[1]!==a.handle?(r=(0,s.jsx)(fe,{src:a.avatar,alt:a.handle}),e[0]=a.avatar,e[1]=a.handle,e[2]=r):r=e[2];let n;e[3]!==a.handle[0]?(n=a.handle[0]?.toUpperCase(),e[3]=a.handle[0],e[4]=n):n=e[4];let o;e[5]!==n?(o=(0,s.jsx)(xe,{children:n}),e[5]=n,e[6]=o):o=e[6];let c;e[7]!==r||e[8]!==o?(c=(0,s.jsxs)(ue,{className:"size-6",children:[r,o]}),e[7]=r,e[8]=o,e[9]=c):c=e[9];let d;e[10]!==a.handle?(d=(0,s.jsx)("span",{className:"font-semibold text-sm",children:a.handle}),e[10]=a.handle,e[11]=d):d=e[11];let m;e[12]!==l?(m=(0,s.jsxs)("span",{className:"text-zinc-500 text-sm",children:["â€¢ ",l]}),e[12]=l,e[13]=m):m=e[13];let u;e[14]!==c||e[15]!==d||e[16]!==m?(u=(0,s.jsxs)("div",{className:"flex items-center gap-x-2 mb-2",children:[c,d,m]}),e[14]=c,e[15]=d,e[16]=m,e[17]=u):u=e[17];let f;e[18]!==i?(f=(0,s.jsx)("p",{className:"text-sm text-zinc-800 dark:text-zinc-300 whitespace-pre-line",children:i}),e[18]=i,e[19]=f):f=e[19];let x;return e[20]!==u||e[21]!==f?(x=(0,s.jsxs)("div",{className:"p-4",children:[u,f]}),e[20]=u,e[21]=f,e[22]=x):x=e[22],x},Ot=Yr,en=W(),tn=t=>{const e=(0,en.c)(17),{icon:a,count:l,onClick:i,active:r,activeColorClass:n}=t,o=n===void 0?"text-violet-600":n,c=a;let d;e[0]!==i?(d=j=>{j.stopPropagation(),i&&i(j)},e[0]=i,e[1]=d):d=e[1];const m=`group flex items-center gap-x-2 text-[13px] font-medium transition-all ${r?o:"text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-300"}`,u=`rounded-full p-2 transition-colors ${r?"":"group-hover:bg-zinc-100 dark:group-hover:bg-zinc-800"}`,f=r?2.5:2,x=r?"fill-current":"";let p;e[2]!==c||e[3]!==f||e[4]!==x?(p=(0,s.jsx)(c,{size:18,strokeWidth:f,className:x}),e[2]=c,e[3]=f,e[4]=x,e[5]=p):p=e[5];let h;e[6]!==u||e[7]!==p?(h=(0,s.jsx)("div",{className:u,children:p}),e[6]=u,e[7]=p,e[8]=h):h=e[8];let b;e[9]!==r||e[10]!==l?(b=l!=null&&(0,s.jsx)("span",{className:r?"font-bold":"",children:l||0}),e[9]=r,e[10]=l,e[11]=b):b=e[11];let v;return e[12]!==d||e[13]!==m||e[14]!==h||e[15]!==b?(v=(0,s.jsxs)("button",{onClick:d,className:m,children:[h,b]}),e[12]=d,e[13]=m,e[14]=h,e[15]=b,e[16]=v):v=e[16],v},Ie=tn,sn=W(),an=t=>{const e=(0,sn.c)(12),{src:a,poster:l}=t,i=(0,g.useRef)(null);let r,n;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=()=>{const x=new IntersectionObserver(h=>{const[b]=h;i.current?.plyr&&(b.isIntersecting?i.current.plyr.play().catch(()=>{i.current.plyr.muted=!0,i.current.plyr.play()}):i.current.plyr.pause())},{threshold:.6}),p=i.current?.elements?.container;return p&&x.observe(p),()=>{p&&x.unobserve(p)}},n=[],e[0]=r,e[1]=n):(r=e[0],n=e[1]),(0,g.useEffect)(r,n);let o;e[2]!==a?(o=[{src:a,type:"video/mp4"}],e[2]=a,e[3]=o):o=e[3];let c;e[4]!==l||e[5]!==o?(c={type:"video",sources:o,poster:l},e[4]=l,e[5]=o,e[6]=c):c=e[6];let d;e[7]===Symbol.for("react.memo_cache_sentinel")?(d={controls:["play-large","play","progress","current-time","mute","volume","fullscreen"],settings:["quality","speed"],ratio:"16:9",clickToPlay:!0,hideControls:!0,resetOnEnd:!0},e[7]=d):d=e[7];let m;e[8]!==c?(m={source:c,options:d},e[8]=c,e[9]=m):m=e[9];const u=m;let f;return e[10]!==u?(f=(0,s.jsx)("div",{className:"mt-3 overflow-hidden rounded-2xl shadow-sm border border-zinc-100 dark:border-zinc-800 bg-black",onClick:rn,children:(0,s.jsx)(Xt,{ref:i,...u})}),e[10]=u,e[11]=f):f=e[11],f},ln=an;function rn(t){return t.stopPropagation()}var nn=W(),on=t=>{const e=(0,nn.c)(17),{file:a}=t;let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=(0,s.jsx)("div",{className:"size-10 rounded-xl bg-violet-100 dark:bg-violet-900/30 flex items-center justify-center text-violet-600",children:(0,s.jsx)(Gt,{size:20})}),e[0]=l):l=e[0];let i;e[1]!==a.name?(i=(0,s.jsx)("div",{className:"text-sm font-bold truncate dark:text-white",children:a.name}),e[1]=a.name,e[2]=i):i=e[2];const r=a.size/1024/1024;let n;e[3]!==r?(n=r.toFixed(2),e[3]=r,e[4]=n):n=e[4];let o;e[5]!==n?(o=(0,s.jsxs)("div",{className:"text-xs text-zinc-500 uppercase",children:[n," MB"]}),e[5]=n,e[6]=o):o=e[6];let c;e[7]!==i||e[8]!==o?(c=(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[i,o]}),e[7]=i,e[8]=o,e[9]=c):c=e[9];let d;e[10]===Symbol.for("react.memo_cache_sentinel")?(d=(0,s.jsx)(Kt,{size:18}),e[10]=d):d=e[10];let m;e[11]!==a.name||e[12]!==a.url?(m=(0,s.jsx)("a",{href:a.url,download:a.name,className:"p-2 text-zinc-400 hover:text-violet-600 transition-colors",onClick:dn,children:d}),e[11]=a.name,e[12]=a.url,e[13]=m):m=e[13];let u;return e[14]!==c||e[15]!==m?(u=(0,s.jsxs)("div",{className:"mt-3 flex items-center gap-3 p-3 rounded-2xl border border-zinc-100 dark:border-zinc-800 bg-zinc-50/50 dark:bg-zinc-900/10 group hover:border-violet-500/30 transition-colors",children:[l,c,m]}),e[14]=c,e[15]=m,e[16]=u):u=e[16],u},cn=on;function dn(t){return t.stopPropagation()}var mn=W(),un=t=>{const e=(0,mn.c)(3),{items:a}=t,l=a===void 0?[]:a,{openLightbox:i}=bt();if(!l||l.length===0)return null;const r=Array.isArray(l)?l:[l],n=r.filter(xn),o=r.filter(hn),c=x=>{const p=n.filter(pn).map(bn),h=n[x];i(p,p.indexOf(h.url||h.src))},d="mt-3 space-y-2",m=n.length>0&&(0,s.jsx)("div",{className:`grid gap-2 rounded-2xl overflow-hidden border border-zinc-100 dark:border-zinc-800 ${n.length===1?"grid-cols-1":n.length===2?"grid-cols-2 aspect-[16/9]":(n.length===3,"grid-cols-2 grid-rows-2 aspect-[16/9]")}`,children:n.map((x,p)=>(0,s.jsx)("div",{className:`relative overflow-hidden bg-zinc-100 dark:bg-zinc-900 cursor-pointer ${n.length===3&&p===0?"row-span-2":""}`,onClick:h=>{x.type==="image"&&(h.stopPropagation(),c(p))},children:x.type==="video"?(0,s.jsx)(ln,{src:x.url,poster:x.poster}):(0,s.jsx)("img",{src:x.url||x.src,className:"size-full object-cover hover:scale-[1.02] transition-transform duration-500",alt:"",loading:"lazy"})},p))}),u=o.map(gn);let f;return e[0]!==m||e[1]!==u?(f=(0,s.jsxs)("div",{className:d,children:[m,u]}),e[0]=m,e[1]=u,e[2]=f):f=e[2],f},fn=un;function xn(t){return t.type==="image"||t.type==="video"}function hn(t){return t.type==="file"}function pn(t){return t.type==="image"}function bn(t){return t.url||t.src}function gn(t,e){return(0,s.jsx)(cn,{file:t},e)}var vn=W(),jn=t=>{const e=(0,vn.c)(51),{currentUser:a,newComment:l,setNewComment:i,handleSubmitComment:r,loading:n,selectedFiles:o,setSelectedFiles:c,isUploading:d}=t;let m;e[0]!==o?(m=o===void 0?[]:o,e[0]=o,e[1]=m):m=e[1];const u=m,f=(0,g.useRef)(null);let x;e[2]!==c?(x=I=>{const y=Array.from(I.target.files);c&&c(C=>[...C,...y])},e[2]=c,e[3]=x):x=e[3];const p=x;let h;e[4]!==c?(h=I=>{c&&c(y=>y.filter((C,E)=>E!==I))},e[4]=c,e[5]=h):h=e[5];const b=h;if(!a){let I;return e[6]===Symbol.for("react.memo_cache_sentinel")?(I=(0,s.jsx)("div",{className:"p-6 text-center border-y border-zinc-100 dark:border-zinc-800 bg-zinc-50/30 dark:bg-zinc-900/10",children:(0,s.jsx)("p",{className:"text-zinc-500 text-sm",children:"Please login to join the conversation."})}),e[6]=I):I=e[6],I}let v;e[7]!==a.avatar||e[8]!==a.handle?(v=(0,s.jsx)(fe,{src:a.avatar,alt:a.handle,className:"object-cover"}),e[7]=a.avatar,e[8]=a.handle,e[9]=v):v=e[9];let j;e[10]!==a.handle?.[0]?(j=a.handle?.[0]?.toUpperCase(),e[10]=a.handle?.[0],e[11]=j):j=e[11];let k;e[12]!==j?(k=(0,s.jsx)(xe,{children:j}),e[12]=j,e[13]=k):k=e[13];let N;e[14]!==v||e[15]!==k?(N=(0,s.jsxs)(ue,{className:"size-9 border border-zinc-200 dark:border-zinc-700",children:[v,k]}),e[14]=v,e[15]=k,e[16]=N):N=e[16];let w;e[17]!==i?(w=I=>i(I.target.value),e[17]=i,e[18]=w):w=e[18];let _;e[19]!==l||e[20]!==w?(_=(0,s.jsx)("textarea",{id:"comment-input",className:"w-full bg-transparent outline-none text-base min-h-[60px] resize-none dark:text-white placeholder:text-zinc-500",placeholder:"Post your reply...",value:l,onChange:w}),e[19]=l,e[20]=w,e[21]=_):_=e[21];let S;e[22]!==b||e[23]!==u?(S=u.length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mt-2 mb-2",children:u.map((I,y)=>(0,s.jsxs)("div",{className:"relative size-20 rounded-xl overflow-hidden border border-zinc-200 dark:border-zinc-800",children:[I.type.startsWith("image/")?(0,s.jsx)("img",{src:URL.createObjectURL(I),className:"size-full object-cover",alt:""}):(0,s.jsx)("div",{className:"size-full flex items-center justify-center bg-zinc-100 dark:bg-zinc-800",children:(0,s.jsx)(is,{size:20,className:"text-zinc-500"})}),(0,s.jsx)("button",{onClick:()=>b(y),className:"absolute top-1 right-1 bg-black/60 text-white rounded-full p-1 hover:bg-black transition-colors",children:(0,s.jsx)(be,{size:12})})]},y))}),e[22]=b,e[23]=u,e[24]=S):S=e[24];let z;e[25]===Symbol.for("react.memo_cache_sentinel")?(z=()=>f.current?.click(),e[25]=z):z=e[25];let $;e[26]===Symbol.for("react.memo_cache_sentinel")?($=(0,s.jsx)("button",{type:"button",onClick:z,className:"text-violet-600 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full p-2 transition-colors",title:"Attach media",children:(0,s.jsx)(Jt,{size:20})}),e[26]=$):$=e[26];let P;e[27]!==p?(P=(0,s.jsxs)("div",{className:"flex text-violet-600 gap-1",children:[$,(0,s.jsx)("input",{type:"file",ref:f,onChange:p,multiple:!0,className:"hidden",accept:"image/*,video/*,application/pdf"})]}),e[27]=p,e[28]=P):P=e[28];let F;e[29]!==d||e[30]!==n||e[31]!==l||e[32]!==u.length?(F=!l.trim()&&u.length===0||n||d,e[29]=d,e[30]=n,e[31]=l,e[32]=u.length,e[33]=F):F=e[33];let M;e[34]!==d||e[35]!==n?(M=n||d?(0,s.jsx)(re,{size:16,className:"animate-spin text-white mx-auto"}):"Reply",e[34]=d,e[35]=n,e[36]=M):M=e[36];let L;e[37]!==r||e[38]!==F||e[39]!==M?(L=(0,s.jsx)(pe,{className:"!w-auto px-5 py-1.5 text-sm font-bold min-w-[70px]",onClick:r,disabled:F,children:M}),e[37]=r,e[38]=F,e[39]=M,e[40]=L):L=e[40];let R;e[41]!==P||e[42]!==L?(R=(0,s.jsxs)("div",{className:"flex justify-between items-center mt-2 pt-3 border-t border-zinc-100 dark:border-zinc-800",children:[P,L]}),e[41]=P,e[42]=L,e[43]=R):R=e[43];let O;e[44]!==_||e[45]!==S||e[46]!==R?(O=(0,s.jsxs)("div",{className:"flex-1",children:[_,S,R]}),e[44]=_,e[45]=S,e[46]=R,e[47]=O):O=e[47];let q;return e[48]!==O||e[49]!==N?(q=(0,s.jsx)("div",{className:"p-4 border-y border-zinc-100 dark:border-zinc-800 bg-zinc-50/30 dark:bg-zinc-900/10",children:(0,s.jsxs)("div",{className:"flex gap-3",children:[N,O]})}),e[48]=O,e[49]=N,e[50]=q):q=e[50],q},wn=jn;const yn=(t,e,a,l)=>{const[i,r]=(0,g.useState)(!1),[n,o]=(0,g.useState)(!1),[c,d]=(0,g.useState)(e||{comments:0,likes:0,mirrors:0});return(0,g.useEffect)(()=>{a&&t&&je(t)&&je(a.id)&&(Ul(t,a.id).then(r).catch(()=>r(!1)),Jl(t,a.id).then(o).catch(()=>o(!1)))},[t,a]),{liked:i,reposted:n,localStats:c,setLocalStats:d,handleLike:async f=>{if(f&&f.stopPropagation(),!a)return l("Please login to like!","error");if(!je(t)||!je(a.id)){const x=!i;r(x),d(p=>({...p,likes:x?(p.likes||0)+1:(p.likes||0)-1}));return}try{const x=await Vl(t,a.id);r(x),d(p=>({...p,likes:x?(p.likes||0)+1:(p.likes||0)-1}))}catch(x){console.error("Failed to toggle like:",x)}},handleRepost:async f=>{if(f&&f.stopPropagation(),!a)return l("Please login to repost!","error");if(!je(t)||!je(a.id)){const x=!n;o(x),d(p=>({...p,mirrors:x?(p.mirrors||0)+1:(p.mirrors||0)-1}));return}try{const x=await Kl(t,a.id);o(x),d(p=>({...p,mirrors:x?(p.mirrors||0)+1:(p.mirrors||0)-1})),l(x?"Reposted!":"Removed repost")}catch(x){console.error("Failed to toggle repost:",x),l("Failed to update repost","error")}}}};var Ss=({id:t,user:e,timeAgo:a,content:l,contentClass:i,media:r,quotedPost:n,stats:o,onClick:c,repostedBy:d,onUserClick:m,currentUser:u,showToast:f,poll:x,isDetail:p,initialComments:h,onDelete:b,isComment:v,onReply:j})=>{const{liked:k,reposted:N,localStats:w,setLocalStats:_,handleLike:S,handleRepost:z}=yn(t,o,u,f),{deletePost:$,updatePost:P}=We(),[F,M]=(0,g.useState)(h||[]),[L,R]=(0,g.useState)(""),[O,q]=(0,g.useState)(!1),[I,y]=(0,g.useState)(!1),[C,E]=(0,g.useState)(!1),[D,U]=(0,g.useState)(!0),[B,Y]=(0,g.useState)([]),[G,te]=(0,g.useState)(!1),[se,ie]=(0,g.useState)(!1),[de,ce]=(0,g.useState)(!1),[me,Z]=(0,g.useState)(l),[ee,A]=(0,g.useState)(r||[]),[Q,H]=(0,g.useState)([]),[ae,J]=(0,g.useState)(!1),[ne,Ce]=(0,g.useState)(!1),qe=(0,g.useRef)(null),Nt=(0,g.useRef)(F);(0,g.useEffect)(()=>{Nt.current=F},[F]);const As=async()=>{const V=JSON.stringify(ee)!==JSON.stringify(r||[])||Q.length>0;if(!me.trim()||me===l&&!V){ce(!1);return}J(!0);try{const K=[];for(const le of Q){const oe=await ze(le);K.push(oe)}await P(t,{content:me,media:[...ee,...K]}),H([]),ce(!1),f&&f("Post updated")}catch(K){console.error("Failed to update post:",K),f&&f("Failed to update post")}finally{J(!1)}},zt=async V=>{V&&V.stopPropagation();try{await $(t),f&&f("Post deleted successfully"),b&&b(t)}catch(K){console.error("Failed to delete post:",K),f&&f("Failed to delete post")}finally{ie(!1)}},Qe=(0,g.useCallback)(async(V=!1)=>{if(t){V?E(!0):q(!0);try{const K=Nt.current,le=await Hl(t,V&&K.length>0?K[K.length-1].created_at:null,10);le.length<10?U(!1):U(!0),M(V?oe=>[...oe,...le]:le)}catch(K){console.error("Failed to load comments:",K)}finally{q(!1),E(!1)}}},[t]);(0,g.useEffect)(()=>{p&&t&&Qe()},[p,t,Qe]);const Os=async V=>{if(V.preventDefault(),!(!L.trim()&&B.length===0||!u)){y(!0),te(!0);try{const K=[];for(const le of B){const oe=await ze(le);K.push(oe)}await Ql(t,u.id,L,K),R(""),Y([]),_(le=>({...le,comments:(le.comments||0)+1})),f&&f("Reply posted!"),Qe()}catch(K){console.error("Failed to post comment:",K),f&&f("Failed to post reply.")}finally{y(!1),te(!1)}}},Ds=V=>{V.stopPropagation();const K=`${window.location.origin}/post/${t}`;navigator.clipboard.writeText(K),f&&f("Link copied to clipboard!")},kt=({trigger:V})=>(0,s.jsxs)(Ar,{children:[(0,s.jsx)(Or,{asChild:!0,onClick:K=>K.stopPropagation(),children:V}),(0,s.jsxs)(Dr,{align:"end",className:"w-48 rounded-xl bg-white dark:bg-zinc-900 border-zinc-100 dark:border-zinc-800",children:[(0,s.jsxs)(Oe,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5",onClick:Ds,children:[(0,s.jsx)(Yt,{size:16}),(0,s.jsx)("span",{children:"Copy link to post"})]}),!v&&(0,s.jsxs)(Oe,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5",onClick:K=>{K.stopPropagation(),f&&f("Post reported")},children:[(0,s.jsx)(Va,{size:16}),(0,s.jsx)("span",{children:"Report post"})]}),!_t&&(0,s.jsxs)(Oe,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5 text-rose-500 focus:text-rose-500",onClick:K=>{K.stopPropagation(),f&&f("User blocked")},children:[(0,s.jsx)(il,{size:16}),(0,s.jsxs)("span",{children:["Block @",e.handle]})]}),_t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Br,{className:"bg-zinc-100 dark:bg-zinc-800"}),(0,s.jsxs)(Oe,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-900 py-2.5",onClick:K=>{K.stopPropagation(),ce(!0)},children:[(0,s.jsx)(rs,{size:16}),(0,s.jsx)("span",{children:"Edit post"})]}),(0,s.jsxs)(Oe,{className:"gap-2 cursor-pointer focus:bg-rose-50 dark:focus:bg-rose-900/20 py-2.5 text-rose-500 focus:text-rose-500",onClick:K=>{K.stopPropagation(),ie(!0)},children:[(0,s.jsx)(os,{size:16}),(0,s.jsx)("span",{children:"Delete post"})]})]})]})]}),_t=u?.handle===e.handle,Ct=V=>{if(!V)return null;const K=de?ee:V;return!K||Array.isArray(K)&&K.length===0?null:de?(0,s.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,s.jsxs)("div",{className:"grid gap-2 grid-cols-2 sm:grid-cols-3",children:[ee.map((le,oe)=>(0,s.jsxs)("div",{className:"relative aspect-square rounded-xl overflow-hidden border border-zinc-200 dark:border-zinc-800 group",children:[le.type==="video"?(0,s.jsx)("div",{className:"size-full bg-zinc-100 dark:bg-zinc-900 flex items-center justify-center",children:(0,s.jsx)(Ue,{size:24,className:"text-zinc-400"})}):(0,s.jsx)("img",{src:le.url||le.src,className:"size-full object-cover",alt:""}),(0,s.jsx)("button",{onClick:Pe=>{Pe.stopPropagation(),A(ge=>ge.filter((at,Ae)=>Ae!==oe))},className:"absolute top-1.5 right-1.5 size-7 rounded-full bg-black/60 text-white flex items-center justify-center hover:bg-black transition-colors",children:(0,s.jsx)(be,{size:16})})]},`old-${oe}`)),Q.map((le,oe)=>(0,s.jsxs)("div",{className:"relative aspect-square rounded-xl overflow-hidden border-2 border-dashed border-violet-500 bg-violet-50/10 group",children:[le.type.startsWith("image/")?(0,s.jsx)("img",{src:URL.createObjectURL(le),className:"size-full object-cover",alt:""}):(0,s.jsx)("div",{className:"size-full flex items-center justify-center",children:(0,s.jsx)(Ue,{size:24,className:"text-violet-500 animate-pulse"})}),(0,s.jsx)("button",{onClick:Pe=>{Pe.stopPropagation(),H(ge=>ge.filter((at,Ae)=>Ae!==oe))},className:"absolute top-1.5 right-1.5 size-7 rounded-full bg-black/60 text-white flex items-center justify-center hover:bg-black transition-colors",children:(0,s.jsx)(be,{size:16})}),(0,s.jsx)("div",{className:"absolute bottom-1 left-1 bg-violet-600 text-white text-[8px] font-bold px-1 rounded",children:"NEW"})]},`new-${oe}`)),ee.length+Q.length<4&&(0,s.jsxs)("button",{onClick:le=>{le.stopPropagation(),qe.current?.click()},className:"relative aspect-square rounded-xl border-2 border-dashed border-zinc-200 dark:border-zinc-800 flex flex-col items-center justify-center gap-1 text-zinc-400 hover:text-violet-500 hover:border-violet-500 hover:bg-violet-50/5 transition-all",children:[(0,s.jsx)(Re,{size:20}),(0,s.jsx)("span",{className:"text-[10px] font-bold",children:"Add Media"})]})]}),(0,s.jsx)("input",{type:"file",ref:qe,onChange:le=>{const oe=Array.from(le.target.files);H(Pe=>[...Pe,...oe])},multiple:!0,className:"hidden",accept:"image/*,video/*"})]}):g.isValidElement(K)?K:(0,s.jsx)(fn,{items:K})},St=(V,K)=>{const le=typeof V=="string"&&qi(V);if(de)return(0,s.jsxs)("div",{className:"flex flex-col gap-2 mt-2",onClick:oe=>oe.stopPropagation(),children:[(0,s.jsx)(Vr,{value:me,onChange:oe=>Z(oe.target.value),className:`min-h-[100px] w-full bg-zinc-50 dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800 rounded-xl focus:ring-violet-500 ${le?"font-bangla text-lg":"font-english"}`,autoFocus:!0}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)("button",{onClick:()=>{ce(!1),Z(l),A(r||[]),H([])},className:"px-4 py-1.5 text-sm font-bold text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-300 transition-colors",children:"Cancel"}),(0,s.jsx)("button",{onClick:As,disabled:ae||!me.trim()||me===l,className:"px-4 py-1.5 text-sm font-bold bg-violet-600 text-white rounded-full hover:bg-violet-700 disabled:opacity-50 transition-all active:scale-95",children:ae?"Saving...":"Save"})]})]});if(typeof V=="string"){const oe=!p&&V.length>280,Pe=(oe&&!ne?V.substring(0,280):V).split(/(@[a-zA-Z0-9_]+)/g).map((ge,at)=>{if(ge.startsWith("@")&&ge.length>1){const Ae=ge.substring(1);return(0,s.jsx)("span",{onClick:Ws=>{Ws.stopPropagation(),m&&m(Ae)},className:"text-violet-600 dark:text-violet-400 font-bold hover:underline cursor-pointer",children:ge},at)}return ge});return(0,s.jsxs)("p",{className:`whitespace-pre-line ${K||""} ${le?"font-bangla text-[1.15em] leading-relaxed":"font-english text-[1.05em]"}`,children:[Pe,oe&&!ne&&"...",oe&&(0,s.jsx)("button",{onClick:ge=>{ge.stopPropagation(),Ce(!ne)},className:"ml-1 text-violet-600 dark:text-violet-400 font-bold hover:underline cursor-pointer",children:ne?"Show less":"See more"})]})}return V},Bs=V=>{R(K=>{const le=`@${V} `;return K.includes(le)?K:K+le}),document.getElementById("comment-input")?.focus()};return p?(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("article",{className:"p-5 dark:bg-black",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex items-start gap-x-3",children:[(0,s.jsx)("button",{className:"shrink-0",onClick:()=>m&&m(e.handle),children:(0,s.jsxs)(ue,{className:"size-12 border border-zinc-200 dark:border-zinc-700",children:[(0,s.jsx)(fe,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,s.jsx)(xe,{children:e.handle[0]?.toUpperCase()})]})}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("div",{className:"flex flex-wrap items-center gap-x-1",children:(0,s.jsxs)("button",{className:"font-bold hover:underline text-zinc-900 dark:text-white flex items-center gap-1 text-base",onClick:()=>m&&m(e.handle),children:[e.handle,e.verified&&(0,s.jsx)(Je,{})]})}),(0,s.jsxs)("span",{className:"text-sm text-zinc-500 dark:text-zinc-400",children:["@",e.handle]})]})]}),(0,s.jsx)(kt,{trigger:(0,s.jsx)("button",{className:"text-zinc-500 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full p-2 transition-colors",children:(0,s.jsx)(ot,{size:20})})})]}),(0,s.jsx)("div",{className:"break-words text-zinc-900 dark:text-zinc-100 mt-4 text-lg sm:text-xl leading-relaxed sm:leading-8 whitespace-pre-line",children:St(l,i)}),Ct(r),x&&(0,s.jsx)(At,{poll:x}),n&&(0,s.jsx)("div",{className:"mt-4 border border-zinc-200 dark:border-zinc-700 rounded-2xl overflow-hidden shadow-sm",children:(0,s.jsx)(Ot,{...n})}),(0,s.jsx)("div",{className:"my-4 flex items-center text-zinc-500 dark:text-zinc-400 text-sm border-b border-zinc-100 dark:border-zinc-800 pb-4",children:a||"Recent"}),(0,s.jsxs)("div",{className:"border-b border-zinc-100 dark:border-zinc-800 pb-4 flex items-center gap-x-6 text-zinc-500 dark:text-zinc-400 text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,s.jsx)("span",{className:"font-bold text-black dark:text-white",children:w.likes||0})," ",(0,s.jsx)("span",{className:"opacity-70",children:"Likes"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,s.jsx)("span",{className:"font-bold text-black dark:text-white",children:w.comments||0})," ",(0,s.jsx)("span",{className:"opacity-70",children:"Comments"})]})]}),(0,s.jsxs)("div",{className:"mt-4 flex w-full items-center justify-around py-1",children:[(0,s.jsx)(Ie,{icon:De,onClick:S,active:k,activeColorClass:"text-rose-500"}),!v&&(0,s.jsx)(Ie,{icon:rt,onClick:z,active:N,activeColorClass:"text-emerald-500"}),(0,s.jsx)(Ie,{icon:ct,onClick:()=>document.getElementById("comment-input")?.focus()})]})]}),(0,s.jsx)(wn,{currentUser:u,newComment:L,setNewComment:R,handleSubmitComment:Os,loading:I,selectedFiles:B,setSelectedFiles:Y,isUploading:G}),(0,s.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:O?(0,s.jsx)("div",{className:"p-8 flex justify-center",children:(0,s.jsx)(re,{className:"animate-spin text-violet-500"})}):(0,s.jsxs)(s.Fragment,{children:[D&&F.length>0&&(0,s.jsxs)("button",{onClick:()=>Qe(!0),disabled:C,className:"w-full py-3 text-sm font-bold text-violet-600 hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors flex items-center justify-center gap-2",children:[C&&(0,s.jsx)(re,{size:14,className:"animate-spin"}),"View more replies"]}),F.map(V=>(0,s.jsx)(Ss,{...V,isComment:!0,onReply:Bs,onUserClick:m,currentUser:u,showToast:f,onDelete:K=>M(le=>le.filter(oe=>oe.id!==K))},V.id))]})}),(0,s.jsx)(Ft,{open:se,onOpenChange:ie,children:(0,s.jsxs)(Mt,{onClick:V=>V.stopPropagation(),children:[(0,s.jsxs)(Lt,{children:[(0,s.jsx)(It,{children:"Are you absolutely sure?"}),(0,s.jsx)(Et,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,s.jsxs)(Rt,{children:[(0,s.jsx)(qt,{onClick:V=>V.stopPropagation(),children:"Cancel"}),(0,s.jsx)(Tt,{onClick:zt,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]}):(0,s.jsxs)("article",{onClick:c,className:`px-5 pt-4 pb-3 hover:bg-zinc-50/80 dark:hover:bg-zinc-900/40 transition-colors border-b border-zinc-100 dark:border-zinc-800 last:border-0 ${c?"cursor-pointer":""}`,children:[d&&(0,s.jsxs)("div",{className:"mb-2 flex items-center space-x-1.5 text-[13px] text-zinc-500 font-semibold ml-1",children:[(0,s.jsx)(rt,{size:14,className:"text-zinc-400"}),(0,s.jsx)("span",{className:"hover:underline cursor-pointer flex items-center text-zinc-600 dark:text-zinc-400",onClick:V=>{V.stopPropagation(),m&&m(d.handle)},children:(0,s.jsx)("span",{className:"truncate max-w-[150px]",children:typeof d=="object"?d.name:d})}),(0,s.jsx)("span",{className:"text-zinc-400",children:"reposted"})]}),(0,s.jsxs)("div",{className:"flex items-start gap-x-3",children:[(0,s.jsx)("button",{className:"shrink-0 group",onClick:V=>{V.stopPropagation(),m&&m(e.handle)},children:(0,s.jsxs)(ue,{className:"size-11 border border-zinc-200 dark:border-zinc-700 group-hover:brightness-95 transition-all",children:[(0,s.jsx)(fe,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,s.jsx)(xe,{children:e.handle[0]?.toUpperCase()})]})}),(0,s.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,s.jsxs)("div",{className:"flex w-full items-start justify-between",children:[(0,s.jsx)("div",{className:"flex flex-col min-w-0",children:(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-x-1",children:[(0,s.jsxs)("button",{className:"font-bold hover:underline text-zinc-900 dark:text-white flex items-center gap-1 truncate text-[15px]",onClick:V=>{V.stopPropagation(),m&&m(e.handle)},children:[(0,s.jsx)("span",{className:"truncate",children:e.handle}),e.verified&&(0,s.jsx)(Je,{})]}),(0,s.jsxs)("span",{className:"text-zinc-400 text-sm ml-1 whitespace-nowrap",children:["â€¢ ",a||"Recent"]})]})}),(0,s.jsx)(kt,{trigger:(0,s.jsx)("button",{className:"text-zinc-400 hover:bg-zinc-100 hover:text-zinc-700 dark:hover:bg-zinc-800 dark:hover:text-zinc-200 rounded-full p-2 -mr-2 transition-colors",children:(0,s.jsx)(ot,{size:18})})})]}),(0,s.jsxs)("div",{className:"break-words text-zinc-900 dark:text-zinc-100 mt-1 whitespace-pre-line text-sm sm:text-[15px] leading-relaxed",children:[St(l,i),Ct(r),x&&(0,s.jsx)(At,{poll:x,onVote:()=>f&&f("Voted!")}),n&&(0,s.jsx)("div",{className:"mt-3 border border-zinc-200 dark:border-zinc-700 rounded-2xl overflow-hidden bg-white dark:bg-zinc-900 hover:bg-zinc-50 dark:hover:bg-zinc-800 transition-colors cursor-pointer",onClick:V=>V.stopPropagation(),children:(0,s.jsx)(Ot,{...n})})]}),(0,s.jsx)("div",{className:"mt-3 flex w-full flex-wrap items-center justify-between gap-3 pr-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-6",children:[(0,s.jsx)(Ie,{icon:De,count:w.likes,active:k,onClick:S,activeColorClass:"text-rose-500"}),!v&&(0,s.jsx)(Ie,{icon:rt,count:w.mirrors,active:N,onClick:z,activeColorClass:"text-emerald-500"}),(0,s.jsx)(Ie,{icon:ct,count:w.comments,onClick:V=>{v&&j?(V.stopPropagation(),j(e.handle)):c&&c(V)}})]})})]})]}),(0,s.jsx)(Ft,{open:se,onOpenChange:ie,children:(0,s.jsxs)(Mt,{onClick:V=>V.stopPropagation(),children:[(0,s.jsxs)(Lt,{children:[(0,s.jsx)(It,{children:"Are you absolutely sure?"}),(0,s.jsx)(Et,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,s.jsxs)(Rt,{children:[(0,s.jsx)(qt,{onClick:V=>V.stopPropagation(),children:"Cancel"}),(0,s.jsx)(Tt,{onClick:zt,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]})},tt=Ss,Nn=W(),zn=()=>{const t=(0,Nn.c)(3);let e;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,s.jsx)("div",{className:"size-11 rounded-full bg-zinc-200 dark:bg-zinc-800 shrink-0"}),t[0]=e):e=t[0];let a;t[1]===Symbol.for("react.memo_cache_sentinel")?(a=(0,s.jsx)("div",{className:"h-4 bg-zinc-200 dark:bg-zinc-800 rounded w-1/3"}),t[1]=a):a=t[1];let l;return t[2]===Symbol.for("react.memo_cache_sentinel")?(l=(0,s.jsx)("div",{className:"px-5 pt-4 pb-3 border-b border-zinc-100 dark:border-zinc-800 animate-pulse",children:(0,s.jsxs)("div",{className:"flex items-start gap-x-3",children:[e,(0,s.jsxs)("div",{className:"flex-1 space-y-3",children:[a,(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"h-3 bg-zinc-200 dark:bg-zinc-800 rounded w-full"}),(0,s.jsx)("div",{className:"h-3 bg-zinc-200 dark:bg-zinc-800 rounded w-5/6"})]}),(0,s.jsx)("div",{className:"h-48 bg-zinc-200 dark:bg-zinc-800 rounded-xl w-full"})]})]})}),t[2]=l):l=t[2],l},wt=zn,$s=W();function Dt(t){const e=(0,$s.c)(14);let a,l,i;e[0]!==t?({className:l,children:a,...i}=t,e[0]=t,e[1]=a,e[2]=l,e[3]=i):(a=e[1],l=e[2],i=e[3]);let r;e[4]!==l?(r=X("relative",l),e[4]=l,e[5]=r):r=e[5];let n;e[6]!==a?(n=(0,s.jsx)(xl,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:a}),e[6]=a,e[7]=n):n=e[7];let o,c;e[8]===Symbol.for("react.memo_cache_sentinel")?(o=(0,s.jsx)(dt,{}),c=(0,s.jsx)(Sa,{}),e[8]=o,e[9]=c):(o=e[8],c=e[9]);let d;return e[10]!==i||e[11]!==r||e[12]!==n?(d=(0,s.jsxs)(ml,{"data-slot":"scroll-area",className:r,...i,children:[n,o,c]}),e[10]=i,e[11]=r,e[12]=n,e[13]=d):d=e[13],d}function dt(t){const e=(0,$s.c)(13);let a,l,i;e[0]!==t?({className:a,orientation:i,...l}=t,e[0]=t,e[1]=a,e[2]=l,e[3]=i):(a=e[1],l=e[2],i=e[3]);const r=i===void 0?"vertical":i,n=r==="vertical"&&"h-full w-2.5 border-l border-l-transparent",o=r==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent";let c;e[4]!==a||e[5]!==n||e[6]!==o?(c=X("flex touch-none p-px transition-colors select-none",n,o,a),e[4]=a,e[5]=n,e[6]=o,e[7]=c):c=e[7];let d;e[8]===Symbol.for("react.memo_cache_sentinel")?(d=(0,s.jsx)(La,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"}),e[8]=d):d=e[8];let m;return e[9]!==r||e[10]!==l||e[11]!==c?(m=(0,s.jsx)(hl,{"data-slot":"scroll-area-scrollbar",orientation:r,className:c,...l,children:d}),e[9]=r,e[10]=l,e[11]=c,e[12]=m):m=e[12],m}var kn=W(),_n=t=>{const e=(0,kn.c)(49),{onStoryClick:a,onAddStory:l}=t,{currentUser:i}=he(),{posts:r,loading:n,hasMore:o,isFetchingNextPage:c,fetchNextPage:d}=We(),{addToast:m}=_e(),u=we();let f;e[0]===Symbol.for("react.memo_cache_sentinel")?(f={threshold:.1},e[0]=f):f=e[0];const{ref:x,inView:p}=ca(f);let h,b;e[1]!==d||e[2]!==o||e[3]!==p||e[4]!==c?(h=()=>{p&&o&&!c&&d()},b=[p,o,c,d],e[1]=d,e[2]=o,e[3]=p,e[4]=c,e[5]=h,e[6]=b):(h=e[5],b=e[6]),(0,g.useEffect)(h,b);let v;e[7]===Symbol.for("react.memo_cache_sentinel")?(v={queryKey:["stories"],queryFn:ni},e[7]=v):v=e[7];const{data:j,isLoading:k}=Le(v);let N;e[8]!==j?(N=j===void 0?[]:j,e[8]=j,e[9]=N):N=e[9];const w=N;let _;if(e[10]!==w){const B={};w.forEach(Y=>{if(!Y.user)return;const G=Y.user.id;B[G]||(B[G]={user:Y.user,stories:[]}),B[G].stories.push(Y)}),_=Object.values(B),e[10]=w,e[11]=_}else _=e[11];const S=_,z=r;let $;e[12]!==u?($=B=>{u(`/post/${B}`)},e[12]=u,e[13]=$):$=e[13];const P=$;let F;e[14]!==u?(F=B=>{u(`/u/${B}`)},e[14]=u,e[15]=F):F=e[15];const M=F;if(n||k){let B;return e[16]===Symbol.for("react.memo_cache_sentinel")?(B=(0,s.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:[(0,s.jsxs)(Dt,{className:"w-full whitespace-nowrap border-b border-zinc-100 dark:border-zinc-800",children:[(0,s.jsxs)("div",{className:"flex w-max gap-3 py-4 px-4",children:[(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"}),(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"}),(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"})]}),(0,s.jsx)(dt,{orientation:"horizontal",className:"hidden"})]}),[1,2,3].map(Sn)]}),e[16]=B):B=e[16],B}let L;e[17]!==i||e[18]!==l?(L=i&&(0,s.jsx)(Pt,{user:i,isAddStory:!0,onClick:l}),e[17]=i,e[18]=l,e[19]=L):L=e[19];let R;e[20]!==S||e[21]!==a?(R=S.map(B=>(0,s.jsx)(Pt,{user:B.user,onClick:()=>a(B)},B.user.id)),e[20]=S,e[21]=a,e[22]=R):R=e[22];let O;e[23]!==L||e[24]!==R?(O=(0,s.jsxs)("div",{className:"flex w-max gap-4 py-4 px-4",children:[L,R]}),e[23]=L,e[24]=R,e[25]=O):O=e[25];let q;e[26]===Symbol.for("react.memo_cache_sentinel")?(q=(0,s.jsx)(dt,{orientation:"horizontal",className:"hidden"}),e[26]=q):q=e[26];let I;e[27]!==O?(I=(0,s.jsxs)(Dt,{className:"w-full border-b border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black",children:[O,q]}),e[27]=O,e[28]=I):I=e[28];let y;e[29]!==i?(y=!i&&(0,s.jsx)("div",{className:"px-4 py-2 md:hidden",children:(0,s.jsx)(ws,{className:"p-6"})}),e[29]=i,e[30]=y):y=e[30];let C;e[31]!==m||e[32]!==i||e[33]!==P||e[34]!==M||e[35]!==z?(C=z.length>0?z.map(B=>(0,s.jsx)(tt,{...B,currentUser:i,showToast:m,onClick:()=>P(B.id),onUserClick:M},B.feed_id||B.id)):(0,s.jsxs)("div",{className:"p-20 text-center text-zinc-500",children:[(0,s.jsx)("p",{className:"text-lg font-medium",children:"No posts yet."}),(0,s.jsx)("p",{className:"text-sm",children:"Be the first to share something amazing!"})]}),e[31]=m,e[32]=i,e[33]=P,e[34]=M,e[35]=z,e[36]=C):C=e[36];let E;e[37]!==o||e[38]!==z.length||e[39]!==c||e[40]!==x?(E=z.length>0&&(0,s.jsx)("div",{ref:x,className:"py-8 flex justify-center",children:c?(0,s.jsx)(re,{className:"animate-spin text-violet-500",size:24}):o?(0,s.jsx)("div",{className:"h-4"}):(0,s.jsx)("p",{className:"text-sm text-zinc-500 font-medium",children:"You've reached the end of the feed."})}),e[37]=o,e[38]=z.length,e[39]=c,e[40]=x,e[41]=E):E=e[41];let D;e[42]!==C||e[43]!==E?(D=(0,s.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm",children:[C,E]}),e[42]=C,e[43]=E,e[44]=D):D=e[44];let U;return e[45]!==I||e[46]!==y||e[47]!==D?(U=(0,s.jsxs)("div",{className:"w-full max-w-full overflow-hidden",children:[I,y,D]}),e[45]=I,e[46]=y,e[47]=D,e[48]=U):U=e[48],U},Cn=_n;function Sn(t){return(0,s.jsx)(wt,{},t)}const Ps=(t,e,a)=>{const l=t?.id,[i,r]=(0,g.useState)(!1),[n,o]=(0,g.useState)({followers:t?.followers||t?.follower_count||0,following:t?.following||t?.following_count||0}),[c,d]=(0,g.useState)(!1);return(0,g.useEffect)(()=>{t&&(o({followers:t.followers||t.follower_count||0,following:t.following||t.following_count||0}),l&&je(l)&&(El(l).then(u=>{u&&o({followers:u.followers,following:u.following})}).catch(()=>{}),e&&je(e)&&Ll(e,l).then(r).catch(()=>r(!1))))},[t,l,e]),{isFollowing:i,stats:n,loading:c,handleFollow:async()=>{if(!e)return a("Please login to follow!","error");if(e===l)return a("You cannot follow yourself!","error");if(!l||!je(l)||!je(e)){const u=!i;r(u),o(f=>{const x=typeof f.followers=="string"?parseInt(f.followers.replace(/,/g,"")):f.followers||0;return{...f,followers:u?x+1:Math.max(0,x-1)}}),a(u?"Followed":"Unfollowed");return}d(!0);try{const u=await Ml(e,l);r(u),o(f=>({...f,followers:u?(f.followers||0)+1:Math.max(0,(f.followers||0)-1)})),a(u?"Followed":"Unfollowed")}catch(u){console.error("Failed to toggle follow:",u),a("Failed to update follow status","error")}finally{d(!1)}},setStats:o}};var $n=W(),Pn=t=>{const e=(0,$n.c)(57),{profile:a,onUserClick:l,isCommunity:i}=t,r=i===void 0?!1:i,{onlineUsers:n}=hs(),{currentUser:o}=he(),{addToast:c}=_e();let d;e[0]!==n||e[1]!==a.id?(d=n.has(a.id),e[0]=n,e[1]=a.id,e[2]=d):d=e[2];const m=d,{isFollowing:u,loading:f,handleFollow:x}=Ps(a,o?.id,c),p=o?.id===a.id;let h;e[3]!==l||e[4]!==a.handle?(h=()=>l(a.handle),e[3]=l,e[4]=a.handle,e[5]=h):h=e[5];const b=`size-12 border border-zinc-200 dark:border-zinc-800 shadow-sm ${r?"rounded-2xl":""}`;let v;e[6]!==a.avatar||e[7]!==a.handle?(v=(0,s.jsx)(fe,{src:a.avatar,alt:a.handle,className:"object-cover"}),e[6]=a.avatar,e[7]=a.handle,e[8]=v):v=e[8];const j=r?"rounded-2xl":"";let k;e[9]!==a.handle?.[0]?(k=a.handle?.[0]?.toUpperCase(),e[9]=a.handle?.[0],e[10]=k):k=e[10];let N;e[11]!==j||e[12]!==k?(N=(0,s.jsx)(xe,{className:j,children:k}),e[11]=j,e[12]=k,e[13]=N):N=e[13];let w;e[14]!==b||e[15]!==v||e[16]!==N?(w=(0,s.jsxs)(ue,{className:b,children:[v,N]}),e[14]=b,e[15]=v,e[16]=N,e[17]=w):w=e[17];let _;e[18]!==r||e[19]!==m?(_=m&&!r&&(0,s.jsx)("span",{className:"absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full shadow-sm"}),e[18]=r,e[19]=m,e[20]=_):_=e[20];let S;e[21]!==_||e[22]!==w?(S=(0,s.jsxs)("div",{className:"relative",children:[w,_]}),e[21]=_,e[22]=w,e[23]=S):S=e[23];let z;e[24]!==a.name?(z=(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white leading-none",children:a.name}),e[24]=a.name,e[25]=z):z=e[25];let $;e[26]!==a.verified?($=a.verified&&(0,s.jsx)(Je,{}),e[26]=a.verified,e[27]=$):$=e[27];let P;e[28]!==z||e[29]!==$?(P=(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[z,$]}),e[28]=z,e[29]=$,e[30]=P):P=e[30];let F;e[31]!==a.handle?(F=(0,s.jsxs)("span",{className:"text-sm text-zinc-500 mt-0.5",children:["@",a.handle]}),e[31]=a.handle,e[32]=F):F=e[32];let M;e[33]!==r||e[34]!==a.members?(M=r&&a.members&&(0,s.jsxs)("span",{className:"text-xs text-zinc-400 mt-1",children:[a.members," members"]}),e[33]=r,e[34]=a.members,e[35]=M):M=e[35];let L;e[36]!==r||e[37]!==a.followers?(L=!r&&a.followers&&(0,s.jsxs)("span",{className:"text-xs text-zinc-400 mt-1",children:[a.followers," followers"]}),e[36]=r,e[37]=a.followers,e[38]=L):L=e[38];let R;e[39]!==P||e[40]!==F||e[41]!==M||e[42]!==L?(R=(0,s.jsxs)("div",{className:"flex flex-col",children:[P,F,M,L]}),e[39]=P,e[40]=F,e[41]=M,e[42]=L,e[43]=R):R=e[43];let O;e[44]!==S||e[45]!==R?(O=(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[S,R]}),e[44]=S,e[45]=R,e[46]=O):O=e[46];let q;e[47]!==x||e[48]!==r||e[49]!==u||e[50]!==p||e[51]!==f?(q=!p&&(0,s.jsx)(pe,{variant:u?"secondary":"outline",className:"!w-auto !py-1.5 !px-4 text-sm font-bold rounded-full border-zinc-200 dark:border-zinc-700 hover:bg-zinc-100 dark:hover:bg-zinc-800",onClick:y=>{y.stopPropagation(),x()},disabled:f,children:f?(0,s.jsx)(re,{size:14,className:"animate-spin"}):u?"Following":r?"Join":"Follow"}),e[47]=x,e[48]=r,e[49]=u,e[50]=p,e[51]=f,e[52]=q):q=e[52];let I;return e[53]!==O||e[54]!==q||e[55]!==h?(I=(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-zinc-100 dark:border-zinc-800 hover:bg-zinc-50 dark:hover:bg-zinc-900/40 transition-colors group cursor-pointer",onClick:h,children:[O,q]}),e[53]=O,e[54]=q,e[55]=h,e[56]=I):I=e[56],I},mt=Pn,st=W();function Fs(t){const e=(0,st.c)(8);let a,l;e[0]!==t?({className:a,...l}=t,e[0]=t,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let i;e[3]!==a?(i=X("flex flex-col gap-2",a),e[3]=a,e[4]=i):i=e[4];let r;return e[5]!==l||e[6]!==i?(r=(0,s.jsx)(Da,{"data-slot":"tabs",className:i,...l}),e[5]=l,e[6]=i,e[7]=r):r=e[7],r}function Ms(t){const e=(0,st.c)(8);let a,l;e[0]!==t?({className:a,...l}=t,e[0]=t,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let i;e[3]!==a?(i=X("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",a),e[3]=a,e[4]=i):i=e[4];let r;return e[5]!==l||e[6]!==i?(r=(0,s.jsx)(Xa,{"data-slot":"tabs-list",className:i,...l}),e[5]=l,e[6]=i,e[7]=r):r=e[7],r}function Ls(t){const e=(0,st.c)(8);let a,l;e[0]!==t?({className:a,...l}=t,e[0]=t,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let i;e[3]!==a?(i=X("inline-flex items-center justify-center gap-1.5 px-2 py-1 text-sm font-medium whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 outline-none focus:outline-none focus-visible:outline-none ring-0 focus:ring-0 focus-visible:ring-0 shadow-none data-[state=active]:shadow-none",a),e[3]=a,e[4]=i):i=e[4];let r;return e[5]!==l||e[6]!==i?(r=(0,s.jsx)(Oa,{"data-slot":"tabs-trigger",className:i,...l}),e[5]=l,e[6]=i,e[7]=r):r=e[7],r}function Ee(t){const e=(0,st.c)(8);let a,l;e[0]!==t?({className:a,...l}=t,e[0]=t,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let i;e[3]!==a?(i=X("flex-1 outline-none",a),e[3]=a,e[4]=i):i=e[4];let r;return e[5]!==l||e[6]!==i?(r=(0,s.jsx)(el,{"data-slot":"tabs-content",className:i,...l}),e[5]=l,e[6]=i,e[7]=r):r=e[7],r}var Fn=()=>{const{currentUser:t}=he(),{posts:e,loading:a}=We(),{addToast:l}=_e(),i=we(),[r,n]=(0,g.useState)("users"),[o,c]=(0,g.useState)(""),[d,m]=(0,g.useState)([]),[u,f]=(0,g.useState)(!0),[x,p]=(0,g.useState)(!1),[h,b]=(0,g.useState)(!0),v=(0,g.useRef)(d);(0,g.useEffect)(()=>{v.current=d},[d]);const j=(0,g.useCallback)(async(z=!1)=>{z?p(!0):f(!0);try{const $=v.current,P=await $l(z&&$.length>0?$[$.length-1].created_at:null,10);P.length<10?b(!1):b(!0),m(z?F=>[...F,...P]:P)}catch($){console.error("Failed to fetch profiles:",$)}finally{f(!1),p(!1)}},[]);(0,g.useEffect)(()=>{j()},[j]);const k=(0,g.useMemo)(()=>{let z=d.filter($=>$.type!=="community");return o&&(z=z.filter($=>$.name?.toLowerCase().includes(o.toLowerCase())||$.handle?.toLowerCase().includes(o.toLowerCase()))),z},[d,o]),N=(0,g.useMemo)(()=>{let z=d.filter($=>$.type==="community");return o&&(z=z.filter($=>$.name?.toLowerCase().includes(o.toLowerCase())||$.handle?.toLowerCase().includes(o.toLowerCase()))),z},[d,o]),w=(0,g.useMemo)(()=>{let z=e.filter($=>$.type==="video");return o&&(z=z.filter($=>$.content?.toLowerCase().includes(o.toLowerCase()))),z},[e,o]),_=z=>{i(`/post/${z}`)},S=z=>{i(`/u/${z}`)};return a||u?(0,s.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:[1,2,3].map(z=>(0,s.jsx)(wt,{},z))}):(0,s.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm",children:(0,s.jsxs)(Fs,{value:r,onValueChange:n,className:"w-full",children:[(0,s.jsxs)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-10 border-b border-zinc-100 dark:border-zinc-800",children:[(0,s.jsx)("div",{className:"p-4",children:(0,s.jsx)(Ke,{value:o,onChange:c,onClear:()=>c(""),placeholder:`Search ${r}...`})}),(0,s.jsx)(Ms,{className:"w-full h-auto bg-transparent p-0 rounded-none justify-around px-5",children:["users","communities","reels"].map(z=>(0,s.jsx)(Ls,{value:z,className:"relative py-4 px-2 text-sm font-semibold transition-all border-b-2 rounded-none whitespace-nowrap flex-1 text-center capitalize data-[state=active]:border-black dark:data-[state=active]:border-white data-[state=active]:text-black dark:data-[state=active]:text-white text-zinc-500 hover:text-zinc-800 dark:hover:text-zinc-300",children:z},z))})]}),(0,s.jsx)(Ee,{value:"users",className:"m-0 border-none",children:(0,s.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:[k.length>0?k.map(z=>(0,s.jsx)(mt,{profile:z,onUserClick:S},z.handle)):(0,s.jsx)("div",{className:"p-20 text-center text-zinc-500",children:(0,s.jsx)("p",{className:"font-bold",children:"No users found"})}),h&&k.length>0&&(0,s.jsx)("div",{className:"p-6 flex justify-center border-t border-zinc-100 dark:border-zinc-800",children:(0,s.jsxs)(pe,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>j(!0),disabled:x,children:[x&&(0,s.jsx)(re,{size:18,className:"animate-spin mr-2"}),"Load more"]})})]})}),(0,s.jsx)(Ee,{value:"communities",className:"m-0 border-none",children:(0,s.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:[N.length>0?N.map(z=>(0,s.jsx)(mt,{profile:z,onUserClick:S,isCommunity:!0},z.handle)):(0,s.jsx)("div",{className:"p-20 text-center text-zinc-500",children:(0,s.jsx)("p",{className:"font-bold",children:"No communities found"})}),h&&N.length>0&&(0,s.jsx)("div",{className:"p-6 flex justify-center border-t border-zinc-100 dark:border-zinc-800",children:(0,s.jsxs)(pe,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>j(!0),disabled:x,children:[x&&(0,s.jsx)(re,{size:18,className:"animate-spin mr-2"}),"Load more"]})})]})}),(0,s.jsx)(Ee,{value:"reels",className:"m-0 border-none",children:(0,s.jsx)("div",{children:w.length>0?w.map(z=>(0,s.jsx)(tt,{...z,currentUser:t,showToast:l,onClick:()=>_(z.id),onUserClick:S},z.feed_id||z.id)):(0,s.jsx)("div",{className:"p-20 text-center text-zinc-500",children:(0,s.jsx)("p",{className:"font-bold",children:"No reels found"})})})})]})})},Mn=Fn,Ln=W(),Rn=t=>{const e=(0,Ln.c)(56),{reel:a}=t,l=(0,g.useRef)(null),[i,r]=(0,g.useState)(!1),n=(0,g.useRef)(0),o=Array.isArray(a.media)?a.media[0]?.src||a.media[0]?.url:a.media?.src||a.media?.url||a.url;let c,d;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=()=>{const de=new IntersectionObserver(me=>{const[Z]=me;l.current?.plyr&&(Z.isIntersecting?l.current.plyr.play().catch(()=>{l.current.plyr.muted=!0,l.current.plyr.play()}):l.current.plyr.pause())},{threshold:.8}),ce=l.current?.elements?.container;return ce&&de.observe(ce),()=>{ce&&de.unobserve(ce)}},d=[],e[0]=c,e[1]=d):(c=e[0],d=e[1]),(0,g.useEffect)(c,d);let m;e[2]===Symbol.for("react.memo_cache_sentinel")?(m=()=>{const de=Date.now();de-n.current<300&&(r(!0),setTimeout(()=>r(!1),800)),n.current=de},e[2]=m):m=e[2];const u=m;let f;e[3]!==o?(f={type:"video",sources:[{src:o,type:"video/mp4"}]},e[3]=o,e[4]=f):f=e[4];let x;e[5]===Symbol.for("react.memo_cache_sentinel")?(x={controls:[],loop:{active:!0},clickToPlay:!0,ratio:"9:16"},e[5]=x):x=e[5];let p;e[6]!==f?(p={source:f,options:x},e[6]=f,e[7]=p):p=e[7];const h=p;let b;e[8]!==h?(b=(0,s.jsx)("div",{className:"w-full h-full max-w-[450px]",children:(0,s.jsx)(Xt,{ref:l,...h})}),e[8]=h,e[9]=b):b=e[9];let v;e[10]!==i?(v=i&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-50 animate-in zoom-in-50 fade-in duration-300",children:(0,s.jsx)(De,{size:100,fill:"white",className:"text-white drop-shadow-2xl scale-125"})}),e[10]=i,e[11]=v):v=e[11];let j;e[12]===Symbol.for("react.memo_cache_sentinel")?(j=(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-black/60 pointer-events-none"}),e[12]=j):j=e[12];const k=a.user?.avatar,N=a.user?.handle;let w;e[13]!==k||e[14]!==N?(w=(0,s.jsx)(fe,{src:k,alt:N,className:"object-cover"}),e[13]=k,e[14]=N,e[15]=w):w=e[15];let _;e[16]!==a.user?.handle?.[0]?(_=a.user?.handle?.[0]?.toUpperCase(),e[16]=a.user?.handle?.[0],e[17]=_):_=e[17];let S;e[18]!==_?(S=(0,s.jsx)(xe,{children:_}),e[18]=_,e[19]=S):S=e[19];let z;e[20]!==w||e[21]!==S?(z=(0,s.jsxs)(ue,{className:"size-10 border-2 border-white",children:[w,S]}),e[20]=w,e[21]=S,e[22]=z):z=e[22];const $=a.user?.handle;let P;e[23]!==$?(P=(0,s.jsxs)("span",{className:"font-bold",children:["@",$]}),e[23]=$,e[24]=P):P=e[24];let F;e[25]===Symbol.for("react.memo_cache_sentinel")?(F=(0,s.jsx)("button",{className:"bg-white text-black text-xs font-bold px-3 py-1 rounded-full ml-2 hover:scale-105 active:scale-95 transition-all",children:"Follow"}),e[25]=F):F=e[25];let M;e[26]!==z||e[27]!==P?(M=(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3 pointer-events-auto",children:[z,P,F]}),e[26]=z,e[27]=P,e[28]=M):M=e[28];let L;e[29]!==a.content?(L=(0,s.jsx)("p",{className:"text-sm mb-3 line-clamp-2",children:a.content}),e[29]=a.content,e[30]=L):L=e[30];let R;e[31]===Symbol.for("react.memo_cache_sentinel")?(R=(0,s.jsx)(ul,{size:14,className:"animate-spin-slow"}),e[31]=R):R=e[31];const O=a.user?.handle;let q;e[32]!==O?(q=(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs opacity-90",children:[R,(0,s.jsxs)("span",{children:["Original Audio - ",O]})]}),e[32]=O,e[33]=q):q=e[33];let I;e[34]!==M||e[35]!==L||e[36]!==q?(I=(0,s.jsxs)("div",{className:"absolute bottom-20 left-4 right-16 text-white pointer-events-none",children:[M,L,q]}),e[34]=M,e[35]=L,e[36]=q,e[37]=I):I=e[37];let y;e[38]===Symbol.for("react.memo_cache_sentinel")?(y=(0,s.jsx)("button",{className:"p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90",children:(0,s.jsx)(De,{size:28})}),e[38]=y):y=e[38];const C=a.stats?.likes||0;let E;e[39]!==C?(E=(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[y,(0,s.jsx)("span",{className:"text-white text-xs font-bold",children:C})]}),e[39]=C,e[40]=E):E=e[40];let D;e[41]===Symbol.for("react.memo_cache_sentinel")?(D=(0,s.jsx)("button",{className:"p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90",children:(0,s.jsx)(ct,{size:28})}),e[41]=D):D=e[41];const U=a.stats?.comments||0;let B;e[42]!==U?(B=(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[D,(0,s.jsx)("span",{className:"text-white text-xs font-bold",children:U})]}),e[42]=U,e[43]=B):B=e[43];let Y;e[44]===Symbol.for("react.memo_cache_sentinel")?(Y=(0,s.jsx)("button",{className:"p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90",children:(0,s.jsx)(Ga,{size:28})}),e[44]=Y):Y=e[44];const G=a.stats?.shares||0;let te;e[45]!==G?(te=(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[Y,(0,s.jsx)("span",{className:"text-white text-xs font-bold",children:G})]}),e[45]=G,e[46]=te):te=e[46];let se;e[47]!==E||e[48]!==B||e[49]!==te?(se=(0,s.jsxs)("div",{className:"absolute bottom-20 right-2 flex flex-col items-center gap-6 z-10",children:[E,B,te]}),e[47]=E,e[48]=B,e[49]=te,e[50]=se):se=e[50];let ie;return e[51]!==I||e[52]!==se||e[53]!==b||e[54]!==v?(ie=(0,s.jsxs)("div",{className:"relative h-screen w-full bg-black snap-start flex items-center justify-center overflow-hidden",onClick:u,children:[b,v,j,I,se]}),e[51]=I,e[52]=se,e[53]=b,e[54]=v,e[55]=ie):ie=e[55],ie},In=Rn,En=W(),Tn=()=>{const t=(0,En.c)(12),{posts:e,loading:a}=We(),l=we();let i,r;if(t[0]!==a||t[1]!==l||t[2]!==e){r=Symbol.for("react.early_return_sentinel");e:{const n=e.filter(An);if(a){let m;t[5]===Symbol.for("react.memo_cache_sentinel")?(m=(0,s.jsx)("div",{className:"h-[100dvh] w-full flex items-center justify-center bg-black",children:(0,s.jsx)(re,{size:40,className:"animate-spin text-white"})}),t[5]=m):m=t[5],r=m;break e}if(n.length===0){let m;t[6]===Symbol.for("react.memo_cache_sentinel")?(m=(0,s.jsx)("div",{className:"h-[100dvh] w-full flex flex-col items-center justify-center bg-black text-white gap-4",children:(0,s.jsx)("p",{className:"text-zinc-500",children:"No reels found."})}),t[6]=m):m=t[6],r=m;break e}let o;t[7]!==l?(o=()=>l(-1),t[7]=l,t[8]=o):o=t[8];let c;t[9]===Symbol.for("react.memo_cache_sentinel")?(c=(0,s.jsx)(Be,{size:24,strokeWidth:2.5}),t[9]=c):c=t[9];let d;t[10]!==o?(d=(0,s.jsx)("button",{onClick:o,className:"absolute top-6 left-6 z-50 p-2.5 bg-black/20 hover:bg-black/40 text-white backdrop-blur-md rounded-full transition-all active:scale-90 border border-white/10 shadow-xl",title:"Back",children:c}),t[10]=o,t[11]=d):d=t[11],i=(0,s.jsxs)("div",{className:"h-[100dvh] w-full snap-y snap-mandatory overflow-y-auto no-scrollbar bg-black md:rounded-xl relative",children:[d,n.map(On)]})}t[0]=a,t[1]=l,t[2]=e,t[3]=i,t[4]=r}else i=t[3],r=t[4];return r!==Symbol.for("react.early_return_sentinel")?r:i},qn=Tn;function An(t){return t.type==="video"||t.category==="video"}function On(t){return(0,s.jsx)(In,{reel:t},t.id)}var Dn=W();const Rs=t=>{const e=(0,Dn.c)(5);let a;e[0]!==t?(a=()=>Ve(t),e[0]=t,e[1]=a):a=e[1];const[l,i]=(0,g.useState)(a);let r,n;return e[2]!==t?(r=()=>{if(!t)return;const o=setTimeout(()=>{i(Ve(t))},0),c=setInterval(()=>{i(Ve(t))},6e4);return()=>{clearTimeout(o),clearInterval(c)}},n=[t],e[2]=t,e[3]=r,e[4]=n):(r=e[3],n=e[4]),(0,g.useEffect)(r,n),l};var Bn=W(),Wn=t=>{const e=(0,Bn.c)(50),{conv:a,selectedId:l,onSelect:i,onlineUsers:r}=t,n=Rs(a.user?.lastSeen);let o;e[0]!==a.user?.id||e[1]!==r?(o=r.has(a.user?.id),e[0]=a.user?.id,e[1]=r,e[2]=o):o=e[2];const c=o;let d;e[3]!==a||e[4]!==i?(d=()=>i(a),e[3]=a,e[4]=i,e[5]=d):d=e[5];const m=`flex items-center gap-3 p-4 cursor-pointer transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900 ${l===a.id?"bg-zinc-50 dark:bg-zinc-900 border-r-2 border-violet-500":""}`,u=a.user?.avatar,f=a.user?.name;let x;e[6]!==u||e[7]!==f?(x=(0,s.jsx)(fe,{src:u,alt:f,className:"object-cover"}),e[6]=u,e[7]=f,e[8]=x):x=e[8];let p;e[9]!==a.user?.name?.[0]?(p=a.user?.name?.[0]?.toUpperCase(),e[9]=a.user?.name?.[0],e[10]=p):p=e[10];let h;e[11]!==p?(h=(0,s.jsx)(xe,{children:p}),e[11]=p,e[12]=h):h=e[12];let b;e[13]!==x||e[14]!==h?(b=(0,s.jsxs)(ue,{className:"size-12",children:[x,h]}),e[13]=x,e[14]=h,e[15]=b):b=e[15];let v;e[16]!==c?(v=c&&(0,s.jsx)("span",{className:"absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full"}),e[16]=c,e[17]=v):v=e[17];let j;e[18]!==v||e[19]!==b?(j=(0,s.jsxs)("div",{className:"relative",children:[b,v]}),e[18]=v,e[19]=b,e[20]=j):j=e[20];const k=a.user?.name;let N;e[21]!==k?(N=(0,s.jsx)("span",{className:"font-bold dark:text-white truncate",children:k}),e[21]=k,e[22]=N):N=e[22];let w;e[23]!==a.user?.lastSeen||e[24]!==c||e[25]!==n?(w=c?(0,s.jsx)("span",{className:"text-[10px] text-emerald-500 font-medium leading-none mb-1",children:"Online"}):a.user?.lastSeen&&(0,s.jsx)("span",{className:"text-[10px] text-zinc-500 font-medium leading-none mb-1",children:n}),e[23]=a.user?.lastSeen,e[24]=c,e[25]=n,e[26]=w):w=e[26];let _;e[27]!==N||e[28]!==w?(_=(0,s.jsxs)("div",{className:"flex flex-col min-w-0",children:[N,w]}),e[27]=N,e[28]=w,e[29]=_):_=e[29];let S;e[30]!==a.time?(S=(0,s.jsx)("span",{className:"text-xs text-zinc-500 whitespace-nowrap ml-2",children:a.time}),e[30]=a.time,e[31]=S):S=e[31];let z;e[32]!==_||e[33]!==S?(z=(0,s.jsxs)("div",{className:"flex justify-between items-center mb-0.5",children:[_,S]}),e[32]=_,e[33]=S,e[34]=z):z=e[34];let $;e[35]!==a.lastMessage?($=(0,s.jsx)("p",{className:"text-zinc-500 text-sm truncate pr-2",children:a.lastMessage}),e[35]=a.lastMessage,e[36]=$):$=e[36];let P;e[37]!==a.unread?(P=a.unread>0&&(0,s.jsx)("span",{className:"bg-violet-600 text-white text-[10px] font-bold size-5 rounded-full flex items-center justify-center shrink-0",children:a.unread}),e[37]=a.unread,e[38]=P):P=e[38];let F;e[39]!==$||e[40]!==P?(F=(0,s.jsxs)("div",{className:"flex-1 flex justify-between items-center",children:[$,P]}),e[39]=$,e[40]=P,e[41]=F):F=e[41];let M;e[42]!==z||e[43]!==F?(M=(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[z,F]}),e[42]=z,e[43]=F,e[44]=M):M=e[44];let L;return e[45]!==j||e[46]!==d||e[47]!==M||e[48]!==m?(L=(0,s.jsxs)("div",{onClick:d,className:m,children:[j,M]}),e[45]=j,e[46]=d,e[47]=M,e[48]=m,e[49]=L):L=e[49],L},Hn=({conversations:t,userResults:e=[],onSelect:a,onStartNew:l,selectedId:i,searchQuery:r,onSearchChange:n,onlineUsers:o=new Set})=>(0,s.jsxs)("div",{className:"flex-1 flex flex-col min-w-0 bg-white dark:bg-black",children:[(0,s.jsx)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)(Ke,{value:r,onChange:n,onClear:()=>n(""),placeholder:"Search people or messages..."})}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[t.length>0&&(0,s.jsx)("div",{className:"py-2",children:t.map(c=>(0,s.jsx)(Wn,{conv:c,selectedId:i,onSelect:a,onlineUsers:o},c.id))}),e.length>0&&(0,s.jsxs)("div",{className:"border-t border-zinc-100 dark:border-zinc-800",children:[(0,s.jsx)("div",{className:"px-4 py-3 text-xs font-bold text-zinc-500 uppercase tracking-wider",children:"People"}),e.map(c=>(0,s.jsxs)("div",{onClick:()=>l(c),className:"flex items-center gap-3 p-4 cursor-pointer transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[(0,s.jsxs)(ue,{className:"size-12",children:[(0,s.jsx)(fe,{src:c.avatar,alt:c.name,className:"object-cover"}),(0,s.jsx)(xe,{children:c.name?.[0]?.toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"font-bold dark:text-white truncate",children:c.name}),(0,s.jsxs)("div",{className:"text-zinc-500 text-sm truncate",children:["@",c.handle]})]}),(0,s.jsx)(ns,{size:18,className:"text-violet-500"})]},c.id))]}),t.length===0&&e.length===0&&r&&(0,s.jsx)("div",{className:"p-8 text-center",children:(0,s.jsxs)("p",{className:"text-zinc-500 text-sm",children:['No conversations or people found for "',r,'"']})}),t.length===0&&!r&&(0,s.jsx)("div",{className:"p-8 text-center",children:(0,s.jsx)("p",{className:"text-zinc-500 text-sm",children:"No messages yet. Search for people to start a chat!"})})]})]}),Qn=Hn,Vn=W(),Un=t=>{const e=(0,Vn.c)(7),{className:a}=t;let l;e[0]!==a?(l=X("flex items-center gap-1 px-1 py-1.5",a),e[0]=a,e[1]=l):l=e[1];let i,r,n;e[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsx)("div",{className:"size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse"}),r=(0,s.jsx)("div",{className:"size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse [animation-delay:0.2s]"}),n=(0,s.jsx)("div",{className:"size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse [animation-delay:0.4s]"}),e[2]=i,e[3]=r,e[4]=n):(i=e[2],r=e[3],n=e[4]);let o;return e[5]!==l?(o=(0,s.jsxs)("div",{className:l,children:[i,r,n]}),e[5]=l,e[6]=o):o=e[6],o},Kn=Un,yt=W();function Is(t){const e=(0,yt.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let l;return e[2]!==a?(l=(0,s.jsx)(Ea,{"data-slot":"popover",...a}),e[2]=a,e[3]=l):l=e[3],l}function Es(t){const e=(0,yt.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let l;return e[2]!==a?(l=(0,s.jsx)(qa,{"data-slot":"popover-trigger",...a}),e[2]=a,e[3]=l):l=e[3],l}function Ts(t){const e=(0,yt.c)(12);let a,l,i,r;e[0]!==t?({className:a,align:i,sideOffset:r,...l}=t,e[0]=t,e[1]=a,e[2]=l,e[3]=i,e[4]=r):(a=e[1],l=e[2],i=e[3],r=e[4]);const n=i===void 0?"center":i,o=r===void 0?4:r;let c;e[5]!==a?(c=X("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 rounded-md border p-4 shadow-md outline-hidden",a),e[5]=a,e[6]=c):c=e[6];let d;return e[7]!==n||e[8]!==l||e[9]!==o||e[10]!==c?(d=(0,s.jsx)(cl,{children:(0,s.jsx)(Ja,{"data-slot":"popover-content",align:n,sideOffset:o,className:c,...l})}),e[7]=n,e[8]=l,e[9]=o,e[10]=c,e[11]=d):d=e[11],d}var Te=W();function Jn(t){const e=(0,Te.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let l;return e[2]!==a?(l=(0,s.jsx)(Ya,{"data-slot":"context-menu",...a}),e[2]=a,e[3]=l):l=e[3],l}function Gn(t){const e=(0,Te.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let l;return e[2]!==a?(l=(0,s.jsx)(Ia,{"data-slot":"context-menu-trigger",...a}),e[2]=a,e[3]=l):l=e[3],l}function Xn(t){const e=(0,Te.c)(8);let a,l;e[0]!==t?({className:a,...l}=t,e[0]=t,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let i;e[3]!==a?(i=X("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",a),e[3]=a,e[4]=i):i=e[4];let r;return e[5]!==l||e[6]!==i?(r=(0,s.jsx)(Pa,{children:(0,s.jsx)(Za,{"data-slot":"context-menu-content",className:i,...l})}),e[5]=l,e[6]=i,e[7]=r):r=e[7],r}function nt(t){const e=(0,Te.c)(12);let a,l,i,r;e[0]!==t?({className:a,inset:l,variant:r,...i}=t,e[0]=t,e[1]=a,e[2]=l,e[3]=i,e[4]=r):(a=e[1],l=e[2],i=e[3],r=e[4]);const n=r===void 0?"default":r;let o;e[5]!==a?(o=X("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),e[5]=a,e[6]=o):o=e[6];let c;return e[7]!==l||e[8]!==i||e[9]!==o||e[10]!==n?(c=(0,s.jsx)(al,{"data-slot":"context-menu-item","data-inset":l,"data-variant":n,className:o,...i}),e[7]=l,e[8]=i,e[9]=o,e[10]=n,e[11]=c):c=e[11],c}function Zn(t){const e=(0,Te.c)(10);let a,l,i;e[0]!==t?({className:a,inset:l,...i}=t,e[0]=t,e[1]=a,e[2]=l,e[3]=i):(a=e[1],l=e[2],i=e[3]);let r;e[4]!==a?(r=X("text-foreground px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",a),e[4]=a,e[5]=r):r=e[5];let n;return e[6]!==l||e[7]!==i||e[8]!==r?(n=(0,s.jsx)(Ba,{"data-slot":"context-menu-label","data-inset":l,className:r,...i}),e[6]=l,e[7]=i,e[8]=r,e[9]=n):n=e[9],n}function Bt(t){const e=(0,Te.c)(8);let a,l;e[0]!==t?({className:a,...l}=t,e[0]=t,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let i;e[3]!==a?(i=X("bg-border -mx-1 my-1 h-px",a),e[3]=a,e[4]=i):i=e[4];let r;return e[5]!==l||e[6]!==i?(r=(0,s.jsx)(rl,{"data-slot":"context-menu-separator",className:i,...l}),e[5]=l,e[6]=i,e[7]=r):r=e[7],r}var Yn=W(),eo=t=>{const e=(0,Yn.c)(10),{onEmojiSelect:a,className:l}=t;let i;e[0]!==l?(i=X("isolate flex h-[350px] w-[320px] flex-col overflow-hidden rounded-xl border border-zinc-200 bg-white shadow-xl dark:border-zinc-800 dark:bg-zinc-950",l),e[0]=l,e[1]=i):i=e[1];let r;e[2]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsx)(Fe.Search,{className:"z-10 mx-3 mt-3 appearance-none rounded-lg border-none bg-zinc-100 px-3 py-2 text-sm outline-none placeholder:text-zinc-500 focus:ring-1 focus:ring-violet-500 dark:bg-zinc-900 dark:text-white",placeholder:"Search emojis..."}),e[2]=r):r=e[2];let n,o;e[3]===Symbol.for("react.memo_cache_sentinel")?(n=(0,s.jsx)(Fe.Loading,{className:"absolute inset-0 flex items-center justify-center text-zinc-400 text-sm dark:text-zinc-500",children:"Loadingâ€¦"}),o=(0,s.jsx)(Fe.Empty,{className:"absolute inset-0 flex items-center justify-center text-zinc-400 text-sm dark:text-zinc-500",children:"No emoji found."}),e[3]=n,e[4]=o):(n=e[3],o=e[4]);let c,d;e[5]===Symbol.for("react.memo_cache_sentinel")?(c=(0,s.jsxs)(Fe.Viewport,{className:"relative flex-1 outline-none no-scrollbar",children:[n,o,(0,s.jsx)(Fe.List,{className:"select-none pb-2",components:{CategoryHeader:so,Row:ao,Emoji:lo}})]}),d=(0,s.jsx)(Fe.ActiveEmoji,{children:io}),e[5]=c,e[6]=d):(c=e[5],d=e[6]);let m;return e[7]!==a||e[8]!==i?(m=(0,s.jsxs)(Fe.Root,{onEmojiSelect:a,className:i,children:[r,c,d]}),e[7]=a,e[8]=i,e[9]=m):m=e[9],m},to=eo;function so(t){const{category:e,...a}=t;return(0,s.jsx)("div",{className:"bg-white/80 px-4 pt-4 pb-1.5 font-bold text-zinc-500 text-[11px] uppercase tracking-wider backdrop-blur-sm dark:bg-zinc-950/80 dark:text-zinc-400",...a,children:e.label})}function ao(t){const{children:e,...a}=t;return(0,s.jsx)("div",{className:"scroll-my-1 px-2",...a,children:e})}function lo(t){const{emoji:e,...a}=t;return(0,s.jsx)("button",{className:"flex aspect-square size-9 items-center justify-center rounded-lg text-xl transition-colors hover:bg-zinc-100 data-[active]:bg-violet-500/10 data-[active]:text-violet-500 dark:hover:bg-zinc-900 dark:data-[active]:bg-violet-500/20",...a,children:e.emoji})}function io(t){const{emoji:e}=t;return(0,s.jsx)("div",{className:"flex items-center gap-3 border-t border-zinc-100 p-3 dark:border-zinc-800",children:e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"text-2xl",children:e.emoji}),(0,s.jsx)("span",{className:"text-xs font-bold text-zinc-600 dark:text-zinc-400 truncate",children:e.label.replace(/:/g,"").replace(/_/g," ")})]}):(0,s.jsx)("span",{className:"text-xs font-medium text-zinc-400",children:"Select an emoji..."})})}var ro=W(),no=["â¤ï¸","ðŸ˜‚","ðŸ˜®","ðŸ˜¢","ðŸ™","ðŸ‘"],oo=t=>{const e=(0,ro.c)(6),{onSelect:a,currentReaction:l}=t;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsx)(Es,{asChild:!0,children:(0,s.jsx)("button",{className:"p-1.5 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-300 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full transition-all active:scale-90",onClick:mo,children:(0,s.jsx)(as,{size:16})})}),e[0]=i):i=e[0];let r;e[1]!==l||e[2]!==a?(r=no.map(o=>(0,s.jsx)("button",{onClick:()=>a(o),className:`text-xl p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full transition-all active:scale-125 ${l===o?"bg-zinc-100 dark:bg-zinc-800":""}`,children:o},o)),e[1]=l,e[2]=a,e[3]=r):r=e[3];let n;return e[4]!==r?(n=(0,s.jsxs)(Is,{children:[i,(0,s.jsx)(Ts,{side:"top",align:"center",className:"w-fit p-1 rounded-full bg-white dark:bg-zinc-900 border border-zinc-100 dark:border-zinc-800 shadow-xl",onClick:uo,children:(0,s.jsx)("div",{className:"flex items-center gap-1",children:r})})]}),e[4]=r,e[5]=n):n=e[5],n},co=oo;function mo(t){return t.stopPropagation()}function uo(t){return t.stopPropagation()}var fo=W(),xo=t=>{const e=(0,fo.c)(10),{reactions:a,currentUser:l,onToggle:i}=t;let r;e[0]!==a?(r=a===void 0?[]:a,e[0]=a,e[1]=r):r=e[1];const n=r;let o;e[2]!==l?.id||e[3]!==n?(o={},n.forEach(u=>{o[u.emoji]||(o[u.emoji]={count:0,me:!1}),o[u.emoji].count=o[u.emoji].count+1,u.user_id===l?.id&&(o[u.emoji].me=!0)}),e[2]=l?.id,e[3]=n,e[4]=o):o=e[4];const c=o;if(n.length===0)return null;let d;e[5]!==c?(d=Object.entries(c),e[5]=c,e[6]=d):d=e[6];let m;return e[7]!==i||e[8]!==d?(m=(0,s.jsx)("div",{className:"flex flex-wrap gap-1 mt-1 px-2",children:d.map(u=>{const[f,x]=u;return(0,s.jsxs)("button",{onClick:p=>{p.stopPropagation(),i(f)},className:`flex items-center gap-1.5 px-2 py-0.5 rounded-full text-xs font-medium border transition-all active:scale-90 ${x.me?"bg-violet-50 border-violet-200 text-violet-600 dark:bg-violet-900/30 dark:border-violet-800 dark:text-violet-400":"bg-white border-zinc-100 text-zinc-600 dark:bg-zinc-900 dark:border-zinc-800 dark:text-zinc-400"}`,children:[(0,s.jsx)("span",{children:f}),x.count>1&&(0,s.jsx)("span",{children:x.count})]},f)})}),e[7]=i,e[8]=d,e[9]=m):m=e[9],m},ho=xo,po=["â¤ï¸","ðŸ˜‚","ðŸ˜®","ðŸ˜¢","ðŸ™","ðŸ‘"],bo=({conversation:t,messages:e,onBack:a,onSendMessage:l,onToggleReaction:i,onDeleteMessage:r,currentUser:n,onTyping:o,isLoading:c,isTyping:d,isOnline:m})=>{const{openLightbox:u}=bt(),[f,x]=(0,g.useState)(""),[p,h]=(0,g.useState)(!1),[b,v]=(0,g.useState)([]),[j,k]=(0,g.useState)(!1),[N,w]=(0,g.useState)(null),_=(0,g.useRef)(null),S=(0,g.useRef)(null),z=(0,g.useRef)(null),$=Rs(t.user?.lastSeen);(0,g.useEffect)(()=>{S.current&&(S.current.scrollTop=S.current.scrollHeight)},[e,d]);const P=y=>{const C=y.target.value;x(C),o&&(o(!0),z.current&&clearTimeout(z.current),z.current=setTimeout(()=>{o(!1)},2e3))},F=y=>{x(C=>C+y.emoji)},M=y=>{y.preventDefault(),!(!f.trim()&&b.length===0)&&(o&&(clearTimeout(z.current),o(!1)),l(t.id,f,b.length>0?"image":"text",b,N?.id),x(""),v([]),w(null))},L=async y=>{const C=Array.from(y.target.files);if(C.length!==0){h(!0);try{const E=await Promise.all(C.map(D=>ze(D)));v(D=>[...D,...E])}catch(E){console.error("Upload failed:",E)}finally{h(!1)}}},R=y=>{v(C=>C.filter(E=>E.url!==y))},O=y=>{!y.media||y.media.length===0||u(y.media.map(C=>C.url),0)},q=(0,g.useMemo)(()=>{const y=e.filter(C=>C.sender==="me");return y.length>0?y[y.length-1].id:null},[e]),I=y=>e.find(C=>C.id===y);return(0,s.jsxs)("div",{className:"flex-1 flex flex-col h-full min-w-0 bg-white dark:bg-black md:border-l md:border-zinc-100 dark:md:border-zinc-800",children:[(0,s.jsxs)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800 flex items-center justify-between shrink-0 bg-white/80 dark:bg-black/80 backdrop-blur-md sticky top-0 z-10",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("button",{onClick:a,className:"md:hidden p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:(0,s.jsx)(Be,{size:20})}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)(ue,{className:"size-10 border border-zinc-200 dark:border-zinc-700",children:[(0,s.jsx)(fe,{src:t.user.avatar,alt:t.user.name,className:"object-cover"}),(0,s.jsx)(xe,{children:t.user.name?.[0]?.toUpperCase()})]}),m&&(0,s.jsx)("span",{className:"absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-bold dark:text-white",children:t.user.name}),m?(0,s.jsxs)("div",{className:"text-xs text-emerald-500 font-medium flex items-center gap-1",children:[(0,s.jsx)("span",{className:"size-1.5 bg-emerald-500 rounded-full animate-pulse"}),"Online"]}):(0,s.jsx)("div",{className:"text-xs text-zinc-500 font-medium",children:t.user.lastSeen?`Last seen ${$}`:"Offline"})]})]}),(0,s.jsx)("button",{className:"p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full dark:text-zinc-400",children:(0,s.jsx)(ia,{size:20})})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",ref:S,children:[(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsxs)("div",{className:"relative w-fit mx-auto",children:[(0,s.jsxs)(ue,{className:"size-20 mx-auto mb-3 border-4 border-zinc-50 dark:border-zinc-900 shadow-sm",children:[(0,s.jsx)(fe,{src:t.user.avatar,alt:t.user.name,className:"object-cover"}),(0,s.jsx)(xe,{className:"text-2xl font-bold",children:t.user.name?.[0]?.toUpperCase()})]}),m&&(0,s.jsx)("span",{className:"absolute bottom-4 right-1 size-5 bg-emerald-500 border-4 border-white dark:border-black rounded-full animate-in zoom-in duration-300"})]}),(0,s.jsx)("h4",{className:"font-bold dark:text-white text-lg",children:t.user.name}),(0,s.jsxs)("p",{className:"text-sm text-zinc-500",children:["@",t.user.handle]}),(0,s.jsxs)("p",{className:"text-xs text-zinc-400 mt-4 max-w-xs mx-auto",children:["This is the beginning of your direct message history with"," ",(0,s.jsxs)("span",{className:"font-bold",children:["@",t.user.handle]})]})]}),c&&e.length===0?(0,s.jsx)("div",{className:"flex justify-center p-8",children:(0,s.jsx)(re,{className:"animate-spin text-violet-500",size:32})}):e.map(y=>(0,s.jsxs)(Jn,{children:[(0,s.jsx)(Gn,{asChild:!0,children:(0,s.jsxs)("div",{id:`msg-${y.id}`,className:`flex items-end gap-2 group ${y.sender==="me"?"flex-row-reverse":"flex-row"}`,children:[(0,s.jsxs)("div",{className:`max-w-[75%] p-1 rounded-2xl text-[15px] shadow-sm relative ${y.sender==="me"?"bg-violet-600 text-white rounded-tr-none":"bg-zinc-100 dark:bg-zinc-800 dark:text-white rounded-tl-none"}`,children:[y.replyToId&&(0,s.jsxs)("div",{className:`mb-2 p-2 rounded-lg border-l-4 text-xs truncate cursor-pointer ${y.sender==="me"?"bg-violet-500/50 border-violet-300 text-violet-100":"bg-zinc-200/50 dark:bg-zinc-700/50 border-zinc-400 dark:border-zinc-500 text-zinc-600 dark:text-zinc-300"}`,onClick:C=>{C.stopPropagation(),document.getElementById(`msg-${y.replyToId}`)?.scrollIntoView({behavior:"smooth",block:"center"})},children:[(0,s.jsx)("span",{className:"font-bold block mb-0.5",children:I(y.replyToId)?.sender==="me"?"You":t.user.name}),I(y.replyToId)?.text||"Media"]}),y.media?.length>0&&(0,s.jsx)("div",{className:"mb-2 grid gap-1 grid-cols-1 overflow-hidden rounded-lg cursor-pointer",onClick:()=>O(y),children:y.media.map((C,E)=>(0,s.jsx)("img",{src:C.url,alt:"",className:"max-h-60 w-full object-cover rounded-md hover:brightness-90 transition-all"},E))}),y.text&&(0,s.jsx)("p",{className:"m-0 leading-tight px-3 py-1",children:y.text}),y.reactions?.length>0&&(0,s.jsx)(ho,{reactions:y.reactions,currentUser:n,onToggle:C=>i(y.id,C)}),(0,s.jsxs)("div",{className:`text-[10px] flex items-center justify-end gap-1 px-3 pb-1 ${y.sender==="me"?"text-violet-200":"text-zinc-400"}`,children:[y.time,y.sender==="me"&&y.id===q&&(0,s.jsx)("span",{className:"ml-0.5",children:y.isRead?(0,s.jsx)(oa,{size:14,className:"text-white"}):(0,s.jsx)(ta,{size:14,className:"text-violet-200"})})]})]}),(0,s.jsx)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)(co,{onSelect:C=>i(y.id,C),currentReaction:y.reactions?.find(C=>C.user_id===n?.id)?.emoji})})]})}),(0,s.jsxs)(Xn,{className:"w-64 rounded-xl bg-white dark:bg-zinc-950 border-zinc-100 dark:border-zinc-800 shadow-xl",children:[(0,s.jsx)(Zn,{className:"text-xs text-zinc-500 font-bold px-3 py-2",children:"QUICK REACTION"}),(0,s.jsx)("div",{className:"flex items-center justify-between px-2 pb-2",children:po.map(C=>(0,s.jsx)("button",{onClick:()=>i(y.id,C),className:"text-xl p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full transition-all active:scale-125",children:C},C))}),(0,s.jsx)(Bt,{className:"bg-zinc-100 dark:bg-zinc-800"}),(0,s.jsxs)(nt,{className:"gap-3 px-3 py-2.5 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-900",onClick:()=>{navigator.clipboard.writeText(y.text)},children:[(0,s.jsx)(gl,{size:16,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"font-medium",children:"Copy Text"})]}),(0,s.jsxs)(nt,{className:"gap-3 px-3 py-2.5 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-900",onClick:()=>w(y),children:[(0,s.jsx)(Aa,{size:16,className:"text-zinc-500"}),(0,s.jsx)("span",{className:"font-medium",children:"Reply"})]}),(0,s.jsx)(Bt,{className:"bg-zinc-100 dark:bg-zinc-800"}),(0,s.jsxs)(nt,{className:"gap-3 px-3 py-2.5 cursor-pointer text-rose-500 focus:text-rose-500 focus:bg-rose-50 dark:focus:bg-rose-900/20",onClick:()=>r(y.id),children:[(0,s.jsx)(Ma,{size:16}),(0,s.jsx)("span",{className:"font-medium",children:"Delete message"})]})]})]},y.id)),d&&(0,s.jsx)("div",{className:"flex justify-start animate-in fade-in slide-in-from-bottom-2 duration-300",children:(0,s.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-800/50 px-3 py-2 rounded-2xl rounded-tl-none border border-zinc-200/50 dark:border-zinc-700/30 shadow-sm",children:(0,s.jsx)(Kn,{})})})]}),(0,s.jsxs)("div",{className:"p-4 border-t border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black shrink-0",children:[N&&(0,s.jsxs)("div",{className:"mb-3 p-3 bg-zinc-50 dark:bg-zinc-900 border border-zinc-100 dark:border-zinc-800 rounded-xl flex items-center justify-between animate-in slide-in-from-bottom-2 duration-200",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("span",{className:"text-xs font-bold text-violet-600 dark:text-violet-400 block mb-1",children:["Replying to"," ",N.sender==="me"?"yourself":t.user.name]}),(0,s.jsx)("p",{className:"text-sm text-zinc-500 truncate",children:N.text||"Media"})]}),(0,s.jsx)("button",{onClick:()=>w(null),className:"p-1 hover:bg-zinc-200 dark:hover:bg-zinc-800 rounded-full text-zinc-400 transition-colors",children:(0,s.jsx)(be,{size:18})})]}),b.length>0&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 mb-3",children:[b.map(y=>(0,s.jsxs)("div",{className:"relative size-16 rounded-xl overflow-hidden border border-zinc-200 dark:border-zinc-800",children:[(0,s.jsx)("img",{src:y.url,className:"size-full object-cover",alt:""}),(0,s.jsx)("button",{type:"button",onClick:()=>R(y.url),className:"absolute top-1 right-1 bg-black/50 text-white rounded-full p-0.5 hover:bg-black transition-colors",children:(0,s.jsx)(be,{size:12})})]},y.url)),p&&(0,s.jsx)("div",{className:"size-16 rounded-xl bg-zinc-100 dark:bg-zinc-900 flex items-center justify-center",children:(0,s.jsx)(re,{className:"animate-spin text-violet-500",size:20})})]}),(0,s.jsxs)("form",{onSubmit:M,className:"flex items-center gap-2 bg-zinc-100 dark:bg-zinc-900 p-2 rounded-2xl border border-transparent focus-within:border-violet-500 transition-all",children:[(0,s.jsxs)(Is,{open:j,onOpenChange:k,children:[(0,s.jsx)(Es,{asChild:!0,children:(0,s.jsx)("button",{type:"button",className:"p-2 text-zinc-500 hover:text-violet-600 transition-colors",children:(0,s.jsx)(as,{size:20})})}),(0,s.jsx)(Ts,{className:"w-fit p-0 border-none bg-transparent shadow-none",side:"top",align:"start",sideOffset:10,children:(0,s.jsx)(to,{onEmojiSelect:y=>{F(y)}})})]}),(0,s.jsx)("input",{type:"text",className:"flex-1 min-w-0 bg-transparent border-none outline-none dark:text-white py-1 px-1",placeholder:"Start a new message",value:f,onChange:P}),(0,s.jsx)("input",{type:"file",ref:_,onChange:L,className:"hidden",multiple:!0,accept:"image/*"}),(0,s.jsx)("button",{type:"button",onClick:()=>_.current?.click(),className:"p-2 text-zinc-500 hover:text-violet-600 transition-colors",disabled:p,children:(0,s.jsx)(is,{size:20})}),(0,s.jsx)(pe,{type:"submit",className:"size-10 !p-0 rounded-xl",disabled:!f.trim()&&b.length===0||p,children:(0,s.jsx)(dl,{size:18})})]})]})]})},go=bo,vo=W(),jo=()=>{const t=(0,vo.c)(73),{id:e}=ft(),a=we(),{currentUser:l}=he(),{onlineUsers:i}=hs(),r=Ze(),[n,o]=(0,g.useState)("");let c;t[0]===Symbol.for("react.memo_cache_sentinel")?(c=[],t[0]=c):c=t[0];const[d,m]=(0,g.useState)(c),{conversations:u,isConvLoading:f,sendMessage:x,sendTypingStatus:p,typingStatus:h,markAsRead:b,formatMessages:v,onToggleReaction:j,allReactions:k}=gt(l);let N;e:{if(!e||u.length===0){N=null;break e}let J;t[1]!==u||t[2]!==e?(J=u.find(ne=>ne.id===e)||null,t[1]=u,t[2]=e,t[3]=J):J=t[3],N=J}const w=N;let _,S;t[4]!==e||t[5]!==b?(_=()=>{e&&b(e)},S=[e,b],t[4]=e,t[5]=b,t[6]=_,t[7]=S):(_=t[6],S=t[7]),(0,g.useEffect)(_,S);let z;t[8]!==u||t[9]!==l?.id||t[10]!==n?(z=()=>{const J=setTimeout(async()=>{if(n.length>1){const ne=await Sl(n),Ce=u.map(wo);m(ne.filter(qe=>qe.id!==l?.id&&!Ce.includes(qe.id)))}else m([])},300);return()=>clearTimeout(J)},t[8]=u,t[9]=l?.id,t[10]=n,t[11]=z):z=t[11];const $=l?.id;let P;t[12]!==u||t[13]!==n||t[14]!==$?(P=[n,u,$],t[12]=u,t[13]=n,t[14]=$,t[15]=P):P=t[15],(0,g.useEffect)(z,P);let F;t[16]!==l||t[17]!==a||t[18]!==r?(F=async J=>{try{const ne=await us(l.id,J.id);r.invalidateQueries({queryKey:["conversations",l.id]}),o(""),a(`/messages/${ne}`)}catch(ne){console.error("Failed to start conversation:",ne)}},t[16]=l,t[17]=a,t[18]=r,t[19]=F):F=t[19];const M=F;let L;t[20]!==a?(L=J=>{a(`/messages/${J.id}`)},t[20]=a,t[21]=L):L=t[21];const R=L,O=w?.id;let q;t[22]!==O?(q=["messages",O],t[22]=O,t[23]=q):q=t[23];let I;t[24]!==w?.id?(I=()=>Yl(w?.id),t[24]=w?.id,t[25]=I):I=t[25];const y=!!w?.id;let C;t[26]!==q||t[27]!==I||t[28]!==y?(C={queryKey:q,queryFn:I,enabled:y},t[26]=q,t[27]=I,t[28]=y,t[29]=C):C=t[29];const{data:E,isLoading:D}=Le(C);let U;t[30]!==E?(U=E===void 0?[]:E,t[30]=E,t[31]=U):U=t[31];const B=U;let Y;t[32]!==k||t[33]!==B||t[34]!==v?(Y=v(B,k),t[32]=k,t[33]=B,t[34]=v,t[35]=Y):Y=t[35];const G=Y;if(!l){let J;return t[36]===Symbol.for("react.memo_cache_sentinel")?(J=(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-screen gap-4 p-8 text-center bg-white dark:bg-black md:rounded-xl md:border border-zinc-100 dark:border-zinc-800",children:[(0,s.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-900 p-4 rounded-full",children:(0,s.jsx)(ha,{size:40,className:"text-zinc-400"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"Sign in to message others"}),(0,s.jsx)("p",{className:"text-zinc-500 max-w-xs",children:"Start decentralized conversations with anyone on the network."})]}),t[36]=J):J=t[36],J}if(f){let J;return t[37]===Symbol.for("react.memo_cache_sentinel")?(J=(0,s.jsx)("div",{className:"flex h-screen items-center justify-center bg-white dark:bg-black md:rounded-xl md:border border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)(re,{className:"animate-spin text-violet-500",size:32})}),t[37]=J):J=t[37],J}let te;if(t[38]!==u||t[39]!==n){let J;t[41]!==n?(J=ne=>ne.user?.name?.toLowerCase().includes(n.toLowerCase())||ne.user?.handle?.toLowerCase().includes(n.toLowerCase())||ne.lastMessage?.toLowerCase().includes(n.toLowerCase()),t[41]=n,t[42]=J):J=t[42],te=u.filter(J),t[38]=u,t[39]=n,t[40]=te}else te=t[40];const se=te,ie=w&&h[w.id];let de;t[43]!==i||t[44]!==w?(de=w&&i.has(w.user?.id),t[43]=i,t[44]=w,t[45]=de):de=t[45];const ce=de,me=`flex ${e?"h-[100dvh]":"h-[calc(100dvh-4rem)]"} md:h-[calc(100vh-2rem)] bg-white dark:bg-black overflow-hidden md:rounded-xl md:border border-zinc-100 dark:border-zinc-800`,Z=`w-full md:w-80 flex flex-col border-r border-zinc-100 dark:border-zinc-800 ${w?"hidden md:flex":"flex"}`;let ee;t[46]===Symbol.for("react.memo_cache_sentinel")?(ee=(0,s.jsx)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)("h2",{className:"text-xl font-bold dark:text-white",children:"Messages"})}),t[46]=ee):ee=t[46];let A;t[47]!==se||t[48]!==R||t[49]!==M||t[50]!==e||t[51]!==n||t[52]!==i||t[53]!==d?(A=(0,s.jsx)(Qn,{conversations:se,userResults:d,onSelect:R,onStartNew:M,selectedId:e,searchQuery:n,onSearchChange:o,onlineUsers:i}),t[47]=se,t[48]=R,t[49]=M,t[50]=e,t[51]=n,t[52]=i,t[53]=d,t[54]=A):A=t[54];let Q;t[55]!==Z||t[56]!==A?(Q=(0,s.jsxs)("div",{className:Z,children:[ee,A]}),t[55]=Z,t[56]=A,t[57]=Q):Q=t[57];let H;t[58]!==ie||t[59]!==l||t[60]!==D||t[61]!==G||t[62]!==a||t[63]!==j||t[64]!==ce||t[65]!==w||t[66]!==x||t[67]!==p?(H=w?(0,s.jsx)(go,{conversation:w,messages:G,onBack:()=>a("/messages"),onSendMessage:x,onToggleReaction:j,currentUser:l,onTyping:J=>p(w.id,J),isLoading:D,isTyping:ie,isOnline:ce}):(0,s.jsxs)("div",{className:"hidden md:flex flex-1 items-center justify-center text-zinc-500 flex-col gap-4",children:[(0,s.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full",children:(0,s.jsx)(Ge,{size:48,className:"text-zinc-300"})}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-zinc-900 dark:text-white",children:"Select a message"}),(0,s.jsx)("p",{children:"Choose from your existing conversations or start a new one."})]})]}),t[58]=ie,t[59]=l,t[60]=D,t[61]=G,t[62]=a,t[63]=j,t[64]=ce,t[65]=w,t[66]=x,t[67]=p,t[68]=H):H=t[68];let ae;return t[69]!==me||t[70]!==Q||t[71]!==H?(ae=(0,s.jsxs)("div",{className:me,children:[Q,H]}),t[69]=me,t[70]=Q,t[71]=H,t[72]=ae):ae=t[72],ae},Wt=jo;function wo(t){return t.user?.id}var yo=()=>{const{currentUser:t}=he(),e=we(),[a,l]=(0,g.useState)([]),[i,r]=(0,g.useState)(!0),[n,o]=(0,g.useState)(!1),[c,d]=(0,g.useState)(!0),m=(0,g.useRef)(a);(0,g.useEffect)(()=>{m.current=a},[a]);const u=(0,g.useCallback)(async(h=!1)=>{if(t?.id){h?o(!0):r(!0);try{const b=m.current,v=h&&b.length>0?b[b.length-1].created_at:null,j=await li(t.id,v,10);j.length<10?d(!1):d(!0),l(h?k=>[...k,...j]:j)}catch(b){console.error("Failed to fetch notifications:",b)}finally{r(!1),o(!1)}}},[t?.id]);(0,g.useEffect)(()=>{u()},[u]),(0,g.useEffect)(()=>{if(!t?.id)return;const h=T.channel(`user_notifications:${t.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`recipient_id=eq.${t.id}`},()=>{u()}).subscribe();return()=>T.removeChannel(h)},[t?.id,u]);const f=cs({mutationFn:()=>ii(t.id),onSuccess:()=>{l(h=>h.map(b=>({...b,is_read:!0})))}}),x=h=>{h.type==="follow"?e(`/u/${h.user}`):h.post_id&&e(`/post/${h.post_id}`)};if((0,g.useEffect)(()=>{t?.id&&a.some(h=>!h.is_read)&&f.mutate()},[t?.id,a,f]),i)return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,s.jsx)(re,{size:32,className:"animate-spin text-violet-500"})});if(!t)return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[400px] gap-4 p-8 text-center",children:[(0,s.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-900 p-4 rounded-full",children:(0,s.jsx)(it,{size:40,className:"text-zinc-400"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"Sign in to see notifications"}),(0,s.jsx)("p",{className:"text-zinc-500 max-w-xs",children:"Join the conversation and keep track of who's engaging with your content."})]});const p=h=>{switch(h){case"like":return(0,s.jsx)(De,{size:20,className:"text-rose-500 fill-rose-500"});case"follow":return(0,s.jsx)(ns,{size:20,className:"text-blue-500"});case"mention":return(0,s.jsx)(it,{size:20,className:"text-emerald-500"});case"comment":return(0,s.jsx)(Ra,{size:20,className:"text-violet-500"});case"repost":return(0,s.jsx)(Xs,{size:20,className:"text-amber-500"});default:return(0,s.jsx)(it,{size:20,className:"text-zinc-500"})}};return(0,s.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm",children:[(0,s.jsx)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800 sticky top-0 bg-white/80 dark:bg-black/80 backdrop-blur-md z-10",children:(0,s.jsx)("h2",{className:"text-xl font-bold dark:text-white",children:"Notifications"})}),a.length>0?a.map(h=>(0,s.jsxs)("div",{onClick:()=>x(h),className:`p-4 border-b border-zinc-100 dark:border-zinc-800 flex items-start gap-4 hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors cursor-pointer ${h.is_read?"":"bg-violet-50/30 dark:bg-violet-500/5"}`,children:[(0,s.jsx)("div",{className:"shrink-0 pt-1",children:p(h.type)}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-1",children:[(0,s.jsxs)(ue,{className:"size-8",children:[(0,s.jsx)(fe,{src:h.avatar}),(0,s.jsx)(xe,{children:h.user?.[0]?.toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex-1 flex justify-between items-center",children:[(0,s.jsxs)("span",{className:"font-bold text-sm dark:text-white truncate",children:["@",h.user]}),(0,s.jsx)("span",{className:"text-zinc-500 text-xs whitespace-nowrap",children:Ve(h.created_at)})]})]}),(0,s.jsxs)("p",{className:"text-zinc-600 dark:text-zinc-400 text-[15px] ml-11",children:[h.type==="like"&&"liked your post",h.type==="follow"&&"followed you",h.type==="mention"&&"mentioned you in a post",h.type==="comment"&&"commented on your post",h.type==="repost"&&"reposted your post"]})]}),!h.is_read&&(0,s.jsx)("div",{className:"size-2 rounded-full bg-violet-500 mt-2 shrink-0 shadow-[0_0_8px_rgba(139,92,246,0.5)]"})]},h.id)):(0,s.jsx)("div",{className:"p-16 text-center text-zinc-500",children:(0,s.jsx)("p",{className:"font-medium",children:"No notifications yet."})}),a.length>0&&c&&(0,s.jsx)("div",{className:"p-6 flex justify-center border-t border-zinc-100 dark:border-zinc-800",children:(0,s.jsxs)(pe,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>u(!0),disabled:n,children:[n?(0,s.jsx)(re,{size:18,className:"animate-spin mr-2"}):null,"Load more"]})}),a.length>0&&!c&&(0,s.jsx)("div",{className:"p-8 text-center text-zinc-500 text-sm",children:"You've caught up with everything!"})]})},No=yo,zo=({profile:t,currentUser:e,isCurrentUser:a,onEditProfile:l,showToast:i,isCommunity:r,onShowFollowers:n,onShowFollowing:o})=>{const{isFollowing:c,stats:d,loading:m,handleFollow:u}=Ps(t,e?.id,i),f=we(),[x,p]=(0,g.useState)(!1),h=async()=>{if(!e){i("Please sign in to message users");return}p(!0);try{f(`/messages/${await us(e.id,t.id)}`)}catch(b){console.error("Failed to start conversation:",b),i("Failed to open chat")}finally{p(!1)}};return(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("div",{className:"relative h-32 sm:h-48 w-full bg-zinc-200 dark:bg-zinc-800",children:[t.cover&&(0,s.jsx)("img",{src:t.cover,className:"h-full w-full object-cover transition-opacity duration-500",alt:"Cover"}),(0,s.jsx)("div",{className:"absolute -bottom-12 sm:-bottom-16 left-4 sm:left-6",children:(0,s.jsx)("div",{className:"p-1 bg-white dark:bg-black rounded-full overflow-hidden shadow-xl ring-4 ring-white dark:ring-black relative",children:(0,s.jsxs)(ue,{className:"size-24 sm:size-32",children:[(0,s.jsx)(fe,{src:t.avatar,alt:t.handle,className:"object-cover"}),(0,s.jsx)(xe,{className:"text-4xl font-bold",children:t.handle?.[0]?.toUpperCase()})]})})})]}),(0,s.jsxs)("div",{className:"flex flex-col p-4 sm:p-6 pt-16 sm:pt-20 space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsx)("div",{className:"flex-1 min-w-0 pr-4"}),(0,s.jsx)("div",{className:"flex gap-2 shrink-0",children:a?(0,s.jsx)(pe,{variant:"secondary",onClick:()=>l(t),className:"text-sm px-5",children:"Edit profile"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:h,disabled:x,className:"rounded-full p-2 border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 dark:border-zinc-800 transition-colors disabled:opacity-50",children:x?(0,s.jsx)(re,{size:20,className:"animate-spin"}):(0,s.jsx)(Ge,{size:20})}),(0,s.jsx)("button",{className:"rounded-full p-2 border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 dark:border-zinc-800 transition-colors",children:(0,s.jsx)(ut,{size:20})}),(0,s.jsx)(pe,{variant:c?"secondary":"primary",onClick:u,className:"text-sm px-6 min-w-[100px]",disabled:m,children:m?(0,s.jsx)(re,{size:16,className:"animate-spin mx-auto"}):c?"Following":"Follow"}),(0,s.jsx)("button",{className:"rounded-full p-2 hover:bg-zinc-100 text-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-800 transition-colors",children:(0,s.jsx)(ot,{size:20})})]})})]}),(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsx)("div",{className:"flex items-center gap-1.5",children:(0,s.jsxs)("h3",{className:"text-xl sm:text-2xl font-extrabold truncate dark:text-white flex items-center gap-1",children:[t.name,t.verified&&(0,s.jsx)(Je,{})]})}),!r&&(0,s.jsx)("div",{className:"flex items-center space-x-3",children:(0,s.jsxs)("span",{className:"text-zinc-500 font-medium text-sm px-1.5 py-0.5 -ml-1.5 rounded-md dark:text-zinc-400",children:["@",t.handle]})})]}),(0,s.jsx)("div",{className:"whitespace-pre-line text-zinc-900 dark:text-zinc-100 leading-relaxed text-sm sm:text-[15px]",children:t.bio}),(t.website||t.location)&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-x-5 gap-y-2 text-sm pt-1",children:[t.location&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)(Zt,{size:14}),(0,s.jsx)("span",{children:t.location})]}),t.website&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)(Yt,{size:14}),(0,s.jsx)("a",{href:`https://${t.website}`,target:"_blank",rel:"noreferrer",className:"text-violet-600 hover:underline font-semibold text-black dark:text-white",children:t.website})]})]}),(0,s.jsx)("div",{className:"flex gap-4 sm:gap-6 text-sm pt-2 relative z-10",children:r?(0,s.jsxs)("button",{className:"flex gap-x-1 hover:underline group cursor-pointer",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white group-hover:text-violet-600",children:t.members}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Members"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:b=>{b.preventDefault(),b.stopPropagation(),o()},className:"flex gap-x-1 hover:underline group cursor-pointer",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white group-hover:text-violet-600",children:d.following}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Following"})]}),(0,s.jsxs)("button",{onClick:b=>{b.preventDefault(),b.stopPropagation(),n()},className:"flex gap-x-1 hover:underline group cursor-pointer",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white group-hover:text-violet-600",children:d.followers}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Followers"})]})]})})]})]})},ko=zo,_o=W(),Co=t=>{const e=(0,_o.c)(20),{title:a,message:l,icon:i,showHome:r,showBack:n}=t,o=a===void 0?"Not Found":a,c=l===void 0?"The content you are looking for doesn't exist or has been removed.":l,d=i===void 0?Ut:i,m=r===void 0?!0:r,u=n===void 0?!0:n,f=we(),x=d;let p;e[0]!==x?(p=(0,s.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-900 p-6 rounded-full mb-6",children:(0,s.jsx)(x,{size:48,className:"text-zinc-400 dark:text-zinc-600"})}),e[0]=x,e[1]=p):p=e[1];let h;e[2]!==o?(h=(0,s.jsx)("h2",{className:"text-2xl font-black mb-2 dark:text-white",children:o}),e[2]=o,e[3]=h):h=e[3];let b;e[4]!==c?(b=(0,s.jsx)("p",{className:"text-zinc-500 dark:text-zinc-400 max-w-xs mb-8 leading-relaxed",children:c}),e[4]=c,e[5]=b):b=e[5];let v;e[6]!==f||e[7]!==u?(v=u&&(0,s.jsxs)(pe,{variant:"secondary",onClick:()=>f(-1),className:"rounded-full px-6",children:[(0,s.jsx)(Be,{size:18,className:"mr-2"}),"Go Back"]}),e[6]=f,e[7]=u,e[8]=v):v=e[8];let j;e[9]!==f||e[10]!==m?(j=m&&(0,s.jsxs)(pe,{onClick:()=>f("/"),className:"bg-zinc-900 dark:bg-white text-white dark:text-zinc-900 rounded-full px-6",children:[(0,s.jsx)(xt,{size:18,className:"mr-2"}),"Home"]}),e[9]=f,e[10]=m,e[11]=j):j=e[11];let k;e[12]!==j||e[13]!==v?(k=(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-center gap-3",children:[v,j]}),e[12]=j,e[13]=v,e[14]=k):k=e[14];let N;return e[15]!==k||e[16]!==p||e[17]!==h||e[18]!==b?(N=(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[400px] p-8 text-center animate-in fade-in zoom-in-95 duration-300",children:[p,h,b,k]}),e[15]=k,e[16]=p,e[17]=h,e[18]=b,e[19]=N):N=e[19],N},qs=Co,So=({onEditProfile:t})=>{const{handle:e}=ft(),a=we(),{profiles:l,currentUser:i,getProfileByHandle:r}=he(),{addToast:n}=_e(),[o,c]=(0,g.useState)(l[e]),[d,m]=(0,g.useState)(!o),[u,f]=(0,g.useState)([]),[x,p]=(0,g.useState)([]),[h,b]=(0,g.useState)("feed"),[v,j]=(0,g.useState)(!0),[k,N]=(0,g.useState)(!1),[w,_]=(0,g.useState)(!0),[S,z]=(0,g.useState)(!1),[$,P]=(0,g.useState)(!0),F=(0,g.useRef)(u),M=(0,g.useRef)(x);(0,g.useEffect)(()=>{F.current=u,M.current=x},[u,x]);const[L,R]=(0,g.useState)(!1),[O,q]=(0,g.useState)("Followers"),[I,y]=(0,g.useState)([]),[C,E]=(0,g.useState)(!1),[D,U]=(0,g.useState)(!1),[B,Y]=(0,g.useState)(!0),G=(0,g.useRef)(I);(0,g.useEffect)(()=>{G.current=I},[I]);const te=(0,g.useCallback)(async(A,Q=!1)=>{if(A){Q?N(!0):j(!0);try{const H=F.current,ae=await Al(A,Q&&H.length>0?H[H.length-1].created_at:null,10);ae.length<10?_(!1):_(!0),f(Q?J=>[...J,...ae]:ae)}catch(H){console.error("Failed to fetch user posts:",H)}finally{j(!1),N(!1)}}},[]),se=(0,g.useCallback)(async(A,Q=!1)=>{if(A){Q?z(!0):j(!0);try{const H=M.current,ae=await Ol(A,Q&&H.length>0?H[H.length-1].created_at:null,10);ae.length<10?P(!1):P(!0),p(Q?J=>[...J,...ae]:ae)}catch(H){console.error("Failed to fetch user replies:",H)}finally{j(!1),z(!1)}}},[]),ie=async(A,Q=!1)=>{const H=o?.id||Z?.id;if(H){Q?U(!0):(q(A),R(!0),E(!0),y([]));try{const ae=G.current,J=Q&&ae.length>0?ae[ae.length-1].followed_at:null,ne=A==="Followers"?await Rl(H,J,10):await Il(H,J,10);ne.length<10?Y(!1):Y(!0),y(Q?Ce=>[...Ce,...ne]:ne)}catch(ae){console.error(`Failed to fetch ${A}:`,ae),n(`Failed to load ${A}`)}finally{E(!1),U(!1)}}};(0,g.useEffect)(()=>{(async()=>{let Q=l[e];Q?c(Q):(m(!0),Q=await r(e),c(Q),m(!1)),Q?.id&&(te(Q.id),se(Q.id))})()},[e,l,r,te,se]);const de=(0,g.useMemo)(()=>h==="feed"?u.filter(A=>A.parent_id===null):h==="media"?u.filter(A=>A.parent_id===null&&(A.type==="video"||A.type==="image"||A.media&&A.media.length>0)):h==="replies"?x:u,[u,x,h]),ce=A=>{a(`/post/${A}`)},me=A=>{A!==e&&a(`/u/${A}`)};if(d)return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)(re,{size:40,className:"animate-spin text-violet-500"})});if(!o)return(0,s.jsx)("div",{className:"bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-[600px] flex items-center justify-center",children:(0,s.jsx)(qs,{title:"Account doesn't exist",message:`Try searching for another. The user @${e} could not be found.`,icon:ol})});const Z=o,ee=()=>v?(0,s.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,s.jsx)(re,{className:"animate-spin text-violet-500",size:32})}):de.length>0?(0,s.jsxs)(s.Fragment,{children:[de.map(A=>(0,s.jsx)(tt,{currentUser:i,showToast:n,...A,onClick:()=>ce(A.id),onUserClick:me,onDelete:Q=>f(H=>H.filter(ae=>ae.id!==Q))},A.feed_id||A.id)),(h==="replies"?$:w)&&(0,s.jsx)("div",{className:"p-6 flex justify-center",children:(0,s.jsxs)(Button,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>h==="replies"?se(o.id,!0):te(o.id,!0),disabled:h==="replies"?S:k,children:[(h==="replies"?S:k)&&(0,s.jsx)(re,{size:18,className:"animate-spin mr-2"}),"Load more ",h==="replies"?"replies":"posts"]})})]}):(0,s.jsxs)("div",{className:"p-20 text-center text-zinc-500 flex flex-col items-center gap-4 animate-in fade-in duration-500",children:[(0,s.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full mb-2 ring-1 ring-zinc-100 dark:ring-zinc-800",children:(0,s.jsx)(ls,{size:40,className:"text-zinc-300 dark:text-zinc-700"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"No posts yet"}),(0,s.jsxs)("p",{className:"text-sm text-zinc-500 dark:text-zinc-400 max-w-[250px]",children:["When @",Z.handle," shares posts, they will appear here."]})]});return(0,s.jsxs)("div",{className:"border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:[(0,s.jsxs)("div",{className:"border-y md:border-b-0 border-zinc-100 dark:border-zinc-800",children:[(0,s.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3 md:hidden",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,s.jsx)("button",{onClick:()=>a(-1),className:"p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:(0,s.jsx)(Be,{size:22})}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("h5",{className:"text-lg font-bold dark:text-white leading-none",children:Z.name}),(0,s.jsxs)("span",{className:"text-xs text-zinc-500 mt-0.5",children:[u.length," Posts"]})]})]})}),(0,s.jsx)(ko,{profile:Z,currentUser:i,isCurrentUser:i?.handle===Z.handle,onEditProfile:t,showToast:n,onShowFollowers:()=>ie("Followers"),onShowFollowing:()=>ie("Following")}),(0,s.jsxs)(Fs,{value:h,onValueChange:b,className:"w-full",children:[(0,s.jsx)("div",{className:"sticky top-[60px] md:top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-10 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)(Ms,{className:"w-full h-auto bg-transparent p-0 rounded-none justify-start px-2",children:["feed","replies","media"].map(A=>(0,s.jsx)(Ls,{value:A,className:"flex-1 py-4 text-sm font-bold capitalize rounded-none border-b-2 data-[state=active]:border-black dark:data-[state=active]:border-white data-[state=active]:text-black dark:data-[state=active]:text-white text-zinc-500 transition-all hover:bg-zinc-50 dark:hover:bg-zinc-900",children:A==="feed"?"Posts":A},A))})}),(0,s.jsx)(Ee,{value:"feed",className:"m-0 border-none",children:ee()}),(0,s.jsx)(Ee,{value:"replies",className:"m-0 border-none",children:ee()}),(0,s.jsx)(Ee,{value:"media",className:"m-0 border-none",children:ee()})]})]}),(0,s.jsx)(et,{isOpen:L,onClose:()=>R(!1),title:O,className:"sm:max-w-md",children:(0,s.jsx)("div",{className:"min-h-[300px]",children:C?(0,s.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,s.jsx)(re,{className:"animate-spin text-violet-500",size:32})}):I.length>0?(0,s.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800 -mx-6",children:[I.map(A=>(0,s.jsx)(mt,{profile:A,onUserClick:Q=>{R(!1),a(`/u/${Q}`)}},A.id)),B&&(0,s.jsx)("div",{className:"p-4 flex justify-center",children:(0,s.jsxs)(Button,{variant:"secondary",className:"w-full text-xs",onClick:()=>ie(O,!0),disabled:D,children:[D?(0,s.jsx)(re,{size:14,className:"animate-spin mr-2"}):null,"Load more"]})})]}):(0,s.jsx)("div",{className:"flex flex-col items-center justify-center py-20 text-zinc-500",children:(0,s.jsxs)("p",{className:"font-medium",children:["No ",O.toLowerCase()," yet."]})})})})]})},$o=So,Po=W(),Fo=()=>{const t=(0,Po.c)(32),{id:e}=ft(),a=we(),{currentUser:l}=he(),{addToast:i}=_e();let r,n;t[0]!==e?(r=["post",e],n=async()=>{if(!je(e))throw new Error("Invalid post ID");return ql(e)},t[0]=e,t[1]=r,t[2]=n):(r=t[1],n=t[2]);const o=!!e;let c;t[3]!==r||t[4]!==n||t[5]!==o?(c={queryKey:r,queryFn:n,enabled:o,retry:!1},t[3]=r,t[4]=n,t[5]=o,t[6]=c):c=t[6];const{data:d,isLoading:m,isError:u}=Le(c);if(m){let _;return t[7]===Symbol.for("react.memo_cache_sentinel")?(_=(0,s.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:(0,s.jsx)(wt,{})}),t[7]=_):_=t[7],_}if(u||!d){let _;return t[8]===Symbol.for("react.memo_cache_sentinel")?(_=(0,s.jsx)("div",{className:"bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-[600px] flex items-center justify-center",children:(0,s.jsx)(qs,{title:"Post not found",message:"The post you are looking for doesn't exist. It may have been deleted by the author.",icon:ua})}),t[8]=_):_=t[8],_}let f;t[9]!==a?(f=()=>a(-1),t[9]=a,t[10]=f):f=t[10];let x;t[11]===Symbol.for("react.memo_cache_sentinel")?(x=(0,s.jsx)(Be,{size:20,strokeWidth:2.5}),t[11]=x):x=t[11];let p;t[12]!==f?(p=(0,s.jsx)("button",{onClick:f,className:"p-2 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:x}),t[12]=f,t[13]=p):p=t[13];let h;t[14]===Symbol.for("react.memo_cache_sentinel")?(h=(0,s.jsx)("h5",{className:"text-xl font-bold dark:text-white",children:"Post"}),t[14]=h):h=t[14];let b;t[15]!==p?(b=(0,s.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4",children:[p,h]})}),t[15]=p,t[16]=b):b=t[16];let v;t[17]!==d.comments?(v=d.comments||[],t[17]=d.comments,t[18]=v):v=t[18];let j,k;t[19]!==a?(j=_=>a(`/u/${_}`),k=()=>a(-1),t[19]=a,t[20]=j,t[21]=k):(j=t[20],k=t[21]);let N;t[22]!==i||t[23]!==l||t[24]!==d||t[25]!==j||t[26]!==k||t[27]!==v?(N=(0,s.jsx)(tt,{...d,isDetail:!0,currentUser:l,initialComments:v,showToast:i,onUserClick:j,onDelete:k}),t[22]=i,t[23]=l,t[24]=d,t[25]=j,t[26]=k,t[27]=v,t[28]=N):N=t[28];let w;return t[29]!==N||t[30]!==b?(w=(0,s.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm mb-20 animate-in slide-in-from-right-5 duration-300",children:(0,s.jsxs)("div",{className:"border-b border-zinc-100 dark:border-zinc-800",children:[b,N]})}),t[29]=N,t[30]=b,t[31]=w):w=t[31],w},Mo=Fo,Lo=W();function Ro(){const t=(0,Lo.c)(49),e=Xe(),{currentUser:a,authMode:l,setAuthMode:i}=he(),{darkMode:r}=pt(),{isOpen:n,images:o,currentIndex:c,closeLightbox:d,setIndex:m}=bt(),[u,f]=(0,g.useState)(!1),[x,p]=(0,g.useState)(!1),[h,b]=(0,g.useState)(!1);let v;t[0]===Symbol.for("react.memo_cache_sentinel")?(v={},t[0]=v):v=t[0];const[j,k]=(0,g.useState)(v),[N,w]=(0,g.useState)(null);if(l){const Y=r?"dark":"";let G;t[1]!==i?(G=()=>i(null),t[1]=i,t[2]=G):G=t[2];let te;t[3]!==l||t[4]!==i?(te=()=>i(l==="login"?"signup":"login"),t[3]=l,t[4]=i,t[5]=te):te=t[5];let se;t[6]!==l||t[7]!==G||t[8]!==te?(se=(0,s.jsx)("div",{className:"min-h-screen bg-white dark:bg-black flex items-center justify-center p-4",children:(0,s.jsx)(Ne,{children:(0,s.jsx)(Rr,{type:l,onComplete:G,onSwitch:te})})}),t[6]=l,t[7]=G,t[8]=te,t[9]=se):se=t[9];let ie;return t[10]!==Y||t[11]!==se?(ie=(0,s.jsx)("div",{className:Y,children:se}),t[10]=Y,t[11]=se,t[12]=ie):ie=t[12],ie}let _;t[13]===Symbol.for("react.memo_cache_sentinel")?(_=(0,s.jsx)(Ei,{}),t[13]=_):_=t[13];let S;t[14]===Symbol.for("react.memo_cache_sentinel")?(S=(0,s.jsx)(ar,{onPostClick:()=>f(!0)}),t[14]=S):S=t[14];let z;t[15]===Symbol.for("react.memo_cache_sentinel")?(z=(0,s.jsx)(ve,{path:"/",element:(0,s.jsx)(Ne,{children:(0,s.jsx)(Cn,{onStoryClick:w,onAddStory:()=>b(!0)})})}),t[15]=z):z=t[15];let $;t[16]===Symbol.for("react.memo_cache_sentinel")?($=(0,s.jsx)(ve,{path:"/home",element:(0,s.jsx)($t,{to:"/",replace:!0})}),t[16]=$):$=t[16];let P;t[17]===Symbol.for("react.memo_cache_sentinel")?(P=(0,s.jsx)(ve,{path:"/explore",element:(0,s.jsx)(Ne,{children:(0,s.jsx)(Mn,{})})}),t[17]=P):P=t[17];let F;t[18]===Symbol.for("react.memo_cache_sentinel")?(F=(0,s.jsx)(ve,{path:"/reels",element:(0,s.jsx)(Ne,{children:(0,s.jsx)(qn,{})})}),t[18]=F):F=t[18];let M;t[19]===Symbol.for("react.memo_cache_sentinel")?(M=(0,s.jsx)(ve,{path:"/messages",element:(0,s.jsx)(Ne,{children:(0,s.jsx)(Wt,{})})}),t[19]=M):M=t[19];let L;t[20]===Symbol.for("react.memo_cache_sentinel")?(L=(0,s.jsx)(ve,{path:"/messages/:id",element:(0,s.jsx)(Ne,{children:(0,s.jsx)(Wt,{})})}),t[20]=L):L=t[20];let R;t[21]===Symbol.for("react.memo_cache_sentinel")?(R=(0,s.jsx)(ve,{path:"/notifications",element:(0,s.jsx)(Ne,{children:(0,s.jsx)(No,{})})}),t[21]=R):R=t[21];let O;t[22]===Symbol.for("react.memo_cache_sentinel")?(O=(0,s.jsx)(ve,{path:"/post/:id",element:(0,s.jsx)(Ne,{children:(0,s.jsx)(Mo,{})})}),t[22]=O):O=t[22];let q;t[23]===Symbol.for("react.memo_cache_sentinel")?(q=(0,s.jsx)(ve,{path:"/u/:handle",element:(0,s.jsx)(Ne,{children:(0,s.jsx)($o,{onEditProfile:Y=>{k(Y),p(!0)}})})}),t[23]=q):q=t[23];let I;t[24]===Symbol.for("react.memo_cache_sentinel")?(I=(0,s.jsxs)(ve,{element:S,children:[z,$,P,F,M,L,R,O,q,(0,s.jsx)(ve,{path:"*",element:(0,s.jsx)($t,{to:"/explore"})})]}),t[24]=I):I=t[24];let y;t[25]!==e?(y=(0,s.jsx)(Qa,{location:e,children:I},e.pathname),t[25]=e,t[26]=y):y=t[26];let C;t[27]!==j||t[28]!==x||t[29]!==u||t[30]!==h?(C=(0,s.jsx)(yr,{isPostModalOpen:u,setIsPostModalOpen:f,isEditProfileOpen:x,setIsEditProfileOpen:p,isStoryModalOpen:h,setIsStoryModalOpen:b,editProfileData:j,setEditProfileData:k}),t[27]=j,t[28]=x,t[29]=u,t[30]=h,t[31]=C):C=t[31];let E;t[32]!==N?(E=N&&(0,s.jsx)(kr,{story:N,onClose:()=>w(null)}),t[32]=N,t[33]=E):E=t[33];let D;t[34]!==d||t[35]!==c||t[36]!==o||t[37]!==n||t[38]!==m?(D=n&&(0,s.jsx)(Pr,{images:o,currentIndex:c,onClose:d,onNavigate:m}),t[34]=d,t[35]=c,t[36]=o,t[37]=n,t[38]=m,t[39]=D):D=t[39];let U;t[40]!==a||t[41]!==e.pathname?(U=a&&e.pathname==="/"&&(0,s.jsx)("button",{onClick:()=>f(!0),className:"fixed bottom-20 right-5 md:hidden z-50 bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 size-12 rounded-full flex items-center justify-center shadow-2xl hover:scale-110 active:scale-90 transition-all cursor-pointer group",title:"Create Post",children:(0,s.jsx)(Re,{size:28,className:"group-hover:rotate-90 transition-transform duration-300"})}),t[40]=a,t[41]=e.pathname,t[42]=U):U=t[42];let B;return t[43]!==y||t[44]!==C||t[45]!==E||t[46]!==D||t[47]!==U?(B=(0,s.jsxs)(s.Fragment,{children:[_,y,C,E,D,U]}),t[43]=y,t[44]=C,t[45]=E,t[46]=D,t[47]=U,t[48]=B):B=t[48],B}var Io=new vl;(0,zl.createRoot)(document.getElementById("root")).render((0,s.jsx)(g.StrictMode,{children:(0,s.jsx)(ll,{client:Io,children:(0,s.jsx)(ja,{children:(0,s.jsx)(pi,{children:(0,s.jsx)(ui,{children:(0,s.jsx)(xi,{children:(0,s.jsx)(Ni,{children:(0,s.jsx)(wi,{children:(0,s.jsx)(ki,{children:(0,s.jsx)(Ro,{})})})})})})})})})}));
