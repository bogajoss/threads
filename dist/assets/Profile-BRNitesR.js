import{a as oe}from"./rolldown-runtime-BaZ8gS7u.js";import{s as he,u as fe,w as pe,y as ue}from"./framework-C-7_uJf4.js";import"./database-BqFyPhmY.js";import{Bt as be,Kn as je,Qt as ve,Wn as ge,dn as ze,kn as Ne,mn as j}from"./ui-libs-BRyi7QEs.js";import{$ as ke,Dt as we,L as ye,M as _e,N as Fe,Q as Ce,R as Pe,_ as Le,b as Me,c as Se,d as Te,et as Ie,f as We,l as $e,m as Ee,s as Ue,u as Ae,ut as ce,v as De,x as Oe,y as re}from"./index-BJOntbJp.js";import{n as qe}from"./post-C5srNobu.js";import{n as Be,t as He}from"./linkify-Cx_iB-94.js";import{l as Qe}from"./hooks-AM0ZtlUW.js";var Ve=he(),Ke=oe(pe(),1),s=oe(fe(),1),Re=({profile:t,currentUser:e,isCurrentUser:V,onEditProfile:se,showToast:c,isCommunity:G,onShowFollowers:K,onShowFollowing:o})=>{const{isFollowing:v,stats:g,loading:u,handleFollow:R}=Fe(t,e?.id,c),h=ue(),[z,d]=(0,Ke.useState)(!1),x=async()=>{if(!e){c("Please sign in to message users");return}d(!0);try{h(`/messages/${await we(e.id,t.id)}`)}catch(i){console.error("Failed to start conversation:",i),c("Failed to open chat")}finally{d(!1)}};return(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("div",{className:"relative h-32 w-full bg-zinc-200 dark:bg-zinc-800 sm:h-48",children:[t.cover&&(0,s.jsx)("img",{src:t.cover,className:"h-full w-full object-cover transition-opacity duration-500",alt:"Cover"}),(0,s.jsx)("div",{className:"absolute -bottom-12 left-4 sm:-bottom-16 sm:left-6",children:(0,s.jsx)("div",{className:"relative rounded-full bg-white p-1 shadow-xl ring-4 ring-white dark:bg-black dark:ring-black",children:(0,s.jsxs)(Ce,{className:"size-24 sm:size-32",children:[(0,s.jsx)(Ie,{src:t.avatar,alt:t.handle,className:"object-cover"}),(0,s.jsx)(ke,{className:"text-4xl font-bold",children:t.handle?.[0]?.toUpperCase()})]})})})]}),(0,s.jsxs)("div",{className:"flex flex-col space-y-4 p-4 pt-16 sm:p-6 sm:pt-20",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsx)("div",{className:"min-w-0 flex-1 pr-4"}),(0,s.jsx)("div",{className:"flex shrink-0 gap-2",children:V?(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>se?.(t),className:"flex size-10 items-center justify-center rounded-full border border-zinc-200 text-zinc-700 transition-all hover:bg-zinc-50 active:scale-95 dark:border-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-900",title:"Edit Profile",children:(0,s.jsx)(Ue,{size:20})}),(0,s.jsx)("button",{onClick:()=>h("/settings"),className:"rounded-full border border-zinc-200 p-2 text-zinc-700 transition-all hover:bg-zinc-50 active:scale-95 dark:border-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-900",title:"Settings",children:(0,s.jsx)(We,{size:20})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:x,disabled:z,className:"rounded-full border border-zinc-200 p-2 text-zinc-700 transition-colors hover:bg-zinc-50 disabled:opacity-50 dark:border-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-900",children:z?(0,s.jsx)(j,{size:20,className:"animate-spin"}):(0,s.jsx)(ze,{size:20})}),(0,s.jsx)("button",{className:"rounded-full border border-zinc-200 p-2 text-zinc-700 transition-colors hover:bg-zinc-50 dark:border-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-900",children:(0,s.jsx)(ge,{size:20})}),(0,s.jsx)(ce,{variant:v?"secondary":"primary",onClick:R,className:"flex min-w-0 items-center gap-2 px-4 text-sm sm:min-w-[100px]",disabled:u,children:u?(0,s.jsx)(j,{size:16,className:"mx-auto animate-spin"}):v?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)($e,{size:18}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Following"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Se,{size:18}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Follow"})]})}),(0,s.jsx)("button",{className:"rounded-full p-2 text-zinc-700 transition-colors hover:bg-zinc-100 dark:text-zinc-300 dark:hover:bg-zinc-800",children:(0,s.jsx)(Ne,{size:20})})]})})]}),(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsxs)("div",{className:"mt-1 flex items-center gap-1.5",children:[(0,s.jsx)("h1",{className:"text-xl font-extrabold text-zinc-900 dark:text-zinc-100",children:t.name}),t.verified&&(0,s.jsx)(Ee,{size:20,className:"text-blue-500"})]}),!G&&(0,s.jsx)("div",{className:"flex items-center space-x-3",children:(0,s.jsxs)("span",{className:"-ml-1.5 rounded-md px-1.5 py-0.5 text-sm font-medium text-zinc-500 dark:text-zinc-400",children:["@",t.handle]})})]}),(0,s.jsx)("div",{className:"whitespace-pre-line text-sm leading-relaxed text-zinc-900 dark:text-zinc-100 sm:text-[15px]",children:(0,s.jsx)(Be,{options:{...He,render:({attributes:i,content:f})=>{const{href:l,...N}=i,r=!l.startsWith("/")&&(l.startsWith("http")||l.startsWith("www"));return l.startsWith("/u/")||l.startsWith("/tags/")||l.startsWith("/c/")||l.startsWith("/explore")?(0,s.jsx)("span",{...N,className:"cursor-pointer font-bold text-rose-500 hover:underline dark:text-rose-400",onClick:X=>{X.stopPropagation(),h(l)},children:f},f):(0,s.jsx)("a",{href:l,...N,target:r?"_blank":void 0,rel:r?"noopener noreferrer":void 0,children:f},f)}},children:t.bio})}),(t.website||t.location)&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-x-5 gap-y-2 pt-1 text-sm",children:[t.location&&(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(Te,{size:14}),t.location]}),t.website&&(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(Ae,{size:14}),(0,s.jsx)("a",{href:`https://${t.website}`,target:"_blank",rel:"noreferrer",className:"font-semibold text-black hover:underline dark:text-white",children:t.website})]})]}),(0,s.jsx)("div",{className:"relative z-10 flex gap-4 pt-2 text-sm sm:gap-6",children:G?(0,s.jsxs)("button",{className:"group flex cursor-pointer gap-x-1",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white",children:t.members}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Members"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:i=>{i.preventDefault(),i.stopPropagation(),o()},className:"group flex cursor-pointer gap-x-1",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white",children:g.following}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Following"})]}),(0,s.jsxs)("button",{onClick:i=>{i.preventDefault(),i.stopPropagation(),K()},className:"group flex cursor-pointer gap-x-1",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white",children:g.followers}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Followers"})]})]})})]})]})},Xe=Re,Ge=t=>{const e=(0,Ve.c)(89),{onEditProfile:V}=t,{handle:se,profile:c,loading:G,setUserPosts:K,activeProfileTab:o,setActiveProfileTab:v,loadingPosts:g,isFetchingMorePosts:u,hasMorePosts:R,filteredPosts:h,isFollowModalOpen:z,setIsFollowModalOpen:d,followModalType:x,followListData:i,isListLoading:f,isFetchingMoreFollows:l,hasMoreFollows:N,openFollowModal:r,handlePostClick:X,handleUserClick:te,loadUserPosts:ae,currentUser:b,addToast:k,navigate:w}=Qe();if(G){let n;return e[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,s.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,s.jsx)(j,{size:40,className:"animate-spin text-violet-500"})}),e[0]=n):n=e[0],n}if(!c){const n=`Try searching for another. The user @${se} could not be found.`;let p;return e[1]!==n?(p=(0,s.jsx)("div",{className:"flex min-h-[600px] items-center justify-center overflow-hidden rounded-none border-zinc-100 bg-white dark:bg-black md:rounded-xl",children:(0,s.jsx)(ye,{title:"Account doesn't exist",message:n,icon:be})}),e[1]=n,e[2]=p):p=e[2],p}const a=c;let J;e[3]!==o||e[4]!==k||e[5]!==b||e[6]!==a.handle||e[7]!==h||e[8]!==X||e[9]!==te||e[10]!==R||e[11]!==u||e[12]!==ae||e[13]!==g||e[14]!==c||e[15]!==K?(J=n=>{const p=n===void 0?!1:n;return g?(0,s.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,s.jsx)(j,{className:"animate-spin text-violet-500",size:32})}):h.length>0?(0,s.jsxs)(s.Fragment,{children:[h.map(ne=>(0,s.jsx)(qe,{currentUser:b,showToast:k,...ne,onClick:()=>X(ne.id),onUserClick:te,onDelete:de=>K(xe=>xe.filter(me=>me.id!==de))},ne.id)),R&&(0,s.jsx)("div",{className:"flex justify-center p-6",children:(0,s.jsxs)(ce,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>ae(c.id,!0),disabled:u,children:[u&&(0,s.jsx)(j,{size:18,className:"mr-2 animate-spin"}),"Load more posts"]})})]}):p?null:(0,s.jsxs)("div",{className:"flex animate-in fade-in flex-col items-center gap-4 p-20 text-center text-zinc-500 duration-500",children:[(0,s.jsx)("div",{className:"mb-2 rounded-full bg-zinc-50 p-6 ring-1 ring-zinc-100 dark:bg-zinc-900 dark:ring-zinc-800",children:(0,s.jsx)(ve,{size:40,className:"text-zinc-300 dark:text-zinc-700"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:o==="collections"?"No collections yet":"No posts yet"}),(0,s.jsx)("p",{className:"max-w-[250px] text-sm text-zinc-500 dark:text-zinc-400",children:o==="collections"?"Saved posts and curated collections will appear here.":`When @${a.handle} shares posts, they will appear here.`})]})},e[3]=o,e[4]=k,e[5]=b,e[6]=a.handle,e[7]=h,e[8]=X,e[9]=te,e[10]=R,e[11]=u,e[12]=ae,e[13]=g,e[14]=c,e[15]=K,e[16]=J):J=e[16];const m=J;let y;e[17]!==w?(y=()=>w(-1),e[17]=w,e[18]=y):y=e[18];let Y;e[19]===Symbol.for("react.memo_cache_sentinel")?(Y=(0,s.jsx)(je,{size:22}),e[19]=Y):Y=e[19];let _;e[20]!==y?(_=(0,s.jsx)("button",{onClick:y,className:"rounded-full p-1 transition-colors hover:bg-zinc-100 dark:text-white dark:hover:bg-zinc-800",children:Y}),e[20]=y,e[21]=_):_=e[21];let F;e[22]!==a.name?(F=(0,s.jsx)("h5",{className:"text-lg font-bold leading-none dark:text-white",children:a.name}),e[22]=a.name,e[23]=F):F=e[23];const ie=a.posts_count||0;let C;e[24]!==ie?(C=(0,s.jsxs)("span",{className:"mt-0.5 text-xs text-zinc-500",children:[ie," Posts"]}),e[24]=ie,e[25]=C):C=e[25];let P;e[26]!==F||e[27]!==C?(P=(0,s.jsxs)("div",{className:"flex flex-col",children:[F,C]}),e[26]=F,e[27]=C,e[28]=P):P=e[28];let L;e[29]!==_||e[30]!==P?(L=(0,s.jsx)("div",{className:"sticky top-0 z-20 border-b border-zinc-100 bg-white/90 p-4 py-3 backdrop-blur-md dark:border-zinc-800 dark:bg-black/90 md:hidden",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4",children:[_,P]})}),e[29]=_,e[30]=P,e[31]=L):L=e[31];const le=b?.handle===a.handle;let M,S;e[32]!==r?(M=()=>r("Followers"),S=()=>r("Following"),e[32]=r,e[33]=M,e[34]=S):(M=e[33],S=e[34]);let T;e[35]!==k||e[36]!==b||e[37]!==a||e[38]!==V||e[39]!==le||e[40]!==M||e[41]!==S?(T=(0,s.jsx)(Xe,{profile:a,currentUser:b,isCurrentUser:le,onEditProfile:V,showToast:k,onShowFollowers:M,onShowFollowing:S}),e[35]=k,e[36]=b,e[37]=a,e[38]=V,e[39]=le,e[40]=M,e[41]=S,e[42]=T):T=e[42];let Z;e[43]===Symbol.for("react.memo_cache_sentinel")?(Z=(0,s.jsx)("div",{className:"sticky top-[60px] z-10 border-b border-zinc-100 bg-white/90 backdrop-blur-md dark:border-zinc-800 dark:bg-black/90 md:top-0",children:(0,s.jsx)(Me,{className:"hide-scrollbar h-auto w-full justify-start overflow-x-auto rounded-none bg-transparent p-0 px-2",children:["feed","collections","media"].map(Je)})}),e[43]=Z):Z=e[43];let I;e[44]!==m?(I=m(),e[44]=m,e[45]=I):I=e[45];let W;e[46]!==I?(W=(0,s.jsx)(re,{value:"feed",className:"m-0 border-none",children:I}),e[46]=I,e[47]=W):W=e[47];let $;e[48]!==a.id||e[49]!==a.name?($=(0,s.jsx)(Le,{name:a.name,number:a.id}),e[48]=a.id,e[49]=a.name,e[50]=$):$=e[50];let E;e[51]!==m?(E=m(!0),e[51]=m,e[52]=E):E=e[52];let U;e[53]!==$||e[54]!==E?(U=(0,s.jsxs)(re,{value:"collections",className:"m-0 border-none",children:[$,E]}),e[53]=$,e[54]=E,e[55]=U):U=e[55];let A;e[56]!==m?(A=m(),e[56]=m,e[57]=A):A=e[57];let D;e[58]!==A?(D=(0,s.jsx)(re,{value:"media",className:"m-0 border-none",children:A}),e[58]=A,e[59]=D):D=e[59];let O;e[60]!==o||e[61]!==v||e[62]!==W||e[63]!==U||e[64]!==D?(O=(0,s.jsxs)(De,{value:o,onValueChange:v,className:"w-full",children:[Z,W,U,D]}),e[60]=o,e[61]=v,e[62]=W,e[63]=U,e[64]=D,e[65]=O):O=e[65];let q;e[66]!==T||e[67]!==O||e[68]!==L?(q=(0,s.jsxs)("div",{className:"border-y border-zinc-100 dark:border-zinc-800 md:border-b-0",children:[L,T,O]}),e[66]=T,e[67]=O,e[68]=L,e[69]=q):q=e[69];let B;e[70]!==d?(B=()=>d(!1),e[70]=d,e[71]=B):B=e[71];let H;e[72]!==i||e[73]!==x||e[74]!==N||e[75]!==l||e[76]!==f||e[77]!==w||e[78]!==r||e[79]!==d?(H=(0,s.jsx)("div",{className:"flex max-h-[75vh] flex-col overflow-y-auto",children:(0,s.jsx)("div",{className:"min-h-[300px]",children:f?(0,s.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,s.jsx)(j,{className:"animate-spin text-violet-500",size:32})}):i.length>0?(0,s.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:[i.map(n=>(0,s.jsx)(_e,{profile:n,onUserClick:p=>{d(!1),w(`/u/${p}`)}},n.id)),N&&(0,s.jsx)("div",{className:"flex justify-center p-4",children:(0,s.jsxs)(ce,{variant:"secondary",className:"w-full text-xs",onClick:()=>r(x,!0),disabled:l,children:[l?(0,s.jsx)(j,{size:14,className:"mr-2 animate-spin"}):null,"Load more"]})})]}):(0,s.jsx)("div",{className:"flex flex-col items-center justify-center py-20 text-zinc-500",children:(0,s.jsxs)("p",{className:"font-medium",children:["No ",x.toLowerCase()," yet."]})})})}),e[72]=i,e[73]=x,e[74]=N,e[75]=l,e[76]=f,e[77]=w,e[78]=r,e[79]=d,e[80]=H):H=e[80];let Q;e[81]!==x||e[82]!==z||e[83]!==B||e[84]!==H?(Q=(0,s.jsx)(Pe,{isOpen:z,onClose:B,title:x,className:"sm:max-w-md",children:H}),e[81]=x,e[82]=z,e[83]=B,e[84]=H,e[85]=Q):Q=e[85];let ee;return e[86]!==q||e[87]!==Q?(ee=(0,s.jsxs)("div",{className:"min-h-screen overflow-hidden rounded-none border-zinc-100 bg-white pb-20 dark:bg-black dark:border-zinc-800 md:rounded-xl",children:[q,Q]}),e[86]=q,e[87]=Q,e[88]=ee):ee=e[88],ee},ns=Ge;function Je(t){return(0,s.jsx)(Oe,{value:t,className:"flex-1 whitespace-nowrap rounded-none border-b-2 px-4 py-4 text-sm font-bold capitalize text-zinc-500 transition-all data-[state=active]:border-black data-[state=active]:text-black dark:data-[state=active]:border-white dark:data-[state=active]:text-white",children:t==="feed"?"Posts":t},t)}export{ns as default};
