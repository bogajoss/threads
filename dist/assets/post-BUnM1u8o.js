const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/VideoPlayer-Dkpd3B3h.js","assets/framework-qAfQIUpw.js","assets/database-CdmW3A7f.js","assets/animations-DnIvWaa_.js","assets/rolldown-runtime-BaZ8gS7u.js","assets/framework-sg0yWRLc.css","assets/media-libs-BYH8vgqC.js","assets/media-libs-CqCaMccn.css","assets/VideoPlayer-CDxVYyol.js","assets/index-DjXQ6X3Z.js","assets/ui-libs-lxLEvj1Y.js","assets/query-gr-7CPJN.js","assets/index-Cem365pZ.css","assets/dist-DzEd4B1b.js"])))=>i.map(i=>d[i]);
import{a as pt}from"./rolldown-runtime-BaZ8gS7u.js";import{a as It,i as re,o as Mt,s as Et}from"./animations-DnIvWaa_.js";import{_ as ce,b as gt,c as q,n as At,u as Dt}from"./framework-qAfQIUpw.js";import{r as Lt}from"./query-gr-7CPJN.js";import{$t as Ot,Bt as Ve,Fn as Ne,Hn as ye,In as Be,It as qe,Kn as Ut,Nn as He,Rn as Wt,Rt as Vt,Vn as Bt,Wn as qt,Zn as Ht,Zt as Qe,an as Qt,cn as Gt,dn as Xt,gn as vt,in as Jt,ir as Kt,jn as ge,kt as oe,ln as Zt,mn as Yt,on as Ge,rn as we,wn as es,yn as ts,zn as ss}from"./ui-libs-lxLEvj1Y.js";import{An as is,At as Xe,Cn as ls,Ct as ee,D as as,Dt as Je,E as ve,Et as Ke,F as ns,Ft as bt,In as Ze,It as rs,Lt as os,Mn as Ce,Mt as Ye,Nn as G,Ot as et,P as cs,Pn as pe,Pt as ds,Qt as ms,Rt as _e,Sn as xs,St as te,Tt as tt,Ut as fs,Vt as jt,Yt as st,_ as kt,_n as hs,b as us,cn as ps,dt as gs,en as vs,fn as bs,jt as it,k as js,kt as lt,ln as ks,lt as ae,ot as zs,st as Ns,tt as zt,ut as ys,v as ws,w as Cs,wt as se,x as $s,yn as at}from"./index-DjXQ6X3Z.js";import{t as Se}from"./text-processing-CRKQxkaV.js";import{t as Pe}from"./linkify-Bgxg4QY4.js";import{n as ne,t as _s}from"./actionsheet-Cggx_7S8.js";import{d as nt,m as Ss,t as Ps}from"./hooks-Qdn5JF-7.js";var Fs=q(),C=pt(Et(),1),t=pt(Mt(),1),Ts=i=>{const e=(0,Fs.c)(37),{isComment:s,liked:n,reposted:a,handleLike:l,handleRepost:r,handleCommentClick:d,handleShareClick:c,isDetail:g}=i;if(g!==void 0&&g){let $;e[0]!==l||e[1]!==n?($=(0,t.jsx)(X,{icon:ge,label:"Like",type:"like",onClick:l,active:n}),e[0]=l,e[1]=n,e[2]=$):$=e[2];let k;e[3]!==r||e[4]!==s||e[5]!==a?(k=!s&&(0,t.jsx)(X,{icon:we,label:"Repost",type:"repost",onClick:r,active:a}),e[3]=r,e[4]=s,e[5]=a,e[6]=k):k=e[6];let N;e[7]!==d?(N=(0,t.jsx)(X,{icon:kt,label:"Comment",type:"comment",onClick:d}),e[7]=d,e[8]=N):N=e[8];let o;e[9]!==c||e[10]!==s?(o=!s&&(0,t.jsx)(X,{icon:ve,label:"Share",type:"share",onClick:c}),e[9]=c,e[10]=s,e[11]=o):o=e[11];let _;return e[12]!==$||e[13]!==k||e[14]!==N||e[15]!==o?(_=(0,t.jsxs)("div",{className:"mt-4 flex w-full items-center justify-around py-1",children:[$,k,N,o]}),e[12]=$,e[13]=k,e[14]=N,e[15]=o,e[16]=_):_=e[16],_}const h=`flex items-center gap-x-1 ${s?"mt-1.5":"mt-3"}`,u=s?16:18;let x;e[17]!==l||e[18]!==n||e[19]!==u?(x=(0,t.jsx)(X,{icon:ge,size:u,type:"like",onClick:l,active:n}),e[17]=l,e[18]=n,e[19]=u,e[20]=x):x=e[20];const z=s?16:18;let p;e[21]!==d||e[22]!==z?(p=(0,t.jsx)(X,{icon:vt,size:z,type:"comment",onClick:d}),e[21]=d,e[22]=z,e[23]=p):p=e[23];const f=s?16:18;let v;e[24]!==r||e[25]!==a||e[26]!==f?(v=(0,t.jsx)(X,{icon:we,size:f,type:"repost",onClick:r,active:a}),e[24]=r,e[25]=a,e[26]=f,e[27]=v):v=e[27];let m;e[28]!==c||e[29]!==s?(m=!s&&c&&(0,t.jsx)(X,{icon:ve,type:"share",onClick:c}),e[28]=c,e[29]=s,e[30]=m):m=e[30];let y;return e[31]!==h||e[32]!==x||e[33]!==p||e[34]!==v||e[35]!==m?(y=(0,t.jsxs)("div",{className:h,children:[x,p,v,m]}),e[31]=h,e[32]=x,e[33]=p,e[34]=v,e[35]=m,e[36]=y):y=e[36],y},rt=Ts,Rs=q(),Is=i=>{const e=(0,Rs.c)(38),{views:s,likes:n,comments:a,isDetail:l,isComment:r,onRepliesClick:d}=i,c=l===void 0?!1:l,g=r===void 0?!1:r;if(c){const v=s||0;let m;e[0]!==v?(m=(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:v}),e[0]=v,e[1]=m):m=e[1];let y;e[2]===Symbol.for("react.memo_cache_sentinel")?(y=(0,t.jsx)("span",{className:"opacity-70",children:"Views"}),e[2]=y):y=e[2];let $;e[3]!==m?($=(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[m," ",y]}),e[3]=m,e[4]=$):$=e[4];const k=n||0;let N;e[5]!==k?(N=(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:k}),e[5]=k,e[6]=N):N=e[6];let o;e[7]===Symbol.for("react.memo_cache_sentinel")?(o=(0,t.jsx)("span",{className:"opacity-70",children:"Likes"}),e[7]=o):o=e[7];let _;e[8]!==N?(_=(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[N," ",o]}),e[8]=N,e[9]=_):_=e[9];const S=a||0;let I;e[10]!==S?(I=(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:S}),e[10]=S,e[11]=I):I=e[11];let w;e[12]===Symbol.for("react.memo_cache_sentinel")?(w=(0,t.jsx)("span",{className:"opacity-70",children:"Comments"}),e[12]=w):w=e[12];let b;e[13]!==I?(b=(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[I," ",w]}),e[13]=I,e[14]=b):b=e[14];let F;return e[15]!==_||e[16]!==b||e[17]!==$?(F=(0,t.jsxs)("div",{className:"mt-4 flex items-center gap-x-6 border-b border-zinc-100 pb-4 text-sm text-zinc-500 dark:border-zinc-800 dark:text-zinc-400",children:[$,_,b]}),e[15]=_,e[16]=b,e[17]=$,e[18]=F):F=e[18],F}if(a===0&&n===0&&(s===0||g))return null;const h=`mt-1 flex items-center gap-x-1.5 px-0.5 ${g?"text-[12px]":"text-[14px]"} font-medium text-zinc-500 dark:text-zinc-400`;let u;e[19]!==a||e[20]!==g||e[21]!==n||e[22]!==s?(u=s>0&&!g&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{className:"hover:underline",children:[s," ",s===1?"view":"views"]}),(a>0||n>0)&&(0,t.jsx)("span",{className:"opacity-50",children:"·"})]}),e[19]=a,e[20]=g,e[21]=n,e[22]=s,e[23]=u):u=e[23];let x;e[24]!==a||e[25]!==d?(x=a>0&&(0,t.jsxs)("button",{className:"hover:underline",onClick:v=>{v.stopPropagation(),d&&d(v)},children:[a," ",a===1?"reply":"replies"]}),e[24]=a,e[25]=d,e[26]=x):x=e[26];let z;e[27]!==a||e[28]!==n?(z=a>0&&n>0&&(0,t.jsx)("span",{className:"opacity-50",children:"·"}),e[27]=a,e[28]=n,e[29]=z):z=e[29];let p;e[30]!==n?(p=n>0&&(0,t.jsxs)("button",{className:"hover:underline",children:[n," ",n===1?"like":"likes"]}),e[30]=n,e[31]=p):p=e[31];let f;return e[32]!==h||e[33]!==u||e[34]!==x||e[35]!==z||e[36]!==p?(f=(0,t.jsxs)("div",{className:h,children:[u,x,z,p]}),e[32]=h,e[33]=u,e[34]=x,e[35]=z,e[36]=p,e[37]=f):f=e[37],f},ot=Is,Ms=q(),Es=i=>{const e=(0,Ms.c)(43),{user:s,timeAgo:n,community:a,onUserClick:l,actionsMenu:r,isComment:d,isDetail:c,showAvatar:g}=i,h=g===void 0?!1:g,u=ce();let x;e[0]!==l||e[1]!==s.handle?(x=T=>{T.stopPropagation(),l&&l(s.handle)},e[0]=l,e[1]=s.handle,e[2]=x):x=e[2];const z=x;let p;e[3]!==a||e[4]!==u?(p=T=>{T.stopPropagation(),a&&u(`/c/${a.handle}`)},e[3]=a,e[4]=u,e[5]=p):p=e[5];const f=p,v=`flex items-center justify-between ${c?"pb-4":"min-h-[40px] mb-1"}`;let m;e[6]!==z||e[7]!==d||e[8]!==c||e[9]!==h||e[10]!==s.avatar||e[11]!==s.handle?(m=h&&(0,t.jsx)("button",{className:"shrink-0",onClick:z,children:(0,t.jsxs)(te,{className:`${c?"size-12":d?"size-8":"size-10"} border-0 shadow-sm`,children:[(0,t.jsx)(se,{src:s.avatar,alt:s.handle,className:"object-cover"}),(0,t.jsx)(ee,{className:"text-xs",children:s.handle[0]?.toUpperCase()})]})}),e[6]=z,e[7]=d,e[8]=c,e[9]=h,e[10]=s.avatar,e[11]=s.handle,e[12]=m):m=e[12];const y=`flex shrink-0 items-center gap-1 font-bold text-zinc-900 hover:underline dark:text-white ${c?"text-base sm:text-lg":d?"text-[14px]":"text-[15px]"}`;let $;e[13]!==s.handle?($=(0,t.jsx)("span",{className:"max-w-[150px] truncate sm:max-w-none",children:s.handle}),e[13]=s.handle,e[14]=$):$=e[14];let k;e[15]!==d||e[16]!==c||e[17]!==s.verified?(k=s.verified&&(0,t.jsx)(as,{size:c?16:d?12:14,className:"text-blue-500"}),e[15]=d,e[16]=c,e[17]=s.verified,e[18]=k):k=e[18];let N;e[19]!==z||e[20]!==y||e[21]!==$||e[22]!==k?(N=(0,t.jsxs)("button",{className:y,onClick:z,children:[$,k]}),e[19]=z,e[20]=y,e[21]=$,e[22]=k,e[23]=N):N=e[23];let o;e[24]!==a||e[25]!==f||e[26]!==c?(o=a&&(0,t.jsxs)("div",{className:"flex min-w-0 items-center gap-1 text-zinc-500",children:[(0,t.jsx)(ws,{size:c?14:12,className:"shrink-0 text-zinc-400"}),(0,t.jsxs)("button",{className:`flex items-center gap-1 font-bold text-zinc-900 hover:underline dark:text-zinc-100 ${c?"text-[14px] sm:text-[15px]":"text-[13px]"}`,onClick:f,children:[(0,t.jsxs)(te,{className:"size-3.5 shrink-0 border border-zinc-200 bg-zinc-100 dark:border-zinc-700 dark:bg-zinc-800",children:[(0,t.jsx)(se,{src:a.avatar,alt:a.name,className:"object-cover"}),(0,t.jsx)(ee,{className:"text-[6px] font-bold text-zinc-500",children:a.name?.[0]?.toUpperCase()})]}),(0,t.jsx)("span",{className:"max-w-[150px] truncate sm:max-w-none",children:a.name})]})]}),e[24]=a,e[25]=f,e[26]=c,e[27]=o):o=e[27];let _;e[28]!==o||e[29]!==N?(_=(0,t.jsx)("div",{className:"flex min-w-0 flex-1 flex-col",children:(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-x-1.5 leading-none",children:(0,t.jsxs)("div",{className:"flex min-w-0 max-w-full items-center gap-1.5",children:[N,o]})})}),e[28]=o,e[29]=N,e[30]=_):_=e[30];let S;e[31]!==_||e[32]!==m?(S=(0,t.jsxs)("div",{className:"flex items-center gap-x-3 flex-1 min-w-0",children:[m,_]}),e[31]=_,e[32]=m,e[33]=S):S=e[33];const I=n||"Recent";let w;e[34]!==I?(w=(0,t.jsx)("span",{className:"whitespace-nowrap text-[12px] text-zinc-500 dark:text-zinc-400",children:I}),e[34]=I,e[35]=w):w=e[35];let b;e[36]!==r||e[37]!==w?(b=(0,t.jsxs)("div",{className:"-mt-1 flex items-center gap-2",children:[w,r]}),e[36]=r,e[37]=w,e[38]=b):b=e[38];let F;return e[39]!==S||e[40]!==b||e[41]!==v?(F=(0,t.jsxs)("div",{className:v,children:[S,b]}),e[39]=S,e[40]=b,e[41]=v,e[42]=F):F=e[42],F},ct=Es,As=q(),Ds=i=>{const e=(0,As.c)(45),{content:s,isDetail:n,isEditing:a,editedContent:l,setEditedContent:r,onCancelEdit:d,onSaveEdit:c,isUpdating:g,contentClass:h}=i,u=ce(),[x,z]=(0,C.useState)(!1),p=typeof s=="string"&&Ze(s);if(a&&r){let b;e[0]!==r?(b=W=>r(W.target.value),e[0]=r,e[1]=b):b=e[1];const F=`min-h-[100px] w-full rounded-xl border-zinc-200 bg-zinc-50 focus:ring-violet-500 dark:border-zinc-800 dark:bg-zinc-900 ${Ze(l||"")?"font-bangla text-lg":"font-english"}`;let T;e[2]!==l||e[3]!==b||e[4]!==F?(T=(0,t.jsx)(js,{value:l,onChange:b,className:F,autoFocus:!0}),e[2]=l,e[3]=b,e[4]=F,e[5]=T):T=e[5];let M;e[6]!==d?(M=(0,t.jsx)("button",{onClick:d,className:"px-4 py-1.5 text-sm font-bold text-zinc-500 transition-colors hover:text-zinc-700 dark:hover:text-zinc-300",children:"Cancel"}),e[6]=d,e[7]=M):M=e[7];let E;e[8]!==s||e[9]!==l||e[10]!==g?(E=g||!l?.trim()||l===s,e[8]=s,e[9]=l,e[10]=g,e[11]=E):E=e[11];const O=g?"Saving...":"Save";let A;e[12]!==c||e[13]!==E||e[14]!==O?(A=(0,t.jsx)("button",{onClick:c,disabled:E,className:"rounded-full bg-violet-600 px-4 py-1.5 text-sm font-bold text-white transition-all hover:bg-violet-700 disabled:opacity-50 active:scale-95",children:O}),e[12]=c,e[13]=E,e[14]=O,e[15]=A):A=e[15];let L;e[16]!==M||e[17]!==A?(L=(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[M,A]}),e[16]=M,e[17]=A,e[18]=L):L=e[18];let U;return e[19]!==T||e[20]!==L?(U=(0,t.jsxs)("div",{className:"mt-2 flex flex-col gap-2",onClick:Ls,children:[T,L]}),e[19]=T,e[20]=L,e[21]=U):U=e[21],U}const f=!n&&s.length>280;let v;e[22]!==s||e[23]!==x||e[24]!==f?(v=f&&!x?s.substring(0,280):s,e[22]=s,e[23]=x,e[24]=f,e[25]=v):v=e[25];const m=v,y=n?"text-lg leading-relaxed sm:text-xl sm:leading-8":"text-[15px] leading-relaxed",$=p?"font-bangla text-[1.15em]":"font-english";let k;e[26]!==h||e[27]!==y||e[28]!==$?(k=G("whitespace-pre-line break-words",y,$,h),e[26]=h,e[27]=y,e[28]=$,e[29]=k):k=e[29];let N;e[30]!==u?(N={...Pe,render:b=>{const{attributes:F,content:T}=b,{href:M,...E}=F,O=window.location.origin;if(M.includes("internal.tag/")){const L=decodeURIComponent(M.split("internal.tag/")[1]);return(0,t.jsxs)("span",{...E,className:G("cursor-pointer font-bold text-rose-600 hover:underline dark:text-rose-400 font-bangla",E.className),onClick:U=>{U.stopPropagation(),u(`/tags/${L}`)},children:["#",L]},T)}let A=null;return M.startsWith("/")?A=M:M.startsWith(O)&&(A=M.replace(O,"")),A?(0,t.jsx)("span",{...E,className:G("cursor-pointer font-medium text-violet-600 hover:underline dark:text-violet-400",E.className),onClick:L=>{L.stopPropagation(),u(A)},children:T},T):(0,t.jsx)("a",{href:M,...E,target:"_blank",rel:"noopener noreferrer",className:G("text-violet-600 hover:underline dark:text-violet-400",E.className),onClick:Os,children:T},T)}},e[30]=u,e[31]=N):N=e[31];let o;e[32]!==m?(o=typeof m=="string"?m.replace(/#([\u0980-\u09FF\w]+)/g,"https://internal.tag/$1"):m,e[32]=m,e[33]=o):o=e[33];let _;e[34]!==N||e[35]!==o?(_=(0,t.jsx)(Se,{options:N,children:o}),e[34]=N,e[35]=o,e[36]=_):_=e[36];const S=f&&!x&&"...";let I;e[37]!==x||e[38]!==f?(I=f&&(0,t.jsx)("button",{onClick:b=>{b.stopPropagation(),z(!x)},className:"ml-1 cursor-pointer font-bold text-rose-600 hover:underline dark:text-rose-400",children:x?"Show less":"See more"}),e[37]=x,e[38]=f,e[39]=I):I=e[39];let w;return e[40]!==k||e[41]!==_||e[42]!==S||e[43]!==I?(w=(0,t.jsxs)("div",{className:k,children:[_,S,I]}),e[40]=k,e[41]=_,e[42]=S,e[43]=I,e[44]=w):w=e[44],w},dt=Ds;function Ls(i){return i.stopPropagation()}function Os(i){return i.stopPropagation()}var Us=q(),Ws=i=>{const e=(0,Us.c)(28),{media:s,isEditing:n,editedMedia:a,setEditedMedia:l,newFiles:r,setNewFiles:d}=i;let c;e[0]!==a?(c=a===void 0?[]:a,e[0]=a,e[1]=c):c=e[1];const g=c;let h;e[2]!==r?(h=r===void 0?[]:r,e[2]=r,e[3]=h):h=e[3];const u=h,x=(0,C.useRef)(null);if(n&&l&&d){let p;if(e[4]!==g||e[5]!==l){let k;e[7]!==l?(k=(N,o)=>(0,t.jsxs)("div",{className:"group relative aspect-square overflow-hidden rounded-xl border border-zinc-200 dark:border-zinc-800",children:[N.type==="video"?(0,t.jsx)("div",{className:"flex size-full items-center justify-center bg-zinc-100 dark:bg-zinc-900",children:(0,t.jsx)(Be,{size:24,className:"text-zinc-400"})}):(0,t.jsx)("img",{src:N.url||N.src,className:"size-full object-cover",alt:""}),(0,t.jsx)("button",{onClick:_=>{_.stopPropagation(),l(S=>S.filter((I,w)=>w!==o))},className:"absolute right-1.5 top-1.5 flex size-7 items-center justify-center rounded-full bg-black/60 text-white transition-colors hover:bg-black",children:(0,t.jsx)(oe,{size:16})})]},`old-${o}`),e[7]=l,e[8]=k):k=e[8],p=g.map(k),e[4]=g,e[5]=l,e[6]=p}else p=e[6];let f;if(e[9]!==u||e[10]!==d){let k;e[12]!==d?(k=(N,o)=>(0,t.jsxs)("div",{className:"group relative aspect-square overflow-hidden rounded-xl border-2 border-dashed border-violet-500 bg-violet-50/10",children:[N.type.startsWith("image/")?(0,t.jsx)("img",{src:URL.createObjectURL(N),className:"size-full object-cover",alt:""}):(0,t.jsx)("div",{className:"flex size-full items-center justify-center",children:(0,t.jsx)(Be,{size:24,className:"animate-pulse text-violet-500"})}),(0,t.jsx)("button",{onClick:_=>{_.stopPropagation(),d(S=>S.filter((I,w)=>w!==o))},className:"absolute right-1.5 top-1.5 flex size-7 items-center justify-center rounded-full bg-black/60 text-white transition-colors hover:bg-black",children:(0,t.jsx)(oe,{size:16})}),(0,t.jsx)("div",{className:"absolute bottom-1 left-1 rounded bg-violet-600 px-1 text-[8px] font-bold text-white",children:"NEW"})]},`new-${o}`),e[12]=d,e[13]=k):k=e[13],f=u.map(k),e[9]=u,e[10]=d,e[11]=f}else f=e[11];let v;e[14]!==g.length||e[15]!==u.length?(v=g.length+u.length<4&&(0,t.jsxs)("button",{onClick:k=>{k.stopPropagation(),x.current?.click()},className:"relative flex aspect-square flex-col items-center justify-center gap-1 rounded-xl border-2 border-dashed border-zinc-200 text-zinc-400 transition-all hover:border-violet-500 hover:bg-violet-50/5 hover:text-violet-500 dark:border-zinc-800",children:[(0,t.jsx)(Jt,{size:20}),(0,t.jsx)("span",{className:"text-[10px] font-bold",children:"Add Media"})]}),e[14]=g.length,e[15]=u.length,e[16]=v):v=e[16];let m;e[17]!==p||e[18]!==f||e[19]!==v?(m=(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:[p,f,v]}),e[17]=p,e[18]=f,e[19]=v,e[20]=m):m=e[20];let y;e[21]!==d?(y=(0,t.jsx)("input",{type:"file",ref:x,onChange:k=>{if(k.target.files){const N=Array.from(k.target.files);d(o=>[...o,...N])}},multiple:!0,className:"hidden",accept:"image/*,video/*"}),e[21]=d,e[22]=y):y=e[22];let $;return e[23]!==m||e[24]!==y?($=(0,t.jsxs)("div",{className:"mt-3 space-y-3",children:[m,y]}),e[23]=m,e[24]=y,e[25]=$):$=e[25],$}if(!s||s.length===0)return null;let z;return e[26]!==s?(z=(0,t.jsx)(mi,{items:s}),e[26]=s,e[27]=z):z=e[27],z},mt=Ws,Vs=q(),Bs=i=>{const e=(0,Vs.c)(48),{icon:s,count:n,label:a,onClick:l,active:r,activeColorClass:d,size:c,type:g}=i,h=c===void 0?18:c,u=g===void 0?"default":g;let x,z,p,f,v,m,y;if(e[0]!==r||e[1]!==d||e[2]!==n||e[3]!==a||e[4]!==l||e[5]!==u){const E={like:{hoverBg:"group-hover:bg-rose-500/10",hoverText:"group-hover:text-rose-500",activeText:"text-rose-500",activeFill:"fill-rose-500"},repost:{hoverBg:"group-hover:bg-emerald-500/10",hoverText:"group-hover:text-emerald-500",activeText:"text-emerald-500",activeFill:"fill-emerald-500"},comment:{hoverBg:"group-hover:bg-sky-500/10",hoverText:"group-hover:text-sky-500",activeText:"text-sky-500",activeFill:"fill-sky-500"},share:{hoverBg:"group-hover:bg-violet-500/10",hoverText:"group-hover:text-violet-500",activeText:"text-violet-500",activeFill:"fill-violet-500"},default:{hoverBg:"group-hover:bg-zinc-500/10",hoverText:"group-hover:text-zinc-500",activeText:"text-zinc-900 dark:text-white",activeFill:"fill-current"}};z=E[u]||E.default;const O=d||z.activeText;x=re.button,e[13]===Symbol.for("react.memo_cache_sentinel")?(f={scale:.85},e[13]=f):f=e[13],e[14]!==l?(v=A=>{A.stopPropagation(),l&&l(A)},e[14]=l,e[15]=v):v=e[15],m=`${a} ${n!==void 0?`(${n})`:""}`,y=G("group -ml-2 flex items-center gap-x-0.5 rounded-xl px-2 py-1.5 text-[12px] font-bold transition-all sm:gap-x-1 sm:text-[13px]",r?O:"text-zinc-500",!r&&z.hoverText),p=G("rounded-full p-2 transition-all duration-200",!r&&z.hoverBg),e[0]=r,e[1]=d,e[2]=n,e[3]=a,e[4]=l,e[5]=u,e[6]=x,e[7]=z,e[8]=p,e[9]=f,e[10]=v,e[11]=m,e[12]=y}else x=e[6],z=e[7],p=e[8],f=e[9],v=e[10],m=e[11],y=e[12];let $;e[16]!==r?($=r?{scale:[1,1.4,1],rotate:[0,15,0]}:{scale:1},e[16]=r,e[17]=$):$=e[17];let k;e[18]===Symbol.for("react.memo_cache_sentinel")?(k={duration:.45,type:"spring",stiffness:300,damping:15},e[18]=k):k=e[18];const N=r?2.5:2,o=r&&z.activeFill;let _;e[19]!==o?(_=G("transition-colors duration-200",o),e[19]=o,e[20]=_):_=e[20];let S;e[21]!==s||e[22]!==h||e[23]!==N||e[24]!==_?(S=(0,t.jsx)(s,{size:h,strokeWidth:N,className:_}),e[21]=s,e[22]=h,e[23]=N,e[24]=_,e[25]=S):S=e[25];let I;e[26]!==S||e[27]!==$?(I=(0,t.jsx)(re.div,{animate:$,transition:k,children:S}),e[26]=S,e[27]=$,e[28]=I):I=e[28];let w;e[29]!==I||e[30]!==p?(w=(0,t.jsx)("div",{className:p,children:I}),e[29]=I,e[30]=p,e[31]=w):w=e[31];let b;e[32]!==a?(b=a&&(0,t.jsx)("span",{className:"hidden xs:inline",children:a}),e[32]=a,e[33]=b):b=e[33];let F;e[34]!==r||e[35]!==n?(F=n!=null&&(0,t.jsx)(re.span,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},className:G("transition-all",r?"font-black":"font-bold"),children:n||0},n),e[34]=r,e[35]=n,e[36]=F):F=e[36];let T;e[37]!==F?(T=(0,t.jsx)(It,{mode:"wait",children:F}),e[37]=F,e[38]=T):T=e[38];let M;return e[39]!==x||e[40]!==w||e[41]!==b||e[42]!==T||e[43]!==f||e[44]!==v||e[45]!==m||e[46]!==y?(M=(0,t.jsxs)(x,{whileTap:f,onClick:v,"aria-label":m,className:y,children:[w,b,T]}),e[39]=x,e[40]=w,e[41]=b,e[42]=T,e[43]=f,e[44]=v,e[45]=m,e[46]=y,e[47]=M):M=e[47],M},X=Bs,qs=q(),Hs=i=>{const e=(0,qs.c)(18),{poll:s,onVote:n}=i,a=s.options.reduce(Qs,0),[l,r]=(0,C.useState)(null);let d;e[0]!==n||e[1]!==l?(d=p=>{l||(r(p),n&&n(p))},e[0]=n,e[1]=l,e[2]=d):d=e[2];const c=d;let g;if(e[3]!==c||e[4]!==s.options||e[5]!==a||e[6]!==l){let p;e[8]!==c||e[9]!==a||e[10]!==l?(p=(f,v)=>{const m=a>0?Math.round((f.votes+(l===f.id?1:0))/(a+(l?1:0))*100):0,y=l===f.id;return(0,t.jsxs)("div",{onClick:()=>c(f.id),className:`relative h-10 w-full overflow-hidden rounded-xl border cursor-pointer ${y?"border-violet-500 dark:border-violet-500":"border-zinc-200 dark:border-zinc-700"}`,children:[l&&(0,t.jsx)("div",{className:"absolute left-0 top-0 h-full bg-zinc-200 transition-all duration-500 dark:bg-zinc-800",style:{width:`${m}%`}}),(0,t.jsxs)("div",{className:"absolute inset-0 z-10 flex items-center justify-between px-4",children:[(0,t.jsxs)("span",{className:`text-sm font-medium ${y?"font-bold text-violet-600":"text-zinc-700 dark:text-zinc-200"}`,children:[f.text," ",y&&(0,t.jsx)(Ht,{size:14,className:"mb-0.5 inline ml-1"})]}),l&&(0,t.jsxs)("span",{className:"text-sm font-bold text-zinc-900 dark:text-white",children:[m,"%"]})]})]},f.id||v)},e[8]=c,e[9]=a,e[10]=l,e[11]=p):p=e[11],g=s.options.map(p),e[3]=c,e[4]=s.options,e[5]=a,e[6]=l,e[7]=g}else g=e[7];const h=a+(l?1:0),u=l?"6 days left":"Click to vote";let x;e[12]!==h||e[13]!==u?(x=(0,t.jsxs)("div",{className:"pl-1 text-xs text-zinc-500 dark:text-zinc-400",children:[h," votes •"," ",u]}),e[12]=h,e[13]=u,e[14]=x):x=e[14];let z;return e[15]!==g||e[16]!==x?(z=(0,t.jsxs)("div",{className:"mt-3 space-y-2",children:[g,x]}),e[15]=g,e[16]=x,e[17]=z):z=e[17],z},xt=Hs;function Qs(i,e){return i+e.votes}var Gs=q(),Xs=i=>{const e=(0,Gs.c)(30),{user:s,time:n,content:a}=i,l=ce();let r;e[0]!==s.avatar||e[1]!==s.handle?(r=(0,t.jsx)(se,{src:s.avatar,alt:s.handle}),e[0]=s.avatar,e[1]=s.handle,e[2]=r):r=e[2];let d;e[3]!==s.handle[0]?(d=s.handle[0]?.toUpperCase(),e[3]=s.handle[0],e[4]=d):d=e[4];let c;e[5]!==d?(c=(0,t.jsx)(ee,{children:d}),e[5]=d,e[6]=c):c=e[6];let g;e[7]!==r||e[8]!==c?(g=(0,t.jsxs)(te,{className:"size-6",children:[r,c]}),e[7]=r,e[8]=c,e[9]=g):g=e[9];let h;e[10]!==s.handle?(h=(0,t.jsx)("span",{className:"text-sm font-semibold",children:s.handle}),e[10]=s.handle,e[11]=h):h=e[11];let u;e[12]!==g||e[13]!==h?(u=(0,t.jsxs)("div",{className:"flex items-center gap-x-2",children:[g,h]}),e[12]=g,e[13]=h,e[14]=u):u=e[14];let x;e[15]!==n?(x=(0,t.jsx)("span",{className:"text-xs text-zinc-500 sm:text-sm",children:n}),e[15]=n,e[16]=x):x=e[16];let z;e[17]!==u||e[18]!==x?(z=(0,t.jsxs)("div",{className:"mb-2 flex items-center justify-between gap-x-2",children:[u,x]}),e[17]=u,e[18]=x,e[19]=z):z=e[19];let p;e[20]!==l?(p={...Pe,render:y=>{const{attributes:$,content:k}=y,{href:N,...o}=$,_=window.location.origin;let S=null;return N.startsWith("/")?S=N:N.startsWith(_)&&(S=N.replace(_,"")),S?(0,t.jsx)("span",{...o,className:G("cursor-pointer font-medium text-violet-600 hover:underline dark:text-violet-400",o.className),onClick:I=>{I.stopPropagation(),l(S)},children:k},k):(0,t.jsx)("a",{href:N,...o,target:"_blank",rel:"noopener noreferrer",className:G("text-violet-600 hover:underline dark:text-violet-400",o.className),onClick:Js,children:k},k)}},e[20]=l,e[21]=p):p=e[21];let f;e[22]!==a?(f=(0,t.jsx)("p",{className:"whitespace-pre-line text-sm text-zinc-800 dark:text-zinc-300",children:a}),e[22]=a,e[23]=f):f=e[23];let v;e[24]!==f||e[25]!==p?(v=(0,t.jsx)(Se,{options:p,children:f}),e[24]=f,e[25]=p,e[26]=v):v=e[26];let m;return e[27]!==v||e[28]!==z?(m=(0,t.jsxs)("div",{className:"p-4",children:[z,v]}),e[27]=v,e[28]=z,e[29]=m):m=e[29],m},ft=Xs;function Js(i){return i.stopPropagation()}var Ks=q(),Zs=i=>{const e=(0,Ks.c)(54),{currentUser:s,newComment:n,setNewComment:a,handleSubmitComment:l,loading:r,selectedFiles:d,setSelectedFiles:c,isUploading:g}=i;let h;e[0]!==d?(h=d===void 0?[]:d,e[0]=d,e[1]=h):h=e[1];const u=h,x=(0,C.useRef)(null);let z;e[2]!==c?(z=j=>{if(j.target.files){const P=Array.from(j.target.files);c&&c(D=>[...D,...P])}},e[2]=c,e[3]=z):z=e[3];const p=z;let f;e[4]!==c?(f=j=>{c&&c(P=>P.filter((D,B)=>B!==j))},e[4]=c,e[5]=f):f=e[5];const v=f;let m;e[6]!==c?(m=j=>{const P=j.clipboardData.files;if(P&&P.length>0){const D=Array.from(P).filter(Ys);D.length>0&&(j.preventDefault(),c&&c(B=>[...B,...D]))}},e[6]=c,e[7]=m):m=e[7];const y=m;if(!s){let j;return e[8]===Symbol.for("react.memo_cache_sentinel")?(j=(0,t.jsx)("div",{className:"border-y border-zinc-100 bg-zinc-50/30 p-6 text-center dark:border-zinc-800 dark:bg-zinc-900/10",children:(0,t.jsx)("p",{className:"text-sm text-zinc-500",children:"Please login to join the conversation."})}),e[8]=j):j=e[8],j}let $;e[9]!==s.avatar||e[10]!==s.handle?($=(0,t.jsx)(se,{src:s.avatar,alt:s.handle,className:"object-cover"}),e[9]=s.avatar,e[10]=s.handle,e[11]=$):$=e[11];let k;e[12]!==s.handle?.[0]?(k=s.handle?.[0]?.toUpperCase(),e[12]=s.handle?.[0],e[13]=k):k=e[13];let N;e[14]!==k?(N=(0,t.jsx)(ee,{children:k}),e[14]=k,e[15]=N):N=e[15];let o;e[16]!==$||e[17]!==N?(o=(0,t.jsxs)(te,{className:"size-9 border border-zinc-200 dark:border-zinc-700",children:[$,N]}),e[16]=$,e[17]=N,e[18]=o):o=e[18];let _;e[19]!==a?(_=j=>a(j.target.value),e[19]=a,e[20]=_):_=e[20];let S;e[21]!==y||e[22]!==n||e[23]!==_?(S=(0,t.jsx)("textarea",{id:"comment-input",className:"min-h-[60px] w-full resize-none bg-transparent text-base outline-none placeholder:text-zinc-500 dark:text-white",placeholder:"Post your reply...",value:n,onChange:_,onPaste:y}),e[21]=y,e[22]=n,e[23]=_,e[24]=S):S=e[24];let I;e[25]!==v||e[26]!==u?(I=u.length>0&&(0,t.jsx)("div",{className:"mt-2 mb-2 flex flex-wrap gap-2",children:u.map((j,P)=>(0,t.jsxs)("div",{className:"relative size-20 overflow-hidden rounded-xl border border-zinc-200 dark:border-zinc-800",children:[j.type.startsWith("image/")?(0,t.jsx)("img",{src:URL.createObjectURL(j),className:"size-full object-cover",alt:""}):(0,t.jsx)("div",{className:"flex size-full items-center justify-center bg-zinc-100 dark:bg-zinc-800",children:(0,t.jsx)(Zt,{size:20,className:"text-zinc-500"})}),(0,t.jsx)("button",{onClick:()=>v(P),className:"absolute right-1 top-1 rounded-full bg-black/60 p-1 text-white transition-colors hover:bg-black",children:(0,t.jsx)(oe,{size:12})})]},P))}),e[25]=v,e[26]=u,e[27]=I):I=e[27];let w;e[28]===Symbol.for("react.memo_cache_sentinel")?(w=()=>x.current?.click(),e[28]=w):w=e[28];let b;e[29]===Symbol.for("react.memo_cache_sentinel")?(b=(0,t.jsx)("button",{type:"button",onClick:w,className:"rounded-full p-2 text-violet-600 transition-colors hover:bg-violet-50 dark:hover:bg-zinc-800",title:"Attach media",children:(0,t.jsx)(Cs,{size:20})}),e[29]=b):b=e[29];let F;e[30]!==p?(F=(0,t.jsxs)("div",{className:"flex gap-1 text-violet-600",children:[b,(0,t.jsx)("input",{type:"file",ref:x,onChange:p,multiple:!0,className:"hidden",accept:"image/*,video/*,application/pdf"})]}),e[30]=p,e[31]=F):F=e[31];const T=r||g?"primary":"animated";let M;e[32]!==g||e[33]!==r?(M=!(r||g)&&(0,t.jsx)(ve,{size:20}),e[32]=g,e[33]=r,e[34]=M):M=e[34];const E=r||g;let O;e[35]!==n||e[36]!==u.length?(O=!n.trim()&&u.length===0,e[35]=n,e[36]=u.length,e[37]=O):O=e[37];let A;e[38]!==l||e[39]!==T||e[40]!==M||e[41]!==E||e[42]!==O?(A=(0,t.jsx)(ds,{variant:T,icon:M,className:"min-w-[70px] !w-auto",onClick:l,loading:E,disabled:O,children:"Reply"}),e[38]=l,e[39]=T,e[40]=M,e[41]=E,e[42]=O,e[43]=A):A=e[43];let L;e[44]!==F||e[45]!==A?(L=(0,t.jsxs)("div",{className:"mt-2 flex items-center justify-between border-t border-zinc-100 pt-3 dark:border-zinc-800",children:[F,A]}),e[44]=F,e[45]=A,e[46]=L):L=e[46];let U;e[47]!==S||e[48]!==I||e[49]!==L?(U=(0,t.jsxs)("div",{className:"flex-1",children:[S,I,L]}),e[47]=S,e[48]=I,e[49]=L,e[50]=U):U=e[50];let W;return e[51]!==U||e[52]!==o?(W=(0,t.jsx)("div",{className:"border-y border-zinc-100 bg-zinc-50/30 p-4 dark:border-zinc-800 dark:bg-zinc-900/10",children:(0,t.jsxs)("div",{className:"flex gap-3",children:[o,U]})}),e[51]=U,e[52]=o,e[53]=W):W=e[53],W},Nt=C.memo(Zs);function Ys(i){return i.type.startsWith("image/")}var ei=q(),ti=i=>{const e=(0,ei.c)(30),{url:s}=i;let n,a;e[0]!==s?(n=["link-preview",s],a=()=>fs(s),e[0]=s,e[1]=n,e[2]=a):(n=e[1],a=e[2]);const l=!!s;let r;e[3]!==n||e[4]!==a||e[5]!==l?(r={queryKey:n,queryFn:a,staleTime:864e5,enabled:l},e[3]=n,e[4]=a,e[5]=l,e[6]=r):r=e[6];const{data:d,isLoading:c,isError:g}=Lt(r);if(c){let $;return e[7]===Symbol.for("react.memo_cache_sentinel")?($=(0,t.jsx)("div",{className:"mt-3 flex h-24 animate-pulse items-center justify-center overflow-hidden rounded-2xl border border-zinc-100 bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-900/50",children:(0,t.jsx)(He,{className:"animate-spin text-zinc-300 dark:text-zinc-700",size:24})}),e[7]=$):$=e[7],$}if(g||!d||!d.title&&!d.image)return null;let h;e[8]!==d.image||e[9]!==d.title?(h=d.image&&(0,t.jsx)("div",{className:"aspect-[1.91/1] w-full overflow-hidden border-b border-zinc-100 bg-zinc-100 dark:border-zinc-800 dark:bg-zinc-900",children:(0,t.jsx)("img",{src:d.image,alt:d.title??void 0,className:"h-full w-full object-cover transition-transform duration-500 group-hover:scale-[1.02]",onError:ii})}),e[8]=d.image,e[9]=d.title,e[10]=h):h=e[10];let u;e[11]===Symbol.for("react.memo_cache_sentinel")?(u=(0,t.jsx)(He,{size:12}),e[11]=u):u=e[11];let x;e[12]!==d.siteName?(x=(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs font-bold uppercase tracking-wider text-zinc-600",children:[u,(0,t.jsx)("span",{children:d.siteName})]}),e[12]=d.siteName,e[13]=x):x=e[13];let z;e[14]!==d.title?(z=(0,t.jsx)("div",{className:"line-clamp-2 text-[15px] font-bold leading-snug transition-colors group-hover:text-violet-700 dark:text-white",children:d.title}),e[14]=d.title,e[15]=z):z=e[15];let p;e[16]!==d.description?(p=d.description&&(0,t.jsx)("p",{className:"line-clamp-2 text-xs leading-relaxed text-zinc-600 dark:text-zinc-400",children:d.description}),e[16]=d.description,e[17]=p):p=e[17];let f;e[18]===Symbol.for("react.memo_cache_sentinel")?(f=(0,t.jsx)(Bt,{size:10}),e[18]=f):f=e[18];let v;e[19]!==s?(v=(0,t.jsxs)("div",{className:"flex items-center gap-1 pt-1 text-[11px] font-medium text-zinc-500",children:[f,(0,t.jsx)("span",{className:"truncate",children:s})]}),e[19]=s,e[20]=v):v=e[20];let m;e[21]!==v||e[22]!==x||e[23]!==z||e[24]!==p?(m=(0,t.jsxs)("div",{className:"space-y-1 p-3.5",children:[x,z,p,v]}),e[21]=v,e[22]=x,e[23]=z,e[24]=p,e[25]=m):m=e[25];let y;return e[26]!==m||e[27]!==h||e[28]!==s?(y=(0,t.jsxs)("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"group mt-3 flex flex-col overflow-hidden rounded-2xl border border-zinc-100 bg-white shadow-sm transition-all hover:bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-950 dark:hover:bg-zinc-900",onClick:si,children:[h,m]}),e[26]=m,e[27]=h,e[28]=s,e[29]=y):y=e[29],y},ht=ti;function si(i){return i.stopPropagation()}function ii(i){return i.target.style.display="none"}var li=q(),ai=i=>{const e=(0,li.c)(15),{file:s}=i;let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,t.jsx)("div",{className:"flex size-10 items-center justify-center rounded-xl bg-violet-100 text-violet-600 dark:bg-violet-900/30",children:(0,t.jsx)(Wt,{size:20})}),e[0]=n):n=e[0];let a;e[1]!==s.name?(a=(0,t.jsx)("div",{className:"truncate text-sm font-bold dark:text-white",children:s.name}),e[1]=s.name,e[2]=a):a=e[2];let l;e[3]!==s.size?(l=s.size!==void 0&&(0,t.jsxs)("div",{className:"text-xs uppercase text-zinc-500",children:[(s.size/1024/1024).toFixed(2)," MB"]}),e[3]=s.size,e[4]=l):l=e[4];let r;e[5]!==a||e[6]!==l?(r=(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[a,l]}),e[5]=a,e[6]=l,e[7]=r):r=e[7];let d;e[8]===Symbol.for("react.memo_cache_sentinel")?(d=(0,t.jsx)(qt,{size:18}),e[8]=d):d=e[8];let c;e[9]!==s.name||e[10]!==s.url?(c=(0,t.jsx)("a",{href:s.url,download:s.name,className:"p-2 text-zinc-400 transition-colors hover:text-violet-600",onClick:ri,children:d}),e[9]=s.name,e[10]=s.url,e[11]=c):c=e[11];let g;return e[12]!==r||e[13]!==c?(g=(0,t.jsxs)("div",{className:"group mt-3 flex items-center gap-3 rounded-2xl border border-zinc-100 bg-zinc-50/50 p-3 transition-colors hover:border-violet-500/30 dark:border-zinc-800 dark:bg-zinc-900/10",children:[n,r,c]}),e[12]=r,e[13]=c,e[14]=g):g=e[14],g},ni=ai;function ri(i){return i.stopPropagation()}var yt=q(),oi=C.lazy(()=>gt(()=>import("./VideoPlayer-Dkpd3B3h.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),ci=i=>{const e=(0,yt.c)(10),{item:s,onClick:n}=i,[a,l]=(0,C.useState)(!1);let r;e[0]!==a?(r=!a&&(0,t.jsx)("div",{className:"absolute inset-0 animate-pulse bg-zinc-200 dark:bg-zinc-800"}),e[0]=a,e[1]=r):r=e[1];const d=s.url||s.src,c=`size-full object-cover transition-all duration-500 hover:scale-[1.02] ${a?"opacity-100":"opacity-0"}`;let g;e[2]===Symbol.for("react.memo_cache_sentinel")?(g=()=>l(!0),e[2]=g):g=e[2];let h;e[3]!==d||e[4]!==c?(h=(0,t.jsx)("img",{src:d,className:c,alt:"",loading:"lazy",onLoad:g}),e[3]=d,e[4]=c,e[5]=h):h=e[5];let u;return e[6]!==n||e[7]!==r||e[8]!==h?(u=(0,t.jsxs)("div",{className:"relative size-full overflow-hidden",onClick:n,children:[r,h]}),e[6]=n,e[7]=r,e[8]=h,e[9]=u):u=e[9],u},di=i=>{const e=(0,yt.c)(3),{items:s}=i,n=s===void 0?[]:s,{openLightbox:a}=rs();if(!n||Array.isArray(n)&&n.length===0)return null;const l=Array.isArray(n)?n:[n],r=l.filter(xi),d=l.filter(fi),c=r.some(hi),g=p=>{const f=r.filter(ui).map(pi),v=r[p];a(f,f.indexOf(v.url||v.src))},h="mt-2 space-y-2",u=r.length>0&&(0,t.jsx)("div",{className:`grid gap-2 overflow-hidden rounded-2xl border border-zinc-100 dark:border-zinc-800 ${r.length===1?"grid-cols-1":r.length===2?c?"aspect-[8/9] grid-cols-1 grid-rows-2":"aspect-[16/9] grid-cols-2":(r.length===3,"aspect-[16/9] grid-cols-2 grid-rows-2")}`,children:r.map((p,f)=>(0,t.jsx)("div",{className:`relative cursor-pointer overflow-hidden bg-zinc-100 dark:bg-zinc-900 ${r.length===3&&f===0?"row-span-2":""}`,children:p.type==="video"?(0,t.jsx)(C.Suspense,{fallback:(0,t.jsx)("div",{className:"flex aspect-video w-full items-center justify-center bg-zinc-100 dark:bg-zinc-900",children:(0,t.jsx)("div",{className:"size-8 animate-spin rounded-full border-2 border-violet-500 border-t-transparent"})}),children:(0,t.jsx)(oi,{src:p.url,poster:p.poster||void 0})}):(0,t.jsx)(ci,{item:p,onClick:v=>{v.stopPropagation(),g(f)}})},f))}),x=d.map(gi);let z;return e[0]!==u||e[1]!==x?(z=(0,t.jsxs)("div",{className:h,children:[u,x]}),e[0]=u,e[1]=x,e[2]=z):z=e[2],z},mi=di;function xi(i){return i.type==="image"||i.type==="video"}function fi(i){return i.type==="file"}function hi(i){return i.type==="video"}function ui(i){return i.type==="image"}function pi(i){return i.url||i.src}function gi(i,e){return(0,t.jsx)(ni,{file:i},e)}var wt=q(),vi=i=>{const e=(0,wt.c)(6),{avatars:s}=i;if(!s||s.length===0)return null;let n,a;if(e[0]!==s){const r=s.slice(0,3);n="relative mt-2 h-7 w-7",a=r.map((d,c)=>{let g,h;return r.length===1?(g="top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",h="size-5"):r.length===2?(h="size-4",g=c===0?"top-0 right-0":"bottom-0 left-0"):(h=c===0?"size-3.5":"size-3",c===0?g="top-0 right-0":c===1?g="bottom-0 right-0":g="top-1/2 left-0 -translate-y-1/2"),(0,t.jsx)("div",{className:`absolute rounded-full border border-white bg-zinc-100 dark:border-black dark:bg-zinc-800 overflow-hidden shadow-sm ${g} ${h}`,style:{zIndex:10-c},children:(0,t.jsx)("img",{src:d,alt:"",className:"h-full w-full object-cover"})},c)}),e[0]=s,e[1]=n,e[2]=a}else n=e[1],a=e[2];let l;return e[3]!==n||e[4]!==a?(l=(0,t.jsx)("div",{className:n,children:a}),e[3]=n,e[4]=a,e[5]=l):l=e[5],l},ut=i=>{const e=(0,wt.c)(70),{id:s,user:n,isCurrentUser:a,isComment:l,onEdit:r,onDelete:d,addToast:c,trigger:g}=i,{openReport:h}=bt(),[u,x]=(0,C.useState)(!1);if(Ps("(min-width: 1024px)")){let w;e[0]!==g?(w=(0,t.jsx)(gs,{asChild:!0,onClick:zi,children:(0,t.jsx)("div",{className:"cursor-pointer outline-none",children:g})}),e[0]=g,e[1]=w):w=e[1];let b;e[2]!==c||e[3]!==s||e[4]!==l?(b=!l&&(0,t.jsxs)(ae,{onClick:j=>{j.stopPropagation(),navigator.clipboard.writeText(`${window.location.origin}/p/${s}`),c("Link copied"),x(!1)},children:[(0,t.jsx)(Qe,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Copy link"})]}),e[2]=c,e[3]=s,e[4]=l,e[5]=b):b=e[5];let F;e[6]!==s||e[7]!==h?(F=j=>{j.stopPropagation(),h("post",s),x(!1)},e[6]=s,e[7]=h,e[8]=F):F=e[8];let T;e[9]===Symbol.for("react.memo_cache_sentinel")?(T=(0,t.jsx)(Ne,{className:"mr-2 h-4 w-4"}),e[9]=T):T=e[9];const M=l?"comment":"post";let E;e[10]!==M?(E=(0,t.jsxs)("span",{children:["Report ",M]}),e[10]=M,e[11]=E):E=e[11];let O;e[12]!==F||e[13]!==E?(O=(0,t.jsxs)(ae,{onClick:F,children:[T,E]}),e[12]=F,e[13]=E,e[14]=O):O=e[14];let A;e[15]!==a||e[16]!==h||e[17]!==n?(A=!a&&(0,t.jsxs)(ae,{onClick:j=>{j.stopPropagation(),h("user",n.id),x(!1)},children:[(0,t.jsx)(qe,{className:"mr-2 h-4 w-4"}),(0,t.jsxs)("span",{children:["Report @",n.handle]})]}),e[15]=a,e[16]=h,e[17]=n,e[18]=A):A=e[18];let L;e[19]!==l||e[20]!==a||e[21]!==d||e[22]!==r?(L=a&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ys,{}),(0,t.jsxs)(ae,{onClick:j=>{j.stopPropagation(),r(),x(!1)},children:[(0,t.jsx)(Ge,{className:"mr-2 h-4 w-4"}),(0,t.jsxs)("span",{children:["Edit ",l?"Comment":"Post"]})]}),(0,t.jsxs)(ae,{className:"text-red-500 focus:text-red-500",onClick:j=>{j.stopPropagation(),d(),x(!1)},children:[(0,t.jsx)(Ve,{className:"mr-2 h-4 w-4"}),(0,t.jsxs)("span",{children:["Delete ",l?"comment":"post"]})]})]}),e[19]=l,e[20]=a,e[21]=d,e[22]=r,e[23]=L):L=e[23];let U;e[24]!==b||e[25]!==O||e[26]!==A||e[27]!==L?(U=(0,t.jsxs)(Ns,{align:"end",className:"w-56",onClick:Ni,children:[b,O,A,L]}),e[24]=b,e[25]=O,e[26]=A,e[27]=L,e[28]=U):U=e[28];let W;return e[29]!==u||e[30]!==w||e[31]!==U?(W=(0,t.jsx)("div",{onClick:ki,children:(0,t.jsxs)(zs,{open:u,onOpenChange:x,modal:!0,children:[w,U]})}),e[29]=u,e[30]=w,e[31]=U,e[32]=W):W=e[32],W}let z;e[33]===Symbol.for("react.memo_cache_sentinel")?(z=w=>{w.stopPropagation(),x(!0)},e[33]=z):z=e[33];let p;e[34]!==g?(p=(0,t.jsx)("div",{onClick:z,className:"cursor-pointer",children:g}),e[34]=g,e[35]=p):p=e[35];let f;e[36]===Symbol.for("react.memo_cache_sentinel")?(f=()=>x(!1),e[36]=f):f=e[36];let v;e[37]!==c||e[38]!==s||e[39]!==l?(v=!l&&(0,t.jsx)(ne,{icon:(0,t.jsx)(Qe,{size:18}),onClick:w=>{w.stopPropagation(),navigator.clipboard.writeText(`${window.location.origin}/p/${s}`),c("Link copied"),x(!1)},children:"Copy link"}),e[37]=c,e[38]=s,e[39]=l,e[40]=v):v=e[40];let m;e[41]===Symbol.for("react.memo_cache_sentinel")?(m=(0,t.jsx)(Ne,{size:18}),e[41]=m):m=e[41];let y;e[42]!==s||e[43]!==h?(y=w=>{w.stopPropagation(),h("post",s),x(!1)},e[42]=s,e[43]=h,e[44]=y):y=e[44];const $=l?"comment":"post";let k;e[45]!==y||e[46]!==$?(k=(0,t.jsxs)(ne,{icon:m,onClick:y,children:["Report ",$]}),e[45]=y,e[46]=$,e[47]=k):k=e[47];let N;e[48]!==a||e[49]!==h||e[50]!==n?(N=!a&&(0,t.jsxs)(ne,{icon:(0,t.jsx)(qe,{size:18}),onClick:w=>{w.stopPropagation(),h("user",n.id),x(!1)},children:["Report @",n.handle]}),e[48]=a,e[49]=h,e[50]=n,e[51]=N):N=e[51];let o;e[52]!==l||e[53]!==a||e[54]!==r?(o=a&&(0,t.jsxs)(ne,{icon:(0,t.jsx)(Ge,{size:18}),onClick:w=>{w.stopPropagation(),r(),x(!1)},children:["Edit ",l?"Comment":"Post"]}),e[52]=l,e[53]=a,e[54]=r,e[55]=o):o=e[55];let _;e[56]!==l||e[57]!==a||e[58]!==d?(_=a&&(0,t.jsxs)(ne,{variant:"destructive",icon:(0,t.jsx)(Ve,{size:18}),onClick:w=>{w.stopPropagation(),d(),x(!1)},children:["Delete ",l?"comment":"post"]}),e[56]=l,e[57]=a,e[58]=d,e[59]=_):_=e[59];let S;e[60]!==u||e[61]!==o||e[62]!==_||e[63]!==v||e[64]!==k||e[65]!==N?(S=(0,t.jsx)("div",{onClick:yi,children:(0,t.jsxs)(_s,{isOpen:u,onClose:f,children:[v,k,N,o,_]})}),e[60]=u,e[61]=o,e[62]=_,e[63]=v,e[64]=k,e[65]=N,e[66]=S):S=e[66];let I;return e[67]!==S||e[68]!==p?(I=(0,t.jsxs)(t.Fragment,{children:[p,S]}),e[67]=S,e[68]=p,e[69]=I):I=e[69],I},$e=({id:i,user:e,timeAgo:s,content:n,contentClass:a,media:l,quotedPost:r,stats:d,onClick:c,repostedBy:g,onUserClick:h,currentUser:u,poll:x,isDetail:z,initialComments:p,onDelete:f,onUpdate:v,isComment:m,onReply:y,community:$,parent_id:k,post_id:N,commenterAvatars:o=[]})=>{const _=ce(),{addToast:S}=_e(),{liked:I,reposted:w,localStats:b,setLocalStats:F,handleLike:T,handleRepost:M}=Ss(N||i,d,u),{deletePost:E,updatePost:O}=os(),{comments:A,fetchNextPage:L,hasNextPage:U,isFetchingNextPage:W,addComment:j,deleteComment:P,updateComment:D,isSubmitting:B}=nt(N||i,p),[Q,J]=(0,C.useState)(""),[be,Fe]=(0,C.useState)([]),[$t,Te]=(0,C.useState)(!1),[Re,ie]=(0,C.useState)(!1),[de,Z]=(0,C.useState)(!1),[K,me]=(0,C.useState)(n),[xe,fe]=(0,C.useState)(l||[]),[he,le]=(0,C.useState)([]),[Ie,Me]=(0,C.useState)(!1),[_t,je]=(0,C.useState)(!1),[ke,ue]=(0,C.useState)(null),[ze,Ee]=(0,C.useState)(!1),{comments:St,refetch:Ae}=nt(N||i,void 0,ze?i:void 0),{ref:De,inView:Le}=At({threshold:.5,triggerOnce:!0});(0,C.useEffect)(()=>{if(Le&&!m){const R=setTimeout(()=>{hs(i).catch(console.error)},1500);return()=>clearTimeout(R)}},[Le,i,m]);const Pt=(0,C.useCallback)(async()=>{!i||!N&&!i||b.comments===0||(Ee(!0),Ae())},[i,N,b.comments,Ae]),Oe=async()=>{const R=JSON.stringify(xe)!==JSON.stringify(l||[])||he.length>0;if(!K.trim()||K===n&&!R){Z(!1);return}Me(!0);try{const V=[];for(const Y of he){const Rt=await Ce(Y);V.push(Rt)}const H=[...xe,...V];m?await D({commentId:i,content:K,media:H}):await O(i,{content:K,media:H}),le([]),Z(!1),S(`${m?"Comment":"Post"} updated`),v&&v(i,K,H)}catch(V){console.error(`Failed to update ${m?"comment":"post"}:`,V),S(`Failed to update ${m?"comment":"post"}`)}finally{Me(!1)}},Ue=async R=>{R&&R.stopPropagation();try{m?await P(i):await E(i),S(`${m?"Comment":"Post"} deleted successfully`),f&&f(i)}catch(V){console.error(`Failed to delete ${m?"comment":"post"}:`,V),S(`Failed to delete ${m?"comment":"post"}`)}finally{ie(!1)}},Ft=async R=>{if(R.preventDefault(),!(!Q.trim()&&be.length===0||!u)){Te(!0);try{const V=[];for(const H of be){const Y=await Ce(H);V.push(Y)}await j({userId:u.id,content:Q,media:V,replyToId:ke?.id}),J(""),Fe([]),ue(null),F(H=>({...H,comments:(H.comments||0)+1})),S("Reply posted!")}catch(V){console.error("Failed to post comment:",V),S("Failed to post reply.")}finally{Te(!1)}}},We=u?.handle===e.handle,Tt=(R,V)=>{ue(V?{handle:R,id:m?k||i:V}:null),J(H=>{const Y=`@${R} `;return H.includes(Y)?H:Y+H}),document.getElementById("comment-input")?.focus()};return z?(0,t.jsxs)(re.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"flex flex-col",ref:De,children:[(0,t.jsxs)("article",{className:"p-5 dark:bg-black",children:[(0,t.jsx)(ct,{user:e,timeAgo:s,community:$,onUserClick:h,isDetail:!0,showAvatar:!0,actionsMenu:(0,t.jsx)(ut,{id:i,user:e,isCurrentUser:We,isComment:m,onEdit:()=>Z(!0),onDelete:()=>ie(!0),addToast:S,trigger:(0,t.jsx)("button",{"aria-label":"More options",className:"rounded-full p-2 text-zinc-500 transition-colors hover:bg-zinc-100 dark:hover:bg-zinc-800",children:(0,t.jsx)(ye,{size:20})})})}),(0,t.jsx)(dt,{content:n,isDetail:!0,isEditing:de,editedContent:K,setEditedContent:me,onCancelEdit:()=>{Z(!1),me(n),fe(l||[]),le([])},onSaveEdit:Oe,isUpdating:Ie,contentClass:a}),pe(n)&&(0,t.jsx)(ht,{url:pe(n)}),(0,t.jsx)(mt,{media:l,isEditing:de,editedMedia:xe,setEditedMedia:fe,newFiles:he,setNewFiles:le}),x&&(0,t.jsx)(xt,{poll:x,onVote:R=>xs(i,R,u.id)}),r&&(0,t.jsx)("div",{className:"mt-4 overflow-hidden rounded-2xl border border-zinc-200 shadow-sm dark:border-zinc-700",children:(0,t.jsx)(ft,{...r})}),(0,t.jsx)(ot,{views:b.views||0,likes:b.likes||0,comments:b.comments||0,isDetail:!0}),(0,t.jsx)(rt,{liked:I,reposted:w,handleLike:T,handleRepost:M,handleCommentClick:()=>document.getElementById("comment-input")?.focus(),handleShareClick:()=>je(!0),isDetail:!0,isComment:m})]}),ke&&(0,t.jsxs)("div",{className:"flex items-center justify-between bg-zinc-50 px-5 py-2 dark:bg-zinc-900/50",children:[(0,t.jsxs)("span",{className:"text-sm text-zinc-500",children:["Replying to"," ",(0,t.jsxs)("span",{className:"font-bold text-violet-600",children:["@",ke.handle]})]}),(0,t.jsx)("button",{onClick:()=>ue(null),className:"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200",children:(0,t.jsx)(oe,{size:16})})]}),(0,t.jsx)(Nt,{currentUser:u,newComment:Q,setNewComment:J,handleSubmitComment:Ft,loading:B,selectedFiles:be,setSelectedFiles:Fe,isUploading:$t}),(0,t.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:[(0,t.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:(0,t.jsxs)(t.Fragment,{children:[U&&A.length>0&&(0,t.jsxs)("button",{onClick:()=>L(),disabled:W,className:"flex w-full items-center justify-center gap-2 py-3 text-sm font-bold text-violet-600 transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[W&&(0,t.jsx)("span",{className:"animate-spin",children:"⌛"}),"View more replies"]}),A.map(R=>(0,t.jsx)($e,{...R,isComment:!0,post_id:i,onReply:Tt,onUserClick:h,currentUser:u,stats:{likes:R.stats?.likes||0,comments:R.stats?.comments||0,reposts:R.stats?.reposts||0},timeAgo:R.timeAgo||R.created_at},R.id))]})}),(0,t.jsx)(tt,{open:Re,onOpenChange:ie,children:(0,t.jsxs)(et,{onClick:R=>R.stopPropagation(),children:[(0,t.jsxs)(it,{children:[(0,t.jsx)(Ye,{children:"Are you absolutely sure?"}),(0,t.jsx)(lt,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,t.jsxs)(Xe,{children:[(0,t.jsx)(Je,{onClick:R=>R.stopPropagation(),children:"Cancel"}),(0,t.jsx)(Ke,{onClick:Ue,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]})]}):(0,t.jsxs)(re.article,{initial:{opacity:0,y:10},whileInView:{opacity:1,y:0},viewport:{once:!0,margin:"-50px"},transition:{duration:.4,ease:"easeOut"},ref:De,onClick:c,className:`px-4 transition-all ${m?"py-2 bg-transparent hover:bg-zinc-50/30 dark:hover:bg-zinc-800/20":"py-4 bg-white hover:bg-zinc-50/30 dark:bg-black dark:hover:bg-white/[0.02]"} ${c?"cursor-pointer":""}`,children:[g&&(0,t.jsxs)("div",{className:"mb-2 ml-1 flex items-center space-x-1.5 text-[13px] font-semibold text-zinc-600",children:[(0,t.jsx)(we,{size:14,className:"text-zinc-500"}),(0,t.jsxs)("span",{className:"flex cursor-pointer items-center text-zinc-700 hover:underline dark:text-zinc-300",onClick:R=>{R.stopPropagation(),h&&h(g.handle)},children:[g.handle," Reposted"]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-x-3",children:[(0,t.jsxs)("div",{className:"flex shrink-0 flex-col items-center self-stretch pt-0.5",children:[(0,t.jsx)("div",{className:"cursor-pointer",onClick:R=>{R.stopPropagation(),h&&h(e.handle)},children:(0,t.jsxs)(te,{className:`${m?"size-8":"size-10"} border-0 shadow-sm`,children:[(0,t.jsx)(se,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,t.jsx)(ee,{className:"text-xs",children:e.handle[0]?.toUpperCase()})]})}),(!m&&b.comments>0||m&&!k&&b.comments>0)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"mt-2 w-0.5 flex-1 rounded-full bg-zinc-100 dark:bg-zinc-800"}),!m&&(0,t.jsx)(vi,{avatars:o.length>0?o:(A||[]).slice(0,3).map(R=>R.user.avatar)})]})]}),(0,t.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col",children:[(0,t.jsx)(ct,{user:e,timeAgo:s,community:$,onUserClick:h,isComment:m,actionsMenu:(0,t.jsx)(ut,{id:i,user:e,isCurrentUser:We,isComment:m,onEdit:()=>Z(!0),onDelete:()=>ie(!0),addToast:S,trigger:(0,t.jsx)("button",{"aria-label":"More options",className:"rounded-full p-2 text-zinc-500 transition-colors hover:bg-zinc-100 group-hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:group-hover:bg-zinc-800/50",children:(0,t.jsx)(ye,{size:18})})})}),(0,t.jsx)(dt,{content:n,isEditing:de,editedContent:K,setEditedContent:me,onCancelEdit:()=>{Z(!1),me(n),fe(l||[]),le([])},onSaveEdit:Oe,isUpdating:Ie,contentClass:a}),pe(n)&&(0,t.jsx)(ht,{url:pe(n)}),(0,t.jsx)(mt,{media:l,isEditing:de,editedMedia:xe,setEditedMedia:fe,newFiles:he,setNewFiles:le}),x&&(0,t.jsx)(xt,{poll:x}),r&&(0,t.jsx)("div",{className:"mt-3 overflow-hidden rounded-2xl border border-zinc-200 shadow-sm transition-all hover:bg-zinc-50 dark:border-zinc-800 dark:hover:bg-zinc-900",onClick:R=>{R.stopPropagation(),_(`/p/${r.id}`)},children:(0,t.jsx)(ft,{...r})}),(0,t.jsx)(rt,{liked:I,reposted:w,handleLike:T,handleRepost:M,handleCommentClick:R=>{if(R?.stopPropagation(),y){const V=m&&k||i;y(e.handle,V)}else c&&c()},handleShareClick:R=>{R?.stopPropagation(),je(!0)},isComment:m}),(0,t.jsx)(ot,{views:b.views||0,likes:b.likes||0,comments:b.comments||0,isComment:m,onRepliesClick:()=>{ze?Ee(!1):Pt()}}),ze&&(0,t.jsxs)("div",{className:"relative mt-2 space-y-0",children:[(0,t.jsx)("div",{className:"absolute left-[19px] top-0 bottom-4 w-0.5 bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsx)("div",{className:"flex flex-col",children:St.map(R=>(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute left-[19px] top-5 h-0.5 w-4 bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsx)("div",{className:"pl-6",children:(0,t.jsx)($e,{...R,isComment:!0,post_id:N||i,onReply:y,onUserClick:h,currentUser:u,stats:{likes:R.stats?.likes||0,comments:R.stats?.comments||0,reposts:R.stats?.reposts||0},timeAgo:R.timeAgo||R.created_at})})]},R.id))})]}),(0,t.jsx)(Ct,{isOpen:_t,onClose:()=>je(!1),url:`${window.location.origin}/p/${i}`,title:"Share Post"}),(0,t.jsx)(tt,{open:Re,onOpenChange:ie,children:(0,t.jsxs)(et,{onClick:R=>R.stopPropagation(),children:[(0,t.jsxs)(it,{children:[(0,t.jsx)(Ye,{children:"Are you absolutely sure?"}),(0,t.jsx)(lt,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,t.jsxs)(Xe,{children:[(0,t.jsx)(Je,{onClick:R=>R.stopPropagation(),children:"Cancel"}),(0,t.jsx)(Ke,{onClick:Ue,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]})]})]})};function bi(i,e){const s=!i.media&&!e.media||i.media?.length===e.media?.length&&i.media?.every((a,l)=>a.url===e.media?.[l].url),n=i.repostedBy?.handle===e.repostedBy?.handle;return i.id===e.id&&i.content===e.content&&i.timeAgo===e.timeAgo&&i.user.id===e.user.id&&i.user.avatar===e.user.avatar&&i.stats.likes===e.stats.likes&&i.stats.comments===e.stats.comments&&i.stats.reposts===e.stats.reposts&&i.currentUser?.id===e.currentUser?.id&&!!s&&!!n}var ji=C.memo($e,bi);function ki(i){return i.stopPropagation()}function zi(i){return i.stopPropagation()}function Ni(i){return i.stopPropagation()}function yi(i){return i.stopPropagation()}var wi=({isOpen:i,onClose:e,url:s,title:n="Share"})=>{const[a,l]=(0,C.useState)(!1),[r,d]=(0,C.useState)(""),[c,g]=(0,C.useState)([]),[h,u]=(0,C.useState)(!1),[x,z]=(0,C.useState)(null),{addToast:p}=_e(),{currentUser:f}=jt(),v=(0,C.useCallback)(async()=>{if(f){u(!0);try{g((await st(f.id)).map(o=>o.user).filter(o=>o!==null).slice(0,5))}catch(o){console.error("Failed to fetch conversations:",o)}finally{u(!1)}}},[f]);(0,C.useEffect)(()=>{i&&f?v():(d(""),g([]))},[i,f,v]);const m=(0,C.useCallback)(async()=>{if(f){u(!0);try{g((await st(f.id)).map(o=>o.user).filter(o=>o!==null&&(o.name?.toLowerCase().includes(r.toLowerCase())||o.handle.toLowerCase().includes(r.toLowerCase()))))}catch(o){console.error("Search failed:",o)}finally{u(!1)}}},[r,f]);(0,C.useEffect)(()=>{const o=setTimeout(()=>{r.trim()&&i?m():!r.trim()&&i&&v()},300);return()=>clearTimeout(o)},[r,i,m,v]);const y=async o=>{o&&o.stopPropagation();try{await navigator.clipboard.writeText(s),l(!0),p("Link copied to clipboard!","success"),setTimeout(()=>l(!1),2e3)}catch(_){console.error("Failed to copy:",_),p("Failed to copy link","error")}},$=async o=>{if(f){z(o.id);try{await vs(await ms(f.id,o.id),f.id,s,"text"),p(`Sent to ${o.name||o.handle}!`,"success")}catch(_){console.error("Failed to send message:",_),p("Failed to send message","error")}finally{z(null)}}},k=[{name:"X",icon:Vt,color:"bg-black text-white",href:`https://twitter.com/intent/tweet?url=${encodeURIComponent(s)}`},{name:"Facebook",icon:ss,color:"bg-[#1877F2] text-white",href:`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(s)}`},{name:"LinkedIn",icon:es,color:"bg-[#0A66C2] text-white",href:`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(s)}`},{name:"WhatsApp",icon:Yt,color:"bg-[#25D366] text-white",href:`https://wa.me/?text=${encodeURIComponent(s)}`},{name:"Email",icon:ts,color:"bg-zinc-600 text-white",href:`mailto:?body=${encodeURIComponent(s)}`}],N=async()=>{if(navigator.share)try{await navigator.share({title:n,url:s})}catch(o){o.name!=="AbortError"&&console.error("Native share failed:",o)}else y()};return(0,t.jsx)(zt,{isOpen:i,onClose:e,title:n,className:"max-w-[420px] !p-0 overflow-hidden",children:(0,t.jsxs)("div",{className:"flex h-full flex-col bg-white dark:bg-zinc-900",children:[(0,t.jsx)("div",{className:"px-5 pb-2 pt-4",children:(0,t.jsxs)("div",{className:"group relative",children:[(0,t.jsx)(Ot,{className:"absolute left-3 top-1/2 size-4 -translate-y-1/2 text-zinc-400 transition-colors group-focus-within:text-violet-500"}),(0,t.jsx)("input",{type:"text",placeholder:"Search people...",value:r,onChange:o=>d(o.target.value),className:"w-full rounded-xl border-none bg-zinc-100 py-2.5 pl-10 pr-4 text-sm transition-all focus:ring-2 focus:ring-violet-500/20 outline-none dark:bg-zinc-800/50"})]})}),(0,t.jsx)("div",{className:"no-scrollbar flex min-h-[100px] items-center gap-4 overflow-x-auto px-5 py-4",children:h?(0,t.jsx)("div",{className:"flex flex-1 justify-center",children:(0,t.jsx)("span",{className:"animate-pulse font-bold text-zinc-400",children:"Loading..."})}):c.length>0?c.map(o=>(0,t.jsxs)("button",{onClick:()=>$(o),disabled:x!==null,className:"group flex shrink-0 flex-col items-center gap-1.5 disabled:opacity-50",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"size-14 overflow-hidden rounded-full border-2 border-white shadow-sm transition-transform group-hover:scale-105 bg-zinc-100 dark:bg-zinc-800 dark:border-zinc-900",children:(0,t.jsx)("img",{src:o.avatar||`https://i.pravatar.cc/150?u=${o.id}`,alt:o.handle,className:"size-full object-cover"})}),x===o.id&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center rounded-full bg-black/40",children:(0,t.jsx)("span",{className:"animate-pulse text-white font-bold",children:"..."})})]}),(0,t.jsx)("span",{className:"max-w-[60px] truncate text-[10px] font-medium text-zinc-500 dark:text-zinc-400",children:o.name?.split(" ")[0]||o.handle})]},o.id)):(0,t.jsx)("div",{className:"flex-1 py-2 text-center",children:(0,t.jsx)("span",{className:"text-xs text-zinc-400",children:"No people found"})})}),(0,t.jsx)("div",{className:"mx-5 h-px bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsxs)("div",{className:"grid grid-cols-5 gap-2 px-5 py-6",children:[k.map(o=>(0,t.jsxs)("a",{href:o.href,target:"_blank",rel:"noopener noreferrer",className:"group flex flex-col items-center gap-2",children:[(0,t.jsx)("div",{className:`size-12 ${o.color} flex items-center justify-center rounded-2xl shadow-md transition-all group-hover:-translate-y-1 group-hover:scale-110 group-hover:shadow-lg`,children:(0,t.jsx)(o.icon,{size:20,strokeWidth:2.5})}),(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-tighter text-zinc-500 dark:text-zinc-400",children:o.name})]},o.name)),(0,t.jsxs)("button",{onClick:N,className:"group flex flex-col items-center gap-2",children:[(0,t.jsx)("div",{className:"flex size-12 items-center justify-center rounded-2xl border border-zinc-200 bg-zinc-100 text-zinc-600 shadow-sm transition-all group-hover:-translate-y-1 group-hover:scale-110 dark:border-zinc-700 dark:bg-zinc-800 dark:text-zinc-300",children:(0,t.jsx)(ye,{size:20,strokeWidth:2.5})}),(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-tighter text-zinc-500 dark:text-zinc-400",children:"More"})]})]}),(0,t.jsx)("div",{className:"px-5 pb-6",children:(0,t.jsxs)("div",{className:"group relative",children:[(0,t.jsx)("input",{type:"text",readOnly:!0,value:s,className:"w-full rounded-2xl border border-zinc-200 bg-zinc-50 py-3.5 pl-4 pr-14 text-sm font-medium transition-colors focus:outline-none group-hover:border-zinc-300 dark:border-zinc-800 dark:bg-zinc-950 dark:group-hover:border-zinc-700"}),(0,t.jsx)("button",{onClick:y,className:`absolute right-1.5 top-1/2 flex -translate-y-1/2 items-center gap-2 rounded-xl h-10 px-4 text-xs font-bold shadow-sm transition-all active:scale-95 ${a?"bg-emerald-500 text-white":"bg-zinc-900 text-white hover:opacity-90 dark:bg-white dark:text-zinc-900"}`,children:a?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Kt,{size:14,strokeWidth:3}),(0,t.jsx)("span",{children:"Copied"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Ut,{size:14,strokeWidth:3}),(0,t.jsx)("span",{children:"Copy"})]})})]})}),(0,t.jsx)("div",{className:"px-5 pb-5",children:(0,t.jsxs)("button",{onClick:e,className:"group relative flex w-full items-center justify-center overflow-hidden rounded-2xl bg-zinc-900 py-4 font-bold text-white transition-all hover:shadow-xl hover:shadow-zinc-900/10 active:scale-[0.98] dark:bg-white dark:text-zinc-900 dark:hover:shadow-white/10",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-zinc-500 to-zinc-600 opacity-0 transition-opacity duration-300 group-hover:opacity-100"}),(0,t.jsx)("div",{className:"relative flex items-center gap-2",children:(0,t.jsx)("span",{children:"Close"})})]})})]})})},Ct=wi,Ci=C.lazy(()=>gt(()=>import("./dist-DzEd4B1b.js"),__vite__mapDeps([13,1,2,3,4,5,6,7])).then(i=>({default:i.Plyr}))),$i=C.memo(({reel:i,isActive:e,isMuted:s,shouldLoad:n=!0})=>{const a=ce(),{currentUser:l}=jt(),{addToast:r}=_e(),{openReport:d}=bt(),c=(0,C.useRef)(null),[g,h]=(0,C.useState)(!1),[u,x]=(0,C.useState)(!1),[z,p]=(0,C.useState)(!1),[f,v]=(0,C.useState)(!1),[m,y]=(0,C.useState)(null),[$,k]=(0,C.useState)(!1),[N,o]=(0,C.useState)(i.stats?.likes||0),[_,S]=(0,C.useState)(!1),[I,w]=(0,C.useState)(0),b=(0,C.useRef)(null),F=(0,C.useMemo)(()=>Array.isArray(i.media)?i.media[0]?.src||i.media[0]?.url:i.media?.src||i.media?.url||i.url,[i.media,i.url]);(0,C.useEffect)(()=>{v(!1);const j=c.current?.plyr;if(j&&typeof j.on=="function"){const P=()=>v(!0);return j.on("ready",P),j.on("canplay",P),j.on("loadeddata",P),()=>{typeof j.off=="function"&&(j.off("ready",P),j.off("canplay",P),j.off("loadeddata",P))}}else{const P=setTimeout(()=>v(!0),1e3);return()=>clearTimeout(P)}},[F]),(0,C.useEffect)(()=>{let j;const P=c.current?.plyr;return P&&f&&(e?j=setTimeout(()=>{if(typeof P.play=="function"){const D=P.play();D!==void 0&&D.catch(()=>{P&&(P.muted=!0,P.play().catch(()=>{}))})}},100):typeof P.pause=="function"&&P.pause()),()=>{j&&clearTimeout(j)}},[e,f]),(0,C.useEffect)(()=>{if(!l?.id||!e)return;(async()=>{try{const[P,D]=await Promise.all([ks(i.id,l.id),ls(l.id,i.user?.id)]);k(P),S(D)}catch(P){console.error("Failed to check interaction status:",P)}})()},[i.id,l?.id,e,i.user?.id]),(0,C.useEffect)(()=>{c.current?.plyr&&(c.current.plyr.muted=s)},[s]),(0,C.useEffect)(()=>{const j=c.current?.plyr;if(!j||!e)return;const P=()=>{const D=j.currentTime,B=j.duration;B>0&&w(D/B*100)};if(typeof j.on=="function")return j.on("timeupdate",P),()=>{typeof j.off=="function"&&j.off("timeupdate",P)}},[e]);const T=j=>{j.stopPropagation();const P=j.currentTarget.getBoundingClientRect(),D=j.clientX-P.left,B=Math.min(Math.max(0,D/P.width),1),Q=c.current?.plyr;Q&&Q.duration&&(Q.currentTime=B*Q.duration,w(B*100))};(0,C.useEffect)(()=>()=>{b.current&&clearTimeout(b.current)},[]);const M=j=>{const P=j.target;P.closest("button")||P.closest("a")||P.closest(".plyr__controls")||(b.current?(clearTimeout(b.current),b.current=null,O()):b.current=setTimeout(()=>{b.current=null,E()},250))},E=()=>{const j=c.current?.plyr;j&&(j.paused?(j.play().catch(()=>{}),y("play")):(j.pause(),y("pause")),setTimeout(()=>y(null),800))},O=async()=>{if(l&&(h(!0),setTimeout(()=>h(!1),1e3),!$)){k(!0),o(j=>j+1);try{await at(i.id,l.id)}catch{k(!1),o(j=>j-1)}}},A=async j=>{if(j.stopPropagation(),!l)return;const P=!$;k(P),o(D=>P?D+1:D-1);try{await at(i.id,l.id)}catch{k(!P),o(D=>P?D-1:D+1)}},L=async j=>{if(j.stopPropagation(),!l)return;const P=!_;S(P);try{await is(l.id,i.user?.id)}catch{S(!P)}},U=j=>{j.stopPropagation(),p(!0)},W=(0,C.useMemo)(()=>({source:{type:"video",sources:[{src:F,type:"video/mp4"}]},options:{controls:[],loop:{active:!0},clickToPlay:!1,ratio:"9:16",autoplay:!0,muted:!0,playsinline:!0}}),[F]);return(0,t.jsxs)("div",{"data-id":i.id,className:"reel-item relative flex h-[100dvh] w-full snap-start items-center justify-center overflow-hidden bg-black cursor-pointer",onClick:M,children:[(0,t.jsxs)("div",{className:"relative flex h-full w-full max-w-[450px] items-center justify-center",children:[(0,t.jsx)("div",{className:"w-full",children:n?(0,t.jsx)(C.Suspense,{fallback:(0,t.jsx)("div",{className:"aspect-[9/16] w-full bg-zinc-900 animate-pulse"}),children:(0,t.jsx)(Ci,{ref:c,...W})}):(0,t.jsx)("div",{className:"aspect-[9/16] w-full bg-zinc-900",children:(0,t.jsx)("img",{src:i.media?.[0]?.preview||i.media?.[0]?.thumbnail||F,className:"h-full w-full object-cover opacity-50 blur-xl",alt:"Reel preview"})})}),!f&&(0,t.jsx)("div",{className:"absolute inset-0 z-[60] flex items-center justify-center bg-zinc-900",children:(0,t.jsx)(ns,{})}),g&&(0,t.jsx)("div",{className:"pointer-events-none absolute inset-0 z-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-in zoom-in-50 fade-out fill-mode-forwards duration-500",children:(0,t.jsx)(ge,{size:120,fill:"white",className:"scale-125 text-white drop-shadow-[0_0_30px_rgba(255,255,255,0.4)]"})})}),m&&(0,t.jsx)("div",{className:"pointer-events-none absolute inset-0 z-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-in fade-in zoom-in-90 scale-100 animate-out zoom-out-110 fade-out fill-mode-forwards duration-500",children:(0,t.jsx)("div",{className:"rounded-full border border-white/20 bg-white/10 p-8 shadow-2xl backdrop-blur-md",children:m==="play"?(0,t.jsx)(Qt,{size:50,fill:"white",className:"ml-1.5 text-white"}):(0,t.jsx)(Gt,{size:50,fill:"white",className:"text-white"})})})}),(0,t.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-black/60"}),(0,t.jsxs)("div",{className:"pointer-events-none absolute bottom-6 left-4 right-16 text-white",children:[(0,t.jsxs)("div",{className:"pointer-events-auto mb-3 flex items-center gap-2",children:[(0,t.jsxs)(Dt,{to:`/u/${i.user?.handle}`,className:"flex items-center gap-2 transition-opacity hover:opacity-80",onClick:j=>j.stopPropagation(),children:[(0,t.jsxs)(te,{className:"size-10 border-2 border-white",children:[(0,t.jsx)(se,{src:i.user?.avatar,alt:i.user?.handle,className:"object-cover"}),(0,t.jsx)(ee,{children:i.user?.handle?.[0]?.toUpperCase()})]}),(0,t.jsxs)("span",{className:"font-bold",children:["@",i.user?.handle]})]}),l?.id!==i.user?.id&&(0,t.jsx)("button",{className:`ml-2 flex items-center gap-1.5 rounded-full px-3 py-1.5 text-xs font-bold transition-all active:scale-95 ${_?"border border-white/50 bg-transparent text-white":"bg-white text-black hover:bg-zinc-200"}`,onClick:L,children:_?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)($s,{size:14}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Following"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(us,{size:14}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Follow"})]})})]}),(0,t.jsx)(Se,{options:{...Pe,render:({attributes:j,content:P})=>{const{href:D,...B}=j,Q=!D.startsWith("/")&&(D.startsWith("http")||D.startsWith("www"));return D.startsWith("/u/")||D.startsWith("/tags/")||D.startsWith("/c/")||D.startsWith("/explore")?(0,t.jsx)("span",{...B,className:"cursor-pointer font-bold text-white hover:underline",onClick:J=>{J.stopPropagation(),a(D)},children:P},P):(0,t.jsx)("a",{href:D,...B,className:"text-white hover:underline",target:Q?"_blank":void 0,rel:Q?"noopener noreferrer":void 0,onClick:J=>J.stopPropagation(),children:P},P)}},children:(0,t.jsx)("p",{className:"mb-3 line-clamp-2 text-sm",children:i.content})}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs opacity-90",children:[(0,t.jsx)(Xt,{size:14,className:"animate-spin-slow"}),(0,t.jsxs)("span",{children:["Original Audio - ",i.user?.handle]})]})]}),(0,t.jsxs)("div",{className:"absolute bottom-6 right-2 z-10 flex flex-col items-center gap-6",children:[(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)("button",{className:`rounded-full p-3 backdrop-blur-md transition-all active:scale-90 ${$?"bg-rose-500/20 text-rose-500":"bg-zinc-800/50 text-white hover:bg-zinc-700"}`,onClick:A,children:(0,t.jsx)(ge,{size:28,fill:$?"currentColor":"none"})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:N})]}),(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)("button",{className:"rounded-full bg-zinc-800/50 p-3 text-white backdrop-blur-md transition-colors hover:bg-zinc-700 active:scale-90",onClick:j=>{j.stopPropagation(),x(!0)},children:(0,t.jsx)(kt,{size:28})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:i.stats?.comments||0})]}),(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)("button",{className:"rounded-full bg-zinc-800/50 p-3 text-white backdrop-blur-md transition-colors hover:bg-zinc-700 active:scale-90",onClick:U,children:(0,t.jsx)(ve,{size:28})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:i.stats?.shares||0})]}),(0,t.jsx)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:(0,t.jsx)("button",{className:"rounded-full bg-zinc-800/50 p-3 text-white backdrop-blur-md transition-colors hover:bg-rose-500/20 hover:text-rose-500 active:scale-90",onClick:j=>{j.stopPropagation(),d("reel",i.id)},children:(0,t.jsx)(Ne,{size:28})})})]}),(0,t.jsx)("div",{className:"absolute bottom-0 left-0 z-50 h-[3px] w-full bg-white/20 hover:h-[8px] transition-all cursor-pointer group",onClick:T,children:(0,t.jsx)("div",{className:"h-full bg-white shadow-[0_0_8px_rgba(255,255,255,0.8)] transition-all duration-100 ease-linear relative",style:{width:`${I}%`},children:(0,t.jsx)("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 size-3 bg-white rounded-full shadow-lg scale-0 group-hover:scale-100 transition-transform"})})})]}),(0,t.jsx)(Si,{isOpen:u,onClose:()=>x(!1),reelId:i.id,currentUser:l,showToast:r}),(0,t.jsx)(Ct,{isOpen:z,onClose:()=>p(!1),url:`${window.location.origin}/r/${i.id}`,title:"Share Reel"})]})},(i,e)=>i.isActive===e.isActive&&i.reel.id===e.reel.id&&i.isMuted===e.isMuted),Oi=$i,_i=({isOpen:i,onClose:e,reelId:s,currentUser:n,showToast:a})=>{const[l,r]=(0,C.useState)([]),[d,c]=(0,C.useState)(!1),[g,h]=(0,C.useState)(!1),[u,x]=(0,C.useState)(""),[z,p]=(0,C.useState)([]),[f,v]=(0,C.useState)(!1),[m,y]=(0,C.useState)(!0),[$,k]=(0,C.useState)(!1),[N,o]=(0,C.useState)(null),_=(0,C.useRef)(l);(0,C.useEffect)(()=>{_.current=l},[l]);const S=(0,C.useCallback)(async(w=!1)=>{if(s){w?k(!0):c(!0);try{const b=_.current,F=await bs(s,w&&b.length>0?b[b.length-1].created_at:null,10);F.length<10?y(!1):y(!0),r(w?T=>[...T,...F]:F)}catch(b){console.error("Failed to load comments:",b),a&&a("Failed to load comments","error")}finally{c(!1),k(!1)}}},[s,a]);(0,C.useEffect)(()=>{i&&s?S():(r([]),y(!0))},[i,s,S]);const I=async w=>{if(w.preventDefault(),!(!u.trim()&&z.length===0||!n)){h(!0),v(!0);try{const b=[];for(const F of z){const T=await Ce(F);b.push(T)}await ps(s,n.id,u,b,N?.id),x(""),p([]),o(null),a&&a("Reply posted!"),S()}catch(b){console.error("Failed to post comment:",b),a&&a("Failed to post reply.","error")}finally{h(!1),v(!1)}}};return(0,t.jsx)(zt,{isOpen:i,onClose:e,title:"Comments",className:"max-sm:h-[95dvh] h-[85vh] overflow-hidden !p-0 sm:max-w-xl",children:(0,t.jsxs)("div",{className:"flex h-full flex-col overflow-hidden bg-white dark:bg-zinc-900",children:[(0,t.jsx)("div",{className:"mx-auto my-3 h-1.5 w-12 shrink-0 rounded-full bg-zinc-200 dark:bg-zinc-800 sm:hidden"}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto scroll-smooth scrollbar-thin scrollbar-thumb-zinc-200 dark:scrollbar-thumb-zinc-800",children:d?(0,t.jsx)("div",{className:"flex flex-col",children:[1,2,3].map(w=>(0,t.jsx)(cs,{},w))}):l.length>0?(0,t.jsxs)("div",{className:"flex flex-col",children:[l.map(w=>(0,t.jsx)(ji,{...w,isComment:!0,post_id:s,currentUser:n,showToast:a,onReply:(b,F)=>{o(F?{handle:b,id:F}:null),x(T=>T.includes(`@${b}`)?T:T+`@${b} `)},onDelete:b=>r(F=>F.filter(T=>T.id!==b)),onUpdate:(b,F,T)=>r(M=>M.map(E=>E.id===b?{...E,content:F,media:T}:E))},w.id)),m&&(0,t.jsxs)("button",{onClick:()=>S(!0),disabled:$,className:"flex w-full items-center justify-center gap-2 py-6 text-sm font-bold text-violet-600 transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[$&&(0,t.jsx)("span",{className:"mr-2 animate-pulse",children:"..."}),"View more replies"]})]}):(0,t.jsxs)("div",{className:"flex h-full min-h-[300px] flex-col items-center justify-center p-8 text-center text-zinc-500",children:[(0,t.jsx)("div",{className:"mb-4 flex size-16 items-center justify-center rounded-full bg-zinc-100 dark:bg-zinc-900",children:(0,t.jsx)(vt,{size:32,className:"text-zinc-400"})}),(0,t.jsx)("p",{className:"text-lg font-bold dark:text-zinc-300",children:"No comments yet"}),(0,t.jsx)("p",{className:"text-sm dark:text-zinc-500",children:"Be the first to share what you think!"})]})}),(0,t.jsxs)("div",{className:"shrink-0 border-t border-zinc-100 bg-white pb-safe dark:border-zinc-800 dark:bg-zinc-900",children:[N&&(0,t.jsxs)("div",{className:"flex items-center justify-between border-b border-zinc-50 bg-zinc-50/50 px-4 py-2 dark:border-zinc-800/50 dark:bg-zinc-900/50",children:[(0,t.jsxs)("span",{className:"text-xs text-zinc-500",children:["Replying to"," ",(0,t.jsxs)("span",{className:"font-bold text-violet-600",children:["@",N.handle]})]}),(0,t.jsx)("button",{onClick:()=>o(null),className:"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200",children:(0,t.jsx)(oe,{size:14})})]}),(0,t.jsx)(Nt,{currentUser:n,newComment:u,setNewComment:x,handleSubmitComment:I,loading:g,selectedFiles:z,setSelectedFiles:p,isUploading:f})]})]})})},Si=_i,Ui=q();export{ji as n,Oi as t};
