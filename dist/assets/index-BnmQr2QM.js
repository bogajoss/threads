import{a as e}from"./rolldown-runtime-DDUpfMIz.js";import{$ as t,A as n,At as r,B as i,Bt as a,C as o,Ct as s,D as c,Dt as l,E as u,Et as d,F as f,Ft as p,G as m,Gt as h,H as g,Ht as _,I as v,It as y,J as b,Jt as x,K as S,Kt as C,L as w,Lt as T,M as E,N as D,Nt as O,O as k,Ot as A,P as j,Pt as M,Q as N,R as P,Rt as F,S as I,St as L,T as R,Tt as z,U as B,Ut as V,V as H,Vt as U,W as ee,Wt as te,X as ne,Y as W,Yt as G,Z as re,_ as ie,_t as ae,a as oe,at as se,b as ce,bt as le,c as ue,ct as de,d as fe,dt as pe,et as me,f as he,ft as ge,g as _e,gt as ve,h as ye,ht as be,i as xe,it as Se,j as Ce,k as we,kt as Te,l as Ee,lt as De,m as Oe,mt as ke,n as Ae,nt as je,o as Me,ot as Ne,p as Pe,pt as Fe,q as Ie,qt as Le,r as Re,rt as ze,s as Be,st as Ve,t as He,tt as Ue,u as We,ut as Ge,v as Ke,vt as qe,w as Je,wt as Ye,x as Xe,xt as Ze,y as Qe,yt as $e,z as et,zt as tt}from"./react-h_Ay_R0R.js";import{t as nt}from"./query-B90BCAvF.js";import{t as rt}from"./supabase-TkW-vFHi.js";import{n as it,r as at,t as ot}from"./vendor-BMykRcYb.js";(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var st=x(),K=e(G(),1);const q=rt(`https://dbkcedktqhueqnulnosq.supabase.co`,`eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRia2NlZGt0cWh1ZXFudWxub3NxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg5NzE1NTQsImV4cCI6MjA4NDU0NzU1NH0.m_Tv-H7o5mL1Nac6TH-S1JkS1x7ZN1AK_4Mt1hZlkvU`),ct=e=>e?{id:e.id,handle:e.username,name:e.display_name,avatar:e.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm`,cover:e.cover_url||`https://systemadminbd.com/uploads/675346dd55e0c7.43939630.png`,verified:e.is_verified,bio:e.bio,location:e.location,website:e.website,follower_count:e.follower_count||0,following_count:e.following_count||0,lastSeen:e.last_seen_at}:null,lt=e=>e?{...e,stats:{comments:e.comments_count||0,likes:e.likes_count||0,mirrors:e.mirrors_count||0},user:ct(e.user),timeAgo:new Date(e.created_at).toLocaleDateString()}:null,ut=e=>e?{...e,user:e.actor?.username,avatar:e.actor?.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm`}:null,dt=e=>e?{...e,media:e.media_url,user:ct(e.user)}:null,ft=async(e,t={})=>{if(!e.type.startsWith(`image/`))return e;let n={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0,initialQuality:.8,...t};try{let t=await at(e,n);return console.log(`Original size: ${(e.size/1024/1024).toFixed(2)} MB`),console.log(`Compressed size: ${(t.size/1024/1024).toFixed(2)} MB`),t}catch(t){return console.error(`Image compression failed:`,t),e}},pt=async(e,t=`media`)=>{let n=e;e.type.startsWith(`image/`)&&(n=await ft(e));let r=e.name.split(`.`).pop(),i=`${`${Math.random()}-${Date.now()}.${r}`}`,{data:a,error:o}=await q.storage.from(t).upload(i,n);if(o)throw o;let{data:{publicUrl:s}}=q.storage.from(t).getPublicUrl(a.path);return{url:s,name:e.name,type:e.type.startsWith(`image/`)?`image`:e.type.startsWith(`video/`)?`video`:`file`,size:n.size}},mt=async()=>{let{data:e,error:t}=await q.from(`posts`).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified,
                bio,
                location,
                website,
                follower_count,
                following_count
            )
        `).order(`created_at`,{ascending:!1});if(t)throw t;return e.map(lt)},ht=async e=>{let{data:t,error:n}=await q.from(`posts`).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified,
                bio,
                location,
                website,
                follower_count,
                following_count
            )
        `).eq(`id`,e).single();if(n)throw n;return lt(t)},gt=async({content:e,media:t=[],type:n=`text`,userId:r,poll:i=null,parentId:a=null})=>{let{data:o,error:s}=await q.from(`posts`).insert([{user_id:r,content:e,media:t,type:n,poll:i,parent_id:a,created_at:new Date().toISOString()}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `);if(s)throw s;return lt(o[0])},_t=async e=>{let{data:t,error:n}=await q.from(`users`).select(`*`).or(`username.ilike.%${e}%,display_name.ilike.%${e}%`).limit(5);if(n)throw n;return t.map(ct)},vt=async(e,t)=>{let{data:n}=await q.from(`conversation_participants`).select(`conversation_id`).eq(`user_id`,e),r=n.map(e=>e.conversation_id),{data:i}=await q.from(`conversation_participants`).select(`conversation_id`).eq(`user_id`,t).in(`conversation_id`,r).maybeSingle();if(i)return i.conversation_id;let{data:a,error:o}=await q.from(`conversations`).insert([{}]).select().single();if(o)throw o;return await q.from(`conversation_participants`).insert([{conversation_id:a.id,user_id:e},{conversation_id:a.id,user_id:t}]),a.id},yt=async()=>{let{data:e,error:t}=await q.from(`users`).select(`*`);if(t)throw t;return e.reduce((e,t)=>{let n=ct(t);return e[n.handle]=n,e},{})},bt=async e=>{let{data:t,error:n}=await q.from(`users`).select(`*`).eq(`username`,e).maybeSingle();if(n)throw n;return ct(t)},xt=async(e,t)=>{let{error:n}=await q.from(`users`).update({display_name:t.name,username:t.handle,avatar_url:t.avatar,bio:t.bio,cover_url:t.cover,website:t.website,location:t.location}).eq(`id`,e);if(n)throw n},St=async e=>{if(!e)return[];let{data:t,error:n}=await q.from(`notifications`).select(`
            *,
            actor:users!actor_id (
                username,
                avatar_url
            )
        `).eq(`recipient_id`,e).order(`created_at`,{ascending:!1});if(n)throw n;return t.map(ut)},Ct=async e=>{let{error:t}=await q.from(`notifications`).update({is_read:!0}).eq(`recipient_id`,e).eq(`is_read`,!1);if(t)throw t},wt=async e=>{if(!e)return 0;let{count:t,error:n}=await q.from(`notifications`).select(`*`,{count:`exact`,head:!0}).eq(`recipient_id`,e).eq(`is_read`,!1);if(n)throw n;return t||0},Tt=async e=>{if(!e)return 0;let{count:t,error:n}=await q.from(`messages`).select(`*`,{count:`exact`,head:!0}).eq(`is_read`,!1).neq(`sender_id`,e).in(`conversation_id`,(await q.from(`conversation_participants`).select(`conversation_id`).eq(`user_id`,e)).data?.map(e=>e.conversation_id)||[]);if(n)throw n;return t||0},Et=async(e,t)=>{if(!e||!t)return;let{error:n}=await q.from(`messages`).update({is_read:!0}).eq(`conversation_id`,e).neq(`sender_id`,t).eq(`is_read`,!1);if(n)throw n},Dt=async e=>{if(!e)return[];let{data:t,error:n}=await q.from(`conversation_participants`).select(`
            conversation:conversations (
                id,
                last_message_at,
                last_message_content,
                participants:conversation_participants (
                    user:users (
                        id,
                        username,
                        display_name,
                        avatar_url
                    )
                ),
                messages (
                    id,
                    is_read,
                    sender_id
                )
            )
        `).eq(`user_id`,e);if(n)throw console.error(`Supabase Error in fetchConversations:`,n.message),n;return t.map(t=>{let n=t.conversation,r=n.participants.find(t=>t.user?.id!==e)||n.participants[0],i=n.messages?.filter(t=>!t.is_read&&t.sender_id!==e).length||0;return{id:n.id,user:ct(r?.user),lastMessage:n.last_message_content||`No messages yet`,time:n.last_message_at?new Date(n.last_message_at).toLocaleTimeString([],{hour:`2-digit`,minute:`2-digit`}):``,unread:i}})},Ot=async e=>{let{data:t,error:n}=await q.from(`messages`).select(`*`).eq(`conversation_id`,e).order(`created_at`,{ascending:!0});if(n)throw n;return t},kt=async(e,t,n,r=`text`,i=[])=>{let{data:a,error:o}=await q.from(`messages`).insert([{conversation_id:e,sender_id:t,content:n,type:r,media:i}]).select();if(o)throw o;return a[0]},At=async e=>{let{data:t,error:n}=await q.from(`posts`).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `).eq(`parent_id`,e).order(`created_at`,{ascending:!0});if(n)throw n;return t.map(lt)},jt=async(e,t,n)=>{let{data:r,error:i}=await q.from(`posts`).insert([{parent_id:e,user_id:t,content:n,type:`text`,created_at:new Date().toISOString()}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `);if(i)throw i;return lt(r[0])},Mt=async(e,t)=>{let{data:n}=await q.from(`likes`).select(`*`).eq(`post_id`,e).eq(`user_id`,t).maybeSingle();return n?(await q.from(`likes`).delete().eq(`post_id`,e).eq(`user_id`,t),!1):(await q.from(`likes`).insert([{post_id:e,user_id:t}]),!0)},Nt=async(e,t)=>{if(!t)return!1;let{data:n}=await q.from(`likes`).select(`*`).eq(`post_id`,e).eq(`user_id`,t).maybeSingle();return!!n},Pt=async(e,t)=>{let{data:n}=await q.from(`follows`).select(`*`).eq(`follower_id`,e).eq(`following_id`,t).maybeSingle();return n?(await q.from(`follows`).delete().eq(`follower_id`,e).eq(`following_id`,t),!1):(await q.from(`follows`).insert([{follower_id:e,following_id:t}]),!0)},Ft=async(e,t)=>{if(!e)return!1;let{data:n}=await q.from(`follows`).select(`*`).eq(`follower_id`,e).eq(`following_id`,t).maybeSingle();return!!n},It=async e=>{let{data:t,error:n}=await q.from(`users`).select(`follower_count, following_count`).eq(`id`,e).maybeSingle();return n||!t?{followers:0,following:0}:{followers:t.follower_count||0,following:t.following_count||0}},Lt=async()=>{let{data:e,error:t}=await q.from(`stories`).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `).gt(`expires_at`,new Date().toISOString()).order(`created_at`,{ascending:!1});if(t)throw t;return e.map(dt)},Rt=async(e,t,n=`image`)=>{let{data:r,error:i}=await q.from(`stories`).insert([{user_id:e,media_url:t,type:n,expires_at:new Date(Date.now()+1440*60*1e3).toISOString()}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `);if(i)throw i;return dt(r[0])},zt=[{tag:`Lens`,posts:`0`},{tag:`Web3`,posts:`0`},{tag:`Art`,posts:`0`}];var J=e(T(),1),Bt=(0,K.createContext)();const Vt=({children:e})=>{let[t,n]=(0,K.useState)(null),[r,i]=(0,K.useState)(null),[a,o]=(0,K.useState)({}),[s,c]=(0,K.useState)(!0),l=async e=>{try{let{data:t,error:r}=await q.from(`users`).select(`*`).eq(`id`,e.id).maybeSingle();if(r)throw r;if(t){let e=ct(t);n(e),o(t=>({...t,[e.handle]:e}))}else n({id:e.id,email:e.email,name:e.email.split(`@`)[0],handle:e.email.split(`@`)[0],avatar:`https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm`,verified:!1})}catch(e){console.error(`Error fetching user profile:`,e)}finally{c(!1)}};return(0,K.useEffect)(()=>{if(!t?.id)return;let e=async()=>{await q.from(`users`).update({last_seen_at:new Date().toISOString()}).eq(`id`,t.id)};e();let n=setInterval(e,3e4),r=()=>{document.visibilityState===`visible`&&e()};return window.addEventListener(`visibilitychange`,r),window.addEventListener(`beforeunload`,e),()=>{clearInterval(n),window.removeEventListener(`visibilitychange`,r),window.removeEventListener(`beforeunload`,e)}},[t?.id]),(0,K.useEffect)(()=>{q.auth.getSession().then(({data:{session:e}})=>{e?l(e.user):c(!1)});let{data:{subscription:e}}=q.auth.onAuthStateChange((e,t)=>{t?l(t.user):(n(null),c(!1))});return()=>e.unsubscribe()},[]),(0,J.jsx)(Bt.Provider,{value:{currentUser:t,authMode:r,setAuthMode:i,profiles:a,login:async({email:e,password:t})=>{let{data:n,error:r}=await q.auth.signInWithPassword({email:e,password:t});if(r)throw r;return i(null),n},signup:async({email:e,password:t,username:n,name:r})=>{let{data:{user:a},error:o}=await q.auth.signUp({email:e,password:t,options:{data:{username:n.toLowerCase(),name:r}}});if(o)throw o;return i(null),a},logout:async()=>{await q.auth.signOut(),n(null),i(null)},updateProfile:async e=>{t&&(await xt(t.id,e),await l(t))},getProfileByHandle:async e=>{if(a[e])return a[e];let t=await bt(e);return t?(o(n=>({...n,[e]:t})),t):null},loading:s},children:!s&&e})},Y=()=>{let e=(0,K.useContext)(Bt);if(!e)throw Error(`useAuth must be used within an AuthProvider`);return e};var Ht=r(),Ut=(0,K.createContext)();const Wt=e=>{let t=(0,Ht.c)(10),{children:n}=e,{currentUser:r}=Y(),i;t[0]===Symbol.for(`react.memo_cache_sentinel`)?(i=new Set,t[0]=i):i=t[0];let[a,o]=(0,K.useState)(i),s;t[1]===r?s=t[2]:(s=()=>{if(!r?.id)return;let e=q.channel(`global_presence`,{config:{presence:{key:r.id}}});return e.on(`presence`,{event:`sync`},()=>{let t=e.presenceState(),n=new Set;Object.keys(t).forEach(e=>n.add(e)),o(n)}).subscribe(async t=>{t===`SUBSCRIBED`&&await e.track({userId:r.id,online_at:new Date().toISOString()})}),()=>{q.removeChannel(e),o(new Set)}},t[1]=r,t[2]=s);let c=r?.id,l;t[3]===c?l=t[4]:(l=[c],t[3]=c,t[4]=l),(0,K.useEffect)(s,l);let u;t[5]===a?u=t[6]:(u={onlineUsers:a},t[5]=a,t[6]=u);let d;return t[7]!==n||t[8]!==u?(d=(0,J.jsx)(Ut.Provider,{value:u,children:n}),t[7]=n,t[8]=u,t[9]=d):d=t[9],d},Gt=()=>{let e=(0,K.useContext)(Ut);if(!e)throw Error(`usePresence must be used within a PresenceProvider`);return e};var Kt=r(),qt=(0,K.createContext)();const Jt=e=>{let t=(0,Kt.c)(11),{children:n}=e,[r,i]=(0,K.useState)(Xt),a,o;t[0]===r?(a=t[1],o=t[2]):(a=()=>{localStorage.setItem(`theme`,r?`dark`:`light`),r?document.documentElement.classList.add(`dark`):document.documentElement.classList.remove(`dark`)},o=[r],t[0]=r,t[1]=a,t[2]=o),(0,K.useEffect)(a,o);let s;t[3]===r?s=t[4]:(s=()=>i(!r),t[3]=r,t[4]=s);let c=s,l;t[5]!==r||t[6]!==c?(l={darkMode:r,setDarkMode:i,toggleDarkMode:c},t[5]=r,t[6]=c,t[7]=l):l=t[7];let u;return t[8]!==n||t[9]!==l?(u=(0,J.jsx)(qt.Provider,{value:l,children:n}),t[8]=n,t[9]=l,t[10]=u):u=t[10],u},Yt=()=>{let e=(0,K.useContext)(qt);if(!e)throw Error(`useTheme must be used within a ThemeProvider`);return e};function Xt(){let e=localStorage.getItem(`theme`);return e===`dark`||!e&&window.matchMedia(`(prefers-color-scheme: dark)`).matches}var Zt=r(),Qt=e=>{let t=(0,Zt.c)(7),n;t[0]===e?n=t[1]:({...n}=e,t[0]=e,t[1]=n);let{theme:r}=E(),i=r===void 0?`system`:r,a,o;t[2]===Symbol.for(`react.memo_cache_sentinel`)?(a={success:(0,J.jsx)(ae,{className:`size-4`}),info:(0,J.jsx)(se,{className:`size-4`}),warning:(0,J.jsx)(P,{className:`size-4`}),error:(0,J.jsx)(W,{className:`size-4`}),loading:(0,J.jsx)(je,{className:`size-4 animate-spin`})},o={"--normal-bg":`var(--popover)`,"--normal-text":`var(--popover-foreground)`,"--normal-border":`var(--border)`,"--border-radius":`var(--radius)`},t[2]=a,t[3]=o):(a=t[2],o=t[3]);let s;return t[4]!==n||t[5]!==i?(s=(0,J.jsx)(A,{theme:i,className:`toaster group`,icons:a,style:o,...n}),t[4]=n,t[5]=i,t[6]=s):s=t[6],s},$t=r(),en=(0,K.createContext)();const tn=e=>{let t=(0,$t.c)(4),{children:n}=e,r=rn,i;t[0]===Symbol.for(`react.memo_cache_sentinel`)?(i={addToast:r},t[0]=i):i=t[0];let a;t[1]===Symbol.for(`react.memo_cache_sentinel`)?(a=(0,J.jsx)(Qt,{position:`bottom-center`,toastOptions:{className:`rounded-full font-bold`}}),t[1]=a):a=t[1];let o;return t[2]===n?o=t[3]:(o=(0,J.jsxs)(en.Provider,{value:i,children:[n,a]}),t[2]=n,t[3]=o),o},nn=()=>{let e=(0,K.useContext)(en);if(!e)throw Error(`useToast must be used within a ToastProvider`);return e};function rn(e,t){let n=t===void 0?`success`:t;n===`error`?Te.error(e):n===`info`?Te.info(e):Te.success(e)}var an=(0,K.createContext)();const on=({children:e})=>{let[t,n]=(0,K.useState)([]),[r,i]=(0,K.useState)(!0),a=async()=>{try{n(await mt())}catch(e){console.error(`Failed to load posts:`,e)}finally{i(!1)}};return(0,K.useEffect)(()=>{a()},[]),(0,J.jsx)(an.Provider,{value:{posts:t,setPosts:n,addPost:async e=>{let t=await gt(e);return a(),t},getPostById:e=>t.find(t=>t.id===e),getUserPosts:(e,n=`feed`)=>{let r=t.filter(t=>!!(t.user?.handle===e||t.repostedBy&&t.repostedBy.handle===e));return n===`media`?r.filter(e=>e.type===`video`||e.type===`image`||e.media?.length>0):n===`replies`?r.filter(e=>e.parent_id!==null):r},loading:r,refreshPosts:a},children:e})},sn=()=>{let e=(0,K.useContext)(an);if(!e)throw Error(`usePosts must be used within a PostProvider`);return e};var cn=r(),ln=(0,K.createContext)();const un=e=>{let t=(0,cn.c)(9),{children:n}=e,r;t[0]===Symbol.for(`react.memo_cache_sentinel`)?(r={isOpen:!1,images:[],currentIndex:0},t[0]=r):r=t[0];let[i,a]=(0,K.useState)(r),o;t[1]===Symbol.for(`react.memo_cache_sentinel`)?(o=(e,t)=>{let n=t===void 0?0:t;a({isOpen:!0,images:Array.isArray(e)?e:[e],currentIndex:n})},t[1]=o):o=t[1];let s=o,c;t[2]===Symbol.for(`react.memo_cache_sentinel`)?(c=()=>{a(fn)},t[2]=c):c=t[2];let l=c,u;t[3]===Symbol.for(`react.memo_cache_sentinel`)?(u=e=>{a(t=>({...t,currentIndex:e}))},t[3]=u):u=t[3];let d=u,f;t[4]===i?f=t[5]:(f={...i,openLightbox:s,closeLightbox:l,setIndex:d},t[4]=i,t[5]=f);let p;return t[6]!==n||t[7]!==f?(p=(0,J.jsx)(ln.Provider,{value:f,children:n}),t[6]=n,t[7]=f,t[8]=p):p=t[8],p},dn=()=>{let e=(0,K.useContext)(ln);if(!e)throw Error(`useLightbox must be used within a LightboxProvider`);return e};function fn(e){return{...e,isOpen:!1}}var pn=r();const mn=e=>{let t=(0,pn.c)(16),n=y(),r=e?.id,i;t[0]===r?i=t[1]:(i=[`unread_notifications_count`,r],t[0]=r,t[1]=i);let a;t[2]===e?.id?a=t[3]:(a=()=>wt(e?.id),t[2]=e?.id,t[3]=a);let o=!!e?.id,s;t[4]!==i||t[5]!==a||t[6]!==o?(s={queryKey:i,queryFn:a,enabled:o},t[4]=i,t[5]=a,t[6]=o,t[7]=s):s=t[7];let{data:c}=M(s),l=c===void 0?0:c,u;t[8]!==e||t[9]!==n?(u=()=>{if(!e?.id)return;let t=q.channel(`unread_count:${e.id}`).on(`postgres_changes`,{event:`*`,schema:`public`,table:`notifications`,filter:`recipient_id=eq.${e.id}`},()=>{n.invalidateQueries({queryKey:[`unread_notifications_count`,e.id]}),n.invalidateQueries({queryKey:[`notifications`,e.id]})}).subscribe();return()=>q.removeChannel(t)},t[8]=e,t[9]=n,t[10]=u):u=t[10];let d=e?.id,f;t[11]!==n||t[12]!==d?(f=[d,n],t[11]=n,t[12]=d,t[13]=f):f=t[13],(0,K.useEffect)(u,f);let p;return t[14]===l?p=t[15]:(p={unreadCount:l},t[14]=l,t[15]=p),p};var hn=r();const gn=e=>{let t=(0,hn.c)(52),n=y(),r;t[0]===Symbol.for(`react.memo_cache_sentinel`)?(r={},t[0]=r):r=t[0];let[i,a]=(0,K.useState)(r),o=(0,K.useRef)(null),s=e?.id,c;t[1]===s?c=t[2]:(c=[`conversations`,s],t[1]=s,t[2]=c);let l;t[3]===e?.id?l=t[4]:(l=()=>Dt(e?.id),t[3]=e?.id,t[4]=l);let u=!!e?.id,d;t[5]!==c||t[6]!==l||t[7]!==u?(d={queryKey:c,queryFn:l,enabled:u},t[5]=c,t[6]=l,t[7]=u,t[8]=d):d=t[8];let{data:f,isLoading:p}=M(d),m;t[9]===f?m=t[10]:(m=f===void 0?[]:f,t[9]=f,t[10]=m);let h=m,g=e?.id,_;t[11]===g?_=t[12]:(_=[`unread_messages_count`,g],t[11]=g,t[12]=_);let v;t[13]===e?.id?v=t[14]:(v=()=>Tt(e?.id),t[13]=e?.id,t[14]=v);let b=!!e?.id,x;t[15]!==v||t[16]!==b||t[17]!==_?(x={queryKey:_,queryFn:v,enabled:b},t[15]=v,t[16]=b,t[17]=_,t[18]=x):x=t[18];let{data:S}=M(x),C=S===void 0?0:S,w;t[19]!==e||t[20]!==n?(w=()=>{if(!e?.id)return;let t=q.channel(`user_messages:${e.id}`).on(`postgres_changes`,{event:`INSERT`,schema:`public`,table:`messages`},t=>{let r=t.new;n.setQueryData([`messages`,r.conversation_id],e=>e?e.find(e=>e.id===r.id)?e:[...e,r]:[r]),r.sender_id!==e.id&&n.invalidateQueries({queryKey:[`unread_messages_count`,e.id]}),n.invalidateQueries([`conversations`,e.id]),a(e=>({...e,[r.conversation_id]:!1}))}).subscribe(),r=q.channel(`chat_typing_shared`).on(`broadcast`,{event:`typing`},t=>{let{payload:n}=t,{conversationId:r,isTyping:i,userId:o}=n;o!==e.id&&a(e=>({...e,[r]:i}))}).subscribe();return o.current=r,()=>{q.removeChannel(t),q.removeChannel(r)}},t[19]=e,t[20]=n,t[21]=w):w=t[21];let T=e?.id,E;t[22]!==n||t[23]!==T?(E=[T,n],t[22]=n,t[23]=T,t[24]=E):E=t[24],(0,K.useEffect)(w,E);let D;t[25]===e?D=t[26]:(D=t=>{let{convId:n,text:r,type:i,media:a}=t,o=i===void 0?`text`:i,s=a===void 0?[]:a;return kt(n,e.id,r,o,s)},t[25]=e,t[26]=D);let k;t[27]!==e||t[28]!==n?(k=t=>{n.setQueryData([`messages`,t.conversation_id],e=>e?e.find(e=>e.id===t.id)?e:[...e,t]:[t]),n.invalidateQueries([`conversations`,e.id])},t[27]=e,t[28]=n,t[29]=k):k=t[29];let A;t[30]!==D||t[31]!==k?(A={mutationFn:D,onSuccess:k},t[30]=D,t[31]=k,t[32]=A):A=t[32];let j=O(A),N;t[33]===e?N=t[34]:(N=(t,n)=>{o.current&&o.current.send({type:`broadcast`,event:`typing`,payload:{conversationId:t,isTyping:n,userId:e.id}})},t[33]=e,t[34]=N);let P=N,F;t[35]!==e||t[36]!==n?(F=async t=>{!e?.id||!t||(await Et(t,e.id),n.invalidateQueries({queryKey:[`unread_messages_count`,e.id]}),n.invalidateQueries({queryKey:[`conversations`,e.id]}))},t[35]=e,t[36]=n,t[37]=F):F=t[37];let I=F,L;t[38]===e?.id?L=t[39]:(L=t=>(t===void 0?[]:t).map(t=>({id:t.id,sender:t.sender_id===e?.id?`me`:`them`,text:t.content,type:t.type||`text`,media:t.media||[],isRead:t.is_read,time:new Date(t.created_at).toLocaleTimeString([],{hour:`2-digit`,minute:`2-digit`})})),t[38]=e?.id,t[39]=L);let R=L,z;t[40]===j?z=t[41]:(z=(e,t,n,r)=>j.mutate({convId:e,text:t,type:n,media:r}),t[40]=j,t[41]=z);let B;return t[42]!==h||t[43]!==R||t[44]!==p||t[45]!==I||t[46]!==j.isPending||t[47]!==P||t[48]!==z||t[49]!==i||t[50]!==C?(B={conversations:h,unreadCount:C,isConvLoading:p,sendMessage:z,sendTypingStatus:P,typingStatus:i,markAsRead:I,formatMessages:R,isSending:j.isPending},t[42]=h,t[43]=R,t[44]=p,t[45]=I,t[46]=j.isPending,t[47]=P,t[48]=z,t[49]=i,t[50]=C,t[51]=B):B=t[51],B};var _n=r(),vn=()=>{let e=(0,_n.c)(12),{currentUser:t}=Y(),{unreadCount:n}=mn(t),{unreadCount:r}=gn(t),i,o,s,c,l;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(i={id:`home`,icon:Ve,path:`/`},o={id:`explore`,icon:ve,path:`/explore`},s={id:`reels`,icon:Ge,path:`/reels`},c={id:`messages`,icon:Ue,path:`/messages`},l={id:`notifications`,icon:Ye,path:`/notifications`},e[0]=i,e[1]=o,e[2]=s,e[3]=c,e[4]=l):(i=e[0],o=e[1],s=e[2],c=e[3],l=e[4]);let u=t?`/u/${t.handle}`:`/explore`,d;e[5]===u?d=e[6]:(d=[i,o,s,c,l,{id:`profile`,icon:f,path:u}],e[5]=u,e[6]=d);let p=d,m;e[7]===Symbol.for(`react.memo_cache_sentinel`)?(m=(0,J.jsx)(tt,{to:`/`,className:`mb-8 hover:scale-110 transition-transform`,children:(0,J.jsx)(`img`,{src:`https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png`,alt:`Logo`,className:`size-8 rounded-lg`})}),e[7]=m):m=e[7];let h;return e[8]!==r||e[9]!==p||e[10]!==n?(h=(0,J.jsxs)(`aside`,{className:`sticky top-0 hidden md:flex h-screen w-[68px] flex-col items-center py-5 border-r border-zinc-100 dark:border-zinc-800 shrink-0 bg-white dark:bg-black transition-colors duration-200`,children:[m,(0,J.jsx)(`nav`,{className:`flex flex-col gap-y-4 w-full items-center`,children:p.map(e=>(0,J.jsxs)(a,{to:e.path,className:yn,children:[(0,J.jsx)(e.icon,{size:26,strokeWidth:2.5}),e.id===`notifications`&&n>0&&(0,J.jsx)(`span`,{className:`absolute top-2 right-2 size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black`}),e.id===`messages`&&r>0&&(0,J.jsx)(`span`,{className:`absolute top-2 right-2 size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black`})]},e.id))})]}),e[8]=r,e[9]=p,e[10]=n,e[11]=h):h=e[11],h};function yn(e){let{isActive:t}=e;return`p-2.5 rounded-xl transition-all duration-200 border border-transparent relative ${t?`text-black dark:text-white bg-zinc-100 dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800`:`text-zinc-500 hover:bg-zinc-50 dark:hover:bg-zinc-900`}`}var bn=r(),xn=e=>{let t=(0,bn.c)(13),{value:n,onChange:r,onClear:i,placeholder:a}=e,o=a===void 0?`Search...`:a,s;t[0]===Symbol.for(`react.memo_cache_sentinel`)?(s=(0,J.jsx)(ee,{size:18,className:`absolute left-4 top-1/2 -translate-y-1/2 text-zinc-400 group-focus-within:text-violet-500 transition-colors`}),t[0]=s):s=t[0];let c;t[1]===r?c=t[2]:(c=e=>r(e.target.value),t[1]=r,t[2]=c);let l;t[3]!==o||t[4]!==c||t[5]!==n?(l=(0,J.jsx)(`input`,{className:`w-full rounded-full border border-zinc-100 dark:border-zinc-800 bg-zinc-50 dark:bg-zinc-900/50 text-zinc-900 dark:text-white px-11 py-2.5 text-sm outline-none focus:border-violet-500 focus:ring-1 focus:ring-violet-500 transition-all`,placeholder:o,value:n,onChange:c}),t[3]=o,t[4]=c,t[5]=n,t[6]=l):l=t[6];let u;t[7]!==i||t[8]!==n?(u=n&&(0,J.jsx)(`button`,{onClick:i,className:`absolute right-4 top-1/2 -translate-y-1/2 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 transition-colors`,children:(0,J.jsx)(j,{size:16})}),t[7]=i,t[8]=n,t[9]=u):u=t[9];let d;return t[10]!==l||t[11]!==u?(d=(0,J.jsxs)(`div`,{className:`relative group w-full`,children:[s,l,u]}),t[10]=l,t[11]=u,t[12]=d):d=t[12],d},Sn=r();function X(...e){return ot(it(e))}const Cn=()=>{let e=(0,Sn.c)(2),{pathname:t}=h(),n;return e[0]===t?n=e[1]:(n=[t],e[0]=t,e[1]=n),(0,K.useEffect)(Dn,n),null},wn=e=>typeof e==`string`?/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e):!1,Tn=(e,t)=>{let n=document.createElement(`canvas`),r=e.naturalWidth/e.width,i=e.naturalHeight/e.height;return n.width=t.width,n.height=t.height,n.getContext(`2d`).drawImage(e,t.x*r,t.y*i,t.width*r,t.height*i,0,0,t.width,t.height),new Promise((e,t)=>{n.toBlob(n=>{if(!n){t(Error(`Canvas is empty`));return}e(n)},`image/jpeg`,1)})},En=e=>{if(!e)return``;let t=new Date-new Date(e),n=Math.floor(t/1e3),r=Math.floor(n/60),i=Math.floor(r/60),a=Math.floor(i/24);return n<60?`Just now`:r<60?`${r}m ago`:i<24?`${i}h ago`:a<7?`${a}d ago`:new Date(e).toLocaleDateString()};function Dn(){window.scrollTo(0,0)}var On=r(),kn=e=>{let t=(0,On.c)(9),{className:n}=e,{setAuthMode:r}=Y(),i;t[0]===n?i=t[1]:(i=X(`border border-[--border] rounded-2xl p-8 flex flex-col items-center text-center gap-4 bg-[--card] shadow-sm`,n),t[0]=n,t[1]=i);let a,o;t[2]===Symbol.for(`react.memo_cache_sentinel`)?(a=(0,J.jsxs)(`div`,{className:`relative`,children:[(0,J.jsx)(`div`,{className:`size-16 rounded-full border-4 border-amber-400 border-t-transparent animate-spin duration-[3000ms]`}),(0,J.jsx)(`span`,{className:`absolute inset-0 flex items-center justify-center text-2xl`,children:`ðŸ’«`})]}),o=(0,J.jsx)(`h3`,{className:`font-extrabold text-lg text-[--foreground] mt-2 leading-tight`,children:`Get your Sysm account now!`}),t[2]=a,t[3]=o):(a=t[2],o=t[3]);let s;t[4]===r?s=t[5]:(s=(0,J.jsx)(`button`,{onClick:()=>r(`signup`),className:`w-full bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 py-2.5 rounded-full font-black text-sm uppercase tracking-wider hover:opacity-90 active:scale-95 transition-all shadow-lg cursor-pointer`,children:`Signup now`}),t[4]=r,t[5]=s);let c;return t[6]!==i||t[7]!==s?(c=(0,J.jsxs)(`div`,{className:i,children:[a,o,s]}),t[6]=i,t[7]=s,t[8]=c):c=t[8],c},An=r(),jn=e=>{let t=(0,An.c)(41),{trendingTopics:n}=e,r;t[0]===n?r=t[1]:(r=n===void 0?[]:n,t[0]=n,t[1]=r);let a=r,{currentUser:o,setAuthMode:s}=Y(),{darkMode:c,toggleDarkMode:l}=Yt(),[u,d]=(0,K.useState)(``),f;t[2]===Symbol.for(`react.memo_cache_sentinel`)?(f=[`Â© 2026 Sysm`,`Terms`,`Privacy`,`Guidelines`,`Discord`,`Sysm`,`GitHub`,`Support`,`Status`],t[2]=f):f=t[2];let p=f,m;t[3]===c?m=t[4]:(m=c?(0,J.jsx)(i,{size:20}):(0,J.jsx)(re,{size:20}),t[3]=c,t[4]=m);let h;t[5]!==m||t[6]!==l?(h=(0,J.jsx)(`button`,{onClick:l,className:`p-3 rounded-full bg-zinc-50 dark:bg-zinc-900 text-zinc-500 dark:text-zinc-400 border border-zinc-100 dark:border-zinc-800 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-all cursor-pointer`,title:`Toggle Theme`,children:m}),t[5]=m,t[6]=l,t[7]=h):h=t[7];let g=h;if(o){let e;t[8]===Symbol.for(`react.memo_cache_sentinel`)?(e=()=>d(``),t[8]=e):e=t[8];let n;t[9]===u?n=t[10]:(n=(0,J.jsx)(`div`,{className:`flex-1`,children:(0,J.jsx)(xn,{value:u,onChange:d,onClear:e})}),t[9]=u,t[10]=n);let r;t[11]!==n||t[12]!==g?(r=(0,J.jsxs)(`div`,{className:`flex items-center gap-3`,children:[n,g]}),t[11]=n,t[12]=g,t[13]=r):r=t[13];let i;t[14]===Symbol.for(`react.memo_cache_sentinel`)?(i=(0,J.jsx)(`h3`,{className:`font-extrabold text-xl mb-4 px-2 text-[--foreground]`,children:`What's happening`}),t[14]=i):i=t[14];let o;t[15]===a?o=t[16]:(o=a.map(Mn),t[15]=a,t[16]=o);let s;t[17]===o?s=t[18]:(s=(0,J.jsxs)(`div`,{className:`bg-zinc-50 dark:bg-zinc-900 rounded-2xl p-4 border border-[--border]`,children:[i,(0,J.jsx)(`div`,{className:`flex flex-col gap-1`,children:o})]}),t[17]=o,t[18]=s);let c;t[19]===Symbol.for(`react.memo_cache_sentinel`)?(c=(0,J.jsx)(`div`,{className:`flex flex-wrap gap-x-4 gap-y-2 px-2 text-[13px] text-zinc-500 font-medium pb-5`,children:p.map(Nn)}),t[19]=c):c=t[19];let l;return t[20]!==s||t[21]!==r?(l=(0,J.jsxs)(`aside`,{className:`sticky top-5 hidden w-[320px] shrink-0 flex-col gap-y-6 lg:flex overflow-y-auto max-h-screen`,children:[r,s,c]}),t[20]=s,t[21]=r,t[22]=l):l=t[22],l}let _,v;t[23]===s?(_=t[24],v=t[25]):(_=(0,J.jsx)(`button`,{onClick:()=>s(`signup`),className:`flex-1 bg-[--card] border border-[--border] py-2.5 rounded-full font-bold text-[--foreground] hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors shadow-sm cursor-pointer`,children:`Signup`}),v=()=>s(`login`),t[23]=s,t[24]=_,t[25]=v);let y;t[26]===Symbol.for(`react.memo_cache_sentinel`)?(y=(0,J.jsx)(`img`,{src:`https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png`,alt:``,className:`size-4 rounded-sm`}),t[26]=y):y=t[26];let b;t[27]===v?b=t[28]:(b=(0,J.jsxs)(`button`,{onClick:v,className:`flex-1 bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 py-2.5 rounded-full font-bold flex items-center justify-center gap-2 hover:opacity-90 transition-opacity cursor-pointer`,children:[y,`Login`]}),t[27]=v,t[28]=b);let x;t[29]!==_||t[30]!==b||t[31]!==g?(x=(0,J.jsxs)(`div`,{className:`flex gap-3`,children:[_,b,g]}),t[29]=_,t[30]=b,t[31]=g,t[32]=x):x=t[32];let S;t[33]===Symbol.for(`react.memo_cache_sentinel`)?(S=()=>d(``),t[33]=S):S=t[33];let C;t[34]===u?C=t[35]:(C=(0,J.jsx)(xn,{value:u,onChange:d,onClear:S}),t[34]=u,t[35]=C);let w;t[36]===Symbol.for(`react.memo_cache_sentinel`)?(w=(0,J.jsx)(kn,{}),t[36]=w):w=t[36];let T;t[37]===Symbol.for(`react.memo_cache_sentinel`)?(T=(0,J.jsx)(`div`,{className:`flex flex-wrap gap-x-4 gap-y-2 px-2 text-[13px] text-zinc-500 font-medium pb-5`,children:p.map(Pn)}),t[37]=T):T=t[37];let E;return t[38]!==x||t[39]!==C?(E=(0,J.jsxs)(`aside`,{className:`sticky top-5 hidden w-[350px] shrink-0 flex-col gap-y-6 lg:flex pr-4`,children:[x,C,w,T]}),t[38]=x,t[39]=C,t[40]=E):E=t[40],E};function Mn(e){return(0,J.jsxs)(`div`,{className:`px-3 py-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-xl cursor-pointer transition-colors group`,children:[(0,J.jsx)(`div`,{className:`text-xs text-zinc-500 dark:text-zinc-400 font-medium`,children:`Trending`}),(0,J.jsxs)(`div`,{className:`font-bold text-[--foreground]`,children:[`#`,e.tag]}),(0,J.jsxs)(`div`,{className:`text-xs text-zinc-500 dark:text-zinc-400`,children:[e.posts,` posts`]})]},e.tag)}function Nn(e){return(0,J.jsx)(`a`,{href:`#`,className:`hover:underline`,children:e},e)}function Pn(e){return(0,J.jsx)(`a`,{href:`#`,className:`hover:underline`,children:e},e)}var Fn=r();function Z(e){let t=(0,Fn.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=X(`relative flex size-8 shrink-0 overflow-hidden rounded-full`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,J.jsx)(we,{"data-slot":`avatar`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}function Q(e){let t=(0,Fn.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=X(`aspect-square size-full`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,J.jsx)(k,{"data-slot":`avatar-image`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}function $(e){let t=(0,Fn.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=X(`bg-muted flex size-full items-center justify-center rounded-full`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,J.jsx)(c,{"data-slot":`avatar-fallback`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}var In=r(),Ln=e=>{let t=(0,In.c)(23),{handleProfileClick:n}=e,{currentUser:r}=Y(),{unreadCount:i}=mn(r),{unreadCount:o}=gn(r),s=h(),c;t[0]===Symbol.for(`react.memo_cache_sentinel`)?(c=[{id:`home`,icon:Ve,path:`/`},{id:`explore`,icon:ve,path:`/explore`},{id:`reels`,icon:Ge,path:`/reels`},{id:`messages`,icon:Ue,path:`/messages`},{id:`notifications`,icon:Ye,path:`/notifications`}],t[0]=c):c=t[0];let l=c,u;t[1]!==o||t[2]!==i?(u=l.map(e=>(0,J.jsx)(a,{to:e.path,className:Rn,children:t=>{let{isActive:n}=t;return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(e.icon,{size:26,strokeWidth:n?2.5:2}),e.id===`notifications`&&i>0&&(0,J.jsx)(`span`,{className:`absolute top-3 right-[30%] size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black`}),e.id===`messages`&&o>0&&(0,J.jsx)(`span`,{className:`absolute top-3 right-[30%] size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black`})]})}},e.id)),t[1]=o,t[2]=i,t[3]=u):u=t[3];let d;t[4]!==r||t[5]!==n?(d=()=>{r&&n(r.handle)},t[4]=r,t[5]=n,t[6]=d):d=t[6];let f=`size-7 border-2 ${s.pathname.startsWith(`/u/`)?`border-black dark:border-white`:`border-transparent opacity-70`}`,p=r?.avatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm`,m;t[7]===p?m=t[8]:(m=(0,J.jsx)(Q,{src:p,alt:`Profile`,className:`object-cover`}),t[7]=p,t[8]=m);let g;t[9]===r?.handle?.[0]?g=t[10]:(g=r?.handle?.[0]?.toUpperCase(),t[9]=r?.handle?.[0],t[10]=g);let _;t[11]===g?_=t[12]:(_=(0,J.jsx)($,{children:g}),t[11]=g,t[12]=_);let v;t[13]!==f||t[14]!==m||t[15]!==_?(v=(0,J.jsxs)(Z,{className:f,children:[m,_]}),t[13]=f,t[14]=m,t[15]=_,t[16]=v):v=t[16];let y;t[17]!==d||t[18]!==v?(y=(0,J.jsx)(`button`,{onClick:d,className:`flex-1 flex flex-col items-center justify-center h-full`,children:v}),t[17]=d,t[18]=v,t[19]=y):y=t[19];let b;return t[20]!==y||t[21]!==u?(b=(0,J.jsxs)(`nav`,{className:`fixed bottom-0 left-0 right-0 z-[40] flex h-16 items-center border-t border-zinc-100 bg-white/90 pb-safe backdrop-blur-md dark:border-zinc-800 dark:bg-black/90 md:hidden`,children:[u,y]}),t[20]=y,t[21]=u,t[22]=b):b=t[22],b};function Rn(e){let{isActive:t}=e;return`flex flex-1 flex-col items-center justify-center h-full transition-all duration-200 relative ${t?`text-black dark:text-white`:`text-zinc-400 opacity-70`}`}var zn=r(),Bn=()=>{let e=(0,zn.c)(5),t,n;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,J.jsx)(`img`,{src:`https://systemadminbd.com/uploads/675346dd55e0c7.43939630.png`,alt:`Welcome Banner`,className:`w-full h-full object-cover group-hover:scale-105 transition-transform duration-700`}),n=(0,J.jsx)(`div`,{className:`absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent`}),e[0]=t,e[1]=n):(t=e[0],n=e[1]);let r;e[2]===Symbol.for(`react.memo_cache_sentinel`)?(r=(0,J.jsx)(`h1`,{className:`text-3xl sm:text-4xl font-black mb-1 drop-shadow-lg`,children:`Welcome to Sysm`}),e[2]=r):r=e[2];let i;e[3]===Symbol.for(`react.memo_cache_sentinel`)?(i=(0,J.jsxs)(`div`,{className:`absolute bottom-6 left-8 text-white`,children:[r,(0,J.jsxs)(`p`,{className:`text-sm sm:text-base font-medium opacity-90 tracking-wide drop-shadow-md`,children:[`a social network built by `,(0,J.jsx)(`a`,{href:`https://t.me/systemadminbd`,target:`_blank`,rel:`noopener noreferrer`,className:`hover:underline`,children:`@Systemadminbd`})]})]}),e[3]=i):i=e[3];let a;return e[4]===Symbol.for(`react.memo_cache_sentinel`)?(a=(0,J.jsxs)(`div`,{className:`relative w-full aspect-[21/9] sm:aspect-[2.5/1] rounded-3xl overflow-hidden mb-6 group cursor-pointer`,children:[t,n,i,(0,J.jsx)(`div`,{className:`absolute bottom-4 right-8`,children:(0,J.jsx)(`img`,{src:`https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png`,className:`size-12 animate-pulse opacity-80 rounded-xl`,alt:``})})]}),e[4]=a):a=e[4],a},Vn=r(),Hn=()=>{let e=(0,Vn.c)(23),t=h(),n=C(),{darkMode:r}=Yt(),i=t.pathname===`/`,a;e[0]===t.pathname?a=e[1]:(a=t.pathname.split(`/`).length>2&&t.pathname.startsWith(`/messages`),e[0]=t.pathname,e[1]=a);let o=a,s;e[2]===n?s=e[3]:(s=e=>{n(`/u/${e}`)},e[2]=n,e[3]=s);let c=s,l=`min-h-screen bg-[--background] text-[--foreground] font-sans selection:bg-violet-500 selection:text-white transition-colors duration-200 ${r?`dark`:``}`,u;e[4]===Symbol.for(`react.memo_cache_sentinel`)?(u=(0,J.jsx)(vn,{}),e[4]=u):u=e[4];let d=!o&&`pb-24 md:pb-0`,f;e[5]===d?f=e[6]:(f=X(`flex-1 flex justify-center gap-x-2 md:gap-x-8 py-0 md:py-5 px-0 md:px-4`,d),e[5]=d,e[6]=f);let p;e[7]===i?p=e[8]:(p=i&&(0,J.jsx)(Bn,{}),e[7]=i,e[8]=p);let m;e[9]===Symbol.for(`react.memo_cache_sentinel`)?(m=(0,J.jsx)(`div`,{className:`w-full`,children:(0,J.jsx)(_,{})}),e[9]=m):m=e[9];let g;e[10]===p?g=e[11]:(g=(0,J.jsxs)(`div`,{className:`w-full flex flex-col flex-1`,children:[p,m]}),e[10]=p,e[11]=g);let v;e[12]===Symbol.for(`react.memo_cache_sentinel`)?(v=(0,J.jsx)(jn,{trendingTopics:zt}),e[12]=v):v=e[12];let y;e[13]!==f||e[14]!==g?(y=(0,J.jsxs)(`div`,{className:`flex justify-center w-full max-w-[1300px] mx-auto min-h-screen px-0 sm:px-0`,children:[u,(0,J.jsxs)(`div`,{className:f,children:[g,v]})]}),e[13]=f,e[14]=g,e[15]=y):y=e[15];let b;e[16]!==c||e[17]!==o?(b=!o&&(0,J.jsx)(Ln,{handleProfileClick:c}),e[16]=c,e[17]=o,e[18]=b):b=e[18];let x;return e[19]!==y||e[20]!==b||e[21]!==l?(x=(0,J.jsxs)(`div`,{className:l,children:[y,b]}),e[19]=y,e[20]=b,e[21]=l,e[22]=x):x=e[22],x},Un=r();function Wn(e){let t=(0,Un.c)(4),n;t[0]===e?n=t[1]:({...n}=e,t[0]=e,t[1]=n);let r;return t[2]===n?r=t[3]:(r=(0,J.jsx)(R,{"data-slot":`dialog`,...n}),t[2]=n,t[3]=r),r}function Gn(e){let t=(0,Un.c)(4),n;t[0]===e?n=t[1]:({...n}=e,t[0]=e,t[1]=n);let r;return t[2]===n?r=t[3]:(r=(0,J.jsx)(Je,{"data-slot":`dialog-portal`,...n}),t[2]=n,t[3]=r),r}function Kn(e){let t=(0,Un.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=X(`data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,J.jsx)(o,{"data-slot":`dialog-overlay`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}function qn(e){let t=(0,Un.c)(15),n,r,i,a;t[0]===e?(n=t[1],r=t[2],i=t[3],a=t[4]):({className:r,children:n,showCloseButton:a,...i}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a);let o=a===void 0?!0:a,s;t[5]===Symbol.for(`react.memo_cache_sentinel`)?(s=(0,J.jsx)(Kn,{}),t[5]=s):s=t[5];let c;t[6]===r?c=t[7]:(c=X(`bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 outline-none sm:max-w-lg`,r),t[6]=r,t[7]=c);let l;t[8]===o?l=t[9]:(l=o&&(0,J.jsxs)(ce,{"data-slot":`dialog-close`,className:`ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4`,children:[(0,J.jsx)(j,{}),(0,J.jsx)(`span`,{className:`sr-only`,children:`Close`})]}),t[8]=o,t[9]=l);let u;return t[10]!==n||t[11]!==i||t[12]!==c||t[13]!==l?(u=(0,J.jsxs)(Gn,{"data-slot":`dialog-portal`,children:[s,(0,J.jsxs)(Xe,{"data-slot":`dialog-content`,className:c,...i,children:[n,l]})]}),t[10]=n,t[11]=i,t[12]=c,t[13]=l,t[14]=u):u=t[14],u}function Jn(e){let t=(0,Un.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=X(`flex flex-col gap-2 text-center sm:text-left`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,J.jsx)(`div`,{"data-slot":`dialog-header`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}function Yn(e){let t=(0,Un.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=X(`flex flex-col-reverse gap-2 sm:flex-row sm:justify-end`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,J.jsx)(`div`,{"data-slot":`dialog-footer`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}function Xn(e){let t=(0,Un.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=X(`text-lg leading-none font-semibold`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,J.jsx)(u,{"data-slot":`dialog-title`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}function Zn(e){let t=(0,Un.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=X(`text-muted-foreground text-sm`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,J.jsx)(I,{"data-slot":`dialog-description`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}var Qn=r(),$n=e=>{let t=(0,Qn.c)(20),{isOpen:n,onClose:r,title:i,children:a,footer:o,description:s,className:c}=e,l;t[0]===r?l=t[1]:(l=e=>{e||r()},t[0]=r,t[1]=l);let u=l,d;t[2]===c?d=t[3]:(d=X(`sm:max-w-md max-h-[calc(100dvh-2rem)] flex flex-col p-0 gap-0 overflow-hidden bg-white dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800`,c),t[2]=c,t[3]=d);let f;t[4]!==s||t[5]!==i?(f=i&&(0,J.jsxs)(Jn,{className:`px-5 py-4 border-b border-zinc-100 dark:border-zinc-800 shrink-0`,children:[(0,J.jsx)(Xn,{className:`text-xl font-bold`,children:i}),s&&(0,J.jsx)(Zn,{children:s})]}),t[4]=s,t[5]=i,t[6]=f):f=t[6];let p;t[7]===a?p=t[8]:(p=(0,J.jsx)(`div`,{className:`flex-1 overflow-y-auto p-5 min-h-0`,children:a}),t[7]=a,t[8]=p);let m;t[9]===o?m=t[10]:(m=o&&(0,J.jsx)(Yn,{className:`px-5 py-4 border-t border-zinc-100 dark:border-zinc-800 shrink-0 bg-white dark:bg-zinc-900`,children:o}),t[9]=o,t[10]=m);let h;t[11]!==d||t[12]!==f||t[13]!==p||t[14]!==m?(h=(0,J.jsxs)(qn,{className:d,children:[f,p,m]}),t[11]=d,t[12]=f,t[13]=p,t[14]=m,t[15]=h):h=t[15];let g;return t[16]!==u||t[17]!==n||t[18]!==h?(g=(0,J.jsx)(Wn,{open:n,onOpenChange:u,children:h}),t[16]=u,t[17]=n,t[18]=h,t[19]=g):g=t[19],g},er=r(),tr=e=>{let t=(0,er.c)(12),n,r,i,a;t[0]===e?(n=t[1],r=t[2],i=t[3],a=t[4]):({children:n,variant:i,className:a,...r}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a);let o=i===void 0?`primary`:i,s=a===void 0?``:a,c;t[5]===Symbol.for(`react.memo_cache_sentinel`)?(c={primary:`text-white hover:text-white bg-zinc-900 hover:bg-zinc-800 border border-zinc-900 dark:bg-white dark:text-black dark:border-white dark:hover:bg-zinc-200`,secondary:`text-zinc-900 border border-zinc-300 hover:border-zinc-400 bg-transparent hover:bg-zinc-50 dark:text-white dark:border-zinc-700 dark:hover:border-zinc-600 dark:hover:bg-zinc-900`,outline:`text-zinc-900 border border-zinc-300 hover:border-zinc-400 bg-white dark:bg-transparent dark:text-white dark:border-zinc-700 dark:hover:bg-zinc-900`,danger:`text-white bg-red-500 hover:bg-red-600 border border-red-500`,ghost:`text-zinc-500 hover:bg-zinc-100 dark:text-zinc-400 dark:hover:bg-zinc-800 border-transparent`},t[5]=c):c=t[5];let l=`rounded-full font-bold inline-flex items-center justify-center relative overflow-hidden px-4 py-1.5 transition-all duration-200 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:active:scale-100 touch-manipulation ${c[o]} ${s}`,u;t[6]===n?u=t[7]:(u=(0,J.jsx)(`div`,{className:`flex items-center gap-x-1.5`,children:n}),t[6]=n,t[7]=u);let d;return t[8]!==r||t[9]!==l||t[10]!==u?(d=(0,J.jsx)(`button`,{className:l,...r,children:u}),t[8]=r,t[9]=l,t[10]=u,t[11]=d):d=t[11],d},nr=r(),rr=e=>{let t=(0,nr.c)(33),{src:n,isOpen:r,onClose:i,onCropComplete:a,aspect:o,circular:s}=e,[c,l]=(0,K.useState)(),[u,d]=(0,K.useState)(null),f=(0,K.useRef)(null),p;t[0]===o?p=t[1]:(p=e=>{let{width:t,height:n}=e.currentTarget;l(o?Ke(ie({unit:`%`,width:90},o,t,n),t,n):{unit:`%`,width:80,height:80,x:10,y:10})},t[0]=o,t[1]=p);let m=p,h;t[2]!==u||t[3]!==i||t[4]!==a?(h=async()=>{if(u&&f.current)try{a(await Tn(f.current,u)),i()}catch(e){let t=e;console.error(`Error cropping image:`,t)}},t[2]=u,t[3]=i,t[4]=a,t[5]=h):h=t[5];let g=h,_;t[6]===i?_=t[7]:(_=e=>!e&&i(),t[6]=i,t[7]=_);let v;t[8]===Symbol.for(`react.memo_cache_sentinel`)?(v=(0,J.jsx)(Jn,{className:`p-4 border-b border-zinc-100 dark:border-zinc-800`,children:(0,J.jsx)(Xn,{children:`Crop Image`})}),t[8]=v):v=t[8];let y,b;t[9]===Symbol.for(`react.memo_cache_sentinel`)?(y=e=>l(e),b=e=>d(e),t[9]=y,t[10]=b):(y=t[9],b=t[10]);let x;t[11]!==m||t[12]!==n?(x=(0,J.jsx)(`img`,{ref:f,src:n,alt:`Crop preview`,onLoad:m,className:`max-h-[60vh] w-auto block`}),t[11]=m,t[12]=n,t[13]=x):x=t[13];let S;t[14]!==o||t[15]!==s||t[16]!==c||t[17]!==x?(S=(0,J.jsx)(`div`,{className:`p-6 flex items-center justify-center bg-zinc-100/50 dark:bg-zinc-950/50 min-h-[300px] max-h-[65vh] overflow-auto`,children:(0,J.jsx)(Qe,{crop:c,onChange:y,onComplete:b,aspect:o,circularCrop:s,className:`max-w-full shadow-2xl`,children:x})}),t[14]=o,t[15]=s,t[16]=c,t[17]=x,t[18]=S):S=t[18];let C;t[19]===i?C=t[20]:(C=(0,J.jsx)(tr,{variant:`outline`,onClick:i,className:`!w-auto px-6`,children:`Cancel`}),t[19]=i,t[20]=C);let w;t[21]===g?w=t[22]:(w=(0,J.jsx)(tr,{onClick:g,className:`!w-auto px-6`,children:`Apply Crop`}),t[21]=g,t[22]=w);let T;t[23]!==w||t[24]!==C?(T=(0,J.jsxs)(Yn,{className:`p-4 bg-white dark:bg-zinc-900 border-t border-zinc-100 dark:border-zinc-800 flex flex-row justify-end gap-2`,children:[C,w]}),t[23]=w,t[24]=C,t[25]=T):T=t[25];let E;t[26]!==T||t[27]!==S?(E=(0,J.jsxs)(qn,{className:`sm:max-w-2xl bg-white dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800 p-0 overflow-hidden`,children:[v,S,T]}),t[26]=T,t[27]=S,t[28]=E):E=t[28];let D;return t[29]!==r||t[30]!==E||t[31]!==_?(D=(0,J.jsx)(Wn,{open:r,onOpenChange:_,children:E}),t[29]=r,t[30]=E,t[31]=_,t[32]=D):D=t[32],D},ir=({isOpen:e,onClose:t})=>{let{currentUser:n}=Y(),{addPost:r}=sn(),{addToast:i}=nn(),[a,o]=(0,K.useState)(``),[c,l]=(0,K.useState)([]),[u,d]=(0,K.useState)(!1),[f,p]=(0,K.useState)({options:[``,``],duration:`1 day`}),[m,h]=(0,K.useState)(!1),[g,_]=(0,K.useState)(null),[v,y]=(0,K.useState)(null),b=(0,K.useRef)(null),x=e=>{let t=Array.from(e.target.files);l(e=>[...e,...t])},C=e=>{l(t=>t.filter((t,n)=>n!==e))},w=e=>{let t=c[e],n=new FileReader;n.onload=()=>{_(n.result),y(e)},n.readAsDataURL(t)},T=e=>{let t=new File([e],`cropped-${Date.now()}.jpg`,{type:`image/jpeg`}),n=[...c];n[v]=t,l(n),_(null),y(null)},E=()=>{f.options.length<4&&p(e=>({...e,options:[...e.options,``]}))},D=e=>{p(t=>({...t,options:t.options.filter((t,n)=>n!==e)}))},O=(e,t)=>{let n=[...f.options];n[e]=t,p(e=>({...e,options:n}))};return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)($n,{isOpen:e,onClose:()=>!m&&t(),title:`Create Post`,className:`sm:max-w-xl`,footer:(0,J.jsxs)(`div`,{className:`flex items-center justify-between w-full`,children:[(0,J.jsxs)(`div`,{className:`flex text-violet-600 gap-1`,children:[(0,J.jsx)(`button`,{type:`button`,onClick:()=>b.current?.click(),className:`p-2.5 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full transition-colors`,title:`Attach media`,children:(0,J.jsx)(Ne,{size:22})}),(0,J.jsx)(`button`,{type:`button`,onClick:()=>d(!0),className:`p-2.5 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full transition-colors`,title:`Add poll`,children:(0,J.jsx)(s,{size:22})}),(0,J.jsx)(`button`,{type:`button`,className:`p-2.5 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full transition-colors`,children:(0,J.jsx)(me,{size:22})}),(0,J.jsx)(`input`,{type:`file`,ref:b,onChange:x,multiple:!0,className:`hidden`,accept:`image/*,video/*,application/pdf`})]}),(0,J.jsx)(tr,{onClick:async e=>{if(e.preventDefault(),!(!a.trim()&&c.length===0||!n)){h(!0);try{let e=[];for(let t of c){let n=await pt(t);e.push(n)}let s=null;u&&f.options.some(e=>e.trim())&&(s={options:f.options.filter(e=>e.trim()).map((e,t)=>({id:t+1,text:e,votes:0})),ends_at:new Date(Date.now()+1440*60*1e3).toISOString()}),await r({content:a,media:e,poll:s,type:e.length>0?e[0].type===`video`?`video`:`image`:s?`poll`:`text`,userId:n.id}),o(``),l([]),d(!1),p({options:[``,``],duration:`1 day`}),t(),i(`Post published!`)}catch(e){console.error(`Failed to create post:`,e),i(`Failed to publish post.`)}finally{h(!1)}}},disabled:!a.trim()&&c.length===0||m,className:`px-8 py-2.5 min-w-[100px] text-base`,children:m?(0,J.jsx)(je,{size:18,className:`animate-spin`}):`Post`})]}),children:(0,J.jsx)(`div`,{className:`space-y-4`,children:(0,J.jsxs)(`div`,{className:`flex gap-3`,children:[(0,J.jsxs)(Z,{className:`size-12 border border-zinc-200 dark:border-zinc-800`,children:[(0,J.jsx)(Q,{src:n?.avatar,className:`object-cover`}),(0,J.jsx)($,{children:n?.handle?.[0]?.toUpperCase()})]}),(0,J.jsxs)(`div`,{className:`flex-1`,children:[(0,J.jsx)(`textarea`,{className:`w-full bg-transparent border-none outline-none text-lg min-h-[120px] resize-none dark:text-white`,placeholder:`What's happening?`,autoFocus:!0,value:a,onChange:e=>o(e.target.value)}),u&&(0,J.jsxs)(`div`,{className:`mt-4 p-4 rounded-2xl border border-zinc-100 dark:border-zinc-800 space-y-3 bg-zinc-50/50 dark:bg-zinc-900/50`,children:[(0,J.jsxs)(`div`,{className:`flex justify-between items-center mb-2`,children:[(0,J.jsx)(`span`,{className:`text-sm font-bold opacity-60`,children:`Poll`}),(0,J.jsx)(`button`,{type:`button`,onClick:()=>d(!1),className:`text-zinc-500 hover:text-rose-500`,children:(0,J.jsx)(j,{size:18})})]}),f.options.map((e,t)=>(0,J.jsxs)(`div`,{className:`flex gap-2`,children:[(0,J.jsx)(`input`,{className:`flex-1 bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-xl px-4 py-2 text-sm outline-none focus:border-violet-500`,placeholder:`Option ${t+1}`,value:e,onChange:e=>O(t,e.target.value)}),f.options.length>2&&(0,J.jsx)(`button`,{type:`button`,onClick:()=>D(t),className:`p-2 text-rose-500 hover:bg-rose-50 dark:hover:bg-rose-900/20 rounded-lg transition-colors`,children:(0,J.jsx)(et,{size:16})})]},t)),f.options.length<4&&(0,J.jsx)(`button`,{type:`button`,onClick:E,className:`text-sm font-bold text-violet-600 hover:bg-violet-50 dark:hover:bg-violet-900/20 px-3 py-1.5 rounded-lg transition-colors`,children:`+ Add option`})]}),c.length>0&&(0,J.jsx)(`div`,{className:`mt-4 flex flex-wrap gap-2`,children:c.map((e,t)=>(0,J.jsxs)(`div`,{className:`relative group size-24 rounded-xl overflow-hidden bg-zinc-100 dark:bg-zinc-800 border dark:border-zinc-700`,children:[e.type.startsWith(`image/`)?(0,J.jsx)(`img`,{src:URL.createObjectURL(e),className:`size-full object-cover`,alt:``}):(0,J.jsx)(`div`,{className:`size-full flex items-center justify-center text-zinc-500`,children:e.type.startsWith(`video/`)?(0,J.jsx)(S,{size:24,className:`animate-pulse`}):(0,J.jsx)(pe,{size:24})}),(0,J.jsx)(`button`,{type:`button`,onClick:()=>C(t),className:`absolute top-1 right-1 size-6 rounded-full bg-black/60 text-white flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity`,children:(0,J.jsx)(j,{size:14,strokeWidth:3})}),e.type.startsWith(`image/`)&&(0,J.jsx)(`button`,{type:`button`,onClick:()=>w(t),className:`absolute bottom-1 right-1 size-6 rounded-full bg-black/60 text-white flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity`,title:`Crop image`,children:(0,J.jsx)(be,{size:14,strokeWidth:3})})]},t))})]})]})})}),g&&(0,J.jsx)(rr,{src:g,isOpen:!!g,onClose:()=>{_(null),y(null)},onCropComplete:T,aspect:void 0})]})},ar=r(),or=K.forwardRef((e,t)=>{let n=(0,ar.c)(20),r,i,a,o,s;n[0]===e?(r=n[1],i=n[2],a=n[3],o=n[4],s=n[5]):({className:r,label:i,type:s,textarea:o,...a}=e,n[0]=e,n[1]=r,n[2]=i,n[3]=a,n[4]=o,n[5]=s);let c=o?`textarea`:`input`,l;n[6]===i?l=n[7]:(l=i&&(0,J.jsx)(`label`,{className:`text-sm font-bold text-zinc-500 dark:text-zinc-400 ml-1`,children:i}),n[6]=i,n[7]=l);let u=o&&`min-h-[100px] resize-none`,d;n[8]!==r||n[9]!==u?(d=X(`flex w-full rounded-xl border border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900 px-4 py-2.5 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-zinc-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:ring-offset-zinc-950 dark:text-white transition-all`,u,r),n[8]=r,n[9]=u,n[10]=d):d=n[10];let f;n[11]!==c||n[12]!==a||n[13]!==t||n[14]!==d||n[15]!==s?(f=(0,J.jsx)(c,{type:s,className:d,ref:t,...a}),n[11]=c,n[12]=a,n[13]=t,n[14]=d,n[15]=s,n[16]=f):f=n[16];let p;return n[17]!==l||n[18]!==f?(p=(0,J.jsxs)(`div`,{className:`w-full space-y-1.5`,children:[l,f]}),n[17]=l,n[18]=f,n[19]=p):p=n[19],p});or.displayName=`Input`;var sr=or,cr=({isOpen:e,onClose:t,editProfileData:n,setEditProfileData:r})=>{let{updateProfile:i}=Y(),{addToast:a}=nn(),[o,s]=(0,K.useState)(!1),[c,l]=(0,K.useState)(null),[u,d]=(0,K.useState)(null),[f,p]=(0,K.useState)(null),[m,h]=(0,K.useState)(null),g=(0,K.useRef)(null),_=(0,K.useRef)(null),v=(e,t)=>{let n=e.target.files[0];if(n){let e=new FileReader;e.onload=()=>{p(e.result),h(t)},e.readAsDataURL(n)}};return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)($n,{isOpen:e,onClose:()=>!o&&t(),title:`Edit Profile`,children:(0,J.jsxs)(`div`,{className:`space-y-6`,children:[(0,J.jsx)(`input`,{type:`file`,ref:_,className:`hidden`,accept:`image/*`,onChange:e=>v(e,`cover`)}),(0,J.jsx)(`input`,{type:`file`,ref:g,className:`hidden`,accept:`image/*`,onChange:e=>v(e,`avatar`)}),(0,J.jsxs)(`div`,{className:`relative h-32 bg-zinc-100 dark:bg-zinc-800 rounded-xl overflow-hidden group cursor-pointer`,onClick:()=>_.current?.click(),children:[(u||n?.cover)&&(0,J.jsx)(`img`,{src:u?URL.createObjectURL(u):n.cover,className:`w-full h-full object-cover opacity-60`,alt:``}),(0,J.jsx)(`div`,{className:`absolute inset-0 flex items-center justify-center`,children:(0,J.jsx)(`div`,{className:`bg-black/50 p-2 rounded-full text-white group-hover:scale-110 transition-transform`,children:(0,J.jsx)(S,{size:20})})})]}),(0,J.jsx)(`div`,{className:`relative -mt-16 ml-4`,children:(0,J.jsxs)(`div`,{className:`relative size-24 rounded-full border-4 border-white dark:border-black overflow-hidden group cursor-pointer shadow-lg bg-white dark:bg-black`,onClick:()=>g.current?.click(),children:[(c||n?.avatar)&&(0,J.jsxs)(Z,{className:`size-full opacity-60 rounded-none`,children:[(0,J.jsx)(Q,{src:c?URL.createObjectURL(c):n.avatar,className:`object-cover`}),(0,J.jsx)($,{children:n?.handle?.[0]?.toUpperCase()})]}),(0,J.jsx)(`div`,{className:`absolute inset-0 flex items-center justify-center`,children:(0,J.jsx)(`div`,{className:`bg-black/50 p-2 rounded-full text-white group-hover:scale-110 transition-transform`,children:(0,J.jsx)(S,{size:16})})})]})}),(0,J.jsxs)(`div`,{className:`space-y-4`,children:[(0,J.jsx)(sr,{label:`Name`,value:n?.name||``,onChange:e=>r({...n,name:e.target.value})}),(0,J.jsx)(sr,{label:`Bio`,textarea:!0,value:n?.bio||``,onChange:e=>r({...n,bio:e.target.value})}),(0,J.jsx)(sr,{label:`Location`,value:n?.location||``,onChange:e=>r({...n,location:e.target.value})}),(0,J.jsx)(sr,{label:`Website`,value:n?.website||``,onChange:e=>r({...n,website:e.target.value})})]}),(0,J.jsx)(tr,{className:`w-full py-3`,disabled:o,onClick:async()=>{s(!0);try{let e=n.avatar,r=n.cover;c&&(e=(await pt(c)).url),u&&(r=(await pt(u)).url),await i({...n,avatar:e,cover:r}),l(null),d(null),t(),a(`Profile updated!`)}catch(e){console.error(`Failed to update profile:`,e),a(`Failed to update profile.`,`error`)}finally{s(!1)}},children:o?(0,J.jsx)(je,{size:24,className:`animate-spin text-white mx-auto`}):`Save changes`})]})}),f&&(0,J.jsx)(rr,{src:f,isOpen:!!f,onClose:()=>{p(null),h(null)},onCropComplete:e=>{let t=new File([e],`cropped-${Date.now()}.jpg`,{type:`image/jpeg`});m===`avatar`?l(t):d(t),p(null),h(null)},aspect:m===`avatar`?1:m===`cover`?3/1:void 0,circular:m===`avatar`})]})},lr=({isOpen:e,onClose:t})=>{let{currentUser:n}=Y(),{addToast:r}=nn(),i=y(),[a,o]=(0,K.useState)(null),[s,c]=(0,K.useState)(!1),[l,u]=(0,K.useState)(null),d=(0,K.useRef)(null);return(0,J.jsxs)($n,{isOpen:e,onClose:()=>!s&&t(),title:`Add Story`,children:[(0,J.jsxs)(`div`,{className:`space-y-6`,children:[a?(0,J.jsxs)(`div`,{className:`space-y-6`,children:[(0,J.jsxs)(`div`,{className:`relative aspect-[9/16] w-full max-w-[280px] mx-auto rounded-3xl overflow-hidden shadow-2xl border dark:border-zinc-800`,children:[(0,J.jsx)(`img`,{src:URL.createObjectURL(a),className:`w-full h-full object-cover`,alt:`Preview`}),(0,J.jsx)(`button`,{onClick:()=>o(null),className:`absolute top-4 right-4 p-2 bg-black/50 text-white rounded-full hover:bg-rose-500 transition-colors`,title:`Remove`,children:(0,J.jsx)(j,{size:20})})]}),(0,J.jsxs)(`div`,{className:`flex items-center justify-center gap-4 py-2 border-y border-zinc-100 dark:border-zinc-800 bg-zinc-50/50 dark:bg-zinc-900/50 rounded-2xl`,children:[(0,J.jsxs)(`button`,{onClick:()=>{if(!a)return;let e=new FileReader;e.onload=()=>{u(e.result)},e.readAsDataURL(a)},className:`flex flex-col items-center gap-1.5 p-3 rounded-xl hover:bg-white dark:hover:bg-zinc-800 transition-all text-zinc-600 dark:text-zinc-400 hover:text-violet-600 dark:hover:text-violet-400 group`,children:[(0,J.jsx)(`div`,{className:`p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm group-hover:shadow-md transition-all`,children:(0,J.jsx)(Ie,{size:20})}),(0,J.jsx)(`span`,{className:`text-[10px] font-bold uppercase tracking-wider`,children:`Crop / Edit`})]}),(0,J.jsxs)(`button`,{className:`flex flex-col items-center gap-1.5 p-3 rounded-xl opacity-40 cursor-not-allowed text-zinc-600 dark:text-zinc-400`,children:[(0,J.jsx)(`div`,{className:`p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm`,children:(0,J.jsx)(`svg`,{size:20,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,strokeWidth:`2`,className:`w-5 h-5`,children:(0,J.jsx)(`path`,{d:`M17 3a2.828 2.828 0 1 1 4 4L7.5 21 3 22l1-4.5L17 3z`})})}),(0,J.jsx)(`span`,{className:`text-[10px] font-bold uppercase tracking-wider`,children:`Text`})]}),(0,J.jsxs)(`button`,{className:`flex flex-col items-center gap-1.5 p-3 rounded-xl opacity-40 cursor-not-allowed text-zinc-600 dark:text-zinc-400`,children:[(0,J.jsx)(`div`,{className:`p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm`,children:(0,J.jsxs)(`svg`,{size:20,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,strokeWidth:`2`,className:`w-5 h-5`,children:[(0,J.jsx)(`circle`,{cx:`12`,cy:`12`,r:`10`}),(0,J.jsx)(`path`,{d:`M8 14s1.5 2 4 2 4-2 4-2`}),(0,J.jsx)(`line`,{x1:`9`,y1:`9`,x2:`9.01`,y2:`9`}),(0,J.jsx)(`line`,{x1:`15`,y1:`9`,x2:`15.01`,y2:`9`})]})}),(0,J.jsx)(`span`,{className:`text-[10px] font-bold uppercase tracking-wider`,children:`Stickers`})]})]})]}):(0,J.jsxs)(`div`,{className:`py-10`,children:[(0,J.jsxs)(`div`,{className:`relative w-full group`,onClick:()=>d.current?.click(),children:[(0,J.jsx)(`div`,{className:`relative z-40 cursor-pointer group-hover:translate-x-8 group-hover:shadow-2xl group-hover:-translate-y-8 transition-all duration-500 bg-zinc-900 dark:bg-white flex items-center justify-center h-32 w-32 mx-auto rounded-xl border-4 border-white dark:border-zinc-900`,children:(0,J.jsxs)(`svg`,{className:`h-8 w-8 text-white/60 dark:text-zinc-950/60`,strokeLinejoin:`round`,strokeLinecap:`round`,strokeWidth:`2`,stroke:`currentColor`,fill:`none`,viewBox:`0 0 24 24`,xmlns:`http://www.w3.org/2000/svg`,children:[(0,J.jsx)(`path`,{d:`M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2`}),(0,J.jsx)(`path`,{d:`M7 9l5 -5l5 5`}),(0,J.jsx)(`path`,{d:`M12 4l0 12`})]})}),(0,J.jsx)(`div`,{className:`absolute border-2 opacity-0 group-hover:opacity-80 transition-all duration-300 border-dashed border-violet-500 inset-0 z-30 bg-transparent flex items-center justify-center h-32 w-32 mx-auto rounded-xl`})]}),(0,J.jsxs)(`div`,{className:`text-center mt-8`,children:[(0,J.jsx)(`p`,{className:`font-bold dark:text-white`,children:`Choose a photo`}),(0,J.jsx)(`p`,{className:`text-sm text-zinc-500`,children:`Stories last for 24 hours`})]})]}),(0,J.jsx)(`input`,{type:`file`,ref:d,onChange:e=>{let t=e.target.files[0];t&&o(t)},className:`hidden`,accept:`image/*`}),(0,J.jsx)(tr,{className:`w-full py-3 text-lg`,disabled:!a||s,onClick:async()=>{if(!(!a||!n)){c(!0);try{let e=await pt(a);await Rt(n.id,e.url,e.type),o(null),t(),r(`Story shared!`),i.invalidateQueries([`stories`])}catch(e){console.error(`Failed to create story:`,e),r(`Failed to share story.`)}finally{c(!1)}}},children:s?(0,J.jsx)(je,{size:24,className:`animate-spin mx-auto`}):`Share story`})]}),l&&(0,J.jsx)(rr,{src:l,isOpen:!!l,onClose:()=>u(null),onCropComplete:e=>{o(new File([e],`story-cropped-${Date.now()}.jpg`,{type:`image/jpeg`})),u(null)},aspect:9/16})]})},ur=r(),dr=e=>{let t=(0,ur.c)(21),{isPostModalOpen:n,setIsPostModalOpen:r,isEditProfileOpen:i,setIsEditProfileOpen:a,isStoryModalOpen:o,setIsStoryModalOpen:s,editProfileData:c,setEditProfileData:l}=e,u;t[0]===r?u=t[1]:(u=()=>r(!1),t[0]=r,t[1]=u);let d;t[2]!==n||t[3]!==u?(d=(0,J.jsx)(ir,{isOpen:n,onClose:u}),t[2]=n,t[3]=u,t[4]=d):d=t[4];let f;t[5]===a?f=t[6]:(f=()=>a(!1),t[5]=a,t[6]=f);let p;t[7]!==c||t[8]!==i||t[9]!==l||t[10]!==f?(p=(0,J.jsx)(cr,{isOpen:i,onClose:f,editProfileData:c,setEditProfileData:l}),t[7]=c,t[8]=i,t[9]=l,t[10]=f,t[11]=p):p=t[11];let m;t[12]===s?m=t[13]:(m=()=>s(!1),t[12]=s,t[13]=m);let h;t[14]!==o||t[15]!==m?(h=(0,J.jsx)(lr,{isOpen:o,onClose:m}),t[14]=o,t[15]=m,t[16]=h):h=t[16];let g;return t[17]!==d||t[18]!==p||t[19]!==h?(g=(0,J.jsxs)(J.Fragment,{children:[d,p,h]}),t[17]=d,t[18]=p,t[19]=h,t[20]=g):g=t[20],g},fr=r(),pr=e=>{let t=(0,fr.c)(38),{story:n,onClose:r}=e,[i,a]=(0,K.useState)(0),o,s;t[0]===r?(o=t[1],s=t[2]):(o=()=>{let e=setInterval(()=>{a(e=>e>=100?(r(),100):e+1)},50);return()=>clearInterval(e)},s=[r],t[0]=r,t[1]=o,t[2]=s),(0,K.useEffect)(o,s);let c=`${i}%`,l;t[3]===c?l=t[4]:(l=(0,J.jsx)(`div`,{className:`flex gap-1 h-1 w-full bg-white/20 rounded-full overflow-hidden`,children:(0,J.jsx)(`div`,{className:`h-full bg-white transition-all duration-100`,style:{width:c}})}),t[3]=c,t[4]=l);let u;t[5]!==n.user.avatar||t[6]!==n.user.handle?(u=(0,J.jsx)(Q,{src:n.user.avatar,alt:n.user.handle,className:`object-cover`}),t[5]=n.user.avatar,t[6]=n.user.handle,t[7]=u):u=t[7];let d;t[8]===n.user.handle?.[0]?d=t[9]:(d=n.user.handle?.[0]?.toUpperCase(),t[8]=n.user.handle?.[0],t[9]=d);let f;t[10]===d?f=t[11]:(f=(0,J.jsx)($,{children:d}),t[10]=d,t[11]=f);let p;t[12]!==u||t[13]!==f?(p=(0,J.jsxs)(Z,{className:`size-10 border border-white/20`,children:[u,f]}),t[12]=u,t[13]=f,t[14]=p):p=t[14];let m;t[15]===n.user.handle?m=t[16]:(m=(0,J.jsx)(`span`,{className:`text-white font-bold`,children:n.user.handle}),t[15]=n.user.handle,t[16]=m);let h;t[17]!==p||t[18]!==m?(h=(0,J.jsxs)(`div`,{className:`flex items-center gap-3`,children:[p,m]}),t[17]=p,t[18]=m,t[19]=h):h=t[19];let g;t[20]===Symbol.for(`react.memo_cache_sentinel`)?(g=(0,J.jsx)(j,{size:24}),t[20]=g):g=t[20];let _;t[21]===r?_=t[22]:(_=(0,J.jsx)(`button`,{onClick:r,className:`text-white p-2 hover:bg-white/10 rounded-full`,children:g}),t[21]=r,t[22]=_);let v;t[23]!==h||t[24]!==_?(v=(0,J.jsxs)(`div`,{className:`flex items-center justify-between`,children:[h,_]}),t[23]=h,t[24]=_,t[25]=v):v=t[25];let y;t[26]!==v||t[27]!==l?(y=(0,J.jsxs)(`div`,{className:`absolute top-0 left-0 right-0 p-4 z-20 flex flex-col gap-4`,children:[l,v]}),t[26]=v,t[27]=l,t[28]=y):y=t[28];let b;t[29]===Symbol.for(`react.memo_cache_sentinel`)?(b=(0,J.jsx)(`button`,{className:`absolute left-4 z-10 p-2 bg-black/20 hover:bg-black/40 rounded-full text-white backdrop-blur-md transition-all active:scale-90`,children:(0,J.jsx)(le,{size:32})}),t[29]=b):b=t[29];let x;t[30]===n.media?x=t[31]:(x=(0,J.jsx)(`img`,{src:n.media,className:`w-full h-full object-contain rounded-2xl shadow-2xl`,alt:``}),t[30]=n.media,t[31]=x);let S;t[32]===Symbol.for(`react.memo_cache_sentinel`)?(S=(0,J.jsx)(`button`,{className:`absolute right-4 z-10 p-2 bg-black/20 hover:bg-black/40 rounded-full text-white backdrop-blur-md transition-all active:scale-90`,children:(0,J.jsx)($e,{size:32})}),t[32]=S):S=t[32];let C;t[33]===x?C=t[34]:(C=(0,J.jsxs)(`div`,{className:`w-full h-full max-w-xl relative flex items-center justify-center p-4`,children:[b,x,S]}),t[33]=x,t[34]=C);let w;return t[35]!==y||t[36]!==C?(w=(0,J.jsxs)(`div`,{className:`fixed inset-0 z-[100] bg-black flex flex-col items-center justify-center animate-in fade-in duration-300`,children:[y,C]}),t[35]=y,t[36]=C,t[37]=w):w=t[37],w},mr=r(),hr=e=>{let t=(0,mr.c)(48),{images:n,currentIndex:r,onClose:i,onNavigate:a}=e,o=r===void 0?0:r;if(!n||n.length===0)return null;let s=n[o],c=n.length>1,l;t[0]!==o||t[1]!==a?(l=e=>{e.stopPropagation(),a&&o>0&&a(o-1)},t[0]=o,t[1]=a,t[2]=l):l=t[2];let u=l,d;t[3]!==o||t[4]!==n.length||t[5]!==a?(d=e=>{e.stopPropagation(),a&&o<n.length-1&&a(o+1)},t[3]=o,t[4]=n.length,t[5]=a,t[6]=d):d=t[6];let f=d,p;t[7]===s?p=t[8]:(p=e=>{e.stopPropagation();let t=document.createElement(`a`);t.href=s,t.download=`image-${Date.now()}.jpg`,document.body.appendChild(t),t.click(),document.body.removeChild(t)},t[7]=s,t[8]=p);let m=p,h=c?`${o+1} / ${n.length}`:``,g;t[9]===h?g=t[10]:(g=(0,J.jsx)(`div`,{className:`text-white font-medium`,children:h}),t[9]=h,t[10]=g);let _;t[11]===Symbol.for(`react.memo_cache_sentinel`)?(_=(0,J.jsx)(ke,{size:22}),t[11]=_):_=t[11];let v;t[12]===m?v=t[13]:(v=(0,J.jsx)(`button`,{onClick:m,className:`text-white p-2 hover:bg-white/10 rounded-full transition-colors`,title:`Download`,children:_}),t[12]=m,t[13]=v);let y;t[14]===Symbol.for(`react.memo_cache_sentinel`)?(y=(0,J.jsx)(j,{size:24}),t[14]=y):y=t[14];let b;t[15]===i?b=t[16]:(b=(0,J.jsx)(`button`,{onClick:i,className:`text-white p-2 hover:bg-white/10 rounded-full transition-colors`,title:`Close`,children:y}),t[15]=i,t[16]=b);let x;t[17]!==b||t[18]!==v?(x=(0,J.jsxs)(`div`,{className:`flex items-center gap-2`,children:[v,b]}),t[17]=b,t[18]=v,t[19]=x):x=t[19];let S;t[20]!==x||t[21]!==g?(S=(0,J.jsxs)(`div`,{className:`absolute top-0 left-0 right-0 p-4 z-20 flex items-center justify-between bg-gradient-to-b from-black/50 to-transparent`,children:[g,x]}),t[20]=x,t[21]=g,t[22]=S):S=t[22];let C;t[23]!==o||t[24]!==u||t[25]!==c?(C=c&&o>0&&(0,J.jsx)(`button`,{onClick:u,className:`absolute left-4 z-10 p-3 bg-white/10 hover:bg-white/20 rounded-full text-white backdrop-blur-md transition-all active:scale-90`,children:(0,J.jsx)(le,{size:32})}),t[23]=o,t[24]=u,t[25]=c,t[26]=C):C=t[26];let w;t[27]===s?w=t[28]:(w=(0,J.jsx)(`img`,{src:s,className:`max-w-full max-h-full object-contain select-none shadow-2xl animate-in zoom-in-95 duration-300`,alt:``,onClick:gr}),t[27]=s,t[28]=w);let T;t[29]!==o||t[30]!==f||t[31]!==c||t[32]!==n.length?(T=c&&o<n.length-1&&(0,J.jsx)(`button`,{onClick:f,className:`absolute right-4 z-10 p-3 bg-white/10 hover:bg-white/20 rounded-full text-white backdrop-blur-md transition-all active:scale-90`,children:(0,J.jsx)($e,{size:32})}),t[29]=o,t[30]=f,t[31]=c,t[32]=n.length,t[33]=T):T=t[33];let E;t[34]!==C||t[35]!==w||t[36]!==T?(E=(0,J.jsxs)(`div`,{className:`w-full h-full relative flex items-center justify-center p-4`,children:[C,w,T]}),t[34]=C,t[35]=w,t[36]=T,t[37]=E):E=t[37];let D;t[38]!==o||t[39]!==c||t[40]!==n||t[41]!==a?(D=c&&(0,J.jsx)(`div`,{className:`absolute bottom-6 flex gap-2 p-2 bg-black/40 backdrop-blur-md rounded-2xl overflow-x-auto max-w-[90%] hide-scrollbar`,onClick:_r,children:n.map((e,t)=>(0,J.jsx)(`button`,{onClick:()=>a(t),className:`size-12 rounded-lg overflow-hidden border-2 transition-all shrink-0 ${t===o?`border-white scale-110`:`border-transparent opacity-50 hover:opacity-100`}`,children:(0,J.jsx)(`img`,{src:e,className:`size-full object-cover`,alt:``})},t))}),t[38]=o,t[39]=c,t[40]=n,t[41]=a,t[42]=D):D=t[42];let O;return t[43]!==i||t[44]!==S||t[45]!==E||t[46]!==D?(O=(0,J.jsxs)(`div`,{className:`fixed inset-0 z-[100] bg-black/95 backdrop-blur-sm flex flex-col items-center justify-center animate-in fade-in duration-300`,onClick:i,children:[S,E,D]}),t[43]=i,t[44]=S,t[45]=E,t[46]=D,t[47]=O):O=t[47],O};function gr(e){return e.stopPropagation()}function _r(e){return e.stopPropagation()}var vr=({type:e,onComplete:t,onSwitch:n})=>{let{login:r,signup:i}=Y(),{addToast:a}=nn(),[o,s]=(0,K.useState)({name:``,email:``,username:``,password:``}),[c,l]=(0,K.useState)(!1),[u,d]=(0,K.useState)(null);return(0,J.jsxs)(`div`,{className:`max-w-md mx-auto p-8 w-full animate-in fade-in slide-in-from-bottom-5 duration-300`,children:[(0,J.jsxs)(`div`,{className:`text-center mb-8`,children:[(0,J.jsx)(`div`,{className:`flex justify-center mb-4`,children:(0,J.jsx)(`div`,{className:`bg-black dark:bg-white dark:text-black text-white p-3 rounded-2xl shadow-lg`,children:(0,J.jsx)(`img`,{src:`https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png`,alt:`Logo`,className:`w-10 h-10 rounded-xl`})})}),(0,J.jsx)(`h2`,{className:`text-3xl font-extrabold mb-2 dark:text-white tracking-tight`,children:e===`login`?`Welcome back!`:`Join Sysm today`}),(0,J.jsx)(`p`,{className:`text-zinc-500 font-medium`,children:`The decentralized social network`})]}),u&&(0,J.jsxs)(`div`,{className:`mb-6 p-4 bg-rose-50 dark:bg-rose-900/20 border border-rose-100 dark:border-rose-800 rounded-xl flex items-center gap-3 text-rose-600 dark:text-rose-400 text-sm`,children:[(0,J.jsx)(qe,{size:18}),(0,J.jsx)(`span`,{children:u})]}),(0,J.jsxs)(`form`,{onSubmit:async n=>{n.preventDefault(),l(!0),d(null);try{e===`login`?(await r({email:o.email,password:o.password}),a(`Welcome back!`)):(await i({email:o.email,password:o.password,username:o.username,name:o.name}),a(`Account created successfully!`)),t()}catch(e){console.error(`Auth error:`,e),d(e.message||`Authentication failed. Please check your credentials.`),a(`Authentication failed!`)}finally{l(!1)}},className:`space-y-4`,children:[(0,J.jsx)(sr,{label:`Email`,type:`email`,placeholder:`john@example.com`,value:o.email,onChange:e=>s({...o,email:e.target.value}),required:!0}),e===`signup`&&(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(sr,{label:`Name`,placeholder:`John Doe`,value:o.name,onChange:e=>s({...o,name:e.target.value}),required:!0}),(0,J.jsx)(sr,{label:`Username`,placeholder:`johndoe`,value:o.username,onChange:e=>s({...o,username:e.target.value}),required:!0})]}),(0,J.jsx)(sr,{label:`Password`,type:`password`,placeholder:`â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢`,value:o.password,onChange:e=>s({...o,password:e.target.value}),required:!0}),(0,J.jsx)(tr,{type:`submit`,className:`w-full justify-center py-3 mt-6 text-lg`,disabled:c,children:c?(0,J.jsx)(je,{size:24,className:`animate-spin`}):e===`login`?`Log in`:`Sign up`})]}),(0,J.jsxs)(`div`,{className:`mt-8 text-center text-sm`,children:[(0,J.jsx)(`span`,{className:`text-zinc-500`,children:e===`login`?`Don't have an account?`:`Already have an account?`}),(0,J.jsx)(`button`,{onClick:n,className:`font-bold ml-1 hover:underline dark:text-white`,children:e===`login`?`Sign up`:`Log in`})]})]})},yr=r(),br=e=>{let t=(0,yr.c)(6),{children:r}=e,i,a,o,s;t[0]===Symbol.for(`react.memo_cache_sentinel`)?(i={opacity:0,y:10},a={opacity:1,y:0},o={opacity:0,y:-10},s={duration:.3,ease:`easeOut`},t[0]=i,t[1]=a,t[2]=o,t[3]=s):(i=t[0],a=t[1],o=t[2],s=t[3]);let c;return t[4]===r?c=t[5]:(c=(0,J.jsx)(n.div,{initial:i,animate:a,exit:o,transition:s,className:`w-full`,children:r}),t[4]=r,t[5]=c),c},xr=r(),Sr=e=>{let t=(0,xr.c)(24),{user:n,onClick:r,isAddStory:i}=e,a=i===void 0?!1:i,o=`relative p-0.5 rounded-full ${a?`bg-transparent`:`bg-gradient-to-tr from-yellow-400 via-pink-500 to-violet-600`}`,s;t[0]!==n.avatar||t[1]!==n.handle?(s=(0,J.jsx)(Q,{src:n.avatar,alt:n.handle,className:`object-cover`}),t[0]=n.avatar,t[1]=n.handle,t[2]=s):s=t[2];let c;t[3]===n.handle?.[0]?c=t[4]:(c=n.handle?.[0]?.toUpperCase(),t[3]=n.handle?.[0],t[4]=c);let l;t[5]===c?l=t[6]:(l=(0,J.jsx)($,{children:c}),t[5]=c,t[6]=l);let u;t[7]!==s||t[8]!==l?(u=(0,J.jsxs)(Z,{className:`size-14 sm:size-16 border border-zinc-100 dark:border-zinc-800`,children:[s,l]}),t[7]=s,t[8]=l,t[9]=u):u=t[9];let d;t[10]===a?d=t[11]:(d=a&&(0,J.jsx)(`div`,{className:`absolute bottom-0 right-0 bg-violet-600 border-2 border-white dark:border-black rounded-full p-1 text-white shadow-lg`,children:(0,J.jsx)(S,{size:14,strokeWidth:3})}),t[10]=a,t[11]=d);let f;t[12]!==u||t[13]!==d?(f=(0,J.jsx)(`div`,{className:`bg-white dark:bg-black rounded-full p-0.5`,children:(0,J.jsxs)(`div`,{className:`relative`,children:[u,d]})}),t[12]=u,t[13]=d,t[14]=f):f=t[14];let p;t[15]!==o||t[16]!==f?(p=(0,J.jsx)(`div`,{className:o,children:f}),t[15]=o,t[16]=f,t[17]=p):p=t[17];let m=a?`Add Story`:n.handle,h;t[18]===m?h=t[19]:(h=(0,J.jsx)(`span`,{className:`text-[11px] font-semibold text-zinc-600 dark:text-zinc-400 truncate w-16 text-center leading-tight`,children:m}),t[18]=m,t[19]=h);let g;return t[20]!==r||t[21]!==h||t[22]!==p?(g=(0,J.jsxs)(`button`,{onClick:r,className:`flex flex-col items-center gap-2 group shrink-0`,children:[p,h]}),t[20]=r,t[21]=h,t[22]=p,t[23]=g):g=t[23],g},Cr=r();function wr(e){let t=(0,Cr.c)(4),n;t[0]===e?n=t[1]:({...n}=e,t[0]=e,t[1]=n);let r;return t[2]===n?r=t[3]:(r=(0,J.jsx)(Oe,{"data-slot":`dropdown-menu`,...n}),t[2]=n,t[3]=r),r}function Tr(e){let t=(0,Cr.c)(4),n;t[0]===e?n=t[1]:({...n}=e,t[0]=e,t[1]=n);let r;return t[2]===n?r=t[3]:(r=(0,J.jsx)(_e,{"data-slot":`dropdown-menu-trigger`,...n}),t[2]=n,t[3]=r),r}function Er(e){let t=(0,Cr.c)(10),n,r,i;t[0]===e?(n=t[1],r=t[2],i=t[3]):({className:n,sideOffset:i,...r}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i);let a=i===void 0?4:i,o;t[4]===n?o=t[5]:(o=X(`bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md`,n),t[4]=n,t[5]=o);let s;return t[6]!==r||t[7]!==a||t[8]!==o?(s=(0,J.jsx)(Pe,{children:(0,J.jsx)(fe,{"data-slot":`dropdown-menu-content`,sideOffset:a,className:o,...r})}),t[6]=r,t[7]=a,t[8]=o,t[9]=s):s=t[9],s}function Dr(e){let t=(0,Cr.c)(12),n,r,i,a;t[0]===e?(n=t[1],r=t[2],i=t[3],a=t[4]):({className:n,inset:r,variant:a,...i}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a);let o=a===void 0?`default`:a,s;t[5]===n?s=t[6]:(s=X(`focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4`,n),t[5]=n,t[6]=s);let c;return t[7]!==r||t[8]!==i||t[9]!==s||t[10]!==o?(c=(0,J.jsx)(he,{"data-slot":`dropdown-menu-item`,"data-inset":r,"data-variant":o,className:s,...i}),t[7]=r,t[8]=i,t[9]=s,t[10]=o,t[11]=c):c=t[11],c}function Or(e){let t=(0,Cr.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=X(`bg-border -mx-1 my-1 h-px`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,J.jsx)(ye,{"data-slot":`dropdown-menu-separator`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}var kr=r(),Ar=()=>{let e=(0,kr.c)(1),t;return e[0]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,J.jsx)(z,{size:16,className:`fill-blue-500 text-white ml-1 inline-block shrink-0`}),e[0]=t):t=e[0],t},jr=r(),Mr=e=>{let t=(0,jr.c)(18),{poll:n,onVote:r}=e,i=n.options.reduce(Nr,0),[a,o]=(0,K.useState)(null),s;t[0]!==r||t[1]!==a?(s=e=>{a||(o(e),r&&r(e))},t[0]=r,t[1]=a,t[2]=s):s=t[2];let c=s,l;if(t[3]!==c||t[4]!==n.options||t[5]!==i||t[6]!==a){let e;t[8]!==c||t[9]!==i||t[10]!==a?(e=(e,t)=>{let n=i>0?Math.round((e.votes+(a===e.id?1:0))/(i+(a?1:0))*100):0,r=a===e.id;return(0,J.jsxs)(`div`,{onClick:t=>{t.stopPropagation(),c(e.id)},className:`relative h-10 w-full rounded-xl overflow-hidden cursor-pointer border ${r?`border-violet-500 dark:border-violet-500`:`border-zinc-200 dark:border-zinc-700`}`,children:[a&&(0,J.jsx)(`div`,{className:`absolute top-0 left-0 h-full bg-zinc-200 dark:bg-zinc-800 transition-all duration-500`,style:{width:`${n}%`}}),(0,J.jsxs)(`div`,{className:`absolute inset-0 flex items-center justify-between px-4 z-10`,children:[(0,J.jsxs)(`span`,{className:`font-medium text-sm ${r?`text-violet-600 font-bold`:`text-zinc-700 dark:text-zinc-200`}`,children:[e.text,` `,r&&(0,J.jsx)(ae,{size:14,className:`inline ml-1 mb-0.5`})]}),a&&(0,J.jsxs)(`span`,{className:`text-sm font-bold text-zinc-900 dark:text-white`,children:[n,`%`]})]})]},e.id||t)},t[8]=c,t[9]=i,t[10]=a,t[11]=e):e=t[11],l=n.options.map(e),t[3]=c,t[4]=n.options,t[5]=i,t[6]=a,t[7]=l}else l=t[7];let u=i+(a?1:0),d=a?`6 days left`:`Click to vote`,f;t[12]!==u||t[13]!==d?(f=(0,J.jsxs)(`div`,{className:`text-xs text-zinc-500 dark:text-zinc-400 pl-1`,children:[u,` votes â€¢ `,d]}),t[12]=u,t[13]=d,t[14]=f):f=t[14];let p;return t[15]!==l||t[16]!==f?(p=(0,J.jsxs)(`div`,{className:`mt-3 space-y-2`,children:[l,f]}),t[15]=l,t[16]=f,t[17]=p):p=t[17],p};function Nr(e,t){return e+t.votes}var Pr=r(),Fr=e=>{let t=(0,Pr.c)(23),{user:n,time:r,content:i}=e,a;t[0]!==n.avatar||t[1]!==n.handle?(a=(0,J.jsx)(Q,{src:n.avatar,alt:n.handle}),t[0]=n.avatar,t[1]=n.handle,t[2]=a):a=t[2];let o;t[3]===n.handle[0]?o=t[4]:(o=n.handle[0]?.toUpperCase(),t[3]=n.handle[0],t[4]=o);let s;t[5]===o?s=t[6]:(s=(0,J.jsx)($,{children:o}),t[5]=o,t[6]=s);let c;t[7]!==a||t[8]!==s?(c=(0,J.jsxs)(Z,{className:`size-6`,children:[a,s]}),t[7]=a,t[8]=s,t[9]=c):c=t[9];let l;t[10]===n.handle?l=t[11]:(l=(0,J.jsx)(`span`,{className:`font-semibold text-sm`,children:n.handle}),t[10]=n.handle,t[11]=l);let u;t[12]===r?u=t[13]:(u=(0,J.jsxs)(`span`,{className:`text-zinc-500 text-sm`,children:[`â€¢ `,r]}),t[12]=r,t[13]=u);let d;t[14]!==c||t[15]!==l||t[16]!==u?(d=(0,J.jsxs)(`div`,{className:`flex items-center gap-x-2 mb-2`,children:[c,l,u]}),t[14]=c,t[15]=l,t[16]=u,t[17]=d):d=t[17];let f;t[18]===i?f=t[19]:(f=(0,J.jsx)(`p`,{className:`text-sm text-zinc-800 dark:text-zinc-300 whitespace-pre-line`,children:i}),t[18]=i,t[19]=f);let p;return t[20]!==d||t[21]!==f?(p=(0,J.jsxs)(`div`,{className:`p-4`,children:[d,f]}),t[20]=d,t[21]=f,t[22]=p):p=t[22],p},Ir=r(),Lr=e=>{let t=(0,Ir.c)(17),{icon:n,count:r,onClick:i,active:a,activeColorClass:o}=e,s=o===void 0?`text-violet-600`:o,c=n,l;t[0]===i?l=t[1]:(l=e=>{e.stopPropagation(),i&&i(e)},t[0]=i,t[1]=l);let u=`group flex items-center gap-x-2 text-[13px] font-medium transition-all ${a?s:`text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-300`}`,d=`rounded-full p-2 transition-colors ${a?`bg-current/10`:`group-hover:bg-zinc-100 dark:group-hover:bg-zinc-800`}`,f=a?2.5:2,p=a?`fill-current`:``,m;t[2]!==c||t[3]!==f||t[4]!==p?(m=(0,J.jsx)(c,{size:18,strokeWidth:f,className:p}),t[2]=c,t[3]=f,t[4]=p,t[5]=m):m=t[5];let h;t[6]!==d||t[7]!==m?(h=(0,J.jsx)(`div`,{className:d,children:m}),t[6]=d,t[7]=m,t[8]=h):h=t[8];let g;t[9]!==a||t[10]!==r?(g=r!=null&&(0,J.jsx)(`span`,{className:a?`font-bold`:``,children:r||0}),t[9]=a,t[10]=r,t[11]=g):g=t[11];let _;return t[12]!==l||t[13]!==u||t[14]!==h||t[15]!==g?(_=(0,J.jsxs)(`button`,{onClick:l,className:u,children:[h,g]}),t[12]=l,t[13]=u,t[14]=h,t[15]=g,t[16]=_):_=t[16],_},Rr=r(),zr=e=>{let t=(0,Rr.c)(12),{src:n,poster:r}=e,i=(0,K.useRef)(null),a,o;t[0]===Symbol.for(`react.memo_cache_sentinel`)?(a=()=>{let e=new IntersectionObserver(e=>{let[t]=e;i.current?.plyr&&(t.isIntersecting?i.current.plyr.play().catch(()=>{i.current.plyr.muted=!0,i.current.plyr.play()}):i.current.plyr.pause())},{threshold:.6}),t=i.current?.elements?.container;return t&&e.observe(t),()=>{t&&e.unobserve(t)}},o=[],t[0]=a,t[1]=o):(a=t[0],o=t[1]),(0,K.useEffect)(a,o);let s;t[2]===n?s=t[3]:(s=[{src:n,type:`video/mp4`}],t[2]=n,t[3]=s);let c;t[4]!==r||t[5]!==s?(c={type:`video`,sources:s,poster:r},t[4]=r,t[5]=s,t[6]=c):c=t[6];let l;t[7]===Symbol.for(`react.memo_cache_sentinel`)?(l={controls:[`play-large`,`play`,`progress`,`current-time`,`mute`,`volume`,`fullscreen`],settings:[`quality`,`speed`],ratio:`16:9`,clickToPlay:!0,hideControls:!0,resetOnEnd:!0},t[7]=l):l=t[7];let u;t[8]===c?u=t[9]:(u={source:c,options:l},t[8]=c,t[9]=u);let d=u,f;return t[10]===d?f=t[11]:(f=(0,J.jsx)(`div`,{className:`mt-3 overflow-hidden rounded-2xl shadow-sm border border-zinc-100 dark:border-zinc-800 bg-black`,onClick:Br,children:(0,J.jsx)(We,{ref:i,...d})}),t[10]=d,t[11]=f),f};function Br(e){return e.stopPropagation()}var Vr=r(),Hr=e=>{let t=(0,Vr.c)(17),{file:n}=e,r;t[0]===Symbol.for(`react.memo_cache_sentinel`)?(r=(0,J.jsx)(`div`,{className:`size-10 rounded-xl bg-violet-100 dark:bg-violet-900/30 flex items-center justify-center text-violet-600`,children:(0,J.jsx)(pe,{size:20})}),t[0]=r):r=t[0];let i;t[1]===n.name?i=t[2]:(i=(0,J.jsx)(`div`,{className:`text-sm font-bold truncate dark:text-white`,children:n.name}),t[1]=n.name,t[2]=i);let a=n.size/1024/1024,o;t[3]===a?o=t[4]:(o=a.toFixed(2),t[3]=a,t[4]=o);let s;t[5]===o?s=t[6]:(s=(0,J.jsxs)(`div`,{className:`text-xs text-zinc-500 uppercase`,children:[o,` MB`]}),t[5]=o,t[6]=s);let c;t[7]!==i||t[8]!==s?(c=(0,J.jsxs)(`div`,{className:`flex-1 min-w-0`,children:[i,s]}),t[7]=i,t[8]=s,t[9]=c):c=t[9];let l;t[10]===Symbol.for(`react.memo_cache_sentinel`)?(l=(0,J.jsx)(ke,{size:18}),t[10]=l):l=t[10];let u;t[11]!==n.name||t[12]!==n.url?(u=(0,J.jsx)(`a`,{href:n.url,download:n.name,className:`p-2 text-zinc-400 hover:text-violet-600 transition-colors`,onClick:Ur,children:l}),t[11]=n.name,t[12]=n.url,t[13]=u):u=t[13];let d;return t[14]!==c||t[15]!==u?(d=(0,J.jsxs)(`div`,{className:`mt-3 flex items-center gap-3 p-3 rounded-2xl border border-zinc-100 dark:border-zinc-800 bg-zinc-50/50 dark:bg-zinc-900/10 group hover:border-violet-500/30 transition-colors`,children:[r,c,u]}),t[14]=c,t[15]=u,t[16]=d):d=t[16],d};function Ur(e){return e.stopPropagation()}var Wr=r(),Gr=e=>{let t=(0,Wr.c)(3),{items:n}=e,r=n===void 0?[]:n,{openLightbox:i}=dn();if(!r||r.length===0)return null;let a=Array.isArray(r)?r:[r],o=a.filter(Kr),s=a.filter(qr),c=e=>{let t=o.filter(Jr).map(Yr),n=o[e];i(t,t.indexOf(n.url||n.src))},l=o.length>0&&(0,J.jsx)(`div`,{className:`grid gap-2 rounded-2xl overflow-hidden border border-zinc-100 dark:border-zinc-800 ${o.length===1?`grid-cols-1`:o.length===2?`grid-cols-2 aspect-[16/9]`:(o.length,`grid-cols-2 grid-rows-2 aspect-[16/9]`)}`,children:o.map((e,t)=>(0,J.jsx)(`div`,{className:`relative overflow-hidden bg-zinc-100 dark:bg-zinc-900 cursor-pointer ${o.length===3&&t===0?`row-span-2`:``}`,onClick:n=>{e.type===`image`&&(n.stopPropagation(),c(t))},children:e.type===`video`?(0,J.jsx)(zr,{src:e.url,poster:e.poster}):(0,J.jsx)(`img`,{src:e.url||e.src,className:`size-full object-cover hover:scale-[1.02] transition-transform duration-500`,alt:``,loading:`lazy`})},t))}),u=s.map(Xr),d;return t[0]!==l||t[1]!==u?(d=(0,J.jsxs)(`div`,{className:`mt-3 space-y-2`,children:[l,u]}),t[0]=l,t[1]=u,t[2]=d):d=t[2],d};function Kr(e){return e.type===`image`||e.type===`video`}function qr(e){return e.type===`file`}function Jr(e){return e.type===`image`}function Yr(e){return e.url||e.src}function Xr(e,t){return(0,J.jsx)(Hr,{file:e},t)}var Zr=r(),Qr=e=>{let t=(0,Zr.c)(6),{currentUser:n,newComment:r,setNewComment:i,handleSubmitComment:a,loading:o}=e,s;return t[0]!==n||t[1]!==a||t[2]!==o||t[3]!==r||t[4]!==i?(s=n?(0,J.jsx)(`div`,{className:`p-4 border-y border-zinc-100 dark:border-zinc-800 bg-zinc-50/30 dark:bg-zinc-900/10`,children:(0,J.jsxs)(`div`,{className:`flex gap-3`,children:[(0,J.jsxs)(Z,{className:`size-9 border border-zinc-200 dark:border-zinc-700`,children:[(0,J.jsx)(Q,{src:n.avatar,alt:n.handle,className:`object-cover`}),(0,J.jsx)($,{children:n.handle?.[0]?.toUpperCase()})]}),(0,J.jsxs)(`div`,{className:`flex-1`,children:[(0,J.jsx)(`textarea`,{id:`comment-input`,className:`w-full bg-transparent outline-none text-base min-h-[60px] resize-none dark:text-white placeholder:text-zinc-500`,placeholder:`Post your reply...`,value:r,onChange:e=>i(e.target.value)}),(0,J.jsxs)(`div`,{className:`flex justify-between items-center mt-2 pt-3 border-t border-zinc-100 dark:border-zinc-800`,children:[(0,J.jsxs)(`div`,{className:`flex text-violet-600 gap-1`,children:[(0,J.jsx)(`button`,{className:`text-violet-600 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full p-2`,children:(0,J.jsx)(S,{size:20})}),(0,J.jsx)(`button`,{className:`text-violet-600 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full p-2`,children:(0,J.jsx)(me,{size:20})})]}),(0,J.jsx)(tr,{className:`!w-auto px-5 py-1.5 text-sm font-bold min-w-[70px]`,onClick:a,disabled:!r.trim()||o,children:o?(0,J.jsx)(je,{size:16,className:`animate-spin text-white mx-auto`}):`Reply`})]})]})]})}):(0,J.jsx)(`div`,{className:`p-6 text-center border-y border-zinc-100 dark:border-zinc-800 bg-zinc-50/30 dark:bg-zinc-900/10`,children:(0,J.jsx)(`p`,{className:`text-zinc-500 text-sm`,children:`Please login to join the conversation.`})}),t[0]=n,t[1]=a,t[2]=o,t[3]=r,t[4]=i,t[5]=s):s=t[5],s};const $r=(e,t,n,r)=>{let[i,a]=(0,K.useState)(!1),[o,s]=(0,K.useState)(!1),[c,l]=(0,K.useState)(t||{comments:0,likes:0,mirrors:0});return(0,K.useEffect)(()=>{n&&e&&wn(e)&&wn(n.id)&&Nt(e,n.id).then(a).catch(()=>a(!1))},[e,n]),{liked:i,reposted:o,localStats:c,setLocalStats:l,handleLike:async t=>{if(t&&t.stopPropagation(),!n)return r(`Please login to like!`,`error`);if(!wn(e)||!wn(n.id)){let e=!i;a(e),l(t=>({...t,likes:e?(t.likes||0)+1:(t.likes||0)-1})),r(e?`Liked`:`Unliked`);return}try{let t=await Mt(e,n.id);a(t),l(e=>({...e,likes:t?(e.likes||0)+1:(e.likes||0)-1})),r(t?`Liked`:`Unliked`)}catch(e){console.error(`Failed to toggle like:`,e),r(`Failed to update like state`,`error`)}},handleRepost:e=>{if(e&&e.stopPropagation(),!n)return r(`Please login to repost!`,`error`);s(!o),l(e=>({...e,mirrors:o?(e.mirrors||0)-1:(e.mirrors||0)+1})),r(o?`Removed repost`:`Reposted`)}}};var ei=({id:e,user:n,timeAgo:r,content:i,contentClass:a,media:o,quotedPost:s,stats:c,onClick:l,repostedBy:u,onUserClick:d,currentUser:f,showToast:p,poll:h,isDetail:g,initialComments:_})=>{let{liked:v,reposted:y,localStats:b,setLocalStats:x,handleLike:S,handleRepost:C}=$r(e,c,f,p),[T,E]=(0,K.useState)(_||[]),[D,O]=(0,K.useState)(``),[k,A]=(0,K.useState)(!1),[j,M]=(0,K.useState)(!1),N=(0,K.useCallback)(async()=>{if(e){A(!0);try{E(await At(e))}catch(e){console.error(`Failed to load comments:`,e)}finally{A(!1)}}},[e]);(0,K.useEffect)(()=>{g&&e&&N()},[g,e,N]);let P=async t=>{if(t.preventDefault(),!(!D.trim()||!f)){M(!0);try{await jt(e,f.id,D),O(``),x(e=>({...e,comments:(e.comments||0)+1})),p&&p(`Reply posted!`),N()}catch(e){console.error(`Failed to post comment:`,e),p&&p(`Failed to post reply.`)}finally{M(!1)}}},F=t=>{t.stopPropagation();let n=`${window.location.origin}/post/${e}`;navigator.clipboard.writeText(n),p&&p(`Link copied to clipboard!`)},I=({trigger:e})=>(0,J.jsxs)(wr,{children:[(0,J.jsx)(Tr,{asChild:!0,onClick:e=>e.stopPropagation(),children:e}),(0,J.jsxs)(Er,{align:`end`,className:`w-48 rounded-xl bg-white dark:bg-zinc-900 border-zinc-100 dark:border-zinc-800`,children:[(0,J.jsxs)(Dr,{className:`gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5`,onClick:F,children:[(0,J.jsx)(ze,{size:16}),(0,J.jsx)(`span`,{children:`Copy link to post`})]}),(0,J.jsxs)(Dr,{className:`gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5`,onClick:e=>{e.stopPropagation(),p&&p(`Post reported`)},children:[(0,J.jsx)(De,{size:16}),(0,J.jsx)(`span`,{children:`Report post`})]}),!L&&(0,J.jsxs)(Dr,{className:`gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5 text-rose-500 focus:text-rose-500`,onClick:e=>{e.stopPropagation(),p&&p(`User blocked`)},children:[(0,J.jsx)(w,{size:16}),(0,J.jsxs)(`span`,{children:[`Block @`,n.handle]})]}),L&&(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(Or,{className:`bg-zinc-100 dark:bg-zinc-800`}),(0,J.jsxs)(Dr,{className:`gap-2 cursor-pointer focus:bg-rose-50 dark:focus:bg-rose-900/20 py-2.5 text-rose-500 focus:text-rose-500`,onClick:e=>{e.stopPropagation(),p&&p(`Delete not implemented yet`)},children:[(0,J.jsx)(et,{size:16}),(0,J.jsx)(`span`,{children:`Delete post`})]})]})]})]}),L=f?.handle===n.handle,R=e=>e?K.isValidElement(e)?e:(0,J.jsx)(Gr,{items:e}):null,z=(e,t)=>typeof e==`string`?(0,J.jsx)(`p`,{className:`whitespace-pre-line ${t||``}`,children:e}):e;return g?(0,J.jsxs)(`div`,{className:`flex flex-col`,children:[(0,J.jsxs)(`article`,{className:`p-5 dark:bg-black`,children:[(0,J.jsxs)(`div`,{className:`flex items-start justify-between`,children:[(0,J.jsxs)(`div`,{className:`flex items-start gap-x-3`,children:[(0,J.jsx)(`button`,{className:`shrink-0`,onClick:()=>d&&d(n.handle),children:(0,J.jsxs)(Z,{className:`size-12 border border-zinc-200 dark:border-zinc-700`,children:[(0,J.jsx)(Q,{src:n.avatar,alt:n.handle,className:`object-cover`}),(0,J.jsx)($,{children:n.handle[0]?.toUpperCase()})]})}),(0,J.jsxs)(`div`,{className:`flex flex-col`,children:[(0,J.jsx)(`div`,{className:`flex flex-wrap items-center gap-x-1`,children:(0,J.jsxs)(`button`,{className:`font-bold hover:underline text-zinc-900 dark:text-white flex items-center gap-1 text-base`,onClick:()=>d&&d(n.handle),children:[n.handle,n.verified&&(0,J.jsx)(Ar,{})]})}),(0,J.jsxs)(`span`,{className:`text-sm text-zinc-500 dark:text-zinc-400`,children:[`@`,n.handle]})]})]}),(0,J.jsx)(I,{trigger:(0,J.jsx)(`button`,{className:`text-zinc-500 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full p-2 transition-colors`,children:(0,J.jsx)(ge,{size:20})})})]}),(0,J.jsx)(`div`,{className:`break-words text-zinc-900 dark:text-zinc-100 mt-4 text-xl leading-8 whitespace-pre-line`,children:z(i,a)}),R(o),h&&(0,J.jsx)(Mr,{poll:h}),s&&(0,J.jsx)(`div`,{className:`mt-4 border border-zinc-200 dark:border-zinc-700 rounded-2xl overflow-hidden shadow-sm`,children:(0,J.jsx)(Fr,{...s})}),(0,J.jsx)(`div`,{className:`my-4 flex items-center text-zinc-500 dark:text-zinc-400 text-sm border-b border-zinc-100 dark:border-zinc-800 pb-4`,children:r||`Recent`}),(0,J.jsxs)(`div`,{className:`border-b border-zinc-100 dark:border-zinc-800 pb-4 flex items-center gap-x-6 text-zinc-500 dark:text-zinc-400 text-sm`,children:[(0,J.jsxs)(`div`,{className:`flex items-center gap-x-1`,children:[(0,J.jsx)(`span`,{className:`font-bold text-black dark:text-white`,children:b.likes||0}),` `,(0,J.jsx)(`span`,{className:`opacity-70`,children:`Likes`})]}),(0,J.jsxs)(`div`,{className:`flex items-center gap-x-1`,children:[(0,J.jsx)(`span`,{className:`font-bold text-black dark:text-white`,children:b.comments||0}),` `,(0,J.jsx)(`span`,{className:`opacity-70`,children:`Comments`})]})]}),(0,J.jsxs)(`div`,{className:`mt-4 flex w-full items-center justify-around py-1`,children:[(0,J.jsx)(Lr,{icon:de,onClick:S,active:v,activeColorClass:`text-rose-500`}),(0,J.jsx)(Lr,{icon:m,onClick:C,active:y,activeColorClass:`text-emerald-500`}),(0,J.jsx)(Lr,{icon:t,onClick:()=>document.getElementById(`comment-input`)?.focus()})]})]}),(0,J.jsx)(Qr,{currentUser:f,newComment:D,setNewComment:O,handleSubmitComment:P,loading:j}),(0,J.jsx)(`div`,{className:`divide-y divide-zinc-100 dark:divide-zinc-800`,children:k?(0,J.jsx)(`div`,{className:`p-8 flex justify-center`,children:(0,J.jsx)(je,{className:`animate-spin text-violet-500`})}):T.map(e=>(0,J.jsx)(ei,{...e,onUserClick:d,currentUser:f,showToast:p},e.id))})]}):(0,J.jsxs)(`article`,{onClick:l,className:`px-5 pt-4 pb-3 hover:bg-zinc-50/80 dark:hover:bg-zinc-900/40 transition-colors border-b border-zinc-100 dark:border-zinc-800 last:border-0 ${l?`cursor-pointer`:``}`,children:[u&&(0,J.jsxs)(`div`,{className:`mb-2 flex items-center space-x-1.5 text-[13px] text-zinc-500 font-semibold ml-1`,children:[(0,J.jsx)(m,{size:14,className:`text-zinc-400`}),(0,J.jsx)(`span`,{className:`hover:underline cursor-pointer flex items-center text-zinc-600 dark:text-zinc-400`,onClick:e=>{e.stopPropagation(),d&&d(u.handle)},children:(0,J.jsx)(`span`,{className:`truncate max-w-[150px]`,children:typeof u==`object`?u.name:u})}),(0,J.jsx)(`span`,{className:`text-zinc-400`,children:`reposted`})]}),(0,J.jsxs)(`div`,{className:`flex items-start gap-x-3`,children:[(0,J.jsx)(`button`,{className:`shrink-0 group`,onClick:e=>{e.stopPropagation(),d&&d(n.handle)},children:(0,J.jsxs)(Z,{className:`size-11 border border-zinc-200 dark:border-zinc-700 group-hover:brightness-95 transition-all`,children:[(0,J.jsx)(Q,{src:n.avatar,alt:n.handle,className:`object-cover`}),(0,J.jsx)($,{children:n.handle[0]?.toUpperCase()})]})}),(0,J.jsxs)(`div`,{className:`min-w-0 flex-1`,children:[(0,J.jsxs)(`div`,{className:`flex w-full items-start justify-between`,children:[(0,J.jsx)(`div`,{className:`flex flex-col min-w-0`,children:(0,J.jsxs)(`div`,{className:`flex flex-wrap items-center gap-x-1`,children:[(0,J.jsxs)(`button`,{className:`font-bold hover:underline text-zinc-900 dark:text-white flex items-center gap-1 truncate text-[15px]`,onClick:e=>{e.stopPropagation(),d&&d(n.handle)},children:[(0,J.jsx)(`span`,{className:`truncate`,children:n.handle}),n.verified&&(0,J.jsx)(Ar,{})]}),(0,J.jsxs)(`span`,{className:`text-zinc-400 text-sm ml-1 whitespace-nowrap`,children:[`â€¢ `,r||`Recent`]})]})}),(0,J.jsx)(I,{trigger:(0,J.jsx)(`button`,{className:`text-zinc-400 hover:bg-zinc-100 hover:text-zinc-700 dark:hover:bg-zinc-800 dark:hover:text-zinc-200 rounded-full p-2 -mr-2 transition-colors`,children:(0,J.jsx)(ge,{size:18})})})]}),(0,J.jsxs)(`div`,{className:`break-words text-zinc-900 dark:text-zinc-100 mt-1 whitespace-pre-line text-[15px] leading-relaxed`,children:[z(i,a),R(o),h&&(0,J.jsx)(Mr,{poll:h,onVote:()=>p&&p(`Voted!`)}),s&&(0,J.jsx)(`div`,{className:`mt-3 border border-zinc-200 dark:border-zinc-700 rounded-2xl overflow-hidden bg-white dark:bg-zinc-900 hover:bg-zinc-50 dark:hover:bg-zinc-800 transition-colors cursor-pointer`,onClick:e=>e.stopPropagation(),children:(0,J.jsx)(Fr,{...s})})]}),(0,J.jsx)(`div`,{className:`mt-3 flex w-full flex-wrap items-center justify-between gap-3 pr-4`,children:(0,J.jsxs)(`div`,{className:`flex items-center gap-x-6`,children:[(0,J.jsx)(Lr,{icon:de,count:b.likes,active:v,onClick:S,activeColorClass:`text-rose-500`}),(0,J.jsx)(Lr,{icon:m,count:b.mirrors,active:y,onClick:C,activeColorClass:`text-emerald-500`}),(0,J.jsx)(Lr,{icon:t,count:b.comments,onClick:l})]})})]})]})]})},ti=ei,ni=r(),ri=()=>{let e=(0,ni.c)(3),t;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,J.jsx)(`div`,{className:`size-11 rounded-full bg-zinc-200 dark:bg-zinc-800 shrink-0`}),e[0]=t):t=e[0];let n;e[1]===Symbol.for(`react.memo_cache_sentinel`)?(n=(0,J.jsx)(`div`,{className:`h-4 bg-zinc-200 dark:bg-zinc-800 rounded w-1/3`}),e[1]=n):n=e[1];let r;return e[2]===Symbol.for(`react.memo_cache_sentinel`)?(r=(0,J.jsx)(`div`,{className:`px-5 pt-4 pb-3 border-b border-zinc-100 dark:border-zinc-800 animate-pulse`,children:(0,J.jsxs)(`div`,{className:`flex items-start gap-x-3`,children:[t,(0,J.jsxs)(`div`,{className:`flex-1 space-y-3`,children:[n,(0,J.jsxs)(`div`,{className:`space-y-2`,children:[(0,J.jsx)(`div`,{className:`h-3 bg-zinc-200 dark:bg-zinc-800 rounded w-full`}),(0,J.jsx)(`div`,{className:`h-3 bg-zinc-200 dark:bg-zinc-800 rounded w-5/6`})]}),(0,J.jsx)(`div`,{className:`h-48 bg-zinc-200 dark:bg-zinc-800 rounded-xl w-full`})]})]})}),e[2]=r):r=e[2],r},ii=r(),ai=e=>{let t=(0,ii.c)(38),{onStoryClick:n,onAddStory:r}=e,{currentUser:i}=Y(),{addToast:a}=nn(),o=C(),s;t[0]===Symbol.for(`react.memo_cache_sentinel`)?(s={queryKey:[`posts`],queryFn:mt},t[0]=s):s=t[0];let{data:c,isLoading:l}=M(s),u;t[1]===c?u=t[2]:(u=c===void 0?[]:c,t[1]=c,t[2]=u);let d=u,f;t[3]===Symbol.for(`react.memo_cache_sentinel`)?(f={queryKey:[`stories`],queryFn:Lt},t[3]=f):f=t[3];let{data:p,isLoading:m}=M(f),h;t[4]===p?h=t[5]:(h=p===void 0?[]:p,t[4]=p,t[5]=h);let g=h,_;t[6]===d?_=t[7]:(_=d.filter(oi),t[6]=d,t[7]=_);let v=_,y;t[8]===o?y=t[9]:(y=e=>{o(`/post/${e}`)},t[8]=o,t[9]=y);let b=y,x;t[10]===o?x=t[11]:(x=e=>{o(`/u/${e}`)},t[10]=o,t[11]=x);let S=x;if(l||m){let e;return t[12]===Symbol.for(`react.memo_cache_sentinel`)?(e=(0,J.jsxs)(`div`,{className:`border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen`,children:[(0,J.jsxs)(`div`,{className:`flex gap-3 overflow-x-auto no-scrollbar py-4 px-4 bg-white dark:bg-black border-b border-zinc-100 dark:border-zinc-800`,children:[(0,J.jsx)(`div`,{className:`size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0`}),(0,J.jsx)(`div`,{className:`size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0`}),(0,J.jsx)(`div`,{className:`size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0`})]}),[1,2,3].map(si)]}),t[12]=e):e=t[12],e}let w;t[13]!==i||t[14]!==r?(w=i&&(0,J.jsx)(Sr,{user:i,isAddStory:!0,onClick:r}),t[13]=i,t[14]=r,t[15]=w):w=t[15];let T;if(t[16]!==n||t[17]!==g){let e;t[19]===n?e=t[20]:(e=e=>(0,J.jsx)(Sr,{user:e.user,onClick:()=>n(e)},e.id),t[19]=n,t[20]=e),T=g.map(e),t[16]=n,t[17]=g,t[18]=T}else T=t[18];let E;t[21]!==w||t[22]!==T?(E=(0,J.jsxs)(`div`,{className:`flex gap-4 overflow-x-auto no-scrollbar py-4 px-4 bg-white dark:bg-black border-b border-zinc-100 dark:border-zinc-800`,children:[w,T]}),t[21]=w,t[22]=T,t[23]=E):E=t[23];let D;t[24]===i?D=t[25]:(D=!i&&(0,J.jsx)(`div`,{className:`px-4 py-2 md:hidden`,children:(0,J.jsx)(kn,{className:`p-6`})}),t[24]=i,t[25]=D);let O;t[26]!==a||t[27]!==i||t[28]!==b||t[29]!==S||t[30]!==v?(O=v.length>0?v.map(e=>(0,J.jsx)(ti,{...e,currentUser:i,showToast:a,onClick:()=>b(e.id),onUserClick:S},e.id)):(0,J.jsxs)(`div`,{className:`p-20 text-center text-zinc-500`,children:[(0,J.jsx)(`p`,{className:`text-lg font-medium`,children:`No posts yet.`}),(0,J.jsx)(`p`,{className:`text-sm`,children:`Be the first to share something amazing!`})]}),t[26]=a,t[27]=i,t[28]=b,t[29]=S,t[30]=v,t[31]=O):O=t[31];let k;t[32]===O?k=t[33]:(k=(0,J.jsx)(`div`,{className:`border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm`,children:O}),t[32]=O,t[33]=k);let A;return t[34]!==E||t[35]!==D||t[36]!==k?(A=(0,J.jsxs)(`div`,{children:[E,D,k]}),t[34]=E,t[35]=D,t[36]=k,t[37]=A):A=t[37],A};function oi(e){return!e.parent_id}function si(e){return(0,J.jsx)(ri,{},e)}var ci=r(),li=e=>{let t=(0,ci.c)(53),{profile:n,onUserClick:r,isCommunity:i}=e,a=i===void 0?!1:i,{onlineUsers:o}=Gt(),s;t[0]!==o||t[1]!==n.id?(s=o.has(n.id),t[0]=o,t[1]=n.id,t[2]=s):s=t[2];let c=s,l;t[3]!==r||t[4]!==n.handle?(l=()=>r(n.handle),t[3]=r,t[4]=n.handle,t[5]=l):l=t[5];let u=`size-12 border border-zinc-200 dark:border-zinc-800 shadow-sm ${a?`rounded-2xl`:``}`,d;t[6]!==n.avatar||t[7]!==n.handle?(d=(0,J.jsx)(Q,{src:n.avatar,alt:n.handle,className:`object-cover`}),t[6]=n.avatar,t[7]=n.handle,t[8]=d):d=t[8];let f=a?`rounded-2xl`:``,p;t[9]===n.handle?.[0]?p=t[10]:(p=n.handle?.[0]?.toUpperCase(),t[9]=n.handle?.[0],t[10]=p);let m;t[11]!==f||t[12]!==p?(m=(0,J.jsx)($,{className:f,children:p}),t[11]=f,t[12]=p,t[13]=m):m=t[13];let h;t[14]!==u||t[15]!==d||t[16]!==m?(h=(0,J.jsxs)(Z,{className:u,children:[d,m]}),t[14]=u,t[15]=d,t[16]=m,t[17]=h):h=t[17];let g;t[18]!==a||t[19]!==c?(g=c&&!a&&(0,J.jsx)(`span`,{className:`absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full shadow-sm`}),t[18]=a,t[19]=c,t[20]=g):g=t[20];let _;t[21]!==g||t[22]!==h?(_=(0,J.jsxs)(`div`,{className:`relative`,children:[h,g]}),t[21]=g,t[22]=h,t[23]=_):_=t[23];let v;t[24]===n.name?v=t[25]:(v=(0,J.jsx)(`span`,{className:`font-bold text-zinc-900 dark:text-white group-hover:underline leading-none`,children:n.name}),t[24]=n.name,t[25]=v);let y;t[26]===n.verified?y=t[27]:(y=n.verified&&(0,J.jsx)(Ar,{}),t[26]=n.verified,t[27]=y);let b;t[28]!==v||t[29]!==y?(b=(0,J.jsxs)(`div`,{className:`flex items-center gap-1`,children:[v,y]}),t[28]=v,t[29]=y,t[30]=b):b=t[30];let x;t[31]===n.handle?x=t[32]:(x=(0,J.jsxs)(`span`,{className:`text-sm text-zinc-500 mt-0.5`,children:[`@`,n.handle]}),t[31]=n.handle,t[32]=x);let S;t[33]!==a||t[34]!==n.members?(S=a&&n.members&&(0,J.jsxs)(`span`,{className:`text-xs text-zinc-400 mt-1`,children:[n.members,` members`]}),t[33]=a,t[34]=n.members,t[35]=S):S=t[35];let C;t[36]!==a||t[37]!==n.followers?(C=!a&&n.followers&&(0,J.jsxs)(`span`,{className:`text-xs text-zinc-400 mt-1`,children:[n.followers,` followers`]}),t[36]=a,t[37]=n.followers,t[38]=C):C=t[38];let w;t[39]!==b||t[40]!==x||t[41]!==S||t[42]!==C?(w=(0,J.jsxs)(`div`,{className:`flex flex-col`,children:[b,x,S,C]}),t[39]=b,t[40]=x,t[41]=S,t[42]=C,t[43]=w):w=t[43];let T;t[44]!==_||t[45]!==w?(T=(0,J.jsxs)(`div`,{className:`flex items-center gap-3`,children:[_,w]}),t[44]=_,t[45]=w,t[46]=T):T=t[46];let E=a?`Join`:`Follow`,D;t[47]===E?D=t[48]:(D=(0,J.jsx)(tr,{variant:`outline`,className:`!w-auto !py-1.5 !px-4 text-sm font-bold rounded-full border-zinc-200 dark:border-zinc-700 hover:bg-zinc-100 dark:hover:bg-zinc-800`,onClick:ui,children:E}),t[47]=E,t[48]=D);let O;return t[49]!==T||t[50]!==D||t[51]!==l?(O=(0,J.jsxs)(`div`,{className:`flex items-center justify-between p-4 border-b border-zinc-100 dark:border-zinc-800 hover:bg-zinc-50 dark:hover:bg-zinc-900/40 transition-colors group cursor-pointer`,onClick:l,children:[T,D]}),t[49]=T,t[50]=D,t[51]=l,t[52]=O):O=t[52],O};function ui(e){e.stopPropagation()}var di=r();function fi(e){let t=(0,di.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=X(`flex flex-col gap-2`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,J.jsx)(ue,{"data-slot":`tabs`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}function pi(e){let t=(0,di.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=X(`bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,J.jsx)(Be,{"data-slot":`tabs-list`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}function mi(e){let t=(0,di.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=X(`inline-flex items-center justify-center gap-1.5 px-2 py-1 text-sm font-medium whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 outline-none focus:outline-none focus-visible:outline-none ring-0 focus:ring-0 focus-visible:ring-0 shadow-none data-[state=active]:shadow-none`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,J.jsx)(Ee,{"data-slot":`tabs-trigger`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}function hi(e){let t=(0,di.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=X(`flex-1 outline-none`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,J.jsx)(Me,{"data-slot":`tabs-content`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}var gi=r(),_i=()=>{let e=(0,gi.c)(53),{currentUser:t}=Y(),{addToast:n}=nn(),r=C(),[i,a]=(0,K.useState)(`users`),[o,s]=(0,K.useState)(``),c;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(c={queryKey:[`posts`],queryFn:mt},e[0]=c):c=e[0];let{data:l,isLoading:u}=M(c),d;e[1]===l?d=e[2]:(d=l===void 0?[]:l,e[1]=l,e[2]=d);let f=d,p;e[3]===Symbol.for(`react.memo_cache_sentinel`)?(p={queryKey:[`profiles`],queryFn:yt},e[3]=p):p=e[3];let{data:m,isLoading:h}=M(p),g;e[4]===m?g=e[5]:(g=m===void 0?{}:m,e[4]=m,e[5]=g);let _=g,v;e[6]!==_||e[7]!==o?(v=Object.values(_).filter(vi),o&&(v=v.filter(e=>e.name?.toLowerCase().includes(o.toLowerCase())||e.handle?.toLowerCase().includes(o.toLowerCase()))),e[6]=_,e[7]=o,e[8]=v):v=e[8];let y=v,b;e[9]!==_||e[10]!==o?(b=Object.values(_).filter(yi),o&&(b=b.filter(e=>e.name?.toLowerCase().includes(o.toLowerCase())||e.handle?.toLowerCase().includes(o.toLowerCase()))),e[9]=_,e[10]=o,e[11]=b):b=e[11];let x=b,S;if(e[12]!==f||e[13]!==o){if(S=f.filter(bi),o){let t;e[15]===o?t=e[16]:(t=e=>e.content?.toLowerCase().includes(o.toLowerCase()),e[15]=o,e[16]=t),S=S.filter(t)}e[12]=f,e[13]=o,e[14]=S}else S=e[14];let w=S,T;e[17]===r?T=e[18]:(T=e=>{r(`/post/${e}`)},e[17]=r,e[18]=T);let E=T,D;e[19]===r?D=e[20]:(D=e=>{r(`/u/${e}`)},e[19]=r,e[20]=D);let O=D;if(u||h){let t;return e[21]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,J.jsx)(`div`,{className:`border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen`,children:[1,2,3].map(xi)}),e[21]=t):t=e[21],t}let k;e[22]===Symbol.for(`react.memo_cache_sentinel`)?(k=()=>s(``),e[22]=k):k=e[22];let A=`Search ${i}...`,j;e[23]!==o||e[24]!==A?(j=(0,J.jsx)(`div`,{className:`p-4`,children:(0,J.jsx)(xn,{value:o,onChange:s,onClear:k,placeholder:A})}),e[23]=o,e[24]=A,e[25]=j):j=e[25];let N;e[26]===Symbol.for(`react.memo_cache_sentinel`)?(N=(0,J.jsx)(pi,{className:`w-full h-auto bg-transparent p-0 rounded-none justify-around px-5`,children:[`users`,`communities`,`reels`].map(Si)}),e[26]=N):N=e[26];let P;e[27]===j?P=e[28]:(P=(0,J.jsxs)(`div`,{className:`sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-10 border-b border-zinc-100 dark:border-zinc-800`,children:[j,N]}),e[27]=j,e[28]=P);let F;e[29]!==O||e[30]!==y?(F=y.length>0?y.map(e=>(0,J.jsx)(li,{profile:e,onUserClick:O},e.handle)):(0,J.jsx)(`div`,{className:`p-20 text-center text-zinc-500`,children:(0,J.jsx)(`p`,{className:`font-bold`,children:`No users found`})}),e[29]=O,e[30]=y,e[31]=F):F=e[31];let I;e[32]===F?I=e[33]:(I=(0,J.jsx)(hi,{value:`users`,className:`m-0 border-none`,children:(0,J.jsx)(`div`,{className:`divide-y divide-zinc-100 dark:divide-zinc-800`,children:F})}),e[32]=F,e[33]=I);let L;e[34]!==x||e[35]!==O?(L=x.length>0?x.map(e=>(0,J.jsx)(li,{profile:e,onUserClick:O,isCommunity:!0},e.handle)):(0,J.jsx)(`div`,{className:`p-20 text-center text-zinc-500`,children:(0,J.jsx)(`p`,{className:`font-bold`,children:`No communities found`})}),e[34]=x,e[35]=O,e[36]=L):L=e[36];let R;e[37]===L?R=e[38]:(R=(0,J.jsx)(hi,{value:`communities`,className:`m-0 border-none`,children:(0,J.jsx)(`div`,{className:`divide-y divide-zinc-100 dark:divide-zinc-800`,children:L})}),e[37]=L,e[38]=R);let z;e[39]!==n||e[40]!==t||e[41]!==E||e[42]!==O||e[43]!==w?(z=w.length>0?w.map(e=>(0,J.jsx)(ti,{...e,currentUser:t,showToast:n,onClick:()=>E(e.id),onUserClick:O},e.id)):(0,J.jsx)(`div`,{className:`p-20 text-center text-zinc-500`,children:(0,J.jsx)(`p`,{className:`font-bold`,children:`No reels found`})}),e[39]=n,e[40]=t,e[41]=E,e[42]=O,e[43]=w,e[44]=z):z=e[44];let B;e[45]===z?B=e[46]:(B=(0,J.jsx)(hi,{value:`reels`,className:`m-0 border-none`,children:(0,J.jsx)(`div`,{children:z})}),e[45]=z,e[46]=B);let V;return e[47]!==i||e[48]!==P||e[49]!==I||e[50]!==R||e[51]!==B?(V=(0,J.jsx)(`div`,{className:`border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm`,children:(0,J.jsxs)(fi,{value:i,onValueChange:a,className:`w-full`,children:[P,I,R,B]})}),e[47]=i,e[48]=P,e[49]=I,e[50]=R,e[51]=B,e[52]=V):V=e[52],V};function vi(e){return e.type!==`community`}function yi(e){return e.type===`community`}function bi(e){return e.type===`video`}function xi(e){return(0,J.jsx)(ri,{},e)}function Si(e){return(0,J.jsx)(mi,{value:e,className:`relative py-4 px-2 text-sm font-semibold transition-all border-b-2 rounded-none whitespace-nowrap flex-1 text-center capitalize data-[state=active]:border-black dark:data-[state=active]:border-white data-[state=active]:text-black dark:data-[state=active]:text-white text-zinc-500 hover:text-zinc-800 dark:hover:text-zinc-300`,children:e},e)}var Ci=r(),wi=e=>{let r=(0,Ci.c)(58),{reel:i}=e,a=(0,K.useRef)(null),[o,s]=(0,K.useState)(!1),c=(0,K.useRef)(0),l=Array.isArray(i.media)?i.media[0]?.src||i.media[0]?.url:i.media?.src||i.media?.url||i.url,u,d;r[0]===Symbol.for(`react.memo_cache_sentinel`)?(u=()=>{let e=new IntersectionObserver(e=>{let[t]=e;a.current?.plyr&&(t.isIntersecting?a.current.plyr.play().catch(()=>{a.current.plyr.muted=!0,a.current.plyr.play()}):a.current.plyr.pause())},{threshold:.8}),t=a.current?.elements?.container;return t&&e.observe(t),()=>{t&&e.unobserve(t)}},d=[],r[0]=u,r[1]=d):(u=r[0],d=r[1]),(0,K.useEffect)(u,d);let f;r[2]===Symbol.for(`react.memo_cache_sentinel`)?(f=()=>{let e=Date.now();e-c.current<300&&(s(!0),setTimeout(()=>s(!1),1e3)),c.current=e},r[2]=f):f=r[2];let p=f,m;r[3]===l?m=r[4]:(m={type:`video`,sources:[{src:l,type:`video/mp4`}]},r[3]=l,r[4]=m);let h;r[5]===Symbol.for(`react.memo_cache_sentinel`)?(h={controls:[],loop:{active:!0},clickToPlay:!0,ratio:`9:16`},r[5]=h):h=r[5];let _;r[6]===m?_=r[7]:(_={source:m,options:h},r[6]=m,r[7]=_);let v=_,y;r[8]===v?y=r[9]:(y=(0,J.jsx)(`div`,{className:`w-full h-full max-w-[450px]`,children:(0,J.jsx)(We,{ref:a,...v})}),r[8]=v,r[9]=y);let b;r[10]===o?b=r[11]:(b=o&&(0,J.jsx)(n.div,{initial:{scale:0,opacity:0},animate:{scale:1.5,opacity:1},exit:{scale:2,opacity:0},className:`absolute inset-0 flex items-center justify-center pointer-events-none z-50`,children:(0,J.jsx)(de,{size:100,fill:`white`,className:`text-white drop-shadow-2xl`})}),r[10]=o,r[11]=b);let x;r[12]===b?x=r[13]:(x=(0,J.jsx)(Ce,{children:b}),r[12]=b,r[13]=x);let S;r[14]===Symbol.for(`react.memo_cache_sentinel`)?(S=(0,J.jsx)(`div`,{className:`absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-black/60 pointer-events-none`}),r[14]=S):S=r[14];let C=i.user?.avatar,w=i.user?.handle,T;r[15]!==C||r[16]!==w?(T=(0,J.jsx)(Q,{src:C,alt:w,className:`object-cover`}),r[15]=C,r[16]=w,r[17]=T):T=r[17];let E;r[18]===i.user?.handle?.[0]?E=r[19]:(E=i.user?.handle?.[0]?.toUpperCase(),r[18]=i.user?.handle?.[0],r[19]=E);let D;r[20]===E?D=r[21]:(D=(0,J.jsx)($,{children:E}),r[20]=E,r[21]=D);let O;r[22]!==T||r[23]!==D?(O=(0,J.jsxs)(Z,{className:`size-10 border-2 border-white`,children:[T,D]}),r[22]=T,r[23]=D,r[24]=O):O=r[24];let k=i.user?.handle,A;r[25]===k?A=r[26]:(A=(0,J.jsxs)(`span`,{className:`font-bold`,children:[`@`,k]}),r[25]=k,r[26]=A);let j;r[27]===Symbol.for(`react.memo_cache_sentinel`)?(j=(0,J.jsx)(`button`,{className:`bg-white text-black text-xs font-bold px-3 py-1 rounded-full ml-2 hover:scale-105 active:scale-95 transition-all`,children:`Follow`}),r[27]=j):j=r[27];let M;r[28]!==O||r[29]!==A?(M=(0,J.jsxs)(`div`,{className:`flex items-center gap-2 mb-3 pointer-events-auto`,children:[O,A,j]}),r[28]=O,r[29]=A,r[30]=M):M=r[30];let N;r[31]===i.content?N=r[32]:(N=(0,J.jsx)(`p`,{className:`text-sm mb-3 line-clamp-2`,children:i.content}),r[31]=i.content,r[32]=N);let P;r[33]===Symbol.for(`react.memo_cache_sentinel`)?(P=(0,J.jsx)(ne,{size:14,className:`animate-spin-slow`}),r[33]=P):P=r[33];let F=i.user?.handle,I;r[34]===F?I=r[35]:(I=(0,J.jsxs)(`div`,{className:`flex items-center gap-2 text-xs opacity-90`,children:[P,(0,J.jsxs)(`span`,{children:[`Original Audio - `,F]})]}),r[34]=F,r[35]=I);let L;r[36]!==M||r[37]!==N||r[38]!==I?(L=(0,J.jsxs)(`div`,{className:`absolute bottom-20 left-4 right-16 text-white pointer-events-none`,children:[M,N,I]}),r[36]=M,r[37]=N,r[38]=I,r[39]=L):L=r[39];let R;r[40]===Symbol.for(`react.memo_cache_sentinel`)?(R=(0,J.jsx)(`button`,{className:`p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90`,children:(0,J.jsx)(de,{size:28})}),r[40]=R):R=r[40];let z=i.stats?.likes||0,B;r[41]===z?B=r[42]:(B=(0,J.jsxs)(`div`,{className:`flex flex-col items-center gap-1`,children:[R,(0,J.jsx)(`span`,{className:`text-white text-xs font-bold`,children:z})]}),r[41]=z,r[42]=B);let V;r[43]===Symbol.for(`react.memo_cache_sentinel`)?(V=(0,J.jsx)(`button`,{className:`p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90`,children:(0,J.jsx)(t,{size:28})}),r[43]=V):V=r[43];let H=i.stats?.comments||0,U;r[44]===H?U=r[45]:(U=(0,J.jsxs)(`div`,{className:`flex flex-col items-center gap-1`,children:[V,(0,J.jsx)(`span`,{className:`text-white text-xs font-bold`,children:H})]}),r[44]=H,r[45]=U);let ee;r[46]===Symbol.for(`react.memo_cache_sentinel`)?(ee=(0,J.jsx)(`button`,{className:`p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90`,children:(0,J.jsx)(g,{size:28})}),r[46]=ee):ee=r[46];let te=i.stats?.shares||0,W;r[47]===te?W=r[48]:(W=(0,J.jsxs)(`div`,{className:`flex flex-col items-center gap-1`,children:[ee,(0,J.jsx)(`span`,{className:`text-white text-xs font-bold`,children:te})]}),r[47]=te,r[48]=W);let G;r[49]!==B||r[50]!==U||r[51]!==W?(G=(0,J.jsxs)(`div`,{className:`absolute bottom-20 right-2 flex flex-col items-center gap-6 z-10`,children:[B,U,W]}),r[49]=B,r[50]=U,r[51]=W,r[52]=G):G=r[52];let re;return r[53]!==L||r[54]!==G||r[55]!==y||r[56]!==x?(re=(0,J.jsxs)(`div`,{className:`relative h-screen w-full bg-black snap-start flex items-center justify-center overflow-hidden`,onClick:p,children:[y,x,S,L,G]}),r[53]=L,r[54]=G,r[55]=y,r[56]=x,r[57]=re):re=r[57],re},Ti=r(),Ei=()=>{let e=(0,Ti.c)(10),{posts:t,loading:n}=sn(),r,i,a;if(e[0]!==n||e[1]!==t){a=Symbol.for(`react.early_return_sentinel`);bb0:{let o=t.filter(Di);if(n){let t;e[5]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,J.jsx)(`div`,{className:`h-screen w-full flex items-center justify-center bg-black`,children:(0,J.jsx)(je,{size:40,className:`animate-spin text-white`})}),e[5]=t):t=e[5],a=t;break bb0}if(o.length===0){let t;e[6]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,J.jsx)(`div`,{className:`h-screen w-full flex flex-col items-center justify-center bg-black text-white gap-4`,children:(0,J.jsx)(`p`,{className:`text-zinc-500`,children:`No reels found.`})}),e[6]=t):t=e[6],a=t;break bb0}r=`h-screen w-full snap-y snap-mandatory overflow-y-auto no-scrollbar bg-black md:rounded-xl`,i=o.map(Oi)}e[0]=n,e[1]=t,e[2]=r,e[3]=i,e[4]=a}else r=e[2],i=e[3],a=e[4];if(a!==Symbol.for(`react.early_return_sentinel`))return a;let o;return e[7]!==r||e[8]!==i?(o=(0,J.jsx)(`div`,{className:r,children:i}),e[7]=r,e[8]=i,e[9]=o):o=e[9],o};function Di(e){return e.type===`video`||e.category===`video`}function Oi(e){return(0,J.jsx)(wi,{reel:e},e.id)}var ki=r();const Ai=e=>{let t=(0,ki.c)(5),n;t[0]===e?n=t[1]:(n=()=>En(e),t[0]=e,t[1]=n);let[r,i]=(0,K.useState)(n),a,o;return t[2]===e?(a=t[3],o=t[4]):(a=()=>{if(!e)return;let t=setTimeout(()=>{i(En(e))},0),n=setInterval(()=>{i(En(e))},6e4);return()=>{clearTimeout(t),clearInterval(n)}},o=[e],t[2]=e,t[3]=a,t[4]=o),(0,K.useEffect)(a,o),r};var ji=r(),Mi=e=>{let t=(0,ji.c)(50),{conv:n,selectedId:r,onSelect:i,onlineUsers:a}=e,o=Ai(n.user?.lastSeen),s;t[0]!==n.user?.id||t[1]!==a?(s=a.has(n.user?.id),t[0]=n.user?.id,t[1]=a,t[2]=s):s=t[2];let c=s,l;t[3]!==n||t[4]!==i?(l=()=>i(n),t[3]=n,t[4]=i,t[5]=l):l=t[5];let u=`flex items-center gap-3 p-4 cursor-pointer transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900 ${r===n.id?`bg-zinc-50 dark:bg-zinc-900 border-r-2 border-violet-500`:``}`,d=n.user?.avatar,f=n.user?.name,p;t[6]!==d||t[7]!==f?(p=(0,J.jsx)(Q,{src:d,alt:f,className:`object-cover`}),t[6]=d,t[7]=f,t[8]=p):p=t[8];let m;t[9]===n.user?.name?.[0]?m=t[10]:(m=n.user?.name?.[0]?.toUpperCase(),t[9]=n.user?.name?.[0],t[10]=m);let h;t[11]===m?h=t[12]:(h=(0,J.jsx)($,{children:m}),t[11]=m,t[12]=h);let g;t[13]!==p||t[14]!==h?(g=(0,J.jsxs)(Z,{className:`size-12`,children:[p,h]}),t[13]=p,t[14]=h,t[15]=g):g=t[15];let _;t[16]===c?_=t[17]:(_=c&&(0,J.jsx)(`span`,{className:`absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full`}),t[16]=c,t[17]=_);let v;t[18]!==_||t[19]!==g?(v=(0,J.jsxs)(`div`,{className:`relative`,children:[g,_]}),t[18]=_,t[19]=g,t[20]=v):v=t[20];let y=n.user?.name,b;t[21]===y?b=t[22]:(b=(0,J.jsx)(`span`,{className:`font-bold dark:text-white truncate`,children:y}),t[21]=y,t[22]=b);let x;t[23]!==n.user?.lastSeen||t[24]!==c||t[25]!==o?(x=c?(0,J.jsx)(`span`,{className:`text-[10px] text-emerald-500 font-medium leading-none mb-1`,children:`Online`}):n.user?.lastSeen&&(0,J.jsx)(`span`,{className:`text-[10px] text-zinc-500 font-medium leading-none mb-1`,children:o}),t[23]=n.user?.lastSeen,t[24]=c,t[25]=o,t[26]=x):x=t[26];let S;t[27]!==b||t[28]!==x?(S=(0,J.jsxs)(`div`,{className:`flex flex-col min-w-0`,children:[b,x]}),t[27]=b,t[28]=x,t[29]=S):S=t[29];let C;t[30]===n.time?C=t[31]:(C=(0,J.jsx)(`span`,{className:`text-xs text-zinc-500 whitespace-nowrap ml-2`,children:n.time}),t[30]=n.time,t[31]=C);let w;t[32]!==S||t[33]!==C?(w=(0,J.jsxs)(`div`,{className:`flex justify-between items-center mb-0.5`,children:[S,C]}),t[32]=S,t[33]=C,t[34]=w):w=t[34];let T;t[35]===n.lastMessage?T=t[36]:(T=(0,J.jsx)(`p`,{className:`text-zinc-500 text-sm truncate pr-2`,children:n.lastMessage}),t[35]=n.lastMessage,t[36]=T);let E;t[37]===n.unread?E=t[38]:(E=n.unread>0&&(0,J.jsx)(`span`,{className:`bg-violet-600 text-white text-[10px] font-bold size-5 rounded-full flex items-center justify-center shrink-0`,children:n.unread}),t[37]=n.unread,t[38]=E);let D;t[39]!==T||t[40]!==E?(D=(0,J.jsxs)(`div`,{className:`flex-1 flex justify-between items-center`,children:[T,E]}),t[39]=T,t[40]=E,t[41]=D):D=t[41];let O;t[42]!==w||t[43]!==D?(O=(0,J.jsxs)(`div`,{className:`flex-1 min-w-0`,children:[w,D]}),t[42]=w,t[43]=D,t[44]=O):O=t[44];let k;return t[45]!==v||t[46]!==l||t[47]!==O||t[48]!==u?(k=(0,J.jsxs)(`div`,{onClick:l,className:u,children:[v,O]}),t[45]=v,t[46]=l,t[47]=O,t[48]=u,t[49]=k):k=t[49],k},Ni=({conversations:e,userResults:t=[],onSelect:n,onStartNew:r,selectedId:i,searchQuery:a,onSearchChange:o,onlineUsers:s=new Set})=>(0,J.jsxs)(`div`,{className:`flex-1 flex flex-col min-w-0 bg-white dark:bg-black`,children:[(0,J.jsx)(`div`,{className:`p-4 border-b border-zinc-100 dark:border-zinc-800`,children:(0,J.jsx)(xn,{value:a,onChange:o,onClear:()=>o(``),placeholder:`Search people or messages...`})}),(0,J.jsxs)(`div`,{className:`flex-1 overflow-y-auto`,children:[e.length>0&&(0,J.jsx)(`div`,{className:`py-2`,children:e.map(e=>(0,J.jsx)(Mi,{conv:e,selectedId:i,onSelect:n,onlineUsers:s},e.id))}),t.length>0&&(0,J.jsxs)(`div`,{className:`border-t border-zinc-100 dark:border-zinc-800`,children:[(0,J.jsx)(`div`,{className:`px-4 py-3 text-xs font-bold text-zinc-500 uppercase tracking-wider`,children:`People`}),t.map(e=>(0,J.jsxs)(`div`,{onClick:()=>r(e),className:`flex items-center gap-3 p-4 cursor-pointer transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900`,children:[(0,J.jsxs)(Z,{className:`size-12`,children:[(0,J.jsx)(Q,{src:e.avatar,alt:e.name,className:`object-cover`}),(0,J.jsx)($,{children:e.name?.[0]?.toUpperCase()})]}),(0,J.jsxs)(`div`,{className:`flex-1 min-w-0`,children:[(0,J.jsx)(`div`,{className:`font-bold dark:text-white truncate`,children:e.name}),(0,J.jsxs)(`div`,{className:`text-zinc-500 text-sm truncate`,children:[`@`,e.handle]})]}),(0,J.jsx)(v,{size:18,className:`text-violet-500`})]},e.id))]}),e.length===0&&t.length===0&&a&&(0,J.jsx)(`div`,{className:`p-8 text-center`,children:(0,J.jsxs)(`p`,{className:`text-zinc-500 text-sm`,children:[`No conversations or people found for "`,a,`"`]})}),e.length===0&&!a&&(0,J.jsx)(`div`,{className:`p-8 text-center`,children:(0,J.jsx)(`p`,{className:`text-zinc-500 text-sm`,children:`No messages yet. Search for people to start a chat!`})})]})]}),Pi=r(),Fi=e=>{let t=(0,Pi.c)(7),{className:n}=e,r;t[0]===n?r=t[1]:(r=X(`flex items-center gap-1 px-1 py-1.5`,n),t[0]=n,t[1]=r);let i,a,o;t[2]===Symbol.for(`react.memo_cache_sentinel`)?(i=(0,J.jsx)(`div`,{className:`size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse`}),a=(0,J.jsx)(`div`,{className:`size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse [animation-delay:0.2s]`}),o=(0,J.jsx)(`div`,{className:`size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse [animation-delay:0.4s]`}),t[2]=i,t[3]=a,t[4]=o):(i=t[2],a=t[3],o=t[4]);let s;return t[5]===r?s=t[6]:(s=(0,J.jsxs)(`div`,{className:r,children:[i,a,o]}),t[5]=r,t[6]=s),s},Ii=r();function Li(e){let t=(0,Ii.c)(4),n;t[0]===e?n=t[1]:({...n}=e,t[0]=e,t[1]=n);let r;return t[2]===n?r=t[3]:(r=(0,J.jsx)(xe,{"data-slot":`popover`,...n}),t[2]=n,t[3]=r),r}function Ri(e){let t=(0,Ii.c)(4),n;t[0]===e?n=t[1]:({...n}=e,t[0]=e,t[1]=n);let r;return t[2]===n?r=t[3]:(r=(0,J.jsx)(oe,{"data-slot":`popover-trigger`,...n}),t[2]=n,t[3]=r),r}function zi(e){let t=(0,Ii.c)(12),n,r,i,a;t[0]===e?(n=t[1],r=t[2],i=t[3],a=t[4]):({className:n,align:i,sideOffset:a,...r}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a);let o=i===void 0?`center`:i,s=a===void 0?4:a,c;t[5]===n?c=t[6]:(c=X(`bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 rounded-md border p-4 shadow-md outline-hidden`,n),t[5]=n,t[6]=c);let l;return t[7]!==o||t[8]!==r||t[9]!==s||t[10]!==c?(l=(0,J.jsx)(Re,{children:(0,J.jsx)(Ae,{"data-slot":`popover-content`,align:o,sideOffset:s,className:c,...r})}),t[7]=o,t[8]=r,t[9]=s,t[10]=c,t[11]=l):l=t[11],l}var Bi=r(),Vi=e=>{let t=(0,Bi.c)(10),{onEmojiSelect:n,className:r}=e,i;t[0]===r?i=t[1]:(i=X(`isolate flex h-[350px] w-[320px] flex-col overflow-hidden rounded-xl border border-zinc-200 bg-white shadow-xl dark:border-zinc-800 dark:bg-zinc-950`,r),t[0]=r,t[1]=i);let a;t[2]===Symbol.for(`react.memo_cache_sentinel`)?(a=(0,J.jsx)(He.Search,{className:`z-10 mx-3 mt-3 appearance-none rounded-lg border-none bg-zinc-100 px-3 py-2 text-sm outline-none placeholder:text-zinc-500 focus:ring-1 focus:ring-violet-500 dark:bg-zinc-900 dark:text-white`,placeholder:`Search emojis...`}),t[2]=a):a=t[2];let o,s;t[3]===Symbol.for(`react.memo_cache_sentinel`)?(o=(0,J.jsx)(He.Loading,{className:`absolute inset-0 flex items-center justify-center text-zinc-400 text-sm dark:text-zinc-500`,children:`Loadingâ€¦`}),s=(0,J.jsx)(He.Empty,{className:`absolute inset-0 flex items-center justify-center text-zinc-400 text-sm dark:text-zinc-500`,children:`No emoji found.`}),t[3]=o,t[4]=s):(o=t[3],s=t[4]);let c,l;t[5]===Symbol.for(`react.memo_cache_sentinel`)?(c=(0,J.jsxs)(He.Viewport,{className:`relative flex-1 outline-none no-scrollbar`,children:[o,s,(0,J.jsx)(He.List,{className:`select-none pb-2`,components:{CategoryHeader:Hi,Row:Ui,Emoji:Wi}})]}),l=(0,J.jsx)(He.ActiveEmoji,{children:Gi}),t[5]=c,t[6]=l):(c=t[5],l=t[6]);let u;return t[7]!==n||t[8]!==i?(u=(0,J.jsxs)(He.Root,{onEmojiSelect:n,className:i,children:[a,c,l]}),t[7]=n,t[8]=i,t[9]=u):u=t[9],u};function Hi(e){let{category:t,...n}=e;return(0,J.jsx)(`div`,{className:`bg-white/80 px-4 pt-4 pb-1.5 font-bold text-zinc-500 text-[11px] uppercase tracking-wider backdrop-blur-sm dark:bg-zinc-950/80 dark:text-zinc-400`,...n,children:t.label})}function Ui(e){let{children:t,...n}=e;return(0,J.jsx)(`div`,{className:`scroll-my-1 px-2`,...n,children:t})}function Wi(e){let{emoji:t,...n}=e;return(0,J.jsx)(`button`,{className:`flex aspect-square size-9 items-center justify-center rounded-lg text-xl transition-colors hover:bg-zinc-100 data-[active]:bg-violet-500/10 data-[active]:text-violet-500 dark:hover:bg-zinc-900 dark:data-[active]:bg-violet-500/20`,...n,children:t.emoji})}function Gi(e){let{emoji:t}=e;return(0,J.jsx)(`div`,{className:`flex items-center gap-3 border-t border-zinc-100 p-3 dark:border-zinc-800`,children:t?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(`span`,{className:`text-2xl`,children:t.emoji}),(0,J.jsx)(`span`,{className:`text-xs font-bold text-zinc-600 dark:text-zinc-400 truncate`,children:t.label.replace(/:/g,``).replace(/_/g,` `)})]}):(0,J.jsx)(`span`,{className:`text-xs font-medium text-zinc-400`,children:`Select an emoji...`})})}var Ki=({conversation:e,messages:t,onBack:n,onSendMessage:r,onTyping:i,isLoading:a,isTyping:o,isOnline:s})=>{let{openLightbox:c}=dn(),[u,d]=(0,K.useState)(``),[f,p]=(0,K.useState)(!1),[m,h]=(0,K.useState)([]),[g,_]=(0,K.useState)(!1),v=(0,K.useRef)(null),y=(0,K.useRef)(null),x=(0,K.useRef)(null),S=Ai(e.user?.lastSeen);(0,K.useEffect)(()=>{y.current&&(y.current.scrollTop=y.current.scrollHeight)},[t,o]);let C=e=>{let t=e.target.value;d(t),i&&(i(!0),x.current&&clearTimeout(x.current),x.current=setTimeout(()=>{i(!1)},2e3))},w=e=>{d(t=>t+e.emoji)},T=t=>{t.preventDefault(),!(!u.trim()&&m.length===0)&&(i&&(clearTimeout(x.current),i(!1)),r(e.id,u,m.length>0?`image`:`text`,m),d(``),h([]))},E=async e=>{let t=Array.from(e.target.files);if(t.length!==0){p(!0);try{let e=await Promise.all(t.map(e=>pt(e)));h(t=>[...t,...e])}catch(e){console.error(`Upload failed:`,e)}finally{p(!1)}}},D=e=>{h(t=>t.filter(t=>t.url!==e))},O=e=>{!e.media||e.media.length===0||c(e.media.map(e=>e.url),0)},k=(0,K.useMemo)(()=>{let e=t.filter(e=>e.sender===`me`);return e.length>0?e[e.length-1].id:null},[t]);return(0,J.jsxs)(`div`,{className:`flex-1 flex flex-col h-full bg-white dark:bg-black md:border-l md:border-zinc-100 dark:md:border-zinc-800`,children:[(0,J.jsxs)(`div`,{className:`p-4 border-b border-zinc-100 dark:border-zinc-800 flex items-center justify-between shrink-0 bg-white/80 dark:bg-black/80 backdrop-blur-md sticky top-0 z-10`,children:[(0,J.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,J.jsx)(`button`,{onClick:n,className:`md:hidden p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors`,children:(0,J.jsx)(l,{size:20})}),(0,J.jsxs)(`div`,{className:`relative`,children:[(0,J.jsxs)(Z,{className:`size-10 border border-zinc-200 dark:border-zinc-700`,children:[(0,J.jsx)(Q,{src:e.user.avatar,alt:e.user.name,className:`object-cover`}),(0,J.jsx)($,{children:e.user.name?.[0]?.toUpperCase()})]}),s&&(0,J.jsx)(`span`,{className:`absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full`})]}),(0,J.jsxs)(`div`,{children:[(0,J.jsx)(`div`,{className:`font-bold dark:text-white`,children:e.user.name}),s?(0,J.jsxs)(`div`,{className:`text-xs text-emerald-500 font-medium flex items-center gap-1`,children:[(0,J.jsx)(`span`,{className:`size-1.5 bg-emerald-500 rounded-full animate-pulse`}),`Online`]}):(0,J.jsx)(`div`,{className:`text-xs text-zinc-500 font-medium`,children:e.user.lastSeen?`Last seen ${S}`:`Offline`})]})]}),(0,J.jsx)(`button`,{className:`p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full dark:text-zinc-400`,children:(0,J.jsx)(Fe,{size:20})})]}),(0,J.jsxs)(`div`,{className:`flex-1 overflow-y-auto p-4 space-y-4`,ref:y,children:[(0,J.jsxs)(`div`,{className:`text-center py-8`,children:[(0,J.jsxs)(`div`,{className:`relative w-fit mx-auto`,children:[(0,J.jsxs)(Z,{className:`size-20 mx-auto mb-3 border-4 border-zinc-50 dark:border-zinc-900 shadow-sm`,children:[(0,J.jsx)(Q,{src:e.user.avatar,alt:e.user.name,className:`object-cover`}),(0,J.jsx)($,{className:`text-2xl font-bold`,children:e.user.name?.[0]?.toUpperCase()})]}),s&&(0,J.jsx)(`span`,{className:`absolute bottom-4 right-1 size-5 bg-emerald-500 border-4 border-white dark:border-black rounded-full animate-in zoom-in duration-300`})]}),(0,J.jsx)(`h4`,{className:`font-bold dark:text-white text-lg`,children:e.user.name}),(0,J.jsxs)(`p`,{className:`text-sm text-zinc-500`,children:[`@`,e.user.handle]}),(0,J.jsxs)(`p`,{className:`text-xs text-zinc-400 mt-4 max-w-xs mx-auto`,children:[`This is the beginning of your direct message history with `,(0,J.jsxs)(`span`,{className:`font-bold`,children:[`@`,e.user.handle]})]})]}),a&&t.length===0?(0,J.jsx)(`div`,{className:`flex justify-center p-8`,children:(0,J.jsx)(je,{className:`animate-spin text-violet-500`,size:32})}):t.map(e=>(0,J.jsx)(`div`,{className:`flex ${e.sender===`me`?`justify-end`:`justify-start`}`,children:(0,J.jsxs)(`div`,{className:`max-w-[75%] p-1 rounded-2xl text-[15px] shadow-sm ${e.sender===`me`?`bg-violet-600 text-white rounded-tr-none`:`bg-zinc-100 dark:bg-zinc-800 dark:text-white rounded-tl-none`}`,children:[e.media?.length>0&&(0,J.jsx)(`div`,{className:`mb-2 grid gap-1 grid-cols-1 overflow-hidden rounded-lg cursor-pointer`,onClick:()=>O(e),children:e.media.map((e,t)=>(0,J.jsx)(`img`,{src:e.url,alt:``,className:`max-h-60 w-full object-cover rounded-md hover:brightness-90 transition-all`},t))}),e.text&&(0,J.jsx)(`p`,{className:`m-0 leading-tight px-3 py-1`,children:e.text}),(0,J.jsxs)(`div`,{className:`text-[10px] flex items-center justify-end gap-1 px-3 pb-1 ${e.sender===`me`?`text-violet-200`:`text-zinc-400`}`,children:[e.time,e.sender===`me`&&e.id===k&&(0,J.jsx)(`span`,{className:`ml-0.5`,children:e.isRead?(0,J.jsx)(L,{size:14,className:`text-white`}):(0,J.jsx)(Ze,{size:14,className:`text-violet-200`})})]})]})},e.id)),o&&(0,J.jsx)(`div`,{className:`flex justify-start animate-in fade-in slide-in-from-bottom-2 duration-300`,children:(0,J.jsx)(`div`,{className:`bg-zinc-100 dark:bg-zinc-800/50 px-3 py-2 rounded-2xl rounded-tl-none border border-zinc-200/50 dark:border-zinc-700/30 shadow-sm`,children:(0,J.jsx)(Fi,{})})})]}),(0,J.jsxs)(`div`,{className:`p-4 border-t border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black shrink-0`,children:[m.length>0&&(0,J.jsxs)(`div`,{className:`flex flex-wrap gap-2 mb-3`,children:[m.map(e=>(0,J.jsxs)(`div`,{className:`relative size-16 rounded-xl overflow-hidden border border-zinc-200 dark:border-zinc-800`,children:[(0,J.jsx)(`img`,{src:e.url,className:`size-full object-cover`,alt:``}),(0,J.jsx)(`button`,{type:`button`,onClick:()=>D(e.url),className:`absolute top-1 right-1 bg-black/50 text-white rounded-full p-0.5 hover:bg-black transition-colors`,children:(0,J.jsx)(j,{size:12})})]},e.url)),f&&(0,J.jsx)(`div`,{className:`size-16 rounded-xl bg-zinc-100 dark:bg-zinc-900 flex items-center justify-center`,children:(0,J.jsx)(je,{className:`animate-spin text-violet-500`,size:20})})]}),(0,J.jsxs)(`form`,{onSubmit:T,className:`flex items-center gap-2 bg-zinc-100 dark:bg-zinc-900 p-2 rounded-2xl border border-transparent focus-within:border-violet-500 transition-all`,children:[(0,J.jsxs)(Li,{open:g,onOpenChange:_,children:[(0,J.jsx)(Ri,{asChild:!0,children:(0,J.jsx)(`button`,{type:`button`,className:`p-2 text-zinc-500 hover:text-violet-600 transition-colors`,children:(0,J.jsx)(H,{size:20})})}),(0,J.jsx)(zi,{className:`w-fit p-0 border-none bg-transparent shadow-none`,side:`top`,align:`start`,sideOffset:10,children:(0,J.jsx)(Vi,{onEmojiSelect:e=>{w(e)}})})]}),(0,J.jsx)(`input`,{type:`text`,className:`flex-1 bg-transparent border-none outline-none dark:text-white py-1 px-1`,placeholder:`Start a new message`,value:u,onChange:C}),(0,J.jsx)(`input`,{type:`file`,ref:v,onChange:E,className:`hidden`,multiple:!0,accept:`image/*`}),(0,J.jsx)(`button`,{type:`button`,onClick:()=>v.current?.click(),className:`p-2 text-zinc-500 hover:text-violet-600 transition-colors`,disabled:f,children:(0,J.jsx)(b,{size:20})}),(0,J.jsx)(tr,{type:`submit`,className:`size-10 !p-0 rounded-xl`,disabled:!u.trim()&&m.length===0||f,children:(0,J.jsx)(B,{size:18})})]})]})]})},qi=r(),Ji=()=>{let e=(0,qi.c)(69),{id:t}=Le(),n=C(),{currentUser:r}=Y(),{onlineUsers:i}=Gt(),a=y(),[o,s]=(0,K.useState)(``),c;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(c=[],e[0]=c):c=e[0];let[l,u]=(0,K.useState)(c),{conversations:d,isConvLoading:f,sendMessage:p,sendTypingStatus:m,typingStatus:h,markAsRead:g,formatMessages:_}=gn(r),v;bb0:{if(!t||d.length===0){v=null;break bb0}let n;e[1]!==d||e[2]!==t?(n=d.find(e=>e.id===t)||null,e[1]=d,e[2]=t,e[3]=n):n=e[3],v=n}let b=v,x,S;e[4]!==t||e[5]!==g?(x=()=>{t&&g(t)},S=[t,g],e[4]=t,e[5]=g,e[6]=x,e[7]=S):(x=e[6],S=e[7]),(0,K.useEffect)(x,S);let w;e[8]!==d||e[9]!==r?.id||e[10]!==o?(w=()=>{let e=setTimeout(async()=>{if(o.length>1){let e=await _t(o),t=d.map(Yi);u(e.filter(e=>e.id!==r?.id&&!t.includes(e.id)))}else u([])},300);return()=>clearTimeout(e)},e[8]=d,e[9]=r?.id,e[10]=o,e[11]=w):w=e[11];let T=r?.id,E;e[12]!==d||e[13]!==o||e[14]!==T?(E=[o,d,T],e[12]=d,e[13]=o,e[14]=T,e[15]=E):E=e[15],(0,K.useEffect)(w,E);let O;e[16]!==r||e[17]!==n||e[18]!==a?(O=async e=>{try{let t=await vt(r.id,e.id);a.invalidateQueries({queryKey:[`conversations`,r.id]}),s(``),n(`/messages/${t}`)}catch(e){let t=e;console.error(`Failed to start conversation:`,t)}},e[16]=r,e[17]=n,e[18]=a,e[19]=O):O=e[19];let k=O,A;e[20]===n?A=e[21]:(A=e=>{n(`/messages/${e.id}`)},e[20]=n,e[21]=A);let j=A,N=b?.id,P;e[22]===N?P=e[23]:(P=[`messages`,N],e[22]=N,e[23]=P);let F;e[24]===b?.id?F=e[25]:(F=()=>Ot(b?.id),e[24]=b?.id,e[25]=F);let I=!!b?.id,L;e[26]!==P||e[27]!==F||e[28]!==I?(L={queryKey:P,queryFn:F,enabled:I},e[26]=P,e[27]=F,e[28]=I,e[29]=L):L=e[29];let{data:R,isLoading:z}=M(L),B;e[30]===R?B=e[31]:(B=R===void 0?[]:R,e[30]=R,e[31]=B);let V=B,H;e[32]!==V||e[33]!==_?(H=_(V),e[32]=V,e[33]=_,e[34]=H):H=e[34];let U=H;if(!r){let t;return e[35]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,J.jsxs)(`div`,{className:`flex flex-col items-center justify-center h-screen gap-4 p-8 text-center bg-white dark:bg-black md:rounded-xl md:border border-zinc-100 dark:border-zinc-800`,children:[(0,J.jsx)(`div`,{className:`bg-zinc-100 dark:bg-zinc-900 p-4 rounded-full`,children:(0,J.jsx)(D,{size:40,className:`text-zinc-400`})}),(0,J.jsx)(`h3`,{className:`text-xl font-bold dark:text-white`,children:`Sign in to message others`}),(0,J.jsx)(`p`,{className:`text-zinc-500 max-w-xs`,children:`Start decentralized conversations with anyone on the network.`})]}),e[35]=t):t=e[35],t}if(f){let t;return e[36]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,J.jsx)(`div`,{className:`flex h-screen items-center justify-center bg-white dark:bg-black md:rounded-xl md:border border-zinc-100 dark:border-zinc-800`,children:(0,J.jsx)(je,{className:`animate-spin text-violet-500`,size:32})}),e[36]=t):t=e[36],t}let ee;if(e[37]!==d||e[38]!==o){let t;e[40]===o?t=e[41]:(t=e=>e.user?.name?.toLowerCase().includes(o.toLowerCase())||e.user?.handle?.toLowerCase().includes(o.toLowerCase())||e.lastMessage?.toLowerCase().includes(o.toLowerCase()),e[40]=o,e[41]=t),ee=d.filter(t),e[37]=d,e[38]=o,e[39]=ee}else ee=e[39];let te=ee,ne=b&&h[b.id],W;e[42]!==i||e[43]!==b?(W=b&&i.has(b.user?.id),e[42]=i,e[43]=b,e[44]=W):W=e[44];let G=W,re=`w-full md:w-80 flex flex-col border-r border-zinc-100 dark:border-zinc-800 ${b?`hidden md:flex`:`flex`}`,ie;e[45]===Symbol.for(`react.memo_cache_sentinel`)?(ie=(0,J.jsx)(`div`,{className:`p-4 border-b border-zinc-100 dark:border-zinc-800`,children:(0,J.jsx)(`h2`,{className:`text-xl font-bold dark:text-white`,children:`Messages`})}),e[45]=ie):ie=e[45];let ae;e[46]!==te||e[47]!==j||e[48]!==k||e[49]!==t||e[50]!==o||e[51]!==i||e[52]!==l?(ae=(0,J.jsx)(Ni,{conversations:te,userResults:l,onSelect:j,onStartNew:k,selectedId:t,searchQuery:o,onSearchChange:s,onlineUsers:i}),e[46]=te,e[47]=j,e[48]=k,e[49]=t,e[50]=o,e[51]=i,e[52]=l,e[53]=ae):ae=e[53];let oe;e[54]!==re||e[55]!==ae?(oe=(0,J.jsxs)(`div`,{className:re,children:[ie,ae]}),e[54]=re,e[55]=ae,e[56]=oe):oe=e[56];let se;e[57]!==ne||e[58]!==z||e[59]!==U||e[60]!==n||e[61]!==G||e[62]!==b||e[63]!==p||e[64]!==m?(se=b?(0,J.jsx)(Ki,{conversation:b,messages:U,onBack:()=>n(`/messages`),onSendMessage:p,onTyping:e=>m(b.id,e),isLoading:z,isTyping:ne,isOnline:G}):(0,J.jsxs)(`div`,{className:`hidden md:flex flex-1 items-center justify-center text-zinc-500 flex-col gap-4`,children:[(0,J.jsx)(`div`,{className:`bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full`,children:(0,J.jsx)(Ue,{size:48,className:`text-zinc-300`})}),(0,J.jsxs)(`div`,{className:`text-center`,children:[(0,J.jsx)(`h3`,{className:`text-xl font-bold text-zinc-900 dark:text-white`,children:`Select a message`}),(0,J.jsx)(`p`,{children:`Choose from your existing conversations or start a new one.`})]})]}),e[57]=ne,e[58]=z,e[59]=U,e[60]=n,e[61]=G,e[62]=b,e[63]=p,e[64]=m,e[65]=se):se=e[65];let ce;return e[66]!==oe||e[67]!==se?(ce=(0,J.jsxs)(`div`,{className:`flex h-screen bg-white dark:bg-black overflow-hidden md:rounded-xl md:border border-zinc-100 dark:border-zinc-800`,children:[oe,se]}),e[66]=oe,e[67]=se,e[68]=ce):ce=e[68],ce};function Yi(e){return e.user?.id}var Xi=r(),Zi=()=>{let e=(0,Xi.c)(39),{currentUser:t}=Y(),n=y(),r=t?.id,i;e[0]===r?i=e[1]:(i=[`notifications`,r],e[0]=r,e[1]=i);let a;e[2]===t?.id?a=e[3]:(a=()=>St(t?.id),e[2]=t?.id,e[3]=a);let o=!!t?.id,s;e[4]!==i||e[5]!==a||e[6]!==o?(s={queryKey:i,queryFn:a,enabled:o},e[4]=i,e[5]=a,e[6]=o,e[7]=s):s=e[7];let{data:c,isLoading:l}=M(s),u;e[8]===c?u=e[9]:(u=c===void 0?[]:c,e[8]=c,e[9]=u);let d=u,f;e[10]!==t||e[11]!==n?(f=()=>{if(!t?.id)return;let e=q.channel(`user_notifications:${t.id}`).on(`postgres_changes`,{event:`INSERT`,schema:`public`,table:`notifications`,filter:`recipient_id=eq.${t.id}`},()=>{n.invalidateQueries({queryKey:[`notifications`,t.id]})}).subscribe();return()=>q.removeChannel(e)},e[10]=t,e[11]=n,e[12]=f):f=e[12];let p=t?.id,m;e[13]!==n||e[14]!==p?(m=[p,n],e[13]=n,e[14]=p,e[15]=m):m=e[15],(0,K.useEffect)(f,m);let h;e[16]===t?h=e[17]:(h=()=>Ct(t.id),e[16]=t,e[17]=h);let g;e[18]!==t||e[19]!==n?(g=()=>{n.invalidateQueries({queryKey:[`notifications`,t.id]})},e[18]=t,e[19]=n,e[20]=g):g=e[20];let _;e[21]!==h||e[22]!==g?(_={mutationFn:h,onSuccess:g},e[21]=h,e[22]=g,e[23]=_):_=e[23];let v=O(_),b;e[24]!==t?.id||e[25]!==v||e[26]!==d?(b=()=>{t?.id&&d.some(Qi)&&v.mutate()},e[24]=t?.id,e[25]=v,e[26]=d,e[27]=b):b=e[27];let x=t?.id,S;if(e[28]!==v||e[29]!==d||e[30]!==x?(S=[x,d,v],e[28]=v,e[29]=d,e[30]=x,e[31]=S):S=e[31],(0,K.useEffect)(b,S),l){let t;return e[32]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,J.jsx)(`div`,{className:`flex items-center justify-center min-h-[400px]`,children:(0,J.jsx)(je,{size:32,className:`animate-spin text-violet-500`})}),e[32]=t):t=e[32],t}if(!t){let t;return e[33]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,J.jsxs)(`div`,{className:`flex flex-col items-center justify-center min-h-[400px] gap-4 p-8 text-center`,children:[(0,J.jsx)(`div`,{className:`bg-zinc-100 dark:bg-zinc-900 p-4 rounded-full`,children:(0,J.jsx)(D,{size:40,className:`text-zinc-400`})}),(0,J.jsx)(`h3`,{className:`text-xl font-bold dark:text-white`,children:`Sign in to see notifications`}),(0,J.jsx)(`p`,{className:`text-zinc-500 max-w-xs`,children:`Join the conversation and keep track of who's engaging with your content.`})]}),e[33]=t):t=e[33],t}let C=$i,w;e[34]===Symbol.for(`react.memo_cache_sentinel`)?(w=(0,J.jsx)(`div`,{className:`p-4 border-b border-zinc-100 dark:border-zinc-800 sticky top-0 bg-white/80 dark:bg-black/80 backdrop-blur-md z-10`,children:(0,J.jsx)(`h2`,{className:`text-xl font-bold dark:text-white`,children:`Notifications`})}),e[34]=w):w=e[34];let T;e[35]===d?T=e[36]:(T=d.length>0?d.map(e=>(0,J.jsxs)(`div`,{className:`p-4 border-b border-zinc-100 dark:border-zinc-800 flex items-start gap-4 hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors cursor-pointer ${e.is_read?``:`bg-violet-50/30 dark:bg-violet-500/5`}`,children:[(0,J.jsx)(`div`,{className:`shrink-0 pt-1`,children:C(e.type)}),(0,J.jsxs)(`div`,{className:`flex-1 min-w-0`,children:[(0,J.jsxs)(`div`,{className:`flex items-center gap-3 mb-1`,children:[(0,J.jsxs)(Z,{className:`size-8`,children:[(0,J.jsx)(Q,{src:e.avatar}),(0,J.jsx)($,{children:e.user?.[0]?.toUpperCase()})]}),(0,J.jsxs)(`div`,{className:`flex-1 flex justify-between items-center`,children:[(0,J.jsxs)(`span`,{className:`font-bold text-sm dark:text-white truncate`,children:[`@`,e.user]}),(0,J.jsx)(`span`,{className:`text-zinc-500 text-xs whitespace-nowrap`,children:En(e.created_at)})]})]}),(0,J.jsxs)(`p`,{className:`text-zinc-600 dark:text-zinc-400 text-[15px] ml-11`,children:[e.type===`like`&&`liked your post`,e.type===`follow`&&`followed you`,e.type===`mention`&&`mentioned you in a post`,e.type===`comment`&&`commented on your post`,e.type===`repost`&&`reposted your post`]})]}),!e.is_read&&(0,J.jsx)(`div`,{className:`size-2 rounded-full bg-violet-500 mt-2 shrink-0 shadow-[0_0_8px_rgba(139,92,246,0.5)]`})]},e.id)):(0,J.jsx)(`div`,{className:`p-16 text-center text-zinc-500`,children:(0,J.jsx)(`p`,{className:`font-medium`,children:`No notifications yet.`})}),e[35]=d,e[36]=T);let E;return e[37]===T?E=e[38]:(E=(0,J.jsxs)(`div`,{className:`border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm`,children:[w,T]}),e[37]=T,e[38]=E),E};function Qi(e){return!e.is_read}function $i(e){switch(e){case`like`:return(0,J.jsx)(de,{size:20,className:`text-rose-500 fill-rose-500`});case`follow`:return(0,J.jsx)(v,{size:20,className:`text-blue-500`});case`mention`:return(0,J.jsx)(d,{size:20,className:`text-emerald-500`});case`comment`:return(0,J.jsx)(N,{size:20,className:`text-violet-500`});case`repost`:return(0,J.jsx)(Se,{size:20,className:`text-amber-500`});default:return(0,J.jsx)(d,{size:20,className:`text-zinc-500`})}}const ea=(e,t,n)=>{let r=e?.id,[i,a]=(0,K.useState)(!1),[o,s]=(0,K.useState)({followers:e?.followers||e?.follower_count||0,following:e?.following||e?.following_count||0}),[c,l]=(0,K.useState)(!1);return(0,K.useEffect)(()=>{e&&(s({followers:e.followers||e.follower_count||0,following:e.following||e.following_count||0}),r&&wn(r)&&(It(r).then(e=>{e&&s({followers:e.followers,following:e.following})}).catch(()=>{}),t&&wn(t)&&Ft(t,r).then(a).catch(()=>a(!1))))},[e,r,t]),{isFollowing:i,stats:o,loading:c,handleFollow:async()=>{if(!t)return n(`Please login to follow!`,`error`);if(t===r)return n(`You cannot follow yourself!`,`error`);if(!r||!wn(r)||!wn(t)){let e=!i;a(e),s(t=>{let n=typeof t.followers==`string`?parseInt(t.followers.replace(/,/g,``)):t.followers||0;return{...t,followers:e?n+1:Math.max(0,n-1)}}),n(e?`Followed`:`Unfollowed`);return}l(!0);try{let e=await Pt(t,r);a(e),s(t=>({...t,followers:e?(t.followers||0)+1:Math.max(0,(t.followers||0)-1)})),n(e?`Followed`:`Unfollowed`)}catch(e){console.error(`Failed to toggle follow:`,e),n(`Failed to update follow status`,`error`)}finally{l(!1)}},setStats:s}};var ta=({profile:e,currentUser:t,isCurrentUser:n,onEditProfile:r,showToast:i,isCommunity:a})=>{let{isFollowing:o,stats:s,loading:c,handleFollow:l}=ea(e,t?.id,i),u=C(),[d,f]=(0,K.useState)(!1);return(0,J.jsxs)(`div`,{className:`flex flex-col`,children:[(0,J.jsxs)(`div`,{className:`relative h-32 sm:h-48 w-full bg-zinc-200 dark:bg-zinc-800`,children:[e.cover&&(0,J.jsx)(`img`,{src:e.cover,className:`h-full w-full object-cover transition-opacity duration-500`,alt:`Cover`}),(0,J.jsx)(`div`,{className:`absolute -bottom-12 sm:-bottom-16 left-4 sm:left-6`,children:(0,J.jsx)(`div`,{className:`p-1 bg-white dark:bg-black rounded-full overflow-hidden shadow-xl ring-4 ring-white dark:ring-black relative`,children:(0,J.jsxs)(Z,{className:`size-24 sm:size-32`,children:[(0,J.jsx)(Q,{src:e.avatar,alt:e.handle,className:`object-cover`}),(0,J.jsx)($,{className:`text-4xl font-bold`,children:e.handle?.[0]?.toUpperCase()})]})})})]}),(0,J.jsxs)(`div`,{className:`flex flex-col p-4 sm:p-6 pt-16 sm:pt-20 space-y-4`,children:[(0,J.jsxs)(`div`,{className:`flex justify-between items-start`,children:[(0,J.jsx)(`div`,{className:`flex-1 min-w-0 pr-4`}),(0,J.jsx)(`div`,{className:`flex gap-2 shrink-0`,children:n?(0,J.jsx)(tr,{variant:`secondary`,onClick:()=>r(e),className:`text-sm px-5`,children:`Edit profile`}):(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(`button`,{onClick:async()=>{if(!t){i(`Please sign in to message users`);return}f(!0);try{u(`/messages/${await vt(t.id,e.id)}`)}catch(e){console.error(`Failed to start conversation:`,e),i(`Failed to open chat`)}finally{f(!1)}},disabled:d,className:`rounded-full p-2 border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 dark:border-zinc-800 transition-colors disabled:opacity-50`,children:d?(0,J.jsx)(je,{size:20,className:`animate-spin`}):(0,J.jsx)(Ue,{size:20})}),(0,J.jsx)(`button`,{className:`rounded-full p-2 border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 dark:border-zinc-800 transition-colors`,children:(0,J.jsx)(Ye,{size:20})}),(0,J.jsx)(tr,{variant:o?`secondary`:`primary`,onClick:l,className:`text-sm px-6 min-w-[100px]`,disabled:c,children:c?(0,J.jsx)(je,{size:16,className:`animate-spin mx-auto`}):o?`Following`:`Follow`}),(0,J.jsx)(`button`,{className:`rounded-full p-2 hover:bg-zinc-100 text-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-800 transition-colors`,children:(0,J.jsx)(ge,{size:20})})]})})]}),(0,J.jsxs)(`div`,{className:`space-y-0.5`,children:[(0,J.jsx)(`div`,{className:`flex items-center gap-1.5`,children:(0,J.jsxs)(`h3`,{className:`text-xl sm:text-2xl font-extrabold truncate dark:text-white flex items-center gap-1`,children:[e.name,e.verified&&(0,J.jsx)(Ar,{})]})}),!a&&(0,J.jsx)(`div`,{className:`flex items-center space-x-3`,children:(0,J.jsxs)(`span`,{className:`text-zinc-500 font-medium text-sm px-1.5 py-0.5 -ml-1.5 rounded-md dark:text-zinc-400`,children:[`@`,e.handle]})})]}),(0,J.jsx)(`div`,{className:`whitespace-pre-line text-zinc-900 dark:text-zinc-100 leading-relaxed text-sm sm:text-[15px]`,children:e.bio}),(e.website||e.location)&&(0,J.jsxs)(`div`,{className:`flex flex-wrap gap-x-5 gap-y-2 text-sm pt-1`,children:[e.location&&(0,J.jsxs)(`div`,{className:`flex items-center gap-2 text-zinc-600 dark:text-zinc-400`,children:[(0,J.jsx)(me,{size:14}),(0,J.jsx)(`span`,{children:e.location})]}),e.website&&(0,J.jsxs)(`div`,{className:`flex items-center gap-2 text-zinc-600 dark:text-zinc-400`,children:[(0,J.jsx)(ze,{size:14}),(0,J.jsx)(`a`,{href:`https://${e.website}`,target:`_blank`,rel:`noreferrer`,className:`text-violet-600 hover:underline font-semibold text-black dark:text-white`,children:e.website})]})]}),(0,J.jsx)(`div`,{className:`flex gap-4 sm:gap-6 text-sm pt-2`,children:a?(0,J.jsxs)(`button`,{className:`flex gap-x-1 hover:underline group`,children:[(0,J.jsx)(`span`,{className:`font-bold text-zinc-900 dark:text-white group-hover:text-violet-600`,children:e.members}),(0,J.jsx)(`span`,{className:`text-zinc-500 dark:text-zinc-400`,children:`Members`})]}):(0,J.jsxs)(J.Fragment,{children:[(0,J.jsxs)(`button`,{className:`flex gap-x-1 hover:underline group`,children:[(0,J.jsx)(`span`,{className:`font-bold text-zinc-900 dark:text-white group-hover:text-violet-600`,children:s.following}),(0,J.jsx)(`span`,{className:`text-zinc-500 dark:text-zinc-400`,children:`Following`})]}),(0,J.jsxs)(`button`,{className:`flex gap-x-1 hover:underline group`,children:[(0,J.jsx)(`span`,{className:`font-bold text-zinc-900 dark:text-white group-hover:text-violet-600`,children:s.followers}),(0,J.jsx)(`span`,{className:`text-zinc-500 dark:text-zinc-400`,children:`Followers`})]})]})})]})]})},na=r(),ra=e=>{let t=(0,na.c)(67),{onEditProfile:n}=e,{handle:r}=Le(),i=C(),{profiles:a,currentUser:o,getProfileByHandle:s}=Y(),{getUserPosts:c}=sn(),{addToast:u}=nn(),[d,f]=(0,K.useState)(`feed`),[p,m]=(0,K.useState)(!a[r]),[h,g]=(0,K.useState)(a[r]),_,v;t[0]!==s||t[1]!==r||t[2]!==a?(_=()=>{(async()=>{a[r]?g(a[r]):(m(!0),g(await s(r)),m(!1))})()},v=[r,a,s],t[0]=s,t[1]=r,t[2]=a,t[3]=_,t[4]=v):(_=t[3],v=t[4]),(0,K.useEffect)(_,v);let y;t[5]!==d||t[6]!==c||t[7]!==r?(y=c(r,d),t[5]=d,t[6]=c,t[7]=r,t[8]=y):y=t[8];let b=y,x;t[9]===i?x=t[10]:(x=e=>{i(`/post/${e}`)},t[9]=i,t[10]=x);let S=x,w;t[11]!==r||t[12]!==i?(w=e=>{e!==r&&i(`/u/${e}`)},t[11]=r,t[12]=i,t[13]=w):w=t[13];let T=w;if(p){let e;return t[14]===Symbol.for(`react.memo_cache_sentinel`)?(e=(0,J.jsx)(`div`,{className:`flex items-center justify-center min-h-screen`,children:(0,J.jsx)(je,{size:40,className:`animate-spin text-violet-500`})}),t[14]=e):e=t[14],e}let E;t[15]!==r||t[16]!==h?(E=h||{id:null,name:r,handle:r,avatar:`https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm`,cover:`https://systemadminbd.com/uploads/675346dd55e0c7.43939630.png`,bio:`Profile not found`,following:`0`,followers:`0`},t[15]=r,t[16]=h,t[17]=E):E=t[17];let D=E,O;t[18]!==u||t[19]!==o||t[20]!==S||t[21]!==T||t[22]!==b?(O=()=>b.length>0?b.map(e=>(0,J.jsx)(ti,{currentUser:o,showToast:u,...e,onClick:()=>S(e.id),onUserClick:T},e.id)):(0,J.jsxs)(`div`,{className:`p-16 text-center text-zinc-500 flex flex-col items-center gap-4`,children:[(0,J.jsx)(`div`,{className:`bg-zinc-50 dark:bg-zinc-900 p-4 rounded-full`,children:(0,J.jsx)(ee,{size:32,className:`text-zinc-300`})}),(0,J.jsx)(`p`,{className:`font-medium`,children:`No posts found`})]}),t[18]=u,t[19]=o,t[20]=S,t[21]=T,t[22]=b,t[23]=O):O=t[23];let k=O,A;t[24]===i?A=t[25]:(A=()=>i(-1),t[24]=i,t[25]=A);let j;t[26]===Symbol.for(`react.memo_cache_sentinel`)?(j=(0,J.jsx)(l,{size:22}),t[26]=j):j=t[26];let M;t[27]===A?M=t[28]:(M=(0,J.jsx)(`button`,{onClick:A,className:`p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors`,children:j}),t[27]=A,t[28]=M);let N;t[29]===D.name?N=t[30]:(N=(0,J.jsx)(`h5`,{className:`text-lg font-bold dark:text-white leading-none`,children:D.name}),t[29]=D.name,t[30]=N);let P=b?b.length:0,F;t[31]===P?F=t[32]:(F=(0,J.jsxs)(`span`,{className:`text-xs text-zinc-500 mt-0.5`,children:[P,` Posts`]}),t[31]=P,t[32]=F);let I;t[33]!==N||t[34]!==F?(I=(0,J.jsxs)(`div`,{className:`flex flex-col`,children:[N,F]}),t[33]=N,t[34]=F,t[35]=I):I=t[35];let L;t[36]!==M||t[37]!==I?(L=(0,J.jsx)(`div`,{className:`sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3 md:hidden`,children:(0,J.jsxs)(`div`,{className:`flex items-center gap-x-4`,children:[M,I]})}),t[36]=M,t[37]=I,t[38]=L):L=t[38];let R=o?.handle===D.handle,z;t[39]!==u||t[40]!==o||t[41]!==D||t[42]!==n||t[43]!==R?(z=(0,J.jsx)(ta,{profile:D,currentUser:o,isCurrentUser:R,onEditProfile:n,showToast:u}),t[39]=u,t[40]=o,t[41]=D,t[42]=n,t[43]=R,t[44]=z):z=t[44];let B;t[45]===Symbol.for(`react.memo_cache_sentinel`)?(B=(0,J.jsx)(`div`,{className:`sticky top-[60px] md:top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-10 border-b border-zinc-100 dark:border-zinc-800`,children:(0,J.jsx)(pi,{className:`w-full h-auto bg-transparent p-0 rounded-none justify-start px-2`,children:[`feed`,`replies`,`media`].map(ia)})}),t[45]=B):B=t[45];let V;t[46]===k?V=t[47]:(V=k(),t[46]=k,t[47]=V);let H;t[48]===V?H=t[49]:(H=(0,J.jsx)(hi,{value:`feed`,className:`m-0 border-none`,children:V}),t[48]=V,t[49]=H);let U;t[50]===k?U=t[51]:(U=k(),t[50]=k,t[51]=U);let te;t[52]===U?te=t[53]:(te=(0,J.jsx)(hi,{value:`replies`,className:`m-0 border-none`,children:U}),t[52]=U,t[53]=te);let ne;t[54]===k?ne=t[55]:(ne=k(),t[54]=k,t[55]=ne);let W;t[56]===ne?W=t[57]:(W=(0,J.jsx)(hi,{value:`media`,className:`m-0 border-none`,children:ne}),t[56]=ne,t[57]=W);let G;t[58]!==d||t[59]!==H||t[60]!==te||t[61]!==W?(G=(0,J.jsxs)(fi,{value:d,onValueChange:f,className:`w-full`,children:[B,H,te,W]}),t[58]=d,t[59]=H,t[60]=te,t[61]=W,t[62]=G):G=t[62];let re;return t[63]!==L||t[64]!==z||t[65]!==G?(re=(0,J.jsx)(`div`,{className:`border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen`,children:(0,J.jsxs)(`div`,{className:`border-y md:border-b-0 border-zinc-100 dark:border-zinc-800`,children:[L,z,G]})}),t[63]=L,t[64]=z,t[65]=G,t[66]=re):re=t[66],re};function ia(e){return(0,J.jsx)(mi,{value:e,className:`flex-1 py-4 text-sm font-bold capitalize rounded-none border-b-2 data-[state=active]:border-black dark:data-[state=active]:border-white data-[state=active]:text-black dark:data-[state=active]:text-white text-zinc-500 transition-all hover:bg-zinc-50 dark:hover:bg-zinc-900`,children:e===`feed`?`Posts`:e},e)}var aa=r(),oa=()=>{let e=(0,aa.c)(32),{id:t}=Le(),n=C(),{currentUser:r}=Y(),{addToast:i}=nn(),a,o;e[0]===t?(a=e[1],o=e[2]):(a=[`post`,t],o=async()=>{if(!wn(t))throw Error(`Invalid post ID`);return ht(t)},e[0]=t,e[1]=a,e[2]=o);let s=!!t,c;e[3]!==a||e[4]!==o||e[5]!==s?(c={queryKey:a,queryFn:o,enabled:s,retry:!1},e[3]=a,e[4]=o,e[5]=s,e[6]=c):c=e[6];let{data:u,isLoading:d,isError:f}=M(c);if(d){let t;return e[7]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,J.jsx)(`div`,{className:`border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen`,children:(0,J.jsx)(ri,{})}),e[7]=t):t=e[7],t}if(f||!u){let t;e[8]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,J.jsx)(`p`,{className:`text-zinc-500`,children:`Post not found`}),e[8]=t):t=e[8];let r;return e[9]===n?r=e[10]:(r=(0,J.jsxs)(`div`,{className:`p-10 text-center`,children:[t,(0,J.jsx)(`button`,{onClick:()=>n(-1),className:`text-violet-500 mt-4 underline font-bold`,children:`Go back`})]}),e[9]=n,e[10]=r),r}let p;e[11]===n?p=e[12]:(p=()=>n(-1),e[11]=n,e[12]=p);let m;e[13]===Symbol.for(`react.memo_cache_sentinel`)?(m=(0,J.jsx)(l,{size:20,strokeWidth:2.5}),e[13]=m):m=e[13];let h;e[14]===p?h=e[15]:(h=(0,J.jsx)(`button`,{onClick:p,className:`p-2 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors`,children:m}),e[14]=p,e[15]=h);let g;e[16]===Symbol.for(`react.memo_cache_sentinel`)?(g=(0,J.jsx)(`h5`,{className:`text-xl font-bold dark:text-white`,children:`Post`}),e[16]=g):g=e[16];let _;e[17]===h?_=e[18]:(_=(0,J.jsx)(`div`,{className:`sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3`,children:(0,J.jsxs)(`div`,{className:`flex items-center gap-x-4`,children:[h,g]})}),e[17]=h,e[18]=_);let v;e[19]===u.comments?v=e[20]:(v=u.comments||[],e[19]=u.comments,e[20]=v);let y;e[21]===n?y=e[22]:(y=e=>n(`/u/${e}`),e[21]=n,e[22]=y);let b;e[23]!==i||e[24]!==r||e[25]!==u||e[26]!==y||e[27]!==v?(b=(0,J.jsx)(ti,{...u,isDetail:!0,currentUser:r,initialComments:v,showToast:i,onUserClick:y}),e[23]=i,e[24]=r,e[25]=u,e[26]=y,e[27]=v,e[28]=b):b=e[28];let x;return e[29]!==b||e[30]!==_?(x=(0,J.jsx)(`div`,{className:`border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm mb-20 animate-in slide-in-from-right-5 duration-300`,children:(0,J.jsxs)(`div`,{className:`border-b border-zinc-100 dark:border-zinc-800`,children:[_,b]})}),e[29]=b,e[30]=_,e[31]=x):x=e[31],x},sa=r();function ca(){let e=(0,sa.c)(49),t=h(),{currentUser:n,authMode:r,setAuthMode:i}=Y(),{darkMode:a}=Yt(),{isOpen:o,images:s,currentIndex:c,closeLightbox:l,setIndex:u}=dn(),[d,f]=(0,K.useState)(!1),[p,m]=(0,K.useState)(!1),[g,_]=(0,K.useState)(!1),v;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(v={},e[0]=v):v=e[0];let[y,b]=(0,K.useState)(v),[x,C]=(0,K.useState)(null);if(r){let t=a?`dark`:``,n;e[1]===i?n=e[2]:(n=()=>i(null),e[1]=i,e[2]=n);let o;e[3]!==r||e[4]!==i?(o=()=>i(r===`login`?`signup`:`login`),e[3]=r,e[4]=i,e[5]=o):o=e[5];let s;e[6]!==r||e[7]!==n||e[8]!==o?(s=(0,J.jsx)(`div`,{className:`min-h-screen bg-white dark:bg-black flex items-center justify-center p-4`,children:(0,J.jsx)(br,{children:(0,J.jsx)(vr,{type:r,onComplete:n,onSwitch:o})})}),e[6]=r,e[7]=n,e[8]=o,e[9]=s):s=e[9];let c;return e[10]!==t||e[11]!==s?(c=(0,J.jsx)(`div`,{className:t,children:s}),e[10]=t,e[11]=s,e[12]=c):c=e[12],c}let w;e[13]===Symbol.for(`react.memo_cache_sentinel`)?(w=(0,J.jsx)(Cn,{}),e[13]=w):w=e[13];let T;e[14]===Symbol.for(`react.memo_cache_sentinel`)?(T=(0,J.jsx)(Hn,{}),e[14]=T):T=e[14];let E;e[15]===Symbol.for(`react.memo_cache_sentinel`)?(E=(0,J.jsx)(V,{path:`/`,element:(0,J.jsx)(br,{children:(0,J.jsx)(ai,{onStoryClick:C,onAddStory:()=>_(!0)})})}),e[15]=E):E=e[15];let D;e[16]===Symbol.for(`react.memo_cache_sentinel`)?(D=(0,J.jsx)(V,{path:`/home`,element:(0,J.jsx)(U,{to:`/`,replace:!0})}),e[16]=D):D=e[16];let O;e[17]===Symbol.for(`react.memo_cache_sentinel`)?(O=(0,J.jsx)(V,{path:`/explore`,element:(0,J.jsx)(br,{children:(0,J.jsx)(_i,{})})}),e[17]=O):O=e[17];let k;e[18]===Symbol.for(`react.memo_cache_sentinel`)?(k=(0,J.jsx)(V,{path:`/reels`,element:(0,J.jsx)(br,{children:(0,J.jsx)(Ei,{})})}),e[18]=k):k=e[18];let A;e[19]===Symbol.for(`react.memo_cache_sentinel`)?(A=(0,J.jsx)(V,{path:`/messages`,element:(0,J.jsx)(br,{children:(0,J.jsx)(Ji,{})})}),e[19]=A):A=e[19];let j;e[20]===Symbol.for(`react.memo_cache_sentinel`)?(j=(0,J.jsx)(V,{path:`/messages/:id`,element:(0,J.jsx)(br,{children:(0,J.jsx)(Ji,{})})}),e[20]=j):j=e[20];let M;e[21]===Symbol.for(`react.memo_cache_sentinel`)?(M=(0,J.jsx)(V,{path:`/notifications`,element:(0,J.jsx)(br,{children:(0,J.jsx)(Zi,{})})}),e[21]=M):M=e[21];let N;e[22]===Symbol.for(`react.memo_cache_sentinel`)?(N=(0,J.jsx)(V,{path:`/post/:id`,element:(0,J.jsx)(br,{children:(0,J.jsx)(oa,{})})}),e[22]=N):N=e[22];let P;e[23]===Symbol.for(`react.memo_cache_sentinel`)?(P=(0,J.jsx)(V,{path:`/u/:handle`,element:(0,J.jsx)(br,{children:(0,J.jsx)(ra,{onEditProfile:e=>{b(e),m(!0)}})})}),e[23]=P):P=e[23];let F;e[24]===Symbol.for(`react.memo_cache_sentinel`)?(F=(0,J.jsxs)(V,{element:T,children:[E,D,O,k,A,j,M,N,P,(0,J.jsx)(V,{path:`*`,element:(0,J.jsx)(U,{to:`/explore`})})]}),e[24]=F):F=e[24];let I;e[25]===t?I=e[26]:(I=(0,J.jsx)(Ce,{mode:`wait`,children:(0,J.jsx)(te,{location:t,children:F},t.pathname)}),e[25]=t,e[26]=I);let L;e[27]!==y||e[28]!==p||e[29]!==d||e[30]!==g?(L=(0,J.jsx)(dr,{isPostModalOpen:d,setIsPostModalOpen:f,isEditProfileOpen:p,setIsEditProfileOpen:m,isStoryModalOpen:g,setIsStoryModalOpen:_,editProfileData:y,setEditProfileData:b}),e[27]=y,e[28]=p,e[29]=d,e[30]=g,e[31]=L):L=e[31];let R;e[32]===x?R=e[33]:(R=x&&(0,J.jsx)(pr,{story:x,onClose:()=>C(null)}),e[32]=x,e[33]=R);let z;e[34]!==l||e[35]!==c||e[36]!==s||e[37]!==o||e[38]!==u?(z=o&&(0,J.jsx)(hr,{images:s,currentIndex:c,onClose:l,onNavigate:u}),e[34]=l,e[35]=c,e[36]=s,e[37]=o,e[38]=u,e[39]=z):z=e[39];let B;e[40]!==n||e[41]!==t.pathname?(B=n&&t.pathname===`/`&&(0,J.jsx)(`button`,{onClick:()=>f(!0),className:`fixed bottom-20 right-5 md:bottom-10 md:right-10 z-50 bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 size-12 md:size-16 rounded-full flex items-center justify-center shadow-2xl hover:scale-110 active:scale-90 transition-all cursor-pointer group`,title:`Create Post`,children:(0,J.jsx)(S,{size:28,className:`md:w-8 md:h-8 group-hover:rotate-90 transition-transform duration-300`})}),e[40]=n,e[41]=t.pathname,e[42]=B):B=e[42];let H;return e[43]!==I||e[44]!==L||e[45]!==R||e[46]!==z||e[47]!==B?(H=(0,J.jsxs)(J.Fragment,{children:[w,I,L,R,z,B]}),e[43]=I,e[44]=L,e[45]=R,e[46]=z,e[47]=B,e[48]=H):H=e[48],H}var la=new nt;(0,st.createRoot)(document.getElementById(`root`)).render((0,J.jsx)(K.StrictMode,{children:(0,J.jsx)(p,{client:la,children:(0,J.jsx)(F,{children:(0,J.jsx)(Jt,{children:(0,J.jsx)(Vt,{children:(0,J.jsx)(Wt,{children:(0,J.jsx)(on,{children:(0,J.jsx)(tn,{children:(0,J.jsx)(un,{children:(0,J.jsx)(ca,{})})})})})})})})})}));
//# sourceMappingURL=index-BnmQr2QM.js.map