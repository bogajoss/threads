import{a as It}from"./rolldown-runtime-BaZ8gS7u.js";import{c as Z,d as Zt,l as es,n as ts,v as Lt,w as ss}from"./framework-3lkjbTvb.js";import{a as ls,r as is}from"./query-CZHA9T67.js";import{At as $e,Gn as as,Gt as rt,Hn as Be,Ht as ns,Jn as rs,Kn as os,Ln as Le,Lt as ot,On as cs,Qt as ct,Un as ds,Vt as dt,Yn as We,Zn as ms,_n as fs,an as He,cn as qe,fn as us,hn as xs,kn as hs,ln as mt,on as ps,pn as gs,rr as bs,sn as De,tn as vs,un as ft,vn as js,wn as ys,xn as Dt,zn as ut,zt as ks}from"./ui-libs-2x6F5Gjm.js";import{n as zs}from"./media-libs-C98UjHPF.js";import{$t as xt,Cn as ws,Ct as Ns,Dn as ht,Dt as Cs,Et as _s,Fn as Se,Ft as Ss,Jt as Qe,Ln as _e,N as $s,Nn as Ps,On as Ts,Qt as pt,R as Fs,Rn as Ge,Sn as Rs,St as Ms,Tn as At,Tt as ye,Un as gt,Wt as Ot,Xt as bt,Yt as vt,Zt as jt,_ as Es,_n as Is,_t as Ut,an as ze,at as Ls,cn as Ds,ct as As,dt as Ae,en as yt,et as Os,fn as Vt,ft as Us,g as kt,gn as zt,in as we,it as Vs,kn as Bs,ln as Ws,lt as Hs,nn as wt,nt as qs,pn as Qs,qt as Q,rn as Ne,sn as Bt,tn as Nt,tt as Wt,un as Ke,v as Gs,vn as Js,wn as Xs,z as Ks,zn as Me}from"./index-D50xAE86.js";import{a as Ys,i as Je,n as Ct,r as Ye}from"./VideoPlayer-C-ex1ZON.js";import{n as ke,t as Zs}from"./actionsheet-Dltj66fS.js";var el=Z(),z=It(ss(),1),t=It(es(),1),tl=l=>{const e=(0,el.c)(37),{isComment:s,liked:r,reposted:i,handleLike:a,handleRepost:o,handleCommentClick:n,handleShareClick:c,isDetail:x}=l;if(x!==void 0&&x){let w;e[0]!==a||e[1]!==r?(w=(0,t.jsx)(ve,{icon:Le,label:"Like",type:"like",onClick:a,active:r}),e[0]=a,e[1]=r,e[2]=w):w=e[2];let C;e[3]!==o||e[4]!==s||e[5]!==i?(C=!s&&(0,t.jsx)(ve,{icon:He,label:"Repost",type:"repost",onClick:o,active:i}),e[3]=o,e[4]=s,e[5]=i,e[6]=C):C=e[6];let S;e[7]!==n?(S=(0,t.jsx)(ve,{icon:Wt,label:"Comment",type:"comment",onClick:n}),e[7]=n,e[8]=S):S=e[8];let N;e[9]!==c||e[10]!==s?(N=!s&&(0,t.jsx)(ve,{icon:Ae,label:"Share",type:"share",onClick:c}),e[9]=c,e[10]=s,e[11]=N):N=e[11];let u;return e[12]!==w||e[13]!==C||e[14]!==S||e[15]!==N?(u=(0,t.jsxs)("div",{className:"mt-5 flex w-full items-center justify-around py-2",children:[w,C,S,N]}),e[12]=w,e[13]=C,e[14]=S,e[15]=N,e[16]=u):u=e[16],u}const b=`flex items-center gap-x-1.5 ${s?"mt-2":"mt-3.5"}`,f=s?16:18;let h;e[17]!==a||e[18]!==r||e[19]!==f?(h=(0,t.jsx)(ve,{icon:Le,size:f,type:"like",onClick:a,active:r}),e[17]=a,e[18]=r,e[19]=f,e[20]=h):h=e[20];const g=s?16:18;let d;e[21]!==n||e[22]!==g?(d=(0,t.jsx)(ve,{icon:Dt,size:g,type:"comment",onClick:n}),e[21]=n,e[22]=g,e[23]=d):d=e[23];const v=s?16:18;let p;e[24]!==o||e[25]!==i||e[26]!==v?(p=(0,t.jsx)(ve,{icon:He,size:v,type:"repost",onClick:o,active:i}),e[24]=o,e[25]=i,e[26]=v,e[27]=p):p=e[27];let m;e[28]!==c||e[29]!==s?(m=!s&&c&&(0,t.jsx)(ve,{icon:Ae,type:"share",onClick:c}),e[28]=c,e[29]=s,e[30]=m):m=e[30];let j;return e[31]!==b||e[32]!==h||e[33]!==d||e[34]!==p||e[35]!==m?(j=(0,t.jsxs)("div",{className:b,children:[h,d,p,m]}),e[31]=b,e[32]=h,e[33]=d,e[34]=p,e[35]=m,e[36]=j):j=e[36],j},_t=tl,sl=Z(),ll=l=>{const e=(0,sl.c)(38),{views:s,likes:r,comments:i,isDetail:a,isComment:o,onRepliesClick:n}=l,c=a===void 0?!1:a,x=o===void 0?!1:o;if(c){const p=s||0;let m;e[0]!==p?(m=(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:p}),e[0]=p,e[1]=m):m=e[1];let j;e[2]===Symbol.for("react.memo_cache_sentinel")?(j=(0,t.jsx)("span",{className:"opacity-70",children:"Views"}),e[2]=j):j=e[2];let w;e[3]!==m?(w=(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[m," ",j]}),e[3]=m,e[4]=w):w=e[4];const C=r||0;let S;e[5]!==C?(S=(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:C}),e[5]=C,e[6]=S):S=e[6];let N;e[7]===Symbol.for("react.memo_cache_sentinel")?(N=(0,t.jsx)("span",{className:"opacity-70",children:"Likes"}),e[7]=N):N=e[7];let u;e[8]!==S?(u=(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[S," ",N]}),e[8]=S,e[9]=u):u=e[9];const R=i||0;let E;e[10]!==R?(E=(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:R}),e[10]=R,e[11]=E):E=e[11];let T;e[12]===Symbol.for("react.memo_cache_sentinel")?(T=(0,t.jsx)("span",{className:"opacity-70",children:"Comments"}),e[12]=T):T=e[12];let y;e[13]!==E?(y=(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[E," ",T]}),e[13]=E,e[14]=y):y=e[14];let P;return e[15]!==u||e[16]!==y||e[17]!==w?(P=(0,t.jsxs)("div",{className:"mt-5 flex items-center gap-x-6 border-b border-zinc-100 pb-4 text-sm text-zinc-500 dark:border-zinc-800 dark:text-zinc-400",children:[w,u,y]}),e[15]=u,e[16]=y,e[17]=w,e[18]=P):P=e[18],P}if(i===0&&r===0&&(s===0||x))return null;const b=`mt-2 flex items-center gap-x-2 px-0.5 ${x?"text-[12px]":"text-[14px]"} font-medium text-zinc-500 dark:text-zinc-400`;let f;e[19]!==i||e[20]!==x||e[21]!==r||e[22]!==s?(f=s>0&&!x&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{className:"hover:underline",children:[s," ",s===1?"view":"views"]}),(i>0||r>0)&&(0,t.jsx)("span",{className:"opacity-50",children:"·"})]}),e[19]=i,e[20]=x,e[21]=r,e[22]=s,e[23]=f):f=e[23];let h;e[24]!==i||e[25]!==n?(h=i>0&&(0,t.jsxs)("button",{className:"hover:underline",onClick:p=>{p.stopPropagation(),n&&n(p)},children:[i," ",i===1?"reply":"replies"]}),e[24]=i,e[25]=n,e[26]=h):h=e[26];let g;e[27]!==i||e[28]!==r?(g=i>0&&r>0&&(0,t.jsx)("span",{className:"opacity-50",children:"·"}),e[27]=i,e[28]=r,e[29]=g):g=e[29];let d;e[30]!==r?(d=r>0&&(0,t.jsxs)("button",{className:"hover:underline",children:[r," ",r===1?"like":"likes"]}),e[30]=r,e[31]=d):d=e[31];let v;return e[32]!==b||e[33]!==f||e[34]!==h||e[35]!==g||e[36]!==d?(v=(0,t.jsxs)("div",{className:b,children:[f,h,g,d]}),e[32]=b,e[33]=f,e[34]=h,e[35]=g,e[36]=d,e[37]=v):v=e[37],v},St=ll,il=Z(),al=l=>{const e=(0,il.c)(53),{user:s,timeAgo:r,community:i,onUserClick:a,actionsMenu:o,isComment:n,isDetail:c,showAvatar:x,isPinned:b}=l,f=x===void 0?!1:x,h=b===void 0?!1:b,g=Lt();let d;e[0]!==a||e[1]!==s.handle?(d=D=>{D.stopPropagation(),a&&a(s.handle)},e[0]=a,e[1]=s.handle,e[2]=d):d=e[2];const v=d;let p;e[3]!==i||e[4]!==g?(p=D=>{D.stopPropagation(),i&&g(`/c/${i.handle}`)},e[3]=i,e[4]=g,e[5]=p):p=e[5];const m=p,j=`flex items-center justify-between ${c?"pb-5":"min-h-[40px] mb-2"}`;let w;e[6]!==v||e[7]!==n||e[8]!==c||e[9]!==f||e[10]!==s.avatar||e[11]!==s.handle?(w=f&&(0,t.jsx)("button",{className:"shrink-0",onClick:v,children:(0,t.jsxs)(Ne,{className:`${c?"size-12":n?"size-8":"size-10"} border-0 shadow-sm`,children:[(0,t.jsx)(ze,{src:s.avatar,alt:s.handle,className:"object-cover"}),(0,t.jsx)(we,{className:"text-xs",children:s.handle[0]?.toUpperCase()})]})}),e[6]=v,e[7]=n,e[8]=c,e[9]=f,e[10]=s.avatar,e[11]=s.handle,e[12]=w):w=e[12];const C=`flex shrink-0 items-center gap-1 font-bold text-zinc-900 hover:underline dark:text-white ${c?"text-base sm:text-lg":n?"text-[14px]":"text-[15px]"}`;let S;e[13]!==s.handle?(S=(0,t.jsx)("span",{className:"max-w-[150px] truncate sm:max-w-none",children:s.handle}),e[13]=s.handle,e[14]=S):S=e[14];let N;e[15]!==n||e[16]!==c||e[17]!==s.role?(N=s.role==="admin"&&(0,t.jsx)(Os,{size:c?28:n?22:24}),e[15]=n,e[16]=c,e[17]=s.role,e[18]=N):N=e[18];let u;e[19]!==n||e[20]!==c||e[21]!==s.isPro||e[22]!==s.verified?(u=s.verified?(0,t.jsx)(Us,{size:c?16:n?12:14}):s.isPro&&(0,t.jsx)(Hs,{size:c?16:n?12:14}),e[19]=n,e[20]=c,e[21]=s.isPro,e[22]=s.verified,e[23]=u):u=e[23];let R;e[24]!==v||e[25]!==u||e[26]!==C||e[27]!==S||e[28]!==N?(R=(0,t.jsxs)("button",{className:C,onClick:v,children:[S,N,u]}),e[24]=v,e[25]=u,e[26]=C,e[27]=S,e[28]=N,e[29]=R):R=e[29];let E;e[30]!==i||e[31]!==m||e[32]!==c?(E=i&&(0,t.jsxs)("div",{className:"flex min-w-0 items-center gap-1 text-zinc-500",children:[(0,t.jsx)(qs,{size:c?14:12,className:"shrink-0 text-zinc-400"}),(0,t.jsxs)("button",{className:`flex items-center gap-1 font-bold text-zinc-900 hover:underline dark:text-zinc-100 ${c?"text-[14px] sm:text-[15px]":"text-[13px]"}`,onClick:m,children:[(0,t.jsxs)(Ne,{className:"size-3.5 shrink-0 border border-zinc-200 bg-zinc-100 dark:border-zinc-700 dark:bg-zinc-800",children:[(0,t.jsx)(ze,{src:i.avatar,alt:i.name,className:"object-cover"}),(0,t.jsx)(we,{className:"text-[6px] font-bold text-zinc-500",children:i.name?.[0]?.toUpperCase()})]}),(0,t.jsx)("span",{className:"max-w-[150px] truncate sm:max-w-none",children:i.name})]})]}),e[30]=i,e[31]=m,e[32]=c,e[33]=E):E=e[33];let T;e[34]!==R||e[35]!==E?(T=(0,t.jsx)("div",{className:"flex min-w-0 flex-1 flex-col",children:(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-x-1.5 leading-none",children:(0,t.jsxs)("div",{className:"flex min-w-0 max-w-full items-center gap-1.5",children:[R,E]})})}),e[34]=R,e[35]=E,e[36]=T):T=e[36];let y;e[37]!==T||e[38]!==w?(y=(0,t.jsxs)("div",{className:"flex items-center gap-x-3.5 flex-1 min-w-0",children:[w,T]}),e[37]=T,e[38]=w,e[39]=y):y=e[39];let P;e[40]!==n||e[41]!==h?(P=h&&!n&&(0,t.jsx)("div",{className:"flex items-center justify-center p-1 opacity-80",children:(0,t.jsx)(qe,{size:14,className:"fill-zinc-400 text-zinc-400 dark:fill-zinc-500 dark:text-zinc-500"})}),e[40]=n,e[41]=h,e[42]=P):P=e[42];const _=r||"Recent";let M;e[43]!==_?(M=(0,t.jsx)("span",{className:"whitespace-nowrap text-[12px] text-zinc-500 dark:text-zinc-400",children:_}),e[43]=_,e[44]=M):M=e[44];let I;e[45]!==o||e[46]!==P||e[47]!==M?(I=(0,t.jsxs)("div",{className:"-mt-1 flex items-center gap-2.5",children:[P,M,o]}),e[45]=o,e[46]=P,e[47]=M,e[48]=I):I=e[48];let A;return e[49]!==y||e[50]!==I||e[51]!==j?(A=(0,t.jsxs)("div",{className:j,children:[y,I]}),e[49]=y,e[50]=I,e[51]=j,e[52]=A):A=e[52],A},$t=al,nl=Z(),rl=l=>{const e=(0,nl.c)(40),{content:s,isDetail:r,isEditing:i,editedContent:a,setEditedContent:o,onCancelEdit:n,onSaveEdit:c,isUpdating:x,contentClass:b}=l,[f,h]=(0,z.useState)(!1),g=typeof s=="string"&&gt(s);if(i&&o){let R;e[0]!==o?(R=D=>o(D.target.value),e[0]=o,e[1]=R):R=e[1];const E=`min-h-[100px] w-full rounded-xl border-zinc-200 bg-zinc-50 focus:ring-violet-500 dark:border-zinc-800 dark:bg-zinc-900 ${gt(a||"")?"font-bangla text-lg":"font-english"}`;let T;e[2]!==a||e[3]!==R||e[4]!==E?(T=(0,t.jsx)($s,{value:a,onChange:R,className:E,autoFocus:!0}),e[2]=a,e[3]=R,e[4]=E,e[5]=T):T=e[5];let y;e[6]!==n?(y=(0,t.jsx)("button",{onClick:n,className:"px-4 py-1.5 text-sm font-bold text-zinc-500 transition-colors hover:text-zinc-700 dark:hover:text-zinc-300",children:"Cancel"}),e[6]=n,e[7]=y):y=e[7];let P;e[8]!==s||e[9]!==a||e[10]!==x?(P=x||!a?.trim()||a===s,e[8]=s,e[9]=a,e[10]=x,e[11]=P):P=e[11];const _=x?"Saving...":"Save";let M;e[12]!==c||e[13]!==P||e[14]!==_?(M=(0,t.jsx)("button",{onClick:c,disabled:P,className:"rounded-full bg-violet-600 px-4 py-1.5 text-sm font-bold text-white transition-all hover:bg-violet-700 disabled:opacity-50 active:scale-95",children:_}),e[12]=c,e[13]=P,e[14]=_,e[15]=M):M=e[15];let I;e[16]!==y||e[17]!==M?(I=(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[y,M]}),e[16]=y,e[17]=M,e[18]=I):I=e[18];let A;return e[19]!==T||e[20]!==I?(A=(0,t.jsxs)("div",{className:"mt-2 flex flex-col gap-2",onClick:ol,children:[T,I]}),e[19]=T,e[20]=I,e[21]=A):A=e[21],A}const d=!r&&s.length>280;let v;e[22]!==s||e[23]!==f||e[24]!==d?(v=d&&!f?s.substring(0,280):s,e[22]=s,e[23]=f,e[24]=d,e[25]=v):v=e[25];const p=v,m=r?"text-lg leading-relaxed sm:text-xl sm:leading-8 mt-1":"text-[15px] leading-snug mt-0.5",j=g?"font-bangla text-[1.15em]":"font-english";let w;e[26]!==b||e[27]!==m||e[28]!==j?(w=_e("whitespace-pre-line break-words",m,j,b),e[26]=b,e[27]=m,e[28]=j,e[29]=w):w=e[29];let C;e[30]!==p?(C=(0,t.jsx)(Ye,{content:p}),e[30]=p,e[31]=C):C=e[31];const S=d&&!f&&"...";let N;e[32]!==f||e[33]!==d?(N=d&&(0,t.jsx)("button",{onClick:R=>{R.stopPropagation(),h(!f)},className:"ml-1 cursor-pointer font-bold text-rose-600 hover:underline dark:text-rose-400",children:f?"Show less":"See more"}),e[32]=f,e[33]=d,e[34]=N):N=e[34];let u;return e[35]!==w||e[36]!==C||e[37]!==S||e[38]!==N?(u=(0,t.jsxs)("div",{className:w,children:[C,S,N]}),e[35]=w,e[36]=C,e[37]=S,e[38]=N,e[39]=u):u=e[39],u},Pt=rl;function ol(l){return l.stopPropagation()}var cl=Z(),dl=l=>{const e=(0,cl.c)(28),{media:s,isEditing:r,editedMedia:i,setEditedMedia:a,newFiles:o,setNewFiles:n}=l;let c;e[0]!==i?(c=i===void 0?[]:i,e[0]=i,e[1]=c):c=e[1];const x=c;let b;e[2]!==o?(b=o===void 0?[]:o,e[2]=o,e[3]=b):b=e[3];const f=b,h=(0,z.useRef)(null);if(r&&a&&n){let d;if(e[4]!==x||e[5]!==a){let C;e[7]!==a?(C=(S,N)=>(0,t.jsxs)("div",{className:"group relative aspect-square overflow-hidden rounded-xl border border-zinc-200 dark:border-zinc-800",children:[S.type==="video"?(0,t.jsx)("div",{className:"flex size-full items-center justify-center bg-zinc-100 dark:bg-zinc-900",children:(0,t.jsx)(ds,{size:24,className:"text-zinc-400"})}):(0,t.jsx)("img",{src:S.url||S.src,className:"size-full object-cover",alt:""}),(0,t.jsx)("button",{onClick:u=>{u.stopPropagation(),a(R=>R.filter((E,T)=>T!==N))},className:"absolute right-1.5 top-1.5 flex size-7 items-center justify-center rounded-full bg-black/60 text-white transition-colors hover:bg-black",children:(0,t.jsx)($e,{size:16})})]},`old-${N}`),e[7]=a,e[8]=C):C=e[8],d=x.map(C),e[4]=x,e[5]=a,e[6]=d}else d=e[6];let v;if(e[9]!==f||e[10]!==n){let C;e[12]!==n?(C=(S,N)=>(0,t.jsxs)("div",{className:"group relative aspect-square overflow-hidden rounded-xl border-2 border-dashed border-violet-500 bg-violet-50/10",children:[S.type.startsWith("image/")?(0,t.jsx)("img",{src:URL.createObjectURL(S),className:"size-full object-cover",alt:""}):(0,t.jsx)("div",{className:"flex size-full items-center justify-center",children:(0,t.jsx)(cs,{size:24,className:"animate-spin text-violet-500"})}),(0,t.jsx)("button",{onClick:u=>{u.stopPropagation(),n(R=>R.filter((E,T)=>T!==N))},className:"absolute right-1.5 top-1.5 flex size-7 items-center justify-center rounded-full bg-black/60 text-white transition-colors hover:bg-black",children:(0,t.jsx)($e,{size:16})}),(0,t.jsx)("div",{className:"absolute bottom-1 left-1 rounded bg-violet-600 px-1 text-[8px] font-bold text-white",children:"NEW"})]},`new-${N}`),e[12]=n,e[13]=C):C=e[13],v=f.map(C),e[9]=f,e[10]=n,e[11]=v}else v=e[11];let p;e[14]!==x.length||e[15]!==f.length?(p=x.length+f.length<4&&(0,t.jsxs)("button",{onClick:C=>{C.stopPropagation(),h.current?.click()},className:"relative flex aspect-square flex-col items-center justify-center gap-1 rounded-xl border-2 border-dashed border-zinc-200 text-zinc-400 transition-all hover:border-violet-500 hover:bg-violet-50/5 hover:text-violet-500 dark:border-zinc-800",children:[(0,t.jsx)(ps,{size:20}),(0,t.jsx)("span",{className:"text-[10px] font-bold",children:"Add Media"})]}),e[14]=x.length,e[15]=f.length,e[16]=p):p=e[16];let m;e[17]!==d||e[18]!==v||e[19]!==p?(m=(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:[d,v,p]}),e[17]=d,e[18]=v,e[19]=p,e[20]=m):m=e[20];let j;e[21]!==n?(j=(0,t.jsx)("input",{type:"file",ref:h,onChange:C=>{if(C.target.files){const S=Array.from(C.target.files);n(N=>[...N,...S])}},multiple:!0,className:"hidden",accept:"image/*,video/*"}),e[21]=n,e[22]=j):j=e[22];let w;return e[23]!==m||e[24]!==j?(w=(0,t.jsxs)("div",{className:"mt-3 space-y-3",children:[m,j]}),e[23]=m,e[24]=j,e[25]=w):w=e[25],w}if(!s||s.length===0)return null;let g;return e[26]!==s?(g=(0,t.jsx)(El,{items:s}),e[26]=s,e[27]=g):g=e[27],g},Tt=dl,ml=Z(),fl=l=>{const e=(0,ml.c)(48),{icon:s,count:r,label:i,onClick:a,active:o,activeColorClass:n,size:c,type:x}=l,b=c===void 0?18:c,f=x===void 0?"default":x;let h,g,d,v,p,m,j;if(e[0]!==o||e[1]!==n||e[2]!==r||e[3]!==i||e[4]!==a||e[5]!==f){const I={like:{hoverBg:"group-hover:bg-rose-500/10",hoverText:"group-hover:text-rose-500",activeText:"text-rose-500",activeFill:"fill-rose-500"},repost:{hoverBg:"group-hover:bg-emerald-500/10",hoverText:"group-hover:text-emerald-500",activeText:"text-emerald-500",activeFill:"fill-emerald-500"},comment:{hoverBg:"group-hover:bg-sky-500/10",hoverText:"group-hover:text-sky-500",activeText:"text-sky-500",activeFill:"fill-sky-500"},share:{hoverBg:"group-hover:bg-violet-500/10",hoverText:"group-hover:text-violet-500",activeText:"text-violet-500",activeFill:"fill-violet-500"},default:{hoverBg:"group-hover:bg-zinc-500/10",hoverText:"group-hover:text-zinc-500",activeText:"text-zinc-900 dark:text-white",activeFill:"fill-current"}};g=I[f]||I.default;const A=n||g.activeText;h=Q.button,e[13]===Symbol.for("react.memo_cache_sentinel")?(v={scale:.85},e[13]=v):v=e[13],e[14]!==a?(p=D=>{D.stopPropagation(),a&&a(D)},e[14]=a,e[15]=p):p=e[15],m=`${i} ${r!==void 0?`(${r})`:""}`,j=_e("group -ml-2 flex items-center gap-x-0.5 rounded-xl px-2 py-1.5 text-[12px] font-bold transition-all sm:gap-x-1 sm:text-[13px]",o?A:"text-zinc-500",!o&&g.hoverText),d=_e("rounded-full p-2 transition-all duration-200",!o&&g.hoverBg),e[0]=o,e[1]=n,e[2]=r,e[3]=i,e[4]=a,e[5]=f,e[6]=h,e[7]=g,e[8]=d,e[9]=v,e[10]=p,e[11]=m,e[12]=j}else h=e[6],g=e[7],d=e[8],v=e[9],p=e[10],m=e[11],j=e[12];let w;e[16]!==o?(w=o?{scale:[1,1.4,1],rotate:[0,15,0]}:{scale:1},e[16]=o,e[17]=w):w=e[17];let C;e[18]===Symbol.for("react.memo_cache_sentinel")?(C={duration:.45,type:"spring",stiffness:300,damping:15},e[18]=C):C=e[18];const S=o?2.5:2,N=o&&g.activeFill;let u;e[19]!==N?(u=_e("transition-colors duration-200",N),e[19]=N,e[20]=u):u=e[20];let R;e[21]!==s||e[22]!==b||e[23]!==S||e[24]!==u?(R=(0,t.jsx)(s,{size:b,strokeWidth:S,className:u}),e[21]=s,e[22]=b,e[23]=S,e[24]=u,e[25]=R):R=e[25];let E;e[26]!==R||e[27]!==w?(E=(0,t.jsx)(Q.div,{animate:w,transition:C,children:R}),e[26]=R,e[27]=w,e[28]=E):E=e[28];let T;e[29]!==E||e[30]!==d?(T=(0,t.jsx)("div",{className:d,children:E}),e[29]=E,e[30]=d,e[31]=T):T=e[31];let y;e[32]!==i?(y=i&&(0,t.jsx)("span",{className:"hidden xs:inline",children:i}),e[32]=i,e[33]=y):y=e[33];let P;e[34]!==o||e[35]!==r?(P=r!=null&&(0,t.jsx)(Q.span,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},className:_e("transition-all",o?"font-black":"font-bold"),children:r||0},r),e[34]=o,e[35]=r,e[36]=P):P=e[36];let _;e[37]!==P?(_=(0,t.jsx)(Qe,{mode:"wait",children:P}),e[37]=P,e[38]=_):_=e[38];let M;return e[39]!==h||e[40]!==T||e[41]!==y||e[42]!==_||e[43]!==v||e[44]!==p||e[45]!==m||e[46]!==j?(M=(0,t.jsxs)(h,{whileTap:v,onClick:p,"aria-label":m,className:j,children:[T,y,_]}),e[39]=h,e[40]=T,e[41]=y,e[42]=_,e[43]=v,e[44]=p,e[45]=m,e[46]=j,e[47]=M):M=e[47],M},ve=fl,ul=Z(),xl=l=>{const e=(0,ul.c)(18),{poll:s,onVote:r}=l,i=s.options.reduce(hl,0),[a,o]=(0,z.useState)(null);let n;e[0]!==r||e[1]!==a?(n=d=>{a||(o(d),r&&r(d))},e[0]=r,e[1]=a,e[2]=n):n=e[2];const c=n;let x;if(e[3]!==c||e[4]!==s.options||e[5]!==i||e[6]!==a){let d;e[8]!==c||e[9]!==i||e[10]!==a?(d=(v,p)=>{const m=i>0?Math.round((v.votes+(a===v.id?1:0))/(i+(a?1:0))*100):0,j=a===v.id;return(0,t.jsxs)("div",{onClick:()=>c(v.id),className:`relative h-10 w-full overflow-hidden rounded-xl border cursor-pointer ${j?"border-violet-500 dark:border-violet-500":"border-zinc-200 dark:border-zinc-700"}`,children:[a&&(0,t.jsx)("div",{className:"absolute left-0 top-0 h-full bg-zinc-200 transition-all duration-500 dark:bg-zinc-800",style:{width:`${m}%`}}),(0,t.jsxs)("div",{className:"absolute inset-0 z-10 flex items-center justify-between px-4",children:[(0,t.jsxs)("span",{className:`text-sm font-medium ${j?"font-bold text-violet-600":"text-zinc-700 dark:text-zinc-200"}`,children:[v.text," ",j&&(0,t.jsx)(bs,{size:14,className:"mb-0.5 inline ml-1"})]}),a&&(0,t.jsxs)("span",{className:"text-sm font-bold text-zinc-900 dark:text-white",children:[m,"%"]})]})]},v.id||p)},e[8]=c,e[9]=i,e[10]=a,e[11]=d):d=e[11],x=s.options.map(d),e[3]=c,e[4]=s.options,e[5]=i,e[6]=a,e[7]=x}else x=e[7];const b=i+(a?1:0),f=a?"6 days left":"Click to vote";let h;e[12]!==b||e[13]!==f?(h=(0,t.jsxs)("div",{className:"pl-1 text-xs text-zinc-500 dark:text-zinc-400",children:[b," votes •"," ",f]}),e[12]=b,e[13]=f,e[14]=h):h=e[14];let g;return e[15]!==x||e[16]!==h?(g=(0,t.jsxs)("div",{className:"mt-3 space-y-2",children:[x,h]}),e[15]=x,e[16]=h,e[17]=g):g=e[17],g},Ft=xl;function hl(l,e){return l+e.votes}var pl=Z(),gl=l=>{const e=(0,pl.c)(25),{user:s,time:r,content:i}=l;let a;e[0]!==s.avatar||e[1]!==s.handle?(a=(0,t.jsx)(ze,{src:s.avatar,alt:s.handle}),e[0]=s.avatar,e[1]=s.handle,e[2]=a):a=e[2];let o;e[3]!==s.handle[0]?(o=s.handle[0]?.toUpperCase(),e[3]=s.handle[0],e[4]=o):o=e[4];let n;e[5]!==o?(n=(0,t.jsx)(we,{children:o}),e[5]=o,e[6]=n):n=e[6];let c;e[7]!==a||e[8]!==n?(c=(0,t.jsxs)(Ne,{className:"size-6",children:[a,n]}),e[7]=a,e[8]=n,e[9]=c):c=e[9];let x;e[10]!==s.handle?(x=(0,t.jsx)("span",{className:"text-sm font-semibold",children:s.handle}),e[10]=s.handle,e[11]=x):x=e[11];let b;e[12]!==c||e[13]!==x?(b=(0,t.jsxs)("div",{className:"flex items-center gap-x-2",children:[c,x]}),e[12]=c,e[13]=x,e[14]=b):b=e[14];let f;e[15]!==r?(f=(0,t.jsx)("span",{className:"text-xs text-zinc-500 sm:text-sm",children:r}),e[15]=r,e[16]=f):f=e[16];let h;e[17]!==b||e[18]!==f?(h=(0,t.jsxs)("div",{className:"mb-2 flex items-center justify-between gap-x-2",children:[b,f]}),e[17]=b,e[18]=f,e[19]=h):h=e[19];let g;e[20]!==i?(g=(0,t.jsx)(Ye,{content:i,className:"text-sm text-zinc-800 dark:text-zinc-300"}),e[20]=i,e[21]=g):g=e[21];let d;return e[22]!==h||e[23]!==g?(d=(0,t.jsxs)("div",{className:"p-4",children:[h,g]}),e[22]=h,e[23]=g,e[24]=d):d=e[24],d},Rt=gl,bl=Z(),vl=l=>{const e=(0,bl.c)(91),{currentUser:s,newComment:r,setNewComment:i,handleSubmitComment:a,loading:o,selectedFiles:n,setSelectedFiles:c,isUploading:x}=l;let b;e[0]!==n?(b=n===void 0?[]:n,e[0]=n,e[1]=b):b=e[1];const f=b,h=(0,z.useRef)(null),{isRecording:g,recordingTime:d,startRecording:v,stopRecording:p,audioBlob:m,audioUrl:j,clearAudio:w}=Es(),[C,S]=(0,z.useState)(!1),N=(0,z.useRef)(null);let u;e[2]!==j||e[3]!==C?(u=()=>{j&&(N.current||(N.current=new Audio(j),N.current.onended=()=>S(!1)),C?N.current.pause():N.current.play(),S(!C))},e[2]=j,e[3]=C,e[4]=u):u=e[4];const R=u;let E,T;e[5]===Symbol.for("react.memo_cache_sentinel")?(E=()=>()=>{N.current&&(N.current.pause(),N.current=null)},T=[],e[5]=E,e[6]=T):(E=e[5],T=e[6]),(0,z.useEffect)(E,T);let y,P;e[7]!==m?(y=()=>{!m&&N.current&&(N.current.pause(),N.current=null,S(!1))},P=[m],e[7]=m,e[8]=y,e[9]=P):(y=e[8],P=e[9]),(0,z.useEffect)(y,P);let _;e[10]!==c?(_=O=>{if(O.target.files){const K=Array.from(O.target.files);c&&c(ge=>[...ge,...K])}},e[10]=c,e[11]=_):_=e[11];const M=_;let I;e[12]!==c?(I=O=>{c&&c(K=>K.filter((ge,Ce)=>Ce!==O))},e[12]=c,e[13]=I):I=e[13];const A=I;let D;e[14]!==f?(D=f.map(jl),e[14]=f,e[15]=D):D=e[15];const V=D;let W,H;e[16]!==V?(W=()=>()=>{V.forEach(yl)},H=[V],e[16]=V,e[17]=W,e[18]=H):(W=e[17],H=e[18]),(0,z.useEffect)(W,H);let G;e[19]!==c?(G=O=>{const K=O.clipboardData.files;if(K&&K.length>0){const ge=Array.from(K).filter(kl);ge.length>0&&(O.preventDefault(),c&&c(Ce=>[...Ce,...ge]))}},e[19]=c,e[20]=G):G=e[20];const J=G;let k;e[21]!==m||e[22]!==w||e[23]!==a||e[24]!==d?(k=O=>{m?(a(O,{blob:m,duration:d}),w()):a(O)},e[21]=m,e[22]=w,e[23]=a,e[24]=d,e[25]=k):k=e[25];const $=k,L=zl;if(!s){let O;return e[26]===Symbol.for("react.memo_cache_sentinel")?(O=(0,t.jsx)("div",{className:"border-y border-zinc-100 bg-zinc-50/30 p-6 text-center dark:border-zinc-800 dark:bg-zinc-900/10",children:(0,t.jsx)("p",{className:"text-sm text-zinc-500",children:"Please login to join the conversation."})}),e[26]=O):O=e[26],O}let U;e[27]!==s.avatar||e[28]!==s.handle?(U=(0,t.jsx)(ze,{src:s.avatar,alt:s.handle,className:"object-cover"}),e[27]=s.avatar,e[28]=s.handle,e[29]=U):U=e[29];let B;e[30]!==s.handle?.[0]?(B=s.handle?.[0]?.toUpperCase(),e[30]=s.handle?.[0],e[31]=B):B=e[31];let de;e[32]!==B?(de=(0,t.jsx)(we,{children:B}),e[32]=B,e[33]=de):de=e[33];let me;e[34]!==U||e[35]!==de?(me=(0,t.jsxs)(Ne,{className:"size-9 border border-zinc-200 dark:border-zinc-700",children:[U,de]}),e[34]=U,e[35]=de,e[36]=me):me=e[36];let fe;e[37]!==j||e[38]!==w||e[39]!==J||e[40]!==C||e[41]!==g||e[42]!==r||e[43]!==d||e[44]!==i||e[45]!==p||e[46]!==R?(fe=g?(0,t.jsxs)("div",{className:"flex items-center justify-between bg-violet-50 dark:bg-violet-900/20 rounded-xl px-4 py-3 animate-pulse",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 text-violet-600",children:[(0,t.jsx)("div",{className:"size-2 rounded-full bg-red-500 animate-ping"}),(0,t.jsx)("span",{className:"font-mono font-bold",children:L(d)})]}),(0,t.jsx)("button",{onClick:p,className:"text-violet-600 hover:scale-110 transition-transform",children:(0,t.jsx)(rt,{size:20,fill:"currentColor"})})]}):j?(0,t.jsxs)("div",{className:"flex items-center justify-between bg-zinc-100 dark:bg-zinc-800 rounded-xl px-3 py-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("button",{type:"button",onClick:R,className:"flex size-10 shrink-0 items-center justify-center rounded-full bg-violet-500 text-white transition-all hover:bg-violet-600",children:C?(0,t.jsx)(rt,{size:16,fill:"currentColor"}):(0,t.jsx)(De,{size:20,fill:"currentColor",className:"ml-0.5"})}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-xs font-semibold text-zinc-500 dark:text-zinc-400",children:"Voice Message"}),(0,t.jsx)("span",{className:"text-sm font-bold text-zinc-900 dark:text-white",children:L(d)})]})]}),(0,t.jsx)("button",{onClick:w,className:"rounded-full p-2 text-zinc-400 transition-colors hover:bg-rose-50 hover:text-rose-500 dark:hover:bg-rose-500/10",children:(0,t.jsx)(ns,{size:18})})]}):(0,t.jsx)("textarea",{id:"comment-input",className:"min-h-[60px] w-full resize-none bg-transparent text-base outline-none placeholder:text-zinc-500 dark:text-white",placeholder:"Post your reply...",value:r,onChange:O=>i(O.target.value),onPaste:J}),e[37]=j,e[38]=w,e[39]=J,e[40]=C,e[41]=g,e[42]=r,e[43]=d,e[44]=i,e[45]=p,e[46]=R,e[47]=fe):fe=e[47];let ue;e[48]!==V||e[49]!==A||e[50]!==f?(ue=f.length>0&&(0,t.jsx)("div",{className:"mt-2 mb-2 flex flex-wrap gap-2",children:f.map((O,K)=>(0,t.jsxs)("div",{className:"relative size-20 overflow-hidden rounded-xl border border-zinc-200 dark:border-zinc-800",children:[O.type.startsWith("image/")?(0,t.jsx)("img",{src:V[K],className:"size-full object-cover",alt:""}):(0,t.jsx)("div",{className:"flex size-full items-center justify-center bg-zinc-100 dark:bg-zinc-800",children:(0,t.jsx)(gs,{size:20,className:"text-zinc-500"})}),(0,t.jsx)("button",{onClick:()=>A(K),className:"absolute right-1 top-1 rounded-full bg-black/60 p-1 text-white transition-colors hover:bg-black",children:(0,t.jsx)($e,{size:12})})]},K))}),e[48]=V,e[49]=A,e[50]=f,e[51]=ue):ue=e[51];let xe;e[52]===Symbol.for("react.memo_cache_sentinel")?(xe=()=>h.current?.click(),e[52]=xe):xe=e[52];const je=g||!!j;let he;e[53]===Symbol.for("react.memo_cache_sentinel")?(he=(0,t.jsx)(As,{size:20}),e[53]=he):he=e[53];let ae;e[54]!==je?(ae=(0,t.jsx)("button",{type:"button",onClick:xe,disabled:je,className:"rounded-full p-2 text-violet-600 transition-colors hover:bg-violet-50 dark:hover:bg-zinc-800 disabled:opacity-30",title:"Attach media",children:he}),e[54]=je,e[55]=ae):ae=e[55];let pe;e[56]!==j||e[57]!==g||e[58]!==v||e[59]!==p?(pe=!j&&(0,t.jsx)("button",{type:"button",onClick:g?p:v,className:`rounded-full p-2 transition-colors ${g?"bg-red-50 text-red-600 animate-pulse":"text-violet-600 hover:bg-violet-50 dark:hover:bg-zinc-800"}`,title:g?"Stop recording":"Record voice comment",children:(0,t.jsx)(fs,{size:20,className:g?"fill-current":""})}),e[56]=j,e[57]=g,e[58]=v,e[59]=p,e[60]=pe):pe=e[60];let ne;e[61]!==M?(ne=(0,t.jsx)("input",{type:"file",ref:h,onChange:M,multiple:!0,className:"hidden",accept:"image/*,video/*,application/pdf"}),e[61]=M,e[62]=ne):ne=e[62];let re;e[63]!==ae||e[64]!==pe||e[65]!==ne?(re=(0,t.jsxs)("div",{className:"flex gap-1 text-violet-600",children:[ae,pe,ne]}),e[63]=ae,e[64]=pe,e[65]=ne,e[66]=re):re=e[66];const oe=o||x?"primary":"animated";let ee;e[67]!==x||e[68]!==o?(ee=!(o||x)&&(0,t.jsx)(Ae,{size:20}),e[67]=x,e[68]=o,e[69]=ee):ee=e[69];const ie=o||x;let X;e[70]!==m||e[71]!==g||e[72]!==r||e[73]!==f.length?(X=!r.trim()&&f.length===0&&!m||g,e[70]=m,e[71]=g,e[72]=r,e[73]=f.length,e[74]=X):X=e[74];let te;e[75]!==$||e[76]!==oe||e[77]!==ee||e[78]!==ie||e[79]!==X?(te=(0,t.jsx)(Ot,{variant:oe,icon:ee,className:"min-w-[70px] !w-auto",onClick:$,loading:ie,disabled:X,children:"Reply"}),e[75]=$,e[76]=oe,e[77]=ee,e[78]=ie,e[79]=X,e[80]=te):te=e[80];let se;e[81]!==re||e[82]!==te?(se=(0,t.jsxs)("div",{className:"mt-2 flex items-center justify-between border-t border-zinc-100 pt-3 dark:border-zinc-800",children:[re,te]}),e[81]=re,e[82]=te,e[83]=se):se=e[83];let le;e[84]!==fe||e[85]!==ue||e[86]!==se?(le=(0,t.jsxs)("div",{className:"flex-1",children:[fe,ue,se]}),e[84]=fe,e[85]=ue,e[86]=se,e[87]=le):le=e[87];let ce;return e[88]!==me||e[89]!==le?(ce=(0,t.jsx)("div",{className:"border-y border-zinc-100 bg-zinc-50/30 p-4 dark:border-zinc-800 dark:bg-zinc-900/10",children:(0,t.jsxs)("div",{className:"flex gap-3",children:[me,le]})}),e[88]=me,e[89]=le,e[90]=ce):ce=e[90],ce},Ht=z.memo(vl);function jl(l){return URL.createObjectURL(l)}function yl(l){return URL.revokeObjectURL(l)}function kl(l){return l.type.startsWith("image/")}function zl(l){return`${Math.floor(l/60)}:${Math.floor(l%60).toString().padStart(2,"0")}`}var wl=Z(),Nl=l=>{const e=(0,wl.c)(30),{url:s}=l;let r,i;e[0]!==s?(r=["link-preview",s],i=()=>Qs(s),e[0]=s,e[1]=r,e[2]=i):(r=e[1],i=e[2]);const a=!!s;let o;e[3]!==r||e[4]!==i||e[5]!==a?(o={queryKey:r,queryFn:i,staleTime:864e5,enabled:a},e[3]=r,e[4]=i,e[5]=a,e[6]=o):o=e[6];const{data:n,isLoading:c,isError:x}=is(o);if(c){let w;return e[7]===Symbol.for("react.memo_cache_sentinel")?(w=(0,t.jsx)("div",{className:"mt-3 flex h-24 animate-pulse items-center justify-center overflow-hidden rounded-2xl border border-zinc-100 bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-900/50",children:(0,t.jsx)(ut,{className:"animate-spin text-zinc-300 dark:text-zinc-700",size:24})}),e[7]=w):w=e[7],w}if(x||!n||!n.title&&!n.image)return null;let b;e[8]!==n.image||e[9]!==n.title?(b=n.image&&(0,t.jsx)("div",{className:"aspect-[1.91/1] w-full overflow-hidden border-b border-zinc-100 bg-zinc-100 dark:border-zinc-800 dark:bg-zinc-900",children:(0,t.jsx)("img",{src:n.image,alt:n.title??void 0,className:"h-full w-full object-cover transition-transform duration-500 group-hover:scale-[1.02]",onError:_l})}),e[8]=n.image,e[9]=n.title,e[10]=b):b=e[10];let f;e[11]===Symbol.for("react.memo_cache_sentinel")?(f=(0,t.jsx)(ut,{size:12}),e[11]=f):f=e[11];let h;e[12]!==n.siteName?(h=(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs font-bold uppercase tracking-wider text-zinc-600",children:[f,(0,t.jsx)("span",{children:n.siteName})]}),e[12]=n.siteName,e[13]=h):h=e[13];let g;e[14]!==n.title?(g=(0,t.jsx)("div",{className:"line-clamp-2 text-[15px] font-bold leading-snug transition-colors group-hover:text-violet-700 dark:text-white",children:n.title}),e[14]=n.title,e[15]=g):g=e[15];let d;e[16]!==n.description?(d=n.description&&(0,t.jsx)("p",{className:"line-clamp-2 text-xs leading-relaxed text-zinc-600 dark:text-zinc-400",children:n.description}),e[16]=n.description,e[17]=d):d=e[17];let v;e[18]===Symbol.for("react.memo_cache_sentinel")?(v=(0,t.jsx)(rs,{size:10}),e[18]=v):v=e[18];let p;e[19]!==s?(p=(0,t.jsxs)("div",{className:"flex items-center gap-1 pt-1 text-[11px] font-medium text-zinc-500",children:[v,(0,t.jsx)("span",{className:"truncate",children:s})]}),e[19]=s,e[20]=p):p=e[20];let m;e[21]!==p||e[22]!==h||e[23]!==g||e[24]!==d?(m=(0,t.jsxs)("div",{className:"space-y-1 p-3.5",children:[h,g,d,p]}),e[21]=p,e[22]=h,e[23]=g,e[24]=d,e[25]=m):m=e[25];let j;return e[26]!==m||e[27]!==b||e[28]!==s?(j=(0,t.jsxs)("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"group mt-3 flex flex-col overflow-hidden rounded-2xl border border-zinc-100 bg-white shadow-sm transition-all hover:bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-950 dark:hover:bg-zinc-900",onClick:Cl,children:[b,m]}),e[26]=m,e[27]=b,e[28]=s,e[29]=j):j=e[29],j},Mt=Nl;function Cl(l){return l.stopPropagation()}function _l(l){return l.target.style.display="none"}var Sl=Z(),$l=l=>{const e=(0,Sl.c)(15),{file:s}=l;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=(0,t.jsx)("div",{className:"flex size-10 items-center justify-center rounded-xl bg-violet-100 text-violet-600 dark:bg-violet-900/30",children:(0,t.jsx)(as,{size:20})}),e[0]=r):r=e[0];let i;e[1]!==s.name?(i=(0,t.jsx)("div",{className:"truncate text-sm font-bold dark:text-white",children:s.name}),e[1]=s.name,e[2]=i):i=e[2];let a;e[3]!==s.size?(a=s.size!==void 0&&(0,t.jsxs)("div",{className:"text-xs uppercase text-zinc-500",children:[(s.size/1024/1024).toFixed(2)," MB"]}),e[3]=s.size,e[4]=a):a=e[4];let o;e[5]!==i||e[6]!==a?(o=(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[i,a]}),e[5]=i,e[6]=a,e[7]=o):o=e[7];let n;e[8]===Symbol.for("react.memo_cache_sentinel")?(n=(0,t.jsx)(ms,{size:18}),e[8]=n):n=e[8];let c;e[9]!==s.name||e[10]!==s.url?(c=(0,t.jsx)("a",{href:s.url,download:s.name,className:"p-2 text-zinc-400 transition-colors hover:text-violet-600",onClick:Tl,children:n}),e[9]=s.name,e[10]=s.url,e[11]=c):c=e[11];let x;return e[12]!==o||e[13]!==c?(x=(0,t.jsxs)("div",{className:"group mt-3 flex items-center gap-3 rounded-2xl border border-zinc-100 bg-zinc-50/50 p-3 transition-colors hover:border-violet-500/30 dark:border-zinc-800 dark:bg-zinc-900/10",children:[r,o,c]}),e[12]=o,e[13]=c,e[14]=x):x=e[14],x},Pl=$l;function Tl(l){return l.stopPropagation()}var Ze=Z(),Fl=l=>{const e=(0,Ze.c)(18),{item:s,onClick:r}=l,[i,a]=(0,z.useState)(!1);let o,n,c;e[0]===Symbol.for("react.memo_cache_sentinel")?(o={scale:1.02},n={scale:.98},c={type:"spring",stiffness:400,damping:25},e[0]=o,e[1]=n,e[2]=c):(o=e[0],n=e[1],c=e[2]);let x;e[3]!==i?(x=!i&&(0,t.jsx)("div",{className:"absolute inset-0 animate-pulse bg-zinc-200 dark:bg-zinc-800"}),e[3]=i,e[4]=x):x=e[4];const b=s.url||s.src;let f;e[5]===Symbol.for("react.memo_cache_sentinel")?(f={opacity:0,scale:1.1,filter:"blur(10px)"},e[5]=f):f=e[5];let h;e[6]!==i?(h=i?{opacity:1,scale:1,filter:"blur(0px)"}:{},e[6]=i,e[7]=h):h=e[7];let g;e[8]===Symbol.for("react.memo_cache_sentinel")?(g={duration:.5,ease:"easeOut"},e[8]=g):g=e[8];let d;e[9]===Symbol.for("react.memo_cache_sentinel")?(d=()=>a(!0),e[9]=d):d=e[9];let v;e[10]!==b||e[11]!==h?(v=(0,t.jsx)(Q.img,{src:b,initial:f,animate:h,transition:g,className:"size-full object-cover transition-transform duration-500 group-hover:scale-105",alt:"",loading:"lazy",onLoad:d}),e[10]=b,e[11]=h,e[12]=v):v=e[12];let p;e[13]===Symbol.for("react.memo_cache_sentinel")?(p=(0,t.jsx)("div",{className:"absolute inset-0 bg-black/0 transition-colors group-hover:bg-black/10"}),e[13]=p):p=e[13];let m;return e[14]!==r||e[15]!==v||e[16]!==x?(m=(0,t.jsxs)(Q.div,{whileHover:o,whileTap:n,transition:c,className:"group relative size-full overflow-hidden",onClick:r,children:[x,v,p]}),e[14]=r,e[15]=v,e[16]=x,e[17]=m):m=e[17],m},Rl=l=>{const e=(0,Ze.c)(21),{item:s,onClick:r}=l,[i,a]=(0,z.useState)(!1);let o,n,c;e[0]===Symbol.for("react.memo_cache_sentinel")?(o={scale:1.02},n={scale:.98},c={type:"spring",stiffness:400,damping:25},e[0]=o,e[1]=n,e[2]=c):(o=e[0],n=e[1],c=e[2]);let x;e[3]!==i?(x=!i&&(0,t.jsx)("div",{className:"absolute inset-0 animate-pulse bg-zinc-200 dark:bg-zinc-800"}),e[3]=i,e[4]=x):x=e[4];let b;e[5]!==s.poster||e[6]!==i?(b=s.poster&&(0,t.jsx)(Q.img,{src:s.poster,initial:{opacity:0,scale:1.1,filter:"blur(10px)"},animate:i?{opacity:1,scale:1,filter:"blur(0px)"}:{},transition:{duration:.5,ease:"easeOut"},className:"size-full object-cover transition-transform duration-500 group-hover:scale-105",alt:"",loading:"lazy",onLoad:()=>a(!0)}),e[5]=s.poster,e[6]=i,e[7]=b):b=e[7];let f;e[8]!==s.poster?(f=!s.poster&&(0,t.jsx)("div",{className:"flex size-full items-center justify-center bg-zinc-100 dark:bg-zinc-900",onMouseEnter:()=>a(!0),children:(0,t.jsx)("div",{className:"size-full bg-zinc-800/20"})}),e[8]=s.poster,e[9]=f):f=e[9];let h;e[10]===Symbol.for("react.memo_cache_sentinel")?(h=(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent opacity-80"}),e[10]=h):h=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsx)("div",{className:"flex size-14 items-center justify-center rounded-full bg-white/15 backdrop-blur-md ring-1 ring-white/30 transition-all group-hover:bg-white/25 group-hover:scale-110 group-active:scale-95 shadow-2xl",children:(0,t.jsx)(De,{className:"ml-1 size-7 text-white fill-white drop-shadow-xl",strokeWidth:0})})}),e[11]=g):g=e[11];let d;e[12]===Symbol.for("react.memo_cache_sentinel")?(d=(0,t.jsx)(De,{className:"size-2.5 fill-white",strokeWidth:0}),e[12]=d):d=e[12];const v=s.duration||"0:00";let p;e[13]!==v?(p=(0,t.jsx)("div",{className:"absolute bottom-3 left-3 flex items-center gap-2",children:(0,t.jsxs)("div",{className:"flex items-center gap-1.5 rounded-lg bg-black/40 px-2 py-1 text-[11px] font-bold text-white backdrop-blur-md border border-white/10 shadow-lg",children:[d,(0,t.jsx)("span",{className:"tabular-nums tracking-wider",children:v})]})}),e[13]=v,e[14]=p):p=e[14];let m;return e[15]!==r||e[16]!==p||e[17]!==x||e[18]!==b||e[19]!==f?(m=(0,t.jsxs)(Q.div,{whileHover:o,whileTap:n,transition:c,className:"group relative size-full overflow-hidden",onClick:r,children:[x,b,f,h,g,p]}),e[15]=r,e[16]=p,e[17]=x,e[18]=b,e[19]=f,e[20]=m):m=e[20],m},Ml=l=>{const e=(0,Ze.c)(3),{items:s}=l,r=s===void 0?[]:s,{openLightbox:i}=Ds();if(!r||Array.isArray(r)&&r.length===0)return null;const a=Array.isArray(r)?r:[r],o=a.filter(Il),n=a.filter(Ll),c=o.some(Dl),x=d=>{i(o,d)},b="mt-2 space-y-2",f=o.length>0&&(0,t.jsx)("div",{className:`grid gap-2 overflow-hidden rounded-2xl border border-zinc-100 dark:border-zinc-800 ${o.length===1?"grid-cols-1":o.length===2?c?"aspect-[8/9] grid-cols-1 grid-rows-2":"aspect-[16/9] grid-cols-2":(o.length===3,"aspect-[16/9] grid-cols-2 grid-rows-2")}`,children:o.map((d,v)=>(0,t.jsx)("div",{className:`relative cursor-pointer overflow-hidden bg-zinc-100 dark:bg-zinc-900 group ${o.length===3&&v===0?"row-span-2":""}`,children:d.type==="video"?(0,t.jsx)(Rl,{item:d,onClick:p=>{p.stopPropagation(),x(v)}}):(0,t.jsx)(Fl,{item:d,onClick:p=>{p.stopPropagation(),x(v)}})},v))}),h=n.map(Al);let g;return e[0]!==f||e[1]!==h?(g=(0,t.jsxs)("div",{className:b,children:[f,h]}),e[0]=f,e[1]=h,e[2]=g):g=e[2],g},El=Ml;function Il(l){return l.type==="image"||l.type==="video"}function Ll(l){return l.type==="file"}function Dl(l){return l.type==="video"}function Al(l,e){return(0,t.jsx)(Pl,{file:l},e)}var Ol=({isOpen:l,onClose:e,url:s,title:r="Share",overlayClassName:i})=>{const[a,o]=(0,z.useState)(!1),[n,c]=(0,z.useState)(""),[x,b]=(0,z.useState)([]),[f,h]=(0,z.useState)(!1),[g,d]=(0,z.useState)(null),{addToast:v}=Ke(),{currentUser:p}=Vt(),m=(0,z.useCallback)(async()=>{if(p){h(!0);try{b((await zt(p.id)).map(u=>u.user).filter(u=>u!==null).slice(0,5))}catch(u){console.error("Failed to fetch conversations:",u)}finally{h(!1)}}},[p]),j=(0,z.useCallback)(async()=>{if(p){h(!0);try{b((await zt(p.id)).map(u=>u.user).filter(u=>u!==null&&(u.name?.toLowerCase().includes(n.toLowerCase())||u.handle?.toLowerCase().includes(n.toLowerCase()))))}catch(u){console.error("Search failed:",u)}finally{h(!1)}}},[n,p]);(0,z.useEffect)(()=>{if(!l||!p){c(""),b([]);return}const u=setTimeout(()=>{n.trim()?j():m()},300);return()=>clearTimeout(u)},[n,l,p,j,m]);const w=async u=>{u&&u.stopPropagation();try{await Ge(s),o(!0),v("Link copied to clipboard!","success"),setTimeout(()=>o(!1),2e3)}catch(R){console.error("Failed to copy:",R),v("Failed to copy link","error")}},C=async u=>{if(p){d(u.id);try{await Js(await Is(p.id,u.id),p.id,s,"text"),v(`Sent to ${u.name||u.handle}!`,"success")}catch(R){console.error("Failed to send message:",R),v("Failed to send message","error")}finally{d(null)}}},S=[{name:"X",icon:ks,color:"bg-black text-white",href:`https://twitter.com/intent/tweet?url=${encodeURIComponent(s)}`},{name:"Facebook",icon:os,color:"bg-[#1877F2] text-white",href:`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(s)}`},{name:"LinkedIn",icon:hs,color:"bg-[#0A66C2] text-white",href:`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(s)}`},{name:"WhatsApp",icon:js,color:"bg-[#25D366] text-white",href:`https://wa.me/?text=${encodeURIComponent(s)}`},{name:"Email",icon:ys,color:"bg-zinc-600 text-white",href:`mailto:?body=${encodeURIComponent(s)}`}],N=async()=>{if(navigator.share)try{await navigator.share({title:r,url:s})}catch(u){u.name!=="AbortError"&&console.error("Native share failed:",u)}else w()};return(0,t.jsx)(Ut,{isOpen:l,onClose:e,className:"max-w-[360px] overflow-hidden rounded-[32px] border border-black/10 bg-white/75 p-0 shadow-2xl backdrop-blur-xl dark:border-white/10 dark:bg-zinc-900/75 sm:max-w-[380px]",overlayClassName:i,children:(0,t.jsxs)("div",{className:"flex h-full flex-col",children:[(0,t.jsx)("div",{className:"flex items-center justify-center pt-6 pb-2",children:(0,t.jsx)("h2",{className:"text-[17px] font-semibold text-zinc-900 dark:text-zinc-50",children:r})}),(0,t.jsx)("div",{className:"px-5 py-3",children:(0,t.jsxs)("div",{className:"group relative",children:[(0,t.jsx)(vs,{className:"absolute left-3.5 top-1/2 size-4 -translate-y-1/2 text-zinc-400 transition-colors group-focus-within:text-violet-500"}),(0,t.jsx)("input",{type:"text",placeholder:"Search people...",value:n,onChange:u=>c(u.target.value),className:"w-full rounded-2xl border border-black/5 bg-black/5 py-3 pl-11 pr-4 text-[15px] outline-none transition-all focus:bg-white/50 focus:ring-4 focus:ring-violet-500/10 dark:border-white/5 dark:bg-white/5 dark:focus:bg-black/50"})]})}),(0,t.jsx)("div",{className:"no-scrollbar flex min-h-[110px] items-center gap-4 overflow-x-auto px-5 py-4",children:f?(0,t.jsx)("div",{className:"flex flex-1 justify-center",children:(0,t.jsx)("span",{className:"animate-pulse text-[13px] font-medium text-zinc-400",children:"Loading..."})}):x.length>0?x.map(u=>(0,t.jsxs)("button",{onClick:()=>C(u),disabled:g!==null,className:"group flex shrink-0 flex-col items-center gap-2 transition-transform active:scale-95 disabled:opacity-50",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"size-16 overflow-hidden rounded-full border-2 border-white/50 shadow-sm dark:border-zinc-800/50 bg-zinc-100 dark:bg-zinc-800",children:(0,t.jsx)("img",{src:u.avatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=${u.handle}`,alt:u.handle,className:"size-full object-cover"})}),g===u.id&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center rounded-full bg-black/40",children:(0,t.jsx)("span",{className:"animate-pulse text-white font-bold",children:"..."})})]}),(0,t.jsx)("span",{className:"max-w-[70px] truncate text-[11px] font-medium text-zinc-500 dark:text-zinc-400",children:u.name?.split(" ")[0]||u.handle})]},u.id)):(0,t.jsx)("div",{className:"flex-1 py-2 text-center",children:(0,t.jsx)("span",{className:"text-xs text-zinc-400",children:"No people found"})})}),(0,t.jsx)("div",{className:"mx-5 h-px bg-black/5 dark:bg-white/5"}),(0,t.jsxs)("div",{className:"grid grid-cols-5 gap-3 px-5 py-6",children:[S.map(u=>(0,t.jsxs)("a",{href:u.href,target:"_blank",rel:"noopener noreferrer",className:"group flex flex-col items-center gap-2.5",children:[(0,t.jsx)("div",{className:`size-12 ${u.color} flex items-center justify-center rounded-[18px] shadow-sm ring-1 ring-black/5 transition-all group-hover:-translate-y-1 group-hover:scale-105 group-hover:shadow-lg dark:ring-white/5`,children:(0,t.jsx)(u.icon,{size:22,strokeWidth:2.5})}),(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider text-zinc-500/80 dark:text-zinc-400/80",children:u.name})]},u.name)),(0,t.jsxs)("button",{onClick:N,className:"group flex flex-col items-center gap-2.5",children:[(0,t.jsx)("div",{className:"flex size-12 items-center justify-center rounded-[18px] border border-black/10 bg-white/50 text-zinc-600 shadow-sm transition-all group-hover:-translate-y-1 group-hover:scale-105 dark:border-white/10 dark:bg-white/5 dark:text-zinc-300",children:(0,t.jsx)(We,{size:22,strokeWidth:2.5})}),(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider text-zinc-500/80 dark:text-zinc-400/80",children:"More"})]})]}),(0,t.jsx)("div",{className:"px-5 pb-6",children:(0,t.jsxs)("div",{className:"group relative flex items-center overflow-hidden rounded-2xl border border-black/10 bg-white/40 dark:border-white/10 dark:bg-black/20",children:[(0,t.jsx)("input",{type:"text",readOnly:!0,value:s,className:"w-full bg-transparent py-4 pl-4 pr-16 text-[14px] font-medium text-zinc-600 outline-none dark:text-zinc-300"}),(0,t.jsx)("button",{onClick:w,className:`absolute right-1 text-[13px] font-bold active:scale-95 transition-all px-4 h-10 rounded-xl leading-none ${a?"text-emerald-500":"text-violet-600 hover:text-violet-700 dark:text-violet-400"}`,children:a?"Copied":"Copy"})]})}),(0,t.jsx)("div",{className:"border-t border-black/10 dark:border-white/10",children:(0,t.jsx)("button",{onClick:e,className:"flex h-16 w-full items-center justify-center text-[19px] font-medium text-zinc-500 transition-colors active:bg-black/5 dark:text-zinc-400 dark:active:bg-white/5",children:"Close"})})]})})},qt=Ol,Qt=Z(),Ul=l=>{const e=(0,Qt.c)(6),{avatars:s}=l;if(!s||s.length===0)return null;let r,i;if(e[0]!==s){const o=s.slice(0,3);r="relative mt-2.5 h-8 w-8",i=o.map((n,c)=>{let x,b;return o.length===1?(x="top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",b="size-5"):o.length===2?(b="size-4.5",x=c===0?"top-0 right-0":"bottom-0 left-0"):(b=c===0?"size-4.5":"size-3.5",c===0?x="top-0 left-1/2 -translate-x-1/2":c===1?x="bottom-0.5 left-0":x="bottom-0.5 right-0"),(0,t.jsx)("div",{className:`absolute rounded-full border-2 border-white bg-zinc-100 dark:border-black dark:bg-zinc-800 overflow-hidden shadow-md transition-transform hover:scale-110 ${x} ${b}`,style:{zIndex:10-c},children:(0,t.jsx)("img",{src:n,alt:"",className:"h-full w-full object-cover",loading:"lazy"})},c)}),e[0]=s,e[1]=r,e[2]=i}else r=e[1],i=e[2];let a;return e[3]!==r||e[4]!==i?(a=(0,t.jsx)("div",{className:r,children:i}),e[3]=r,e[4]=i,e[5]=a):a=e[5],a},Et=l=>{const e=(0,Qt.c)(78),{id:s,user:r,isCurrentUser:i,isComment:a,isPinned:o,onEdit:n,onDelete:c,onTogglePin:x,addToast:b,trigger:f}=l,{openReport:h}=Bt(),[g,d]=(0,z.useState)(!1);if(Ss("(min-width: 1024px)")){let _;e[0]!==f?(_=(0,t.jsx)(Cs,{asChild:!0,onClick:Hl,children:(0,t.jsx)("div",{className:"cursor-pointer outline-none",children:f})}),e[0]=f,e[1]=_):_=e[1];let M;e[2]!==b||e[3]!==s||e[4]!==a?(M=!a&&(0,t.jsxs)(ye,{onClick:$=>{$.stopPropagation(),Ge(Je(s)).then(()=>{b("Link copied"),d(!1)}).catch(()=>{b("Failed to copy link","error")})},children:[(0,t.jsx)(ct,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Copy link"})]}),e[2]=b,e[3]=s,e[4]=a,e[5]=M):M=e[5];let I;e[6]!==s||e[7]!==h?(I=$=>{$.stopPropagation(),h("post",s),d(!1)},e[6]=s,e[7]=h,e[8]=I):I=e[8];let A;e[9]===Symbol.for("react.memo_cache_sentinel")?(A=(0,t.jsx)(Be,{className:"mr-2 h-4 w-4"}),e[9]=A):A=e[9];const D=a?"comment":"post";let V;e[10]!==D?(V=(0,t.jsxs)("span",{children:["Report ",D]}),e[10]=D,e[11]=V):V=e[11];let W;e[12]!==I||e[13]!==V?(W=(0,t.jsxs)(ye,{onClick:I,children:[A,V]}),e[12]=I,e[13]=V,e[14]=W):W=e[14];let H;e[15]!==i||e[16]!==h||e[17]!==r?(H=!i&&(0,t.jsxs)(ye,{onClick:$=>{$.stopPropagation(),h("user",r.id),d(!1)},children:[(0,t.jsx)(ot,{className:"mr-2 h-4 w-4"}),(0,t.jsxs)("span",{children:["Report @",r.handle]})]}),e[15]=i,e[16]=h,e[17]=r,e[18]=H):H=e[18];let G;e[19]!==a||e[20]!==i||e[21]!==o||e[22]!==c||e[23]!==n||e[24]!==x?(G=i&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(_s,{}),!a&&x&&(0,t.jsx)(ye,{onClick:$=>{$.stopPropagation(),x(),d(!1)},children:o?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(mt,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Unpin from profile"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(qe,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Pin to profile"})]})}),(0,t.jsxs)(ye,{onClick:$=>{$.stopPropagation(),n(),d(!1)},children:[(0,t.jsx)(ft,{className:"mr-2 h-4 w-4"}),(0,t.jsxs)("span",{children:["Edit ",a?"Comment":"Post"]})]}),(0,t.jsxs)(ye,{className:"text-red-500 focus:text-red-500",onClick:$=>{$.stopPropagation(),c(),d(!1)},children:[(0,t.jsx)(dt,{className:"mr-2 h-4 w-4"}),(0,t.jsxs)("span",{children:["Delete ",a?"comment":"post"]})]})]}),e[19]=a,e[20]=i,e[21]=o,e[22]=c,e[23]=n,e[24]=x,e[25]=G):G=e[25];let J;e[26]!==M||e[27]!==W||e[28]!==H||e[29]!==G?(J=(0,t.jsxs)(Ns,{align:"end",className:"w-56",onClick:ql,children:[M,W,H,G]}),e[26]=M,e[27]=W,e[28]=H,e[29]=G,e[30]=J):J=e[30];let k;return e[31]!==g||e[32]!==_||e[33]!==J?(k=(0,t.jsx)("div",{onClick:Wl,children:(0,t.jsxs)(Ms,{open:g,onOpenChange:d,modal:!0,children:[_,J]})}),e[31]=g,e[32]=_,e[33]=J,e[34]=k):k=e[34],k}let v;e[35]===Symbol.for("react.memo_cache_sentinel")?(v=_=>{_.stopPropagation(),d(!0)},e[35]=v):v=e[35];let p;e[36]!==f?(p=(0,t.jsx)("div",{onClick:v,className:"cursor-pointer",children:f}),e[36]=f,e[37]=p):p=e[37];let m;e[38]===Symbol.for("react.memo_cache_sentinel")?(m=()=>d(!1),e[38]=m):m=e[38];let j;e[39]!==b||e[40]!==s||e[41]!==a?(j=!a&&(0,t.jsx)(ke,{icon:(0,t.jsx)(ct,{size:18}),onClick:_=>{_.stopPropagation(),Ge(Je(s)).then(()=>{b("Link copied"),d(!1)}).catch(()=>{b("Failed to copy link","error")})},children:"Copy link"}),e[39]=b,e[40]=s,e[41]=a,e[42]=j):j=e[42];let w;e[43]===Symbol.for("react.memo_cache_sentinel")?(w=(0,t.jsx)(Be,{size:18}),e[43]=w):w=e[43];let C;e[44]!==s||e[45]!==h?(C=_=>{_.stopPropagation(),h("post",s),d(!1)},e[44]=s,e[45]=h,e[46]=C):C=e[46];const S=a?"comment":"post";let N;e[47]!==C||e[48]!==S?(N=(0,t.jsxs)(ke,{icon:w,onClick:C,children:["Report ",S]}),e[47]=C,e[48]=S,e[49]=N):N=e[49];let u;e[50]!==i||e[51]!==h||e[52]!==r?(u=!i&&(0,t.jsxs)(ke,{icon:(0,t.jsx)(ot,{size:18}),onClick:_=>{_.stopPropagation(),h("user",r.id),d(!1)},children:["Report @",r.handle]}),e[50]=i,e[51]=h,e[52]=r,e[53]=u):u=e[53];let R;e[54]!==a||e[55]!==i||e[56]!==o||e[57]!==x?(R=i&&!a&&x&&(0,t.jsx)(ke,{icon:o?(0,t.jsx)(mt,{size:18}):(0,t.jsx)(qe,{size:18}),onClick:_=>{_.stopPropagation(),x(),d(!1)},children:o?"Unpin from profile":"Pin to profile"}),e[54]=a,e[55]=i,e[56]=o,e[57]=x,e[58]=R):R=e[58];let E;e[59]!==a||e[60]!==i||e[61]!==n?(E=i&&(0,t.jsxs)(ke,{icon:(0,t.jsx)(ft,{size:18}),onClick:_=>{_.stopPropagation(),n(),d(!1)},children:["Edit ",a?"Comment":"Post"]}),e[59]=a,e[60]=i,e[61]=n,e[62]=E):E=e[62];let T;e[63]!==a||e[64]!==i||e[65]!==c?(T=i&&(0,t.jsxs)(ke,{variant:"destructive",icon:(0,t.jsx)(dt,{size:18}),onClick:_=>{_.stopPropagation(),c(),d(!1)},children:["Delete ",a?"comment":"post"]}),e[63]=a,e[64]=i,e[65]=c,e[66]=T):T=e[66];let y;e[67]!==g||e[68]!==R||e[69]!==E||e[70]!==T||e[71]!==j||e[72]!==N||e[73]!==u?(y=(0,t.jsx)("div",{onClick:Ql,children:(0,t.jsxs)(Zs,{isOpen:g,onClose:m,children:[j,N,u,R,E,T]})}),e[67]=g,e[68]=R,e[69]=E,e[70]=T,e[71]=j,e[72]=N,e[73]=u,e[74]=y):y=e[74];let P;return e[75]!==y||e[76]!==p?(P=(0,t.jsxs)(t.Fragment,{children:[p,y]}),e[75]=y,e[76]=p,e[77]=P):P=e[77],P},Xe=({id:l,user:e,timeAgo:s,content:r,contentClass:i,media:a,quotedPost:o,stats:n,onClick:c,repostedBy:x,onUserClick:b,currentUser:f,poll:h,isDetail:g,initialComments:d,onDelete:v,onUpdate:p,isComment:m,onReply:j,community:w,parent_id:C,post_id:S,commenterAvatars:N=[],is_pinned:u=!1,type:R="text",duration:E})=>{const T=Lt(),{addToast:y}=Ke(),P=ls(),[_,M]=(0,z.useState)(u),{liked:I,reposted:A,localStats:D,setLocalStats:V,handleLike:W,handleRepost:H}=Gs(S||l,n,f,m?l:void 0),{deletePost:G,updatePost:J}=Ws(),k=async()=>{try{const F=!_;await J(l,{is_pinned:F,pinned_at:F?new Date().toISOString():null}),M(F),P.invalidateQueries({queryKey:["posts","user",e.id]}),y(F?"Post pinned to profile":"Post unpinned")}catch(F){console.error("Failed to toggle pin:",F),y("Failed to update pin status")}},{comments:$,fetchNextPage:L,hasNextPage:U,isFetchingNextPage:B,addComment:de,deleteComment:me,updateComment:fe,isSubmitting:ue}=kt(S||l,d),[xe,je]=(0,z.useState)(""),[he,ae]=(0,z.useState)([]),[pe,ne]=(0,z.useState)(!1),[re,oe]=(0,z.useState)(!1),[ee,ie]=(0,z.useState)(!1),[X,te]=(0,z.useState)(r),[se,le]=(0,z.useState)(a||[]),[ce,O]=(0,z.useState)([]),[K,ge]=(0,z.useState)(!1),[Ce,Oe]=(0,z.useState)(!1),[Ue,Pe]=(0,z.useState)(null),[Ve,tt]=(0,z.useState)(!1),{comments:Gt,refetch:st}=kt(S||l,void 0,Ve?l:void 0),{ref:lt,inView:it}=ts({threshold:.5,triggerOnce:!0});(0,z.useEffect)(()=>{if(it&&!m&&l&&!l.startsWith("temp-")){const F=setTimeout(()=>{At(l).catch(console.error)},1500);return()=>clearTimeout(F)}},[it,l,m]);const Jt=(0,z.useCallback)(async()=>{!l||!S&&!l||D.comments===0||(tt(!0),st())},[l,S,D.comments,st]),at=async()=>{const F=JSON.stringify(se)!==JSON.stringify(a||[])||ce.length>0;if(!X.trim()||X===r&&!F){ie(!1);return}ge(!0);try{const q=[];for(const be of ce){const Fe=await Se(be);q.push(Fe)}const Y=[...se,...q];m?await fe({commentId:l,content:X,media:Y}):await J(l,{content:X,media:Y}),O([]),ie(!1),y(`${m?"Comment":"Post"} updated`),p&&p(l,X,Y)}catch(q){console.error(`Failed to update ${m?"comment":"post"}:`,q),y(`Failed to update ${m?"comment":"post"}`)}finally{ge(!1)}},nt=async F=>{F&&F.stopPropagation();try{m?await me(l):await G(l),y(`${m?"Comment":"Post"} deleted successfully`),v&&v(l)}catch(q){console.error(`Failed to delete ${m?"comment":"post"}:`,q),y(`Failed to delete ${m?"comment":"post"}`)}finally{oe(!1)}},Xt=async(F,q)=>{if(F?.preventDefault(),!(!xe.trim()&&he.length===0&&!q||!f)){ne(!0);try{let Y=[],be="text",Fe;if(q)Y=[await Se(new File([q.blob],"voice-comment.webm",{type:"audio/webm"}))],be="voice",Fe=q.duration;else for(const Re of he){const Yt=await Se(Re);Y.push(Yt)}await de({userId:f.id,content:xe,media:Y,replyToId:Ue?.id,type:be,duration:Fe}),je(""),ae([]),Pe(null),V(Re=>({...Re,comments:(Re.comments||0)+1})),y(be==="voice"?"Voice reply posted!":"Reply posted!")}catch(Y){console.error("Failed to post comment:",Y),y("Failed to post reply.")}finally{ne(!1)}}},Te=f?.handle===e.handle,Kt=(F,q)=>{Pe(q?{handle:F,id:m?C||l:q}:null),je(Y=>{const be=`@${F} `;return Y.includes(be)?Y:be+Y}),document.getElementById("comment-input")?.focus()};return g?(0,t.jsxs)(Q.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"flex flex-col",ref:lt,children:[(0,t.jsxs)("article",{className:"p-6 dark:bg-black",children:[(0,t.jsx)($t,{user:e,timeAgo:s,community:w,onUserClick:b,isDetail:!0,showAvatar:!0,isPinned:_,actionsMenu:(0,t.jsx)(Et,{id:l,user:e,isCurrentUser:Te,isComment:m,isPinned:_,onEdit:()=>ie(!0),onDelete:()=>oe(!0),onTogglePin:k,addToast:y,trigger:(0,t.jsx)("button",{"aria-label":"More options",className:"rounded-full p-2 text-zinc-500 transition-colors hover:bg-zinc-100 dark:hover:bg-zinc-800",children:(0,t.jsx)(We,{size:20})})})}),(0,t.jsx)(Pt,{content:r,isDetail:!0,isEditing:ee,editedContent:X,setEditedContent:te,onCancelEdit:()=>{ie(!1),te(r),le(a||[]),O([])},onSaveEdit:at,isUpdating:K,contentClass:i}),R==="voice"&&a?.[0]&&(0,t.jsx)("div",{className:"mt-4 max-w-[300px]",children:(0,t.jsx)(Ct,{url:a[0].url,duration:E||0,isMe:Te})}),Me(r)&&(0,t.jsx)(Mt,{url:Me(r)}),(0,t.jsx)(Tt,{media:a,isEditing:ee,editedMedia:se,setEditedMedia:le,newFiles:ce,setNewFiles:O}),h&&(0,t.jsx)(Ft,{poll:h,onVote:F=>Ts(l,F,f.id)}),o&&(0,t.jsx)("div",{className:"mt-5 overflow-hidden rounded-2xl border border-zinc-200 shadow-sm dark:border-zinc-700",children:(0,t.jsx)(Rt,{...o})}),(0,t.jsx)(St,{views:D.views||0,likes:D.likes||0,comments:D.comments||0,isDetail:!0}),(0,t.jsx)("div",{className:"my-4"}),(0,t.jsx)(_t,{liked:I,reposted:A,handleLike:W,handleRepost:H,handleCommentClick:()=>document.getElementById("comment-input")?.focus(),handleShareClick:()=>Oe(!0),isDetail:!0,isComment:m})]}),Ue&&(0,t.jsxs)("div",{className:"flex items-center justify-between bg-zinc-50 px-5 py-2 dark:bg-zinc-900/50",children:[(0,t.jsxs)("span",{className:"text-sm text-zinc-500",children:["Replying to"," ",(0,t.jsxs)("span",{className:"font-bold text-violet-600",children:["@",Ue.handle]})]}),(0,t.jsx)("button",{onClick:()=>Pe(null),className:"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200",children:(0,t.jsx)($e,{size:16})})]}),(0,t.jsx)(Ht,{currentUser:f,newComment:xe,setNewComment:je,handleSubmitComment:Xt,loading:ue,selectedFiles:he,setSelectedFiles:ae,isUploading:pe}),(0,t.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:[(0,t.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:(0,t.jsxs)(t.Fragment,{children:[U&&$.length>0&&(0,t.jsxs)("button",{onClick:()=>L(),disabled:B,className:"flex w-full items-center justify-center gap-2 py-3 text-sm font-bold text-violet-600 transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[B&&(0,t.jsx)("span",{className:"animate-spin",children:"⌛"}),"View more replies"]}),$.map(F=>(0,t.jsx)(Xe,{...F,isComment:!0,post_id:l,onReply:Kt,onUserClick:b,currentUser:f,stats:{likes:F.stats?.likes||0,comments:F.stats?.comments||0,reposts:F.stats?.reposts||0},timeAgo:F.timeAgo||F.created_at},F.id))]})}),(0,t.jsx)(vt,{open:re,onOpenChange:oe,children:(0,t.jsxs)(pt,{onClick:F=>F.stopPropagation(),children:[(0,t.jsxs)(Nt,{children:[(0,t.jsx)(wt,{children:"Are you absolutely sure?"}),(0,t.jsx)(xt,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,t.jsxs)(yt,{children:[(0,t.jsx)(jt,{onClick:F=>F.stopPropagation(),children:"Cancel"}),(0,t.jsx)(bt,{onClick:nt,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]})]}):(0,t.jsxs)(Q.article,{initial:{opacity:0,y:10},whileInView:{opacity:1,y:0},whileHover:{scale:.995},viewport:{once:!0,margin:"-50px"},transition:{duration:.4,ease:"easeOut"},ref:lt,onClick:c,className:`px-5 transition-all ${m?"py-3 bg-transparent hover:bg-zinc-50/30 dark:hover:bg-zinc-800/20":"py-5 bg-white hover:bg-zinc-50/30 dark:bg-black dark:hover:bg-white/[0.01] active:scale-[0.98]"} ${c?"cursor-pointer":""}`,children:[x&&(0,t.jsxs)("div",{className:"mb-2.5 ml-1 flex items-center space-x-1.5 text-[13px] font-semibold text-zinc-600",children:[(0,t.jsx)(He,{size:14,className:"text-zinc-500"}),(0,t.jsxs)("span",{className:"flex cursor-pointer items-center text-zinc-700 hover:underline dark:text-zinc-300",onClick:F=>{F.stopPropagation(),b&&b(x.handle)},children:[x.handle," Reposted"]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-x-3.5",children:[(0,t.jsxs)("div",{className:"flex shrink-0 flex-col items-center self-stretch pt-0.5",children:[(0,t.jsx)("div",{className:"cursor-pointer",onClick:F=>{F.stopPropagation(),b&&b(e.handle)},children:(0,t.jsxs)(Ne,{className:`${m?"size-8":"size-10"} border-0 shadow-sm`,children:[(0,t.jsx)(ze,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,t.jsx)(we,{className:"text-xs",children:e.handle[0]?.toUpperCase()})]})}),(!m&&D.comments>0||m&&!C&&D.comments>0)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"mt-2 w-0.5 flex-1 rounded-full bg-zinc-100 dark:bg-zinc-800"}),!m&&(0,t.jsx)(Ul,{avatars:N.length>0?N:($||[]).slice(0,3).map(F=>F.user.avatar)})]})]}),(0,t.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col",children:[(0,t.jsx)($t,{user:e,timeAgo:s,community:w,onUserClick:b,isComment:m,isPinned:_,actionsMenu:(0,t.jsx)(Et,{id:l,user:e,isCurrentUser:Te,isComment:m,isPinned:_,onEdit:()=>ie(!0),onDelete:()=>oe(!0),onTogglePin:k,addToast:y,trigger:(0,t.jsx)("button",{"aria-label":"More options",className:"rounded-full p-2 text-zinc-500 transition-colors hover:bg-zinc-100 group-hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:group-hover:bg-zinc-800/50",children:(0,t.jsx)(We,{size:18})})})}),(0,t.jsx)(Pt,{content:r,isEditing:ee,editedContent:X,setEditedContent:te,onCancelEdit:()=>{ie(!1),te(r),le(a||[]),O([])},onSaveEdit:at,isUpdating:K,contentClass:i}),R==="voice"&&a?.[0]&&(0,t.jsx)("div",{className:"mt-3 max-w-[280px]",children:(0,t.jsx)(Ct,{url:a[0].url,duration:E||0,isMe:Te})}),Me(r)&&(0,t.jsx)(Mt,{url:Me(r)}),(0,t.jsx)(Tt,{media:a,isEditing:ee,editedMedia:se,setEditedMedia:le,newFiles:ce,setNewFiles:O}),h&&(0,t.jsx)(Ft,{poll:h}),o&&(0,t.jsx)("div",{className:"mt-3 overflow-hidden rounded-2xl border border-zinc-200 shadow-sm transition-all hover:bg-zinc-50 dark:border-zinc-800 dark:hover:bg-zinc-900",onClick:F=>{F.stopPropagation(),T(`/p/${o.id}`)},children:(0,t.jsx)(Rt,{...o})}),(0,t.jsx)(_t,{liked:I,reposted:A,handleLike:W,handleRepost:H,handleCommentClick:F=>{if(F?.stopPropagation(),j){const q=m&&C||l;j(e.handle,q)}else c&&c()},handleShareClick:F=>{F?.stopPropagation(),Oe(!0)},isComment:m}),(0,t.jsx)(St,{views:D.views||0,likes:D.likes||0,comments:D.comments||0,isComment:m,onRepliesClick:()=>{Ve?tt(!1):Jt()}}),Ve&&(0,t.jsxs)("div",{className:"relative mt-2 space-y-0",children:[(0,t.jsx)("div",{className:"absolute left-[19px] top-0 bottom-4 w-0.5 bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsx)("div",{className:"flex flex-col",children:Gt.map(F=>(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute left-[19px] top-5 h-0.5 w-4 bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsx)("div",{className:"pl-6",children:(0,t.jsx)(Xe,{...F,isComment:!0,post_id:S||l,onReply:j,onUserClick:b,currentUser:f,stats:{likes:F.stats?.likes||0,comments:F.stats?.comments||0,reposts:F.stats?.reposts||0},timeAgo:F.timeAgo||F.created_at})})]},F.id))})]}),(0,t.jsx)(qt,{isOpen:Ce,onClose:()=>Oe(!1),url:Je(l),title:"Share Post",overlayClassName:"z-[9999]"}),(0,t.jsx)(vt,{open:re,onOpenChange:oe,children:(0,t.jsxs)(pt,{onClick:F=>F.stopPropagation(),children:[(0,t.jsxs)(Nt,{children:[(0,t.jsx)(wt,{children:"Are you absolutely sure?"}),(0,t.jsx)(xt,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,t.jsxs)(yt,{children:[(0,t.jsx)(jt,{onClick:F=>F.stopPropagation(),children:"Cancel"}),(0,t.jsx)(bt,{onClick:nt,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]})]})]})};function Vl(l,e){const s=!l.media&&!e.media||l.media?.length===e.media?.length&&l.media?.every((i,a)=>i.url===e.media?.[a].url),r=l.repostedBy?.handle===e.repostedBy?.handle;return l.id===e.id&&l.content===e.content&&l.timeAgo===e.timeAgo&&l.user.id===e.user.id&&l.user.avatar===e.user.avatar&&l.stats.likes===e.stats.likes&&l.stats.comments===e.stats.comments&&l.stats.reposts===e.stats.reposts&&l.currentUser?.id===e.currentUser?.id&&!!s&&!!r}var Bl=z.memo(Xe,Vl);function Wl(l){return l.stopPropagation()}function Hl(l){return l.stopPropagation()}function ql(l){return l.stopPropagation()}function Ql(l){return l.stopPropagation()}var et=null;const Ee=l=>{et=l},Ie=()=>et,ai=()=>{et=null};var Gl=z.memo(({reel:l,isActive:e,volume:s,shouldLoad:r=!0})=>{const{currentUser:i}=Vt(),{addToast:a}=Ke(),{openReport:o}=Bt(),n=(0,z.useRef)(null),[c,x]=(0,z.useState)(!1),[b,f]=(0,z.useState)(!1),[h,g]=(0,z.useState)(!1),[d,v]=(0,z.useState)(!1),[p,m]=(0,z.useState)(null),[j,w]=(0,z.useState)(!1),[C,S]=(0,z.useState)(l.stats?.likes||0),[N,u]=(0,z.useState)(!1),[R,E]=(0,z.useState)(0),[T,y]=(0,z.useState)(!1),P=(0,z.useRef)(null);(0,z.useEffect)(()=>{if(e&&l.id&&!l.id.toString().startsWith("temp-")){const k=setTimeout(()=>{At(l.id).catch(console.error)},1500);return()=>clearTimeout(k)}},[e,l.id]);const _=(0,z.useMemo)(()=>Array.isArray(l.media)?l.media[0]?.src||l.media[0]?.url:l.media?.src||l.media?.url||l.url,[l.media,l.url]);(0,z.useEffect)(()=>{v(!1),y(!1);const k=n.current?.plyr;if(k&&typeof k.on=="function"){const $=()=>v(!0),L=()=>y(!0);k.on("ready",$),k.on("canplay",$),k.on("loadeddata",$),k.on("playing",L);const U=setTimeout(()=>{!T&&e&&y(!0)},3e3);return()=>{clearTimeout(U),typeof k.off=="function"&&(k.off("ready",$),k.off("canplay",$),k.off("loadeddata",$),k.off("playing",L))}}else{const $=setTimeout(()=>{v(!0),e&&y(!0)},1500);return()=>clearTimeout($)}},[_,e]);const M=(0,z.useRef)(null);(0,z.useEffect)(()=>{const k=n.current,$=k?.plyr;if(M.current&&(clearTimeout(M.current),M.current=null),!(!$||!d))return e?M.current=setTimeout(()=>{M.current=null;const L=n.current?.plyr;if(L&&typeof L.play=="function"){const U=Ie();U&&U!==L&&typeof U.pause=="function"&&(U.pause(),typeof U.currentTime<"u"&&(U.currentTime=0)),L.play().catch(()=>{const B=n.current?.plyr;B&&typeof B.play=="function"&&B.play().catch(()=>{})}).then(()=>{Ee(L)})}},50):typeof $.pause=="function"&&($.pause(),typeof $.currentTime<"u"&&($.currentTime=0),Ie()===$&&Ee(null)),()=>{M.current&&(clearTimeout(M.current),M.current=null);const L=k?.plyr;L&&typeof L.pause=="function"&&(L.pause(),typeof L.currentTime<"u"&&(L.currentTime=0),Ie()===L&&Ee(null))}},[e,d]),(0,z.useEffect)(()=>{const k=n.current;return()=>{M.current&&(clearTimeout(M.current),M.current=null);const $=k?.plyr;$&&typeof $.pause=="function"&&($.pause(),$.currentTime=0,Ie()===$&&Ee(null)),v(!1),y(!1),E(0)}},[]),(0,z.useEffect)(()=>{if(!i?.id||!e)return;(async()=>{try{const[$,L]=await Promise.all([ws(i.id,l.id),Bs(i.id,l.user?.id)]);w($),u(L)}catch($){console.error("Failed to check interaction status:",$)}})()},[l.id,i?.id,e,l.user?.id]),(0,z.useEffect)(()=>{const k=n.current?.plyr;k&&e&&(k.muted=s===0,k.volume=s)},[s,d,e]),(0,z.useEffect)(()=>{const k=n.current?.plyr;if(!k||!e)return;const $=()=>{const L=k.currentTime,U=k.duration;U>0&&E(L/U*100)};if(typeof k.on=="function")return k.on("timeupdate",$),()=>{typeof k.off=="function"&&k.off("timeupdate",$)}},[e]);const I=k=>{k.stopPropagation();const $=k.currentTarget.getBoundingClientRect(),L=k.clientX-$.left,U=Math.min(Math.max(0,L/$.width),1),B=n.current?.plyr;B&&B.duration&&(B.currentTime=U*B.duration,E(U*100))};(0,z.useEffect)(()=>()=>{P.current&&clearTimeout(P.current)},[]);const A=k=>{const $=k.target;$.closest("button")||$.closest("a")||$.closest(".plyr__controls")||(P.current?(clearTimeout(P.current),P.current=null,V()):P.current=setTimeout(()=>{P.current=null,D()},250))},D=()=>{const k=n.current?.plyr;k&&(k.paused?(typeof k.play=="function"&&k.play().catch(()=>{}),m("play")):(typeof k.pause=="function"&&k.pause(),m("pause")),setTimeout(()=>m(null),800))},V=async()=>{if(i&&(x(!0),setTimeout(()=>x(!1),800),!j)){w(!0),S(k=>k+1);try{await ht(i.id,l.id)}catch{w(!1),S(k=>k-1)}}},W=async k=>{if(k.stopPropagation(),!i)return;const $=!j;w($),S(L=>$?L+1:L-1);try{await ht(i.id,l.id)}catch{w(!$),S(L=>$?L-1:L+1)}},H=async k=>{if(k.stopPropagation(),!i)return;const $=!N;u($);try{await Ps(i.id,l.user?.id)}catch{u(!$)}},G=k=>{k.stopPropagation(),g(!0)},J=(0,z.useMemo)(()=>({source:{type:"video",sources:[{src:_,type:"video/mp4"}]},options:{controls:[],loop:{active:!0},clickToPlay:!1,ratio:"9:16",autoplay:!1,playsinline:!0,muted:!0}}),[_]);return(0,t.jsxs)("div",{"data-id":l.id,className:"reel-item relative flex h-[100dvh] w-full snap-start items-center justify-center overflow-hidden bg-black cursor-pointer select-none",onClick:A,children:[(0,t.jsxs)("div",{className:"relative flex h-full w-full max-w-[450px] items-center justify-center",children:[(0,t.jsx)("div",{className:"w-full",children:r?(0,t.jsx)(zs,{ref:n,...J}):(0,t.jsx)("div",{className:"aspect-[9/16] w-full bg-zinc-900",children:(0,t.jsx)("img",{src:l.media?.[0]?.preview||l.media?.[0]?.thumbnail||_,className:"h-full w-full object-cover opacity-50 blur-xl",alt:"Reel preview"})})}),!T&&(0,t.jsx)("div",{className:"absolute inset-0 z-[60] flex items-center justify-center bg-zinc-900 pointer-events-none",children:(0,t.jsx)(Ks,{})}),(0,t.jsx)(Qe,{children:c&&(0,t.jsx)(Q.div,{initial:{scale:0,opacity:0},animate:{scale:[0,1.2,1],opacity:1},exit:{scale:1.5,opacity:0},transition:{duration:.5,type:"spring",stiffness:400,damping:20},className:"pointer-events-none absolute inset-0 z-50 flex items-center justify-center",children:(0,t.jsx)(Le,{size:120,fill:"white",className:"text-white drop-shadow-[0_0_30px_rgba(255,255,255,0.4)]"})})}),(0,t.jsx)(Qe,{children:p&&(0,t.jsx)(Q.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},exit:{scale:1.5,opacity:0},transition:{duration:.4},className:"absolute inset-0 z-50 flex items-center justify-center",onClick:k=>{k.stopPropagation(),D()},children:(0,t.jsx)("div",{className:"rounded-full border border-white/20 bg-white/10 p-8 shadow-2xl backdrop-blur-md cursor-pointer hover:bg-white/20 transition-colors",children:p==="play"?(0,t.jsx)(De,{size:50,fill:"white",className:"ml-1.5 text-white"}):(0,t.jsx)(us,{size:50,fill:"white",className:"text-white"})})})}),(0,t.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-black/60"}),(0,t.jsxs)("div",{className:"pointer-events-none absolute bottom-6 left-4 right-16 text-white",children:[(0,t.jsxs)("div",{className:"pointer-events-auto mb-3 flex items-center gap-2",children:[(0,t.jsxs)(Zt,{to:`/u/${l.user?.handle}`,className:"flex items-center gap-2 transition-opacity hover:opacity-80 active:scale-95",onClick:k=>k.stopPropagation(),children:[(0,t.jsxs)(Ne,{className:"size-10 border-2 border-white",children:[(0,t.jsx)(ze,{src:l.user?.avatar,alt:l.user?.handle,className:"object-cover"}),(0,t.jsx)(we,{children:l.user?.handle?.[0]?.toUpperCase()})]}),(0,t.jsxs)("span",{className:"font-bold",children:["@",l.user?.handle]})]}),i?.id!==l.user?.id&&(0,t.jsx)("button",{className:`ml-2 flex items-center gap-1.5 rounded-full px-3 py-1.5 text-xs font-bold transition-all active:scale-95 ${N?"border border-white/50 bg-transparent text-white":"bg-white text-black hover:bg-zinc-200"}`,onClick:H,children:N?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Ls,{size:14}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Following"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Vs,{size:14}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Follow"})]})})]}),(0,t.jsx)(Ye,{content:l.content,className:"mb-3 line-clamp-2 text-sm text-white"}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs opacity-90",children:[(0,t.jsx)(xs,{size:14,className:"animate-spin-slow"}),(0,t.jsxs)("span",{children:["Original Audio - ",l.user?.handle]})]})]}),(0,t.jsxs)("div",{className:"absolute bottom-6 right-2 z-10 flex flex-col items-center gap-6",children:[(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)(Q.button,{whileTap:{scale:.8},className:`rounded-full p-3 backdrop-blur-md transition-all ${j?"bg-rose-500/20 text-rose-500":"bg-zinc-800/50 text-white hover:bg-zinc-700"}`,onClick:W,children:(0,t.jsx)(Q.div,{animate:j?{scale:[1,1.3,1]}:{scale:1},transition:{duration:.3},children:(0,t.jsx)(Le,{size:28,fill:j?"currentColor":"none"})})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:C})]}),(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)(Q.button,{whileTap:{scale:.8},className:"rounded-full bg-zinc-800/50 p-3 text-white backdrop-blur-md transition-colors hover:bg-zinc-700",onClick:k=>{k.stopPropagation(),f(!0)},children:(0,t.jsx)(Wt,{size:28})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:l.stats?.comments||0})]}),(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)(Q.button,{whileTap:{scale:.8},className:"rounded-full bg-zinc-800/50 p-3 text-white backdrop-blur-md transition-colors hover:bg-zinc-700",onClick:G,children:(0,t.jsx)(Ae,{size:28})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:l.stats?.shares||0})]}),(0,t.jsx)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:(0,t.jsx)(Q.button,{whileTap:{scale:.8},className:"rounded-full bg-zinc-800/50 p-3 text-white backdrop-blur-md transition-colors hover:bg-rose-500/20 hover:text-rose-500",onClick:k=>{k.stopPropagation(),o("reel",l.id)},children:(0,t.jsx)(Be,{size:28})})})]}),(0,t.jsx)("div",{className:"absolute bottom-0 left-0 z-50 h-[3px] w-full bg-white/20 hover:h-[8px] transition-all cursor-pointer group",onClick:I,children:(0,t.jsx)("div",{className:"h-full bg-white shadow-[0_0_8px_rgba(255,255,255,0.8)] transition-all duration-100 ease-linear relative",style:{width:`${R}%`},children:(0,t.jsx)("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 size-3 bg-white rounded-full shadow-lg scale-0 group-hover:scale-100 transition-transform"})})})]}),(0,t.jsx)(Xl,{isOpen:b,onClose:()=>f(!1),reelId:l.id,currentUser:i,showToast:a}),(0,t.jsx)(qt,{isOpen:h,onClose:()=>g(!1),url:Ys(l.id),title:"Share Reel",overlayClassName:"z-[9999]"})]})},(l,e)=>l.isActive===e.isActive&&l.reel.id===e.reel.id&&l.volume===e.volume&&l.shouldLoad===e.shouldLoad),ni=Gl,Jl=({isOpen:l,onClose:e,reelId:s,currentUser:r,showToast:i})=>{const[a,o]=(0,z.useState)([]),[n,c]=(0,z.useState)(!1),[x,b]=(0,z.useState)(!1),[f,h]=(0,z.useState)(""),[g,d]=(0,z.useState)([]),[v,p]=(0,z.useState)(!1),[m,j]=(0,z.useState)(!0),[w,C]=(0,z.useState)(!1),[S,N]=(0,z.useState)(null),u=(0,z.useRef)(a);(0,z.useEffect)(()=>{u.current=a},[a]);const R=(0,z.useCallback)(async(T=!1)=>{if(!(!s||s.startsWith("temp-"))){T?C(!0):c(!0);try{const y=u.current,P=await Xs(s,T&&y.length>0?y[y.length-1].created_at:null,10);P.length<10?j(!1):j(!0),o(T?_=>[..._,...P]:P)}catch(y){console.error("Failed to load comments:",y),i&&i("Failed to load comments","error")}finally{c(!1),C(!1)}}},[s,i]);(0,z.useEffect)(()=>{l&&s?R():(o([]),j(!0))},[l,s,R]);const E=async(T,y)=>{if(T?.preventDefault(),!(!f.trim()&&g.length===0&&!y||!r)){b(!0),p(!0);try{let P=[],_="text",M=null;if(y)P=[await Se(new File([y.blob],"voice-comment.webm",{type:"audio/webm"}))],_="voice",M=y.duration;else for(const I of g){const A=await Se(I);P.push(A)}await Rs(s,r.id,f,P,S?.id,_,M),h(""),d([]),N(null),i&&i(_==="voice"?"Voice reply posted!":"Reply posted!"),R()}catch(P){console.error("Failed to post comment:",P),i&&i("Failed to post reply.","error")}finally{b(!1),p(!1)}}};return(0,t.jsx)(Ut,{isOpen:l,onClose:e,title:"Comments",className:"max-sm:h-[95dvh] h-[85vh] overflow-hidden !p-0 sm:max-w-xl",children:(0,t.jsxs)("div",{className:"flex h-full flex-col overflow-hidden bg-white dark:bg-zinc-900",children:[(0,t.jsx)("div",{className:"mx-auto my-3 h-1.5 w-12 shrink-0 rounded-full bg-zinc-200 dark:bg-zinc-800 sm:hidden"}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto scroll-smooth scrollbar-thin scrollbar-thumb-zinc-200 dark:scrollbar-thumb-zinc-800",children:n?(0,t.jsx)("div",{className:"flex flex-col",children:[1,2,3].map(T=>(0,t.jsx)(Fs,{},T))}):a.length>0?(0,t.jsxs)("div",{className:"flex flex-col",children:[a.map(T=>(0,t.jsx)(Bl,{...T,isComment:!0,post_id:s,currentUser:r,showToast:i,onReply:(y,P)=>{N(P?{handle:y,id:P}:null),h(_=>_.includes(`@${y}`)?_:_+`@${y} `)},onDelete:y=>o(P=>P.filter(_=>_.id!==y)),onUpdate:(y,P,_)=>o(M=>M.map(I=>I.id===y?{...I,content:P,media:_}:I))},T.id)),m&&(0,t.jsx)("div",{className:"flex justify-center border-t border-zinc-100 py-4 dark:border-zinc-800",children:(0,t.jsx)(Ot,{variant:"ghost",onClick:()=>R(!0),loading:w,className:"text-violet-600 font-bold",children:"View more replies"})})]}):(0,t.jsxs)("div",{className:"flex h-full min-h-[300px] flex-col items-center justify-center p-8 text-center text-zinc-500",children:[(0,t.jsx)("div",{className:"mb-4 flex size-16 items-center justify-center rounded-full bg-zinc-100 dark:bg-zinc-900",children:(0,t.jsx)(Dt,{size:32,className:"text-zinc-400"})}),(0,t.jsx)("p",{className:"text-lg font-bold dark:text-zinc-300",children:"No comments yet"}),(0,t.jsx)("p",{className:"text-sm dark:text-zinc-500",children:"Be the first to share what you think!"})]})}),(0,t.jsxs)("div",{className:"shrink-0 border-t border-zinc-100 bg-white pb-safe dark:border-zinc-800 dark:bg-zinc-900",children:[S&&(0,t.jsxs)("div",{className:"flex items-center justify-between border-b border-zinc-50 bg-zinc-50/50 px-4 py-2 dark:border-zinc-800/50 dark:bg-zinc-900/50",children:[(0,t.jsxs)("span",{className:"text-xs text-zinc-500",children:["Replying to"," ",(0,t.jsxs)("span",{className:"font-bold text-violet-600",children:["@",S.handle]})]}),(0,t.jsx)("button",{onClick:()=>N(null),className:"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200",children:(0,t.jsx)($e,{size:14})})]}),(0,t.jsx)(Ht,{currentUser:r,newComment:f,setNewComment:h,handleSubmitComment:E,loading:x,selectedFiles:g,setSelectedFiles:d,isUploading:v})]})]})})},Xl=Jl;export{ai as n,Bl as r,ni as t};
