const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/VoiceMessage-CeLDxLJ3.js","assets/framework-CsA6nn9m.js","assets/rolldown-runtime-BaZ8gS7u.js","assets/framework-sg0yWRLc.css","assets/ui-libs-ChWz9FXZ.js","assets/media-libs-Btb8RX-I.js","assets/media-libs-CqCaMccn.css","assets/VoiceMessage-_O3lnEZE.js","assets/index-D-CoZiVy.js","assets/database-BiY55TQY.js","assets/query-QyXblnmD.js","assets/animations-T0TOZv2c.js","assets/index-CIF-5yfD.css"])))=>i.map(i=>d[i]);
import{a as ze}from"./rolldown-runtime-BaZ8gS7u.js";import{C as we,E as Se,b as Ce,c as ne,d as _e}from"./framework-CsA6nn9m.js";import"./database-BiY55TQY.js";import{$t as ye,Bn as Me,Bt as ue,Ft as fe,Gt as Te,Ot as Re,Ut as pe,Wt as $e,Zt as he,bn as Ne,er as Ge,fn as Oe,in as Ie,kt as ge,mn as Ae,nn as be,sn as Ee,sr as Pe,tr as Ue}from"./ui-libs-ChWz9FXZ.js";import"./media-libs-Btb8RX-I.js";import{a as Le,i as oe,n as ve,r as De}from"./animations-T0TOZv2c.js";import{$ as Ve,B as Fe,F as Be,K as He,V as qe,_t as We,at as de,dn as je,et as Ye,fn as I,it as xe,n as Ke,nt as Ze,ot as me,r as Je,rt as Xe,t as Qe,tt as ce,v as et,x as tt,z as st}from"./index-D-CoZiVy.js";import"./VoiceMessage-_O3lnEZE.js";import{t as it}from"./VideoPlayer-BFZDXF7B.js";import{t as lt}from"./text-processing-DFvQvkgt.js";import{t as at}from"./linkify-BIniK2-v.js";import{a as rt,d as nt,f as ot}from"./hooks-C5V4Qbg5.js";var ct=ne(),O=ze(Se(),1),t=ze(_e(),1),dt=i=>{const e=(0,ct.c)(67),{conv:s,selectedId:a,onSelect:g,onlineUsers:n,isTyping:m}=i;let u;e[0]!==s.isGroup||e[1]!==s.user||e[2]!==n?(u=!s.isGroup&&s.user?n.has(s.user.id):!1,e[0]=s.isGroup,e[1]=s.user,e[2]=n,e[3]=u):u=e[3];const c=u,o=a===s.id,v=s.unread>0,r=s.isGroup?s.name:s.user?.name,z=s.isGroup?s.avatar:s.user?.avatar;let p;e[4]!==s||e[5]!==g?(p=()=>g(s),e[4]=s,e[5]=g,e[6]=p):p=e[6];const T=o?"bg-violet-600 dark:bg-violet-600":"hover:bg-zinc-100 dark:hover:bg-zinc-900/80";let w;e[7]!==T?(w=I("group relative flex cursor-pointer items-center gap-[10px] py-2 px-3 transition-all duration-150 rounded-xl",T),e[7]=T,e[8]=w):w=e[8];const l=o?"opacity-90":"opacity-100";let b;e[9]!==l?(b=I("size-[54px] border-0 transition-all",l),e[9]=l,e[10]=b):b=e[10];const C=r||"";let y;e[11]!==z||e[12]!==C?(y=(0,t.jsx)(me,{src:z,alt:C,className:"object-cover"}),e[11]=z,e[12]=C,e[13]=y):y=e[13];let S;e[14]!==r?.[0]?(S=r?.[0]?.toUpperCase(),e[14]=r?.[0],e[15]=S):S=e[15];let N;e[16]!==S?(N=(0,t.jsx)(de,{className:"bg-gradient-to-br from-violet-100 to-violet-200 text-violet-700 font-bold text-xl dark:from-zinc-800 dark:to-zinc-700 dark:text-zinc-300",children:S}),e[16]=S,e[17]=N):N=e[17];let _;e[18]!==N||e[19]!==b||e[20]!==y?(_=(0,t.jsxs)(xe,{className:b,children:[y,N]}),e[18]=N,e[19]=b,e[20]=y,e[21]=_):_=e[21];let M;e[22]!==c||e[23]!==o?(M=c&&!o&&(0,t.jsx)("span",{className:"absolute bottom-0.5 right-0.5 size-3.5 rounded-full border-[2.5px] border-white bg-emerald-500 ring-0 dark:border-black"}),e[22]=c,e[23]=o,e[24]=M):M=e[24];let x;e[25]!==_||e[26]!==M?(x=(0,t.jsxs)("div",{className:"relative shrink-0",children:[_,M]}),e[25]=_,e[26]=M,e[27]=x):x=e[27];const d=o?"text-white":"text-zinc-900 dark:text-zinc-100";let h;e[28]!==d?(h=I("truncate text-[16px] font-bold tracking-tight leading-tight",d),e[28]=d,e[29]=h):h=e[29];let j;e[30]!==s.isMuted?(j=s.isMuted&&(0,t.jsx)("span",{className:"ml-1 text-zinc-400 dark:text-zinc-500",children:"î§º"}),e[30]=s.isMuted,e[31]=j):j=e[31];let k;e[32]!==r||e[33]!==h||e[34]!==j?(k=(0,t.jsxs)("span",{className:h,children:[r,j]}),e[32]=r,e[33]=h,e[34]=j,e[35]=k):k=e[35];const $=o?"text-white/80":"text-zinc-400 dark:text-zinc-500";let f;e[36]!==$?(f=I("shrink-0 text-[12px] font-medium ml-2",$),e[36]=$,e[37]=f):f=e[37];let G;e[38]!==s.time||e[39]!==f?(G=(0,t.jsx)("span",{className:f,children:s.time}),e[38]=s.time,e[39]=f,e[40]=G):G=e[40];let L;e[41]!==k||e[42]!==G?(L=(0,t.jsxs)("div",{className:"flex items-center justify-between gap-1",children:[k,G]}),e[41]=k,e[42]=G,e[43]=L):L=e[43];let A;e[44]!==s.currentUserSent||e[45]!==s.isGroup||e[46]!==s.lastMessage||e[47]!==s.lastMessageSender||e[48]!==v||e[49]!==o||e[50]!==m?(A=m?(0,t.jsx)("p",{className:I("truncate text-[14px] leading-relaxed flex-1 italic animate-pulse",o?"text-white/90":"text-violet-500 dark:text-violet-400 font-medium"),children:"typing..."}):(0,t.jsxs)("p",{className:I("truncate text-[14px] leading-relaxed flex-1",o?"text-white/90":v?"text-zinc-900 font-medium dark:text-zinc-200":"text-zinc-500 dark:text-zinc-400"),children:[s.isGroup&&s.lastMessageSender&&(0,t.jsxs)("span",{className:I("font-semibold mr-1",o?"text-white":"text-violet-500 dark:text-violet-400"),children:[s.lastMessageSender,":"]}),s.currentUserSent&&!s.lastMessageSender&&"You: ",s.lastMessage]}),e[44]=s.currentUserSent,e[45]=s.isGroup,e[46]=s.lastMessage,e[47]=s.lastMessageSender,e[48]=v,e[49]=o,e[50]=m,e[51]=A):A=e[51];let D;e[52]!==s.unread||e[53]!==v||e[54]!==o?(D=v&&(0,t.jsx)("span",{className:I("flex min-w-[20px] h-[20px] px-1.5 items-center justify-center rounded-full text-[11px] font-bold shadow-sm",o?"bg-white text-violet-600":"bg-violet-600 text-white dark:bg-violet-500"),children:s.unread}),e[52]=s.unread,e[53]=v,e[54]=o,e[55]=D):D=e[55];let E;e[56]!==A||e[57]!==D?(E=(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2 mt-0.5",children:[A,D]}),e[56]=A,e[57]=D,e[58]=E):E=e[58];let P;e[59]!==L||e[60]!==E?(P=(0,t.jsxs)("div",{className:"min-w-0 flex-1 flex flex-col justify-center py-1",children:[L,E]}),e[59]=L,e[60]=E,e[61]=P):P=e[61];let V;return e[62]!==x||e[63]!==p||e[64]!==P||e[65]!==w?(V=(0,t.jsxs)("div",{onClick:p,className:w,children:[x,P]}),e[62]=x,e[63]=p,e[64]=P,e[65]=w,e[66]=V):V=e[66],V},xt=({conversations:i,userResults:e=[],onSelect:s,onStartNew:a,selectedId:g,searchQuery:n,onSearchChange:m,onlineUsers:u=new Set,typingStatus:c={}})=>{const[o,v]=(0,O.useState)(!1),[r,z]=(0,O.useState)("all"),p=i.filter(l=>u.has(l.user?.id)),T=i.filter(l=>r==="unread"?l.unread>0:r==="groups"?l.isGroup:!0),w=[{id:"all",label:"All"},{id:"unread",label:"Unread",count:i.filter(l=>l.unread>0).length},{id:"groups",label:"Groups"}];return(0,t.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col overflow-hidden bg-white dark:bg-[#0f0f0f] h-full shadow-inner",children:[(0,t.jsxs)("div",{className:"px-4 md:px-4 pt-4 pb-2 shrink-0 w-full overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,t.jsxs)("div",{className:"relative flex-1 group min-w-0",children:[(0,t.jsx)(he,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-zinc-400 group-focus-within:text-violet-500 transition-colors",size:18}),(0,t.jsx)("input",{type:"text",value:n,onChange:l=>m(l.target.value),placeholder:"Search",className:"w-full rounded-full border-none bg-zinc-100 py-2.5 pl-11 pr-4 text-sm font-medium text-zinc-900 placeholder:text-zinc-500 transition-all focus:bg-white focus:ring-2 focus:ring-violet-500/20 dark:bg-zinc-900 dark:text-white dark:focus:bg-black"})]}),(0,t.jsx)("button",{onClick:()=>v(!0),className:"shrink-0 rounded-full bg-zinc-100 p-2.5 text-zinc-600 transition-colors hover:bg-zinc-200 dark:bg-zinc-900 dark:text-zinc-400 dark:hover:bg-zinc-800",children:(0,t.jsx)($e,{size:20})})]}),(0,t.jsx)("div",{className:"flex items-center gap-1 border-b border-zinc-100 dark:border-zinc-800 mb-1",children:w.map(l=>(0,t.jsxs)("button",{onClick:()=>z(l.id),className:I("relative flex items-center px-4 py-2.5 text-[13px] font-bold transition-all",r===l.id?"text-violet-600 dark:text-violet-400":"text-zinc-500 hover:text-zinc-700 dark:text-zinc-400 dark:hover:text-zinc-200"),children:[l.label,l.count?(0,t.jsx)("span",{className:"ml-1.5 flex size-4 items-center justify-center rounded-full bg-violet-600/10 text-[9px] dark:bg-violet-400/10",children:l.count}):null,r===l.id&&(0,t.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-[3px] bg-violet-600 dark:bg-violet-400 rounded-t-full"})]},l.id))})]}),(0,t.jsx)("div",{className:"flex-1 min-h-0 overflow-hidden",children:(0,t.jsx)(Be,{className:"h-full min-w-0",children:(0,t.jsxs)("div",{className:"flex flex-col pb-4 min-w-0",children:[!n&&r==="all"&&p.length>0&&(0,t.jsx)("div",{className:"mb-4 mt-2 min-w-0 w-full overflow-hidden",children:(0,t.jsxs)("div",{className:"flex gap-4 overflow-x-auto px-4 md:px-5 pb-4 pt-2 no-scrollbar w-full",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2 min-w-[64px] cursor-pointer group",children:[(0,t.jsxs)("div",{className:"relative flex size-[60px] items-center justify-center rounded-full bg-zinc-50 border border-zinc-200 dark:bg-zinc-900 dark:border-zinc-800 group-hover:bg-zinc-100 dark:group-hover:bg-zinc-800 transition-colors",children:[(0,t.jsx)(fe,{size:24,className:"text-zinc-400"}),(0,t.jsx)("div",{className:"absolute bottom-0 right-0 size-5 bg-white dark:bg-black rounded-full flex items-center justify-center",children:(0,t.jsx)("div",{className:"size-4 bg-zinc-200 dark:bg-zinc-700 rounded-full flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-[10px] text-zinc-500 font-bold",children:"+"})})})]}),(0,t.jsx)("span",{className:"text-[11px] font-medium text-zinc-500",children:"Your Story"})]}),p.map(l=>(0,t.jsxs)("div",{onClick:()=>s(l),className:"flex flex-col items-center gap-2 cursor-pointer group min-w-[64px] transition-transform active:scale-95",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute -inset-[3px] rounded-full bg-gradient-to-tr from-violet-500 via-fuchsia-500 to-orange-500 opacity-90 p-[2px]"}),(0,t.jsx)("div",{className:"relative rounded-full border-[3px] border-white dark:border-black p-[2px] bg-white dark:bg-black",children:(0,t.jsxs)(xe,{className:"size-[50px]",children:[(0,t.jsx)(me,{src:l.user?.avatar,className:"object-cover"}),(0,t.jsx)(de,{children:l.user?.name?.[0]})]})}),(0,t.jsx)("span",{className:"absolute bottom-1 right-1 size-3.5 rounded-full border-[2.5px] border-white bg-emerald-500 dark:border-black"})]}),(0,t.jsx)("span",{className:"w-full truncate text-center text-[11px] font-medium text-zinc-600 dark:text-zinc-400 group-hover:text-zinc-900 dark:group-hover:text-white transition-colors",children:l.user?.name.split(" ")[0]})]},l.id))]})}),(0,t.jsx)("div",{className:"px-2 space-y-0.5 mt-2",children:T.length>0&&T.filter(l=>l.lastMessage!=="No messages yet"||l.id===g||n).map(l=>(0,t.jsx)(dt,{conv:l,selectedId:g,onSelect:s,onlineUsers:u,isTyping:c[l.id]},l.id))}),e.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"px-6 py-3 mt-2 text-xs font-bold uppercase tracking-wider text-zinc-400",children:"More People"}),(0,t.jsx)("div",{className:"px-2 space-y-1",children:e.map(l=>(0,t.jsxs)("div",{onClick:()=>a(l),className:"flex cursor-pointer items-center gap-4 px-3 py-2 rounded-2xl transition-colors hover:bg-zinc-100 dark:hover:bg-zinc-800/50",children:[(0,t.jsxs)(xe,{className:"size-10",children:[(0,t.jsx)(me,{src:l.avatar,className:"object-cover"}),(0,t.jsx)(de,{children:l.name?.[0]?.toUpperCase()})]}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("div",{className:"truncate text-sm font-bold text-zinc-900 dark:text-white",children:l.name}),(0,t.jsxs)("div",{className:"truncate text-xs text-zinc-500",children:["@",l.handle]})]}),(0,t.jsx)("button",{className:"flex size-8 items-center justify-center rounded-full bg-violet-50 text-violet-600 dark:bg-violet-900/20 dark:text-violet-400",children:(0,t.jsx)(fe,{size:16})})]},l.id))})]}),i.length===0&&e.length===0&&n&&(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center px-6",children:[(0,t.jsx)("div",{className:"mb-4 rounded-full bg-zinc-100 p-4 dark:bg-zinc-900",children:(0,t.jsx)(he,{className:"text-zinc-400",size:24})}),(0,t.jsxs)("p",{className:"text-zinc-500",children:['No results found for "',n,'"']})]})]})})}),(0,t.jsx)(Je,{isOpen:o,onClose:()=>v(!1),onCreated:l=>{s({id:l,isGroup:!0})}})]})},mt=xt,ut=ne(),ft=i=>{const e=(0,ut.c)(45),{conversation:s,isOnline:a,onBack:g,onOpenSettings:n}=i,m=Ce(),u=ot(s.user?.lastSeen),c=s.isGroup?s.name:s.user?.name,o=s.isGroup?s.avatar:s.user?.avatar;let v;e[0]===Symbol.for("react.memo_cache_sentinel")?(v=(0,t.jsx)(Pe,{size:24}),e[0]=v):v=e[0];let r;e[1]!==s.unread?(r=s.unread>0&&(0,t.jsx)("span",{className:"absolute -top-1 -right-1 flex h-5 min-w-[20px] items-center justify-center rounded-full bg-violet-500 px-1 text-[11px] font-bold text-white ring-2 ring-white dark:ring-[#212121]",children:s.unread}),e[1]=s.unread,e[2]=r):r=e[2];let z;e[3]!==g||e[4]!==r?(z=(0,t.jsxs)("button",{onClick:g,className:"relative flex items-center justify-center size-11 rounded-full text-zinc-500 transition-colors hover:bg-zinc-100 dark:text-zinc-400 dark:hover:bg-white/5 md:hidden",children:[v,r]}),e[3]=g,e[4]=r,e[5]=z):z=e[5];let p;e[6]!==s.isGroup||e[7]!==s.user||e[8]!==m?(p=()=>!s.isGroup&&s.user&&m(`/u/${s.user.handle}`),e[6]=s.isGroup,e[7]=s.user,e[8]=m,e[9]=p):p=e[9];const T=c||"";let w;e[10]!==o||e[11]!==T?(w=(0,t.jsx)(me,{src:o,alt:T,className:"object-cover"}),e[10]=o,e[11]=T,e[12]=w):w=e[12];let l;e[13]!==c?.[0]?(l=c?.[0]?.toUpperCase(),e[13]=c?.[0],e[14]=l):l=e[14];let b;e[15]!==l?(b=(0,t.jsx)(de,{className:"bg-gradient-to-br from-violet-100 to-violet-200 text-violet-700 font-bold dark:from-zinc-800 dark:to-zinc-700 dark:text-zinc-300",children:l}),e[15]=l,e[16]=b):b=e[16];let C;e[17]!==w||e[18]!==b?(C=(0,t.jsxs)(xe,{className:"size-[42px] shrink-0",children:[w,b]}),e[17]=w,e[18]=b,e[19]=C):C=e[19];let y;e[20]!==c?(y=(0,t.jsx)("h3",{className:"text-[16px] font-bold text-zinc-900 dark:text-white truncate leading-tight",children:c}),e[20]=c,e[21]=y):y=e[21];let S;e[22]!==s.isGroup||e[23]!==s.user?.lastSeen||e[24]!==a||e[25]!==u?(S=s.isGroup?"Group Chat":a?(0,t.jsx)("span",{className:"text-violet-500 dark:text-[#8774e1]",children:"Active now"}):s.user?.lastSeen?`last seen ${u}`:"offline",e[22]=s.isGroup,e[23]=s.user?.lastSeen,e[24]=a,e[25]=u,e[26]=S):S=e[26];let N;e[27]!==S?(N=(0,t.jsx)("span",{className:"text-[13px] text-zinc-500 dark:text-[#aaaaaa] leading-tight",children:S}),e[27]=S,e[28]=N):N=e[28];let _;e[29]!==y||e[30]!==N?(_=(0,t.jsxs)("div",{className:"flex flex-col min-w-0",children:[y,N]}),e[29]=y,e[30]=N,e[31]=_):_=e[31];let M;e[32]!==_||e[33]!==p||e[34]!==C?(M=(0,t.jsxs)("div",{className:"flex items-center gap-3 px-2 flex-1 min-w-0 cursor-pointer",onClick:p,children:[C,_]}),e[32]=_,e[33]=p,e[34]=C,e[35]=M):M=e[35];let x;e[36]!==M||e[37]!==z?(x=(0,t.jsxs)("div",{className:"flex items-center gap-1 w-full max-w-full",children:[z,M]}),e[36]=M,e[37]=z,e[38]=x):x=e[38];let d;e[39]===Symbol.for("react.memo_cache_sentinel")?(d=(0,t.jsx)(Me,{size:22}),e[39]=d):d=e[39];let h;e[40]!==n?(h=(0,t.jsx)("div",{className:"flex items-center gap-0.5 pr-1",children:(0,t.jsx)("button",{onClick:n,className:"flex size-10 items-center justify-center rounded-full text-zinc-500 hover:bg-zinc-100 dark:text-[#aaaaaa] dark:hover:bg-white/5 transition-colors",children:d})}),e[40]=n,e[41]=h):h=e[41];let j;return e[42]!==x||e[43]!==h?(j=(0,t.jsxs)("div",{className:"sticky top-0 z-40 flex shrink-0 items-center justify-between bg-white/95 px-2 py-1.5 backdrop-blur-md dark:bg-[#212121]/95 transition-all h-[56px]",children:[x,h]}),e[42]=x,e[43]=h,e[44]=j):j=e[44],j},pt=ft,ht=ne();const gt=(i,e,s)=>{const a=(0,ht.c)(7),g=e===void 0?40:e,n=s===void 0?120:s,m=(0,O.useRef)(null);let u;a[0]!==n||a[1]!==g?(u=()=>{const o=m.current;if(o){o.style.height="auto";const v=o.scrollHeight;o.style.height=`${Math.min(Math.max(v,g),n)}px`}},a[0]=n,a[1]=g,a[2]=u):u=a[2];let c;return a[3]!==n||a[4]!==g||a[5]!==i?(c=[i,g,n],a[3]=n,a[4]=g,a[5]=i,a[6]=c):c=a[6],(0,O.useEffect)(u,c),m};var bt=ne(),vt=i=>{const e=(0,bt.c)(68),{onSendMessage:s,onTyping:a,replyingTo:g,setReplyingTo:n,editingMessage:m,setEditingMessage:u}=i,[c,o]=(0,O.useState)("");let v;e[0]===Symbol.for("react.memo_cache_sentinel")?(v=[],e[0]=v):v=e[0];const[r,z]=(0,O.useState)(v),[p,T]=(0,O.useState)(!1),w=(0,O.useRef)(null),l=(0,O.useRef)(null),b=gt(c);let C,y;e[1]!==m||e[2]!==n||e[3]!==b?(C=()=>{m&&(o(m.text),n(null),b.current&&b.current.focus())},y=[m,n,b],e[1]=m,e[2]=n,e[3]=b,e[4]=C,e[5]=y):(C=e[4],y=e[5]),O.useEffect(C,y);const{isRecording:S,recordingTime:N,startRecording:_,stopRecording:M,cancelRecording:x,audioBlob:d,audioUrl:h,clearAudio:j}=nt(),[k,$]=(0,O.useState)(!1),f=(0,O.useRef)(null),G=zt,L=(0,O.useRef)(0);let A;e[6]!==a?(A=R=>{const Z=R.target.value;if(o(Z),a){const U=Date.now();U-L.current>3e3&&(a(!0),L.current=U),l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{a(!1),L.current=0},2e3)}},e[6]=a,e[7]=A):A=e[7];const D=A;let E;e[8]!==r||e[9]!==d||e[10]!==j||e[11]!==s||e[12]!==a||e[13]!==N||e[14]!==n||e[15]!==c||e[16]!==b?(E=R=>{if(R&&R.preventDefault(),d){s("",[],d,N),j();return}!c.trim()&&r.length===0||(a&&(l.current&&clearTimeout(l.current),a(!1)),s(c,r),o(""),z([]),n(null),setTimeout(()=>{b.current?.focus()},10))},e[8]=r,e[9]=d,e[10]=j,e[11]=s,e[12]=a,e[13]=N,e[14]=n,e[15]=c,e[16]=b,e[17]=E):E=e[17];const P=E;let V;e[18]!==h||e[19]!==k?(V=()=>{h&&(f.current||(f.current=new Audio(h),f.current.onended=()=>$(!1)),k?f.current.pause():f.current.play(),$(!k))},e[18]=h,e[19]=k,e[20]=V):V=e[20];const ie=V;let J,X;e[21]!==d?(J=()=>{!d&&f.current&&(f.current.pause(),f.current=null,$(!1))},X=[d],e[21]=d,e[22]=J,e[23]=X):(J=e[22],X=e[23]),O.useEffect(J,X);let Q;e[24]===Symbol.for("react.memo_cache_sentinel")?(Q=R=>{if(!R.target.files)return;const Z=Array.from(R.target.files);z(U=>[...U,...Z])},e[24]=Q):Q=e[24];const ae=Q;let F;e[25]!==r?(F=r.length>0&&(0,t.jsx)(oe.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},exit:{y:20,opacity:0},className:"flex gap-2 overflow-x-auto mx-auto mb-2 px-2 py-2 bg-white dark:bg-[#212121] rounded-2xl shadow-lg border border-zinc-100 dark:border-zinc-800 max-w-3xl no-scrollbar",children:r.map((R,Z)=>(0,t.jsxs)("div",{className:"relative size-20 shrink-0 rounded-xl overflow-hidden border border-zinc-200 dark:border-zinc-700 group",children:[R.type.startsWith("video/")?(0,t.jsx)("div",{className:"size-full bg-black flex items-center justify-center",children:(0,t.jsx)(be,{size:20,className:"text-white opacity-50"})}):(0,t.jsx)("img",{src:URL.createObjectURL(R),className:"size-full object-cover"}),(0,t.jsx)("button",{type:"button",onClick:()=>z(U=>U.filter((re,ke)=>ke!==Z)),className:"absolute top-1 right-1 size-6 flex items-center justify-center rounded-full bg-black/50 text-white hover:bg-black/70 transition-colors",children:(0,t.jsx)(ge,{size:14})})]},Z))}),e[25]=r,e[26]=F):F=e[26];let B;e[27]!==m||e[28]!==g||e[29]!==u||e[30]!==n?(B=(g||m)&&(0,t.jsxs)(oe.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},exit:{y:20,opacity:0},className:"flex items-center justify-between mx-auto mb-1.5 px-4 py-2 bg-white dark:bg-[#212121] rounded-2xl shadow-lg border border-zinc-100 dark:border-zinc-800 max-w-3xl",children:[(0,t.jsxs)("div",{className:"text-sm flex items-center gap-3 min-w-0",children:[(0,t.jsx)("div",{className:"size-8 flex items-center justify-center rounded-full bg-violet-500/10 text-violet-500",children:m?(0,t.jsx)(Ie,{size:16}):(0,t.jsx)(ye,{size:16})}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("span",{className:"text-[13px] font-bold text-violet-500 block leading-tight",children:m?"Edit Message":`Reply to ${g.sender==="me"?"yourself":g.senderName}`}),(0,t.jsx)("p",{className:"truncate text-xs text-zinc-500 dark:text-[#aaaaaa]",children:m?m.text:g.text})]})]}),(0,t.jsx)("button",{onClick:()=>{n(null),u(null),m&&o("")},className:"p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-white/10",children:(0,t.jsx)(ge,{size:18,className:"text-zinc-400"})})]}),e[27]=m,e[28]=g,e[29]=u,e[30]=n,e[31]=B):B=e[31];let H;e[32]!==F||e[33]!==B?(H=(0,t.jsxs)(Le,{children:[F,B]}),e[32]=F,e[33]=B,e[34]=H):H=e[34];const le=(S||d)&&"bg-zinc-900 ring-red-500/50";let q;e[35]!==le?(q=I("flex-1 flex items-center gap-1 rounded-[24px] px-1.5 py-1.5 transition-all bg-white dark:bg-[#212121] shadow-md border-0 ring-1 ring-zinc-200 dark:ring-zinc-800 focus-within:ring-violet-500/30",le),e[35]=le,e[36]=q):q=e[36];let ee;e[37]!==d||e[38]!==x||e[39]!==j||e[40]!==P||e[41]!==D||e[42]!==p||e[43]!==k||e[44]!==S||e[45]!==N||e[46]!==c||e[47]!==b||e[48]!==ie?(ee=S?(0,t.jsxs)("div",{className:"flex-1 flex items-center gap-4 px-3 py-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(oe.div,{animate:{scale:[1,1.2,1]},transition:{repeat:1/0},className:"size-2 rounded-full bg-red-500"}),(0,t.jsx)("span",{className:"text-[15px] font-medium tabular-nums text-red-500",children:G(N)})]}),(0,t.jsx)("div",{className:"flex-1 text-center text-sm text-zinc-500",children:"Recording..."}),(0,t.jsx)("button",{type:"button",onClick:x,className:"p-2 text-zinc-400 hover:text-red-500",children:(0,t.jsx)(ue,{size:20})})]}):d?(0,t.jsxs)("div",{className:"flex-1 flex items-center gap-3 px-3 py-1",children:[(0,t.jsx)("button",{type:"button",onClick:ie,className:"size-10 flex items-center justify-center rounded-full bg-[#8774e1] text-white",children:k?(0,t.jsx)(pe,{size:16,fill:"currentColor"}):(0,t.jsx)(be,{size:20,fill:"currentColor",className:"ml-0.5"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"h-1 bg-zinc-800 rounded-full overflow-hidden",children:(0,t.jsx)(oe.div,{initial:{width:0},animate:{width:k?"100%":"0%"},transition:{duration:N,ease:"linear"},className:"h-full bg-[#8774e1]"})}),(0,t.jsxs)("div",{className:"flex justify-between mt-1",children:[(0,t.jsx)("span",{className:"text-[10px] text-zinc-500",children:"Voice message"}),(0,t.jsx)("span",{className:"text-[10px] text-zinc-500 tabular-nums",children:G(N)})]})]}),(0,t.jsx)("button",{type:"button",onClick:j,className:"p-2 text-zinc-400 hover:text-red-500",children:(0,t.jsx)(ue,{size:20})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(st,{open:p,onOpenChange:T,children:[(0,t.jsx)(qe,{asChild:!0,children:(0,t.jsx)("button",{type:"button",className:"p-2 text-zinc-400 hover:text-violet-500 dark:text-[#aaaaaa] dark:hover:text-[#8774e1] transition-colors",children:(0,t.jsx)(Te,{size:24})})}),(0,t.jsx)(Fe,{className:"p-0 border-none bg-transparent",side:"top",align:"start",children:(0,t.jsx)(He,{onEmojiSelect:R=>o(Z=>Z+R.emoji)})})]}),(0,t.jsx)("textarea",{ref:b,value:c,onChange:D,onKeyDown:R=>{R.key==="Enter"&&!R.shiftKey&&(R.preventDefault(),P())},placeholder:"Message",className:"flex-1 bg-transparent border-none outline-none text-[16px] resize-none py-2 px-1 text-zinc-900 dark:text-white placeholder:text-zinc-500 dark:placeholder:text-[#aaaaaa] min-h-[40px] max-h-[200px]",rows:1}),(0,t.jsx)("button",{type:"button",onClick:()=>w.current?.click(),className:"p-2 text-zinc-400 hover:text-violet-500 dark:text-[#aaaaaa] dark:hover:text-[#8774e1] transition-colors",children:(0,t.jsx)(Ee,{size:24,className:"-rotate-45"})})]}),e[37]=d,e[38]=x,e[39]=j,e[40]=P,e[41]=D,e[42]=p,e[43]=k,e[44]=S,e[45]=N,e[46]=c,e[47]=b,e[48]=ie,e[49]=ee):ee=e[49];let W;e[50]!==q||e[51]!==ee?(W=(0,t.jsx)("div",{className:q,children:ee}),e[50]=q,e[51]=ee,e[52]=W):W=e[52];let Y;e[53]!==r.length||e[54]!==d||e[55]!==P||e[56]!==S||e[57]!==_||e[58]!==M||e[59]!==c?(Y=c.trim()||r.length>0||d?(0,t.jsx)("button",{onClick:P,className:"size-[50px] shrink-0 flex items-center justify-center rounded-full bg-[#8774e1] text-white shadow-md hover:scale-105 transition-transform",children:(0,t.jsx)(et,{size:24})}):S?(0,t.jsx)("button",{onClick:M,className:"size-[50px] shrink-0 flex items-center justify-center rounded-full bg-red-500 text-white shadow-md hover:scale-105 transition-transform",children:(0,t.jsx)(pe,{size:20,fill:"currentColor"})}):(0,t.jsx)("button",{onClick:_,className:"size-[50px] shrink-0 flex items-center justify-center rounded-full bg-zinc-200 dark:bg-[#212121] text-zinc-500 dark:text-[#aaaaaa] shadow-md hover:scale-105 transition-transform",children:(0,t.jsx)(Oe,{size:24})}),e[53]=r.length,e[54]=d,e[55]=P,e[56]=S,e[57]=_,e[58]=M,e[59]=c,e[60]=Y):Y=e[60];let K;e[61]!==W||e[62]!==Y?(K=(0,t.jsxs)("div",{className:"flex items-end gap-2 max-w-3xl mx-auto",children:[W,Y]}),e[61]=W,e[62]=Y,e[63]=K):K=e[63];let te;e[64]===Symbol.for("react.memo_cache_sentinel")?(te=(0,t.jsx)("input",{type:"file",ref:w,onChange:ae,className:"hidden",multiple:!0,accept:"image/*,video/*"}),e[64]=te):te=e[64];let se;return e[65]!==H||e[66]!==K?(se=(0,t.jsxs)("div",{className:"shrink-0 p-2 md:p-3 relative z-20",children:[H,K,te]}),e[65]=H,e[66]=K,e[67]=se):se=e[67],se},jt=vt;function zt(i){return`${Math.floor(i/60)}:${(i%60).toString().padStart(2,"0")}`}var Bt=ne(),yt=ne(),Nt=i=>{const e=(0,yt.c)(10),{reactions:s,currentUser:a,onToggle:g}=i;let n;e[0]!==s?(n=s===void 0?[]:s,e[0]=s,e[1]=n):n=e[1];const m=n;let u;e[2]!==a?.id||e[3]!==m?(u={},m.forEach(r=>{u[r.emoji]||(u[r.emoji]={count:0,me:!1}),u[r.emoji].count=u[r.emoji].count+1,r.user_id===a?.id&&(u[r.emoji].me=!0)}),e[2]=a?.id,e[3]=m,e[4]=u):u=e[4];const c=u;if(m.length===0)return null;let o;e[5]!==c?(o=Object.entries(c),e[5]=c,e[6]=o):o=e[6];let v;return e[7]!==g||e[8]!==o?(v=(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:o.map(r=>{const[z,p]=r;return(0,t.jsxs)("button",{onClick:T=>{T.stopPropagation(),g(z)},className:I("pointer-events-auto flex items-center gap-1 rounded-full border px-1.5 py-0.5 text-[11px] font-bold shadow-sm transition-all hover:scale-110 active:scale-90",p.me?"bg-violet-50 border-violet-200 text-violet-600 dark:bg-violet-900/30 dark:border-violet-800 dark:text-violet-400":"bg-white border-zinc-100 text-zinc-700 dark:bg-zinc-800 dark:border-zinc-700 dark:text-zinc-300"),children:[(0,t.jsx)("span",{className:"leading-none",children:z}),p.count>1&&(0,t.jsx)("span",{className:"text-[10px] leading-none opacity-80",children:p.count})]},z)})}),e[7]=g,e[8]=o,e[9]=v):v=e[9],v},kt=Nt,wt=ne(),St=O.lazy(()=>we(()=>import("./VoiceMessage-CeLDxLJ3.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),Ct=i=>{const e=(0,wt.c)(97),{msg:s,isMe:a,isLastInGroup:g,setReplyingTo:n,handleImageClick:m,handleVoiceMessage:u,onDeleteMessage:c,setEditingMessage:o,onToggleReaction:v,currentUser:r}=i,z=De(0);let p,T;e[0]===Symbol.for("react.memo_cache_sentinel")?(p=[0,-60],T=[0,1],e[0]=p,e[1]=T):(p=e[0],T=e[1]);const w=ve(z,p,T);let l,b;e[2]===Symbol.for("react.memo_cache_sentinel")?(l=[0,-60],b=[.5,1.1],e[2]=l,e[3]=b):(l=e[2],b=e[3]);const C=ve(z,l,b);let y;e[4]!==s||e[5]!==n?(y=(U,re)=>{re.offset.x<-60&&(n(s),window.navigator.vibrate&&window.navigator.vibrate(10))},e[4]=s,e[5]=n,e[6]=y):y=e[6];const S=y,N=`msg-${s.id}`;let _,M;e[7]===Symbol.for("react.memo_cache_sentinel")?(_={opacity:0,y:5},M={opacity:1,y:0},e[7]=_,e[8]=M):(_=e[7],M=e[8]);const x=a?"justify-end":"justify-start",d=g&&"mb-3";let h;e[9]!==d||e[10]!==x?(h=I("flex w-full group relative overflow-visible",x,d),e[9]=d,e[10]=x,e[11]=h):h=e[11];let j;e[12]!==w||e[13]!==C?(j={opacity:w,scale:C,right:10},e[12]=w,e[13]=C,e[14]=j):j=e[14];let k;e[15]===Symbol.for("react.memo_cache_sentinel")?(k=(0,t.jsx)(ye,{size:20}),e[15]=k):k=e[15];let $;e[16]!==j?($=(0,t.jsx)(oe.div,{style:j,className:"absolute top-1/2 -translate-y-1/2 flex items-center justify-center size-10 rounded-full bg-violet-500/10 text-violet-500 z-0 pointer-events-none",children:k}),e[16]=j,e[17]=$):$=e[17];let f;e[18]===Symbol.for("react.memo_cache_sentinel")?(f={left:-80,right:0},e[18]=f):f=e[18];let G;e[19]!==z?(G={x:z},e[19]=z,e[20]=G):G=e[20];const L=a?"flex-row-reverse":"flex-row";let A;e[21]!==L?(A=I("flex max-w-[85%] md:max-w-[70%] items-end gap-1.5 z-10 touch-pan-y",L),e[21]=L,e[22]=A):A=e[22];const D=a?"items-end":"items-start";let E;e[23]!==D?(E=I("relative flex flex-col min-w-[60px]",D),e[23]=D,e[24]=E):E=e[24];const P=a?"bg-[#8774e1] text-white border border-[#7059d0]":"bg-white text-zinc-900 dark:bg-[#212121] dark:text-white",V=s.isOptimistic&&"opacity-60 grayscale-[0.5]";let ie;e[25]!==P||e[26]!==V?(ie=I("relative px-3 py-1.5 shadow-sm text-[15px] leading-[1.4] transition-all",P,"rounded-[15px]",V),e[25]=P,e[26]=V,e[27]=ie):ie=e[27];let J;e[28]!==a||e[29]!==s.replyTo?(J=s.replyTo&&(0,t.jsxs)("div",{className:I("mb-1.5 border-l-2 pl-2 py-0.5 text-xs rounded bg-black/5 dark:bg-white/5",a?"border-white/50":"border-violet-500"),onClick:U=>{U.stopPropagation();const re=document.getElementById(`msg-${s.replyTo.id}`);re?.scrollIntoView({behavior:"smooth",block:"center"}),re?.classList.add("bg-violet-500/20"),setTimeout(()=>re?.classList.remove("bg-violet-500/20"),2e3)},children:[(0,t.jsx)("span",{className:I("font-bold block",a?"text-white/90":"text-violet-500"),children:s.replyTo.sender==="me"?"You":s.replyTo.senderName}),(0,t.jsx)("span",{className:"opacity-80 line-clamp-1",children:s.replyTo.text})]}),e[28]=a,e[29]=s.replyTo,e[30]=J):J=e[30];let X;e[31]!==m||e[32]!==s?(X=s.media?.length>0&&s.type!=="voice"&&(0,t.jsx)("div",{className:I("relative -mx-3 -mt-1.5 overflow-hidden shadow-sm",!s.text&&"-mb-1.5",s.text&&"mb-1.5","rounded-[15px]"),children:s.media.map((U,re)=>(0,t.jsx)("div",{className:"relative group/media min-w-[280px] md:min-w-[400px]",children:s.type==="video"?(0,t.jsx)("div",{className:"aspect-video w-full bg-black",children:(0,t.jsx)(it,{src:U.url,poster:U.poster})}):(0,t.jsx)("img",{src:U.url,className:"max-h-[400px] md:max-h-[500px] w-full object-cover cursor-pointer hover:brightness-95 transition-all",onClick:()=>m(s)})},re))}),e[31]=m,e[32]=s,e[33]=X):X=e[33];let Q;e[34]!==u||e[35]!==a||e[36]!==s.media||e[37]!==s.type?(Q=s.type==="voice"&&s.media?.[0]&&(0,t.jsx)(O.Suspense,{fallback:(0,t.jsx)("div",{className:"h-12 w-48 animate-pulse bg-zinc-100 dark:bg-zinc-800 rounded-xl"}),children:u(s.media[0].url,s.media[0].duration,a)}),e[34]=u,e[35]=a,e[36]=s.media,e[37]=s.type,e[38]=Q):Q=e[38];let ae;e[39]!==s.text||e[40]!==s.type?(ae=s.text&&s.type!=="voice"&&(0,t.jsx)("div",{className:"whitespace-pre-wrap break-words pr-12",children:(0,t.jsx)(lt,{options:{...at,className:"underline"},children:s.text})}),e[39]=s.text,e[40]=s.type,e[41]=ae):ae=e[41];let F;e[42]!==a||e[43]!==s.isOptimistic||e[44]!==s.isRead||e[45]!==s.text||e[46]!==s.time||e[47]!==s.type?(F=(s.text||s.type==="voice")&&(0,t.jsxs)("div",{className:I("absolute bottom-1 right-1.5 flex items-center gap-0.5 select-none",a?"text-white/70":"text-[#aaaaaa]"),children:[(0,t.jsx)("span",{className:"text-[10px]",children:s.isOptimistic?"sending...":s.time}),a&&!s.isOptimistic&&(s.isRead?(0,t.jsx)(Ue,{size:13,className:"text-white"}):(0,t.jsx)(Ge,{size:13,className:"text-white/60"}))]}),e[42]=a,e[43]=s.isOptimistic,e[44]=s.isRead,e[45]=s.text,e[46]=s.time,e[47]=s.type,e[48]=F):F=e[48];let B;e[49]!==ie||e[50]!==J||e[51]!==X||e[52]!==Q||e[53]!==ae||e[54]!==F?(B=(0,t.jsx)(Xe,{children:(0,t.jsxs)("div",{className:ie,children:[J,X,Q,ae,F]})}),e[49]=ie,e[50]=J,e[51]=X,e[52]=Q,e[53]=ae,e[54]=F,e[55]=B):B=e[55];let H;e[56]!==s||e[57]!==n?(H=(0,t.jsx)(ce,{onSelect:()=>n(s),children:"Reply"}),e[56]=s,e[57]=n,e[58]=H):H=e[58];let le;e[59]!==s.text?(le=(0,t.jsx)(ce,{onSelect:()=>navigator.clipboard.writeText(s.text),children:"Copy"}),e[59]=s.text,e[60]=le):le=e[60];let q;e[61]!==a||e[62]!==s||e[63]!==o?(q=a&&(0,t.jsx)(ce,{onSelect:()=>o(s),children:"Edit"}),e[61]=a,e[62]=s,e[63]=o,e[64]=q):q=e[64];let ee;e[65]===Symbol.for("react.memo_cache_sentinel")?(ee=(0,t.jsx)(Ze,{}),e[65]=ee):ee=e[65];let W;e[66]!==s.id||e[67]!==c?(W=(0,t.jsx)(ce,{onSelect:()=>c?.(s.id),className:"text-red-500",children:"Delete"}),e[66]=s.id,e[67]=c,e[68]=W):W=e[68];let Y;e[69]!==H||e[70]!==le||e[71]!==q||e[72]!==W?(Y=(0,t.jsxs)(Ye,{children:[H,le,q,ee,W]}),e[69]=H,e[70]=le,e[71]=q,e[72]=W,e[73]=Y):Y=e[73];let K;e[74]!==B||e[75]!==Y?(K=(0,t.jsxs)(Ve,{children:[B,Y]}),e[74]=B,e[75]=Y,e[76]=K):K=e[76];let te;e[77]!==r||e[78]!==a||e[79]!==s.id||e[80]!==s.reactions||e[81]!==v?(te=s.reactions&&s.reactions.length>0&&(0,t.jsx)("div",{className:I("mt-1",a?"mr-1":"ml-1"),children:(0,t.jsx)(kt,{reactions:s.reactions,currentUser:r,onToggle:U=>v?.(s.id,U)})}),e[77]=r,e[78]=a,e[79]=s.id,e[80]=s.reactions,e[81]=v,e[82]=te):te=e[82];let se;e[83]!==E||e[84]!==K||e[85]!==te?(se=(0,t.jsxs)("div",{className:E,children:[K,te]}),e[83]=E,e[84]=K,e[85]=te,e[86]=se):se=e[86];let R;e[87]!==S||e[88]!==G||e[89]!==A||e[90]!==se?(R=(0,t.jsx)(oe.div,{drag:"x",dragConstraints:f,dragElastic:.4,onDragEnd:S,style:G,className:A,children:se}),e[87]=S,e[88]=G,e[89]=A,e[90]=se,e[91]=R):R=e[91];let Z;return e[92]!==h||e[93]!==$||e[94]!==R||e[95]!==N?(Z=(0,t.jsxs)(oe.div,{id:N,initial:_,animate:M,className:h,children:[$,R]}),e[92]=h,e[93]=$,e[94]=R,e[95]=N,e[96]=Z):Z=e[96],Z},_t=({conversation:i,messages:e,currentUser:s,onBack:a,onSendMessage:g,onEditMessage:n,onDeleteMessage:m,onToggleReaction:u,onTyping:c,isLoading:o,isTyping:v,isOnline:r})=>{const{openLightbox:z}=We(),[p,T]=(0,O.useState)(null),[w,l]=(0,O.useState)(null),[b,C]=(0,O.useState)(!1),y=(0,O.useRef)(null);(0,O.useEffect)(()=>{y.current&&(y.current.scrollTop=y.current.scrollHeight)},[e,v,p,w]);const S=async(x,d,h,j)=>{if(w){n?.(w.id,x),l(null);return}if(h&&j){try{const f=await je(new File([h],`voice-message-${Date.now()}.webm`,{type:h.type}));g(i.id,"Voice message","voice",[{url:f.url,duration:j}],p?.id)}catch(f){console.error("Failed to send voice message:",f)}return}let k=[];if(d.length>0)try{k=await Promise.all(d.map(f=>je(f)))}catch(f){console.error("Upload failed:",f);return}const $=k.length>0?k[0].type==="video"?"video":"image":"text";g(i.id,x,$,k,p?.id),T(null)},N=x=>{!x.media||x.media.length===0||z(x.media.map(d=>d.url),0)},_=(x,d)=>x===e.length-1?!1:e[x+1].sender===d.sender,M=(x,d,h)=>(0,t.jsx)(St,{url:x,duration:d,isMe:h});return(0,t.jsxs)("div",{className:"relative flex h-full w-full flex-col overflow-hidden bg-[#8774e1]/10 dark:bg-[#0f0f0f] md:border-l md:border-zinc-200/50 dark:md:border-zinc-800/50",children:[(0,t.jsx)("div",{className:"absolute inset-0 z-0 opacity-[0.03] dark:opacity-[0.05] pointer-events-none",style:{backgroundImage:'url("https://web.telegram.org/a/chat-bg-pattern-light.63857502396e95c469b6.png")',backgroundSize:"400px"}}),(0,t.jsx)(pt,{conversation:i,isOnline:r,onBack:a,onOpenSettings:()=>C(!0)}),(0,t.jsx)("div",{className:"flex-1 min-h-0 overflow-hidden relative z-10",children:(0,t.jsx)("div",{className:"h-full overflow-y-auto px-2 md:px-12 py-4 no-scrollbar",ref:y,children:(0,t.jsxs)("div",{className:"flex flex-col min-h-full justify-end max-w-3xl mx-auto",children:[o&&e.length===0?(0,t.jsx)("div",{className:"flex justify-center p-8",children:(0,t.jsx)(Ne,{className:"animate-spin text-violet-500",size:32})}):(0,t.jsx)("div",{className:"flex flex-col gap-[2px]",children:e.map((x,d)=>(0,t.jsx)(Ct,{msg:x,isMe:x.sender==="me",isLastInGroup:!_(d,x),setReplyingTo:T,handleImageClick:N,handleVoiceMessage:M,onDeleteMessage:m,setEditingMessage:l,onToggleReaction:u,currentUser:s},x.id))}),v&&(0,t.jsx)("div",{className:"flex items-center gap-2 mt-1 ml-1",children:(0,t.jsx)("div",{className:"bg-white dark:bg-[#212121] px-4 py-2 rounded-[15px] rounded-tl-[2px] shadow-sm",children:(0,t.jsx)(tt,{})})})]})})}),(0,t.jsx)(jt,{onSendMessage:S,onTyping:c,replyingTo:p,setReplyingTo:T,editingMessage:w,setEditingMessage:l}),i.isGroup?(0,t.jsx)(Ke,{isOpen:b,onClose:()=>C(!1),conversation:i,onUpdate:()=>{C(!1)}}):(0,t.jsx)(Qe,{isOpen:b,onClose:()=>C(!1),user:i.user,conversationId:i.id})]})},Mt=_t,Tt=ne(),Rt=()=>{const i=(0,Tt.c)(33),{id:e,currentUser:s,onlineUsers:a,msgSearchQuery:g,setMsgSearchQuery:n,userSearchResults:m,filteredConversations:u,selectedConversation:c,localMessages:o,isConvLoading:v,isMsgLoading:r,currentIsTyping:z,otherUserIsOnline:p,handleStartConversation:T,handleSelectConversation:w,sendMessage:l,editMessage:b,onDeleteMessage:C,onToggleReaction:y,sendTypingStatus:S,typingStatus:N,navigate:_}=rt();if(!s){let f;i[0]===Symbol.for("react.memo_cache_sentinel")?(f=(0,t.jsx)("div",{className:"rounded-3xl bg-zinc-50 p-6 dark:bg-zinc-900",children:(0,t.jsx)(Re,{size:48,className:"text-zinc-300 dark:text-zinc-600"})}),i[0]=f):f=i[0];let G;return i[1]===Symbol.for("react.memo_cache_sentinel")?(G=(0,t.jsxs)("div",{className:"flex h-[100dvh] flex-col items-center justify-center gap-6 border-zinc-100 bg-white p-8 text-center dark:border-zinc-800 dark:bg-black md:h-[calc(100vh-1.5rem)] md:rounded-2xl md:border",children:[f,(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h3",{className:"text-2xl font-black tracking-tight dark:text-white",children:"Sign in to message"}),(0,t.jsx)("p",{className:"max-w-xs text-zinc-500 font-medium",children:"Join the conversation. Sign up or log in to start chatting."})]})]}),i[1]=G):G=i[1],G}if(v){let f;return i[2]===Symbol.for("react.memo_cache_sentinel")?(f=(0,t.jsx)("div",{className:"flex h-[100dvh] items-center justify-center border-zinc-100 bg-white dark:border-zinc-800 dark:bg-black md:h-[calc(100vh-1.5rem)] md:rounded-2xl md:border",children:(0,t.jsx)(Ne,{className:"animate-spin text-violet-500",size:32})}),i[2]=f):f=i[2],f}const M=`flex ${e?"h-[100dvh]":"h-[calc(100dvh-4rem)]"} w-full max-w-full box-border overscroll-none overflow-x-hidden overflow-y-hidden bg-white shadow-2xl shadow-zinc-200/50 dark:border-zinc-800 dark:bg-[#0f0f0f] dark:shadow-none md:h-[calc(100vh-1.5rem)] md:rounded-3xl md:border md:border-zinc-200/50`,x=`flex-col md:flex md:w-[420px] ${c?"hidden":"flex"} h-full min-h-0 min-w-0 flex-1 md:flex-none bg-white dark:bg-[#0f0f0f] border-r border-zinc-100 dark:border-zinc-800 z-10`,d=e??null;let h;i[3]!==u||i[4]!==w||i[5]!==T||i[6]!==g||i[7]!==a||i[8]!==n||i[9]!==d||i[10]!==N||i[11]!==m?(h=(0,t.jsx)(mt,{conversations:u,userResults:m,onSelect:w,onStartNew:T,selectedId:d,searchQuery:g,onSearchChange:n,onlineUsers:a,typingStatus:N}),i[3]=u,i[4]=w,i[5]=T,i[6]=g,i[7]=a,i[8]=n,i[9]=d,i[10]=N,i[11]=m,i[12]=h):h=i[12];let j;i[13]!==x||i[14]!==h?(j=(0,t.jsx)("div",{className:x,children:h}),i[13]=x,i[14]=h,i[15]=j):j=i[15];let k;i[16]!==z||i[17]!==s||i[18]!==b||i[19]!==r||i[20]!==o||i[21]!==_||i[22]!==C||i[23]!==y||i[24]!==p||i[25]!==c||i[26]!==l||i[27]!==S?(k=c?(0,t.jsx)(Mt,{conversation:c,messages:o,currentUser:s,onBack:()=>_("/m"),onSendMessage:l,onEditMessage:b,onDeleteMessage:C,onToggleReaction:y,onTyping:f=>S(c.id,f),isLoading:r,isTyping:!!z,isOnline:!!p}):(0,t.jsxs)("div",{className:"hidden flex-1 flex-col items-center justify-center gap-6 text-zinc-500 md:flex bg-zinc-50/30 dark:bg-zinc-900/10",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute -inset-10 rounded-full bg-violet-500/5 blur-3xl dark:bg-violet-500/10"}),(0,t.jsx)("div",{className:"relative rounded-[2.5rem] bg-white p-10 shadow-xl shadow-zinc-200/50 dark:bg-zinc-900/50 dark:shadow-none ring-1 ring-zinc-100 dark:ring-zinc-800",children:(0,t.jsx)(Ae,{size:80,className:"text-violet-500 stroke-[1.5]"})})]}),(0,t.jsxs)("div",{className:"text-center max-w-sm px-4 space-y-3",children:[(0,t.jsx)("h3",{className:"text-3xl font-black tracking-tighter text-zinc-900 dark:text-white",children:"Your Messages"}),(0,t.jsx)("p",{className:"text-zinc-500 font-medium text-lg",children:"Send private photos and messages to a friend or group."})]})]}),i[16]=z,i[17]=s,i[18]=b,i[19]=r,i[20]=o,i[21]=_,i[22]=C,i[23]=y,i[24]=p,i[25]=c,i[26]=l,i[27]=S,i[28]=k):k=i[28];let $;return i[29]!==M||i[30]!==j||i[31]!==k?($=(0,t.jsxs)("div",{className:M,children:[j,k]}),i[29]=M,i[30]=j,i[31]=k,i[32]=$):$=i[32],$},Ht=Rt;export{Ht as default};
