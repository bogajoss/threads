import{o as ee}from"./rolldown-runtime-CIzSbf4l.js";import{c as le,l as te,w as re}from"./framework-i0QTTZ5z.js";import"./database-OCX2jLsI.js";import{$t as ie,Cn as Q,Jt as W,Nt as Y,Sn as ne,on as de,wn as ce}from"./ui-libs-CBFZd3CP.js";import{At as oe,Dt as xe,Fn as me,H as K,Mt as he,Ot as ue,Ut as V,_t as je,at as t,b as fe,h as ge,in as ve,it as I,jt as pe,kt as be,nn as Ne,ot as A,rn as ye,rt as P,st as B,x as G,z as Z}from"./index-BhYIW-gb.js";var ke=le(),x=ee(re(),1),s=ee(te(),1),ze=()=>{const e=(0,ke.c)(66),[i,$]=(0,x.useState)("");let N;e[0]===Symbol.for("react.memo_cache_sentinel")?(N={role:"all",status:"all"},e[0]=N):N=e[0];const[l,y]=(0,x.useState)(N),{users:m,actions:n}=ge(),[k,F]=(0,x.useState)(null);let d,h,u,j,c,o,f;if(e[1]!==n||e[2]!==l||e[3]!==i||e[4]!==m.data||e[5]!==m.isLoading){f=Symbol.for("react.early_return_sentinel");e:{let T;if(e[13]!==l||e[14]!==i?(T=a=>{if(!a)return!1;const M=a.name.toLowerCase().includes(i.toLowerCase())||a.handle.toLowerCase().includes(i.toLowerCase()),se=l.role==="all"||a.role===l.role,ae=l.status==="all"||l.status==="verified"&&a.verified||l.status==="unverified"&&!a.verified||l.status==="banned"&&a.isBanned;return M&&se&&ae},e[13]=l,e[14]=i,e[15]=T):T=e[15],d=(m.data||[]).filter(T),m.isLoading){let a;e[16]===Symbol.for("react.memo_cache_sentinel")?(a=(0,s.jsx)("div",{className:"flex min-h-[600px] items-center justify-center",children:(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,s.jsx)(ce,{className:"h-8 w-8 animate-spin text-violet-600"}),(0,s.jsx)("p",{className:"text-sm font-semibold text-zinc-500",children:"Loading users..."})]})}),e[16]=a):a=e[16],f=a;break e}j="space-y-6",e[17]===Symbol.for("react.memo_cache_sentinel")?(c=(0,s.jsx)("div",{className:"space-y-2",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-violet-600 text-white",children:(0,s.jsx)(Y,{className:"h-5 w-5"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-black tracking-tight",children:"User Directory"}),(0,s.jsx)("p",{className:"text-sm text-zinc-500",children:"Manage platform users and permissions"})]})]})}),e[17]=c):c=e[17];let H;e[18]===Symbol.for("react.memo_cache_sentinel")?(H=(0,s.jsx)(ie,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 text-zinc-400"}),e[18]=H):H=e[18];let O;e[19]===Symbol.for("react.memo_cache_sentinel")?(O=a=>$(a.target.value),e[19]=O):O=e[19];let z;e[20]!==i?(z=(0,s.jsxs)("div",{className:"relative",children:[H,(0,s.jsx)(je,{placeholder:"Search by name or handle...",value:i,onChange:O,className:"h-11 rounded-xl border-zinc-200 bg-white pl-10 text-sm font-medium dark:border-zinc-800 dark:bg-black"})]}),e[20]=i,e[21]=z):z=e[21];let S;e[22]!==l?(S=a=>y({...l,role:a}),e[22]=l,e[23]=S):S=e[23];let q;e[24]===Symbol.for("react.memo_cache_sentinel")?(q=(0,s.jsx)(A,{className:"w-[180px] rounded-xl border-zinc-200 dark:border-zinc-800",children:(0,s.jsx)(B,{placeholder:"Filter by role"})}),e[24]=q):q=e[24];let E;e[25]===Symbol.for("react.memo_cache_sentinel")?(E=(0,s.jsxs)(I,{className:"rounded-xl dark:bg-zinc-900",children:[(0,s.jsx)(t,{value:"all",children:"All Roles"}),(0,s.jsx)(t,{value:"user",children:"Users"}),(0,s.jsx)(t,{value:"moderator",children:"Moderators"}),(0,s.jsx)(t,{value:"admin",children:"Admins"})]}),e[25]=E):E=e[25];let w;e[26]!==l.role||e[27]!==S?(w=(0,s.jsxs)(P,{value:l.role,onValueChange:S,children:[q,E]}),e[26]=l.role,e[27]=S,e[28]=w):w=e[28];let C;e[29]!==l?(C=a=>y({...l,status:a}),e[29]=l,e[30]=C):C=e[30];let J;e[31]===Symbol.for("react.memo_cache_sentinel")?(J=(0,s.jsx)(A,{className:"w-[180px] rounded-xl border-zinc-200 dark:border-zinc-800",children:(0,s.jsx)(B,{placeholder:"Filter by status"})}),e[31]=J):J=e[31];let X;e[32]===Symbol.for("react.memo_cache_sentinel")?(X=(0,s.jsxs)(I,{className:"rounded-xl dark:bg-zinc-900",children:[(0,s.jsx)(t,{value:"all",children:"All Status"}),(0,s.jsx)(t,{value:"verified",children:"Verified"}),(0,s.jsx)(t,{value:"unverified",children:"Unverified"}),(0,s.jsx)(t,{value:"banned",children:"Banned"})]}),e[32]=X):X=e[32];let U;e[33]!==l.status||e[34]!==C?(U=(0,s.jsxs)(P,{value:l.status,onValueChange:C,children:[J,X]}),e[33]=l.status,e[34]=C,e[35]=U):U=e[35];let D;e[36]!==l.role||e[37]!==l.status?(D=(l.role!=="all"||l.status!=="all")&&(0,s.jsx)(V,{variant:"outline",size:"sm",onClick:()=>y({role:"all",status:"all"}),className:"rounded-xl",children:"Clear Filters"}),e[36]=l.role,e[37]=l.status,e[38]=D):D=e[38];let R;e[39]!==w||e[40]!==U||e[41]!==D?(R=(0,s.jsxs)("div",{className:"flex flex-wrap gap-3",children:[w,U,D]}),e[39]=w,e[40]=U,e[41]=D,e[42]=R):R=e[42],e[43]!==z||e[44]!==R?(o=(0,s.jsxs)("div",{className:"space-y-4",children:[z,R]}),e[43]=z,e[44]=R,e[45]=o):o=e[45],h="overflow-hidden rounded-3xl border border-zinc-200 dark:border-zinc-800",u=d.length===0?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center bg-white py-12 text-center dark:bg-black",children:[(0,s.jsx)(Y,{className:"h-12 w-12 text-zinc-300 dark:text-zinc-700"}),(0,s.jsx)("p",{className:"mt-4 font-semibold text-zinc-600 dark:text-zinc-400",children:"No users found"}),(0,s.jsx)("p",{className:"text-sm text-zinc-500",children:"Try adjusting your search or filters"})]}):(0,s.jsx)("div",{className:"divide-y divide-zinc-200 bg-white dark:divide-zinc-800 dark:bg-black",children:d.map(a=>a?(0,s.jsxs)("div",{className:"flex flex-col gap-4 p-4 transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900/50 sm:flex-row sm:items-center sm:justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 min-w-0",children:[(0,s.jsxs)("div",{className:"relative shrink-0",children:[(0,s.jsxs)(Ne,{className:"h-12 w-12 rounded-2xl ring-2 ring-zinc-200 dark:ring-zinc-800",children:[(0,s.jsx)(ve,{src:a.avatar,className:"rounded-2xl"}),(0,s.jsx)(ye,{className:"rounded-2xl bg-violet-500/10 text-sm font-bold text-violet-600",children:a.name[0]?.toUpperCase()})]}),a.verified&&(0,s.jsx)(K,{size:20,className:"absolute -bottom-2 -right-2 rounded-full bg-white p-0.5"}),a.isPro&&(0,s.jsx)(Z,{size:20,className:"absolute -bottom-2 -left-2 rounded-full bg-white p-0.5"})]}),(0,s.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,s.jsx)("h3",{className:"truncate font-semibold text-foreground",children:a.name}),(0,s.jsxs)("p",{className:"truncate text-sm text-zinc-500",children:["@",a.handle]})]})]}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2 sm:justify-end",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 rounded-xl bg-zinc-100 px-3 py-1.5 dark:bg-zinc-900",children:[(0,s.jsx)(ne,{className:"h-3.5 w-3.5 text-zinc-600 dark:text-zinc-400"}),(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wider text-zinc-700 dark:text-zinc-300",children:a.role})]}),(0,s.jsx)("div",{className:"flex items-center gap-2 rounded-xl bg-zinc-100 px-3 py-1.5 dark:bg-zinc-900",children:(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wider text-zinc-700 dark:text-zinc-300",children:a.roles})}),a.isPro&&(0,s.jsxs)("div",{className:"flex items-center gap-1.5 rounded-xl bg-amber-500/10 px-3 py-1.5",children:[(0,s.jsx)(Z,{size:14}),(0,s.jsx)("span",{className:"text-xs font-semibold text-amber-700 dark:text-amber-400",children:"PRO"})]}),a.verified&&(0,s.jsxs)("div",{className:"flex items-center gap-1.5 rounded-xl bg-blue-500/10 px-3 py-1.5",children:[(0,s.jsx)(K,{size:14}),(0,s.jsx)("span",{className:"text-xs font-semibold text-blue-700 dark:text-blue-400",children:"Verified"})]}),a.isBanned&&(0,s.jsxs)("div",{className:"flex items-center gap-1.5 rounded-xl bg-rose-500/10 px-3 py-1.5",children:[(0,s.jsx)(W,{className:"h-3.5 w-3.5 text-rose-600 dark:text-rose-400"}),(0,s.jsx)("span",{className:"text-xs font-semibold text-rose-700 dark:text-rose-400",children:"Banned"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 sm:justify-end",children:[(0,s.jsx)(V,{variant:"outline",size:"sm",onClick:()=>F(a),title:"Manage user",className:"h-9 rounded-lg px-3",children:(0,s.jsx)(de,{className:"h-4 w-4"})}),(0,s.jsxs)(P,{value:a.role,onValueChange:M=>n.updateRole({userId:a.id,role:M}),children:[(0,s.jsx)(A,{className:"w-[130px] rounded-lg border-zinc-200 text-xs font-semibold dark:border-zinc-800",children:(0,s.jsx)(B,{})}),(0,s.jsxs)(I,{className:"rounded-xl dark:bg-zinc-900",children:[(0,s.jsx)(t,{value:"user",children:"User"}),(0,s.jsx)(t,{value:"moderator",children:"Moderator"}),(0,s.jsx)(t,{value:"admin",children:"Admin"})]})]}),(0,s.jsx)(V,{variant:"outline",size:"sm",onClick:()=>n.toggleVerification({userId:a.id,verified:!a.verified}),title:a.verified?"Remove verification":"Verify user",className:"h-9 rounded-lg px-3",children:a.verified?(0,s.jsx)(Q,{className:"h-4 w-4"}):(0,s.jsx)(K,{size:16})}),(0,s.jsx)(V,{variant:"outline",size:"sm",onClick:()=>{const M=a.isBanned?"unban":"ban";confirm(`Are you sure you want to ${M} @${a.handle}?`)&&n.toggleBan({userId:a.id,banned:!a.isBanned})},title:a.isBanned?"Unban user":"Ban user",className:me("h-9 rounded-lg px-3",a.isBanned?"border-emerald-200 bg-emerald-50 text-emerald-700 hover:bg-emerald-100 dark:border-emerald-900 dark:bg-emerald-900/20 dark:text-emerald-400":"border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 dark:border-rose-900 dark:bg-rose-900/20 dark:text-rose-400"),children:a.isBanned?(0,s.jsx)(Q,{className:"h-4 w-4"}):(0,s.jsx)(W,{className:"h-4 w-4"})})]})]},a.id):null)})}e[1]=n,e[2]=l,e[3]=i,e[4]=m.data,e[5]=m.isLoading,e[6]=d,e[7]=h,e[8]=u,e[9]=j,e[10]=c,e[11]=o,e[12]=f}else d=e[6],h=e[7],u=e[8],j=e[9],c=e[10],o=e[11],f=e[12];if(f!==Symbol.for("react.early_return_sentinel"))return f;let g;e[46]!==h||e[47]!==u?(g=(0,s.jsx)("div",{className:h,children:u}),e[46]=h,e[47]=u,e[48]=g):g=e[48];let v;e[49]!==d.length?(v=(0,s.jsx)("span",{className:"font-semibold text-foreground",children:d.length}),e[49]=d.length,e[50]=v):v=e[50];const L=m.data?.length||0;let p;e[51]!==L?(p=(0,s.jsx)("span",{className:"font-semibold text-foreground",children:L}),e[51]=L,e[52]=p):p=e[52];let r;e[53]!==p||e[54]!==v?(r=(0,s.jsx)("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4 dark:border-zinc-800 dark:bg-black",children:(0,s.jsxs)("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:["Showing"," ",v," ","of"," ",p," ","users"]})}),e[53]=p,e[54]=v,e[55]=r):r=e[55];let b;e[56]!==n||e[57]!==k?(b=k&&(0,s.jsx)(Se,{user:k,onClose:()=>F(null),actions:n}),e[56]=n,e[57]=k,e[58]=b):b=e[58];let _;return e[59]!==r||e[60]!==b||e[61]!==j||e[62]!==c||e[63]!==o||e[64]!==g?(_=(0,s.jsxs)("div",{className:j,children:[c,o,g,r,b]}),e[59]=r,e[60]=b,e[61]=j,e[62]=c,e[63]=o,e[64]=g,e[65]=_):_=e[65],_},Se=({user:e,onClose:i,actions:$})=>{const[N,l]=(0,x.useState)(e.roles||"Newbie"),[y,m]=(0,x.useState)(e.role||"user"),[n,k]=(0,x.useState)(e.isPro||!1),[F,d]=(0,x.useState)(30),[h,u]=(0,x.useState)(!1),[j,c]=(0,x.useState)(!1),[o,f]=(0,x.useState)(!1),g=async()=>{let r=null;h&&(r=n?F:0);try{o&&await $.updateRoleAsync({userId:e.id,role:y}),(j||h)&&await $.adminUpdateUserAsync({userId:e.id,role:j?N:null,proValidityDays:r}),i()}catch(b){console.error("Failed to update user:",b)}},v=r=>{l(r),c(!0)},L=r=>{m(r),f(!0)},p=r=>{k(r),u(!0)};return(0,s.jsx)(xe,{open:!0,onOpenChange:i,children:(0,s.jsxs)(ue,{className:"sm:max-w-[425px] rounded-2xl",children:[(0,s.jsxs)(pe,{children:[(0,s.jsxs)(he,{children:["Manage ",e.name]}),(0,s.jsx)(be,{children:"Update user role and pro status. Changes are saved upon clicking 'Save changes'."})]}),(0,s.jsxs)("div",{className:"grid gap-6 py-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,s.jsx)(G,{htmlFor:"system-role",className:"text-right",children:"System Role"}),(0,s.jsx)("div",{className:"col-span-3",children:(0,s.jsxs)(P,{value:y,onValueChange:L,children:[(0,s.jsx)(A,{children:(0,s.jsx)(B,{placeholder:"Select a role"})}),(0,s.jsxs)(I,{children:[(0,s.jsx)(t,{value:"user",children:"User"}),(0,s.jsx)(t,{value:"moderator",children:"Moderator"}),(0,s.jsx)(t,{value:"admin",children:"Admin"})]})]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,s.jsx)(G,{htmlFor:"user-role",className:"text-right",children:"User Role"}),(0,s.jsx)("div",{className:"col-span-3",children:(0,s.jsxs)(P,{value:N,onValueChange:v,children:[(0,s.jsx)(A,{children:(0,s.jsx)(B,{placeholder:"Select a role"})}),(0,s.jsxs)(I,{children:[(0,s.jsx)(t,{value:"Newbie",children:"Newbie"}),(0,s.jsx)(t,{value:"Hunter",children:"Hunter"}),(0,s.jsx)(t,{value:"Elite",children:"Elite"})]})]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,s.jsx)(G,{htmlFor:"is-pro",className:"text-right",children:"Pro Status"}),(0,s.jsx)(fe,{id:"is-pro",checked:n,onCheckedChange:p})]}),n&&(0,s.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,s.jsx)(G,{htmlFor:"validity",className:"text-right",children:"Validity"}),(0,s.jsx)("div",{className:"col-span-3",children:(0,s.jsxs)(P,{value:String(F),onValueChange:r=>{d(Number(r)),u(!0)},children:[(0,s.jsx)(A,{children:(0,s.jsx)(B,{placeholder:"Select validity"})}),(0,s.jsxs)(I,{children:[(0,s.jsx)(t,{value:"7",children:"7 days"}),(0,s.jsx)(t,{value:"15",children:"15 days"}),(0,s.jsx)(t,{value:"30",children:"30 days"}),(0,s.jsx)(t,{value:"90",children:"90 days"}),(0,s.jsx)(t,{value:"365",children:"365 days"})]})]})})]})]}),(0,s.jsxs)(oe,{children:[(0,s.jsx)(V,{variant:"outline",onClick:i,children:"Cancel"}),(0,s.jsx)(V,{onClick:g,children:"Save changes"})]})]})})},Ve=ze;export{Ve as default};
