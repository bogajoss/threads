import{a as E}from"./rolldown-runtime-BaZ8gS7u.js";import{c as S,l as H,v as w,w as I}from"./framework-3lkjbTvb.js";import{n as j}from"./media-libs-C98UjHPF.js";import{Ln as P,dn as O,on as T}from"./index-5RZ1uRDG.js";import{i as R,n as D,r as U,t as M}from"./text-processing-BMF44JzJ.js";var F=U("hashtag",{isLink:!0});function q({scanner:e,parser:t}){const{POUND:c,UNDERSCORE:f,FULLWIDTHMIDDLEDOT:a,ASCIINUMERICAL:p,ALPHANUMERICAL:m}=e.tokens,{alpha:u,numeric:i,alphanumeric:r,emoji:l}=e.tokens.groups,o=t.start.tt(c),s=o.tt(f),n=new D(F);o.tt(p,n),o.tt(m,n),o.ta(i,s),o.ta(u,n),o.ta(l,n),o.ta(a,n),s.tt(p,n),s.tt(m,n),s.ta(u,n),s.ta(l,n),s.ta(a,n),s.ta(i,s),s.tt(f,s),n.ta(r,n),n.ta(l,n),n.tt(a,n),n.tt(f,n)}R("hashtag",q);var B=U("mention",{isLink:!0,toHref(){return"/"+this.toString().slice(1)}});function V({scanner:e,parser:t}){const{HYPHEN:c,SLASH:f,UNDERSCORE:a,AT:p}=e.tokens,{domain:m}=e.tokens.groups,u=t.start.tt(p),i=u.tt(c);i.tt(c,i);const r=u.tt(a,B);u.ta(m,r),i.tt(a,r),i.ta(m,r),r.ta(m,r),r.tt(c,r),r.tt(a,r);const l=r.tt(f);l.ta(m,r),l.tt(a,r),l.tt(c,r)}R("mention",V);const W={formatHref:(e,t)=>t==="mention"?`/u/${e.substring(1)}`:t==="hashtag"?`/tags/${e.substring(1)}`:e,attributes:{onClick:e=>e.stopPropagation(),className:"cursor-pointer font-bold text-rose-600 hover:underline dark:text-rose-400"},validate:{hashtag:e=>/^#[\u0980-\u09FF\w]+$/.test(e)},target:(e,t)=>t==="url"?"_blank":void 0,rel:(e,t)=>t==="url"?"noopener noreferrer":void 0},N={BASE_URL:"https://feed.systemadminbd.com",APP_ID:"com.mysys.app",CUSTOM_SCHEME:"mysys"},$=()=>(window.hasOwnProperty("Capacitor"),N.BASE_URL),A=e=>`${$()}${e.startsWith("/")?e:`/${e}`}`,ot=e=>A(`/p/${e}`),at=e=>A(`/r/${e}`);var G=S(),C=E(I(),1),b=E(H(),1),Y=e=>{const t=(0,G.c)(13),{content:c,className:f,onClick:a}=e,p=w(),m=z;let u;t[0]!==c?(u=typeof c=="string"?m(c):c,t[0]=c,t[1]=u):u=t[1];const i=u;let r;t[2]!==f?(r=P("whitespace-pre-line break-words",f),t[2]=f,t[3]=r):r=t[3];let l;t[4]!==p?(l={...W,render:n=>{const{attributes:y,content:g}=n,{href:d,..._}=y,k=$();if(d.includes("internal.tag/")){const v=decodeURIComponent(d.split("internal.tag/")[1]);return(0,b.jsxs)("span",{..._,className:P("cursor-pointer font-bold text-blue-600 hover:underline dark:text-blue-400",_.className),onClick:x=>{x.stopPropagation(),p(`/tags/${v}`)},children:["#",v]},g)}let h=null;return d.startsWith("/")?h=d:d.startsWith(k)&&(h=d.replace(k,"")),h?(0,b.jsx)("span",{..._,className:P("cursor-pointer font-medium text-blue-600 hover:underline dark:text-blue-400",_.className),onClick:v=>{v.stopPropagation(),p(h)},children:g},g):(0,b.jsx)("a",{href:d,..._,target:"_blank",rel:"noopener noreferrer",className:P("text-blue-600 hover:underline dark:text-blue-400",_.className),onClick:J,children:g},g)}},t[4]=p,t[5]=l):l=t[5];let o;t[6]!==i||t[7]!==l?(o=(0,b.jsx)(M,{options:l,children:i}),t[6]=i,t[7]=l,t[8]=o):o=t[8];let s;return t[9]!==a||t[10]!==r||t[11]!==o?(s=(0,b.jsx)("div",{className:r,onClick:a,children:o}),t[9]=a,t[10]=r,t[11]=o,t[12]=s):s=t[12],s},it=Y;function z(e){return e.replace(/#([\u0980-\u09FF\w]+)/g,"https://internal.tag/$1")}function J(e){return e.stopPropagation()}var K=S(),Q=e=>{const t=(0,K.c)(17),{src:c,poster:f}=e,a=(0,C.useRef)(null),{reportVisibility:p,unregister:m}=T(),{dataSaver:u}=O(),i=(0,C.useId)();let r;t[0]===Symbol.for("react.memo_cache_sentinel")?(r={play:()=>{const h=a.current?.plyr;h&&(h.muted=!0,h.play().catch(X))},pause:()=>{a.current?.plyr?.pause()}},t[0]=r):r=t[0];const l=r;let o,s;t[1]!==u||t[2]!==i||t[3]!==p||t[4]!==m?(o=()=>{const h=new IntersectionObserver(x=>{const[L]=x;p(i,u?0:L.intersectionRatio,l)},{threshold:[0,.25,.5,.75,1]}),v=a.current?.elements?.container;return v&&h.observe(v),()=>{a.current?.plyr?.pause(),m(i),v&&h.unobserve(v)}},s=[i,p,m,l,u],t[1]=u,t[2]=i,t[3]=p,t[4]=m,t[5]=o,t[6]=s):(o=t[5],s=t[6]),(0,C.useEffect)(o,s);let n;t[7]!==c?(n=[{src:c,type:"video/mp4"}],t[7]=c,t[8]=n):n=t[8];let y;t[9]!==f||t[10]!==n?(y={type:"video",sources:n,poster:f},t[9]=f,t[10]=n,t[11]=y):y=t[11];let g;t[12]===Symbol.for("react.memo_cache_sentinel")?(g={controls:["play-large","play","progress","current-time","mute","volume","fullscreen"],settings:["quality","speed"],ratio:"16:9",clickToPlay:!0,hideControls:!0,resetOnEnd:!0},t[12]=g):g=t[12];let d;t[13]!==y?(d={source:y,options:g},t[13]=y,t[14]=d):d=t[14];const _=d;let k;return t[15]!==_?(k=(0,b.jsx)("div",{className:"w-full bg-black",onClick:Z,children:(0,b.jsx)(j,{ref:a,..._})}),t[15]=_,t[16]=k):k=t[16],k},lt=Q;function X(){}function Z(e){return e.stopPropagation()}export{at as i,it as n,ot as r,lt as t};
