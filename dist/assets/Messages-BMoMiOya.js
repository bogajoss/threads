const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/VoiceMessage-PxSIXe1Q.js","assets/framework-BjssErrK.js","assets/database-CdmW3A7f.js","assets/animations-Kp4r2r5F.js","assets/rolldown-runtime-BaZ8gS7u.js","assets/framework-sg0yWRLc.css","assets/ui-libs-BDc7wvDc.js","assets/media-libs-DyQ6Lt1T.js","assets/media-libs-CqCaMccn.css","assets/VoiceMessage-BvqKZg8S.js","assets/index-CZ2mVuNB.js","assets/query-BlVNDywe.js","assets/index-P8qLSjvb.css"])))=>i.map(i=>d[i]);
import{a as ze}from"./rolldown-runtime-BaZ8gS7u.js";import{a as ke,c as Se,i as oe,n as pe,r as _e,s as Ce}from"./animations-Kp4r2r5F.js";import{_ as Me,b as Te,c as re}from"./framework-BjssErrK.js";import"./database-CdmW3A7f.js";import{Bt as he,Dt as ge,Et as Re,Gt as $e,Hn as Ge,Pt as be,Qt as ve,Ut as je,Wt as Ie,cn as Oe,fn as Pe,in as Ne,ir as Ee,lr as Ae,mn as Ue,on as Le,rr as De,tn as fe}from"./ui-libs-BDc7wvDc.js";import"./media-libs-DyQ6Lt1T.js";import{$ as ie,B as Ve,Ft as Fe,Gt as xe,H as qe,Kt as me,Mt as Be,Nt as de,Pt as He,Wt as ue,Xt as We,b as Ye,bn as O,dt as Ke,ft as Xe,jt as Je,n as Ze,p as Qe,pt as et,r as tt,st,t as it,x as lt,yn as ye,yt as at}from"./index-CZ2mVuNB.js";import"./VoiceMessage-BvqKZg8S.js";import{t as rt}from"./VideoPlayer-CCeTLazY.js";import{t as nt}from"./text-processing-43DOFg7x.js";import{t as ct}from"./linkify-BbNKDFfD.js";import{t as ot}from"./useAutoResizeTextArea-9iOznvUv.js";var dt=re(),I=ze(Se(),1),t=ze(Ce(),1),xt=i=>{const e=(0,dt.c)(67),{conv:s,selectedId:r,onSelect:g,onlineUsers:o,isTyping:u}=i;let b;e[0]!==s.isGroup||e[1]!==s.user||e[2]!==o?(b=!s.isGroup&&s.user?o.has(s.user.id):!1,e[0]=s.isGroup,e[1]=s.user,e[2]=o,e[3]=b):b=e[3];const d=b,n=r===s.id,j=s.unread>0,a=s.isGroup?s.name:s.user?.name,N=s.isGroup?s.avatar:s.user?.avatar;let f;e[4]!==s||e[5]!==g?(f=()=>g(s),e[4]=s,e[5]=g,e[6]=f):f=e[6];const T=n?"bg-violet-600 dark:bg-violet-600":"hover:bg-zinc-100 dark:hover:bg-zinc-900/80";let k;e[7]!==T?(k=O("group relative flex cursor-pointer items-center gap-[10px] py-2 px-3 transition-all duration-150 rounded-xl",T),e[7]=T,e[8]=k):k=e[8];const l=n?"opacity-90":"opacity-100";let h;e[9]!==l?(h=O("size-[54px] border-0 transition-all",l),e[9]=l,e[10]=h):h=e[10];const _=a||"";let y;e[11]!==N||e[12]!==_?(y=(0,t.jsx)(me,{src:N,alt:_,className:"object-cover"}),e[11]=N,e[12]=_,e[13]=y):y=e[13];let S;e[14]!==a?.[0]?(S=a?.[0]?.toUpperCase(),e[14]=a?.[0],e[15]=S):S=e[15];let z;e[16]!==S?(z=(0,t.jsx)(xe,{className:"bg-gradient-to-br from-violet-100 to-violet-200 text-violet-700 font-bold text-xl dark:from-zinc-800 dark:to-zinc-700 dark:text-zinc-300",children:S}),e[16]=S,e[17]=z):z=e[17];let C;e[18]!==z||e[19]!==h||e[20]!==y?(C=(0,t.jsxs)(ue,{className:h,children:[y,z]}),e[18]=z,e[19]=h,e[20]=y,e[21]=C):C=e[21];let M;e[22]!==d||e[23]!==n?(M=d&&!n&&(0,t.jsx)("span",{className:"absolute bottom-0.5 right-0.5 size-3.5 rounded-full border-[2.5px] border-white bg-emerald-500 ring-0 dark:border-black"}),e[22]=d,e[23]=n,e[24]=M):M=e[24];let x;e[25]!==C||e[26]!==M?(x=(0,t.jsxs)("div",{className:"relative shrink-0",children:[C,M]}),e[25]=C,e[26]=M,e[27]=x):x=e[27];const c=n?"text-white":"text-zinc-900 dark:text-zinc-100";let p;e[28]!==c?(p=O("truncate text-[16px] font-bold tracking-tight leading-tight",c),e[28]=c,e[29]=p):p=e[29];let v;e[30]!==s.isMuted?(v=s.isMuted&&(0,t.jsx)("span",{className:"ml-1 text-zinc-400 dark:text-zinc-500",children:"î§º"}),e[30]=s.isMuted,e[31]=v):v=e[31];let w;e[32]!==a||e[33]!==p||e[34]!==v?(w=(0,t.jsxs)("span",{className:p,children:[a,v]}),e[32]=a,e[33]=p,e[34]=v,e[35]=w):w=e[35];const $=n?"text-white/80":"text-zinc-400 dark:text-zinc-500";let m;e[36]!==$?(m=O("shrink-0 text-[12px] font-medium ml-2",$),e[36]=$,e[37]=m):m=e[37];let G;e[38]!==s.time||e[39]!==m?(G=(0,t.jsx)("span",{className:m,children:s.time}),e[38]=s.time,e[39]=m,e[40]=G):G=e[40];let L;e[41]!==w||e[42]!==G?(L=(0,t.jsxs)("div",{className:"flex items-center justify-between gap-1",children:[w,G]}),e[41]=w,e[42]=G,e[43]=L):L=e[43];let P;e[44]!==s.currentUserSent||e[45]!==s.isGroup||e[46]!==s.lastMessage||e[47]!==s.lastMessageSender||e[48]!==j||e[49]!==n||e[50]!==u?(P=u?(0,t.jsx)("p",{className:O("truncate text-[14px] leading-relaxed flex-1 italic animate-pulse",n?"text-white/90":"text-violet-500 dark:text-violet-400 font-medium"),children:"typing..."}):(0,t.jsxs)("p",{className:O("truncate text-[14px] leading-relaxed flex-1",n?"text-white/90":j?"text-zinc-900 font-medium dark:text-zinc-200":"text-zinc-500 dark:text-zinc-400"),children:[s.isGroup&&s.lastMessageSender&&(0,t.jsxs)("span",{className:O("font-semibold mr-1",n?"text-white":"text-violet-500 dark:text-violet-400"),children:[s.lastMessageSender,":"]}),s.currentUserSent&&!s.lastMessageSender&&"You: ",s.lastMessage]}),e[44]=s.currentUserSent,e[45]=s.isGroup,e[46]=s.lastMessage,e[47]=s.lastMessageSender,e[48]=j,e[49]=n,e[50]=u,e[51]=P):P=e[51];let D;e[52]!==s.unread||e[53]!==j||e[54]!==n?(D=j&&(0,t.jsx)("span",{className:O("flex min-w-[20px] h-[20px] px-1.5 items-center justify-center rounded-full text-[11px] font-bold shadow-sm",n?"bg-white text-violet-600":"bg-violet-600 text-white dark:bg-violet-500"),children:s.unread}),e[52]=s.unread,e[53]=j,e[54]=n,e[55]=D):D=e[55];let E;e[56]!==P||e[57]!==D?(E=(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2 mt-0.5",children:[P,D]}),e[56]=P,e[57]=D,e[58]=E):E=e[58];let A;e[59]!==L||e[60]!==E?(A=(0,t.jsxs)("div",{className:"min-w-0 flex-1 flex flex-col justify-center py-1",children:[L,E]}),e[59]=L,e[60]=E,e[61]=A):A=e[61];let V;return e[62]!==x||e[63]!==f||e[64]!==A||e[65]!==k?(V=(0,t.jsxs)("div",{onClick:f,className:k,children:[x,A]}),e[62]=x,e[63]=f,e[64]=A,e[65]=k,e[66]=V):V=e[66],V},mt=({conversations:i,userResults:e=[],onSelect:s,onStartNew:r,selectedId:g,searchQuery:o,onSearchChange:u,onlineUsers:b=new Set,typingStatus:d={}})=>{const[n,j]=(0,I.useState)(!1),[a,N]=(0,I.useState)("all"),f=i.filter(l=>b.has(l.user?.id)),T=i.filter(l=>a==="unread"?l.unread>0:a==="groups"?l.isGroup:!0),k=[{id:"all",label:"All"},{id:"unread",label:"Unread",count:i.filter(l=>l.unread>0).length},{id:"groups",label:"Groups"}];return(0,t.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col overflow-hidden bg-white dark:bg-[#0f0f0f] h-full shadow-inner",children:[(0,t.jsxs)("div",{className:"px-4 md:px-4 pt-4 pb-2 shrink-0 w-full overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,t.jsxs)("div",{className:"relative flex-1 group min-w-0",children:[(0,t.jsx)(ve,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-zinc-400 group-focus-within:text-violet-500 transition-colors",size:18}),(0,t.jsx)("input",{type:"text",value:o,onChange:l=>u(l.target.value),placeholder:"Search",className:"w-full rounded-full border-none bg-zinc-100 py-2.5 pl-11 pr-4 text-sm font-medium text-zinc-900 placeholder:text-zinc-500 transition-all focus:bg-white focus:ring-2 focus:ring-violet-500/20 dark:bg-zinc-900 dark:text-white dark:focus:bg-black"})]}),(0,t.jsx)("button",{onClick:()=>j(!0),className:"shrink-0 rounded-full bg-zinc-100 p-2.5 text-zinc-600 transition-colors hover:bg-zinc-200 dark:bg-zinc-900 dark:text-zinc-400 dark:hover:bg-zinc-800",children:(0,t.jsx)(Ie,{size:20})})]}),(0,t.jsx)("div",{className:"flex items-center gap-1 border-b border-zinc-100 dark:border-zinc-800 mb-1",children:k.map(l=>(0,t.jsxs)("button",{onClick:()=>N(l.id),className:O("relative flex items-center px-4 py-2.5 text-[13px] font-bold transition-all",a===l.id?"text-violet-600 dark:text-violet-400":"text-zinc-500 hover:text-zinc-700 dark:text-zinc-400 dark:hover:text-zinc-200"),children:[l.label,l.count?(0,t.jsx)("span",{className:"ml-1.5 flex size-4 items-center justify-center rounded-full bg-violet-600/10 text-[9px] dark:bg-violet-400/10",children:l.count}):null,a===l.id&&(0,t.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-[3px] bg-violet-600 dark:bg-violet-400 rounded-t-full"})]},l.id))})]}),(0,t.jsx)("div",{className:"flex-1 min-h-0 overflow-hidden",children:(0,t.jsx)(st,{className:"h-full min-w-0",children:(0,t.jsxs)("div",{className:"flex flex-col pb-4 min-w-0",children:[!o&&a==="all"&&f.length>0&&(0,t.jsx)("div",{className:"mb-4 mt-2 min-w-0 w-full overflow-hidden",children:(0,t.jsxs)("div",{className:"flex gap-4 overflow-x-auto px-4 md:px-5 pb-4 pt-2 no-scrollbar w-full",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2 min-w-[64px] cursor-pointer group",children:[(0,t.jsxs)("div",{className:"relative flex size-[60px] items-center justify-center rounded-full bg-zinc-50 border border-zinc-200 dark:bg-zinc-900 dark:border-zinc-800 group-hover:bg-zinc-100 dark:group-hover:bg-zinc-800 transition-colors",children:[(0,t.jsx)(be,{size:24,className:"text-zinc-400"}),(0,t.jsx)("div",{className:"absolute bottom-0 right-0 size-5 bg-white dark:bg-black rounded-full flex items-center justify-center",children:(0,t.jsx)("div",{className:"size-4 bg-zinc-200 dark:bg-zinc-700 rounded-full flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-[10px] text-zinc-500 font-bold",children:"+"})})})]}),(0,t.jsx)("span",{className:"text-[11px] font-medium text-zinc-500",children:"Your Story"})]}),f.map(l=>(0,t.jsxs)("div",{onClick:()=>s(l),className:"flex flex-col items-center gap-2 cursor-pointer group min-w-[64px] transition-transform active:scale-95",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute -inset-[3px] rounded-full bg-gradient-to-tr from-violet-500 via-fuchsia-500 to-orange-500 opacity-90 p-[2px]"}),(0,t.jsx)("div",{className:"relative rounded-full border-[3px] border-white dark:border-black p-[2px] bg-white dark:bg-black",children:(0,t.jsxs)(ue,{className:"size-[50px]",children:[(0,t.jsx)(me,{src:l.user?.avatar,className:"object-cover"}),(0,t.jsx)(xe,{children:l.user?.name?.[0]})]})}),(0,t.jsx)("span",{className:"absolute bottom-1 right-1 size-3.5 rounded-full border-[2.5px] border-white bg-emerald-500 dark:border-black"})]}),(0,t.jsx)("span",{className:"w-full truncate text-center text-[11px] font-medium text-zinc-600 dark:text-zinc-400 group-hover:text-zinc-900 dark:group-hover:text-white transition-colors",children:l.user?.name.split(" ")[0]})]},l.id))]})}),(0,t.jsx)("div",{className:"px-2 space-y-0.5 mt-2",children:T.length>0&&T.filter(l=>l.lastMessage!=="No messages yet"||l.id===g||o).map(l=>(0,t.jsx)(xt,{conv:l,selectedId:g,onSelect:s,onlineUsers:b,isTyping:d[l.id]},l.id))}),e.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"px-6 py-3 mt-2 text-xs font-bold uppercase tracking-wider text-zinc-400",children:"More People"}),(0,t.jsx)("div",{className:"px-2 space-y-1",children:e.map(l=>(0,t.jsxs)("div",{onClick:()=>r(l),className:"flex cursor-pointer items-center gap-4 px-3 py-2 rounded-2xl transition-colors hover:bg-zinc-100 dark:hover:bg-zinc-800/50",children:[(0,t.jsxs)(ue,{className:"size-10",children:[(0,t.jsx)(me,{src:l.avatar,className:"object-cover"}),(0,t.jsx)(xe,{children:l.name?.[0]?.toUpperCase()})]}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("div",{className:"truncate text-sm font-bold text-zinc-900 dark:text-white",children:l.name}),(0,t.jsxs)("div",{className:"truncate text-xs text-zinc-500",children:["@",l.handle]})]}),(0,t.jsx)("button",{className:"flex size-8 items-center justify-center rounded-full bg-violet-50 text-violet-600 dark:bg-violet-900/20 dark:text-violet-400",children:(0,t.jsx)(be,{size:16})})]},l.id))})]}),i.length===0&&e.length===0&&o&&(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center px-6",children:[(0,t.jsx)("div",{className:"mb-4 rounded-full bg-zinc-100 p-4 dark:bg-zinc-900",children:(0,t.jsx)(ve,{className:"text-zinc-400",size:24})}),(0,t.jsxs)("p",{className:"text-zinc-500",children:['No results found for "',o,'"']})]})]})})}),(0,t.jsx)(tt,{isOpen:n,onClose:()=>j(!1),onCreated:l=>{s({id:l,isGroup:!0})}})]})},ut=mt,ft=re();function pt(){const i=(0,ft.c)(4);let e;i[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,t.jsx)(ie,{className:"h-8 w-8 rounded-full"}),i[0]=e):e=i[0];let s;i[1]===Symbol.for("react.memo_cache_sentinel")?(s=(0,t.jsxs)("div",{className:"flex items-end gap-2 self-start",children:[e,(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(ie,{className:"h-10 w-48 rounded-2xl rounded-bl-sm"}),(0,t.jsx)(ie,{className:"h-10 w-32 rounded-2xl rounded-bl-sm"})]})]}),i[1]=s):s=i[1];let r;i[2]===Symbol.for("react.memo_cache_sentinel")?(r=(0,t.jsx)("div",{className:"flex items-end gap-2 self-end",children:(0,t.jsxs)("div",{className:"space-y-2 flex flex-col items-end",children:[(0,t.jsx)(ie,{className:"h-10 w-40 rounded-2xl rounded-br-sm"}),(0,t.jsx)(ie,{className:"h-24 w-64 rounded-2xl rounded-br-sm"})]})}),i[2]=r):r=i[2];let g;return i[3]===Symbol.for("react.memo_cache_sentinel")?(g=(0,t.jsxs)("div",{className:"flex w-full flex-col gap-4 p-4",children:[s,r,(0,t.jsxs)("div",{className:"flex items-end gap-2 self-start",children:[(0,t.jsx)(ie,{className:"h-8 w-8 rounded-full"}),(0,t.jsx)(ie,{className:"h-14 w-56 rounded-2xl rounded-bl-sm"})]})]}),i[3]=g):g=i[3],g}var ht=re(),gt=i=>{const e=(0,ht.c)(45),{conversation:s,isOnline:r,onBack:g,onOpenSettings:o}=i,u=Me(),b=lt(s.user?.lastSeen),d=s.isGroup?s.name:s.user?.name,n=s.isGroup?s.avatar:s.user?.avatar;let j;e[0]===Symbol.for("react.memo_cache_sentinel")?(j=(0,t.jsx)(Ae,{size:24}),e[0]=j):j=e[0];let a;e[1]!==s.unread?(a=s.unread>0&&(0,t.jsx)("span",{className:"absolute -top-1 -right-1 flex h-5 min-w-[20px] items-center justify-center rounded-full bg-violet-500 px-1 text-[11px] font-bold text-white ring-2 ring-white dark:ring-[#212121]",children:s.unread}),e[1]=s.unread,e[2]=a):a=e[2];let N;e[3]!==g||e[4]!==a?(N=(0,t.jsxs)("button",{onClick:g,className:"relative flex items-center justify-center size-11 rounded-full text-zinc-500 transition-colors hover:bg-zinc-100 dark:text-zinc-400 dark:hover:bg-white/5 md:hidden",children:[j,a]}),e[3]=g,e[4]=a,e[5]=N):N=e[5];let f;e[6]!==s.isGroup||e[7]!==s.user||e[8]!==u?(f=()=>!s.isGroup&&s.user&&u(`/u/${s.user.handle}`),e[6]=s.isGroup,e[7]=s.user,e[8]=u,e[9]=f):f=e[9];const T=d||"";let k;e[10]!==n||e[11]!==T?(k=(0,t.jsx)(me,{src:n,alt:T,className:"object-cover"}),e[10]=n,e[11]=T,e[12]=k):k=e[12];let l;e[13]!==d?.[0]?(l=d?.[0]?.toUpperCase(),e[13]=d?.[0],e[14]=l):l=e[14];let h;e[15]!==l?(h=(0,t.jsx)(xe,{className:"bg-gradient-to-br from-violet-100 to-violet-200 text-violet-700 font-bold dark:from-zinc-800 dark:to-zinc-700 dark:text-zinc-300",children:l}),e[15]=l,e[16]=h):h=e[16];let _;e[17]!==k||e[18]!==h?(_=(0,t.jsxs)(ue,{className:"size-[42px] shrink-0",children:[k,h]}),e[17]=k,e[18]=h,e[19]=_):_=e[19];let y;e[20]!==d?(y=(0,t.jsx)("h3",{className:"text-[16px] font-bold text-zinc-900 dark:text-white truncate leading-tight",children:d}),e[20]=d,e[21]=y):y=e[21];let S;e[22]!==s.isGroup||e[23]!==s.user?.lastSeen||e[24]!==r||e[25]!==b?(S=s.isGroup?"Group Chat":r?(0,t.jsx)("span",{className:"text-violet-500 dark:text-[#8774e1]",children:"Active now"}):s.user?.lastSeen?`last seen ${b}`:"offline",e[22]=s.isGroup,e[23]=s.user?.lastSeen,e[24]=r,e[25]=b,e[26]=S):S=e[26];let z;e[27]!==S?(z=(0,t.jsx)("span",{className:"text-[13px] text-zinc-500 dark:text-[#aaaaaa] leading-tight",children:S}),e[27]=S,e[28]=z):z=e[28];let C;e[29]!==y||e[30]!==z?(C=(0,t.jsxs)("div",{className:"flex flex-col min-w-0",children:[y,z]}),e[29]=y,e[30]=z,e[31]=C):C=e[31];let M;e[32]!==C||e[33]!==f||e[34]!==_?(M=(0,t.jsxs)("div",{className:"flex items-center gap-3 px-2 flex-1 min-w-0 cursor-pointer",onClick:f,children:[_,C]}),e[32]=C,e[33]=f,e[34]=_,e[35]=M):M=e[35];let x;e[36]!==M||e[37]!==N?(x=(0,t.jsxs)("div",{className:"flex items-center gap-1 w-full max-w-full",children:[N,M]}),e[36]=M,e[37]=N,e[38]=x):x=e[38];let c;e[39]===Symbol.for("react.memo_cache_sentinel")?(c=(0,t.jsx)(Ge,{size:22}),e[39]=c):c=e[39];let p;e[40]!==o?(p=(0,t.jsx)("div",{className:"flex items-center gap-0.5 pr-1",children:(0,t.jsx)("button",{onClick:o,className:"flex size-10 items-center justify-center rounded-full text-zinc-500 hover:bg-zinc-100 dark:text-[#aaaaaa] dark:hover:bg-white/5 transition-colors",children:c})}),e[40]=o,e[41]=p):p=e[41];let v;return e[42]!==x||e[43]!==p?(v=(0,t.jsxs)("div",{className:"sticky top-0 z-40 flex shrink-0 items-center justify-between bg-white/95 px-2 py-1.5 backdrop-blur-md dark:bg-[#212121]/95 transition-all h-[56px]",children:[x,p]}),e[42]=x,e[43]=p,e[44]=v):v=e[44],v},bt=gt,vt=re(),jt=i=>{const e=(0,vt.c)(68),{onSendMessage:s,onTyping:r,replyingTo:g,setReplyingTo:o,editingMessage:u,setEditingMessage:b}=i,[d,n]=(0,I.useState)("");let j;e[0]===Symbol.for("react.memo_cache_sentinel")?(j=[],e[0]=j):j=e[0];const[a,N]=(0,I.useState)(j),[f,T]=(0,I.useState)(!1),k=(0,I.useRef)(null),l=(0,I.useRef)(null),h=ot(d);let _,y;e[1]!==u||e[2]!==o||e[3]!==h?(_=()=>{u&&(n(u.text),o(null),h.current&&h.current.focus())},y=[u,o,h],e[1]=u,e[2]=o,e[3]=h,e[4]=_,e[5]=y):(_=e[4],y=e[5]),I.useEffect(_,y);const{isRecording:S,recordingTime:z,startRecording:C,stopRecording:M,cancelRecording:x,audioBlob:c,audioUrl:p,clearAudio:v}=Ye(),[w,$]=(0,I.useState)(!1),m=(0,I.useRef)(null),G=yt,L=(0,I.useRef)(0);let P;e[6]!==r?(P=R=>{const X=R.target.value;if(n(X),r){const U=Date.now();U-L.current>3e3&&(r(!0),L.current=U),l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{r(!1),L.current=0},2e3)}},e[6]=r,e[7]=P):P=e[7];const D=P;let E;e[8]!==a||e[9]!==c||e[10]!==v||e[11]!==s||e[12]!==r||e[13]!==z||e[14]!==o||e[15]!==d||e[16]!==h?(E=R=>{if(R&&R.preventDefault(),c){s("",[],c,z),v();return}!d.trim()&&a.length===0||(r&&(l.current&&clearTimeout(l.current),r(!1)),s(d,a),n(""),N([]),o(null),setTimeout(()=>{h.current?.focus()},10))},e[8]=a,e[9]=c,e[10]=v,e[11]=s,e[12]=r,e[13]=z,e[14]=o,e[15]=d,e[16]=h,e[17]=E):E=e[17];const A=E;let V;e[18]!==p||e[19]!==w?(V=()=>{p&&(m.current||(m.current=new Audio(p),m.current.onended=()=>$(!1)),w?m.current.pause():m.current.play(),$(!w))},e[18]=p,e[19]=w,e[20]=V):V=e[20];const le=V;let J,Z;e[21]!==c?(J=()=>{!c&&m.current&&(m.current.pause(),m.current=null,$(!1))},Z=[c],e[21]=c,e[22]=J,e[23]=Z):(J=e[22],Z=e[23]),I.useEffect(J,Z);let Q;e[24]===Symbol.for("react.memo_cache_sentinel")?(Q=R=>{if(!R.target.files)return;const X=Array.from(R.target.files);N(U=>[...U,...X])},e[24]=Q):Q=e[24];const ne=Q;let F;e[25]!==a?(F=a.length>0&&(0,t.jsx)(oe.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},exit:{y:20,opacity:0},className:"flex gap-2 overflow-x-auto mx-auto mb-2 px-2 py-2 bg-white dark:bg-[#212121] rounded-2xl shadow-lg border border-zinc-100 dark:border-zinc-800 max-w-3xl no-scrollbar",children:a.map((R,X)=>(0,t.jsxs)("div",{className:"relative size-20 shrink-0 rounded-xl overflow-hidden border border-zinc-200 dark:border-zinc-700 group",children:[R.type.startsWith("video/")?(0,t.jsx)("div",{className:"size-full bg-black flex items-center justify-center",children:(0,t.jsx)(Ne,{size:20,className:"text-white opacity-50"})}):(0,t.jsx)("img",{src:URL.createObjectURL(R),className:"size-full object-cover"}),(0,t.jsx)("button",{type:"button",onClick:()=>N(U=>U.filter((ce,we)=>we!==X)),className:"absolute top-1 right-1 size-6 flex items-center justify-center rounded-full bg-black/50 text-white hover:bg-black/70 transition-colors",children:(0,t.jsx)(ge,{size:14})})]},X))}),e[25]=a,e[26]=F):F=e[26];let q;e[27]!==u||e[28]!==g||e[29]!==b||e[30]!==o?(q=(g||u)&&(0,t.jsxs)(oe.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},exit:{y:20,opacity:0},className:"flex items-center justify-between mx-auto mb-1.5 px-4 py-2 bg-white dark:bg-[#212121] rounded-2xl shadow-lg border border-zinc-100 dark:border-zinc-800 max-w-3xl",children:[(0,t.jsxs)("div",{className:"text-sm flex items-center gap-3 min-w-0",children:[(0,t.jsx)("div",{className:"size-8 flex items-center justify-center rounded-full bg-violet-500/10 text-violet-500",children:u?(0,t.jsx)(Le,{size:16}):(0,t.jsx)(fe,{size:16})}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("span",{className:"text-[13px] font-bold text-violet-500 block leading-tight",children:u?"Edit Message":`Reply to ${g.sender==="me"?"yourself":g.senderName}`}),(0,t.jsx)("p",{className:"truncate text-xs text-zinc-500 dark:text-[#aaaaaa]",children:u?u.text:g.text})]})]}),(0,t.jsx)("button",{onClick:()=>{o(null),b(null),u&&n("")},className:"p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-white/10",children:(0,t.jsx)(ge,{size:18,className:"text-zinc-400"})})]}),e[27]=u,e[28]=g,e[29]=b,e[30]=o,e[31]=q):q=e[31];let B;e[32]!==F||e[33]!==q?(B=(0,t.jsxs)(ke,{children:[F,q]}),e[32]=F,e[33]=q,e[34]=B):B=e[34];const ae=(S||c)&&"bg-zinc-900 ring-red-500/50";let H;e[35]!==ae?(H=O("flex-1 flex items-center gap-1 rounded-[24px] px-1.5 py-1.5 transition-all bg-white dark:bg-[#212121] shadow-md border-0 ring-1 ring-zinc-200 dark:ring-zinc-800 focus-within:ring-violet-500/30",ae),e[35]=ae,e[36]=H):H=e[36];let ee;e[37]!==c||e[38]!==x||e[39]!==v||e[40]!==A||e[41]!==D||e[42]!==f||e[43]!==w||e[44]!==S||e[45]!==z||e[46]!==d||e[47]!==h||e[48]!==le?(ee=S?(0,t.jsxs)("div",{className:"flex-1 flex items-center gap-4 px-3 py-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(oe.div,{animate:{scale:[1,1.2,1]},transition:{repeat:1/0},className:"size-2 rounded-full bg-red-500"}),(0,t.jsx)("span",{className:"text-[15px] font-medium tabular-nums text-red-500",children:G(z)})]}),(0,t.jsx)("div",{className:"flex-1 text-center text-sm text-zinc-500",children:"Recording..."}),(0,t.jsx)("button",{type:"button",onClick:x,className:"p-2 text-zinc-400 hover:text-red-500",children:(0,t.jsx)(he,{size:20})})]}):c?(0,t.jsxs)("div",{className:"flex-1 flex items-center gap-3 px-3 py-1",children:[(0,t.jsx)("button",{type:"button",onClick:le,className:"size-10 flex items-center justify-center rounded-full bg-[#8774e1] text-white",children:w?(0,t.jsx)(je,{size:16,fill:"currentColor"}):(0,t.jsx)(Ne,{size:20,fill:"currentColor",className:"ml-0.5"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"h-1 bg-zinc-800 rounded-full overflow-hidden",children:(0,t.jsx)(oe.div,{initial:{width:0},animate:{width:w?"100%":"0%"},transition:{duration:z,ease:"linear"},className:"h-full bg-[#8774e1]"})}),(0,t.jsxs)("div",{className:"flex justify-between mt-1",children:[(0,t.jsx)("span",{className:"text-[10px] text-zinc-500",children:"Voice message"}),(0,t.jsx)("span",{className:"text-[10px] text-zinc-500 tabular-nums",children:G(z)})]})]}),(0,t.jsx)("button",{type:"button",onClick:v,className:"p-2 text-zinc-400 hover:text-red-500",children:(0,t.jsx)(he,{size:20})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(Ke,{open:f,onOpenChange:T,children:[(0,t.jsx)(et,{asChild:!0,children:(0,t.jsx)("button",{type:"button",className:"p-2 text-zinc-400 hover:text-violet-500 dark:text-[#aaaaaa] dark:hover:text-[#8774e1] transition-colors",children:(0,t.jsx)($e,{size:24})})}),(0,t.jsx)(Xe,{className:"p-0 border-none bg-transparent",side:"top",align:"start",children:(0,t.jsx)(at,{onEmojiSelect:R=>n(X=>X+R.emoji)})})]}),(0,t.jsx)("textarea",{ref:h,value:d,onChange:D,onKeyDown:R=>{R.key==="Enter"&&!R.shiftKey&&(R.preventDefault(),A())},placeholder:"Message",className:"flex-1 bg-transparent border-none outline-none text-[16px] resize-none py-2 px-1 text-zinc-900 dark:text-white placeholder:text-zinc-500 dark:placeholder:text-[#aaaaaa] min-h-[40px] max-h-[200px]",rows:1}),(0,t.jsx)("button",{type:"button",onClick:()=>k.current?.click(),className:"p-2 text-zinc-400 hover:text-violet-500 dark:text-[#aaaaaa] dark:hover:text-[#8774e1] transition-colors",children:(0,t.jsx)(Oe,{size:24,className:"-rotate-45"})})]}),e[37]=c,e[38]=x,e[39]=v,e[40]=A,e[41]=D,e[42]=f,e[43]=w,e[44]=S,e[45]=z,e[46]=d,e[47]=h,e[48]=le,e[49]=ee):ee=e[49];let W;e[50]!==H||e[51]!==ee?(W=(0,t.jsx)("div",{className:H,children:ee}),e[50]=H,e[51]=ee,e[52]=W):W=e[52];let Y;e[53]!==a.length||e[54]!==c||e[55]!==A||e[56]!==S||e[57]!==C||e[58]!==M||e[59]!==d?(Y=d.trim()||a.length>0||c?(0,t.jsx)("button",{onClick:A,className:"size-[50px] shrink-0 flex items-center justify-center rounded-full bg-[#8774e1] text-white shadow-md hover:scale-105 transition-transform",children:(0,t.jsx)(Ve,{size:24})}):S?(0,t.jsx)("button",{onClick:M,className:"size-[50px] shrink-0 flex items-center justify-center rounded-full bg-red-500 text-white shadow-md hover:scale-105 transition-transform",children:(0,t.jsx)(je,{size:20,fill:"currentColor"})}):(0,t.jsx)("button",{onClick:C,className:"size-[50px] shrink-0 flex items-center justify-center rounded-full bg-zinc-200 dark:bg-[#212121] text-zinc-500 dark:text-[#aaaaaa] shadow-md hover:scale-105 transition-transform",children:(0,t.jsx)(Pe,{size:24})}),e[53]=a.length,e[54]=c,e[55]=A,e[56]=S,e[57]=C,e[58]=M,e[59]=d,e[60]=Y):Y=e[60];let K;e[61]!==W||e[62]!==Y?(K=(0,t.jsxs)("div",{className:"flex items-end gap-2 max-w-3xl mx-auto",children:[W,Y]}),e[61]=W,e[62]=Y,e[63]=K):K=e[63];let te;e[64]===Symbol.for("react.memo_cache_sentinel")?(te=(0,t.jsx)("input",{type:"file",ref:k,onChange:ne,className:"hidden",multiple:!0,accept:"image/*,video/*"}),e[64]=te):te=e[64];let se;return e[65]!==B||e[66]!==K?(se=(0,t.jsxs)("div",{className:"shrink-0 p-2 md:p-3 relative z-20",children:[B,K,te]}),e[65]=B,e[66]=K,e[67]=se):se=e[67],se},Nt=jt;function yt(i){return`${Math.floor(i/60)}:${(i%60).toString().padStart(2,"0")}`}var Yt=re(),zt=re(),wt=i=>{const e=(0,zt.c)(10),{reactions:s,currentUser:r,onToggle:g}=i;let o;e[0]!==s?(o=s===void 0?[]:s,e[0]=s,e[1]=o):o=e[1];const u=o;let b;e[2]!==r?.id||e[3]!==u?(b={},u.forEach(a=>{b[a.emoji]||(b[a.emoji]={count:0,me:!1}),b[a.emoji].count=b[a.emoji].count+1,a.user_id===r?.id&&(b[a.emoji].me=!0)}),e[2]=r?.id,e[3]=u,e[4]=b):b=e[4];const d=b;if(u.length===0)return null;let n;e[5]!==d?(n=Object.entries(d),e[5]=d,e[6]=n):n=e[6];let j;return e[7]!==g||e[8]!==n?(j=(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:n.map(a=>{const[N,f]=a;return(0,t.jsxs)("button",{onClick:T=>{T.stopPropagation(),g(N)},className:O("pointer-events-auto flex items-center gap-1 rounded-full border px-1.5 py-0.5 text-[11px] font-bold shadow-sm transition-all hover:scale-110 active:scale-90",f.me?"bg-violet-50 border-violet-200 text-violet-600 dark:bg-violet-900/30 dark:border-violet-800 dark:text-violet-400":"bg-white border-zinc-100 text-zinc-700 dark:bg-zinc-800 dark:border-zinc-700 dark:text-zinc-300"),children:[(0,t.jsx)("span",{className:"leading-none",children:N}),f.count>1&&(0,t.jsx)("span",{className:"text-[10px] leading-none opacity-80",children:f.count})]},N)})}),e[7]=g,e[8]=n,e[9]=j):j=e[9],j},kt=wt,St=re(),_t=I.lazy(()=>Te(()=>import("./VoiceMessage-PxSIXe1Q.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),Ct=i=>{const e=(0,St.c)(98),{msg:s,isMe:r,isLastInGroup:g,setReplyingTo:o,handleImageClick:u,handleVoiceMessage:b,onDeleteMessage:d,setEditingMessage:n,onToggleReaction:j,currentUser:a}=i,N=_e(0);let f,T;e[0]===Symbol.for("react.memo_cache_sentinel")?(f=[0,-60],T=[0,1],e[0]=f,e[1]=T):(f=e[0],T=e[1]);const k=pe(N,f,T);let l,h;e[2]===Symbol.for("react.memo_cache_sentinel")?(l=[0,-60],h=[.5,1.1],e[2]=l,e[3]=h):(l=e[2],h=e[3]);const _=pe(N,l,h);let y;e[4]!==s||e[5]!==o?(y=(U,ce)=>{ce.offset.x<-60&&(o(s),window.navigator.vibrate&&window.navigator.vibrate(10))},e[4]=s,e[5]=o,e[6]=y):y=e[6];const S=y,z=`msg-${s.id}`;let C,M;e[7]===Symbol.for("react.memo_cache_sentinel")?(C={opacity:0,y:5},M={opacity:1,y:0},e[7]=C,e[8]=M):(C=e[7],M=e[8]);const x=r?"justify-end":"justify-start",c=g&&"mb-3";let p;e[9]!==c||e[10]!==x?(p=O("flex w-full group relative overflow-visible",x,c),e[9]=c,e[10]=x,e[11]=p):p=e[11];let v;e[12]!==k||e[13]!==_?(v={opacity:k,scale:_,right:10},e[12]=k,e[13]=_,e[14]=v):v=e[14];let w;e[15]===Symbol.for("react.memo_cache_sentinel")?(w=(0,t.jsx)(fe,{size:20}),e[15]=w):w=e[15];let $;e[16]!==v?($=(0,t.jsx)(oe.div,{style:v,className:"absolute top-1/2 -translate-y-1/2 flex items-center justify-center size-10 rounded-full bg-violet-500/10 text-violet-500 z-0 pointer-events-none",children:w}),e[16]=v,e[17]=$):$=e[17];let m;e[18]===Symbol.for("react.memo_cache_sentinel")?(m={left:-80,right:0},e[18]=m):m=e[18];let G;e[19]!==N?(G={x:N},e[19]=N,e[20]=G):G=e[20];const L=r?"flex-row-reverse":"flex-row";let P;e[21]!==L?(P=O("flex max-w-[85%] md:max-w-[70%] items-end gap-1.5 z-10 touch-pan-y",L),e[21]=L,e[22]=P):P=e[22];const D=r?"items-end":"items-start";let E;e[23]!==D?(E=O("relative flex flex-col min-w-[60px]",D),e[23]=D,e[24]=E):E=e[24];const A=r?"bg-[#8774e1] text-white border border-[#7059d0]":"bg-white text-zinc-900 dark:bg-[#212121] dark:text-white",V=s.isOptimistic&&"opacity-60 grayscale-[0.5]";let le;e[25]!==A||e[26]!==V?(le=O("relative px-3 py-1.5 shadow-sm text-[15px] leading-[1.4] transition-all",A,"rounded-[15px]",V),e[25]=A,e[26]=V,e[27]=le):le=e[27];let J;e[28]!==a?.name||e[29]!==r||e[30]!==s.replyTo?(J=s.replyTo&&(0,t.jsxs)("div",{className:O("mb-1.5 -mx-1 px-2.5 py-1.5 rounded-xl text-xs border-l-2 cursor-pointer transition-all hover:opacity-80",r?"bg-black/10 border-white/40 text-white/90":"bg-zinc-100 border-zinc-300 text-zinc-600 dark:bg-zinc-800 dark:border-zinc-600 dark:text-zinc-300"),onClick:U=>{U.stopPropagation();const ce=document.getElementById(`msg-${s.replyTo.id}`);ce&&ce.scrollIntoView({behavior:"smooth",block:"center"})},children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5 mb-0.5 opacity-75",children:[(0,t.jsx)(fe,{size:12}),(0,t.jsx)("span",{className:"font-bold truncate",children:s.replyTo.senderName===a?.name?"You":s.replyTo.senderName})]}),(0,t.jsx)("div",{className:"truncate opacity-90 text-[11px]",children:s.replyTo.text})]}),e[28]=a?.name,e[29]=r,e[30]=s.replyTo,e[31]=J):J=e[31];let Z;e[32]!==u||e[33]!==s?(Z=s.media?.length>0&&s.type!=="voice"&&(0,t.jsx)("div",{className:O("relative -mx-3 overflow-hidden shadow-sm",!s.replyTo&&"-mt-1.5",!s.text&&"-mb-1.5",s.text&&"mb-1.5","rounded-[15px]"),children:s.media.map((U,ce)=>(0,t.jsx)("div",{className:"relative group/media min-w-[280px] md:min-w-[400px]",children:s.type==="video"?(0,t.jsx)("div",{className:"aspect-video w-full bg-black",children:(0,t.jsx)(rt,{src:U.url,poster:U.poster})}):(0,t.jsx)("img",{src:U.url,className:"max-h-[400px] md:max-h-[500px] w-full object-cover cursor-pointer hover:brightness-95 transition-all",onClick:()=>u(s)})},ce))}),e[32]=u,e[33]=s,e[34]=Z):Z=e[34];let Q;e[35]!==b||e[36]!==r||e[37]!==s.media||e[38]!==s.type?(Q=s.type==="voice"&&s.media?.[0]&&(0,t.jsx)(I.Suspense,{fallback:(0,t.jsx)("div",{className:"h-12 w-48 animate-pulse bg-zinc-100 dark:bg-zinc-800 rounded-xl"}),children:b(s.media[0].url,s.media[0].duration,r)}),e[35]=b,e[36]=r,e[37]=s.media,e[38]=s.type,e[39]=Q):Q=e[39];let ne;e[40]!==s.text||e[41]!==s.type?(ne=s.text&&s.type!=="voice"&&(0,t.jsx)("div",{className:"whitespace-pre-wrap break-words pr-12",children:(0,t.jsx)(nt,{options:{...ct,className:"underline"},children:s.text})}),e[40]=s.text,e[41]=s.type,e[42]=ne):ne=e[42];let F;e[43]!==r||e[44]!==s.isOptimistic||e[45]!==s.isRead||e[46]!==s.text||e[47]!==s.time||e[48]!==s.type?(F=(s.text||s.type==="voice")&&(0,t.jsxs)("div",{className:O("absolute bottom-1 right-1.5 flex items-center gap-0.5 select-none",r?"text-white/70":"text-[#aaaaaa]"),children:[(0,t.jsx)("span",{className:"text-[10px]",children:s.isOptimistic?"sending...":s.time}),r&&!s.isOptimistic&&(s.isRead?(0,t.jsx)(Ee,{size:13,className:"text-white"}):(0,t.jsx)(De,{size:13,className:"text-white/60"}))]}),e[43]=r,e[44]=s.isOptimistic,e[45]=s.isRead,e[46]=s.text,e[47]=s.time,e[48]=s.type,e[49]=F):F=e[49];let q;e[50]!==le||e[51]!==J||e[52]!==Z||e[53]!==Q||e[54]!==ne||e[55]!==F?(q=(0,t.jsx)(Fe,{children:(0,t.jsxs)("div",{className:le,children:[J,Z,Q,ne,F]})}),e[50]=le,e[51]=J,e[52]=Z,e[53]=Q,e[54]=ne,e[55]=F,e[56]=q):q=e[56];let B;e[57]!==s||e[58]!==o?(B=(0,t.jsx)(de,{onSelect:()=>o(s),children:"Reply"}),e[57]=s,e[58]=o,e[59]=B):B=e[59];let ae;e[60]!==s.text?(ae=(0,t.jsx)(de,{onSelect:()=>navigator.clipboard.writeText(s.text),children:"Copy"}),e[60]=s.text,e[61]=ae):ae=e[61];let H;e[62]!==r||e[63]!==s||e[64]!==n?(H=r&&(0,t.jsx)(de,{onSelect:()=>n(s),children:"Edit"}),e[62]=r,e[63]=s,e[64]=n,e[65]=H):H=e[65];let ee;e[66]===Symbol.for("react.memo_cache_sentinel")?(ee=(0,t.jsx)(He,{}),e[66]=ee):ee=e[66];let W;e[67]!==s.id||e[68]!==d?(W=(0,t.jsx)(de,{onSelect:()=>d?.(s.id),className:"text-red-500",children:"Delete"}),e[67]=s.id,e[68]=d,e[69]=W):W=e[69];let Y;e[70]!==B||e[71]!==ae||e[72]!==H||e[73]!==W?(Y=(0,t.jsxs)(Be,{children:[B,ae,H,ee,W]}),e[70]=B,e[71]=ae,e[72]=H,e[73]=W,e[74]=Y):Y=e[74];let K;e[75]!==q||e[76]!==Y?(K=(0,t.jsxs)(Je,{children:[q,Y]}),e[75]=q,e[76]=Y,e[77]=K):K=e[77];let te;e[78]!==a||e[79]!==r||e[80]!==s.id||e[81]!==s.reactions||e[82]!==j?(te=s.reactions&&s.reactions.length>0&&(0,t.jsx)("div",{className:O("mt-1",r?"mr-1":"ml-1"),children:(0,t.jsx)(kt,{reactions:s.reactions,currentUser:a,onToggle:U=>j?.(s.id,U)})}),e[78]=a,e[79]=r,e[80]=s.id,e[81]=s.reactions,e[82]=j,e[83]=te):te=e[83];let se;e[84]!==E||e[85]!==K||e[86]!==te?(se=(0,t.jsxs)("div",{className:E,children:[K,te]}),e[84]=E,e[85]=K,e[86]=te,e[87]=se):se=e[87];let R;e[88]!==S||e[89]!==G||e[90]!==P||e[91]!==se?(R=(0,t.jsx)(oe.div,{drag:"x",dragConstraints:m,dragElastic:.4,onDragEnd:S,style:G,className:P,children:se}),e[88]=S,e[89]=G,e[90]=P,e[91]=se,e[92]=R):R=e[92];let X;return e[93]!==p||e[94]!==$||e[95]!==R||e[96]!==z?(X=(0,t.jsxs)(oe.div,{id:z,initial:C,animate:M,className:p,children:[$,R]}),e[93]=p,e[94]=$,e[95]=R,e[96]=z,e[97]=X):X=e[97],X},Mt=({conversation:i,messages:e,currentUser:s,onBack:r,onSendMessage:g,onEditMessage:o,onDeleteMessage:u,onToggleReaction:b,onTyping:d,isLoading:n,isTyping:j,isOnline:a})=>{const{openLightbox:N}=We(),[f,T]=(0,I.useState)(null),[k,l]=(0,I.useState)(null),[h,_]=(0,I.useState)(!1),y=(0,I.useRef)(null);(0,I.useEffect)(()=>{y.current&&(y.current.scrollTop=y.current.scrollHeight)},[e,j,f,k]);const S=async(x,c,p,v)=>{if(k){o?.(k.id,x),l(null);return}if(p&&v){try{const m=await ye(new File([p],`voice-message-${Date.now()}.webm`,{type:p.type}));g(i.id,"Voice message","voice",[{url:m.url,duration:v}],f?.id)}catch(m){console.error("Failed to send voice message:",m)}return}let w=[];if(c.length>0)try{w=await Promise.all(c.map(m=>ye(m)))}catch(m){console.error("Upload failed:",m);return}const $=w.length>0?w[0].type==="video"?"video":"image":"text";g(i.id,x,$,w,f?.id),T(null)},z=x=>{!x.media||x.media.length===0||N(x.media.map(c=>c.url),0)},C=(x,c)=>x===e.length-1?!1:e[x+1].sender===c.sender,M=(x,c,p)=>(0,t.jsx)(_t,{url:x,duration:c,isMe:p});return(0,t.jsxs)("div",{className:"relative flex h-full w-full flex-col overflow-hidden bg-[#8774e1]/10 dark:bg-[#0f0f0f] md:border-l md:border-zinc-200/50 dark:md:border-zinc-800/50",children:[(0,t.jsx)("div",{className:"absolute inset-0 z-0 opacity-[0.03] dark:opacity-[0.05] pointer-events-none",style:{backgroundImage:'url("https://web.telegram.org/a/chat-bg-pattern-light.63857502396e95c469b6.png")',backgroundSize:"400px"}}),(0,t.jsx)(bt,{conversation:i,isOnline:a,onBack:r,onOpenSettings:()=>_(!0)}),(0,t.jsx)("div",{className:"flex-1 min-h-0 overflow-hidden relative z-10",children:(0,t.jsx)("div",{className:"h-full overflow-y-auto px-2 md:px-12 py-4 no-scrollbar",ref:y,children:(0,t.jsxs)("div",{className:"flex flex-col min-h-full justify-end max-w-3xl mx-auto",children:[n&&e.length===0?(0,t.jsx)("div",{className:"flex justify-center p-8",children:(0,t.jsx)(pt,{})}):(0,t.jsx)("div",{className:"flex flex-col gap-[2px]",children:e.map((x,c)=>(0,t.jsx)(Ct,{msg:x,isMe:x.sender==="me",isLastInGroup:!C(c,x),setReplyingTo:T,handleImageClick:z,handleVoiceMessage:M,onDeleteMessage:u,setEditingMessage:l,onToggleReaction:b,currentUser:s},x.id))}),j&&(0,t.jsx)("div",{className:"flex items-center gap-2 mt-1 ml-1",children:(0,t.jsx)("div",{className:"bg-white dark:bg-[#212121] px-4 py-2 rounded-[15px] rounded-tl-[2px] shadow-sm",children:(0,t.jsx)(qe,{})})})]})})}),(0,t.jsx)(Nt,{onSendMessage:S,onTyping:d,replyingTo:f,setReplyingTo:T,editingMessage:k,setEditingMessage:l}),i.isGroup?(0,t.jsx)(Ze,{isOpen:h,onClose:()=>_(!1),conversation:i,onUpdate:()=>{_(!1)}}):(0,t.jsx)(it,{isOpen:h,onClose:()=>_(!1),user:i.user,conversationId:i.id})]})},Tt=Mt,Rt=re();function $t(){const i=(0,Rt.c)(1);let e;return i[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,t.jsx)("div",{className:"flex flex-col",children:[1,2,3,4,5,6].map(Gt)}),i[0]=e):e=i[0],e}function Gt(i){return(0,t.jsxs)("div",{className:"flex items-center gap-3 p-4 border-b border-zinc-50 dark:border-zinc-900",children:[(0,t.jsx)(ie,{className:"h-12 w-12 rounded-full"}),(0,t.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)(ie,{className:"h-4 w-24 rounded"}),(0,t.jsx)(ie,{className:"h-3 w-12 rounded"})]}),(0,t.jsx)(ie,{className:"h-3 w-32 rounded"})]})]},i)}var It=re(),Ot=()=>{const i=(0,It.c)(33),{id:e,currentUser:s,onlineUsers:r,msgSearchQuery:g,setMsgSearchQuery:o,userSearchResults:u,filteredConversations:b,selectedConversation:d,localMessages:n,isConvLoading:j,isMsgLoading:a,currentIsTyping:N,otherUserIsOnline:f,handleStartConversation:T,handleSelectConversation:k,sendMessage:l,editMessage:h,onDeleteMessage:_,onToggleReaction:y,sendTypingStatus:S,typingStatus:z,navigate:C}=Qe();if(!s){let m;i[0]===Symbol.for("react.memo_cache_sentinel")?(m=(0,t.jsx)("div",{className:"rounded-3xl bg-zinc-50 p-6 dark:bg-zinc-900",children:(0,t.jsx)(Re,{size:48,className:"text-zinc-300 dark:text-zinc-600"})}),i[0]=m):m=i[0];let G;return i[1]===Symbol.for("react.memo_cache_sentinel")?(G=(0,t.jsxs)("div",{className:"flex h-[100dvh] flex-col items-center justify-center gap-6 border-zinc-100 bg-white p-8 text-center dark:border-zinc-800 dark:bg-black md:h-[calc(100vh-1.5rem)] md:rounded-2xl md:border",children:[m,(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h3",{className:"text-2xl font-black tracking-tight dark:text-white",children:"Sign in to message"}),(0,t.jsx)("p",{className:"max-w-xs text-zinc-500 font-medium",children:"Join the conversation. Sign up or log in to start chatting."})]})]}),i[1]=G):G=i[1],G}if(j){let m;return i[2]===Symbol.for("react.memo_cache_sentinel")?(m=(0,t.jsx)("div",{className:"flex h-[100dvh] pt-4 md:h-[calc(100vh-1.5rem)] md:rounded-2xl border-zinc-100 bg-white dark:border-zinc-800 dark:bg-black md:border",children:(0,t.jsx)("div",{className:"w-full md:w-[420px]",children:(0,t.jsx)($t,{})})}),i[2]=m):m=i[2],m}const M=`flex ${e?"h-[100dvh]":"h-[calc(100dvh-4rem)]"} w-full max-w-full box-border overscroll-none overflow-x-hidden overflow-y-hidden bg-white shadow-2xl shadow-zinc-200/50 dark:border-zinc-800 dark:bg-[#0f0f0f] dark:shadow-none md:h-[calc(100vh-1.5rem)] md:rounded-3xl md:border md:border-zinc-200/50`,x=`flex-col md:flex md:w-[420px] ${d?"hidden":"flex"} h-full min-h-0 min-w-0 flex-1 md:flex-none bg-white dark:bg-[#0f0f0f] border-r border-zinc-100 dark:border-zinc-800 z-10`,c=e??null;let p;i[3]!==b||i[4]!==k||i[5]!==T||i[6]!==g||i[7]!==r||i[8]!==o||i[9]!==c||i[10]!==z||i[11]!==u?(p=(0,t.jsx)(ut,{conversations:b,userResults:u,onSelect:k,onStartNew:T,selectedId:c,searchQuery:g,onSearchChange:o,onlineUsers:r,typingStatus:z}),i[3]=b,i[4]=k,i[5]=T,i[6]=g,i[7]=r,i[8]=o,i[9]=c,i[10]=z,i[11]=u,i[12]=p):p=i[12];let v;i[13]!==x||i[14]!==p?(v=(0,t.jsx)("div",{className:x,children:p}),i[13]=x,i[14]=p,i[15]=v):v=i[15];let w;i[16]!==N||i[17]!==s||i[18]!==h||i[19]!==a||i[20]!==n||i[21]!==C||i[22]!==_||i[23]!==y||i[24]!==f||i[25]!==d||i[26]!==l||i[27]!==S?(w=d?(0,t.jsx)(Tt,{conversation:d,messages:n,currentUser:s,onBack:()=>C("/m"),onSendMessage:l,onEditMessage:h,onDeleteMessage:_,onToggleReaction:y,onTyping:m=>S(d.id,m),isLoading:a,isTyping:!!N,isOnline:!!f}):(0,t.jsxs)("div",{className:"hidden flex-1 flex-col items-center justify-center gap-6 text-zinc-500 md:flex bg-zinc-50/30 dark:bg-zinc-900/10",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute -inset-10 rounded-full bg-violet-500/5 blur-3xl dark:bg-violet-500/10"}),(0,t.jsx)("div",{className:"relative rounded-[2.5rem] bg-white p-10 shadow-xl shadow-zinc-200/50 dark:bg-zinc-900/50 dark:shadow-none ring-1 ring-zinc-100 dark:ring-zinc-800",children:(0,t.jsx)(Ue,{size:80,className:"text-violet-500 stroke-[1.5]"})})]}),(0,t.jsxs)("div",{className:"text-center max-w-sm px-4 space-y-3",children:[(0,t.jsx)("h3",{className:"text-3xl font-black tracking-tighter text-zinc-900 dark:text-white",children:"Your Messages"}),(0,t.jsx)("p",{className:"text-zinc-500 font-medium text-lg",children:"Send private photos and messages to a friend or group."})]})]}),i[16]=N,i[17]=s,i[18]=h,i[19]=a,i[20]=n,i[21]=C,i[22]=_,i[23]=y,i[24]=f,i[25]=d,i[26]=l,i[27]=S,i[28]=w):w=i[28];let $;return i[29]!==M||i[30]!==v||i[31]!==w?($=(0,t.jsxs)("div",{className:M,children:[v,w]}),i[29]=M,i[30]=v,i[31]=w,i[32]=$):$=i[32],$},Kt=Ot;export{Kt as default};
