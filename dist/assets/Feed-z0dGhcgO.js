import{a as y}from"./rolldown-runtime-BaZ8gS7u.js";import{E as P,b as A,c as S,d as $,t as F}from"./framework-CsA6nn9m.js";import"./database-BiY55TQY.js";import{tn as H,yn as U}from"./ui-libs-C499hzp9.js";import"./media-libs-Btb8RX-I.js";import"./animations-T0TOZv2c.js";import{D as q,E,F as w,P as C,at as L,it as M,rt as B}from"./index-C0xYWOHr.js";import"./VideoPlayer-pFHnfTZA.js";import{n as W}from"./post-MvzpXmbL.js";import"./text-processing-DFvQvkgt.js";import"./linkify-BIniK2-v.js";import{o as Y}from"./hooks-xXwX_OIU.js";var D=S(),le=y(P(),1),s=y($(),1),I=v=>{const e=(0,D.c)(24),{user:t,onClick:c,isAddStory:n,isSeen:r}=v,d=n===void 0?!1:n,u=`relative p-0.5 rounded-full ${d?"bg-transparent":r!==void 0&&r?"bg-zinc-200 dark:bg-zinc-800":"bg-gradient-to-tr from-yellow-400 via-pink-500 to-violet-600"}`;let m;e[0]!==t.avatar||e[1]!==t.handle?(m=(0,s.jsx)(L,{src:t.avatar,alt:t.handle,className:"object-cover"}),e[0]=t.avatar,e[1]=t.handle,e[2]=m):m=e[2];let i;e[3]!==t.handle?.[0]?(i=t.handle?.[0]?.toUpperCase(),e[3]=t.handle?.[0],e[4]=i):i=e[4];let a;e[5]!==i?(a=(0,s.jsx)(M,{children:i}),e[5]=i,e[6]=a):a=e[6];let o;e[7]!==m||e[8]!==a?(o=(0,s.jsxs)(B,{className:"size-14 border border-zinc-100 dark:border-zinc-800 sm:size-16",children:[m,a]}),e[7]=m,e[8]=a,e[9]=o):o=e[9];let h;e[10]!==d?(h=d&&(0,s.jsx)("div",{className:"absolute bottom-0 right-0 rounded-full border-2 border-white bg-violet-600 p-1 text-white shadow-lg dark:border-black",children:(0,s.jsx)(H,{size:14,strokeWidth:3})}),e[10]=d,e[11]=h):h=e[11];let x;e[12]!==o||e[13]!==h?(x=(0,s.jsx)("div",{className:"rounded-full bg-white p-0.5 dark:bg-black",children:(0,s.jsxs)("div",{className:"relative",children:[o,h]})}),e[12]=o,e[13]=h,e[14]=x):x=e[14];let l;e[15]!==u||e[16]!==x?(l=(0,s.jsx)("div",{className:u,children:x}),e[15]=u,e[16]=x,e[17]=l):l=e[17];const p=d?"Add Story":t.handle;let f;e[18]!==p?(f=(0,s.jsx)("span",{className:"w-16 truncate text-center text-[11px] font-semibold leading-tight text-zinc-600 dark:text-zinc-400",children:p}),e[18]=p,e[19]=f):f=e[19];let b;return e[20]!==c||e[21]!==l||e[22]!==f?(b=(0,s.jsxs)("button",{onClick:c,className:"group flex shrink-0 flex-col items-center gap-2",children:[l,f]}),e[20]=c,e[21]=l,e[22]=f,e[23]=b):b=e[23],b},_=I,z=S(),R=v=>{const e=(0,z.c)(19),{currentUser:t,groupedStories:c,onAddStory:n,onStoryClick:r}=v;let d;e[0]!==t||e[1]!==n?(d=t&&(0,s.jsx)(_,{user:t,isAddStory:!0,onClick:n}),e[0]=t,e[1]=n,e[2]=d):d=e[2];let u;if(e[3]!==c||e[4]!==r){let x;e[6]!==r?(x=l=>(0,s.jsx)(_,{user:l.user,isSeen:l.isSeen,onClick:()=>r(l)},l.user.id),e[6]=r,e[7]=x):x=e[7],u=c.map(x),e[3]=c,e[4]=r,e[5]=u}else u=e[5];let m;e[8]!==d||e[9]!==u?(m=(0,s.jsxs)("div",{className:"flex w-max gap-4 px-4 py-4",children:[d,u]}),e[8]=d,e[9]=u,e[10]=m):m=e[10];let i;e[11]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsx)(w,{orientation:"horizontal",className:"hidden"}),e[11]=i):i=e[11];let a;e[12]!==m?(a=(0,s.jsxs)(C,{className:"w-full border-b border-zinc-100 bg-white dark:bg-black dark:border-zinc-800",children:[m,i]}),e[12]=m,e[13]=a):a=e[13];let o;e[14]!==t?(o=!t&&(0,s.jsx)("div",{className:"px-4 py-2 md:hidden",children:(0,s.jsx)(q,{className:"p-6"})}),e[14]=t,e[15]=o):o=e[15];let h;return e[16]!==a||e[17]!==o?(h=(0,s.jsxs)("div",{className:"bg-white dark:bg-black",children:[a,o]}),e[16]=a,e[17]=o,e[18]=h):h=e[18],h},G=v=>{const e=(0,z.c)(4),{isFetchingNextPage:t,hasMore:c,hasPosts:n}=v;let r;return e[0]!==c||e[1]!==n||e[2]!==t?(r=(0,s.jsx)("div",{className:"flex justify-center py-8",children:t?(0,s.jsx)(U,{className:"animate-spin text-violet-500",size:24}):c?(0,s.jsx)("div",{className:"h-4"}):n?(0,s.jsx)("p",{className:"text-sm font-medium text-zinc-500",children:"You've reached the end of the feed."}):(0,s.jsxs)("div",{className:"p-20 text-center text-zinc-500",children:[(0,s.jsx)("p",{className:"text-lg font-medium",children:"No posts yet."}),(0,s.jsx)("p",{className:"text-sm",children:"Be the first to share something amazing!"})]})}),e[0]=c,e[1]=n,e[2]=t,e[3]=r):r=e[3],r},J=v=>{const e=(0,z.c)(26),{onStoryClick:t}=v,c=A(),{currentUser:n,homePosts:r,groupedStories:d,isPostsLoading:u,isStoriesLoading:m,hasMore:i,isFetchingNextPage:a,fetchNextPage:o,handlePostClick:h,handleUserClick:x}=Y();if(u||m){let j;return e[0]===Symbol.for("react.memo_cache_sentinel")?(j=(0,s.jsxs)("div",{className:"min-h-screen overflow-hidden rounded-none border-y border-zinc-100 bg-white dark:bg-black dark:border-zinc-800 md:rounded-xl md:border",children:[(0,s.jsxs)(C,{className:"w-full whitespace-nowrap border-b border-zinc-100 dark:border-zinc-800",children:[(0,s.jsxs)("div",{className:"flex w-max gap-3 px-4 py-4",children:[(0,s.jsx)("div",{className:"size-16 shrink-0 animate-pulse rounded-full bg-zinc-100 dark:bg-zinc-900"}),(0,s.jsx)("div",{className:"size-16 shrink-0 animate-pulse rounded-full bg-zinc-100 dark:bg-zinc-900"}),(0,s.jsx)("div",{className:"size-16 shrink-0 animate-pulse rounded-full bg-zinc-100 dark:bg-zinc-900"})]}),(0,s.jsx)(w,{orientation:"horizontal",className:"hidden"})]}),[1,2,3].map(K)]}),e[0]=j):j=e[0],j}let l;e[1]!==n||e[2]!==d||e[3]!==c||e[4]!==t?(l=()=>(0,s.jsx)(R,{currentUser:n,groupedStories:d,onAddStory:()=>c("/create",{state:{isStory:!0}}),onStoryClick:t}),e[1]=n,e[2]=d,e[3]=c,e[4]=t,e[5]=l):l=e[5];let p;e[6]!==i||e[7]!==r||e[8]!==a?(p=()=>(0,s.jsx)(G,{isFetchingNextPage:a,hasMore:i,hasPosts:r.length>0}),e[6]=i,e[7]=r,e[8]=a,e[9]=p):p=e[9];let f;e[10]!==l||e[11]!==p?(f={Header:l,Footer:p},e[10]=l,e[11]=p,e[12]=f):f=e[12];let b;e[13]!==o||e[14]!==i||e[15]!==a?(b=()=>{i&&!a&&o()},e[13]=o,e[14]=i,e[15]=a,e[16]=b):b=e[16];let g;e[17]!==n||e[18]!==h||e[19]!==x?(g=(j,N)=>(0,s.jsx)(W,{...N,currentUser:n,onClick:()=>h(N.id),onUserClick:x},N.feed_id||N.id),e[17]=n,e[18]=h,e[19]=x,e[20]=g):g=e[20];let k;return e[21]!==r||e[22]!==f||e[23]!==b||e[24]!==g?(k=(0,s.jsx)("div",{className:"w-full max-w-full min-h-screen rounded-none border-y border-zinc-100 bg-white shadow-sm dark:bg-black dark:border-zinc-800 md:rounded-xl md:border",children:(0,s.jsx)(F,{useWindowScroll:!0,data:r,components:f,endReached:b,itemContent:g})}),e[21]=r,e[22]=f,e[23]=b,e[24]=g,e[25]=k):k=e[25],k},ne=J;function K(v){return(0,s.jsx)(E,{},v)}export{ne as default};
