import{n as $}from"./rolldown-runtime-2JzG8er9.js";import{s as U,u as H,w as L}from"./framework-pMVb9Z5_.js";import"./database-ApDMvJcm.js";import{Gt as B,jt as F}from"./ui-libs-Dldhg1Ot.js";import{$ as I,Q as M,Z as T,b as C,d as E,f as G,y as A}from"./index-D1z-Zp4U.js";import{n as J}from"./post-BSQwPkr-.js";import"./linkify-fXGRsD3N.js";import{o as O}from"./hooks-DcgzPp2Z.js";var Q=U(),ae=$(L(),1),s=$(H(),1),W=N=>{const e=(0,Q.c)(24),{user:r,onClick:p,isAddStory:a,isSeen:d}=N,u=a===void 0?!1:a,_=`relative p-0.5 rounded-full ${u?"bg-transparent":d!==void 0&&d?"bg-zinc-200 dark:bg-zinc-800":"bg-gradient-to-tr from-yellow-400 via-pink-500 to-violet-600"}`;let b;e[0]!==r.avatar||e[1]!==r.handle?(b=(0,s.jsx)(I,{src:r.avatar,alt:r.handle,className:"object-cover"}),e[0]=r.avatar,e[1]=r.handle,e[2]=b):b=e[2];let n;e[3]!==r.handle?.[0]?(n=r.handle?.[0]?.toUpperCase(),e[3]=r.handle?.[0],e[4]=n):n=e[4];let o;e[5]!==n?(o=(0,s.jsx)(M,{children:n}),e[5]=n,e[6]=o):o=e[6];let c;e[7]!==b||e[8]!==o?(c=(0,s.jsxs)(T,{className:"size-14 sm:size-16 border border-zinc-100 dark:border-zinc-800",children:[b,o]}),e[7]=b,e[8]=o,e[9]=c):c=e[9];let m;e[10]!==u?(m=u&&(0,s.jsx)("div",{className:"absolute bottom-0 right-0 bg-violet-600 border-2 border-white dark:border-black rounded-full p-1 text-white shadow-lg",children:(0,s.jsx)(F,{size:14,strokeWidth:3})}),e[10]=u,e[11]=m):m=e[11];let h;e[12]!==c||e[13]!==m?(h=(0,s.jsx)("div",{className:"bg-white dark:bg-black rounded-full p-0.5",children:(0,s.jsxs)("div",{className:"relative",children:[c,m]})}),e[12]=c,e[13]=m,e[14]=h):h=e[14];let f;e[15]!==_||e[16]!==h?(f=(0,s.jsx)("div",{className:_,children:h}),e[15]=_,e[16]=h,e[17]=f):f=e[17];const x=u?"Add Story":r.handle;let i;e[18]!==x?(i=(0,s.jsx)("span",{className:"text-[11px] font-semibold text-zinc-600 dark:text-zinc-400 truncate w-16 text-center leading-tight",children:x}),e[18]=x,e[19]=i):i=e[19];let l;return e[20]!==p||e[21]!==f||e[22]!==i?(l=(0,s.jsxs)("button",{onClick:p,className:"flex flex-col items-center gap-2 group shrink-0",children:[f,i]}),e[20]=p,e[21]=f,e[22]=i,e[23]=l):l=e[23],l},P=W,Y=U(),Z=N=>{const e=(0,Y.c)(35),{onStoryClick:r,onAddStory:p}=N,{currentUser:a,homePosts:d,groupedStories:u,isPostsLoading:_,isStoriesLoading:b,hasMore:n,isFetchingNextPage:o,addToast:c,ref:m,handlePostClick:h,handleUserClick:f}=O();if(_||b){let t;return e[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,s.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:[(0,s.jsxs)(A,{className:"w-full whitespace-nowrap border-b border-zinc-100 dark:border-zinc-800",children:[(0,s.jsxs)("div",{className:"flex w-max gap-3 py-4 px-4",children:[(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"}),(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"}),(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"})]}),(0,s.jsx)(C,{orientation:"horizontal",className:"hidden"})]}),[1,2,3].map(D)]}),e[0]=t):t=e[0],t}let x;e[1]!==a||e[2]!==p?(x=a&&(0,s.jsx)(P,{user:a,isAddStory:!0,onClick:p}),e[1]=a,e[2]=p,e[3]=x):x=e[3];let i;if(e[4]!==u||e[5]!==r){let t;e[7]!==r?(t=y=>{const q=JSON.parse(localStorage.getItem("seenStories")||"[]").includes(y.user.id);return(0,s.jsx)(P,{user:y.user,isSeen:q,onClick:()=>r(y)},y.user.id)},e[7]=r,e[8]=t):t=e[8],i=u.map(t),e[4]=u,e[5]=r,e[6]=i}else i=e[6];let l;e[9]!==x||e[10]!==i?(l=(0,s.jsxs)("div",{className:"flex w-max gap-4 py-4 px-4",children:[x,i]}),e[9]=x,e[10]=i,e[11]=l):l=e[11];let w;e[12]===Symbol.for("react.memo_cache_sentinel")?(w=(0,s.jsx)(C,{orientation:"horizontal",className:"hidden"}),e[12]=w):w=e[12];let v;e[13]!==l?(v=(0,s.jsxs)(A,{className:"w-full border-b border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black",children:[l,w]}),e[13]=l,e[14]=v):v=e[14];let g;e[15]!==a?(g=!a&&(0,s.jsx)("div",{className:"px-4 py-2 md:hidden",children:(0,s.jsx)(G,{className:"p-6"})}),e[15]=a,e[16]=g):g=e[16];let j;e[17]!==c||e[18]!==a||e[19]!==h||e[20]!==f||e[21]!==d?(j=d.length>0?d.map(t=>(0,s.jsx)(J,{...t,currentUser:a,showToast:c,onClick:()=>h(t.id),onUserClick:f},t.feed_id||t.id)):(0,s.jsxs)("div",{className:"p-20 text-center text-zinc-500",children:[(0,s.jsx)("p",{className:"text-lg font-medium",children:"No posts yet."}),(0,s.jsx)("p",{className:"text-sm",children:"Be the first to share something amazing!"})]}),e[17]=c,e[18]=a,e[19]=h,e[20]=f,e[21]=d,e[22]=j):j=e[22];let k;e[23]!==n||e[24]!==d.length||e[25]!==o||e[26]!==m?(k=d.length>0&&(0,s.jsx)("div",{ref:m,className:"py-8 flex justify-center",children:o?(0,s.jsx)(B,{className:"animate-spin text-violet-500",size:24}):n?(0,s.jsx)("div",{className:"h-4"}):(0,s.jsx)("p",{className:"text-sm text-zinc-500 font-medium",children:"You've reached the end of the feed."})}),e[23]=n,e[24]=d.length,e[25]=o,e[26]=m,e[27]=k):k=e[27];let z;e[28]!==j||e[29]!==k?(z=(0,s.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen pb-20 shadow-sm",children:[j,k]}),e[28]=j,e[29]=k,e[30]=z):z=e[30];let S;return e[31]!==v||e[32]!==g||e[33]!==z?(S=(0,s.jsxs)("div",{className:"w-full max-w-full overflow-hidden",children:[v,g,z]}),e[31]=v,e[32]=g,e[33]=z,e[34]=S):S=e[34],S},ie=Z;function D(N){return(0,s.jsx)(E,{},N)}export{ie as default};
