import{a as S}from"./rolldown-runtime-BaZ8gS7u.js";import{c as P,s as R}from"./animations-DZuN0xpW.js";import{_ as C,c as z,t as F}from"./framework-YRQI4BOE.js";import"./database-Bh-Nv8Zy.js";import{nn as H,tn as M}from"./ui-libs-BV6sU6gG.js";import"./media-libs-CqtNZWFg.js";import{Bt as U,C as q,Ht as B,J as V,K as I,S as L,Vt as T,_ as W,a as Y,b as E,l as J,nt as $,q as y,tt as A,v as K,w as O,x as D,y as G}from"./index-DwFQeZBj.js";import"./VideoPlayer-Dv9BncyQ.js";import{n as Q}from"./post-OrR2r1RT.js";import"./text-processing-COMFTedg.js";import"./rich-text-CgquMT42.js";import"./actionsheet-DMdJONhV.js";var X=z(),ge=S(P(),1),s=S(R(),1),Z=v=>{const e=(0,X.c)(24),{user:t,onClick:u,isAddStory:l,isSeen:r}=v,f=l===void 0?!1:l,b=`relative p-0.5 rounded-full ${f?"bg-transparent":r!==void 0&&r?"bg-zinc-200 dark:bg-zinc-800":"bg-gradient-to-tr from-yellow-400 via-pink-500 to-violet-600"}`;let c;e[0]!==t.avatar||e[1]!==t.handle?(c=(0,s.jsx)(B,{src:t.avatar,alt:t.handle,className:"object-cover"}),e[0]=t.avatar,e[1]=t.handle,e[2]=c):c=e[2];let i;e[3]!==t.handle?.[0]?(i=t.handle?.[0]?.toUpperCase(),e[3]=t.handle?.[0],e[4]=i):i=e[4];let a;e[5]!==i?(a=(0,s.jsx)(T,{children:i}),e[5]=i,e[6]=a):a=e[6];let o;e[7]!==c||e[8]!==a?(o=(0,s.jsxs)(U,{className:"size-14 border border-zinc-100 dark:border-zinc-800 sm:size-16",children:[c,a]}),e[7]=c,e[8]=a,e[9]=o):o=e[9];let d;e[10]!==f?(d=f&&(0,s.jsx)("div",{className:"absolute bottom-0 right-0 rounded-full border-2 border-white bg-violet-600 p-1 text-white shadow-lg dark:border-black",children:(0,s.jsx)(M,{size:14,strokeWidth:3})}),e[10]=f,e[11]=d):d=e[11];let m;e[12]!==o||e[13]!==d?(m=(0,s.jsx)("div",{className:"rounded-full bg-white p-0.5 dark:bg-black",children:(0,s.jsxs)("div",{className:"relative",children:[o,d]})}),e[12]=o,e[13]=d,e[14]=m):m=e[14];let n;e[15]!==b||e[16]!==m?(n=(0,s.jsx)("div",{className:b,children:m}),e[15]=b,e[16]=m,e[17]=n):n=e[17];const p=f?"Add Story":t.handle;let h;e[18]!==p?(h=(0,s.jsx)("span",{className:"w-16 truncate text-center text-[11px] font-semibold leading-tight text-zinc-600 dark:text-zinc-400",children:p}),e[18]=p,e[19]=h):h=e[19];let x;return e[20]!==u||e[21]!==n||e[22]!==h?(x=(0,s.jsxs)("button",{onClick:u,className:"group flex shrink-0 flex-col items-center gap-2",children:[n,h]}),e[20]=u,e[21]=n,e[22]=h,e[23]=x):x=e[23],x},_=Z,ee=z(),se=v=>{const e=(0,ee.c)(25),{index:t}=v,u=t===void 0?0:t,l=C(),{reels:r,loading:f}=Y();if(f&&r.length===0){let h;e[0]===Symbol.for("react.memo_cache_sentinel")?(h=(0,s.jsxs)("div",{className:"mb-3 px-4 flex items-center justify-between",children:[(0,s.jsx)(y,{className:"h-6 w-32 rounded"}),(0,s.jsx)(y,{className:"h-4 w-16 rounded"})]}),e[0]=h):h=e[0];let x;return e[1]===Symbol.for("react.memo_cache_sentinel")?(x=(0,s.jsxs)("div",{className:"my-4 border-y border-zinc-100 bg-zinc-50/30 py-4 dark:border-zinc-800 dark:bg-zinc-900/10",children:[h,(0,s.jsx)("div",{className:"flex gap-4 overflow-hidden px-4",children:[...Array(5)].map(re)})]}),e[1]=x):x=e[1],x}if(r.length===0)return null;const b=u%Math.max(1,Math.floor(r.length/5))*5;let c,i,a,o,d;if(e[2]!==l||e[3]!==r||e[4]!==b){const h=r.slice(b,b+10);o="my-4 border-y border-zinc-100 bg-zinc-50/30 py-4 dark:border-zinc-800 dark:bg-zinc-900/10";let x;e[10]===Symbol.for("react.memo_cache_sentinel")?(x=(0,s.jsx)("h3",{className:"font-bold text-lg",children:"Recommended Reels"}),e[10]=x):x=e[10],e[11]!==l?(d=(0,s.jsxs)("div",{className:"mb-3 px-4 flex items-center justify-between",children:[x,(0,s.jsx)("button",{onClick:()=>l("/r"),className:"text-sm font-semibold text-violet-600 hover:underline",children:"View all"})]}),e[11]=l,e[12]=d):d=e[12],i=W,c=K;let g;e[13]!==l?(g=j=>(0,s.jsxs)(G,{className:"aspect-[9/16] w-[150px] sm:w-[180px]",onClick:()=>l(`/r/${j.id}`),children:[(0,s.jsx)(O,{src:j.media?.[0]?.url||"",poster:j.media?.[0]?.poster||""}),(0,s.jsx)(q,{}),(0,s.jsxs)("div",{className:"absolute top-2 left-2 z-10 flex items-center gap-1 rounded-full bg-black/20 px-2 py-1 backdrop-blur-md",children:[(0,s.jsx)(H,{size:10,fill:"white",className:"text-white"}),(0,s.jsx)("span",{className:"text-[10px] font-bold text-white",children:j.stats?.views||0})]}),(0,s.jsxs)(E,{children:[(0,s.jsx)(D,{name:j.user?.handle,src:j.user?.avatar}),(0,s.jsx)(L,{children:j.user?.handle})]})]},j.id),e[13]=l,e[14]=g):g=e[14],a=h.map(g),e[2]=l,e[3]=r,e[4]=b,e[5]=c,e[6]=i,e[7]=a,e[8]=o,e[9]=d}else c=e[5],i=e[6],a=e[7],o=e[8],d=e[9];let m;e[15]!==c||e[16]!==a?(m=(0,s.jsx)(c,{children:a}),e[15]=c,e[16]=a,e[17]=m):m=e[17];let n;e[18]!==i||e[19]!==m?(n=(0,s.jsx)(i,{children:m}),e[18]=i,e[19]=m,e[20]=n):n=e[20];let p;return e[21]!==o||e[22]!==d||e[23]!==n?(p=(0,s.jsxs)("div",{className:o,children:[d,n]}),e[21]=o,e[22]=d,e[23]=n,e[24]=p):p=e[24],p},te=se;function re(v,e){return(0,s.jsx)(y,{className:"aspect-[9/16] w-[150px] shrink-0 rounded-xl sm:w-[180px]"},e)}var w=z(),ae=v=>{const e=(0,w.c)(19),{currentUser:t,groupedStories:u,onAddStory:l,onStoryClick:r}=v;let f;e[0]!==t||e[1]!==l?(f=t&&(0,s.jsx)(_,{user:t,isAddStory:!0,onClick:l}),e[0]=t,e[1]=l,e[2]=f):f=e[2];let b;if(e[3]!==u||e[4]!==r){let m;e[6]!==r?(m=n=>(0,s.jsx)(_,{user:n.user,isSeen:n.isSeen,onClick:()=>r(n)},n.user.id),e[6]=r,e[7]=m):m=e[7],b=u.map(m),e[3]=u,e[4]=r,e[5]=b}else b=e[5];let c;e[8]!==f||e[9]!==b?(c=(0,s.jsxs)("div",{className:"flex w-max gap-4 px-4 py-4",children:[f,b]}),e[8]=f,e[9]=b,e[10]=c):c=e[10];let i;e[11]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsx)($,{orientation:"horizontal",className:"hidden"}),e[11]=i):i=e[11];let a;e[12]!==c?(a=(0,s.jsxs)(A,{className:"w-full border-b border-zinc-100 bg-white dark:bg-black dark:border-zinc-800",children:[c,i]}),e[12]=c,e[13]=a):a=e[13];let o;e[14]!==t?(o=!t&&(0,s.jsx)("div",{className:"px-4 py-2 md:hidden",children:(0,s.jsx)(V,{className:"p-6"})}),e[14]=t,e[15]=o):o=e[15];let d;return e[16]!==a||e[17]!==o?(d=(0,s.jsxs)("div",{className:"bg-white dark:bg-black",children:[a,o]}),e[16]=a,e[17]=o,e[18]=d):d=e[18],d},le=v=>{const e=(0,w.c)(4),{isFetchingNextPage:t,hasMore:u,hasPosts:l}=v;let r;return e[0]!==u||e[1]!==l||e[2]!==t?(r=(0,s.jsx)("div",{className:"flex justify-center py-8",children:t?(0,s.jsx)("p",{className:"text-sm text-zinc-400 animate-pulse",children:"Loading more..."}):u?(0,s.jsx)("div",{className:"h-4"}):l?(0,s.jsx)("p",{className:"text-sm font-medium text-zinc-500",children:"You've reached the end of the feed."}):(0,s.jsxs)("div",{className:"p-20 text-center text-zinc-500",children:[(0,s.jsx)("p",{className:"text-lg font-medium",children:"No posts yet."}),(0,s.jsx)("p",{className:"text-sm",children:"Be the first to share something amazing!"})]})}),e[0]=u,e[1]=l,e[2]=t,e[3]=r):r=e[3],r},ie=v=>{const e=(0,w.c)(26),{onStoryClick:t}=v,u=C(),{currentUser:l,homePosts:r,groupedStories:f,isPostsLoading:b,isStoriesLoading:c,hasMore:i,isFetchingNextPage:a,fetchNextPage:o,handlePostClick:d,handleUserClick:m}=J();if(b||c){let k;return e[0]===Symbol.for("react.memo_cache_sentinel")?(k=(0,s.jsxs)("div",{className:"min-h-screen overflow-hidden rounded-none border-y border-zinc-100 bg-white dark:bg-black dark:border-zinc-800 md:rounded-xl md:border",children:[(0,s.jsxs)(A,{className:"w-full whitespace-nowrap border-b border-zinc-100 dark:border-zinc-800",children:[(0,s.jsxs)("div",{className:"flex w-max gap-3 px-4 py-4",children:[(0,s.jsx)("div",{className:"size-16 shrink-0 animate-pulse rounded-full bg-zinc-100 dark:bg-zinc-900"}),(0,s.jsx)("div",{className:"size-16 shrink-0 animate-pulse rounded-full bg-zinc-100 dark:bg-zinc-900"}),(0,s.jsx)("div",{className:"size-16 shrink-0 animate-pulse rounded-full bg-zinc-100 dark:bg-zinc-900"})]}),(0,s.jsx)($,{orientation:"horizontal",className:"hidden"})]}),[1,2,3].map(ne)]}),e[0]=k):k=e[0],k}let n;e[1]!==l||e[2]!==f||e[3]!==u||e[4]!==t?(n=()=>(0,s.jsx)(ae,{currentUser:l,groupedStories:f,onAddStory:()=>u("/create",{state:{isStory:!0}}),onStoryClick:t}),e[1]=l,e[2]=f,e[3]=u,e[4]=t,e[5]=n):n=e[5];let p;e[6]!==i||e[7]!==r||e[8]!==a?(p=()=>(0,s.jsx)(le,{isFetchingNextPage:a,hasMore:i,hasPosts:r.length>0}),e[6]=i,e[7]=r,e[8]=a,e[9]=p):p=e[9];let h;e[10]!==n||e[11]!==p?(h={Header:n,Footer:p},e[10]=n,e[11]=p,e[12]=h):h=e[12];let x;e[13]!==o||e[14]!==i||e[15]!==a?(x=()=>{i&&!a&&o()},e[13]=o,e[14]=i,e[15]=a,e[16]=x):x=e[16];let g;e[17]!==l||e[18]!==d||e[19]!==m?(g=(k,N)=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Q,{...N,currentUser:l,onClick:()=>d(N.id),onUserClick:m},N.feed_id||N.id),(k===4||k>4&&(k-4)%25===0)&&(0,s.jsx)(te,{index:Math.floor((k+1)/5)})]}),e[17]=l,e[18]=d,e[19]=m,e[20]=g):g=e[20];let j;return e[21]!==r||e[22]!==h||e[23]!==x||e[24]!==g?(j=(0,s.jsx)("div",{className:"w-full max-w-full min-h-screen rounded-none border-zinc-100 bg-white shadow-sm dark:bg-black dark:border-zinc-800 md:rounded-xl",children:(0,s.jsx)(F,{useWindowScroll:!0,data:r,overscan:400,increaseViewportBy:200,components:h,endReached:x,itemContent:g})}),e[21]=r,e[22]=h,e[23]=x,e[24]=g,e[25]=j):j=e[25],j},ke=ie;function ne(v){return(0,s.jsx)(I,{},v)}export{ke as default};
