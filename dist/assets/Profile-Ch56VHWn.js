import{a as ne}from"./rolldown-runtime-BaZ8gS7u.js";import{o as de,s as xe}from"./animations-DnIvWaa_.js";import{_ as me,c as he}from"./framework-qAfQIUpw.js";import"./database-CdmW3A7f.js";import{$t as fe,Fn as pe,Hn as ue,Pn as be,Pt as je,Zt as ge,cr as oe,sr as ve,ur as ke,yn as ze}from"./ui-libs-lxLEvj1Y.js";import"./media-libs-BYH8vgqC.js";import{A as we,C as Ne,Ct as ye,D as Fe,Ft as _e,L as Pe,M as Ce,N as Me,Pt as ae,Qt as Se,R as Te,Rt as $e,S as Le,St as Ie,T as De,X as Ue,Y as We,b as Ae,ct as re,dt as Be,et as le,j as ie,lt as te,ot as Ee,st as Oe,tt as Re,ut as qe,wt as He,x as Ge,y as Ve}from"./index-D8jKKKUQ.js";import"./VideoPlayer-BDQZI94r.js";import"./useAdmin-BB94ziex.js";import{n as Xe}from"./post-BtMfl01w.js";import{t as Qe}from"./text-processing-CRKQxkaV.js";import{t as Ye}from"./linkify-Bgxg4QY4.js";import"./actionsheet-CsxbepsG.js";import{l as Ze}from"./hooks-Fe4pqMa-.js";import{t as ce}from"./skeleton-profile-6xpbA10o.js";var Je=he(),Ke=ne(xe(),1),s=ne(de(),1),es=({profile:e,currentUser:u,isCurrentUser:R,onEditProfile:J,isCommunity:m,onShowFollowers:q,onShowFollowing:H})=>{const{addToast:o}=$e(),f=me(),{openReport:b}=_e(),[j,c]=(0,Ke.useState)(!1),{isFollowing:n,stats:p,loading:g,handleFollow:v}=Ue(e||{},u?.id);if(!e)return(0,s.jsx)(ce,{});const G=async()=>{if(!u){o("Please sign in to message users","info");return}c(!0);try{f(`/m/${await Se(u.id,e.id)}`)}catch(a){console.error("Failed to start conversation:",a),o("Failed to open chat","error")}finally{c(!1)}};return(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("div",{className:"relative h-32 w-full bg-zinc-200 dark:bg-zinc-800 sm:h-48",children:[e.cover&&(0,s.jsx)("img",{src:e.cover,className:"h-full w-full object-cover transition-opacity duration-500",alt:"Cover"}),(0,s.jsx)("div",{className:"absolute -bottom-12 left-4 sm:-bottom-16 sm:left-6",children:(0,s.jsx)("div",{className:"relative rounded-full bg-white p-1 shadow-xl ring-4 ring-white dark:bg-black dark:ring-black",children:(0,s.jsxs)(Ie,{className:"size-24 sm:size-32",children:[(0,s.jsx)(He,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,s.jsx)(ye,{className:"text-4xl font-bold",children:e.handle?.[0]?.toUpperCase()})]})})})]}),(0,s.jsxs)("div",{className:"flex flex-col space-y-4 p-4 pt-16 sm:p-6 sm:pt-20",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsx)("div",{className:"min-w-0 flex-1 pr-4"}),(0,s.jsx)("div",{className:"flex shrink-0 gap-2",children:R?(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>J?.(e),className:"flex size-10 items-center justify-center rounded-full border border-zinc-200 text-zinc-700 transition-all hover:bg-zinc-50 active:scale-95 dark:border-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-900",title:"Edit Profile",children:(0,s.jsx)(Ve,{size:20})}),(0,s.jsx)("button",{onClick:()=>f("/settings"),className:"rounded-full border border-zinc-200 p-2 text-zinc-700 transition-all hover:bg-zinc-50 active:scale-95 dark:border-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-900",title:"Settings",children:(0,s.jsx)(De,{size:20})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:G,disabled:j,className:"rounded-full border border-zinc-200 p-2 text-zinc-700 transition-colors hover:bg-zinc-50 disabled:opacity-50 dark:border-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-900",children:j?(0,s.jsx)("span",{className:"animate-pulse",children:"..."}):(0,s.jsx)(ze,{size:20})}),(0,s.jsx)("button",{className:"rounded-full border border-zinc-200 p-2 text-zinc-700 transition-colors hover:bg-zinc-50 dark:border-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-900",children:(0,s.jsx)(ve,{size:20})}),(0,s.jsx)(ae,{variant:n?"secondary":"primary",onClick:v,className:"flex min-w-0 items-center gap-2 px-4 text-sm sm:min-w-[100px]",disabled:g,children:g?(0,s.jsx)("span",{className:"mx-auto animate-pulse",children:"..."}):n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Ge,{size:18}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Following"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Ae,{size:18}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Follow"})]})}),(0,s.jsxs)(Ee,{children:[(0,s.jsx)(Be,{asChild:!0,children:(0,s.jsx)("button",{className:"rounded-full p-2 text-zinc-700 transition-colors hover:bg-zinc-100 dark:text-zinc-300 dark:hover:bg-zinc-800",children:(0,s.jsx)(ue,{size:20})})}),(0,s.jsxs)(Oe,{align:"end",className:"w-48",children:[(0,s.jsxs)(re,{children:[(0,s.jsxs)(te,{className:"cursor-pointer gap-2",onClick:()=>{navigator.clipboard.writeText(window.location.href),o("Profile link copied!")},children:[(0,s.jsx)(ge,{size:16}),"Share Profile"]}),(0,s.jsxs)(te,{className:"cursor-pointer gap-2",onClick:()=>b(m?"community":"user",e.id),children:[(0,s.jsx)(pe,{size:16}),"Report ",m?"community":"user"]})]}),(0,s.jsx)(qe,{}),(0,s.jsx)(re,{children:(0,s.jsxs)(te,{variant:"destructive",className:"cursor-pointer gap-2",onClick:()=>o("User blocked","info"),children:[(0,s.jsx)(oe,{size:16}),"Block user"]})})]})]})]})})]}),(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsxs)("div",{className:"mt-1 flex items-center gap-1.5",children:[(0,s.jsx)("h1",{className:"text-xl font-extrabold text-zinc-900 dark:text-zinc-100",children:e.name}),e.verified&&(0,s.jsx)(Fe,{size:20,className:"text-blue-500"}),e.isBanned&&(0,s.jsxs)("span",{className:"flex items-center gap-1 rounded-full bg-rose-100 px-2 py-0.5 text-[10px] font-black uppercase tracking-wider text-rose-600 dark:bg-rose-500/10 dark:text-rose-500",children:[(0,s.jsx)(be,{size:10}),"Banned"]})]}),!m&&(0,s.jsx)("div",{className:"flex items-center space-x-3",children:(0,s.jsxs)("span",{className:"-ml-1.5 rounded-md px-1.5 py-0.5 text-sm font-medium text-zinc-500 dark:text-zinc-400",children:["@",e.handle]})})]}),(0,s.jsx)("div",{className:"whitespace-pre-line text-sm leading-relaxed text-zinc-900 dark:text-zinc-100 sm:text-[15px]",children:(0,s.jsx)(Qe,{options:{...Ye,render:({attributes:a,content:h})=>{const{href:r,...k}=a,z=!r.startsWith("/")&&(r.startsWith("http")||r.startsWith("www"));return r.startsWith("/u/")||r.startsWith("/tags/")||r.startsWith("/c/")||r.startsWith("/explore")?(0,s.jsx)("span",{...k,className:"cursor-pointer font-bold text-rose-500 hover:underline dark:text-rose-400",onClick:d=>{d.stopPropagation(),f(r)},children:h},h):(0,s.jsx)("a",{href:r,...k,target:z?"_blank":void 0,rel:z?"noopener noreferrer":void 0,children:h},h)}},children:e.bio})}),(e.website||e.location)&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-x-5 gap-y-2 pt-1 text-sm",children:[e.location&&(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(Ne,{size:14}),e.location]}),e.website&&(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(Le,{size:14}),(0,s.jsx)("a",{href:`https://${e.website}`,target:"_blank",rel:"noreferrer",className:"font-semibold text-black hover:underline dark:text-white",children:e.website})]})]}),(0,s.jsx)("div",{className:"relative z-10 flex gap-4 pt-2 text-sm sm:gap-6",children:m?(0,s.jsxs)("button",{className:"group flex cursor-pointer gap-x-1",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white",children:e.members}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Members"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:a=>{a.preventDefault(),a.stopPropagation(),H()},className:"group flex cursor-pointer gap-x-1",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white",children:p.following}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Following"})]}),(0,s.jsxs)("button",{onClick:a=>{a.preventDefault(),a.stopPropagation(),q()},className:"group flex cursor-pointer gap-x-1",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white",children:p.followers}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Followers"})]})]})})]})]})},ss=es,ts=()=>{const e=(0,Je.c)(80),{handle:u,profile:R,loading:J,activeProfileTab:m,setActiveProfileTab:q,loadingPosts:H,isFetchingMorePosts:o,hasMorePosts:f,filteredPosts:b,isFollowModalOpen:j,setIsFollowModalOpen:c,followModalType:n,followListData:p,isListLoading:g,isFetchingMoreFollows:v,hasMoreFollows:G,openFollowModal:a,fetchNextFollows:h,handlePostClick:r,handleUserClick:k,loadUserPosts:z,currentUser:d,navigate:x}=Ze();if(J){let t;return e[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,s.jsx)(ce,{}),e[0]=t):t=e[0],t}if(!R){const t=`Try searching for another. The user @${u} could not be found.`;let i;return e[1]!==t?(i=(0,s.jsx)("div",{className:"flex min-h-[600px] items-center justify-center overflow-hidden rounded-none border-zinc-100 bg-white dark:bg-black md:rounded-xl",children:(0,s.jsx)(le,{title:"Account doesn't exist",message:t,icon:je})}),e[1]=t,e[2]=i):i=e[2],i}if(R.isBanned){const t=`The user @${u} has been suspended for violating our community guidelines.`;let i;return e[3]!==t?(i=(0,s.jsx)("div",{className:"flex min-h-[600px] items-center justify-center overflow-hidden rounded-none border-zinc-100 bg-white dark:bg-black md:rounded-xl",children:(0,s.jsx)(le,{title:"This account is banned",message:t,icon:oe})}),e[3]=t,e[4]=i):i=e[4],i}const l=R;let V;e[5]!==d||e[6]!==l.handle||e[7]!==b||e[8]!==r||e[9]!==k||e[10]!==f||e[11]!==o||e[12]!==z||e[13]!==H?(V=t=>{const i=t===void 0?!1:t;return H?(0,s.jsx)("div",{className:"flex flex-col",children:[1,2,3].map(as)}):b.length>0?(0,s.jsxs)(s.Fragment,{children:[b.map(Z=>(0,s.jsx)(Xe,{currentUser:d,...Z,onClick:()=>r(Z.id),onUserClick:k},Z.feed_id||Z.id)),f&&(0,s.jsx)("div",{className:"flex justify-center p-6",children:(0,s.jsxs)(ae,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>z(),disabled:o,children:[o&&(0,s.jsx)("span",{className:"mr-2 animate-pulse",children:"..."}),"Load more posts"]})})]}):i?null:(0,s.jsxs)("div",{className:"flex animate-in fade-in flex-col items-center gap-4 p-20 text-center text-zinc-500 duration-500",children:[(0,s.jsx)("div",{className:"mb-2 rounded-full bg-zinc-50 p-6 ring-1 ring-zinc-100 dark:bg-zinc-900 dark:ring-zinc-800",children:(0,s.jsx)(fe,{size:40,className:"text-zinc-300 dark:text-zinc-700"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"No posts yet"}),(0,s.jsxs)("p",{className:"max-w-[250px] text-sm text-zinc-500 dark:text-zinc-400",children:["When @",l.handle," shares posts, they will appear here."]})]})},e[5]=d,e[6]=l.handle,e[7]=b,e[8]=r,e[9]=k,e[10]=f,e[11]=o,e[12]=z,e[13]=H,e[14]=V):V=e[14];const w=V;let N;e[15]!==x?(N=()=>x(-1),e[15]=x,e[16]=N):N=e[16];let X;e[17]===Symbol.for("react.memo_cache_sentinel")?(X=(0,s.jsx)(ke,{size:22}),e[17]=X):X=e[17];let y;e[18]!==N?(y=(0,s.jsx)("button",{onClick:N,className:"rounded-full p-1 transition-colors hover:bg-zinc-100 dark:text-white dark:hover:bg-zinc-800",children:X}),e[18]=N,e[19]=y):y=e[19];let F;e[20]!==l.name?(F=(0,s.jsx)("h5",{className:"text-lg font-bold leading-none dark:text-white",children:l.name}),e[20]=l.name,e[21]=F):F=e[21];const K=l.follower_count||0;let _;e[22]!==K?(_=(0,s.jsxs)("span",{className:"mt-0.5 text-xs text-zinc-500",children:[K," Followers"]}),e[22]=K,e[23]=_):_=e[23];let P;e[24]!==F||e[25]!==_?(P=(0,s.jsxs)("div",{className:"flex flex-col",children:[F,_]}),e[24]=F,e[25]=_,e[26]=P):P=e[26];let C;e[27]!==y||e[28]!==P?(C=(0,s.jsx)("div",{className:"sticky top-0 z-20 border-b border-zinc-100 bg-white/90 p-4 py-3 backdrop-blur-md dark:border-zinc-800 dark:bg-black/90 md:hidden",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4",children:[y,P]})}),e[27]=y,e[28]=P,e[29]=C):C=e[29];const ee=d?.handle===l.handle;let M;e[30]!==x?(M=()=>x("/edit-profile"),e[30]=x,e[31]=M):M=e[31];let S,T;e[32]!==a?(S=()=>a("Followers"),T=()=>a("Following"),e[32]=a,e[33]=S,e[34]=T):(S=e[33],T=e[34]);let $;e[35]!==d||e[36]!==l||e[37]!==M||e[38]!==S||e[39]!==T||e[40]!==ee?($=(0,s.jsx)(ss,{profile:l,currentUser:d,isCurrentUser:ee,onEditProfile:M,onShowFollowers:S,onShowFollowing:T}),e[35]=d,e[36]=l,e[37]=M,e[38]=S,e[39]=T,e[40]=ee,e[41]=$):$=e[41];let Q;e[42]===Symbol.for("react.memo_cache_sentinel")?(Q=(0,s.jsx)("div",{className:"sticky top-[60px] z-10 border-b border-zinc-100 bg-white/90 backdrop-blur-md dark:border-zinc-800 dark:bg-black/90 md:top-0",children:(0,s.jsx)(Ce,{className:"hide-scrollbar h-auto w-full justify-start overflow-x-auto rounded-none bg-transparent p-0 px-2",children:["feed","media"].map(rs)})}),e[42]=Q):Q=e[42];let L;e[43]!==w?(L=w(),e[43]=w,e[44]=L):L=e[44];let I;e[45]!==L?(I=(0,s.jsx)(ie,{value:"feed",className:"m-0 border-none",children:L}),e[45]=L,e[46]=I):I=e[46];let D;e[47]!==w?(D=w(),e[47]=w,e[48]=D):D=e[48];let U;e[49]!==D?(U=(0,s.jsx)(ie,{value:"media",className:"m-0 border-none",children:D}),e[49]=D,e[50]=U):U=e[50];let W;e[51]!==m||e[52]!==q||e[53]!==I||e[54]!==U?(W=(0,s.jsxs)(we,{value:m,onValueChange:q,className:"w-full",children:[Q,I,U]}),e[51]=m,e[52]=q,e[53]=I,e[54]=U,e[55]=W):W=e[55];let A;e[56]!==$||e[57]!==W||e[58]!==C?(A=(0,s.jsxs)("div",{className:"border-y border-zinc-100 dark:border-zinc-800 md:border-b-0",children:[C,$,W]}),e[56]=$,e[57]=W,e[58]=C,e[59]=A):A=e[59];let B;e[60]!==c?(B=()=>c(!1),e[60]=c,e[61]=B):B=e[61];const se=n==="Followers"?`People who follow @${l.handle}`:`People @${l.handle} follows`;let E;e[62]!==h||e[63]!==p||e[64]!==n||e[65]!==G||e[66]!==v||e[67]!==g||e[68]!==x||e[69]!==c?(E=(0,s.jsx)("div",{className:"flex max-h-[75vh] flex-col overflow-y-auto",children:(0,s.jsx)("div",{className:"min-h-[300px]",children:g?(0,s.jsx)("div",{className:"flex flex-col",children:[1,2,3,4,5].map(ls)}):p.length>0?(0,s.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:[p.map(t=>(0,s.jsx)(We,{profile:t,onUserClick:i=>{c(!1),x(`/u/${i}`)}},t.id)),G&&(0,s.jsx)("div",{className:"flex justify-center p-4",children:(0,s.jsxs)(ae,{variant:"secondary",className:"w-full text-xs",onClick:()=>h(),disabled:v,children:[v?(0,s.jsx)("span",{className:"mr-2 animate-pulse",children:"..."}):null,"Load more"]})})]}):(0,s.jsx)("div",{className:"flex flex-col items-center justify-center py-20 text-zinc-500",children:(0,s.jsxs)("p",{className:"font-medium",children:["No ",n.toLowerCase()," yet."]})})})}),e[62]=h,e[63]=p,e[64]=n,e[65]=G,e[66]=v,e[67]=g,e[68]=x,e[69]=c,e[70]=E):E=e[70];let O;e[71]!==n||e[72]!==j||e[73]!==B||e[74]!==se||e[75]!==E?(O=(0,s.jsx)(Re,{isOpen:j,onClose:B,title:n,description:se,className:"sm:max-w-md",children:E}),e[71]=n,e[72]=j,e[73]=B,e[74]=se,e[75]=E,e[76]=O):O=e[76];let Y;return e[77]!==A||e[78]!==O?(Y=(0,s.jsxs)("div",{className:"min-h-screen overflow-hidden rounded-none border-zinc-100 bg-white pb-20 dark:bg-black dark:border-zinc-800 md:rounded-xl",children:[A,O]}),e[77]=A,e[78]=O,e[79]=Y):Y=e[79],Y},ks=ts;function as(e){return(0,s.jsx)(Te,{},e)}function rs(e){return(0,s.jsx)(Me,{value:e,className:"flex-1 whitespace-nowrap rounded-none border-b-2 px-4 py-4 text-sm font-bold capitalize text-zinc-500 transition-all data-[state=active]:border-black data-[state=active]:text-black dark:data-[state=active]:border-white dark:data-[state=active]:text-white",children:e==="feed"?"Posts":e},e)}function ls(e){return(0,s.jsx)(Pe,{},e)}export{ks as default};
