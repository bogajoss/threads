import{a as M}from"./rolldown-runtime-BaZ8gS7u.js";import{c as A,l as V,v as W,w as q}from"./framework-3lkjbTvb.js";import{an as B,un as G}from"./ui-libs-CLFiaQG3.js";import{n as Y,t as J}from"./media-libs-C98UjHPF.js";import{Ln as T,dn as K,on as Q}from"./index-4IiBRjit.js";import{i as H,n as X,r as D,t as Z}from"./text-processing-BMF44JzJ.js";var ee=D("hashtag",{isLink:!0});function te({scanner:t,parser:e}){const{POUND:l,UNDERSCORE:f,FULLWIDTHMIDDLEDOT:s,ASCIINUMERICAL:h,ALPHANUMERICAL:g}=t.tokens,{alpha:c,numeric:u,alphanumeric:r,emoji:p}=t.tokens.groups,a=e.start.tt(l),i=a.tt(f),n=new X(ee);a.tt(h,n),a.tt(g,n),a.ta(u,i),a.ta(c,n),a.ta(p,n),a.ta(s,n),i.tt(h,n),i.tt(g,n),i.ta(c,n),i.ta(p,n),i.ta(s,n),i.ta(u,i),i.tt(f,i),n.ta(r,n),n.ta(p,n),n.tt(s,n),n.tt(f,n)}H("hashtag",te);var re=D("mention",{isLink:!0,toHref(){return"/"+this.toString().slice(1)}});function se({scanner:t,parser:e}){const{HYPHEN:l,SLASH:f,UNDERSCORE:s,AT:h}=t.tokens,{domain:g}=t.tokens.groups,c=e.start.tt(h),u=c.tt(l);u.tt(l,u);const r=c.tt(s,re);c.ta(g,r),u.tt(s,r),u.ta(g,r),r.ta(g,r),r.tt(l,r),r.tt(s,r);const p=r.tt(f);p.ta(g,r),p.tt(s,r),p.tt(l,r)}H("mention",se);const ne={formatHref:(t,e)=>e==="mention"?`/u/${t.substring(1)}`:e==="hashtag"?`/tags/${t.substring(1)}`:t,attributes:{onClick:t=>t.stopPropagation(),className:"cursor-pointer font-bold text-rose-600 hover:underline dark:text-rose-400"},validate:{hashtag:t=>/^#[\u0980-\u09FF\w]+$/.test(t)},target:(t,e)=>e==="url"?"_blank":void 0,rel:(t,e)=>e==="url"?"noopener noreferrer":void 0},L={BASE_URL:"https://feed.systemadminbd.com",APP_ID:"com.mysys.app",CUSTOM_SCHEME:"mysys"},O=()=>("Capacitor"in window,L.BASE_URL),z=t=>`${O()}${t.startsWith("/")?t:`/${t}`}`,ke=t=>z(`/p/${t}`),Ce=t=>z(`/r/${t}`);var oe=A(),w=M(q(),1),d=M(V(),1),ae=t=>{const e=(0,oe.c)(13),{content:l,className:f,onClick:s}=t,h=W(),g=ie;let c;e[0]!==l?(c=typeof l=="string"?g(l):l,e[0]=l,e[1]=c):c=e[1];const u=c;let r;e[2]!==f?(r=T("whitespace-pre-line break-words",f),e[2]=f,e[3]=r):r=e[3];let p;e[4]!==h?(p={...ne,render:n=>{const{attributes:E,content:y}=n,{href:m,...v}=E,S=O();if(m.includes("internal.tag/")){const x=decodeURIComponent(m.split("internal.tag/")[1]);return(0,d.jsxs)("span",{...v,className:T("cursor-pointer font-bold text-blue-600 hover:underline dark:text-blue-400",v.className),onClick:R=>{R.stopPropagation(),h(`/tags/${x}`)},children:["#",x]},y)}let P=null;return m.startsWith("/")?P=m:m.startsWith(S)&&(P=m.replace(S,"")),P?(0,d.jsx)("span",{...v,className:T("cursor-pointer font-medium text-blue-600 hover:underline dark:text-blue-400",v.className),onClick:x=>{x.stopPropagation(),h(P)},children:y},y):(0,d.jsx)("a",{href:m,...v,target:"_blank",rel:"noopener noreferrer",className:T("text-blue-600 hover:underline dark:text-blue-400",v.className),onClick:le,children:y},y)}},e[4]=h,e[5]=p):p=e[5];let a;e[6]!==u||e[7]!==p?(a=(0,d.jsx)(Z,{options:p,children:u}),e[6]=u,e[7]=p,e[8]=a):a=e[8];let i;return e[9]!==s||e[10]!==r||e[11]!==a?(i=(0,d.jsx)("div",{className:r,onClick:s,children:a}),e[9]=s,e[10]=r,e[11]=a,e[12]=i):i=e[12],i},Pe=ae;function ie(t){return t.replace(/#([\u0980-\u09FF\w]+)/g,"https://internal.tag/$1")}function le(t){return t.stopPropagation()}var ce=A(),ue=t=>{const e=(0,ce.c)(24),{url:l,duration:f,isMe:s}=t,h=(0,w.useRef)(null),g=(0,w.useRef)(null),[c,u]=(0,w.useState)(!1),[r,p]=(0,w.useState)(!1),[a,i]=(0,w.useState)(0),[n,E]=(0,w.useState)(f||0);let y,m;e[0]!==f||e[1]!==s||e[2]!==l?(y=()=>{if(!h.current)return;const o=J.create({container:h.current,waveColor:s?"rgba(255, 255, 255, 0.35)":"rgba(135, 116, 225, 0.25)",progressColor:s?"#ffffff":"#8774e1",cursorColor:"transparent",barWidth:2,barGap:3,barRadius:2,height:28,normalize:!0,url:l});return g.current=o,o.on("ready",()=>{p(!0),f||E(o.getDuration())}),o.on("play",()=>u(!0)),o.on("pause",()=>u(!1)),o.on("finish",()=>{u(!1),o.setTime(0),i(0)}),o.on("audioprocess",()=>i(o.getCurrentTime())),o.on("interaction",()=>i(o.getCurrentTime())),()=>o.destroy()},m=[l,s,f],e[0]=f,e[1]=s,e[2]=l,e[3]=y,e[4]=m):(y=e[3],m=e[4]),(0,w.useEffect)(y,m);let v;e[5]===Symbol.for("react.memo_cache_sentinel")?(v=o=>{o.stopPropagation(),g.current?.playPause()},e[5]=v):v=e[5];const S=v,P=fe,x=!r,R=s?"bg-white/20 text-white":"bg-[#8774e1] text-white";let b;e[6]!==R?(b=T("size-10 flex shrink-0 items-center justify-center rounded-full transition-all active:scale-90",R),e[6]=R,e[7]=b):b=e[7];let k;e[8]!==c||e[9]!==r?(k=r?c?(0,d.jsx)(G,{size:20,fill:"currentColor"}):(0,d.jsx)(B,{size:20,fill:"currentColor",className:"ml-0.5"}):(0,d.jsx)("span",{className:"animate-pulse font-bold",children:"..."}),e[8]=c,e[9]=r,e[10]=k):k=e[10];let C;e[11]!==x||e[12]!==b||e[13]!==k?(C=(0,d.jsx)("button",{type:"button",onClick:S,disabled:x,className:b,children:k}),e[11]=x,e[12]=b,e[13]=k,e[14]=C):C=e[14];let $;e[15]===Symbol.for("react.memo_cache_sentinel")?($=(0,d.jsx)("div",{className:"h-7 w-full overflow-hidden",children:(0,d.jsx)("div",{ref:h,className:"w-full cursor-pointer"})}),e[15]=$):$=e[15];const _=s?"text-white/80":"text-[#8774e1]";let N;e[16]!==_?(N=T("text-[11px] font-medium mt-0.5 select-none tabular-nums",_),e[16]=_,e[17]=N):N=e[17];const U=c||a>0?P(a):P(n);let j;e[18]!==N||e[19]!==U?(j=(0,d.jsxs)("div",{className:"flex-1 flex flex-col justify-center min-w-0",children:[$,(0,d.jsx)("div",{className:N,children:U})]}),e[18]=N,e[19]=U,e[20]=j):j=e[20];let I;return e[21]!==j||e[22]!==C?(I=(0,d.jsxs)("div",{className:"flex items-center gap-3 py-1 min-w-[220px] md:min-w-[280px]",children:[C,j]}),e[21]=j,e[22]=C,e[23]=I):I=e[23],I},Ne=ue;function fe(t){return`${Math.floor(t/60)}:${Math.floor(t%60).toString().padStart(2,"0")}`}var pe=A(),me=t=>{const e=(0,pe.c)(27),{src:l,poster:f}=t,s=(0,w.useRef)(null),{reportVisibility:h,unregister:g}=Q(),{dataSaver:c}=K(),u=(0,w.useId)(),[r,p]=(0,w.useState)(!1);let a;e[0]===Symbol.for("react.memo_cache_sentinel")?(a={play:()=>{const _=s.current?.plyr;_&&(_.muted=!0,_.play().catch(de))},pause:()=>{const _=s.current?.plyr;_&&typeof _.pause=="function"&&_.pause()}},e[0]=a):a=e[0];const i=a;let n,E;e[1]!==c||e[2]!==u||e[3]!==h||e[4]!==g?(n=()=>{const _=new IntersectionObserver(o=>{const[F]=o;h(u,c?0:F.intersectionRatio,i)},{threshold:[0,.25,.5,.75,1]}),N=s.current?.elements?.container,U=s.current;N&&_.observe(N);let j;const I=()=>{const o=s.current?.plyr;o&&(o.ready?p(!0):typeof o.on=="function"&&o.on("ready",()=>p(!0)),clearInterval(j))};return j=setInterval(I,50),I(),()=>{clearInterval(j);const o=U?.plyr;o&&typeof o.pause=="function"&&o.pause(),g(u),N&&_.unobserve(N)}},E=[u,h,g,i,c],e[1]=c,e[2]=u,e[3]=h,e[4]=g,e[5]=n,e[6]=E):(n=e[5],E=e[6]),(0,w.useEffect)(n,E);let y;e[7]!==l?(y=[{src:l,type:"video/mp4"}],e[7]=l,e[8]=y):y=e[8];let m;e[9]!==f||e[10]!==y?(m={type:"video",sources:y,poster:f},e[9]=f,e[10]=y,e[11]=m):m=e[11];let v;e[12]===Symbol.for("react.memo_cache_sentinel")?(v={controls:["play-large","play","progress","current-time","mute","volume","fullscreen"],settings:["quality","speed"],ratio:"16:9",clickToPlay:!0,hideControls:!0,resetOnEnd:!0},e[12]=v):v=e[12];let S;e[13]!==m?(S={source:m,options:v},e[13]=m,e[14]=S):S=e[14];const P=S;let x;e[15]!==r?(x=!r&&(0,d.jsx)("div",{className:"absolute inset-0 flex items-center justify-center z-10 bg-zinc-900",children:(0,d.jsx)("div",{className:"size-8 border-2 border-white/20 border-t-white/80 rounded-full animate-spin"})}),e[15]=r,e[16]=x):x=e[16];const R=r?"opacity-100":"opacity-0";let b;e[17]!==R?(b=T("transition-opacity duration-500",R),e[17]=R,e[18]=b):b=e[18];let k;e[19]!==P?(k=(0,d.jsx)(Y,{ref:s,...P}),e[19]=P,e[20]=k):k=e[20];let C;e[21]!==b||e[22]!==k?(C=(0,d.jsx)("div",{className:b,children:k}),e[21]=b,e[22]=k,e[23]=C):C=e[23];let $;return e[24]!==C||e[25]!==x?($=(0,d.jsxs)("div",{className:"relative w-full bg-zinc-900 overflow-hidden",onClick:he,children:[x,C]}),e[24]=C,e[25]=x,e[26]=$):$=e[26],$},we=me;function de(){}function he(t){return t.stopPropagation()}export{Ce as a,ke as i,Ne as n,Pe as r,we as t};
