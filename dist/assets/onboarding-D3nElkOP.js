import{a as q}from"./rolldown-runtime-BaZ8gS7u.js";import{a as P,c as U,i as A,s as $}from"./animations-DZuN0xpW.js";import{_ as I,c as L}from"./framework-YRQI4BOE.js";import{a as Q,r as E}from"./query-O_8RQZTX.js";import"./database-Bh-Nv8Zy.js";import{En as S,Pt as C,en as J,ir as T,or as W,rr as M,wn as K}from"./ui-libs-Cxlst_z9.js";import"./media-libs-CqtNZWFg.js";import{$t as O,Cn as D,Gt as G,Ut as H,Wt as R,Zt as B,bn as Y,ot as Z,qt as z,vn as V,xn as X,yn as ee}from"./index-AwJ8Hy3X.js";var F=L(),k=q(U(),1),t=q($(),1);function xe(){const s=(0,F.c)(25),[e,a]=(0,k.useState)(1),f=I(),{currentUser:i,loading:p}=O(),{addToast:h}=B();let o,r;s[0]!==i||s[1]!==p||s[2]!==f?(o=()=>{!p&&!i&&f("/login")},r=[i,p,f],s[0]=i,s[1]=p,s[2]=f,s[3]=o,s[4]=r):(o=s[3],r=s[4]),(0,k.useEffect)(o,r);let n;if(s[5]!==h||s[6]!==i||s[7]!==f||s[8]!==e){n=()=>{e<2?a(e+1):x()};const x=async()=>{if(i)try{await X(i.id,{onboarding_completed:!0}),f("/feed")}catch(g){console.error("Failed to update onboarding status",g),h("Failed to complete onboarding, skipping layout...","error"),f("/feed")}};s[5]=h,s[6]=i,s[7]=f,s[8]=e,s[9]=n}else n=s[9];let d;s[10]!==e?(d=()=>{e>1&&a(e-1)},s[10]=e,s[11]=d):d=s[11];const m=d;if(p||!i){let x;return s[12]===Symbol.for("react.memo_cache_sentinel")?(x=(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,t.jsx)(S,{className:"w-8 h-8 animate-spin text-zinc-500"})}),s[12]=x):x=s[12],x}let l;s[13]!==i||s[14]!==m||s[15]!==n||s[16]!==e?(l=e===1&&(0,t.jsx)(te,{onNext:n,onBack:m,currentUser:i},"step1"),s[13]=i,s[14]=m,s[15]=n,s[16]=e,s[17]=l):l=s[17];let c;s[18]!==m||s[19]!==n||s[20]!==e?(c=e===2&&(0,t.jsx)(ae,{onNext:n,onBack:m,isLoading:!1},"step2"),s[18]=m,s[19]=n,s[20]=e,s[21]=c):c=s[21];let u;return s[22]!==l||s[23]!==c?(u=(0,t.jsx)("div",{className:"min-h-screen bg-white text-black dark:bg-black dark:text-white flex flex-col items-center justify-center",children:(0,t.jsxs)(P,{mode:"wait",children:[l,c]})}),s[22]=l,s[23]=c,s[24]=u):u=s[24],u}function te({onNext:s,currentUser:e}){const[a,f]=(0,k.useState)(""),{addToast:i}=B(),p=Q(),{data:h=[],isLoading:o}=E({queryKey:["onboarding-users",a],queryFn:async()=>a.length>2?ee(a):V(null,20)}),r=h.filter(l=>l.id!==e.id),[n,d]=(0,k.useState)(!1),m=async()=>{d(!0);try{const l=r.map(c=>Y(e.id,c.id));await Promise.allSettled(l),p.invalidateQueries({queryKey:["isFollowing"]}),i("Followed all users!","success"),setTimeout(()=>{s()},800)}catch{i("Failed to follow some users","error")}finally{d(!1)}};return(0,t.jsxs)(A.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"flex flex-col h-screen max-h-screen w-full md:max-w-2xl mx-auto p-4 md:p-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4 md:mb-6",children:[(0,t.jsx)("div",{className:"w-10"}),(0,t.jsxs)("button",{onClick:s,className:"flex items-center text-zinc-900 dark:text-white ml-auto hover:opacity-70 transition",children:[(0,t.jsx)("span",{className:"text-sm md:text-base font-medium",children:"Next"}),(0,t.jsx)(M,{className:"w-5 h-5 md:w-6 md:h-6 ml-1"})]})]}),(0,t.jsxs)("div",{className:"mb-6 md:mb-8 text-center space-y-1 md:space-y-2",children:[(0,t.jsx)("h1",{className:"text-xl md:text-3xl font-bold leading-tight",children:"Follow creators and communities"}),(0,t.jsx)("p",{className:"text-zinc-500 text-xs md:text-sm",children:"Build your feed with people and communities you love"})]}),(0,t.jsxs)("div",{className:"relative mb-6 md:mb-8",children:[(0,t.jsx)("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-zinc-400",children:(0,t.jsx)(J,{className:"w-4 h-4 md:w-5 md:h-5"})}),(0,t.jsx)("input",{type:"text",placeholder:"Search creators...",className:"w-full h-11 md:h-12 rounded-lg md:rounded-xl bg-zinc-100 dark:bg-zinc-900 pl-11 pr-4 text-sm md:text-[15px] outline-none placeholder:text-zinc-400 focus:ring-2 focus:ring-violet-500 transition",value:a,onChange:l=>f(l.target.value)})]}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto -mx-2 md:-mx-4 px-2 md:px-4 pb-24 space-y-3 md:space-y-4 scrollbar-hide",children:[o?(0,t.jsx)("div",{className:"flex justify-center py-10",children:(0,t.jsx)(S,{className:"w-6 h-6 md:w-8 md:h-8 animate-spin text-zinc-400"})}):r.map(l=>(0,t.jsx)(se,{user:l,currentUser:e},l.id)),!o&&r.length===0&&(0,t.jsx)("div",{className:"text-center text-zinc-500 py-10 text-sm md:text-base",children:"No creators found"})]}),(0,t.jsx)("div",{className:"fixed bottom-4 md:bottom-8 left-0 right-0 px-4 md:px-8 max-w-2xl mx-auto",children:(0,t.jsx)(z,{onClick:m,className:"w-full text-sm md:text-[15px] h-11 md:h-12",disabled:n||o||r.length===0,children:n?(0,t.jsx)(S,{className:"w-4 h-4 md:w-5 md:h-5 animate-spin"}):"Follow all"})})]})}function se(s){const e=(0,F.c)(36),{user:a,currentUser:f}=s,{isFollowing:i,handleFollow:p}=Z(a,f.id);let h;e[0]!==a.avatar?(h=(0,t.jsx)(G,{src:a.avatar}),e[0]=a.avatar,e[1]=h):h=e[1];let o;e[2]!==a.handle[0]?(o=a.handle[0]?.toUpperCase(),e[2]=a.handle[0],e[3]=o):o=e[3];let r;e[4]!==o?(r=(0,t.jsx)(R,{children:o}),e[4]=o,e[5]=r):r=e[5];let n;e[6]!==h||e[7]!==r?(n=(0,t.jsxs)(H,{className:"w-10 h-10 md:w-12 md:h-12 border border-zinc-100 dark:border-zinc-800 shrink-0",children:[h,r]}),e[6]=h,e[7]=r,e[8]=n):n=e[8];let d;e[9]!==a.handle?(d=(0,t.jsx)("span",{className:"font-semibold text-sm md:text-[15px] leading-tight truncate",children:a.handle}),e[9]=a.handle,e[10]=d):d=e[10];let m;e[11]!==a.verified?(m=a.verified&&(0,t.jsx)("div",{className:"bg-blue-500 rounded-full p-[2px] shrink-0",children:(0,t.jsx)(W,{className:"w-2 h-2 text-white stroke-[3px]"})}),e[11]=a.verified,e[12]=m):m=e[12];let l;e[13]!==d||e[14]!==m?(l=(0,t.jsxs)("div",{className:"flex items-center gap-1 min-w-0",children:[d,m]}),e[13]=d,e[14]=m,e[15]=l):l=e[15];let c;e[16]!==a.name?(c=(0,t.jsx)("span",{className:"text-zinc-500 text-xs md:text-[14px] leading-tight truncate",children:a.name}),e[16]=a.name,e[17]=c):c=e[17];let u;e[18]!==l||e[19]!==c?(u=(0,t.jsxs)("div",{className:"flex flex-col min-w-0 flex-1",children:[l,c]}),e[18]=l,e[19]=c,e[20]=u):u=e[20];let x;e[21]!==n||e[22]!==u?(x=(0,t.jsxs)("div",{className:"flex items-center gap-3 md:gap-4 min-w-0 flex-1",children:[n,u]}),e[21]=n,e[22]=u,e[23]=x):x=e[23];const g=i?"outline":"primary",N=i&&"text-zinc-500 dark:text-zinc-400";let w;e[24]!==N?(w=D("h-9 md:h-10 px-4 md:px-6 text-xs md:text-sm font-semibold border-zinc-200 dark:border-zinc-700 transition-all shrink-0 ml-2 md:ml-4",N),e[24]=N,e[25]=w):w=e[25];let j;e[26]!==p?(j=()=>p(),e[26]=p,e[27]=j):j=e[27];const v=i?"Following":"Follow";let y;e[28]!==g||e[29]!==w||e[30]!==j||e[31]!==v?(y=(0,t.jsx)(z,{variant:g,className:w,onClick:j,children:v}),e[28]=g,e[29]=w,e[30]=j,e[31]=v,e[32]=y):y=e[32];let b;return e[33]!==x||e[34]!==y?(b=(0,t.jsxs)("div",{className:"flex items-center justify-between py-2 md:py-3 px-2 md:px-3 rounded-lg hover:bg-zinc-50 dark:hover:bg-zinc-900/50 transition",children:[x,y]}),e[33]=x,e[34]=y,e[35]=b):b=e[35],b}function ae(s){const e=(0,F.c)(25),{onNext:a,onBack:f}=s,[i,p]=(0,k.useState)(!1);let h;e[0]!==a?(h=async()=>{p(!0),await a()},e[0]=a,e[1]=h):h=e[1];const o=h;let r,n,d;e[2]===Symbol.for("react.memo_cache_sentinel")?(r={opacity:0,x:20},n={opacity:1,x:0},d={opacity:0,x:-20},e[2]=r,e[3]=n,e[4]=d):(r=e[2],n=e[3],d=e[4]);let m,l;e[5]===Symbol.for("react.memo_cache_sentinel")?(m=(0,t.jsx)(T,{className:"w-5 h-5 md:w-6 md:h-6"}),l=(0,t.jsx)("span",{className:"text-sm md:text-base font-medium",children:"Back"}),e[5]=m,e[6]=l):(m=e[5],l=e[6]);let c;e[7]!==f?(c=(0,t.jsx)("div",{className:"flex items-center mb-4 md:mb-6",children:(0,t.jsxs)("button",{onClick:f,className:"flex items-center text-zinc-900 dark:text-white hover:opacity-70 transition",children:[m,l]})}),e[7]=f,e[8]=c):c=e[8];let u;e[9]===Symbol.for("react.memo_cache_sentinel")?(u=(0,t.jsx)("div",{className:"mb-8 md:mb-12 text-center",children:(0,t.jsx)("h1",{className:"text-2xl md:text-4xl font-bold",children:"Welcome to MySys"})}),e[9]=u):u=e[9];let x;e[10]===Symbol.for("react.memo_cache_sentinel")?(x=(0,t.jsx)("div",{className:"mt-0.5 md:mt-1",children:(0,t.jsx)(C,{className:"w-6 h-6 md:w-8 md:h-8 text-violet-600 dark:text-violet-400 shrink-0"})}),e[10]=x):x=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=(0,t.jsxs)("div",{className:"flex gap-3 md:gap-4",children:[x,(0,t.jsxs)("div",{className:"space-y-1 md:space-y-2 min-w-0",children:[(0,t.jsx)("h3",{className:"font-semibold text-sm md:text-base",children:"Express yourself"}),(0,t.jsx)("p",{className:"text-zinc-500 text-xs md:text-sm leading-relaxed",children:"Share your thoughts, life moments, and connect with communities. Post anything from text to multimedia content."})]})]}),e[11]=g):g=e[11];let N;e[12]===Symbol.for("react.memo_cache_sentinel")?(N=(0,t.jsx)("div",{className:"mt-0.5 md:mt-1",children:(0,t.jsx)(C,{className:"w-6 h-6 md:w-8 md:h-8 text-blue-600 dark:text-blue-400 shrink-0"})}),e[12]=N):N=e[12];let w;e[13]===Symbol.for("react.memo_cache_sentinel")?(w=(0,t.jsxs)("div",{className:"flex gap-3 md:gap-4",children:[N,(0,t.jsxs)("div",{className:"space-y-1 md:space-y-2 min-w-0",children:[(0,t.jsx)("h3",{className:"font-semibold text-sm md:text-base",children:"Discover & Connect"}),(0,t.jsx)("p",{className:"text-zinc-500 text-xs md:text-sm leading-relaxed",children:"Follow creators, join communities, and engage with content that matters. Build meaningful connections with people worldwide."})]})]}),e[13]=w):w=e[13];let j;e[14]===Symbol.for("react.memo_cache_sentinel")?(j=(0,t.jsx)("div",{className:"mt-0.5 md:mt-1",children:(0,t.jsx)(K,{className:"w-6 h-6 md:w-8 md:h-8 text-emerald-600 dark:text-emerald-400 shrink-0"})}),e[14]=j):j=e[14];let v;e[15]===Symbol.for("react.memo_cache_sentinel")?(v=(0,t.jsxs)("div",{className:"space-y-6 md:space-y-8 flex-1 overflow-y-auto pb-24 scrollbar-hide",children:[g,w,(0,t.jsxs)("div",{className:"flex gap-3 md:gap-4",children:[j,(0,t.jsxs)("div",{className:"space-y-1 md:space-y-2 min-w-0",children:[(0,t.jsx)("h3",{className:"font-semibold text-sm md:text-base",children:"Privacy & Safety"}),(0,t.jsx)("p",{className:"text-zinc-500 text-xs md:text-sm leading-relaxed",children:"Your data is yours. We prioritize privacy and security. Control what you share and who sees it."})]})]})]}),e[15]=v):v=e[15];let y;e[16]!==i?(y=i?(0,t.jsx)(S,{className:"w-4 h-4 md:w-5 md:h-5 animate-spin"}):"Join MySys",e[16]=i,e[17]=y):y=e[17];let b;e[18]!==o||e[19]!==i||e[20]!==y?(b=(0,t.jsx)("div",{className:"fixed bottom-4 md:bottom-8 left-0 right-0 px-4 md:px-8 max-w-2xl mx-auto",children:(0,t.jsx)(z,{onClick:o,className:"w-full text-sm md:text-[15px] h-11 md:h-12",disabled:i,children:y})}),e[18]=o,e[19]=i,e[20]=y,e[21]=b):b=e[21];let _;return e[22]!==b||e[23]!==c?(_=(0,t.jsxs)(A.div,{initial:r,animate:n,exit:d,className:"flex flex-col h-screen max-h-screen w-full md:max-w-2xl mx-auto p-4 md:p-8 relative",children:[c,u,v,b]}),e[22]=b,e[23]=c,e[24]=_):_=e[24],_}export{xe as default};
