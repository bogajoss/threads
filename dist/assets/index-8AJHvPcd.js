import{n as gt}from"./rolldown-runtime-2JzG8er9.js";import{$ as as,A as rs,At as We,B as ue,Bt as Ce,C as ls,Ct as vt,D as is,Dt as ns,E as os,Et as jt,F as cs,Ft as Te,G as wt,H as yt,I as ds,It as E,J as ms,K as fs,L as us,Lt as Nt,M as xs,Mt as at,N as hs,Nt as Qe,O as ps,Ot as bs,P as gs,Pt as vs,Q as Ne,R as js,Rt as xe,S as ws,St as zt,T as ys,Tt as kt,U as Ns,V as zs,Vt as ks,W as _s,X as _t,Y as Cs,Z as qe,_ as Ss,_n as $s,_t as Ct,a as Ps,at as De,b as Ls,bt as St,c as Ms,cn as Is,ct as ae,d as Fs,dn as Os,dt as As,et as Es,f as Rs,fn as ie,ft as Ts,g as qs,gn as Ve,gt as $t,h as Ds,hn as ge,ht as Bs,i as Ws,it as Qs,j as Vs,jt as Hs,k as Ks,kt as Js,l as Gs,ln as Pt,lt as Lt,m as Us,mn as Oe,mt as ke,n as Zs,nt as Xs,o as Ys,ot as He,p as ea,pn as ta,pt as Mt,q as sa,r as aa,rt as ra,s as la,sn as ia,st as Ae,t as be,tt as na,u as It,un as rt,ut as oa,v as ca,vn as da,vt as Be,w as ma,wt as fa,x as ua,xt as xa,y as ha,yt as pa,z as Ft,zt as ba}from"./framework-DpD2_Bws.js";import{t as ga}from"./query-mGQNLu_U.js";import{t as va}from"./database-DCcU4ujN.js";import{n as ja,r as wa,t as ya}from"./vendor-DyYlx6SC.js";/* empty css                 */(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const n of i.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function a(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerPolicy&&(i.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?i.credentials="include":l.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(l){if(l.ep)return;l.ep=!0;const i=a(l);fetch(l.href,i)}})();var Na=$s(),N=gt(da(),1),za="https://dbkcedktqhueqnulnosq.supabase.co",ka="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRia2NlZGt0cWh1ZXFudWxub3NxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg5NzE1NTQsImV4cCI6MjA4NDU0NzU1NH0.m_Tv-H7o5mL1Nac6TH-S1JkS1x7ZN1AK_4Mt1hZlkvU";const A=va(za,ka),ve=t=>t?{id:t.id,handle:t.username,name:t.display_name,avatar:t.avatar_url||"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm",cover:t.cover_url||"https://systemadminbd.com/uploads/675346dd55e0c7.43939630.png",verified:t.is_verified,bio:t.bio,location:t.location,website:t.website,follower_count:t.follower_count||0,following_count:t.following_count||0,lastSeen:t.last_seen_at}:null,Se=t=>t?{...t,stats:{comments:t.comments_count||0,likes:t.likes_count||0,mirrors:t.mirrors_count||0},user:ve(t.user),timeAgo:new Date(t.created_at).toLocaleDateString()}:null,_a=t=>t?{...t,user:t.actor?.username,avatar:t.actor?.avatar_url||"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm"}:null,Ot=t=>t?{...t,media:t.media_url,user:ve(t.user)}:null,Ca=async(t,e={})=>{if(!t.type.startsWith("image/"))return t;const a={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0,initialQuality:.8,...e};try{const r=await wa(t,a);return console.log(`Original size: ${(t.size/1024/1024).toFixed(2)} MB`),console.log(`Compressed size: ${(r.size/1024/1024).toFixed(2)} MB`),r}catch(r){return console.error("Image compression failed:",r),t}},_e=async(t,e="media")=>{let a=t;t.type.startsWith("image/")&&(a=await Ca(t));const r=t.name.split(".").pop(),l=`${`${Math.random()}-${Date.now()}.${r}`}`,{data:i,error:n}=await A.storage.from(e).upload(l,a);if(n)throw n;const{data:{publicUrl:c}}=A.storage.from(e).getPublicUrl(i.path);return{url:c,name:t.name,type:t.type.startsWith("image/")?"image":t.type.startsWith("video/")?"video":"file",size:a.size}},Sa=async()=>{const{data:t,error:e}=await A.from("posts").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified,
                bio,
                location,
                website,
                follower_count,
                following_count
            )
        `).order("created_at",{ascending:!1});if(e)throw e;return t.map(Se)},$a=async t=>{const{data:e,error:a}=await A.from("posts").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified,
                bio,
                location,
                website,
                follower_count,
                following_count
            )
        `).eq("id",t).single();if(a)throw a;return Se(e)},Pa=async({content:t,media:e=[],type:a="text",userId:r,poll:l=null,parentId:i=null})=>{const{data:n,error:c}=await A.from("posts").insert([{user_id:r,content:t,media:e,type:a,poll:l,parent_id:i,created_at:new Date().toISOString()}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `);if(c)throw c;return Se(n[0])},La=async t=>{const{error:e}=await A.from("posts").delete().eq("id",t);if(e)throw e},Ma=async t=>{const{data:e,error:a}=await A.from("users").select("*").or(`username.ilike.%${t}%,display_name.ilike.%${t}%`).limit(5);if(a)throw a;return e.map(ve)},At=async(t,e)=>{const{data:a}=await A.from("conversation_participants").select("conversation_id").eq("user_id",t),r=a.map(c=>c.conversation_id),{data:l}=await A.from("conversation_participants").select("conversation_id").eq("user_id",e).in("conversation_id",r).maybeSingle();if(l)return l.conversation_id;const{data:i,error:n}=await A.from("conversations").insert([{}]).select().single();if(n)throw n;return await A.from("conversation_participants").insert([{conversation_id:i.id,user_id:t},{conversation_id:i.id,user_id:e}]),i.id},Ia=async()=>{const{data:t,error:e}=await A.from("users").select("*");if(e)throw e;return t.reduce((a,r)=>{const l=ve(r);return a[l.handle]=l,a},{})},Fa=async t=>{const{data:e,error:a}=await A.from("users").select("*").eq("username",t).maybeSingle();if(a)throw a;return ve(e)},Oa=async(t,e)=>{const{error:a}=await A.from("users").update({display_name:e.name,username:e.handle,avatar_url:e.avatar,bio:e.bio,cover_url:e.cover,website:e.website,location:e.location}).eq("id",t);if(a)throw a},Aa=async t=>{if(!t)return[];const{data:e,error:a}=await A.from("notifications").select(`
            *,
            actor:users!actor_id (
                username,
                avatar_url
            )
        `).eq("recipient_id",t).order("created_at",{ascending:!1});if(a)throw a;return e.map(_a)},Ea=async t=>{const{error:e}=await A.from("notifications").update({is_read:!0}).eq("recipient_id",t).eq("is_read",!1);if(e)throw e},Ra=async t=>{if(!t)return 0;const{count:e,error:a}=await A.from("notifications").select("*",{count:"exact",head:!0}).eq("recipient_id",t).eq("is_read",!1);if(a)throw a;return e||0},Ta=async t=>{if(!t)return 0;const{count:e,error:a}=await A.from("messages").select("*",{count:"exact",head:!0}).eq("is_read",!1).neq("sender_id",t).in("conversation_id",(await A.from("conversation_participants").select("conversation_id").eq("user_id",t)).data?.map(r=>r.conversation_id)||[]);if(a)throw a;return e||0},qa=async(t,e)=>{if(!t||!e)return;const{error:a}=await A.from("messages").update({is_read:!0}).eq("conversation_id",t).neq("sender_id",e).eq("is_read",!1);if(a)throw a},Da=async t=>{if(!t)return[];const{data:e,error:a}=await A.from("conversation_participants").select(`
            conversation:conversations (
                id,
                last_message_at,
                last_message_content,
                participants:conversation_participants (
                    user:users (
                        id,
                        username,
                        display_name,
                        avatar_url
                    )
                ),
                messages (
                    id,
                    is_read,
                    sender_id
                )
            )
        `).eq("user_id",t);if(a)throw console.error("Supabase Error in fetchConversations:",a.message),a;return e.map(r=>{const l=r.conversation,i=l.participants.find(c=>c.user?.id!==t)||l.participants[0],n=l.messages?.filter(c=>!c.is_read&&c.sender_id!==t).length||0;return{id:l.id,user:ve(i?.user),lastMessage:l.last_message_content||"No messages yet",time:l.last_message_at?new Date(l.last_message_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",unread:n}})},Ba=async t=>{const{data:e,error:a}=await A.from("messages").select("*").eq("conversation_id",t).order("created_at",{ascending:!0});if(a)throw a;return e},Wa=async(t,e,a,r="text",l=[])=>{const{data:i,error:n}=await A.from("messages").insert([{conversation_id:t,sender_id:e,content:a,type:r,media:l}]).select();if(n)throw n;return i[0]},Qa=async t=>{const{data:e,error:a}=await A.from("posts").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `).eq("parent_id",t).order("created_at",{ascending:!0});if(a)throw a;return e.map(Se)},Va=async(t,e,a)=>{const{data:r,error:l}=await A.from("posts").insert([{parent_id:t,user_id:e,content:a,type:"text",created_at:new Date().toISOString()}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `);if(l)throw l;return Se(r[0])},Ha=async(t,e)=>{const{data:a}=await A.from("likes").select("*").eq("post_id",t).eq("user_id",e).maybeSingle();return a?(await A.from("likes").delete().eq("post_id",t).eq("user_id",e),!1):(await A.from("likes").insert([{post_id:t,user_id:e}]),!0)},Ka=async(t,e)=>{if(!e)return!1;const{data:a}=await A.from("likes").select("*").eq("post_id",t).eq("user_id",e).maybeSingle();return!!a},Ja=async(t,e)=>{const{data:a}=await A.from("follows").select("*").eq("follower_id",t).eq("following_id",e).maybeSingle();return a?(await A.from("follows").delete().eq("follower_id",t).eq("following_id",e),!1):(await A.from("follows").insert([{follower_id:t,following_id:e}]),!0)},Ga=async(t,e)=>{if(!t)return!1;const{data:a}=await A.from("follows").select("*").eq("follower_id",t).eq("following_id",e).maybeSingle();return!!a},Ua=async t=>{const{data:e,error:a}=await A.from("users").select("follower_count, following_count").eq("id",t).maybeSingle();return a||!e?{followers:0,following:0}:{followers:e.follower_count||0,following:e.following_count||0}},Za=async()=>{const{data:t,error:e}=await A.from("stories").select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `).gt("expires_at",new Date().toISOString()).order("created_at",{ascending:!1});if(e)throw e;return t.map(Ot)},Xa=async(t,e,a="image")=>{const{data:r,error:l}=await A.from("stories").insert([{user_id:t,media_url:e,type:a,expires_at:new Date(Date.now()+864e5).toISOString()}]).select(`
            *,
            user:users!user_id (
                id,
                username,
                display_name,
                avatar_url,
                is_verified
            )
        `);if(l)throw l;return Ot(r[0])},Ya=[{tag:"Lens",posts:"0"},{tag:"Web3",posts:"0"},{tag:"Art",posts:"0"}];var s=gt(ks(),1),Et=(0,N.createContext)();const er=({children:t})=>{const[e,a]=(0,N.useState)(null),[r,l]=(0,N.useState)(null),[i,n]=(0,N.useState)({}),[c,o]=(0,N.useState)(!0),d=async p=>{try{const{data:b,error:g}=await A.from("users").select("*").eq("id",p.id).maybeSingle();if(g)throw g;if(b){const j=ve(b);a(j),n(w=>({...w,[j.handle]:j}))}else a({id:p.id,email:p.email,name:p.email.split("@")[0],handle:p.email.split("@")[0],avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm",verified:!1})}catch(b){console.error("Error fetching user profile:",b)}finally{o(!1)}};(0,N.useEffect)(()=>{if(!e?.id)return;const p=async()=>{await A.from("users").update({last_seen_at:new Date().toISOString()}).eq("id",e.id)};p();const b=setInterval(p,3e4),g=()=>{document.visibilityState==="visible"&&p()};return window.addEventListener("visibilitychange",g),window.addEventListener("beforeunload",p),()=>{clearInterval(b),window.removeEventListener("visibilitychange",g),window.removeEventListener("beforeunload",p)}},[e?.id]),(0,N.useEffect)(()=>{A.auth.getSession().then(({data:{session:b}})=>{b?d(b.user):o(!1)});const{data:{subscription:p}}=A.auth.onAuthStateChange((b,g)=>{g?d(g.user):(a(null),o(!1))});return()=>p.unsubscribe()},[]);const m=async({email:p,password:b})=>{const{data:g,error:j}=await A.auth.signInWithPassword({email:p,password:b});if(j)throw j;return l(null),g},u=async({email:p,password:b,username:g,name:j})=>{const{data:{user:w},error:C}=await A.auth.signUp({email:p,password:b,options:{data:{username:g.toLowerCase(),name:j}}});if(C)throw C;return l(null),w},x=async()=>{await A.auth.signOut(),a(null),l(null)},f=async p=>{e&&(await Oa(e.id,p),await d(e))},h=async p=>{if(i[p])return i[p];const b=await Fa(p);return b?(n(g=>({...g,[p]:b})),b):null};return(0,s.jsx)(Et.Provider,{value:{currentUser:e,authMode:r,setAuthMode:l,profiles:i,login:m,signup:u,logout:x,updateProfile:f,getProfileByHandle:h,loading:c},children:!c&&t})},se=()=>{const t=(0,N.useContext)(Et);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t};var tr=E(),Rt=(0,N.createContext)();const sr=t=>{const e=(0,tr.c)(10),{children:a}=t,{currentUser:r}=se();let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=new Set,e[0]=l):l=e[0];const[i,n]=(0,N.useState)(l);let c;e[1]!==r?(c=()=>{if(!r?.id)return;const x=A.channel("global_presence",{config:{presence:{key:r.id}}});return x.on("presence",{event:"sync"},()=>{const f=x.presenceState(),h=new Set;Object.keys(f).forEach(p=>h.add(p)),n(h)}).subscribe(async f=>{f==="SUBSCRIBED"&&await x.track({userId:r.id,online_at:new Date().toISOString()})}),()=>{A.removeChannel(x),n(new Set)}},e[1]=r,e[2]=c):c=e[2];const o=r?.id;let d;e[3]!==o?(d=[o],e[3]=o,e[4]=d):d=e[4],(0,N.useEffect)(c,d);let m;e[5]!==i?(m={onlineUsers:i},e[5]=i,e[6]=m):m=e[6];let u;return e[7]!==a||e[8]!==m?(u=(0,s.jsx)(Rt.Provider,{value:m,children:a}),e[7]=a,e[8]=m,e[9]=u):u=e[9],u},Tt=()=>{const t=(0,N.useContext)(Rt);if(!t)throw new Error("usePresence must be used within a PresenceProvider");return t};var ar=E(),qt=(0,N.createContext)();const rr=t=>{const e=(0,ar.c)(11),{children:a}=t,[r,l]=(0,N.useState)(lr);let i,n;e[0]!==r?(i=()=>{localStorage.setItem("theme",r?"dark":"light"),r?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},n=[r],e[0]=r,e[1]=i,e[2]=n):(i=e[1],n=e[2]),(0,N.useEffect)(i,n);let c;e[3]!==r?(c=()=>l(!r),e[3]=r,e[4]=c):c=e[4];const o=c;let d;e[5]!==r||e[6]!==o?(d={darkMode:r,setDarkMode:l,toggleDarkMode:o},e[5]=r,e[6]=o,e[7]=d):d=e[7];let m;return e[8]!==a||e[9]!==d?(m=(0,s.jsx)(qt.Provider,{value:d,children:a}),e[8]=a,e[9]=d,e[10]=m):m=e[10],m},Ke=()=>{const t=(0,N.useContext)(qt);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t};function lr(){const t=localStorage.getItem("theme");return t==="dark"||!t&&window.matchMedia("(prefers-color-scheme: dark)").matches}var ir=E(),nr=t=>{const e=(0,ir.c)(7);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];const{theme:r}=js(),l=r===void 0?"system":r;let i,n;e[2]===Symbol.for("react.memo_cache_sentinel")?(i={success:(0,s.jsx)(vt,{className:"size-4"}),info:(0,s.jsx)(As,{className:"size-4"}),warning:(0,s.jsx)(_s,{className:"size-4"}),error:(0,s.jsx)(na,{className:"size-4"}),loading:(0,s.jsx)(ae,{className:"size-4 animate-spin"})},n={"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)","--border-radius":"var(--radius)"},e[2]=i,e[3]=n):(i=e[2],n=e[3]);let c;return e[4]!==a||e[5]!==l?(c=(0,s.jsx)(vs,{theme:l,className:"toaster group",icons:i,style:n,...a}),e[4]=a,e[5]=l,e[6]=c):c=e[6],c},or=E(),Dt=(0,N.createContext)();const cr=t=>{const e=(0,or.c)(4),{children:a}=t,r=dr;let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l={addToast:r},e[0]=l):l=e[0];let i;e[1]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsx)(nr,{position:"bottom-center",toastOptions:{className:"rounded-full font-bold"}}),e[1]=i):i=e[1];let n;return e[2]!==a?(n=(0,s.jsxs)(Dt.Provider,{value:l,children:[a,i]}),e[2]=a,e[3]=n):n=e[3],n},he=()=>{const t=(0,N.useContext)(Dt);if(!t)throw new Error("useToast must be used within a ToastProvider");return t};function dr(t,e){const a=e===void 0?"success":e;a==="error"?Te.error(t):a==="info"?Te.info(t):Te.success(t)}var Bt=(0,N.createContext)();const mr=({children:t})=>{const[e,a]=(0,N.useState)([]),[r,l]=(0,N.useState)(!0),i=async()=>{try{a(await Sa())}catch(m){console.error("Failed to load posts:",m)}finally{l(!1)}};(0,N.useEffect)(()=>{i()},[]);const n=async m=>{const u=await Pa(m);return i(),u},c=async m=>{await La(m),a(u=>u.filter(x=>x.id!==m))},o=m=>e.find(u=>u.id===m),d=(m,u="feed")=>{let x=e.filter(f=>!!(f.user?.handle===m||f.repostedBy&&f.repostedBy.handle===m));return u==="media"?x.filter(f=>f.type==="video"||f.type==="image"||f.media?.length>0):u==="replies"?x.filter(f=>f.parent_id!==null):x};return(0,s.jsx)(Bt.Provider,{value:{posts:e,setPosts:a,addPost:n,deletePost:c,getPostById:o,getUserPosts:d,loading:r,refreshPosts:i},children:t})},ze=()=>{const t=(0,N.useContext)(Bt);if(!t)throw new Error("usePosts must be used within a PostProvider");return t};var fr=E(),Wt=(0,N.createContext)();const ur=t=>{const e=(0,fr.c)(9),{children:a}=t;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r={isOpen:!1,images:[],currentIndex:0},e[0]=r):r=e[0];const[l,i]=(0,N.useState)(r);let n;e[1]===Symbol.for("react.memo_cache_sentinel")?(n=(h,p)=>{const b=p===void 0?0:p;i({isOpen:!0,images:Array.isArray(h)?h:[h],currentIndex:b})},e[1]=n):n=e[1];const c=n;let o;e[2]===Symbol.for("react.memo_cache_sentinel")?(o=()=>{i(xr)},e[2]=o):o=e[2];const d=o;let m;e[3]===Symbol.for("react.memo_cache_sentinel")?(m=h=>{i(p=>({...p,currentIndex:h}))},e[3]=m):m=e[3];const u=m;let x;e[4]!==l?(x={...l,openLightbox:c,closeLightbox:d,setIndex:u},e[4]=l,e[5]=x):x=e[5];let f;return e[6]!==a||e[7]!==x?(f=(0,s.jsx)(Wt.Provider,{value:x,children:a}),e[6]=a,e[7]=x,e[8]=f):f=e[8],f},Je=()=>{const t=(0,N.useContext)(Wt);if(!t)throw new Error("useLightbox must be used within a LightboxProvider");return t};function xr(t){return{...t,isOpen:!1}}var hr=E();const Qt=t=>{const e=(0,hr.c)(16),a=Ce(),r=t?.id;let l;e[0]!==r?(l=["unread_notifications_count",r],e[0]=r,e[1]=l):l=e[1];let i;e[2]!==t?.id?(i=()=>Ra(t?.id),e[2]=t?.id,e[3]=i):i=e[3];const n=!!t?.id;let c;e[4]!==l||e[5]!==i||e[6]!==n?(c={queryKey:l,queryFn:i,enabled:n},e[4]=l,e[5]=i,e[6]=n,e[7]=c):c=e[7];const{data:o}=xe(c),d=o===void 0?0:o;let m;e[8]!==t||e[9]!==a?(m=()=>{if(!t?.id)return;const h=A.channel(`unread_count:${t.id}`).on("postgres_changes",{event:"*",schema:"public",table:"notifications",filter:`recipient_id=eq.${t.id}`},()=>{a.invalidateQueries({queryKey:["unread_notifications_count",t.id]}),a.invalidateQueries({queryKey:["notifications",t.id]})}).subscribe();return()=>A.removeChannel(h)},e[8]=t,e[9]=a,e[10]=m):m=e[10];const u=t?.id;let x;e[11]!==a||e[12]!==u?(x=[u,a],e[11]=a,e[12]=u,e[13]=x):x=e[13],(0,N.useEffect)(m,x);let f;return e[14]!==d?(f={unreadCount:d},e[14]=d,e[15]=f):f=e[15],f};var pr=E();const Ge=t=>{const e=(0,pr.c)(52),a=Ce();let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r={},e[0]=r):r=e[0];const[l,i]=(0,N.useState)(r),n=(0,N.useRef)(null),c=t?.id;let o;e[1]!==c?(o=["conversations",c],e[1]=c,e[2]=o):o=e[2];let d;e[3]!==t?.id?(d=()=>Da(t?.id),e[3]=t?.id,e[4]=d):d=e[4];const m=!!t?.id;let u;e[5]!==o||e[6]!==d||e[7]!==m?(u={queryKey:o,queryFn:d,enabled:m},e[5]=o,e[6]=d,e[7]=m,e[8]=u):u=e[8];const{data:x,isLoading:f}=xe(u);let h;e[9]!==x?(h=x===void 0?[]:x,e[9]=x,e[10]=h):h=e[10];const p=h,b=t?.id;let g;e[11]!==b?(g=["unread_messages_count",b],e[11]=b,e[12]=g):g=e[12];let j;e[13]!==t?.id?(j=()=>Ta(t?.id),e[13]=t?.id,e[14]=j):j=e[14];const w=!!t?.id;let C;e[15]!==j||e[16]!==w||e[17]!==g?(C={queryKey:g,queryFn:j,enabled:w},e[15]=j,e[16]=w,e[17]=g,e[18]=C):C=e[18];const{data:y}=xe(C),z=y===void 0?0:y;let P;e[19]!==t||e[20]!==a?(P=()=>{if(!t?.id)return;const D=A.channel(`user_messages:${t.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},K=>{const Q=K.new;a.setQueryData(["messages",Q.conversation_id],I=>I?I.find(R=>R.id===Q.id)?I:[...I,Q]:[Q]),Q.sender_id!==t.id&&a.invalidateQueries({queryKey:["unread_messages_count",t.id]}),a.invalidateQueries(["conversations",t.id]),i(I=>({...I,[Q.conversation_id]:!1}))}).subscribe(),T=A.channel("chat_typing_shared").on("broadcast",{event:"typing"},K=>{const{payload:Q}=K,{conversationId:I,isTyping:R,userId:U}=Q;U!==t.id&&i(X=>({...X,[I]:R}))}).subscribe();return n.current=T,()=>{A.removeChannel(D),A.removeChannel(T)}},e[19]=t,e[20]=a,e[21]=P):P=e[21];const S=t?.id;let L;e[22]!==a||e[23]!==S?(L=[S,a],e[22]=a,e[23]=S,e[24]=L):L=e[24],(0,N.useEffect)(P,L);let k;e[25]!==t?(k=D=>{const{convId:T,text:K,type:Q,media:I}=D,R=Q===void 0?"text":Q,U=I===void 0?[]:I;return Wa(T,t.id,K,R,U)},e[25]=t,e[26]=k):k=e[26];let $;e[27]!==t||e[28]!==a?($=D=>{a.setQueryData(["messages",D.conversation_id],T=>T?T.find(K=>K.id===D.id)?T:[...T,D]:[D]),a.invalidateQueries(["conversations",t.id])},e[27]=t,e[28]=a,e[29]=$):$=e[29];let v;e[30]!==k||e[31]!==$?(v={mutationFn:k,onSuccess:$},e[30]=k,e[31]=$,e[32]=v):v=e[32];const _=Nt(v);let M;e[33]!==t?(M=(D,T)=>{n.current&&n.current.send({type:"broadcast",event:"typing",payload:{conversationId:D,isTyping:T,userId:t.id}})},e[33]=t,e[34]=M):M=e[34];const F=M;let B;e[35]!==t||e[36]!==a?(B=async D=>{!t?.id||!D||(await qa(D,t.id),a.invalidateQueries({queryKey:["unread_messages_count",t.id]}),a.invalidateQueries({queryKey:["conversations",t.id]}))},e[35]=t,e[36]=a,e[37]=B):B=e[37];const q=B;let W;e[38]!==t?.id?(W=D=>(D===void 0?[]:D).map(T=>({id:T.id,sender:T.sender_id===t?.id?"me":"them",text:T.content,type:T.type||"text",media:T.media||[],isRead:T.is_read,time:new Date(T.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})),e[38]=t?.id,e[39]=W):W=e[39];const V=W;let H;e[40]!==_?(H=(D,T,K,Q)=>_.mutate({convId:D,text:T,type:K,media:Q}),e[40]=_,e[41]=H):H=e[41];let O;return e[42]!==p||e[43]!==V||e[44]!==f||e[45]!==q||e[46]!==_.isPending||e[47]!==F||e[48]!==H||e[49]!==l||e[50]!==z?(O={conversations:p,unreadCount:z,isConvLoading:f,sendMessage:H,sendTypingStatus:F,typingStatus:l,markAsRead:q,formatMessages:V,isSending:_.isPending},e[42]=p,e[43]=V,e[44]=f,e[45]=q,e[46]=_.isPending,e[47]=F,e[48]=H,e[49]=l,e[50]=z,e[51]=O):O=e[51],O};var br=E(),gr=()=>{const t=(0,br.c)(12),{currentUser:e}=se(),{unreadCount:a}=Qt(e),{unreadCount:r}=Ge(e);let l,i,n,c,o;t[0]===Symbol.for("react.memo_cache_sentinel")?(l={id:"home",icon:Mt,path:"/"},i={id:"explore",icon:zt,path:"/explore"},n={id:"reels",icon:$t,path:"/reels"},c={id:"messages",icon:Ae,path:"/messages"},o={id:"notifications",icon:We,path:"/notifications"},t[0]=l,t[1]=i,t[2]=n,t[3]=c,t[4]=o):(l=t[0],i=t[1],n=t[2],c=t[3],o=t[4]);const d=e?`/u/${e.handle}`:"/explore";let m;t[5]!==d?(m=[l,i,n,c,o,{id:"profile",icon:zs,path:d}],t[5]=d,t[6]=m):m=t[6];const u=m;let x;t[7]===Symbol.for("react.memo_cache_sentinel")?(x=(0,s.jsx)(Is,{to:"/",className:"mb-8 hover:scale-110 transition-transform",children:(0,s.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",alt:"Logo",className:"size-8 rounded-lg"})}),t[7]=x):x=t[7];let f;return t[8]!==r||t[9]!==u||t[10]!==a?(f=(0,s.jsxs)("aside",{className:"sticky top-0 hidden md:flex h-screen w-[68px] flex-col items-center py-5 border-r border-zinc-100 dark:border-zinc-800 shrink-0 bg-white dark:bg-black transition-colors duration-200",children:[x,(0,s.jsx)("nav",{className:"flex flex-col gap-y-4 w-full items-center",children:u.map(h=>(0,s.jsxs)(Pt,{to:h.path,className:jr,children:[(0,s.jsx)(h.icon,{size:26,strokeWidth:2.5}),h.id==="notifications"&&a>0&&(0,s.jsx)("span",{className:"absolute top-2 right-2 size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"}),h.id==="messages"&&r>0&&(0,s.jsx)("span",{className:"absolute top-2 right-2 size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"})]},h.id))})]}),t[8]=r,t[9]=u,t[10]=a,t[11]=f):f=t[11],f},vr=gr;function jr(t){const{isActive:e}=t;return`p-2.5 rounded-xl transition-all duration-200 border border-transparent relative ${e?"text-black dark:text-white bg-zinc-100 dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800":"text-zinc-500 hover:bg-zinc-50 dark:hover:bg-zinc-900"}`}var wr=E(),yr=t=>{const e=(0,wr.c)(13),{value:a,onChange:r,onClear:l,placeholder:i}=t,n=i===void 0?"Search...":i;let c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=(0,s.jsx)(_t,{size:18,className:"absolute left-4 top-1/2 -translate-y-1/2 text-zinc-400 group-focus-within:text-violet-500 transition-colors"}),e[0]=c):c=e[0];let o;e[1]!==r?(o=x=>r(x.target.value),e[1]=r,e[2]=o):o=e[2];let d;e[3]!==n||e[4]!==o||e[5]!==a?(d=(0,s.jsx)("input",{className:"w-full rounded-full border border-zinc-100 dark:border-zinc-800 bg-zinc-50 dark:bg-zinc-900/50 text-zinc-900 dark:text-white px-11 py-2.5 text-sm outline-none focus:border-violet-500 focus:ring-1 focus:ring-violet-500 transition-all",placeholder:n,value:a,onChange:o}),e[3]=n,e[4]=o,e[5]=a,e[6]=d):d=e[6];let m;e[7]!==l||e[8]!==a?(m=a&&(0,s.jsx)("button",{onClick:l,className:"absolute right-4 top-1/2 -translate-y-1/2 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 transition-colors",children:(0,s.jsx)(ue,{size:16})}),e[7]=l,e[8]=a,e[9]=m):m=e[9];let u;return e[10]!==d||e[11]!==m?(u=(0,s.jsxs)("div",{className:"relative group w-full",children:[c,d,m]}),e[10]=d,e[11]=m,e[12]=u):u=e[12],u},Ie=yr,Nr=E();function J(...t){return ya(ja(t))}const zr=()=>{const t=(0,Nr.c)(2),{pathname:e}=Oe();let a;return t[0]!==e?(a=[e],t[0]=e,t[1]=a):a=t[1],(0,N.useEffect)(_r,a),null},de=t=>typeof t!="string"?!1:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t),kr=(t,e)=>{const a=document.createElement("canvas"),r=t.naturalWidth/t.width,l=t.naturalHeight/t.height;return a.width=e.width,a.height=e.height,a.getContext("2d").drawImage(t,e.x*r,e.y*l,e.width*r,e.height*l,0,0,e.width,e.height),new Promise((i,n)=>{a.toBlob(c=>{if(!c){n(new Error("Canvas is empty"));return}i(c)},"image/jpeg",1)})},Me=t=>{if(!t)return"";const e=new Date-new Date(t),a=Math.floor(e/1e3),r=Math.floor(a/60),l=Math.floor(r/60),i=Math.floor(l/24);return a<60?"Just now":r<60?`${r}m ago`:l<24?`${l}h ago`:i<7?`${i}d ago`:new Date(t).toLocaleDateString()};function _r(){window.scrollTo(0,0)}var Cr=E(),Sr=t=>{const e=(0,Cr.c)(9),{className:a}=t,{setAuthMode:r}=se();let l;e[0]!==a?(l=J("border border-[--border] rounded-2xl p-8 flex flex-col items-center text-center gap-4 bg-[--card] shadow-sm",a),e[0]=a,e[1]=l):l=e[1];let i,n;e[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"size-16 rounded-full border-4 border-amber-400 border-t-transparent animate-spin duration-[3000ms]"}),(0,s.jsx)("span",{className:"absolute inset-0 flex items-center justify-center text-2xl",children:"ðŸ’«"})]}),n=(0,s.jsx)("h3",{className:"font-extrabold text-lg text-[--foreground] mt-2 leading-tight",children:"Get your Sysm account now!"}),e[2]=i,e[3]=n):(i=e[2],n=e[3]);let c;e[4]!==r?(c=(0,s.jsx)("button",{onClick:()=>r("signup"),className:"w-full bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 py-2.5 rounded-full font-black text-sm uppercase tracking-wider hover:opacity-90 active:scale-95 transition-all shadow-lg cursor-pointer",children:"Signup now"}),e[4]=r,e[5]=c):c=e[5];let o;return e[6]!==l||e[7]!==c?(o=(0,s.jsxs)("div",{className:l,children:[i,n,c]}),e[6]=l,e[7]=c,e[8]=o):o=e[8],o},Vt=Sr,$r=E(),Pr=t=>{const e=(0,$r.c)(41),{trendingTopics:a}=t;let r;e[0]!==a?(r=a===void 0?[]:a,e[0]=a,e[1]=r):r=e[1];const l=r,{currentUser:i,setAuthMode:n}=se(),{darkMode:c,toggleDarkMode:o}=Ke(),[d,m]=(0,N.useState)("");let u;e[2]===Symbol.for("react.memo_cache_sentinel")?(u=["Â© 2026 Sysm","Terms","Privacy","Guidelines","Discord","Sysm","GitHub","Support","Status"],e[2]=u):u=e[2];const x=u;let f;e[3]!==c?(f=c?(0,s.jsx)(fs,{size:20}):(0,s.jsx)(ra,{size:20}),e[3]=c,e[4]=f):f=e[4];let h;e[5]!==f||e[6]!==o?(h=(0,s.jsx)("button",{onClick:o,className:"p-3 rounded-full bg-zinc-50 dark:bg-zinc-900 text-zinc-500 dark:text-zinc-400 border border-zinc-100 dark:border-zinc-800 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-all cursor-pointer",title:"Toggle Theme",children:f}),e[5]=f,e[6]=o,e[7]=h):h=e[7];const p=h;if(i){let k;e[8]===Symbol.for("react.memo_cache_sentinel")?(k=()=>m(""),e[8]=k):k=e[8];let $;e[9]!==d?($=(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(Ie,{value:d,onChange:m,onClear:k})}),e[9]=d,e[10]=$):$=e[10];let v;e[11]!==$||e[12]!==p?(v=(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[$,p]}),e[11]=$,e[12]=p,e[13]=v):v=e[13];let _;e[14]===Symbol.for("react.memo_cache_sentinel")?(_=(0,s.jsx)("h3",{className:"font-extrabold text-xl mb-4 px-2 text-[--foreground]",children:"What's happening"}),e[14]=_):_=e[14];let M;e[15]!==l?(M=l.map(Mr),e[15]=l,e[16]=M):M=e[16];let F;e[17]!==M?(F=(0,s.jsxs)("div",{className:"bg-zinc-50 dark:bg-zinc-900 rounded-2xl p-4 border border-[--border]",children:[_,(0,s.jsx)("div",{className:"flex flex-col gap-1",children:M})]}),e[17]=M,e[18]=F):F=e[18];let B;e[19]===Symbol.for("react.memo_cache_sentinel")?(B=(0,s.jsx)("div",{className:"flex flex-wrap gap-x-4 gap-y-2 px-2 text-[13px] text-zinc-500 font-medium pb-5",children:x.map(Ir)}),e[19]=B):B=e[19];let q;return e[20]!==F||e[21]!==v?(q=(0,s.jsxs)("aside",{className:"sticky top-5 hidden w-[320px] shrink-0 flex-col gap-y-6 lg:flex overflow-y-auto max-h-screen",children:[v,F,B]}),e[20]=F,e[21]=v,e[22]=q):q=e[22],q}let b,g;e[23]!==n?(b=(0,s.jsx)("button",{onClick:()=>n("signup"),className:"flex-1 bg-[--card] border border-[--border] py-2.5 rounded-full font-bold text-[--foreground] hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors shadow-sm cursor-pointer",children:"Signup"}),g=()=>n("login"),e[23]=n,e[24]=b,e[25]=g):(b=e[24],g=e[25]);let j;e[26]===Symbol.for("react.memo_cache_sentinel")?(j=(0,s.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",alt:"",className:"size-4 rounded-sm"}),e[26]=j):j=e[26];let w;e[27]!==g?(w=(0,s.jsxs)("button",{onClick:g,className:"flex-1 bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 py-2.5 rounded-full font-bold flex items-center justify-center gap-2 hover:opacity-90 transition-opacity cursor-pointer",children:[j,"Login"]}),e[27]=g,e[28]=w):w=e[28];let C;e[29]!==b||e[30]!==w||e[31]!==p?(C=(0,s.jsxs)("div",{className:"flex gap-3",children:[b,w,p]}),e[29]=b,e[30]=w,e[31]=p,e[32]=C):C=e[32];let y;e[33]===Symbol.for("react.memo_cache_sentinel")?(y=()=>m(""),e[33]=y):y=e[33];let z;e[34]!==d?(z=(0,s.jsx)(Ie,{value:d,onChange:m,onClear:y}),e[34]=d,e[35]=z):z=e[35];let P;e[36]===Symbol.for("react.memo_cache_sentinel")?(P=(0,s.jsx)(Vt,{}),e[36]=P):P=e[36];let S;e[37]===Symbol.for("react.memo_cache_sentinel")?(S=(0,s.jsx)("div",{className:"flex flex-wrap gap-x-4 gap-y-2 px-2 text-[13px] text-zinc-500 font-medium pb-5",children:x.map(Fr)}),e[37]=S):S=e[37];let L;return e[38]!==C||e[39]!==z?(L=(0,s.jsxs)("aside",{className:"sticky top-5 hidden w-[350px] shrink-0 flex-col gap-y-6 lg:flex pr-4",children:[C,z,P,S]}),e[38]=C,e[39]=z,e[40]=L):L=e[40],L},Lr=Pr;function Mr(t){return(0,s.jsxs)("div",{className:"px-3 py-3 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-xl cursor-pointer transition-colors group",children:[(0,s.jsx)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400 font-medium",children:"Trending"}),(0,s.jsxs)("div",{className:"font-bold text-[--foreground]",children:["#",t.tag]}),(0,s.jsxs)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:[t.posts," posts"]})]},t.tag)}function Ir(t){return(0,s.jsx)("a",{href:"#",className:"hover:underline",children:t},t)}function Fr(t){return(0,s.jsx)("a",{href:"#",className:"hover:underline",children:t},t)}var Ue=E();function Y(t){const e=(0,Ue.c)(8);let a,r;e[0]!==t?({className:a,...r}=t,e[0]=t,e[1]=a,e[2]=r):(a=e[1],r=e[2]);let l;e[3]!==a?(l=J("relative flex size-8 shrink-0 overflow-hidden rounded-full",a),e[3]=a,e[4]=l):l=e[4];let i;return e[5]!==r||e[6]!==l?(i=(0,s.jsx)(us,{"data-slot":"avatar",className:l,...r}),e[5]=r,e[6]=l,e[7]=i):i=e[7],i}function ee(t){const e=(0,Ue.c)(8);let a,r;e[0]!==t?({className:a,...r}=t,e[0]=t,e[1]=a,e[2]=r):(a=e[1],r=e[2]);let l;e[3]!==a?(l=J("aspect-square size-full",a),e[3]=a,e[4]=l):l=e[4];let i;return e[5]!==r||e[6]!==l?(i=(0,s.jsx)(ds,{"data-slot":"avatar-image",className:l,...r}),e[5]=r,e[6]=l,e[7]=i):i=e[7],i}function te(t){const e=(0,Ue.c)(8);let a,r;e[0]!==t?({className:a,...r}=t,e[0]=t,e[1]=a,e[2]=r):(a=e[1],r=e[2]);let l;e[3]!==a?(l=J("bg-muted flex size-full items-center justify-center rounded-full",a),e[3]=a,e[4]=l):l=e[4];let i;return e[5]!==r||e[6]!==l?(i=(0,s.jsx)(cs,{"data-slot":"avatar-fallback",className:l,...r}),e[5]=r,e[6]=l,e[7]=i):i=e[7],i}var Or=E(),Ar=t=>{const e=(0,Or.c)(23),{handleProfileClick:a}=t,{currentUser:r}=se(),{unreadCount:l}=Qt(r),{unreadCount:i}=Ge(r),n=Oe();let c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=[{id:"home",icon:Mt,path:"/"},{id:"explore",icon:zt,path:"/explore"},{id:"reels",icon:$t,path:"/reels"},{id:"messages",icon:Ae,path:"/messages"},{id:"notifications",icon:We,path:"/notifications"}],e[0]=c):c=e[0];const o=c;let d;e[1]!==i||e[2]!==l?(d=o.map(w=>(0,s.jsx)(Pt,{to:w.path,className:Rr,children:C=>{const{isActive:y}=C;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(w.icon,{size:26,strokeWidth:y?2.5:2}),w.id==="notifications"&&l>0&&(0,s.jsx)("span",{className:"absolute top-3 right-[30%] size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"}),w.id==="messages"&&i>0&&(0,s.jsx)("span",{className:"absolute top-3 right-[30%] size-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-black"})]})}},w.id)),e[1]=i,e[2]=l,e[3]=d):d=e[3];let m;e[4]!==r||e[5]!==a?(m=()=>{r&&a(r.handle)},e[4]=r,e[5]=a,e[6]=m):m=e[6];const u=`size-7 border-2 ${n.pathname.startsWith("/u/")?"border-black dark:border-white":"border-transparent opacity-70"}`,x=r?.avatar||"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm";let f;e[7]!==x?(f=(0,s.jsx)(ee,{src:x,alt:"Profile",className:"object-cover"}),e[7]=x,e[8]=f):f=e[8];let h;e[9]!==r?.handle?.[0]?(h=r?.handle?.[0]?.toUpperCase(),e[9]=r?.handle?.[0],e[10]=h):h=e[10];let p;e[11]!==h?(p=(0,s.jsx)(te,{children:h}),e[11]=h,e[12]=p):p=e[12];let b;e[13]!==u||e[14]!==f||e[15]!==p?(b=(0,s.jsxs)(Y,{className:u,children:[f,p]}),e[13]=u,e[14]=f,e[15]=p,e[16]=b):b=e[16];let g;e[17]!==m||e[18]!==b?(g=(0,s.jsx)("button",{onClick:m,className:"flex-1 flex flex-col items-center justify-center h-full",children:b}),e[17]=m,e[18]=b,e[19]=g):g=e[19];let j;return e[20]!==g||e[21]!==d?(j=(0,s.jsxs)("nav",{className:"fixed bottom-0 left-0 right-0 z-[40] flex h-16 items-center border-t border-zinc-100 bg-white/90 pb-safe backdrop-blur-md dark:border-zinc-800 dark:bg-black/90 md:hidden",children:[d,g]}),e[20]=g,e[21]=d,e[22]=j):j=e[22],j},Er=Ar;function Rr(t){const{isActive:e}=t;return`flex flex-1 flex-col items-center justify-center h-full transition-all duration-200 relative ${e?"text-black dark:text-white":"text-zinc-400 opacity-70"}`}var Tr=E(),qr=()=>{const t=(0,Tr.c)(5);let e,a;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,s.jsx)("img",{src:"https://systemadminbd.com/uploads/675346dd55e0c7.43939630.png",alt:"Welcome Banner",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-700"}),a=(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"}),t[0]=e,t[1]=a):(e=t[0],a=t[1]);let r;t[2]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsx)("h1",{className:"text-3xl sm:text-4xl font-black mb-1 drop-shadow-lg",children:"Welcome to Sysm"}),t[2]=r):r=t[2];let l;t[3]===Symbol.for("react.memo_cache_sentinel")?(l=(0,s.jsxs)("div",{className:"absolute bottom-6 left-8 text-white",children:[r,(0,s.jsxs)("p",{className:"text-sm sm:text-base font-medium opacity-90 tracking-wide drop-shadow-md",children:["a social network built by"," ",(0,s.jsx)("a",{href:"https://t.me/systemadminbd",target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:"@Systemadminbd"})]})]}),t[3]=l):l=t[3];let i;return t[4]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsxs)("div",{className:"relative w-full aspect-[21/9] sm:aspect-[2.5/1] rounded-3xl overflow-hidden mb-6 group cursor-pointer",children:[e,a,l,(0,s.jsx)("div",{className:"absolute bottom-4 right-8",children:(0,s.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",className:"size-12 animate-pulse opacity-80 rounded-xl",alt:""})})]}),t[4]=i):i=t[4],i},Dr=qr,Br=E(),Wr=()=>{const t=(0,Br.c)(23),e=Oe(),a=ge(),{darkMode:r}=Ke(),l=e.pathname==="/";let i;t[0]!==e.pathname?(i=e.pathname.split("/").length>2&&e.pathname.startsWith("/messages"),t[0]=e.pathname,t[1]=i):i=t[1];const n=i;let c;t[2]!==a?(c=C=>{a(`/u/${C}`)},t[2]=a,t[3]=c):c=t[3];const o=c,d=`min-h-screen bg-[--background] text-[--foreground] font-sans selection:bg-violet-500 selection:text-white transition-colors duration-200 ${r?"dark":""}`;let m;t[4]===Symbol.for("react.memo_cache_sentinel")?(m=(0,s.jsx)(vr,{}),t[4]=m):m=t[4];const u=!n&&"pb-24 md:pb-0";let x;t[5]!==u?(x=J("flex-1 flex justify-center gap-x-2 md:gap-x-8 py-0 md:py-5 px-0 md:px-4",u),t[5]=u,t[6]=x):x=t[6];let f;t[7]!==l?(f=l&&(0,s.jsx)(Dr,{}),t[7]=l,t[8]=f):f=t[8];let h;t[9]===Symbol.for("react.memo_cache_sentinel")?(h=(0,s.jsx)("div",{className:"w-full",children:(0,s.jsx)(Os,{})}),t[9]=h):h=t[9];let p;t[10]!==f?(p=(0,s.jsxs)("div",{className:"w-full flex flex-col flex-1",children:[f,h]}),t[10]=f,t[11]=p):p=t[11];let b;t[12]===Symbol.for("react.memo_cache_sentinel")?(b=(0,s.jsx)(Lr,{trendingTopics:Ya}),t[12]=b):b=t[12];let g;t[13]!==x||t[14]!==p?(g=(0,s.jsxs)("div",{className:"flex justify-center w-full max-w-[1300px] mx-auto min-h-screen px-0 sm:px-0",children:[m,(0,s.jsxs)("div",{className:x,children:[p,b]})]}),t[13]=x,t[14]=p,t[15]=g):g=t[15];let j;t[16]!==o||t[17]!==n?(j=!n&&(0,s.jsx)(Er,{handleProfileClick:o}),t[16]=o,t[17]=n,t[18]=j):j=t[18];let w;return t[19]!==g||t[20]!==j||t[21]!==d?(w=(0,s.jsxs)("div",{className:d,children:[g,j]}),t[19]=g,t[20]=j,t[21]=d,t[22]=w):w=t[22],w},Qr=Wr,pe=E();function Ht(t){const e=(0,pe.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let r;return e[2]!==a?(r=(0,s.jsx)(hs,{"data-slot":"dialog",...a}),e[2]=a,e[3]=r):r=e[3],r}function Vr(t){const e=(0,pe.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let r;return e[2]!==a?(r=(0,s.jsx)(xs,{"data-slot":"dialog-portal",...a}),e[2]=a,e[3]=r):r=e[3],r}function Hr(t){const e=(0,pe.c)(8);let a,r;e[0]!==t?({className:a,...r}=t,e[0]=t,e[1]=a,e[2]=r):(a=e[1],r=e[2]);let l;e[3]!==a?(l=J("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),e[3]=a,e[4]=l):l=e[4];let i;return e[5]!==r||e[6]!==l?(i=(0,s.jsx)(Vs,{"data-slot":"dialog-overlay",className:l,...r}),e[5]=r,e[6]=l,e[7]=i):i=e[7],i}function Kt(t){const e=(0,pe.c)(15);let a,r,l,i;e[0]!==t?({className:r,children:a,showCloseButton:i,...l}=t,e[0]=t,e[1]=a,e[2]=r,e[3]=l,e[4]=i):(a=e[1],r=e[2],l=e[3],i=e[4]);const n=i===void 0?!0:i;let c;e[5]===Symbol.for("react.memo_cache_sentinel")?(c=(0,s.jsx)(Hr,{}),e[5]=c):c=e[5];let o;e[6]!==r?(o=J("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 outline-none sm:max-w-lg",r),e[6]=r,e[7]=o):o=e[7];let d;e[8]!==n?(d=n&&(0,s.jsxs)(ps,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,s.jsx)(ue,{}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]}),e[8]=n,e[9]=d):d=e[9];let m;return e[10]!==a||e[11]!==l||e[12]!==o||e[13]!==d?(m=(0,s.jsxs)(Vr,{"data-slot":"dialog-portal",children:[c,(0,s.jsxs)(Ks,{"data-slot":"dialog-content",className:o,...l,children:[a,d]})]}),e[10]=a,e[11]=l,e[12]=o,e[13]=d,e[14]=m):m=e[14],m}function Jt(t){const e=(0,pe.c)(8);let a,r;e[0]!==t?({className:a,...r}=t,e[0]=t,e[1]=a,e[2]=r):(a=e[1],r=e[2]);let l;e[3]!==a?(l=J("flex flex-col gap-2 text-center sm:text-left",a),e[3]=a,e[4]=l):l=e[4];let i;return e[5]!==r||e[6]!==l?(i=(0,s.jsx)("div",{"data-slot":"dialog-header",className:l,...r}),e[5]=r,e[6]=l,e[7]=i):i=e[7],i}function Gt(t){const e=(0,pe.c)(8);let a,r;e[0]!==t?({className:a,...r}=t,e[0]=t,e[1]=a,e[2]=r):(a=e[1],r=e[2]);let l;e[3]!==a?(l=J("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),e[3]=a,e[4]=l):l=e[4];let i;return e[5]!==r||e[6]!==l?(i=(0,s.jsx)("div",{"data-slot":"dialog-footer",className:l,...r}),e[5]=r,e[6]=l,e[7]=i):i=e[7],i}function Ut(t){const e=(0,pe.c)(8);let a,r;e[0]!==t?({className:a,...r}=t,e[0]=t,e[1]=a,e[2]=r):(a=e[1],r=e[2]);let l;e[3]!==a?(l=J("text-lg leading-none font-semibold",a),e[3]=a,e[4]=l):l=e[4];let i;return e[5]!==r||e[6]!==l?(i=(0,s.jsx)(gs,{"data-slot":"dialog-title",className:l,...r}),e[5]=r,e[6]=l,e[7]=i):i=e[7],i}function Kr(t){const e=(0,pe.c)(8);let a,r;e[0]!==t?({className:a,...r}=t,e[0]=t,e[1]=a,e[2]=r):(a=e[1],r=e[2]);let l;e[3]!==a?(l=J("text-muted-foreground text-sm",a),e[3]=a,e[4]=l):l=e[4];let i;return e[5]!==r||e[6]!==l?(i=(0,s.jsx)(rs,{"data-slot":"dialog-description",className:l,...r}),e[5]=r,e[6]=l,e[7]=i):i=e[7],i}var Jr=E(),Gr=t=>{const e=(0,Jr.c)(20),{isOpen:a,onClose:r,title:l,children:i,footer:n,description:c,className:o}=t;let d;e[0]!==r?(d=g=>{g||r()},e[0]=r,e[1]=d):d=e[1];const m=d;let u;e[2]!==o?(u=J("sm:max-w-md max-h-[calc(100dvh-2rem)] flex flex-col p-0 gap-0 overflow-hidden bg-white dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800",o),e[2]=o,e[3]=u):u=e[3];let x;e[4]!==c||e[5]!==l?(x=l&&(0,s.jsxs)(Jt,{className:"px-5 py-4 border-b border-zinc-100 dark:border-zinc-800 shrink-0",children:[(0,s.jsx)(Ut,{className:"text-xl font-bold",children:l}),c&&(0,s.jsx)(Kr,{children:c})]}),e[4]=c,e[5]=l,e[6]=x):x=e[6];let f;e[7]!==i?(f=(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-5 min-h-0",children:i}),e[7]=i,e[8]=f):f=e[8];let h;e[9]!==n?(h=n&&(0,s.jsx)(Gt,{className:"px-5 py-4 border-t border-zinc-100 dark:border-zinc-800 shrink-0 bg-white dark:bg-zinc-900",children:n}),e[9]=n,e[10]=h):h=e[10];let p;e[11]!==u||e[12]!==x||e[13]!==f||e[14]!==h?(p=(0,s.jsxs)(Kt,{className:u,children:[x,f,h]}),e[11]=u,e[12]=x,e[13]=f,e[14]=h,e[15]=p):p=e[15];let b;return e[16]!==m||e[17]!==a||e[18]!==p?(b=(0,s.jsx)(Ht,{open:a,onOpenChange:m,children:p}),e[16]=m,e[17]=a,e[18]=p,e[19]=b):b=e[19],b},Ze=Gr,Ur=E(),Zr=t=>{const e=(0,Ur.c)(12);let a,r,l,i;e[0]!==t?({children:a,variant:l,className:i,...r}=t,e[0]=t,e[1]=a,e[2]=r,e[3]=l,e[4]=i):(a=e[1],r=e[2],l=e[3],i=e[4]);const n=l===void 0?"primary":l,c=i===void 0?"":i;let o;e[5]===Symbol.for("react.memo_cache_sentinel")?(o={primary:"text-white hover:text-white bg-zinc-900 hover:bg-zinc-800 border border-zinc-900 dark:bg-white dark:text-black dark:border-white dark:hover:bg-zinc-200",secondary:"text-zinc-900 border border-zinc-300 hover:border-zinc-400 bg-transparent hover:bg-zinc-50 dark:text-white dark:border-zinc-700 dark:hover:border-zinc-600 dark:hover:bg-zinc-900",outline:"text-zinc-900 border border-zinc-300 hover:border-zinc-400 bg-white dark:bg-transparent dark:text-white dark:border-zinc-700 dark:hover:bg-zinc-900",danger:"text-white bg-red-500 hover:bg-red-600 border border-red-500",ghost:"text-zinc-500 hover:bg-zinc-100 dark:text-zinc-400 dark:hover:bg-zinc-800 border-transparent"},e[5]=o):o=e[5];const d=`rounded-full font-bold inline-flex items-center justify-center relative overflow-hidden px-4 py-1.5 transition-all duration-200 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:active:scale-100 touch-manipulation ${o[n]} ${c}`;let m;e[6]!==a?(m=(0,s.jsx)("div",{className:"flex items-center gap-x-1.5",children:a}),e[6]=a,e[7]=m):m=e[7];let u;return e[8]!==r||e[9]!==d||e[10]!==m?(u=(0,s.jsx)("button",{className:d,...r,children:m}),e[8]=r,e[9]=d,e[10]=m,e[11]=u):u=e[11],u},ne=Zr,Xr=E(),Yr=t=>{const e=(0,Xr.c)(33),{src:a,isOpen:r,onClose:l,onCropComplete:i,aspect:n,circular:c}=t,[o,d]=(0,N.useState)(),[m,u]=(0,N.useState)(null),x=(0,N.useRef)(null);let f;e[0]!==n?(f=v=>{const{width:_,height:M}=v.currentTarget;d(n?os(ys({unit:"%",width:90},n,_,M),_,M):{unit:"%",width:80,height:80,x:10,y:10})},e[0]=n,e[1]=f):f=e[1];const h=f;let p;e[2]!==m||e[3]!==l||e[4]!==i?(p=async()=>{if(m&&x.current)try{i(await kr(x.current,m)),l()}catch(v){console.error("Error cropping image:",v)}},e[2]=m,e[3]=l,e[4]=i,e[5]=p):p=e[5];const b=p;let g;e[6]!==l?(g=v=>!v&&l(),e[6]=l,e[7]=g):g=e[7];let j;e[8]===Symbol.for("react.memo_cache_sentinel")?(j=(0,s.jsx)(Jt,{className:"p-4 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)(Ut,{children:"Crop Image"})}),e[8]=j):j=e[8];let w,C;e[9]===Symbol.for("react.memo_cache_sentinel")?(w=v=>d(v),C=v=>u(v),e[9]=w,e[10]=C):(w=e[9],C=e[10]);let y;e[11]!==h||e[12]!==a?(y=(0,s.jsx)("img",{ref:x,src:a,alt:"Crop preview",onLoad:h,className:"max-h-[60vh] w-auto block"}),e[11]=h,e[12]=a,e[13]=y):y=e[13];let z;e[14]!==n||e[15]!==c||e[16]!==o||e[17]!==y?(z=(0,s.jsx)("div",{className:"p-6 flex items-center justify-center bg-zinc-100/50 dark:bg-zinc-950/50 min-h-[300px] max-h-[65vh] overflow-auto",children:(0,s.jsx)(is,{crop:o,onChange:w,onComplete:C,aspect:n,circularCrop:c,className:"max-w-full shadow-2xl",children:y})}),e[14]=n,e[15]=c,e[16]=o,e[17]=y,e[18]=z):z=e[18];let P;e[19]!==l?(P=(0,s.jsx)(ne,{variant:"outline",onClick:l,className:"!w-auto px-6",children:"Cancel"}),e[19]=l,e[20]=P):P=e[20];let S;e[21]!==b?(S=(0,s.jsx)(ne,{onClick:b,className:"!w-auto px-6",children:"Apply Crop"}),e[21]=b,e[22]=S):S=e[22];let L;e[23]!==S||e[24]!==P?(L=(0,s.jsxs)(Gt,{className:"p-4 bg-white dark:bg-zinc-900 border-t border-zinc-100 dark:border-zinc-800 flex flex-row justify-end gap-2",children:[P,S]}),e[23]=S,e[24]=P,e[25]=L):L=e[25];let k;e[26]!==L||e[27]!==z?(k=(0,s.jsxs)(Kt,{className:"sm:max-w-2xl bg-white dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800 p-0 overflow-hidden",children:[j,z,L]}),e[26]=L,e[27]=z,e[28]=k):k=e[28];let $;return e[29]!==r||e[30]!==k||e[31]!==g?($=(0,s.jsx)(Ht,{open:r,onOpenChange:g,children:k}),e[29]=r,e[30]=k,e[31]=g,e[32]=$):$=e[32],$},Xe=Yr,el=({isOpen:t,onClose:e})=>{const{currentUser:a}=se(),{addPost:r}=ze(),{addToast:l}=he(),[i,n]=(0,N.useState)(""),[c,o]=(0,N.useState)([]),[d,m]=(0,N.useState)(!1),[u,x]=(0,N.useState)({options:["",""],duration:"1 day"}),[f,h]=(0,N.useState)(!1),[p,b]=(0,N.useState)(null),[g,j]=(0,N.useState)(null),w=(0,N.useRef)(null),C=v=>{const _=Array.from(v.target.files);o(M=>[...M,..._])},y=v=>{o(_=>_.filter((M,F)=>F!==v))},z=v=>{const _=c[v],M=new FileReader;M.onload=()=>{b(M.result),j(v)},M.readAsDataURL(_)},P=v=>{const _=new File([v],`cropped-${Date.now()}.jpg`,{type:"image/jpeg"}),M=[...c];M[g]=_,o(M),b(null),j(null)},S=()=>{u.options.length<4&&x(v=>({...v,options:[...v.options,""]}))},L=v=>{x(_=>({..._,options:_.options.filter((M,F)=>F!==v)}))},k=(v,_)=>{const M=[...u.options];M[v]=_,x(F=>({...F,options:M}))},$=async v=>{if(v.preventDefault(),!(!i.trim()&&c.length===0||!a)){h(!0);try{const _=[];for(const F of c){const B=await _e(F);_.push(B)}let M=null;d&&u.options.some(F=>F.trim())&&(M={options:u.options.filter(F=>F.trim()).map((F,B)=>({id:B+1,text:F,votes:0})),ends_at:new Date(Date.now()+1440*60*1e3).toISOString()}),await r({content:i,media:_,poll:M,type:_.length>0?_[0].type==="video"?"video":"image":M?"poll":"text",userId:a.id}),n(""),o([]),m(!1),x({options:["",""],duration:"1 day"}),e(),l("Post published!")}catch(_){console.error("Failed to create post:",_),l("Failed to publish post.")}finally{h(!1)}}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Ze,{isOpen:t,onClose:()=>!f&&e(),title:"Create Post",className:"sm:max-w-xl",footer:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,s.jsxs)("div",{className:"flex text-violet-600 gap-1",children:[(0,s.jsx)("button",{type:"button",onClick:()=>w.current?.click(),className:"p-2.5 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full transition-colors",title:"Attach media",children:(0,s.jsx)(Ts,{size:22})}),(0,s.jsx)("button",{type:"button",onClick:()=>m(!0),className:"p-2.5 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full transition-colors",title:"Add poll",children:(0,s.jsx)(Js,{size:22})}),(0,s.jsx)("button",{type:"button",className:"p-2.5 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full transition-colors",children:(0,s.jsx)(He,{size:22})}),(0,s.jsx)("input",{type:"file",ref:w,onChange:C,multiple:!0,className:"hidden",accept:"image/*,video/*,application/pdf"})]}),(0,s.jsx)(ne,{onClick:$,disabled:!i.trim()&&c.length===0||f,className:"px-8 py-2.5 min-w-[100px] text-base",children:f?(0,s.jsx)(ae,{size:18,className:"animate-spin"}):"Post"})]}),children:(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)(Y,{className:"size-12 border border-zinc-200 dark:border-zinc-800",children:[(0,s.jsx)(ee,{src:a?.avatar,className:"object-cover"}),(0,s.jsx)(te,{children:a?.handle?.[0]?.toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("textarea",{className:"w-full bg-transparent border-none outline-none text-lg min-h-[120px] resize-none dark:text-white",placeholder:"What's happening?",autoFocus:!0,value:i,onChange:v=>n(v.target.value)}),d&&(0,s.jsxs)("div",{className:"mt-4 p-4 rounded-2xl border border-zinc-100 dark:border-zinc-800 space-y-3 bg-zinc-50/50 dark:bg-zinc-900/50",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsx)("span",{className:"text-sm font-bold opacity-60",children:"Poll"}),(0,s.jsx)("button",{type:"button",onClick:()=>m(!1),className:"text-zinc-500 hover:text-rose-500",children:(0,s.jsx)(ue,{size:18})})]}),u.options.map((v,_)=>(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{className:"flex-1 bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-xl px-4 py-2 text-sm outline-none focus:border-violet-500",placeholder:`Option ${_+1}`,value:v,onChange:M=>k(_,M.target.value)}),u.options.length>2&&(0,s.jsx)("button",{type:"button",onClick:()=>L(_),className:"p-2 text-rose-500 hover:bg-rose-50 dark:hover:bg-rose-900/20 rounded-lg transition-colors",children:(0,s.jsx)(wt,{size:16})})]},_)),u.options.length<4&&(0,s.jsx)("button",{type:"button",onClick:S,className:"text-sm font-bold text-violet-600 hover:bg-violet-50 dark:hover:bg-violet-900/20 px-3 py-1.5 rounded-lg transition-colors",children:"+ Add option"})]}),c.length>0&&(0,s.jsx)("div",{className:"mt-4 flex flex-wrap gap-2",children:c.map((v,_)=>(0,s.jsxs)("div",{className:"relative group size-24 rounded-xl overflow-hidden bg-zinc-100 dark:bg-zinc-800 border dark:border-zinc-700",children:[v.type.startsWith("image/")?(0,s.jsx)("img",{src:URL.createObjectURL(v),className:"size-full object-cover",alt:""}):(0,s.jsx)("div",{className:"size-full flex items-center justify-center text-zinc-500",children:v.type.startsWith("video/")?(0,s.jsx)(Ne,{size:24,className:"animate-pulse"}):(0,s.jsx)(Ct,{size:24})}),(0,s.jsx)("button",{type:"button",onClick:()=>y(_),className:"absolute top-1 right-1 size-6 rounded-full bg-black/60 text-white flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)(ue,{size:14,strokeWidth:3})}),v.type.startsWith("image/")&&(0,s.jsx)("button",{type:"button",onClick:()=>z(_),className:"absolute bottom-1 right-1 size-6 rounded-full bg-black/60 text-white flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",title:"Crop image",children:(0,s.jsx)(xa,{size:14,strokeWidth:3})})]},_))})]})]})})}),p&&(0,s.jsx)(Xe,{src:p,isOpen:!!p,onClose:()=>{b(null),j(null)},onCropComplete:P,aspect:void 0})]})},tl=el,sl=E(),Zt=N.forwardRef((t,e)=>{const a=(0,sl.c)(20);let r,l,i,n,c;a[0]!==t?({className:r,label:l,type:c,textarea:n,...i}=t,a[0]=t,a[1]=r,a[2]=l,a[3]=i,a[4]=n,a[5]=c):(r=a[1],l=a[2],i=a[3],n=a[4],c=a[5]);const o=n?"textarea":"input";let d;a[6]!==l?(d=l&&(0,s.jsx)("label",{className:"text-sm font-bold text-zinc-500 dark:text-zinc-400 ml-1",children:l}),a[6]=l,a[7]=d):d=a[7];const m=n&&"min-h-[100px] resize-none";let u;a[8]!==r||a[9]!==m?(u=J("flex w-full rounded-xl border border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900 px-4 py-2.5 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-zinc-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:ring-offset-zinc-950 dark:text-white transition-all",m,r),a[8]=r,a[9]=m,a[10]=u):u=a[10];let x;a[11]!==o||a[12]!==i||a[13]!==e||a[14]!==u||a[15]!==c?(x=(0,s.jsx)(o,{type:c,className:u,ref:e,...i}),a[11]=o,a[12]=i,a[13]=e,a[14]=u,a[15]=c,a[16]=x):x=a[16];let f;return a[17]!==d||a[18]!==x?(f=(0,s.jsxs)("div",{className:"w-full space-y-1.5",children:[d,x]}),a[17]=d,a[18]=x,a[19]=f):f=a[19],f});Zt.displayName="Input";var fe=Zt,al=({isOpen:t,onClose:e,editProfileData:a,setEditProfileData:r})=>{const{updateProfile:l}=se(),{addToast:i}=he(),[n,c]=(0,N.useState)(!1),[o,d]=(0,N.useState)(null),[m,u]=(0,N.useState)(null),[x,f]=(0,N.useState)(null),[h,p]=(0,N.useState)(null),b=(0,N.useRef)(null),g=(0,N.useRef)(null),j=(y,z)=>{const P=y.target.files[0];if(P){const S=new FileReader;S.onload=()=>{f(S.result),p(z)},S.readAsDataURL(P)}},w=y=>{const z=new File([y],`cropped-${Date.now()}.jpg`,{type:"image/jpeg"});h==="avatar"?d(z):u(z),f(null),p(null)},C=async()=>{c(!0);try{let y=a.avatar,z=a.cover;o&&(y=(await _e(o)).url),m&&(z=(await _e(m)).url),await l({...a,avatar:y,cover:z}),d(null),u(null),e(),i("Profile updated!")}catch(y){console.error("Failed to update profile:",y),i("Failed to update profile.","error")}finally{c(!1)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Ze,{isOpen:t,onClose:()=>!n&&e(),title:"Edit Profile",children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("input",{type:"file",ref:g,className:"hidden",accept:"image/*",onChange:y=>j(y,"cover")}),(0,s.jsx)("input",{type:"file",ref:b,className:"hidden",accept:"image/*",onChange:y=>j(y,"avatar")}),(0,s.jsxs)("div",{className:"relative h-32 bg-zinc-100 dark:bg-zinc-800 rounded-xl overflow-hidden group cursor-pointer",onClick:()=>g.current?.click(),children:[(m||a?.cover)&&(0,s.jsx)("img",{src:m?URL.createObjectURL(m):a.cover,className:"w-full h-full object-cover opacity-60",alt:""}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("div",{className:"bg-black/50 p-2 rounded-full text-white group-hover:scale-110 transition-transform",children:(0,s.jsx)(Ne,{size:20})})})]}),(0,s.jsx)("div",{className:"relative -mt-16 ml-4",children:(0,s.jsxs)("div",{className:"relative size-24 rounded-full border-4 border-white dark:border-black overflow-hidden group cursor-pointer shadow-lg bg-white dark:bg-black",onClick:()=>b.current?.click(),children:[(o||a?.avatar)&&(0,s.jsxs)(Y,{className:"size-full opacity-60 rounded-none",children:[(0,s.jsx)(ee,{src:o?URL.createObjectURL(o):a.avatar,className:"object-cover"}),(0,s.jsx)(te,{children:a?.handle?.[0]?.toUpperCase()})]}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("div",{className:"bg-black/50 p-2 rounded-full text-white group-hover:scale-110 transition-transform",children:(0,s.jsx)(Ne,{size:16})})})]})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(fe,{label:"Name",value:a?.name||"",onChange:y=>r({...a,name:y.target.value})}),(0,s.jsx)(fe,{label:"Bio",textarea:!0,value:a?.bio||"",onChange:y=>r({...a,bio:y.target.value})}),(0,s.jsx)(fe,{label:"Location",value:a?.location||"",onChange:y=>r({...a,location:y.target.value})}),(0,s.jsx)(fe,{label:"Website",value:a?.website||"",onChange:y=>r({...a,website:y.target.value})})]}),(0,s.jsx)(ne,{className:"w-full py-3",disabled:n,onClick:C,children:n?(0,s.jsx)(ae,{size:24,className:"animate-spin text-white mx-auto"}):"Save changes"})]})}),x&&(0,s.jsx)(Xe,{src:x,isOpen:!!x,onClose:()=>{f(null),p(null)},onCropComplete:w,aspect:h==="avatar"?1:h==="cover"?3/1:void 0,circular:h==="avatar"})]})},rl=al,ll=({isOpen:t,onClose:e})=>{const{currentUser:a}=se(),{addToast:r}=he(),l=Ce(),[i,n]=(0,N.useState)(null),[c,o]=(0,N.useState)(!1),[d,m]=(0,N.useState)(null),u=(0,N.useRef)(null),x=b=>{const g=b.target.files[0];g&&n(g)},f=()=>{if(!i)return;const b=new FileReader;b.onload=()=>{m(b.result)},b.readAsDataURL(i)},h=b=>{n(new File([b],`story-cropped-${Date.now()}.jpg`,{type:"image/jpeg"})),m(null)},p=async()=>{if(!(!i||!a)){o(!0);try{const b=await _e(i);await Xa(a.id,b.url,b.type),n(null),e(),r("Story shared!"),l.invalidateQueries(["stories"])}catch(b){console.error("Failed to create story:",b),r("Failed to share story.")}finally{o(!1)}}};return(0,s.jsxs)(Ze,{isOpen:t,onClose:()=>!c&&e(),title:"Add Story",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[i?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"relative aspect-[9/16] w-full max-w-[280px] mx-auto rounded-3xl overflow-hidden shadow-2xl border dark:border-zinc-800",children:[(0,s.jsx)("img",{src:URL.createObjectURL(i),className:"w-full h-full object-cover",alt:"Preview"}),(0,s.jsx)("button",{onClick:()=>n(null),className:"absolute top-4 right-4 p-2 bg-black/50 text-white rounded-full hover:bg-rose-500 transition-colors",title:"Remove",children:(0,s.jsx)(ue,{size:20})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-center gap-4 py-2 border-y border-zinc-100 dark:border-zinc-800 bg-zinc-50/50 dark:bg-zinc-900/50 rounded-2xl",children:[(0,s.jsxs)("button",{onClick:f,className:"flex flex-col items-center gap-1.5 p-3 rounded-xl hover:bg-white dark:hover:bg-zinc-800 transition-all text-zinc-600 dark:text-zinc-400 hover:text-violet-600 dark:hover:text-violet-400 group",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm group-hover:shadow-md transition-all",children:(0,s.jsx)(as,{size:20})}),(0,s.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Crop / Edit"})]}),(0,s.jsxs)("button",{className:"flex flex-col items-center gap-1.5 p-3 rounded-xl opacity-40 cursor-not-allowed text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm",children:(0,s.jsx)("svg",{size:20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:(0,s.jsx)("path",{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 21 3 22l1-4.5L17 3z"})})}),(0,s.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Text"})]}),(0,s.jsxs)("button",{className:"flex flex-col items-center gap-1.5 p-3 rounded-xl opacity-40 cursor-not-allowed text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-white dark:bg-zinc-800 shadow-sm",children:(0,s.jsxs)("svg",{size:20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[(0,s.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,s.jsx)("path",{d:"M8 14s1.5 2 4 2 4-2 4-2"}),(0,s.jsx)("line",{x1:"9",y1:"9",x2:"9.01",y2:"9"}),(0,s.jsx)("line",{x1:"15",y1:"9",x2:"15.01",y2:"9"})]})}),(0,s.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Stickers"})]})]})]}):(0,s.jsxs)("div",{className:"py-10",children:[(0,s.jsxs)("div",{className:"relative w-full group",onClick:()=>u.current?.click(),children:[(0,s.jsx)("div",{className:"relative z-40 cursor-pointer group-hover:translate-x-8 group-hover:shadow-2xl group-hover:-translate-y-8 transition-all duration-500 bg-zinc-900 dark:bg-white flex items-center justify-center h-32 w-32 mx-auto rounded-xl border-4 border-white dark:border-zinc-900",children:(0,s.jsxs)("svg",{className:"h-8 w-8 text-white/60 dark:text-zinc-950/60",strokeLinejoin:"round",strokeLinecap:"round",strokeWidth:"2",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2"}),(0,s.jsx)("path",{d:"M7 9l5 -5l5 5"}),(0,s.jsx)("path",{d:"M12 4l0 12"})]})}),(0,s.jsx)("div",{className:"absolute border-2 opacity-0 group-hover:opacity-80 transition-all duration-300 border-dashed border-violet-500 inset-0 z-30 bg-transparent flex items-center justify-center h-32 w-32 mx-auto rounded-xl"})]}),(0,s.jsxs)("div",{className:"text-center mt-8",children:[(0,s.jsx)("p",{className:"font-bold dark:text-white",children:"Choose a photo"}),(0,s.jsx)("p",{className:"text-sm text-zinc-500",children:"Stories last for 24 hours"})]})]}),(0,s.jsx)("input",{type:"file",ref:u,onChange:x,className:"hidden",accept:"image/*"}),(0,s.jsx)(ne,{className:"w-full py-3 text-lg",disabled:!i||c,onClick:p,children:c?(0,s.jsx)(ae,{size:24,className:"animate-spin mx-auto"}):"Share story"})]}),d&&(0,s.jsx)(Xe,{src:d,isOpen:!!d,onClose:()=>m(null),onCropComplete:h,aspect:9/16})]})},il=ll,nl=E(),ol=t=>{const e=(0,nl.c)(21),{isPostModalOpen:a,setIsPostModalOpen:r,isEditProfileOpen:l,setIsEditProfileOpen:i,isStoryModalOpen:n,setIsStoryModalOpen:c,editProfileData:o,setEditProfileData:d}=t;let m;e[0]!==r?(m=()=>r(!1),e[0]=r,e[1]=m):m=e[1];let u;e[2]!==a||e[3]!==m?(u=(0,s.jsx)(tl,{isOpen:a,onClose:m}),e[2]=a,e[3]=m,e[4]=u):u=e[4];let x;e[5]!==i?(x=()=>i(!1),e[5]=i,e[6]=x):x=e[6];let f;e[7]!==o||e[8]!==l||e[9]!==d||e[10]!==x?(f=(0,s.jsx)(rl,{isOpen:l,onClose:x,editProfileData:o,setEditProfileData:d}),e[7]=o,e[8]=l,e[9]=d,e[10]=x,e[11]=f):f=e[11];let h;e[12]!==c?(h=()=>c(!1),e[12]=c,e[13]=h):h=e[13];let p;e[14]!==n||e[15]!==h?(p=(0,s.jsx)(il,{isOpen:n,onClose:h}),e[14]=n,e[15]=h,e[16]=p):p=e[16];let b;return e[17]!==u||e[18]!==f||e[19]!==p?(b=(0,s.jsxs)(s.Fragment,{children:[u,f,p]}),e[17]=u,e[18]=f,e[19]=p,e[20]=b):b=e[20],b},cl=ol,dl=E(),ml=t=>{const e=(0,dl.c)(38),{story:a,onClose:r}=t,[l,i]=(0,N.useState)(0);let n,c;e[0]!==r?(n=()=>{const L=setInterval(()=>{i(k=>k>=100?(r(),100):k+1)},50);return()=>clearInterval(L)},c=[r],e[0]=r,e[1]=n,e[2]=c):(n=e[1],c=e[2]),(0,N.useEffect)(n,c);const o=`${l}%`;let d;e[3]!==o?(d=(0,s.jsx)("div",{className:"flex gap-1 h-1 w-full bg-white/20 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full bg-white transition-all duration-100",style:{width:o}})}),e[3]=o,e[4]=d):d=e[4];let m;e[5]!==a.user.avatar||e[6]!==a.user.handle?(m=(0,s.jsx)(ee,{src:a.user.avatar,alt:a.user.handle,className:"object-cover"}),e[5]=a.user.avatar,e[6]=a.user.handle,e[7]=m):m=e[7];let u;e[8]!==a.user.handle?.[0]?(u=a.user.handle?.[0]?.toUpperCase(),e[8]=a.user.handle?.[0],e[9]=u):u=e[9];let x;e[10]!==u?(x=(0,s.jsx)(te,{children:u}),e[10]=u,e[11]=x):x=e[11];let f;e[12]!==m||e[13]!==x?(f=(0,s.jsxs)(Y,{className:"size-10 border border-white/20",children:[m,x]}),e[12]=m,e[13]=x,e[14]=f):f=e[14];let h;e[15]!==a.user.handle?(h=(0,s.jsx)("span",{className:"text-white font-bold",children:a.user.handle}),e[15]=a.user.handle,e[16]=h):h=e[16];let p;e[17]!==f||e[18]!==h?(p=(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[f,h]}),e[17]=f,e[18]=h,e[19]=p):p=e[19];let b;e[20]===Symbol.for("react.memo_cache_sentinel")?(b=(0,s.jsx)(ue,{size:24}),e[20]=b):b=e[20];let g;e[21]!==r?(g=(0,s.jsx)("button",{onClick:r,className:"text-white p-2 hover:bg-white/10 rounded-full",children:b}),e[21]=r,e[22]=g):g=e[22];let j;e[23]!==p||e[24]!==g?(j=(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[p,g]}),e[23]=p,e[24]=g,e[25]=j):j=e[25];let w;e[26]!==j||e[27]!==d?(w=(0,s.jsxs)("div",{className:"absolute top-0 left-0 right-0 p-4 z-20 flex flex-col gap-4",children:[d,j]}),e[26]=j,e[27]=d,e[28]=w):w=e[28];let C;e[29]===Symbol.for("react.memo_cache_sentinel")?(C=(0,s.jsx)("button",{className:"absolute left-4 z-10 p-2 bg-black/20 hover:bg-black/40 rounded-full text-white backdrop-blur-md transition-all active:scale-90",children:(0,s.jsx)(jt,{size:32})}),e[29]=C):C=e[29];let y;e[30]!==a.media?(y=(0,s.jsx)("img",{src:a.media,className:"w-full h-full object-contain rounded-2xl shadow-2xl",alt:""}),e[30]=a.media,e[31]=y):y=e[31];let z;e[32]===Symbol.for("react.memo_cache_sentinel")?(z=(0,s.jsx)("button",{className:"absolute right-4 z-10 p-2 bg-black/20 hover:bg-black/40 rounded-full text-white backdrop-blur-md transition-all active:scale-90",children:(0,s.jsx)(kt,{size:32})}),e[32]=z):z=e[32];let P;e[33]!==y?(P=(0,s.jsxs)("div",{className:"w-full h-full max-w-xl relative flex items-center justify-center p-4",children:[C,y,z]}),e[33]=y,e[34]=P):P=e[34];let S;return e[35]!==w||e[36]!==P?(S=(0,s.jsxs)("div",{className:"fixed inset-0 z-[100] bg-black flex flex-col items-center justify-center animate-in fade-in duration-300",children:[w,P]}),e[35]=w,e[36]=P,e[37]=S):S=e[37],S},fl=ml,ul=E(),xl=t=>{const e=(0,ul.c)(48),{images:a,currentIndex:r,onClose:l,onNavigate:i}=t,n=r===void 0?0:r;if(!a||a.length===0)return null;const c=a[n],o=a.length>1;let d;e[0]!==n||e[1]!==i?(d=_=>{_.stopPropagation(),i&&n>0&&i(n-1)},e[0]=n,e[1]=i,e[2]=d):d=e[2];const m=d;let u;e[3]!==n||e[4]!==a.length||e[5]!==i?(u=_=>{_.stopPropagation(),i&&n<a.length-1&&i(n+1)},e[3]=n,e[4]=a.length,e[5]=i,e[6]=u):u=e[6];const x=u;let f;e[7]!==c?(f=_=>{_.stopPropagation();const M=document.createElement("a");M.href=c,M.download=`image-${Date.now()}.jpg`,document.body.appendChild(M),M.click(),document.body.removeChild(M)},e[7]=c,e[8]=f):f=e[8];const h=f,p=o?`${n+1} / ${a.length}`:"";let b;e[9]!==p?(b=(0,s.jsx)("div",{className:"text-white font-medium",children:p}),e[9]=p,e[10]=b):b=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=(0,s.jsx)(St,{size:22}),e[11]=g):g=e[11];let j;e[12]!==h?(j=(0,s.jsx)("button",{onClick:h,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors",title:"Download",children:g}),e[12]=h,e[13]=j):j=e[13];let w;e[14]===Symbol.for("react.memo_cache_sentinel")?(w=(0,s.jsx)(ue,{size:24}),e[14]=w):w=e[14];let C;e[15]!==l?(C=(0,s.jsx)("button",{onClick:l,className:"text-white p-2 hover:bg-white/10 rounded-full transition-colors",title:"Close",children:w}),e[15]=l,e[16]=C):C=e[16];let y;e[17]!==C||e[18]!==j?(y=(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[j,C]}),e[17]=C,e[18]=j,e[19]=y):y=e[19];let z;e[20]!==y||e[21]!==b?(z=(0,s.jsxs)("div",{className:"absolute top-0 left-0 right-0 p-4 z-20 flex items-center justify-between bg-gradient-to-b from-black/50 to-transparent",children:[b,y]}),e[20]=y,e[21]=b,e[22]=z):z=e[22];let P;e[23]!==n||e[24]!==m||e[25]!==o?(P=o&&n>0&&(0,s.jsx)("button",{onClick:m,className:"absolute left-4 z-10 p-3 bg-white/10 hover:bg-white/20 rounded-full text-white backdrop-blur-md transition-all active:scale-90",children:(0,s.jsx)(jt,{size:32})}),e[23]=n,e[24]=m,e[25]=o,e[26]=P):P=e[26];let S;e[27]!==c?(S=(0,s.jsx)("img",{src:c,className:"max-w-full max-h-full object-contain select-none shadow-2xl animate-in zoom-in-95 duration-300",alt:"",onClick:pl}),e[27]=c,e[28]=S):S=e[28];let L;e[29]!==n||e[30]!==x||e[31]!==o||e[32]!==a.length?(L=o&&n<a.length-1&&(0,s.jsx)("button",{onClick:x,className:"absolute right-4 z-10 p-3 bg-white/10 hover:bg-white/20 rounded-full text-white backdrop-blur-md transition-all active:scale-90",children:(0,s.jsx)(kt,{size:32})}),e[29]=n,e[30]=x,e[31]=o,e[32]=a.length,e[33]=L):L=e[33];let k;e[34]!==P||e[35]!==S||e[36]!==L?(k=(0,s.jsxs)("div",{className:"w-full h-full relative flex items-center justify-center p-4",children:[P,S,L]}),e[34]=P,e[35]=S,e[36]=L,e[37]=k):k=e[37];let $;e[38]!==n||e[39]!==o||e[40]!==a||e[41]!==i?($=o&&(0,s.jsx)("div",{className:"absolute bottom-6 flex gap-2 p-2 bg-black/40 backdrop-blur-md rounded-2xl overflow-x-auto max-w-[90%] hide-scrollbar",onClick:bl,children:a.map((_,M)=>(0,s.jsx)("button",{onClick:()=>i(M),className:`size-12 rounded-lg overflow-hidden border-2 transition-all shrink-0 ${M===n?"border-white scale-110":"border-transparent opacity-50 hover:opacity-100"}`,children:(0,s.jsx)("img",{src:_,className:"size-full object-cover",alt:""})},M))}),e[38]=n,e[39]=o,e[40]=a,e[41]=i,e[42]=$):$=e[42];let v;return e[43]!==l||e[44]!==z||e[45]!==k||e[46]!==$?(v=(0,s.jsxs)("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-sm flex flex-col items-center justify-center animate-in fade-in duration-300",onClick:l,children:[z,k,$]}),e[43]=l,e[44]=z,e[45]=k,e[46]=$,e[47]=v):v=e[47],v},hl=xl;function pl(t){return t.stopPropagation()}function bl(t){return t.stopPropagation()}var gl=({type:t,onComplete:e,onSwitch:a})=>{const{login:r,signup:l}=se(),{addToast:i}=he(),[n,c]=(0,N.useState)({name:"",email:"",username:"",password:""}),[o,d]=(0,N.useState)(!1),[m,u]=(0,N.useState)(null),x=async f=>{f.preventDefault(),d(!0),u(null);try{t==="login"?(await r({email:n.email,password:n.password}),i("Welcome back!")):(await l({email:n.email,password:n.password,username:n.username,name:n.name}),i("Account created successfully!")),e()}catch(h){console.error("Auth error:",h),u(h.message||"Authentication failed. Please check your credentials."),i("Authentication failed!")}finally{d(!1)}};return(0,s.jsxs)("div",{className:"max-w-md mx-auto p-8 w-full animate-in fade-in slide-in-from-bottom-5 duration-300",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("div",{className:"flex justify-center mb-4",children:(0,s.jsx)("div",{className:"bg-black dark:bg-white dark:text-black text-white p-3 rounded-2xl shadow-lg",children:(0,s.jsx)("img",{src:"https://archive.systemadminbd.com/wp-content/uploads/2024/06/cropped-20240613_193200-270x270.png",alt:"Logo",className:"w-10 h-10 rounded-xl"})})}),(0,s.jsx)("h2",{className:"text-3xl font-extrabold mb-2 dark:text-white tracking-tight",children:t==="login"?"Welcome back!":"Join Sysm today"}),(0,s.jsx)("p",{className:"text-zinc-500 font-medium",children:"The decentralized social network"})]}),m&&(0,s.jsxs)("div",{className:"mb-6 p-4 bg-rose-50 dark:bg-rose-900/20 border border-rose-100 dark:border-rose-800 rounded-xl flex items-center gap-3 text-rose-600 dark:text-rose-400 text-sm",children:[(0,s.jsx)(fa,{size:18}),(0,s.jsx)("span",{children:m})]}),(0,s.jsxs)("form",{onSubmit:x,className:"space-y-4",children:[(0,s.jsx)(fe,{label:"Email",type:"email",placeholder:"john@example.com",value:n.email,onChange:f=>c({...n,email:f.target.value}),required:!0}),t==="signup"&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(fe,{label:"Name",placeholder:"John Doe",value:n.name,onChange:f=>c({...n,name:f.target.value}),required:!0}),(0,s.jsx)(fe,{label:"Username",placeholder:"johndoe",value:n.username,onChange:f=>c({...n,username:f.target.value}),required:!0})]}),(0,s.jsx)(fe,{label:"Password",type:"password",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",value:n.password,onChange:f=>c({...n,password:f.target.value}),required:!0}),(0,s.jsx)(ne,{type:"submit",className:"w-full justify-center py-3 mt-6 text-lg",disabled:o,children:o?(0,s.jsx)(ae,{size:24,className:"animate-spin"}):t==="login"?"Log in":"Sign up"})]}),(0,s.jsxs)("div",{className:"mt-8 text-center text-sm",children:[(0,s.jsx)("span",{className:"text-zinc-500",children:t==="login"?"Don't have an account?":"Already have an account?"}),(0,s.jsx)("button",{onClick:a,className:"font-bold ml-1 hover:underline dark:text-white",children:t==="login"?"Sign up":"Log in"})]})]})},vl=gl,jl=E(),wl=t=>{const e=(0,jl.c)(2),{children:a}=t;let r;return e[0]!==a?(r=(0,s.jsx)("div",{className:"w-full animate-in fade-in slide-in-from-bottom-2 duration-300 ease-out",children:a}),e[0]=a,e[1]=r):r=e[1],r},ce=wl,yl=E(),Nl=t=>{const e=(0,yl.c)(24),{user:a,onClick:r,isAddStory:l}=t,i=l===void 0?!1:l,n=`relative p-0.5 rounded-full ${i?"bg-transparent":"bg-gradient-to-tr from-yellow-400 via-pink-500 to-violet-600"}`;let c;e[0]!==a.avatar||e[1]!==a.handle?(c=(0,s.jsx)(ee,{src:a.avatar,alt:a.handle,className:"object-cover"}),e[0]=a.avatar,e[1]=a.handle,e[2]=c):c=e[2];let o;e[3]!==a.handle?.[0]?(o=a.handle?.[0]?.toUpperCase(),e[3]=a.handle?.[0],e[4]=o):o=e[4];let d;e[5]!==o?(d=(0,s.jsx)(te,{children:o}),e[5]=o,e[6]=d):d=e[6];let m;e[7]!==c||e[8]!==d?(m=(0,s.jsxs)(Y,{className:"size-14 sm:size-16 border border-zinc-100 dark:border-zinc-800",children:[c,d]}),e[7]=c,e[8]=d,e[9]=m):m=e[9];let u;e[10]!==i?(u=i&&(0,s.jsx)("div",{className:"absolute bottom-0 right-0 bg-violet-600 border-2 border-white dark:border-black rounded-full p-1 text-white shadow-lg",children:(0,s.jsx)(Ne,{size:14,strokeWidth:3})}),e[10]=i,e[11]=u):u=e[11];let x;e[12]!==m||e[13]!==u?(x=(0,s.jsx)("div",{className:"bg-white dark:bg-black rounded-full p-0.5",children:(0,s.jsxs)("div",{className:"relative",children:[m,u]})}),e[12]=m,e[13]=u,e[14]=x):x=e[14];let f;e[15]!==n||e[16]!==x?(f=(0,s.jsx)("div",{className:n,children:x}),e[15]=n,e[16]=x,e[17]=f):f=e[17];const h=i?"Add Story":a.handle;let p;e[18]!==h?(p=(0,s.jsx)("span",{className:"text-[11px] font-semibold text-zinc-600 dark:text-zinc-400 truncate w-16 text-center leading-tight",children:h}),e[18]=h,e[19]=p):p=e[19];let b;return e[20]!==r||e[21]!==p||e[22]!==f?(b=(0,s.jsxs)("button",{onClick:r,className:"flex flex-col items-center gap-2 group shrink-0",children:[f,p]}),e[20]=r,e[21]=p,e[22]=f,e[23]=b):b=e[23],b},lt=Nl,$e=E();function zl(t){const e=(0,$e.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let r;return e[2]!==a?(r=(0,s.jsx)(ws,{"data-slot":"dropdown-menu",...a}),e[2]=a,e[3]=r):r=e[3],r}function kl(t){const e=(0,$e.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let r;return e[2]!==a?(r=(0,s.jsx)(ma,{"data-slot":"dropdown-menu-trigger",...a}),e[2]=a,e[3]=r):r=e[3],r}function _l(t){const e=(0,$e.c)(10);let a,r,l;e[0]!==t?({className:a,sideOffset:l,...r}=t,e[0]=t,e[1]=a,e[2]=r,e[3]=l):(a=e[1],r=e[2],l=e[3]);const i=l===void 0?4:l;let n;e[4]!==a?(n=J("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",a),e[4]=a,e[5]=n):n=e[5];let c;return e[6]!==r||e[7]!==i||e[8]!==n?(c=(0,s.jsx)(ua,{children:(0,s.jsx)(ha,{"data-slot":"dropdown-menu-content",sideOffset:i,className:n,...r})}),e[6]=r,e[7]=i,e[8]=n,e[9]=c):c=e[9],c}function Le(t){const e=(0,$e.c)(12);let a,r,l,i;e[0]!==t?({className:a,inset:r,variant:i,...l}=t,e[0]=t,e[1]=a,e[2]=r,e[3]=l,e[4]=i):(a=e[1],r=e[2],l=e[3],i=e[4]);const n=i===void 0?"default":i;let c;e[5]!==a?(c=J("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),e[5]=a,e[6]=c):c=e[6];let o;return e[7]!==r||e[8]!==l||e[9]!==c||e[10]!==n?(o=(0,s.jsx)(Ls,{"data-slot":"dropdown-menu-item","data-inset":r,"data-variant":n,className:c,...l}),e[7]=r,e[8]=l,e[9]=c,e[10]=n,e[11]=o):o=e[11],o}function Cl(t){const e=(0,$e.c)(8);let a,r;e[0]!==t?({className:a,...r}=t,e[0]=t,e[1]=a,e[2]=r):(a=e[1],r=e[2]);let l;e[3]!==a?(l=J("bg-border -mx-1 my-1 h-px",a),e[3]=a,e[4]=l):l=e[4];let i;return e[5]!==r||e[6]!==l?(i=(0,s.jsx)(ls,{"data-slot":"dropdown-menu-separator",className:l,...r}),e[5]=r,e[6]=l,e[7]=i):i=e[7],i}var oe=E();function it(t){const e=(0,oe.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let r;return e[2]!==a?(r=(0,s.jsx)(Ss,{"data-slot":"alert-dialog",...a}),e[2]=a,e[3]=r):r=e[3],r}function Sl(t){const e=(0,oe.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let r;return e[2]!==a?(r=(0,s.jsx)(qs,{"data-slot":"alert-dialog-portal",...a}),e[2]=a,e[3]=r):r=e[3],r}function $l(t){const e=(0,oe.c)(8);let a,r;e[0]!==t?({className:a,...r}=t,e[0]=t,e[1]=a,e[2]=r):(a=e[1],r=e[2]);let l;e[3]!==a?(l=J("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),e[3]=a,e[4]=l):l=e[4];let i;return e[5]!==r||e[6]!==l?(i=(0,s.jsx)(Ds,{"data-slot":"alert-dialog-overlay",className:l,...r}),e[5]=r,e[6]=l,e[7]=i):i=e[7],i}function nt(t){const e=(0,oe.c)(9);let a,r;e[0]!==t?({className:a,...r}=t,e[0]=t,e[1]=a,e[2]=r):(a=e[1],r=e[2]);let l;e[3]===Symbol.for("react.memo_cache_sentinel")?(l=(0,s.jsx)($l,{}),e[3]=l):l=e[3];let i;e[4]!==a?(i=J("bg-white dark:bg-zinc-950 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-2xl border border-zinc-100 dark:border-zinc-800 p-6 shadow-xl duration-200 sm:max-w-md",a),e[4]=a,e[5]=i):i=e[5];let n;return e[6]!==r||e[7]!==i?(n=(0,s.jsxs)(Sl,{children:[l,(0,s.jsx)(ea,{"data-slot":"alert-dialog-content",className:i,...r})]}),e[6]=r,e[7]=i,e[8]=n):n=e[8],n}function ot(t){const e=(0,oe.c)(8);let a,r;e[0]!==t?({className:a,...r}=t,e[0]=t,e[1]=a,e[2]=r):(a=e[1],r=e[2]);let l;e[3]!==a?(l=J("flex flex-col gap-2 text-center sm:text-left",a),e[3]=a,e[4]=l):l=e[4];let i;return e[5]!==r||e[6]!==l?(i=(0,s.jsx)("div",{"data-slot":"alert-dialog-header",className:l,...r}),e[5]=r,e[6]=l,e[7]=i):i=e[7],i}function ct(t){const e=(0,oe.c)(8);let a,r;e[0]!==t?({className:a,...r}=t,e[0]=t,e[1]=a,e[2]=r):(a=e[1],r=e[2]);let l;e[3]!==a?(l=J("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),e[3]=a,e[4]=l):l=e[4];let i;return e[5]!==r||e[6]!==l?(i=(0,s.jsx)("div",{"data-slot":"alert-dialog-footer",className:l,...r}),e[5]=r,e[6]=l,e[7]=i):i=e[7],i}function dt(t){const e=(0,oe.c)(8);let a,r;e[0]!==t?({className:a,...r}=t,e[0]=t,e[1]=a,e[2]=r):(a=e[1],r=e[2]);let l;e[3]!==a?(l=J("text-lg font-semibold",a),e[3]=a,e[4]=l):l=e[4];let i;return e[5]!==r||e[6]!==l?(i=(0,s.jsx)(ca,{"data-slot":"alert-dialog-title",className:l,...r}),e[5]=r,e[6]=l,e[7]=i):i=e[7],i}function mt(t){const e=(0,oe.c)(8);let a,r;e[0]!==t?({className:a,...r}=t,e[0]=t,e[1]=a,e[2]=r):(a=e[1],r=e[2]);let l;e[3]!==a?(l=J("text-muted-foreground text-sm",a),e[3]=a,e[4]=l):l=e[4];let i;return e[5]!==r||e[6]!==l?(i=(0,s.jsx)(Us,{"data-slot":"alert-dialog-description",className:l,...r}),e[5]=r,e[6]=l,e[7]=i):i=e[7],i}function ft(t){const e=(0,oe.c)(8);let a,r;e[0]!==t?({className:a,...r}=t,e[0]=t,e[1]=a,e[2]=r):(a=e[1],r=e[2]);let l;e[3]!==a?(l=J("inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-bold transition-all active:scale-95 bg-zinc-900 text-white hover:bg-zinc-800 dark:bg-white dark:text-black dark:hover:bg-zinc-200",a),e[3]=a,e[4]=l):l=e[4];let i;return e[5]!==r||e[6]!==l?(i=(0,s.jsx)(Fs,{className:l,...r}),e[5]=r,e[6]=l,e[7]=i):i=e[7],i}function ut(t){const e=(0,oe.c)(8);let a,r;e[0]!==t?({className:a,...r}=t,e[0]=t,e[1]=a,e[2]=r):(a=e[1],r=e[2]);let l;e[3]!==a?(l=J("inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-bold border border-zinc-200 bg-white text-zinc-900 hover:bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-950 dark:text-zinc-50 dark:hover:bg-zinc-900",a),e[3]=a,e[4]=l):l=e[4];let i;return e[5]!==r||e[6]!==l?(i=(0,s.jsx)(Rs,{className:l,...r}),e[5]=r,e[6]=l,e[7]=i):i=e[7],i}var Pl=E(),Ll=()=>{const t=(0,Pl.c)(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,s.jsx)(Hs,{size:16,className:"fill-blue-500 text-white ml-1 inline-block shrink-0"}),t[0]=e):e=t[0],e},Fe=Ll,Ml=E(),Il=t=>{const e=(0,Ml.c)(18),{poll:a,onVote:r}=t,l=a.options.reduce(Fl,0),[i,n]=(0,N.useState)(null);let c;e[0]!==r||e[1]!==i?(c=h=>{i||(n(h),r&&r(h))},e[0]=r,e[1]=i,e[2]=c):c=e[2];const o=c;let d;if(e[3]!==o||e[4]!==a.options||e[5]!==l||e[6]!==i){let h;e[8]!==o||e[9]!==l||e[10]!==i?(h=(p,b)=>{const g=l>0?Math.round((p.votes+(i===p.id?1:0))/(l+(i?1:0))*100):0,j=i===p.id;return(0,s.jsxs)("div",{onClick:w=>{w.stopPropagation(),o(p.id)},className:`relative h-10 w-full rounded-xl overflow-hidden cursor-pointer border ${j?"border-violet-500 dark:border-violet-500":"border-zinc-200 dark:border-zinc-700"}`,children:[i&&(0,s.jsx)("div",{className:"absolute top-0 left-0 h-full bg-zinc-200 dark:bg-zinc-800 transition-all duration-500",style:{width:`${g}%`}}),(0,s.jsxs)("div",{className:"absolute inset-0 flex items-center justify-between px-4 z-10",children:[(0,s.jsxs)("span",{className:`font-medium text-sm ${j?"text-violet-600 font-bold":"text-zinc-700 dark:text-zinc-200"}`,children:[p.text," ",j&&(0,s.jsx)(vt,{size:14,className:"inline ml-1 mb-0.5"})]}),i&&(0,s.jsxs)("span",{className:"text-sm font-bold text-zinc-900 dark:text-white",children:[g,"%"]})]})]},p.id||b)},e[8]=o,e[9]=l,e[10]=i,e[11]=h):h=e[11],d=a.options.map(h),e[3]=o,e[4]=a.options,e[5]=l,e[6]=i,e[7]=d}else d=e[7];const m=l+(i?1:0),u=i?"6 days left":"Click to vote";let x;e[12]!==m||e[13]!==u?(x=(0,s.jsxs)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400 pl-1",children:[m," votes â€¢"," ",u]}),e[12]=m,e[13]=u,e[14]=x):x=e[14];let f;return e[15]!==d||e[16]!==x?(f=(0,s.jsxs)("div",{className:"mt-3 space-y-2",children:[d,x]}),e[15]=d,e[16]=x,e[17]=f):f=e[17],f},xt=Il;function Fl(t,e){return t+e.votes}var Ol=E(),Al=t=>{const e=(0,Ol.c)(23),{user:a,time:r,content:l}=t;let i;e[0]!==a.avatar||e[1]!==a.handle?(i=(0,s.jsx)(ee,{src:a.avatar,alt:a.handle}),e[0]=a.avatar,e[1]=a.handle,e[2]=i):i=e[2];let n;e[3]!==a.handle[0]?(n=a.handle[0]?.toUpperCase(),e[3]=a.handle[0],e[4]=n):n=e[4];let c;e[5]!==n?(c=(0,s.jsx)(te,{children:n}),e[5]=n,e[6]=c):c=e[6];let o;e[7]!==i||e[8]!==c?(o=(0,s.jsxs)(Y,{className:"size-6",children:[i,c]}),e[7]=i,e[8]=c,e[9]=o):o=e[9];let d;e[10]!==a.handle?(d=(0,s.jsx)("span",{className:"font-semibold text-sm",children:a.handle}),e[10]=a.handle,e[11]=d):d=e[11];let m;e[12]!==r?(m=(0,s.jsxs)("span",{className:"text-zinc-500 text-sm",children:["â€¢ ",r]}),e[12]=r,e[13]=m):m=e[13];let u;e[14]!==o||e[15]!==d||e[16]!==m?(u=(0,s.jsxs)("div",{className:"flex items-center gap-x-2 mb-2",children:[o,d,m]}),e[14]=o,e[15]=d,e[16]=m,e[17]=u):u=e[17];let x;e[18]!==l?(x=(0,s.jsx)("p",{className:"text-sm text-zinc-800 dark:text-zinc-300 whitespace-pre-line",children:l}),e[18]=l,e[19]=x):x=e[19];let f;return e[20]!==u||e[21]!==x?(f=(0,s.jsxs)("div",{className:"p-4",children:[u,x]}),e[20]=u,e[21]=x,e[22]=f):f=e[22],f},ht=Al,El=E(),Rl=t=>{const e=(0,El.c)(17),{icon:a,count:r,onClick:l,active:i,activeColorClass:n}=t,c=n===void 0?"text-violet-600":n,o=a;let d;e[0]!==l?(d=j=>{j.stopPropagation(),l&&l(j)},e[0]=l,e[1]=d):d=e[1];const m=`group flex items-center gap-x-2 text-[13px] font-medium transition-all ${i?c:"text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-300"}`,u=`rounded-full p-2 transition-colors ${i?"bg-current/10":"group-hover:bg-zinc-100 dark:group-hover:bg-zinc-800"}`,x=i?2.5:2,f=i?"fill-current":"";let h;e[2]!==o||e[3]!==x||e[4]!==f?(h=(0,s.jsx)(o,{size:18,strokeWidth:x,className:f}),e[2]=o,e[3]=x,e[4]=f,e[5]=h):h=e[5];let p;e[6]!==u||e[7]!==h?(p=(0,s.jsx)("div",{className:u,children:h}),e[6]=u,e[7]=h,e[8]=p):p=e[8];let b;e[9]!==i||e[10]!==r?(b=r!=null&&(0,s.jsx)("span",{className:i?"font-bold":"",children:r||0}),e[9]=i,e[10]=r,e[11]=b):b=e[11];let g;return e[12]!==d||e[13]!==m||e[14]!==p||e[15]!==b?(g=(0,s.jsxs)("button",{onClick:d,className:m,children:[p,b]}),e[12]=d,e[13]=m,e[14]=p,e[15]=b,e[16]=g):g=e[16],g},we=Rl,Tl=E(),ql=t=>{const e=(0,Tl.c)(12),{src:a,poster:r}=t,l=(0,N.useRef)(null);let i,n;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=()=>{const f=new IntersectionObserver(p=>{const[b]=p;l.current?.plyr&&(b.isIntersecting?l.current.plyr.play().catch(()=>{l.current.plyr.muted=!0,l.current.plyr.play()}):l.current.plyr.pause())},{threshold:.6}),h=l.current?.elements?.container;return h&&f.observe(h),()=>{h&&f.unobserve(h)}},n=[],e[0]=i,e[1]=n):(i=e[0],n=e[1]),(0,N.useEffect)(i,n);let c;e[2]!==a?(c=[{src:a,type:"video/mp4"}],e[2]=a,e[3]=c):c=e[3];let o;e[4]!==r||e[5]!==c?(o={type:"video",sources:c,poster:r},e[4]=r,e[5]=c,e[6]=o):o=e[6];let d;e[7]===Symbol.for("react.memo_cache_sentinel")?(d={controls:["play-large","play","progress","current-time","mute","volume","fullscreen"],settings:["quality","speed"],ratio:"16:9",clickToPlay:!0,hideControls:!0,resetOnEnd:!0},e[7]=d):d=e[7];let m;e[8]!==o?(m={source:o,options:d},e[8]=o,e[9]=m):m=e[9];const u=m;let x;return e[10]!==u?(x=(0,s.jsx)("div",{className:"mt-3 overflow-hidden rounded-2xl shadow-sm border border-zinc-100 dark:border-zinc-800 bg-black",onClick:Bl,children:(0,s.jsx)(It,{ref:l,...u})}),e[10]=u,e[11]=x):x=e[11],x},Dl=ql;function Bl(t){return t.stopPropagation()}var Wl=E(),Ql=t=>{const e=(0,Wl.c)(17),{file:a}=t;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsx)("div",{className:"size-10 rounded-xl bg-violet-100 dark:bg-violet-900/30 flex items-center justify-center text-violet-600",children:(0,s.jsx)(Ct,{size:20})}),e[0]=r):r=e[0];let l;e[1]!==a.name?(l=(0,s.jsx)("div",{className:"text-sm font-bold truncate dark:text-white",children:a.name}),e[1]=a.name,e[2]=l):l=e[2];const i=a.size/1024/1024;let n;e[3]!==i?(n=i.toFixed(2),e[3]=i,e[4]=n):n=e[4];let c;e[5]!==n?(c=(0,s.jsxs)("div",{className:"text-xs text-zinc-500 uppercase",children:[n," MB"]}),e[5]=n,e[6]=c):c=e[6];let o;e[7]!==l||e[8]!==c?(o=(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[l,c]}),e[7]=l,e[8]=c,e[9]=o):o=e[9];let d;e[10]===Symbol.for("react.memo_cache_sentinel")?(d=(0,s.jsx)(St,{size:18}),e[10]=d):d=e[10];let m;e[11]!==a.name||e[12]!==a.url?(m=(0,s.jsx)("a",{href:a.url,download:a.name,className:"p-2 text-zinc-400 hover:text-violet-600 transition-colors",onClick:Hl,children:d}),e[11]=a.name,e[12]=a.url,e[13]=m):m=e[13];let u;return e[14]!==o||e[15]!==m?(u=(0,s.jsxs)("div",{className:"mt-3 flex items-center gap-3 p-3 rounded-2xl border border-zinc-100 dark:border-zinc-800 bg-zinc-50/50 dark:bg-zinc-900/10 group hover:border-violet-500/30 transition-colors",children:[r,o,m]}),e[14]=o,e[15]=m,e[16]=u):u=e[16],u},Vl=Ql;function Hl(t){return t.stopPropagation()}var Kl=E(),Jl=t=>{const e=(0,Kl.c)(3),{items:a}=t,r=a===void 0?[]:a,{openLightbox:l}=Je();if(!r||r.length===0)return null;const i=Array.isArray(r)?r:[r],n=i.filter(Ul),c=i.filter(Zl),o=f=>{const h=n.filter(Xl).map(Yl),p=n[f];l(h,h.indexOf(p.url||p.src))},d="mt-3 space-y-2",m=n.length>0&&(0,s.jsx)("div",{className:`grid gap-2 rounded-2xl overflow-hidden border border-zinc-100 dark:border-zinc-800 ${n.length===1?"grid-cols-1":n.length===2?"grid-cols-2 aspect-[16/9]":(n.length===3,"grid-cols-2 grid-rows-2 aspect-[16/9]")}`,children:n.map((f,h)=>(0,s.jsx)("div",{className:`relative overflow-hidden bg-zinc-100 dark:bg-zinc-900 cursor-pointer ${n.length===3&&h===0?"row-span-2":""}`,onClick:p=>{f.type==="image"&&(p.stopPropagation(),o(h))},children:f.type==="video"?(0,s.jsx)(Dl,{src:f.url,poster:f.poster}):(0,s.jsx)("img",{src:f.url||f.src,className:"size-full object-cover hover:scale-[1.02] transition-transform duration-500",alt:"",loading:"lazy"})},h))}),u=c.map(ei);let x;return e[0]!==m||e[1]!==u?(x=(0,s.jsxs)("div",{className:d,children:[m,u]}),e[0]=m,e[1]=u,e[2]=x):x=e[2],x},Gl=Jl;function Ul(t){return t.type==="image"||t.type==="video"}function Zl(t){return t.type==="file"}function Xl(t){return t.type==="image"}function Yl(t){return t.url||t.src}function ei(t,e){return(0,s.jsx)(Vl,{file:t},e)}var ti=E(),si=t=>{const e=(0,ti.c)(6),{currentUser:a,newComment:r,setNewComment:l,handleSubmitComment:i,loading:n}=t;let c;return e[0]!==a||e[1]!==i||e[2]!==n||e[3]!==r||e[4]!==l?(c=a?(0,s.jsx)("div",{className:"p-4 border-y border-zinc-100 dark:border-zinc-800 bg-zinc-50/30 dark:bg-zinc-900/10",children:(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)(Y,{className:"size-9 border border-zinc-200 dark:border-zinc-700",children:[(0,s.jsx)(ee,{src:a.avatar,alt:a.handle,className:"object-cover"}),(0,s.jsx)(te,{children:a.handle?.[0]?.toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("textarea",{id:"comment-input",className:"w-full bg-transparent outline-none text-base min-h-[60px] resize-none dark:text-white placeholder:text-zinc-500",placeholder:"Post your reply...",value:r,onChange:o=>l(o.target.value)}),(0,s.jsxs)("div",{className:"flex justify-between items-center mt-2 pt-3 border-t border-zinc-100 dark:border-zinc-800",children:[(0,s.jsxs)("div",{className:"flex text-violet-600 gap-1",children:[(0,s.jsx)("button",{className:"text-violet-600 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full p-2",children:(0,s.jsx)(Ne,{size:20})}),(0,s.jsx)("button",{className:"text-violet-600 hover:bg-violet-50 dark:hover:bg-zinc-800 rounded-full p-2",children:(0,s.jsx)(He,{size:20})})]}),(0,s.jsx)(ne,{className:"!w-auto px-5 py-1.5 text-sm font-bold min-w-[70px]",onClick:i,disabled:!r.trim()||n,children:n?(0,s.jsx)(ae,{size:16,className:"animate-spin text-white mx-auto"}):"Reply"})]})]})]})}):(0,s.jsx)("div",{className:"p-6 text-center border-y border-zinc-100 dark:border-zinc-800 bg-zinc-50/30 dark:bg-zinc-900/10",children:(0,s.jsx)("p",{className:"text-zinc-500 text-sm",children:"Please login to join the conversation."})}),e[0]=a,e[1]=i,e[2]=n,e[3]=r,e[4]=l,e[5]=c):c=e[5],c},ai=si;const ri=(t,e,a,r)=>{const[l,i]=(0,N.useState)(!1),[n,c]=(0,N.useState)(!1),[o,d]=(0,N.useState)(e||{comments:0,likes:0,mirrors:0});return(0,N.useEffect)(()=>{a&&t&&de(t)&&de(a.id)&&Ka(t,a.id).then(i).catch(()=>i(!1))},[t,a]),{liked:l,reposted:n,localStats:o,setLocalStats:d,handleLike:async x=>{if(x&&x.stopPropagation(),!a)return r("Please login to like!","error");if(!de(t)||!de(a.id)){const f=!l;i(f),d(h=>({...h,likes:f?(h.likes||0)+1:(h.likes||0)-1})),r(f?"Liked":"Unliked");return}try{const f=await Ha(t,a.id);i(f),d(h=>({...h,likes:f?(h.likes||0)+1:(h.likes||0)-1})),r(f?"Liked":"Unliked")}catch(f){console.error("Failed to toggle like:",f),r("Failed to update like state","error")}},handleRepost:x=>{if(x&&x.stopPropagation(),!a)return r("Please login to repost!","error");c(!n),d(f=>({...f,mirrors:n?(f.mirrors||0)-1:(f.mirrors||0)+1})),r(n?"Removed repost":"Reposted")}}};var Xt=({id:t,user:e,timeAgo:a,content:r,contentClass:l,media:i,quotedPost:n,stats:c,onClick:o,repostedBy:d,onUserClick:m,currentUser:u,showToast:x,poll:f,isDetail:h,initialComments:p,onDelete:b})=>{const{liked:g,reposted:j,localStats:w,setLocalStats:C,handleLike:y,handleRepost:z}=ri(t,c,u,x),{deletePost:P}=ze(),[S,L]=(0,N.useState)(p||[]),[k,$]=(0,N.useState)(""),[v,_]=(0,N.useState)(!1),[M,F]=(0,N.useState)(!1),[B,q]=(0,N.useState)(!1),W=async I=>{I&&I.stopPropagation();try{await P(t),x&&x("Post deleted successfully"),b&&b(t)}catch(R){console.error("Failed to delete post:",R),x&&x("Failed to delete post")}finally{q(!1)}},V=(0,N.useCallback)(async()=>{if(t){_(!0);try{L(await Qa(t))}catch(I){console.error("Failed to load comments:",I)}finally{_(!1)}}},[t]);(0,N.useEffect)(()=>{h&&t&&V()},[h,t,V]);const H=async I=>{if(I.preventDefault(),!(!k.trim()||!u)){F(!0);try{await Va(t,u.id,k),$(""),C(R=>({...R,comments:(R.comments||0)+1})),x&&x("Reply posted!"),V()}catch(R){console.error("Failed to post comment:",R),x&&x("Failed to post reply.")}finally{F(!1)}}},O=I=>{I.stopPropagation();const R=`${window.location.origin}/post/${t}`;navigator.clipboard.writeText(R),x&&x("Link copied to clipboard!")},D=({trigger:I})=>(0,s.jsxs)(zl,{children:[(0,s.jsx)(kl,{asChild:!0,onClick:R=>R.stopPropagation(),children:I}),(0,s.jsxs)(_l,{align:"end",className:"w-48 rounded-xl bg-white dark:bg-zinc-900 border-zinc-100 dark:border-zinc-800",children:[(0,s.jsxs)(Le,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5",onClick:O,children:[(0,s.jsx)(Lt,{size:16}),(0,s.jsx)("span",{children:"Copy link to post"})]}),(0,s.jsxs)(Le,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5",onClick:R=>{R.stopPropagation(),x&&x("Post reported")},children:[(0,s.jsx)(Bs,{size:16}),(0,s.jsx)("span",{children:"Report post"})]}),!T&&(0,s.jsxs)(Le,{className:"gap-2 cursor-pointer focus:bg-zinc-50 dark:focus:bg-zinc-800 py-2.5 text-rose-500 focus:text-rose-500",onClick:R=>{R.stopPropagation(),x&&x("User blocked")},children:[(0,s.jsx)(Ns,{size:16}),(0,s.jsxs)("span",{children:["Block @",e.handle]})]}),T&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Cl,{className:"bg-zinc-100 dark:bg-zinc-800"}),(0,s.jsxs)(Le,{className:"gap-2 cursor-pointer focus:bg-rose-50 dark:focus:bg-rose-900/20 py-2.5 text-rose-500 focus:text-rose-500",onClick:R=>{R.stopPropagation(),q(!0)},children:[(0,s.jsx)(wt,{size:16}),(0,s.jsx)("span",{children:"Delete post"})]})]})]})]}),T=u?.handle===e.handle,K=I=>I?N.isValidElement(I)?I:(0,s.jsx)(Gl,{items:I}):null,Q=(I,R)=>typeof I=="string"?(0,s.jsx)("p",{className:`whitespace-pre-line ${R||""}`,children:I}):I;return h?(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("article",{className:"p-5 dark:bg-black",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex items-start gap-x-3",children:[(0,s.jsx)("button",{className:"shrink-0",onClick:()=>m&&m(e.handle),children:(0,s.jsxs)(Y,{className:"size-12 border border-zinc-200 dark:border-zinc-700",children:[(0,s.jsx)(ee,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,s.jsx)(te,{children:e.handle[0]?.toUpperCase()})]})}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("div",{className:"flex flex-wrap items-center gap-x-1",children:(0,s.jsxs)("button",{className:"font-bold hover:underline text-zinc-900 dark:text-white flex items-center gap-1 text-base",onClick:()=>m&&m(e.handle),children:[e.handle,e.verified&&(0,s.jsx)(Fe,{})]})}),(0,s.jsxs)("span",{className:"text-sm text-zinc-500 dark:text-zinc-400",children:["@",e.handle]})]})]}),(0,s.jsx)(D,{trigger:(0,s.jsx)("button",{className:"text-zinc-500 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full p-2 transition-colors",children:(0,s.jsx)(Be,{size:20})})})]}),(0,s.jsx)("div",{className:"break-words text-zinc-900 dark:text-zinc-100 mt-4 text-xl leading-8 whitespace-pre-line",children:Q(r,l)}),K(i),f&&(0,s.jsx)(xt,{poll:f}),n&&(0,s.jsx)("div",{className:"mt-4 border border-zinc-200 dark:border-zinc-700 rounded-2xl overflow-hidden shadow-sm",children:(0,s.jsx)(ht,{...n})}),(0,s.jsx)("div",{className:"my-4 flex items-center text-zinc-500 dark:text-zinc-400 text-sm border-b border-zinc-100 dark:border-zinc-800 pb-4",children:a||"Recent"}),(0,s.jsxs)("div",{className:"border-b border-zinc-100 dark:border-zinc-800 pb-4 flex items-center gap-x-6 text-zinc-500 dark:text-zinc-400 text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,s.jsx)("span",{className:"font-bold text-black dark:text-white",children:w.likes||0})," ",(0,s.jsx)("span",{className:"opacity-70",children:"Likes"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,s.jsx)("span",{className:"font-bold text-black dark:text-white",children:w.comments||0})," ",(0,s.jsx)("span",{className:"opacity-70",children:"Comments"})]})]}),(0,s.jsxs)("div",{className:"mt-4 flex w-full items-center justify-around py-1",children:[(0,s.jsx)(we,{icon:ke,onClick:y,active:g,activeColorClass:"text-rose-500"}),(0,s.jsx)(we,{icon:qe,onClick:z,active:j,activeColorClass:"text-emerald-500"}),(0,s.jsx)(we,{icon:De,onClick:()=>document.getElementById("comment-input")?.focus()})]})]}),(0,s.jsx)(ai,{currentUser:u,newComment:k,setNewComment:$,handleSubmitComment:H,loading:M}),(0,s.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:v?(0,s.jsx)("div",{className:"p-8 flex justify-center",children:(0,s.jsx)(ae,{className:"animate-spin text-violet-500"})}):S.map(I=>(0,s.jsx)(Xt,{...I,onUserClick:m,currentUser:u,showToast:x,onDelete:R=>L(U=>U.filter(X=>X.id!==R))},I.id))}),(0,s.jsx)(it,{open:B,onOpenChange:q,children:(0,s.jsxs)(nt,{onClick:I=>I.stopPropagation(),children:[(0,s.jsxs)(ot,{children:[(0,s.jsx)(dt,{children:"Are you absolutely sure?"}),(0,s.jsx)(mt,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,s.jsxs)(ct,{children:[(0,s.jsx)(ut,{onClick:I=>I.stopPropagation(),children:"Cancel"}),(0,s.jsx)(ft,{onClick:W,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]}):(0,s.jsxs)("article",{onClick:o,className:`px-5 pt-4 pb-3 hover:bg-zinc-50/80 dark:hover:bg-zinc-900/40 transition-colors border-b border-zinc-100 dark:border-zinc-800 last:border-0 ${o?"cursor-pointer":""}`,children:[d&&(0,s.jsxs)("div",{className:"mb-2 flex items-center space-x-1.5 text-[13px] text-zinc-500 font-semibold ml-1",children:[(0,s.jsx)(qe,{size:14,className:"text-zinc-400"}),(0,s.jsx)("span",{className:"hover:underline cursor-pointer flex items-center text-zinc-600 dark:text-zinc-400",onClick:I=>{I.stopPropagation(),m&&m(d.handle)},children:(0,s.jsx)("span",{className:"truncate max-w-[150px]",children:typeof d=="object"?d.name:d})}),(0,s.jsx)("span",{className:"text-zinc-400",children:"reposted"})]}),(0,s.jsxs)("div",{className:"flex items-start gap-x-3",children:[(0,s.jsx)("button",{className:"shrink-0 group",onClick:I=>{I.stopPropagation(),m&&m(e.handle)},children:(0,s.jsxs)(Y,{className:"size-11 border border-zinc-200 dark:border-zinc-700 group-hover:brightness-95 transition-all",children:[(0,s.jsx)(ee,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,s.jsx)(te,{children:e.handle[0]?.toUpperCase()})]})}),(0,s.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,s.jsxs)("div",{className:"flex w-full items-start justify-between",children:[(0,s.jsx)("div",{className:"flex flex-col min-w-0",children:(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-x-1",children:[(0,s.jsxs)("button",{className:"font-bold hover:underline text-zinc-900 dark:text-white flex items-center gap-1 truncate text-[15px]",onClick:I=>{I.stopPropagation(),m&&m(e.handle)},children:[(0,s.jsx)("span",{className:"truncate",children:e.handle}),e.verified&&(0,s.jsx)(Fe,{})]}),(0,s.jsxs)("span",{className:"text-zinc-400 text-sm ml-1 whitespace-nowrap",children:["â€¢ ",a||"Recent"]})]})}),(0,s.jsx)(D,{trigger:(0,s.jsx)("button",{className:"text-zinc-400 hover:bg-zinc-100 hover:text-zinc-700 dark:hover:bg-zinc-800 dark:hover:text-zinc-200 rounded-full p-2 -mr-2 transition-colors",children:(0,s.jsx)(Be,{size:18})})})]}),(0,s.jsxs)("div",{className:"break-words text-zinc-900 dark:text-zinc-100 mt-1 whitespace-pre-line text-[15px] leading-relaxed",children:[Q(r,l),K(i),f&&(0,s.jsx)(xt,{poll:f,onVote:()=>x&&x("Voted!")}),n&&(0,s.jsx)("div",{className:"mt-3 border border-zinc-200 dark:border-zinc-700 rounded-2xl overflow-hidden bg-white dark:bg-zinc-900 hover:bg-zinc-50 dark:hover:bg-zinc-800 transition-colors cursor-pointer",onClick:I=>I.stopPropagation(),children:(0,s.jsx)(ht,{...n})})]}),(0,s.jsx)("div",{className:"mt-3 flex w-full flex-wrap items-center justify-between gap-3 pr-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-6",children:[(0,s.jsx)(we,{icon:ke,count:w.likes,active:g,onClick:y,activeColorClass:"text-rose-500"}),(0,s.jsx)(we,{icon:qe,count:w.mirrors,active:j,onClick:z,activeColorClass:"text-emerald-500"}),(0,s.jsx)(we,{icon:De,count:w.comments,onClick:o})]})})]})]}),(0,s.jsx)(it,{open:B,onOpenChange:q,children:(0,s.jsxs)(nt,{onClick:I=>I.stopPropagation(),children:[(0,s.jsxs)(ot,{children:[(0,s.jsx)(dt,{children:"Are you absolutely sure?"}),(0,s.jsx)(mt,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,s.jsxs)(ct,{children:[(0,s.jsx)(ut,{onClick:I=>I.stopPropagation(),children:"Cancel"}),(0,s.jsx)(ft,{onClick:W,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]})},Ee=Xt,li=E(),ii=()=>{const t=(0,li.c)(3);let e;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,s.jsx)("div",{className:"size-11 rounded-full bg-zinc-200 dark:bg-zinc-800 shrink-0"}),t[0]=e):e=t[0];let a;t[1]===Symbol.for("react.memo_cache_sentinel")?(a=(0,s.jsx)("div",{className:"h-4 bg-zinc-200 dark:bg-zinc-800 rounded w-1/3"}),t[1]=a):a=t[1];let r;return t[2]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsx)("div",{className:"px-5 pt-4 pb-3 border-b border-zinc-100 dark:border-zinc-800 animate-pulse",children:(0,s.jsxs)("div",{className:"flex items-start gap-x-3",children:[e,(0,s.jsxs)("div",{className:"flex-1 space-y-3",children:[a,(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"h-3 bg-zinc-200 dark:bg-zinc-800 rounded w-full"}),(0,s.jsx)("div",{className:"h-3 bg-zinc-200 dark:bg-zinc-800 rounded w-5/6"})]}),(0,s.jsx)("div",{className:"h-48 bg-zinc-200 dark:bg-zinc-800 rounded-xl w-full"})]})]})}),t[2]=r):r=t[2],r},Ye=ii,ni=E(),oi=t=>{const e=(0,ni.c)(35),{onStoryClick:a,onAddStory:r}=t,{currentUser:l}=se(),{posts:i,loading:n}=ze(),{addToast:c}=he(),o=ge();let d;e[0]===Symbol.for("react.memo_cache_sentinel")?(d={queryKey:["stories"],queryFn:Za},e[0]=d):d=e[0];const{data:m,isLoading:u}=xe(d);let x;e[1]!==m?(x=m===void 0?[]:m,e[1]=m,e[2]=x):x=e[2];const f=x;let h;e[3]!==i?(h=i.filter(di),e[3]=i,e[4]=h):h=e[4];const p=h;let b;e[5]!==o?(b=$=>{o(`/post/${$}`)},e[5]=o,e[6]=b):b=e[6];const g=b;let j;e[7]!==o?(j=$=>{o(`/u/${$}`)},e[7]=o,e[8]=j):j=e[8];const w=j;if(n||u){let $;return e[9]===Symbol.for("react.memo_cache_sentinel")?($=(0,s.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:[(0,s.jsxs)("div",{className:"flex gap-3 overflow-x-auto no-scrollbar py-4 px-4 bg-white dark:bg-black border-b border-zinc-100 dark:border-zinc-800",children:[(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"}),(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"}),(0,s.jsx)("div",{className:"size-16 rounded-full bg-zinc-100 dark:bg-zinc-900 animate-pulse shrink-0"})]}),[1,2,3].map(mi)]}),e[9]=$):$=e[9],$}let C;e[10]!==l||e[11]!==r?(C=l&&(0,s.jsx)(lt,{user:l,isAddStory:!0,onClick:r}),e[10]=l,e[11]=r,e[12]=C):C=e[12];let y;if(e[13]!==a||e[14]!==f){let $;e[16]!==a?($=v=>(0,s.jsx)(lt,{user:v.user,onClick:()=>a(v)},v.id),e[16]=a,e[17]=$):$=e[17],y=f.map($),e[13]=a,e[14]=f,e[15]=y}else y=e[15];let z;e[18]!==C||e[19]!==y?(z=(0,s.jsxs)("div",{className:"flex gap-4 overflow-x-auto no-scrollbar py-4 px-4 bg-white dark:bg-black border-b border-zinc-100 dark:border-zinc-800",children:[C,y]}),e[18]=C,e[19]=y,e[20]=z):z=e[20];let P;e[21]!==l?(P=!l&&(0,s.jsx)("div",{className:"px-4 py-2 md:hidden",children:(0,s.jsx)(Vt,{className:"p-6"})}),e[21]=l,e[22]=P):P=e[22];let S;e[23]!==c||e[24]!==l||e[25]!==g||e[26]!==w||e[27]!==p?(S=p.length>0?p.map($=>(0,s.jsx)(Ee,{...$,currentUser:l,showToast:c,onClick:()=>g($.id),onUserClick:w},$.id)):(0,s.jsxs)("div",{className:"p-20 text-center text-zinc-500",children:[(0,s.jsx)("p",{className:"text-lg font-medium",children:"No posts yet."}),(0,s.jsx)("p",{className:"text-sm",children:"Be the first to share something amazing!"})]}),e[23]=c,e[24]=l,e[25]=g,e[26]=w,e[27]=p,e[28]=S):S=e[28];let L;e[29]!==S?(L=(0,s.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm",children:S}),e[29]=S,e[30]=L):L=e[30];let k;return e[31]!==P||e[32]!==L||e[33]!==z?(k=(0,s.jsxs)("div",{children:[z,P,L]}),e[31]=P,e[32]=L,e[33]=z,e[34]=k):k=e[34],k},ci=oi;function di(t){return!t.parent_id}function mi(t){return(0,s.jsx)(Ye,{},t)}var fi=E(),ui=t=>{const e=(0,fi.c)(53),{profile:a,onUserClick:r,isCommunity:l}=t,i=l===void 0?!1:l,{onlineUsers:n}=Tt();let c;e[0]!==n||e[1]!==a.id?(c=n.has(a.id),e[0]=n,e[1]=a.id,e[2]=c):c=e[2];const o=c;let d;e[3]!==r||e[4]!==a.handle?(d=()=>r(a.handle),e[3]=r,e[4]=a.handle,e[5]=d):d=e[5];const m=`size-12 border border-zinc-200 dark:border-zinc-800 shadow-sm ${i?"rounded-2xl":""}`;let u;e[6]!==a.avatar||e[7]!==a.handle?(u=(0,s.jsx)(ee,{src:a.avatar,alt:a.handle,className:"object-cover"}),e[6]=a.avatar,e[7]=a.handle,e[8]=u):u=e[8];const x=i?"rounded-2xl":"";let f;e[9]!==a.handle?.[0]?(f=a.handle?.[0]?.toUpperCase(),e[9]=a.handle?.[0],e[10]=f):f=e[10];let h;e[11]!==x||e[12]!==f?(h=(0,s.jsx)(te,{className:x,children:f}),e[11]=x,e[12]=f,e[13]=h):h=e[13];let p;e[14]!==m||e[15]!==u||e[16]!==h?(p=(0,s.jsxs)(Y,{className:m,children:[u,h]}),e[14]=m,e[15]=u,e[16]=h,e[17]=p):p=e[17];let b;e[18]!==i||e[19]!==o?(b=o&&!i&&(0,s.jsx)("span",{className:"absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full shadow-sm"}),e[18]=i,e[19]=o,e[20]=b):b=e[20];let g;e[21]!==b||e[22]!==p?(g=(0,s.jsxs)("div",{className:"relative",children:[p,b]}),e[21]=b,e[22]=p,e[23]=g):g=e[23];let j;e[24]!==a.name?(j=(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white group-hover:underline leading-none",children:a.name}),e[24]=a.name,e[25]=j):j=e[25];let w;e[26]!==a.verified?(w=a.verified&&(0,s.jsx)(Fe,{}),e[26]=a.verified,e[27]=w):w=e[27];let C;e[28]!==j||e[29]!==w?(C=(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[j,w]}),e[28]=j,e[29]=w,e[30]=C):C=e[30];let y;e[31]!==a.handle?(y=(0,s.jsxs)("span",{className:"text-sm text-zinc-500 mt-0.5",children:["@",a.handle]}),e[31]=a.handle,e[32]=y):y=e[32];let z;e[33]!==i||e[34]!==a.members?(z=i&&a.members&&(0,s.jsxs)("span",{className:"text-xs text-zinc-400 mt-1",children:[a.members," members"]}),e[33]=i,e[34]=a.members,e[35]=z):z=e[35];let P;e[36]!==i||e[37]!==a.followers?(P=!i&&a.followers&&(0,s.jsxs)("span",{className:"text-xs text-zinc-400 mt-1",children:[a.followers," followers"]}),e[36]=i,e[37]=a.followers,e[38]=P):P=e[38];let S;e[39]!==C||e[40]!==y||e[41]!==z||e[42]!==P?(S=(0,s.jsxs)("div",{className:"flex flex-col",children:[C,y,z,P]}),e[39]=C,e[40]=y,e[41]=z,e[42]=P,e[43]=S):S=e[43];let L;e[44]!==g||e[45]!==S?(L=(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[g,S]}),e[44]=g,e[45]=S,e[46]=L):L=e[46];const k=i?"Join":"Follow";let $;e[47]!==k?($=(0,s.jsx)(ne,{variant:"outline",className:"!w-auto !py-1.5 !px-4 text-sm font-bold rounded-full border-zinc-200 dark:border-zinc-700 hover:bg-zinc-100 dark:hover:bg-zinc-800",onClick:xi,children:k}),e[47]=k,e[48]=$):$=e[48];let v;return e[49]!==L||e[50]!==$||e[51]!==d?(v=(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-zinc-100 dark:border-zinc-800 hover:bg-zinc-50 dark:hover:bg-zinc-900/40 transition-colors group cursor-pointer",onClick:d,children:[L,$]}),e[49]=L,e[50]=$,e[51]=d,e[52]=v):v=e[52],v},pt=ui;function xi(t){t.stopPropagation()}var Re=E();function Yt(t){const e=(0,Re.c)(8);let a,r;e[0]!==t?({className:a,...r}=t,e[0]=t,e[1]=a,e[2]=r):(a=e[1],r=e[2]);let l;e[3]!==a?(l=J("flex flex-col gap-2",a),e[3]=a,e[4]=l):l=e[4];let i;return e[5]!==r||e[6]!==l?(i=(0,s.jsx)(Ms,{"data-slot":"tabs",className:l,...r}),e[5]=r,e[6]=l,e[7]=i):i=e[7],i}function es(t){const e=(0,Re.c)(8);let a,r;e[0]!==t?({className:a,...r}=t,e[0]=t,e[1]=a,e[2]=r):(a=e[1],r=e[2]);let l;e[3]!==a?(l=J("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",a),e[3]=a,e[4]=l):l=e[4];let i;return e[5]!==r||e[6]!==l?(i=(0,s.jsx)(la,{"data-slot":"tabs-list",className:l,...r}),e[5]=r,e[6]=l,e[7]=i):i=e[7],i}function ts(t){const e=(0,Re.c)(8);let a,r;e[0]!==t?({className:a,...r}=t,e[0]=t,e[1]=a,e[2]=r):(a=e[1],r=e[2]);let l;e[3]!==a?(l=J("inline-flex items-center justify-center gap-1.5 px-2 py-1 text-sm font-medium whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 outline-none focus:outline-none focus-visible:outline-none ring-0 focus:ring-0 focus-visible:ring-0 shadow-none data-[state=active]:shadow-none",a),e[3]=a,e[4]=l):l=e[4];let i;return e[5]!==r||e[6]!==l?(i=(0,s.jsx)(Gs,{"data-slot":"tabs-trigger",className:l,...r}),e[5]=r,e[6]=l,e[7]=i):i=e[7],i}function ye(t){const e=(0,Re.c)(8);let a,r;e[0]!==t?({className:a,...r}=t,e[0]=t,e[1]=a,e[2]=r):(a=e[1],r=e[2]);let l;e[3]!==a?(l=J("flex-1 outline-none",a),e[3]=a,e[4]=l):l=e[4];let i;return e[5]!==r||e[6]!==l?(i=(0,s.jsx)(Ys,{"data-slot":"tabs-content",className:l,...r}),e[5]=r,e[6]=l,e[7]=i):i=e[7],i}var hi=E(),pi=()=>{const t=(0,hi.c)(50),{currentUser:e}=se(),{posts:a,loading:r}=ze(),{addToast:l}=he(),i=ge(),[n,c]=(0,N.useState)("users"),[o,d]=(0,N.useState)("");let m;t[0]===Symbol.for("react.memo_cache_sentinel")?(m={queryKey:["profiles"],queryFn:Ia},t[0]=m):m=t[0];const{data:u,isLoading:x}=xe(m);let f;t[1]!==u?(f=u===void 0?{}:u,t[1]=u,t[2]=f):f=t[2];const h=f;let p;t[3]!==h||t[4]!==o?(p=Object.values(h).filter(gi),o&&(p=p.filter(O=>O.name?.toLowerCase().includes(o.toLowerCase())||O.handle?.toLowerCase().includes(o.toLowerCase()))),t[3]=h,t[4]=o,t[5]=p):p=t[5];const b=p;let g;t[6]!==h||t[7]!==o?(g=Object.values(h).filter(vi),o&&(g=g.filter(O=>O.name?.toLowerCase().includes(o.toLowerCase())||O.handle?.toLowerCase().includes(o.toLowerCase()))),t[6]=h,t[7]=o,t[8]=g):g=t[8];const j=g;let w;if(t[9]!==a||t[10]!==o){if(w=a.filter(ji),o){let O;t[12]!==o?(O=D=>D.content?.toLowerCase().includes(o.toLowerCase()),t[12]=o,t[13]=O):O=t[13],w=w.filter(O)}t[9]=a,t[10]=o,t[11]=w}else w=t[11];const C=w;let y;t[14]!==i?(y=O=>{i(`/post/${O}`)},t[14]=i,t[15]=y):y=t[15];const z=y;let P;t[16]!==i?(P=O=>{i(`/u/${O}`)},t[16]=i,t[17]=P):P=t[17];const S=P;if(r||x){let O;return t[18]===Symbol.for("react.memo_cache_sentinel")?(O=(0,s.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:[1,2,3].map(wi)}),t[18]=O):O=t[18],O}let L;t[19]===Symbol.for("react.memo_cache_sentinel")?(L=()=>d(""),t[19]=L):L=t[19];const k=`Search ${n}...`;let $;t[20]!==o||t[21]!==k?($=(0,s.jsx)("div",{className:"p-4",children:(0,s.jsx)(Ie,{value:o,onChange:d,onClear:L,placeholder:k})}),t[20]=o,t[21]=k,t[22]=$):$=t[22];let v;t[23]===Symbol.for("react.memo_cache_sentinel")?(v=(0,s.jsx)(es,{className:"w-full h-auto bg-transparent p-0 rounded-none justify-around px-5",children:["users","communities","reels"].map(yi)}),t[23]=v):v=t[23];let _;t[24]!==$?(_=(0,s.jsxs)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-10 border-b border-zinc-100 dark:border-zinc-800",children:[$,v]}),t[24]=$,t[25]=_):_=t[25];let M;t[26]!==S||t[27]!==b?(M=b.length>0?b.map(O=>(0,s.jsx)(pt,{profile:O,onUserClick:S},O.handle)):(0,s.jsx)("div",{className:"p-20 text-center text-zinc-500",children:(0,s.jsx)("p",{className:"font-bold",children:"No users found"})}),t[26]=S,t[27]=b,t[28]=M):M=t[28];let F;t[29]!==M?(F=(0,s.jsx)(ye,{value:"users",className:"m-0 border-none",children:(0,s.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:M})}),t[29]=M,t[30]=F):F=t[30];let B;t[31]!==j||t[32]!==S?(B=j.length>0?j.map(O=>(0,s.jsx)(pt,{profile:O,onUserClick:S,isCommunity:!0},O.handle)):(0,s.jsx)("div",{className:"p-20 text-center text-zinc-500",children:(0,s.jsx)("p",{className:"font-bold",children:"No communities found"})}),t[31]=j,t[32]=S,t[33]=B):B=t[33];let q;t[34]!==B?(q=(0,s.jsx)(ye,{value:"communities",className:"m-0 border-none",children:(0,s.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:B})}),t[34]=B,t[35]=q):q=t[35];let W;t[36]!==l||t[37]!==e||t[38]!==z||t[39]!==S||t[40]!==C?(W=C.length>0?C.map(O=>(0,s.jsx)(Ee,{...O,currentUser:e,showToast:l,onClick:()=>z(O.id),onUserClick:S},O.id)):(0,s.jsx)("div",{className:"p-20 text-center text-zinc-500",children:(0,s.jsx)("p",{className:"font-bold",children:"No reels found"})}),t[36]=l,t[37]=e,t[38]=z,t[39]=S,t[40]=C,t[41]=W):W=t[41];let V;t[42]!==W?(V=(0,s.jsx)(ye,{value:"reels",className:"m-0 border-none",children:(0,s.jsx)("div",{children:W})}),t[42]=W,t[43]=V):V=t[43];let H;return t[44]!==n||t[45]!==F||t[46]!==q||t[47]!==V||t[48]!==_?(H=(0,s.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm",children:(0,s.jsxs)(Yt,{value:n,onValueChange:c,className:"w-full",children:[_,F,q,V]})}),t[44]=n,t[45]=F,t[46]=q,t[47]=V,t[48]=_,t[49]=H):H=t[49],H},bi=pi;function gi(t){return t.type!=="community"}function vi(t){return t.type==="community"}function ji(t){return t.type==="video"}function wi(t){return(0,s.jsx)(Ye,{},t)}function yi(t){return(0,s.jsx)(ts,{value:t,className:"relative py-4 px-2 text-sm font-semibold transition-all border-b-2 rounded-none whitespace-nowrap flex-1 text-center capitalize data-[state=active]:border-black dark:data-[state=active]:border-white data-[state=active]:text-black dark:data-[state=active]:text-white text-zinc-500 hover:text-zinc-800 dark:hover:text-zinc-300",children:t},t)}var Ni=E(),zi=t=>{const e=(0,Ni.c)(56),{reel:a}=t,r=(0,N.useRef)(null),[l,i]=(0,N.useState)(!1),n=(0,N.useRef)(0),c=Array.isArray(a.media)?a.media[0]?.src||a.media[0]?.url:a.media?.src||a.media?.url||a.url;let o,d;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=()=>{const X=new IntersectionObserver(Z=>{const[me]=Z;r.current?.plyr&&(me.isIntersecting?r.current.plyr.play().catch(()=>{r.current.plyr.muted=!0,r.current.plyr.play()}):r.current.plyr.pause())},{threshold:.8}),re=r.current?.elements?.container;return re&&X.observe(re),()=>{re&&X.unobserve(re)}},d=[],e[0]=o,e[1]=d):(o=e[0],d=e[1]),(0,N.useEffect)(o,d);let m;e[2]===Symbol.for("react.memo_cache_sentinel")?(m=()=>{const X=Date.now();X-n.current<300&&(i(!0),setTimeout(()=>i(!1),800)),n.current=X},e[2]=m):m=e[2];const u=m;let x;e[3]!==c?(x={type:"video",sources:[{src:c,type:"video/mp4"}]},e[3]=c,e[4]=x):x=e[4];let f;e[5]===Symbol.for("react.memo_cache_sentinel")?(f={controls:[],loop:{active:!0},clickToPlay:!0,ratio:"9:16"},e[5]=f):f=e[5];let h;e[6]!==x?(h={source:x,options:f},e[6]=x,e[7]=h):h=e[7];const p=h;let b;e[8]!==p?(b=(0,s.jsx)("div",{className:"w-full h-full max-w-[450px]",children:(0,s.jsx)(It,{ref:r,...p})}),e[8]=p,e[9]=b):b=e[9];let g;e[10]!==l?(g=l&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-50 animate-in zoom-in-50 fade-in duration-300",children:(0,s.jsx)(ke,{size:100,fill:"white",className:"text-white drop-shadow-2xl scale-125"})}),e[10]=l,e[11]=g):g=e[11];let j;e[12]===Symbol.for("react.memo_cache_sentinel")?(j=(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-black/60 pointer-events-none"}),e[12]=j):j=e[12];const w=a.user?.avatar,C=a.user?.handle;let y;e[13]!==w||e[14]!==C?(y=(0,s.jsx)(ee,{src:w,alt:C,className:"object-cover"}),e[13]=w,e[14]=C,e[15]=y):y=e[15];let z;e[16]!==a.user?.handle?.[0]?(z=a.user?.handle?.[0]?.toUpperCase(),e[16]=a.user?.handle?.[0],e[17]=z):z=e[17];let P;e[18]!==z?(P=(0,s.jsx)(te,{children:z}),e[18]=z,e[19]=P):P=e[19];let S;e[20]!==y||e[21]!==P?(S=(0,s.jsxs)(Y,{className:"size-10 border-2 border-white",children:[y,P]}),e[20]=y,e[21]=P,e[22]=S):S=e[22];const L=a.user?.handle;let k;e[23]!==L?(k=(0,s.jsxs)("span",{className:"font-bold",children:["@",L]}),e[23]=L,e[24]=k):k=e[24];let $;e[25]===Symbol.for("react.memo_cache_sentinel")?($=(0,s.jsx)("button",{className:"bg-white text-black text-xs font-bold px-3 py-1 rounded-full ml-2 hover:scale-105 active:scale-95 transition-all",children:"Follow"}),e[25]=$):$=e[25];let v;e[26]!==S||e[27]!==k?(v=(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3 pointer-events-auto",children:[S,k,$]}),e[26]=S,e[27]=k,e[28]=v):v=e[28];let _;e[29]!==a.content?(_=(0,s.jsx)("p",{className:"text-sm mb-3 line-clamp-2",children:a.content}),e[29]=a.content,e[30]=_):_=e[30];let M;e[31]===Symbol.for("react.memo_cache_sentinel")?(M=(0,s.jsx)(Xs,{size:14,className:"animate-spin-slow"}),e[31]=M):M=e[31];const F=a.user?.handle;let B;e[32]!==F?(B=(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs opacity-90",children:[M,(0,s.jsxs)("span",{children:["Original Audio - ",F]})]}),e[32]=F,e[33]=B):B=e[33];let q;e[34]!==v||e[35]!==_||e[36]!==B?(q=(0,s.jsxs)("div",{className:"absolute bottom-20 left-4 right-16 text-white pointer-events-none",children:[v,_,B]}),e[34]=v,e[35]=_,e[36]=B,e[37]=q):q=e[37];let W;e[38]===Symbol.for("react.memo_cache_sentinel")?(W=(0,s.jsx)("button",{className:"p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90",children:(0,s.jsx)(ke,{size:28})}),e[38]=W):W=e[38];const V=a.stats?.likes||0;let H;e[39]!==V?(H=(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[W,(0,s.jsx)("span",{className:"text-white text-xs font-bold",children:V})]}),e[39]=V,e[40]=H):H=e[40];let O;e[41]===Symbol.for("react.memo_cache_sentinel")?(O=(0,s.jsx)("button",{className:"p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90",children:(0,s.jsx)(De,{size:28})}),e[41]=O):O=e[41];const D=a.stats?.comments||0;let T;e[42]!==D?(T=(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[O,(0,s.jsx)("span",{className:"text-white text-xs font-bold",children:D})]}),e[42]=D,e[43]=T):T=e[43];let K;e[44]===Symbol.for("react.memo_cache_sentinel")?(K=(0,s.jsx)("button",{className:"p-3 bg-zinc-800/50 rounded-full text-white backdrop-blur-md hover:bg-zinc-700 transition-colors active:scale-90",children:(0,s.jsx)(ms,{size:28})}),e[44]=K):K=e[44];const Q=a.stats?.shares||0;let I;e[45]!==Q?(I=(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[K,(0,s.jsx)("span",{className:"text-white text-xs font-bold",children:Q})]}),e[45]=Q,e[46]=I):I=e[46];let R;e[47]!==H||e[48]!==T||e[49]!==I?(R=(0,s.jsxs)("div",{className:"absolute bottom-20 right-2 flex flex-col items-center gap-6 z-10",children:[H,T,I]}),e[47]=H,e[48]=T,e[49]=I,e[50]=R):R=e[50];let U;return e[51]!==q||e[52]!==R||e[53]!==b||e[54]!==g?(U=(0,s.jsxs)("div",{className:"relative h-screen w-full bg-black snap-start flex items-center justify-center overflow-hidden",onClick:u,children:[b,g,j,q,R]}),e[51]=q,e[52]=R,e[53]=b,e[54]=g,e[55]=U):U=e[55],U},ki=zi,_i=E(),Ci=()=>{const t=(0,_i.c)(10),{posts:e,loading:a}=ze();let r,l,i;if(t[0]!==a||t[1]!==e){i=Symbol.for("react.early_return_sentinel");e:{const c=e.filter($i);if(a){let o;t[5]===Symbol.for("react.memo_cache_sentinel")?(o=(0,s.jsx)("div",{className:"h-screen w-full flex items-center justify-center bg-black",children:(0,s.jsx)(ae,{size:40,className:"animate-spin text-white"})}),t[5]=o):o=t[5],i=o;break e}if(c.length===0){let o;t[6]===Symbol.for("react.memo_cache_sentinel")?(o=(0,s.jsx)("div",{className:"h-screen w-full flex flex-col items-center justify-center bg-black text-white gap-4",children:(0,s.jsx)("p",{className:"text-zinc-500",children:"No reels found."})}),t[6]=o):o=t[6],i=o;break e}r="h-screen w-full snap-y snap-mandatory overflow-y-auto no-scrollbar bg-black md:rounded-xl",l=c.map(Pi)}t[0]=a,t[1]=e,t[2]=r,t[3]=l,t[4]=i}else r=t[2],l=t[3],i=t[4];if(i!==Symbol.for("react.early_return_sentinel"))return i;let n;return t[7]!==r||t[8]!==l?(n=(0,s.jsx)("div",{className:r,children:l}),t[7]=r,t[8]=l,t[9]=n):n=t[9],n},Si=Ci;function $i(t){return t.type==="video"||t.category==="video"}function Pi(t){return(0,s.jsx)(ki,{reel:t},t.id)}var Li=E();const ss=t=>{const e=(0,Li.c)(5);let a;e[0]!==t?(a=()=>Me(t),e[0]=t,e[1]=a):a=e[1];const[r,l]=(0,N.useState)(a);let i,n;return e[2]!==t?(i=()=>{if(!t)return;const c=setTimeout(()=>{l(Me(t))},0),o=setInterval(()=>{l(Me(t))},6e4);return()=>{clearTimeout(c),clearInterval(o)}},n=[t],e[2]=t,e[3]=i,e[4]=n):(i=e[3],n=e[4]),(0,N.useEffect)(i,n),r};var Mi=E(),Ii=t=>{const e=(0,Mi.c)(50),{conv:a,selectedId:r,onSelect:l,onlineUsers:i}=t,n=ss(a.user?.lastSeen);let c;e[0]!==a.user?.id||e[1]!==i?(c=i.has(a.user?.id),e[0]=a.user?.id,e[1]=i,e[2]=c):c=e[2];const o=c;let d;e[3]!==a||e[4]!==l?(d=()=>l(a),e[3]=a,e[4]=l,e[5]=d):d=e[5];const m=`flex items-center gap-3 p-4 cursor-pointer transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900 ${r===a.id?"bg-zinc-50 dark:bg-zinc-900 border-r-2 border-violet-500":""}`,u=a.user?.avatar,x=a.user?.name;let f;e[6]!==u||e[7]!==x?(f=(0,s.jsx)(ee,{src:u,alt:x,className:"object-cover"}),e[6]=u,e[7]=x,e[8]=f):f=e[8];let h;e[9]!==a.user?.name?.[0]?(h=a.user?.name?.[0]?.toUpperCase(),e[9]=a.user?.name?.[0],e[10]=h):h=e[10];let p;e[11]!==h?(p=(0,s.jsx)(te,{children:h}),e[11]=h,e[12]=p):p=e[12];let b;e[13]!==f||e[14]!==p?(b=(0,s.jsxs)(Y,{className:"size-12",children:[f,p]}),e[13]=f,e[14]=p,e[15]=b):b=e[15];let g;e[16]!==o?(g=o&&(0,s.jsx)("span",{className:"absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full"}),e[16]=o,e[17]=g):g=e[17];let j;e[18]!==g||e[19]!==b?(j=(0,s.jsxs)("div",{className:"relative",children:[b,g]}),e[18]=g,e[19]=b,e[20]=j):j=e[20];const w=a.user?.name;let C;e[21]!==w?(C=(0,s.jsx)("span",{className:"font-bold dark:text-white truncate",children:w}),e[21]=w,e[22]=C):C=e[22];let y;e[23]!==a.user?.lastSeen||e[24]!==o||e[25]!==n?(y=o?(0,s.jsx)("span",{className:"text-[10px] text-emerald-500 font-medium leading-none mb-1",children:"Online"}):a.user?.lastSeen&&(0,s.jsx)("span",{className:"text-[10px] text-zinc-500 font-medium leading-none mb-1",children:n}),e[23]=a.user?.lastSeen,e[24]=o,e[25]=n,e[26]=y):y=e[26];let z;e[27]!==C||e[28]!==y?(z=(0,s.jsxs)("div",{className:"flex flex-col min-w-0",children:[C,y]}),e[27]=C,e[28]=y,e[29]=z):z=e[29];let P;e[30]!==a.time?(P=(0,s.jsx)("span",{className:"text-xs text-zinc-500 whitespace-nowrap ml-2",children:a.time}),e[30]=a.time,e[31]=P):P=e[31];let S;e[32]!==z||e[33]!==P?(S=(0,s.jsxs)("div",{className:"flex justify-between items-center mb-0.5",children:[z,P]}),e[32]=z,e[33]=P,e[34]=S):S=e[34];let L;e[35]!==a.lastMessage?(L=(0,s.jsx)("p",{className:"text-zinc-500 text-sm truncate pr-2",children:a.lastMessage}),e[35]=a.lastMessage,e[36]=L):L=e[36];let k;e[37]!==a.unread?(k=a.unread>0&&(0,s.jsx)("span",{className:"bg-violet-600 text-white text-[10px] font-bold size-5 rounded-full flex items-center justify-center shrink-0",children:a.unread}),e[37]=a.unread,e[38]=k):k=e[38];let $;e[39]!==L||e[40]!==k?($=(0,s.jsxs)("div",{className:"flex-1 flex justify-between items-center",children:[L,k]}),e[39]=L,e[40]=k,e[41]=$):$=e[41];let v;e[42]!==S||e[43]!==$?(v=(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[S,$]}),e[42]=S,e[43]=$,e[44]=v):v=e[44];let _;return e[45]!==j||e[46]!==d||e[47]!==v||e[48]!==m?(_=(0,s.jsxs)("div",{onClick:d,className:m,children:[j,v]}),e[45]=j,e[46]=d,e[47]=v,e[48]=m,e[49]=_):_=e[49],_},Fi=({conversations:t,userResults:e=[],onSelect:a,onStartNew:r,selectedId:l,searchQuery:i,onSearchChange:n,onlineUsers:c=new Set})=>(0,s.jsxs)("div",{className:"flex-1 flex flex-col min-w-0 bg-white dark:bg-black",children:[(0,s.jsx)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)(Ie,{value:i,onChange:n,onClear:()=>n(""),placeholder:"Search people or messages..."})}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[t.length>0&&(0,s.jsx)("div",{className:"py-2",children:t.map(o=>(0,s.jsx)(Ii,{conv:o,selectedId:l,onSelect:a,onlineUsers:c},o.id))}),e.length>0&&(0,s.jsxs)("div",{className:"border-t border-zinc-100 dark:border-zinc-800",children:[(0,s.jsx)("div",{className:"px-4 py-3 text-xs font-bold text-zinc-500 uppercase tracking-wider",children:"People"}),e.map(o=>(0,s.jsxs)("div",{onClick:()=>r(o),className:"flex items-center gap-3 p-4 cursor-pointer transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[(0,s.jsxs)(Y,{className:"size-12",children:[(0,s.jsx)(ee,{src:o.avatar,alt:o.name,className:"object-cover"}),(0,s.jsx)(te,{children:o.name?.[0]?.toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"font-bold dark:text-white truncate",children:o.name}),(0,s.jsxs)("div",{className:"text-zinc-500 text-sm truncate",children:["@",o.handle]})]}),(0,s.jsx)(yt,{size:18,className:"text-violet-500"})]},o.id))]}),t.length===0&&e.length===0&&i&&(0,s.jsx)("div",{className:"p-8 text-center",children:(0,s.jsxs)("p",{className:"text-zinc-500 text-sm",children:['No conversations or people found for "',i,'"']})}),t.length===0&&!i&&(0,s.jsx)("div",{className:"p-8 text-center",children:(0,s.jsx)("p",{className:"text-zinc-500 text-sm",children:"No messages yet. Search for people to start a chat!"})})]})]}),Oi=Fi,Ai=E(),Ei=t=>{const e=(0,Ai.c)(7),{className:a}=t;let r;e[0]!==a?(r=J("flex items-center gap-1 px-1 py-1.5",a),e[0]=a,e[1]=r):r=e[1];let l,i,n;e[2]===Symbol.for("react.memo_cache_sentinel")?(l=(0,s.jsx)("div",{className:"size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse"}),i=(0,s.jsx)("div",{className:"size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse [animation-delay:0.2s]"}),n=(0,s.jsx)("div",{className:"size-1.5 rounded-full bg-zinc-400 dark:bg-zinc-500 animate-dot-pulse [animation-delay:0.4s]"}),e[2]=l,e[3]=i,e[4]=n):(l=e[2],i=e[3],n=e[4]);let c;return e[5]!==r?(c=(0,s.jsxs)("div",{className:r,children:[l,i,n]}),e[5]=r,e[6]=c):c=e[6],c},Ri=Ei,et=E();function Ti(t){const e=(0,et.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let r;return e[2]!==a?(r=(0,s.jsx)(Ws,{"data-slot":"popover",...a}),e[2]=a,e[3]=r):r=e[3],r}function qi(t){const e=(0,et.c)(4);let a;e[0]!==t?({...a}=t,e[0]=t,e[1]=a):a=e[1];let r;return e[2]!==a?(r=(0,s.jsx)(Ps,{"data-slot":"popover-trigger",...a}),e[2]=a,e[3]=r):r=e[3],r}function Di(t){const e=(0,et.c)(12);let a,r,l,i;e[0]!==t?({className:a,align:l,sideOffset:i,...r}=t,e[0]=t,e[1]=a,e[2]=r,e[3]=l,e[4]=i):(a=e[1],r=e[2],l=e[3],i=e[4]);const n=l===void 0?"center":l,c=i===void 0?4:i;let o;e[5]!==a?(o=J("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 rounded-md border p-4 shadow-md outline-hidden",a),e[5]=a,e[6]=o):o=e[6];let d;return e[7]!==n||e[8]!==r||e[9]!==c||e[10]!==o?(d=(0,s.jsx)(aa,{children:(0,s.jsx)(Zs,{"data-slot":"popover-content",align:n,sideOffset:c,className:o,...r})}),e[7]=n,e[8]=r,e[9]=c,e[10]=o,e[11]=d):d=e[11],d}var Bi=E(),Wi=t=>{const e=(0,Bi.c)(10),{onEmojiSelect:a,className:r}=t;let l;e[0]!==r?(l=J("isolate flex h-[350px] w-[320px] flex-col overflow-hidden rounded-xl border border-zinc-200 bg-white shadow-xl dark:border-zinc-800 dark:bg-zinc-950",r),e[0]=r,e[1]=l):l=e[1];let i;e[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,s.jsx)(be.Search,{className:"z-10 mx-3 mt-3 appearance-none rounded-lg border-none bg-zinc-100 px-3 py-2 text-sm outline-none placeholder:text-zinc-500 focus:ring-1 focus:ring-violet-500 dark:bg-zinc-900 dark:text-white",placeholder:"Search emojis..."}),e[2]=i):i=e[2];let n,c;e[3]===Symbol.for("react.memo_cache_sentinel")?(n=(0,s.jsx)(be.Loading,{className:"absolute inset-0 flex items-center justify-center text-zinc-400 text-sm dark:text-zinc-500",children:"Loadingâ€¦"}),c=(0,s.jsx)(be.Empty,{className:"absolute inset-0 flex items-center justify-center text-zinc-400 text-sm dark:text-zinc-500",children:"No emoji found."}),e[3]=n,e[4]=c):(n=e[3],c=e[4]);let o,d;e[5]===Symbol.for("react.memo_cache_sentinel")?(o=(0,s.jsxs)(be.Viewport,{className:"relative flex-1 outline-none no-scrollbar",children:[n,c,(0,s.jsx)(be.List,{className:"select-none pb-2",components:{CategoryHeader:Vi,Row:Hi,Emoji:Ki}})]}),d=(0,s.jsx)(be.ActiveEmoji,{children:Ji}),e[5]=o,e[6]=d):(o=e[5],d=e[6]);let m;return e[7]!==a||e[8]!==l?(m=(0,s.jsxs)(be.Root,{onEmojiSelect:a,className:l,children:[i,o,d]}),e[7]=a,e[8]=l,e[9]=m):m=e[9],m},Qi=Wi;function Vi(t){const{category:e,...a}=t;return(0,s.jsx)("div",{className:"bg-white/80 px-4 pt-4 pb-1.5 font-bold text-zinc-500 text-[11px] uppercase tracking-wider backdrop-blur-sm dark:bg-zinc-950/80 dark:text-zinc-400",...a,children:e.label})}function Hi(t){const{children:e,...a}=t;return(0,s.jsx)("div",{className:"scroll-my-1 px-2",...a,children:e})}function Ki(t){const{emoji:e,...a}=t;return(0,s.jsx)("button",{className:"flex aspect-square size-9 items-center justify-center rounded-lg text-xl transition-colors hover:bg-zinc-100 data-[active]:bg-violet-500/10 data-[active]:text-violet-500 dark:hover:bg-zinc-900 dark:data-[active]:bg-violet-500/20",...a,children:e.emoji})}function Ji(t){const{emoji:e}=t;return(0,s.jsx)("div",{className:"flex items-center gap-3 border-t border-zinc-100 p-3 dark:border-zinc-800",children:e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"text-2xl",children:e.emoji}),(0,s.jsx)("span",{className:"text-xs font-bold text-zinc-600 dark:text-zinc-400 truncate",children:e.label.replace(/:/g,"").replace(/_/g," ")})]}):(0,s.jsx)("span",{className:"text-xs font-medium text-zinc-400",children:"Select an emoji..."})})}var Gi=({conversation:t,messages:e,onBack:a,onSendMessage:r,onTyping:l,isLoading:i,isTyping:n,isOnline:c})=>{const{openLightbox:o}=Je(),[d,m]=(0,N.useState)(""),[u,x]=(0,N.useState)(!1),[f,h]=(0,N.useState)([]),[p,b]=(0,N.useState)(!1),g=(0,N.useRef)(null),j=(0,N.useRef)(null),w=(0,N.useRef)(null),C=ss(t.user?.lastSeen);(0,N.useEffect)(()=>{j.current&&(j.current.scrollTop=j.current.scrollHeight)},[e,n]);const y=v=>{const _=v.target.value;m(_),l&&(l(!0),w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{l(!1)},2e3))},z=v=>{m(_=>_+v.emoji)},P=v=>{v.preventDefault(),!(!d.trim()&&f.length===0)&&(l&&(clearTimeout(w.current),l(!1)),r(t.id,d,f.length>0?"image":"text",f),m(""),h([]))},S=async v=>{const _=Array.from(v.target.files);if(_.length!==0){x(!0);try{const M=await Promise.all(_.map(F=>_e(F)));h(F=>[...F,...M])}catch(M){console.error("Upload failed:",M)}finally{x(!1)}}},L=v=>{h(_=>_.filter(M=>M.url!==v))},k=v=>{!v.media||v.media.length===0||o(v.media.map(_=>_.url),0)},$=(0,N.useMemo)(()=>{const v=e.filter(_=>_.sender==="me");return v.length>0?v[v.length-1].id:null},[e]);return(0,s.jsxs)("div",{className:"flex-1 flex flex-col h-full bg-white dark:bg-black md:border-l md:border-zinc-100 dark:md:border-zinc-800",children:[(0,s.jsxs)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800 flex items-center justify-between shrink-0 bg-white/80 dark:bg-black/80 backdrop-blur-md sticky top-0 z-10",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("button",{onClick:a,className:"md:hidden p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:(0,s.jsx)(Qe,{size:20})}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)(Y,{className:"size-10 border border-zinc-200 dark:border-zinc-700",children:[(0,s.jsx)(ee,{src:t.user.avatar,alt:t.user.name,className:"object-cover"}),(0,s.jsx)(te,{children:t.user.name?.[0]?.toUpperCase()})]}),c&&(0,s.jsx)("span",{className:"absolute bottom-0 right-0 size-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-bold dark:text-white",children:t.user.name}),c?(0,s.jsxs)("div",{className:"text-xs text-emerald-500 font-medium flex items-center gap-1",children:[(0,s.jsx)("span",{className:"size-1.5 bg-emerald-500 rounded-full animate-pulse"}),"Online"]}):(0,s.jsx)("div",{className:"text-xs text-zinc-500 font-medium",children:t.user.lastSeen?`Last seen ${C}`:"Offline"})]})]}),(0,s.jsx)("button",{className:"p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full dark:text-zinc-400",children:(0,s.jsx)(pa,{size:20})})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",ref:j,children:[(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsxs)("div",{className:"relative w-fit mx-auto",children:[(0,s.jsxs)(Y,{className:"size-20 mx-auto mb-3 border-4 border-zinc-50 dark:border-zinc-900 shadow-sm",children:[(0,s.jsx)(ee,{src:t.user.avatar,alt:t.user.name,className:"object-cover"}),(0,s.jsx)(te,{className:"text-2xl font-bold",children:t.user.name?.[0]?.toUpperCase()})]}),c&&(0,s.jsx)("span",{className:"absolute bottom-4 right-1 size-5 bg-emerald-500 border-4 border-white dark:border-black rounded-full animate-in zoom-in duration-300"})]}),(0,s.jsx)("h4",{className:"font-bold dark:text-white text-lg",children:t.user.name}),(0,s.jsxs)("p",{className:"text-sm text-zinc-500",children:["@",t.user.handle]}),(0,s.jsxs)("p",{className:"text-xs text-zinc-400 mt-4 max-w-xs mx-auto",children:["This is the beginning of your direct message history with"," ",(0,s.jsxs)("span",{className:"font-bold",children:["@",t.user.handle]})]})]}),i&&e.length===0?(0,s.jsx)("div",{className:"flex justify-center p-8",children:(0,s.jsx)(ae,{className:"animate-spin text-violet-500",size:32})}):e.map(v=>(0,s.jsx)("div",{className:`flex ${v.sender==="me"?"justify-end":"justify-start"}`,children:(0,s.jsxs)("div",{className:`max-w-[75%] p-1 rounded-2xl text-[15px] shadow-sm ${v.sender==="me"?"bg-violet-600 text-white rounded-tr-none":"bg-zinc-100 dark:bg-zinc-800 dark:text-white rounded-tl-none"}`,children:[v.media?.length>0&&(0,s.jsx)("div",{className:"mb-2 grid gap-1 grid-cols-1 overflow-hidden rounded-lg cursor-pointer",onClick:()=>k(v),children:v.media.map((_,M)=>(0,s.jsx)("img",{src:_.url,alt:"",className:"max-h-60 w-full object-cover rounded-md hover:brightness-90 transition-all"},M))}),v.text&&(0,s.jsx)("p",{className:"m-0 leading-tight px-3 py-1",children:v.text}),(0,s.jsxs)("div",{className:`text-[10px] flex items-center justify-end gap-1 px-3 pb-1 ${v.sender==="me"?"text-violet-200":"text-zinc-400"}`,children:[v.time,v.sender==="me"&&v.id===$&&(0,s.jsx)("span",{className:"ml-0.5",children:v.isRead?(0,s.jsx)(bs,{size:14,className:"text-white"}):(0,s.jsx)(ns,{size:14,className:"text-violet-200"})})]})]})},v.id)),n&&(0,s.jsx)("div",{className:"flex justify-start animate-in fade-in slide-in-from-bottom-2 duration-300",children:(0,s.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-800/50 px-3 py-2 rounded-2xl rounded-tl-none border border-zinc-200/50 dark:border-zinc-700/30 shadow-sm",children:(0,s.jsx)(Ri,{})})})]}),(0,s.jsxs)("div",{className:"p-4 border-t border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black shrink-0",children:[f.length>0&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 mb-3",children:[f.map(v=>(0,s.jsxs)("div",{className:"relative size-16 rounded-xl overflow-hidden border border-zinc-200 dark:border-zinc-800",children:[(0,s.jsx)("img",{src:v.url,className:"size-full object-cover",alt:""}),(0,s.jsx)("button",{type:"button",onClick:()=>L(v.url),className:"absolute top-1 right-1 bg-black/50 text-white rounded-full p-0.5 hover:bg-black transition-colors",children:(0,s.jsx)(ue,{size:12})})]},v.url)),u&&(0,s.jsx)("div",{className:"size-16 rounded-xl bg-zinc-100 dark:bg-zinc-900 flex items-center justify-center",children:(0,s.jsx)(ae,{className:"animate-spin text-violet-500",size:20})})]}),(0,s.jsxs)("form",{onSubmit:P,className:"flex items-center gap-2 bg-zinc-100 dark:bg-zinc-900 p-2 rounded-2xl border border-transparent focus-within:border-violet-500 transition-all",children:[(0,s.jsxs)(Ti,{open:p,onOpenChange:b,children:[(0,s.jsx)(qi,{asChild:!0,children:(0,s.jsx)("button",{type:"button",className:"p-2 text-zinc-500 hover:text-violet-600 transition-colors",children:(0,s.jsx)(sa,{size:20})})}),(0,s.jsx)(Di,{className:"w-fit p-0 border-none bg-transparent shadow-none",side:"top",align:"start",sideOffset:10,children:(0,s.jsx)(Qi,{onEmojiSelect:v=>{z(v)}})})]}),(0,s.jsx)("input",{type:"text",className:"flex-1 bg-transparent border-none outline-none dark:text-white py-1 px-1",placeholder:"Start a new message",value:d,onChange:y}),(0,s.jsx)("input",{type:"file",ref:g,onChange:S,className:"hidden",multiple:!0,accept:"image/*"}),(0,s.jsx)("button",{type:"button",onClick:()=>g.current?.click(),className:"p-2 text-zinc-500 hover:text-violet-600 transition-colors",disabled:u,children:(0,s.jsx)(Es,{size:20})}),(0,s.jsx)(ne,{type:"submit",className:"size-10 !p-0 rounded-xl",disabled:!d.trim()&&f.length===0||u,children:(0,s.jsx)(Cs,{size:18})})]})]})]})},Ui=Gi,Zi=E(),Xi=()=>{const t=(0,Zi.c)(69),{id:e}=Ve(),a=ge(),{currentUser:r}=se(),{onlineUsers:l}=Tt(),i=Ce(),[n,c]=(0,N.useState)("");let o;t[0]===Symbol.for("react.memo_cache_sentinel")?(o=[],t[0]=o):o=t[0];const[d,m]=(0,N.useState)(o),{conversations:u,isConvLoading:x,sendMessage:f,sendTypingStatus:h,typingStatus:p,markAsRead:b,formatMessages:g}=Ge(r);let j;e:{if(!e||u.length===0){j=null;break e}let G;t[1]!==u||t[2]!==e?(G=u.find(le=>le.id===e)||null,t[1]=u,t[2]=e,t[3]=G):G=t[3],j=G}const w=j;let C,y;t[4]!==e||t[5]!==b?(C=()=>{e&&b(e)},y=[e,b],t[4]=e,t[5]=b,t[6]=C,t[7]=y):(C=t[6],y=t[7]),(0,N.useEffect)(C,y);let z;t[8]!==u||t[9]!==r?.id||t[10]!==n?(z=()=>{const G=setTimeout(async()=>{if(n.length>1){const le=await Ma(n),tt=u.map(Yi);m(le.filter(st=>st.id!==r?.id&&!tt.includes(st.id)))}else m([])},300);return()=>clearTimeout(G)},t[8]=u,t[9]=r?.id,t[10]=n,t[11]=z):z=t[11];const P=r?.id;let S;t[12]!==u||t[13]!==n||t[14]!==P?(S=[n,u,P],t[12]=u,t[13]=n,t[14]=P,t[15]=S):S=t[15],(0,N.useEffect)(z,S);let L;t[16]!==r||t[17]!==a||t[18]!==i?(L=async G=>{try{const le=await At(r.id,G.id);i.invalidateQueries({queryKey:["conversations",r.id]}),c(""),a(`/messages/${le}`)}catch(le){console.error("Failed to start conversation:",le)}},t[16]=r,t[17]=a,t[18]=i,t[19]=L):L=t[19];const k=L;let $;t[20]!==a?($=G=>{a(`/messages/${G.id}`)},t[20]=a,t[21]=$):$=t[21];const v=$,_=w?.id;let M;t[22]!==_?(M=["messages",_],t[22]=_,t[23]=M):M=t[23];let F;t[24]!==w?.id?(F=()=>Ba(w?.id),t[24]=w?.id,t[25]=F):F=t[25];const B=!!w?.id;let q;t[26]!==M||t[27]!==F||t[28]!==B?(q={queryKey:M,queryFn:F,enabled:B},t[26]=M,t[27]=F,t[28]=B,t[29]=q):q=t[29];const{data:W,isLoading:V}=xe(q);let H;t[30]!==W?(H=W===void 0?[]:W,t[30]=W,t[31]=H):H=t[31];const O=H;let D;t[32]!==O||t[33]!==g?(D=g(O),t[32]=O,t[33]=g,t[34]=D):D=t[34];const T=D;if(!r){let G;return t[35]===Symbol.for("react.memo_cache_sentinel")?(G=(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-screen gap-4 p-8 text-center bg-white dark:bg-black md:rounded-xl md:border border-zinc-100 dark:border-zinc-800",children:[(0,s.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-900 p-4 rounded-full",children:(0,s.jsx)(Ft,{size:40,className:"text-zinc-400"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"Sign in to message others"}),(0,s.jsx)("p",{className:"text-zinc-500 max-w-xs",children:"Start decentralized conversations with anyone on the network."})]}),t[35]=G):G=t[35],G}if(x){let G;return t[36]===Symbol.for("react.memo_cache_sentinel")?(G=(0,s.jsx)("div",{className:"flex h-screen items-center justify-center bg-white dark:bg-black md:rounded-xl md:border border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)(ae,{className:"animate-spin text-violet-500",size:32})}),t[36]=G):G=t[36],G}let K;if(t[37]!==u||t[38]!==n){let G;t[40]!==n?(G=le=>le.user?.name?.toLowerCase().includes(n.toLowerCase())||le.user?.handle?.toLowerCase().includes(n.toLowerCase())||le.lastMessage?.toLowerCase().includes(n.toLowerCase()),t[40]=n,t[41]=G):G=t[41],K=u.filter(G),t[37]=u,t[38]=n,t[39]=K}else K=t[39];const Q=K,I=w&&p[w.id];let R;t[42]!==l||t[43]!==w?(R=w&&l.has(w.user?.id),t[42]=l,t[43]=w,t[44]=R):R=t[44];const U=R,X=`w-full md:w-80 flex flex-col border-r border-zinc-100 dark:border-zinc-800 ${w?"hidden md:flex":"flex"}`;let re;t[45]===Symbol.for("react.memo_cache_sentinel")?(re=(0,s.jsx)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)("h2",{className:"text-xl font-bold dark:text-white",children:"Messages"})}),t[45]=re):re=t[45];let Z;t[46]!==Q||t[47]!==v||t[48]!==k||t[49]!==e||t[50]!==n||t[51]!==l||t[52]!==d?(Z=(0,s.jsx)(Oi,{conversations:Q,userResults:d,onSelect:v,onStartNew:k,selectedId:e,searchQuery:n,onSearchChange:c,onlineUsers:l}),t[46]=Q,t[47]=v,t[48]=k,t[49]=e,t[50]=n,t[51]=l,t[52]=d,t[53]=Z):Z=t[53];let me;t[54]!==X||t[55]!==Z?(me=(0,s.jsxs)("div",{className:X,children:[re,Z]}),t[54]=X,t[55]=Z,t[56]=me):me=t[56];let je;t[57]!==I||t[58]!==V||t[59]!==T||t[60]!==a||t[61]!==U||t[62]!==w||t[63]!==f||t[64]!==h?(je=w?(0,s.jsx)(Ui,{conversation:w,messages:T,onBack:()=>a("/messages"),onSendMessage:f,onTyping:G=>h(w.id,G),isLoading:V,isTyping:I,isOnline:U}):(0,s.jsxs)("div",{className:"hidden md:flex flex-1 items-center justify-center text-zinc-500 flex-col gap-4",children:[(0,s.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-6 rounded-full",children:(0,s.jsx)(Ae,{size:48,className:"text-zinc-300"})}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-zinc-900 dark:text-white",children:"Select a message"}),(0,s.jsx)("p",{children:"Choose from your existing conversations or start a new one."})]})]}),t[57]=I,t[58]=V,t[59]=T,t[60]=a,t[61]=U,t[62]=w,t[63]=f,t[64]=h,t[65]=je):je=t[65];let Pe;return t[66]!==me||t[67]!==je?(Pe=(0,s.jsxs)("div",{className:"flex h-screen bg-white dark:bg-black overflow-hidden md:rounded-xl md:border border-zinc-100 dark:border-zinc-800",children:[me,je]}),t[66]=me,t[67]=je,t[68]=Pe):Pe=t[68],Pe},bt=Xi;function Yi(t){return t.user?.id}var en=E(),tn=()=>{const t=(0,en.c)(39),{currentUser:e}=se(),a=Ce(),r=e?.id;let l;t[0]!==r?(l=["notifications",r],t[0]=r,t[1]=l):l=t[1];let i;t[2]!==e?.id?(i=()=>Aa(e?.id),t[2]=e?.id,t[3]=i):i=t[3];const n=!!e?.id;let c;t[4]!==l||t[5]!==i||t[6]!==n?(c={queryKey:l,queryFn:i,enabled:n},t[4]=l,t[5]=i,t[6]=n,t[7]=c):c=t[7];const{data:o,isLoading:d}=xe(c);let m;t[8]!==o?(m=o===void 0?[]:o,t[8]=o,t[9]=m):m=t[9];const u=m;let x;t[10]!==e||t[11]!==a?(x=()=>{if(!e?.id)return;const k=A.channel(`user_notifications:${e.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`recipient_id=eq.${e.id}`},()=>{a.invalidateQueries({queryKey:["notifications",e.id]})}).subscribe();return()=>A.removeChannel(k)},t[10]=e,t[11]=a,t[12]=x):x=t[12];const f=e?.id;let h;t[13]!==a||t[14]!==f?(h=[f,a],t[13]=a,t[14]=f,t[15]=h):h=t[15],(0,N.useEffect)(x,h);let p;t[16]!==e?(p=()=>Ea(e.id),t[16]=e,t[17]=p):p=t[17];let b;t[18]!==e||t[19]!==a?(b=()=>{a.invalidateQueries({queryKey:["notifications",e.id]})},t[18]=e,t[19]=a,t[20]=b):b=t[20];let g;t[21]!==p||t[22]!==b?(g={mutationFn:p,onSuccess:b},t[21]=p,t[22]=b,t[23]=g):g=t[23];const j=Nt(g);let w;t[24]!==e?.id||t[25]!==j||t[26]!==u?(w=()=>{e?.id&&u.some(an)&&j.mutate()},t[24]=e?.id,t[25]=j,t[26]=u,t[27]=w):w=t[27];const C=e?.id;let y;if(t[28]!==j||t[29]!==u||t[30]!==C?(y=[C,u,j],t[28]=j,t[29]=u,t[30]=C,t[31]=y):y=t[31],(0,N.useEffect)(w,y),d){let k;return t[32]===Symbol.for("react.memo_cache_sentinel")?(k=(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,s.jsx)(ae,{size:32,className:"animate-spin text-violet-500"})}),t[32]=k):k=t[32],k}if(!e){let k;return t[33]===Symbol.for("react.memo_cache_sentinel")?(k=(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[400px] gap-4 p-8 text-center",children:[(0,s.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-900 p-4 rounded-full",children:(0,s.jsx)(Ft,{size:40,className:"text-zinc-400"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"Sign in to see notifications"}),(0,s.jsx)("p",{className:"text-zinc-500 max-w-xs",children:"Join the conversation and keep track of who's engaging with your content."})]}),t[33]=k):k=t[33],k}const z=rn;let P;t[34]===Symbol.for("react.memo_cache_sentinel")?(P=(0,s.jsx)("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800 sticky top-0 bg-white/80 dark:bg-black/80 backdrop-blur-md z-10",children:(0,s.jsx)("h2",{className:"text-xl font-bold dark:text-white",children:"Notifications"})}),t[34]=P):P=t[34];let S;t[35]!==u?(S=u.length>0?u.map(k=>(0,s.jsxs)("div",{className:`p-4 border-b border-zinc-100 dark:border-zinc-800 flex items-start gap-4 hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors cursor-pointer ${k.is_read?"":"bg-violet-50/30 dark:bg-violet-500/5"}`,children:[(0,s.jsx)("div",{className:"shrink-0 pt-1",children:z(k.type)}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-1",children:[(0,s.jsxs)(Y,{className:"size-8",children:[(0,s.jsx)(ee,{src:k.avatar}),(0,s.jsx)(te,{children:k.user?.[0]?.toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex-1 flex justify-between items-center",children:[(0,s.jsxs)("span",{className:"font-bold text-sm dark:text-white truncate",children:["@",k.user]}),(0,s.jsx)("span",{className:"text-zinc-500 text-xs whitespace-nowrap",children:Me(k.created_at)})]})]}),(0,s.jsxs)("p",{className:"text-zinc-600 dark:text-zinc-400 text-[15px] ml-11",children:[k.type==="like"&&"liked your post",k.type==="follow"&&"followed you",k.type==="mention"&&"mentioned you in a post",k.type==="comment"&&"commented on your post",k.type==="repost"&&"reposted your post"]})]}),!k.is_read&&(0,s.jsx)("div",{className:"size-2 rounded-full bg-violet-500 mt-2 shrink-0 shadow-[0_0_8px_rgba(139,92,246,0.5)]"})]},k.id)):(0,s.jsx)("div",{className:"p-16 text-center text-zinc-500",children:(0,s.jsx)("p",{className:"font-medium",children:"No notifications yet."})}),t[35]=u,t[36]=S):S=t[36];let L;return t[37]!==S?(L=(0,s.jsxs)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm",children:[P,S]}),t[37]=S,t[38]=L):L=t[38],L},sn=tn;function an(t){return!t.is_read}function rn(t){switch(t){case"like":return(0,s.jsx)(ke,{size:20,className:"text-rose-500 fill-rose-500"});case"follow":return(0,s.jsx)(yt,{size:20,className:"text-blue-500"});case"mention":return(0,s.jsx)(at,{size:20,className:"text-emerald-500"});case"comment":return(0,s.jsx)(Qs,{size:20,className:"text-violet-500"});case"repost":return(0,s.jsx)(oa,{size:20,className:"text-amber-500"});default:return(0,s.jsx)(at,{size:20,className:"text-zinc-500"})}}const ln=(t,e,a)=>{const r=t?.id,[l,i]=(0,N.useState)(!1),[n,c]=(0,N.useState)({followers:t?.followers||t?.follower_count||0,following:t?.following||t?.following_count||0}),[o,d]=(0,N.useState)(!1);return(0,N.useEffect)(()=>{t&&(c({followers:t.followers||t.follower_count||0,following:t.following||t.following_count||0}),r&&de(r)&&(Ua(r).then(u=>{u&&c({followers:u.followers,following:u.following})}).catch(()=>{}),e&&de(e)&&Ga(e,r).then(i).catch(()=>i(!1))))},[t,r,e]),{isFollowing:l,stats:n,loading:o,handleFollow:async()=>{if(!e)return a("Please login to follow!","error");if(e===r)return a("You cannot follow yourself!","error");if(!r||!de(r)||!de(e)){const u=!l;i(u),c(x=>{const f=typeof x.followers=="string"?parseInt(x.followers.replace(/,/g,"")):x.followers||0;return{...x,followers:u?f+1:Math.max(0,f-1)}}),a(u?"Followed":"Unfollowed");return}d(!0);try{const u=await Ja(e,r);i(u),c(x=>({...x,followers:u?(x.followers||0)+1:Math.max(0,(x.followers||0)-1)})),a(u?"Followed":"Unfollowed")}catch(u){console.error("Failed to toggle follow:",u),a("Failed to update follow status","error")}finally{d(!1)}},setStats:c}};var nn=({profile:t,currentUser:e,isCurrentUser:a,onEditProfile:r,showToast:l,isCommunity:i})=>{const{isFollowing:n,stats:c,loading:o,handleFollow:d}=ln(t,e?.id,l),m=ge(),[u,x]=(0,N.useState)(!1),f=async()=>{if(!e){l("Please sign in to message users");return}x(!0);try{m(`/messages/${await At(e.id,t.id)}`)}catch(h){console.error("Failed to start conversation:",h),l("Failed to open chat")}finally{x(!1)}};return(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("div",{className:"relative h-32 sm:h-48 w-full bg-zinc-200 dark:bg-zinc-800",children:[t.cover&&(0,s.jsx)("img",{src:t.cover,className:"h-full w-full object-cover transition-opacity duration-500",alt:"Cover"}),(0,s.jsx)("div",{className:"absolute -bottom-12 sm:-bottom-16 left-4 sm:left-6",children:(0,s.jsx)("div",{className:"p-1 bg-white dark:bg-black rounded-full overflow-hidden shadow-xl ring-4 ring-white dark:ring-black relative",children:(0,s.jsxs)(Y,{className:"size-24 sm:size-32",children:[(0,s.jsx)(ee,{src:t.avatar,alt:t.handle,className:"object-cover"}),(0,s.jsx)(te,{className:"text-4xl font-bold",children:t.handle?.[0]?.toUpperCase()})]})})})]}),(0,s.jsxs)("div",{className:"flex flex-col p-4 sm:p-6 pt-16 sm:pt-20 space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsx)("div",{className:"flex-1 min-w-0 pr-4"}),(0,s.jsx)("div",{className:"flex gap-2 shrink-0",children:a?(0,s.jsx)(ne,{variant:"secondary",onClick:()=>r(t),className:"text-sm px-5",children:"Edit profile"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:f,disabled:u,className:"rounded-full p-2 border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 dark:border-zinc-800 transition-colors disabled:opacity-50",children:u?(0,s.jsx)(ae,{size:20,className:"animate-spin"}):(0,s.jsx)(Ae,{size:20})}),(0,s.jsx)("button",{className:"rounded-full p-2 border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-900 text-zinc-700 dark:text-zinc-300 dark:border-zinc-800 transition-colors",children:(0,s.jsx)(We,{size:20})}),(0,s.jsx)(ne,{variant:n?"secondary":"primary",onClick:d,className:"text-sm px-6 min-w-[100px]",disabled:o,children:o?(0,s.jsx)(ae,{size:16,className:"animate-spin mx-auto"}):n?"Following":"Follow"}),(0,s.jsx)("button",{className:"rounded-full p-2 hover:bg-zinc-100 text-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-800 transition-colors",children:(0,s.jsx)(Be,{size:20})})]})})]}),(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsx)("div",{className:"flex items-center gap-1.5",children:(0,s.jsxs)("h3",{className:"text-xl sm:text-2xl font-extrabold truncate dark:text-white flex items-center gap-1",children:[t.name,t.verified&&(0,s.jsx)(Fe,{})]})}),!i&&(0,s.jsx)("div",{className:"flex items-center space-x-3",children:(0,s.jsxs)("span",{className:"text-zinc-500 font-medium text-sm px-1.5 py-0.5 -ml-1.5 rounded-md dark:text-zinc-400",children:["@",t.handle]})})]}),(0,s.jsx)("div",{className:"whitespace-pre-line text-zinc-900 dark:text-zinc-100 leading-relaxed text-sm sm:text-[15px]",children:t.bio}),(t.website||t.location)&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-x-5 gap-y-2 text-sm pt-1",children:[t.location&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)(He,{size:14}),(0,s.jsx)("span",{children:t.location})]}),t.website&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)(Lt,{size:14}),(0,s.jsx)("a",{href:`https://${t.website}`,target:"_blank",rel:"noreferrer",className:"text-violet-600 hover:underline font-semibold text-black dark:text-white",children:t.website})]})]}),(0,s.jsx)("div",{className:"flex gap-4 sm:gap-6 text-sm pt-2",children:i?(0,s.jsxs)("button",{className:"flex gap-x-1 hover:underline group",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white group-hover:text-violet-600",children:t.members}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Members"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{className:"flex gap-x-1 hover:underline group",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white group-hover:text-violet-600",children:c.following}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Following"})]}),(0,s.jsxs)("button",{className:"flex gap-x-1 hover:underline group",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white group-hover:text-violet-600",children:c.followers}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Followers"})]})]})})]})]})},on=nn,cn=E(),dn=t=>{const e=(0,cn.c)(67),{onEditProfile:a}=t,{handle:r}=Ve(),l=ge(),{profiles:i,currentUser:n,getProfileByHandle:c}=se(),{getUserPosts:o}=ze(),{addToast:d}=he(),[m,u]=(0,N.useState)("feed"),[x,f]=(0,N.useState)(!i[r]),[h,p]=(0,N.useState)(i[r]);let b,g;e[0]!==c||e[1]!==r||e[2]!==i?(b=()=>{(async()=>i[r]?p(i[r]):(f(!0),p(await c(r)),f(!1)))()},g=[r,i,c],e[0]=c,e[1]=r,e[2]=i,e[3]=b,e[4]=g):(b=e[3],g=e[4]),(0,N.useEffect)(b,g);let j;e[5]!==m||e[6]!==o||e[7]!==r?(j=o(r,m),e[5]=m,e[6]=o,e[7]=r,e[8]=j):j=e[8];const w=j;let C;e[9]!==l?(C=Z=>{l(`/post/${Z}`)},e[9]=l,e[10]=C):C=e[10];const y=C;let z;e[11]!==r||e[12]!==l?(z=Z=>{Z!==r&&l(`/u/${Z}`)},e[11]=r,e[12]=l,e[13]=z):z=e[13];const P=z;if(x){let Z;return e[14]===Symbol.for("react.memo_cache_sentinel")?(Z=(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)(ae,{size:40,className:"animate-spin text-violet-500"})}),e[14]=Z):Z=e[14],Z}let S;e[15]!==r||e[16]!==h?(S=h||{id:null,name:r,handle:r,avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Sysm",cover:"https://systemadminbd.com/uploads/675346dd55e0c7.43939630.png",bio:"Profile not found",following:"0",followers:"0"},e[15]=r,e[16]=h,e[17]=S):S=e[17];const L=S;let k;e[18]!==d||e[19]!==n||e[20]!==y||e[21]!==P||e[22]!==w?(k=()=>w.length>0?w.map(Z=>(0,s.jsx)(Ee,{currentUser:n,showToast:d,...Z,onClick:()=>y(Z.id),onUserClick:P},Z.id)):(0,s.jsxs)("div",{className:"p-16 text-center text-zinc-500 flex flex-col items-center gap-4",children:[(0,s.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 p-4 rounded-full",children:(0,s.jsx)(_t,{size:32,className:"text-zinc-300"})}),(0,s.jsx)("p",{className:"font-medium",children:"No posts found"})]}),e[18]=d,e[19]=n,e[20]=y,e[21]=P,e[22]=w,e[23]=k):k=e[23];const $=k;let v;e[24]!==l?(v=()=>l(-1),e[24]=l,e[25]=v):v=e[25];let _;e[26]===Symbol.for("react.memo_cache_sentinel")?(_=(0,s.jsx)(Qe,{size:22}),e[26]=_):_=e[26];let M;e[27]!==v?(M=(0,s.jsx)("button",{onClick:v,className:"p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:_}),e[27]=v,e[28]=M):M=e[28];let F;e[29]!==L.name?(F=(0,s.jsx)("h5",{className:"text-lg font-bold dark:text-white leading-none",children:L.name}),e[29]=L.name,e[30]=F):F=e[30];const B=w?w.length:0;let q;e[31]!==B?(q=(0,s.jsxs)("span",{className:"text-xs text-zinc-500 mt-0.5",children:[B," Posts"]}),e[31]=B,e[32]=q):q=e[32];let W;e[33]!==F||e[34]!==q?(W=(0,s.jsxs)("div",{className:"flex flex-col",children:[F,q]}),e[33]=F,e[34]=q,e[35]=W):W=e[35];let V;e[36]!==M||e[37]!==W?(V=(0,s.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3 md:hidden",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4",children:[M,W]})}),e[36]=M,e[37]=W,e[38]=V):V=e[38];const H=n?.handle===L.handle;let O;e[39]!==d||e[40]!==n||e[41]!==L||e[42]!==a||e[43]!==H?(O=(0,s.jsx)(on,{profile:L,currentUser:n,isCurrentUser:H,onEditProfile:a,showToast:d}),e[39]=d,e[40]=n,e[41]=L,e[42]=a,e[43]=H,e[44]=O):O=e[44];let D;e[45]===Symbol.for("react.memo_cache_sentinel")?(D=(0,s.jsx)("div",{className:"sticky top-[60px] md:top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-10 border-b border-zinc-100 dark:border-zinc-800",children:(0,s.jsx)(es,{className:"w-full h-auto bg-transparent p-0 rounded-none justify-start px-2",children:["feed","replies","media"].map(fn)})}),e[45]=D):D=e[45];let T;e[46]!==$?(T=$(),e[46]=$,e[47]=T):T=e[47];let K;e[48]!==T?(K=(0,s.jsx)(ye,{value:"feed",className:"m-0 border-none",children:T}),e[48]=T,e[49]=K):K=e[49];let Q;e[50]!==$?(Q=$(),e[50]=$,e[51]=Q):Q=e[51];let I;e[52]!==Q?(I=(0,s.jsx)(ye,{value:"replies",className:"m-0 border-none",children:Q}),e[52]=Q,e[53]=I):I=e[53];let R;e[54]!==$?(R=$(),e[54]=$,e[55]=R):R=e[55];let U;e[56]!==R?(U=(0,s.jsx)(ye,{value:"media",className:"m-0 border-none",children:R}),e[56]=R,e[57]=U):U=e[57];let X;e[58]!==m||e[59]!==K||e[60]!==I||e[61]!==U?(X=(0,s.jsxs)(Yt,{value:m,onValueChange:u,className:"w-full",children:[D,K,I,U]}),e[58]=m,e[59]=K,e[60]=I,e[61]=U,e[62]=X):X=e[62];let re;return e[63]!==V||e[64]!==O||e[65]!==X?(re=(0,s.jsx)("div",{className:"border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:(0,s.jsxs)("div",{className:"border-y md:border-b-0 border-zinc-100 dark:border-zinc-800",children:[V,O,X]})}),e[63]=V,e[64]=O,e[65]=X,e[66]=re):re=e[66],re},mn=dn;function fn(t){return(0,s.jsx)(ts,{value:t,className:"flex-1 py-4 text-sm font-bold capitalize rounded-none border-b-2 data-[state=active]:border-black dark:data-[state=active]:border-white data-[state=active]:text-black dark:data-[state=active]:text-white text-zinc-500 transition-all hover:bg-zinc-50 dark:hover:bg-zinc-900",children:t==="feed"?"Posts":t},t)}var un=E(),xn=()=>{const t=(0,un.c)(34),{id:e}=Ve(),a=ge(),{currentUser:r}=se(),{addToast:l}=he();let i,n;t[0]!==e?(i=["post",e],n=async()=>{if(!de(e))throw new Error("Invalid post ID");return $a(e)},t[0]=e,t[1]=i,t[2]=n):(i=t[1],n=t[2]);const c=!!e;let o;t[3]!==i||t[4]!==n||t[5]!==c?(o={queryKey:i,queryFn:n,enabled:c,retry:!1},t[3]=i,t[4]=n,t[5]=c,t[6]=o):o=t[6];const{data:d,isLoading:m,isError:u}=xe(o);if(m){let z;return t[7]===Symbol.for("react.memo_cache_sentinel")?(z=(0,s.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen",children:(0,s.jsx)(Ye,{})}),t[7]=z):z=t[7],z}if(u||!d){let z;t[8]===Symbol.for("react.memo_cache_sentinel")?(z=(0,s.jsx)("p",{className:"text-zinc-500",children:"Post not found"}),t[8]=z):z=t[8];let P;return t[9]!==a?(P=(0,s.jsxs)("div",{className:"p-10 text-center",children:[z,(0,s.jsx)("button",{onClick:()=>a(-1),className:"text-violet-500 mt-4 underline font-bold",children:"Go back"})]}),t[9]=a,t[10]=P):P=t[10],P}let x;t[11]!==a?(x=()=>a(-1),t[11]=a,t[12]=x):x=t[12];let f;t[13]===Symbol.for("react.memo_cache_sentinel")?(f=(0,s.jsx)(Qe,{size:20,strokeWidth:2.5}),t[13]=f):f=t[13];let h;t[14]!==x?(h=(0,s.jsx)("button",{onClick:x,className:"p-2 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:text-white transition-colors",children:f}),t[14]=x,t[15]=h):h=t[15];let p;t[16]===Symbol.for("react.memo_cache_sentinel")?(p=(0,s.jsx)("h5",{className:"text-xl font-bold dark:text-white",children:"Post"}),t[16]=p):p=t[16];let b;t[17]!==h?(b=(0,s.jsx)("div",{className:"sticky top-0 bg-white/90 dark:bg-black/90 backdrop-blur-md z-20 border-b border-zinc-100 dark:border-zinc-800 px-4 py-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4",children:[h,p]})}),t[17]=h,t[18]=b):b=t[18];let g;t[19]!==d.comments?(g=d.comments||[],t[19]=d.comments,t[20]=g):g=t[20];let j,w;t[21]!==a?(j=z=>a(`/u/${z}`),w=()=>a(-1),t[21]=a,t[22]=j,t[23]=w):(j=t[22],w=t[23]);let C;t[24]!==l||t[25]!==r||t[26]!==d||t[27]!==j||t[28]!==w||t[29]!==g?(C=(0,s.jsx)(Ee,{...d,isDetail:!0,currentUser:r,initialComments:g,showToast:l,onUserClick:j,onDelete:w}),t[24]=l,t[25]=r,t[26]=d,t[27]=j,t[28]=w,t[29]=g,t[30]=C):C=t[30];let y;return t[31]!==C||t[32]!==b?(y=(0,s.jsx)("div",{className:"border-y md:border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-black rounded-none md:rounded-xl overflow-hidden min-h-screen shadow-sm mb-20 animate-in slide-in-from-right-5 duration-300",children:(0,s.jsxs)("div",{className:"border-b border-zinc-100 dark:border-zinc-800",children:[b,C]})}),t[31]=C,t[32]=b,t[33]=y):y=t[33],y},hn=xn,pn=E();function bn(){const t=(0,pn.c)(49),e=Oe(),{currentUser:a,authMode:r,setAuthMode:l}=se(),{darkMode:i}=Ke(),{isOpen:n,images:c,currentIndex:o,closeLightbox:d,setIndex:m}=Je(),[u,x]=(0,N.useState)(!1),[f,h]=(0,N.useState)(!1),[p,b]=(0,N.useState)(!1);let g;t[0]===Symbol.for("react.memo_cache_sentinel")?(g={},t[0]=g):g=t[0];const[j,w]=(0,N.useState)(g),[C,y]=(0,N.useState)(null);if(r){const K=i?"dark":"";let Q;t[1]!==l?(Q=()=>l(null),t[1]=l,t[2]=Q):Q=t[2];let I;t[3]!==r||t[4]!==l?(I=()=>l(r==="login"?"signup":"login"),t[3]=r,t[4]=l,t[5]=I):I=t[5];let R;t[6]!==r||t[7]!==Q||t[8]!==I?(R=(0,s.jsx)("div",{className:"min-h-screen bg-white dark:bg-black flex items-center justify-center p-4",children:(0,s.jsx)(ce,{children:(0,s.jsx)(vl,{type:r,onComplete:Q,onSwitch:I})})}),t[6]=r,t[7]=Q,t[8]=I,t[9]=R):R=t[9];let U;return t[10]!==K||t[11]!==R?(U=(0,s.jsx)("div",{className:K,children:R}),t[10]=K,t[11]=R,t[12]=U):U=t[12],U}let z;t[13]===Symbol.for("react.memo_cache_sentinel")?(z=(0,s.jsx)(zr,{}),t[13]=z):z=t[13];let P;t[14]===Symbol.for("react.memo_cache_sentinel")?(P=(0,s.jsx)(Qr,{}),t[14]=P):P=t[14];let S;t[15]===Symbol.for("react.memo_cache_sentinel")?(S=(0,s.jsx)(ie,{path:"/",element:(0,s.jsx)(ce,{children:(0,s.jsx)(ci,{onStoryClick:y,onAddStory:()=>b(!0)})})}),t[15]=S):S=t[15];let L;t[16]===Symbol.for("react.memo_cache_sentinel")?(L=(0,s.jsx)(ie,{path:"/home",element:(0,s.jsx)(rt,{to:"/",replace:!0})}),t[16]=L):L=t[16];let k;t[17]===Symbol.for("react.memo_cache_sentinel")?(k=(0,s.jsx)(ie,{path:"/explore",element:(0,s.jsx)(ce,{children:(0,s.jsx)(bi,{})})}),t[17]=k):k=t[17];let $;t[18]===Symbol.for("react.memo_cache_sentinel")?($=(0,s.jsx)(ie,{path:"/reels",element:(0,s.jsx)(ce,{children:(0,s.jsx)(Si,{})})}),t[18]=$):$=t[18];let v;t[19]===Symbol.for("react.memo_cache_sentinel")?(v=(0,s.jsx)(ie,{path:"/messages",element:(0,s.jsx)(ce,{children:(0,s.jsx)(bt,{})})}),t[19]=v):v=t[19];let _;t[20]===Symbol.for("react.memo_cache_sentinel")?(_=(0,s.jsx)(ie,{path:"/messages/:id",element:(0,s.jsx)(ce,{children:(0,s.jsx)(bt,{})})}),t[20]=_):_=t[20];let M;t[21]===Symbol.for("react.memo_cache_sentinel")?(M=(0,s.jsx)(ie,{path:"/notifications",element:(0,s.jsx)(ce,{children:(0,s.jsx)(sn,{})})}),t[21]=M):M=t[21];let F;t[22]===Symbol.for("react.memo_cache_sentinel")?(F=(0,s.jsx)(ie,{path:"/post/:id",element:(0,s.jsx)(ce,{children:(0,s.jsx)(hn,{})})}),t[22]=F):F=t[22];let B;t[23]===Symbol.for("react.memo_cache_sentinel")?(B=(0,s.jsx)(ie,{path:"/u/:handle",element:(0,s.jsx)(ce,{children:(0,s.jsx)(mn,{onEditProfile:K=>{w(K),h(!0)}})})}),t[23]=B):B=t[23];let q;t[24]===Symbol.for("react.memo_cache_sentinel")?(q=(0,s.jsxs)(ie,{element:P,children:[S,L,k,$,v,_,M,F,B,(0,s.jsx)(ie,{path:"*",element:(0,s.jsx)(rt,{to:"/explore"})})]}),t[24]=q):q=t[24];let W;t[25]!==e?(W=(0,s.jsx)(ta,{location:e,children:q},e.pathname),t[25]=e,t[26]=W):W=t[26];let V;t[27]!==j||t[28]!==f||t[29]!==u||t[30]!==p?(V=(0,s.jsx)(cl,{isPostModalOpen:u,setIsPostModalOpen:x,isEditProfileOpen:f,setIsEditProfileOpen:h,isStoryModalOpen:p,setIsStoryModalOpen:b,editProfileData:j,setEditProfileData:w}),t[27]=j,t[28]=f,t[29]=u,t[30]=p,t[31]=V):V=t[31];let H;t[32]!==C?(H=C&&(0,s.jsx)(fl,{story:C,onClose:()=>y(null)}),t[32]=C,t[33]=H):H=t[33];let O;t[34]!==d||t[35]!==o||t[36]!==c||t[37]!==n||t[38]!==m?(O=n&&(0,s.jsx)(hl,{images:c,currentIndex:o,onClose:d,onNavigate:m}),t[34]=d,t[35]=o,t[36]=c,t[37]=n,t[38]=m,t[39]=O):O=t[39];let D;t[40]!==a||t[41]!==e.pathname?(D=a&&e.pathname==="/"&&(0,s.jsx)("button",{onClick:()=>x(!0),className:"fixed bottom-20 right-5 md:bottom-10 md:right-10 z-50 bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 size-12 md:size-16 rounded-full flex items-center justify-center shadow-2xl hover:scale-110 active:scale-90 transition-all cursor-pointer group",title:"Create Post",children:(0,s.jsx)(Ne,{size:28,className:"md:w-8 md:h-8 group-hover:rotate-90 transition-transform duration-300"})}),t[40]=a,t[41]=e.pathname,t[42]=D):D=t[42];let T;return t[43]!==W||t[44]!==V||t[45]!==H||t[46]!==O||t[47]!==D?(T=(0,s.jsxs)(s.Fragment,{children:[z,W,V,H,O,D]}),t[43]=W,t[44]=V,t[45]=H,t[46]=O,t[47]=D,t[48]=T):T=t[48],T}var gn=new ga;(0,Na.createRoot)(document.getElementById("root")).render((0,s.jsx)(N.StrictMode,{children:(0,s.jsx)(ba,{client:gn,children:(0,s.jsx)(ia,{children:(0,s.jsx)(rr,{children:(0,s.jsx)(er,{children:(0,s.jsx)(sr,{children:(0,s.jsx)(mr,{children:(0,s.jsx)(cr,{children:(0,s.jsx)(ur,{children:(0,s.jsx)(bn,{})})})})})})})})})}));
