import{a as H}from"./rolldown-runtime-BaZ8gS7u.js";import{c as L,l as V,v as W,w as q}from"./framework-3lkjbTvb.js";import{an as z,un as B}from"./ui-libs-BrvosAtl.js";import{n as G,t as Y}from"./media-libs-C98UjHPF.js";import{Ln as $,dn as J,on as K}from"./index-Cg52Q0DN.js";import{i as I,n as Q,r as D,t as X}from"./text-processing-BMF44JzJ.js";var Z=D("hashtag",{isLink:!0});function tt({scanner:e,parser:t}){const{POUND:i,UNDERSCORE:u,FULLWIDTHMIDDLEDOT:n,ASCIINUMERICAL:m,ALPHANUMERICAL:d}=e.tokens,{alpha:l,numeric:c,alphanumeric:r,emoji:f}=e.tokens.groups,a=t.start.tt(i),o=a.tt(u),s=new Q(Z);a.tt(m,s),a.tt(d,s),a.ta(c,o),a.ta(l,s),a.ta(f,s),a.ta(n,s),o.tt(m,s),o.tt(d,s),o.ta(l,s),o.ta(f,s),o.ta(n,s),o.ta(c,o),o.tt(u,o),s.ta(r,s),s.ta(f,s),s.tt(n,s),s.tt(u,s)}I("hashtag",tt);var et=D("mention",{isLink:!0,toHref(){return"/"+this.toString().slice(1)}});function rt({scanner:e,parser:t}){const{HYPHEN:i,SLASH:u,UNDERSCORE:n,AT:m}=e.tokens,{domain:d}=e.tokens.groups,l=t.start.tt(m),c=l.tt(i);c.tt(i,c);const r=l.tt(n,et);l.ta(d,r),c.tt(n,r),c.ta(d,r),r.ta(d,r),r.tt(i,r),r.tt(n,r);const f=r.tt(u);f.ta(d,r),f.tt(n,r),f.tt(i,r)}I("mention",rt);const st={formatHref:(e,t)=>t==="mention"?`/u/${e.substring(1)}`:t==="hashtag"?`/tags/${e.substring(1)}`:e,attributes:{onClick:e=>e.stopPropagation(),className:"cursor-pointer font-bold text-rose-600 hover:underline dark:text-rose-400"},validate:{hashtag:e=>/^#[\u0980-\u09FF\w]+$/.test(e)},target:(e,t)=>t==="url"?"_blank":void 0,rel:(e,t)=>t==="url"?"noopener noreferrer":void 0},M={BASE_URL:"https://feed.systemadminbd.com",APP_ID:"com.mysys.app",CUSTOM_SCHEME:"mysys"},O=()=>("Capacitor"in window,M.BASE_URL),F=e=>`${O()}${e.startsWith("/")?e:`/${e}`}`,bt=e=>F(`/p/${e}`),kt=e=>F(`/r/${e}`);var nt=L(),C=H(q(),1),g=H(V(),1),ot=e=>{const t=(0,nt.c)(13),{content:i,className:u,onClick:n}=e,m=W(),d=at;let l;t[0]!==i?(l=typeof i=="string"?d(i):i,t[0]=i,t[1]=l):l=t[1];const c=l;let r;t[2]!==u?(r=$("whitespace-pre-line break-words",u),t[2]=u,t[3]=r):r=t[3];let f;t[4]!==m?(f={...st,render:s=>{const{attributes:k,content:y}=s,{href:h,..._}=k,P=O();if(h.includes("internal.tag/")){const x=decodeURIComponent(h.split("internal.tag/")[1]);return(0,g.jsxs)("span",{..._,className:$("cursor-pointer font-bold text-blue-600 hover:underline dark:text-blue-400",_.className),onClick:w=>{w.stopPropagation(),m(`/tags/${x}`)},children:["#",x]},y)}let p=null;return h.startsWith("/")?p=h:h.startsWith(P)&&(p=h.replace(P,"")),p?(0,g.jsx)("span",{..._,className:$("cursor-pointer font-medium text-blue-600 hover:underline dark:text-blue-400",_.className),onClick:x=>{x.stopPropagation(),m(p)},children:y},y):(0,g.jsx)("a",{href:h,..._,target:"_blank",rel:"noopener noreferrer",className:$("text-blue-600 hover:underline dark:text-blue-400",_.className),onClick:it,children:y},y)}},t[4]=m,t[5]=f):f=t[5];let a;t[6]!==c||t[7]!==f?(a=(0,g.jsx)(X,{options:f,children:c}),t[6]=c,t[7]=f,t[8]=a):a=t[8];let o;return t[9]!==n||t[10]!==r||t[11]!==a?(o=(0,g.jsx)("div",{className:r,onClick:n,children:a}),t[9]=n,t[10]=r,t[11]=a,t[12]=o):o=t[12],o},Ct=ot;function at(e){return e.replace(/#([\u0980-\u09FF\w]+)/g,"https://internal.tag/$1")}function it(e){return e.stopPropagation()}var lt=L(),ct=e=>{const t=(0,lt.c)(24),{url:i,duration:u,isMe:n}=e,m=(0,C.useRef)(null),d=(0,C.useRef)(null),[l,c]=(0,C.useState)(!1),[r,f]=(0,C.useState)(!1),[a,o]=(0,C.useState)(0),[s,k]=(0,C.useState)(u||0);let y,h;t[0]!==u||t[1]!==n||t[2]!==i?(y=()=>{if(!m.current)return;const v=Y.create({container:m.current,waveColor:n?"rgba(255, 255, 255, 0.35)":"rgba(135, 116, 225, 0.25)",progressColor:n?"#ffffff":"#8774e1",cursorColor:"transparent",barWidth:2,barGap:3,barRadius:2,height:28,normalize:!0,url:i});return d.current=v,v.on("ready",()=>{f(!0),u||k(v.getDuration())}),v.on("play",()=>c(!0)),v.on("pause",()=>c(!1)),v.on("finish",()=>{c(!1),v.setTime(0),o(0)}),v.on("audioprocess",()=>o(v.getCurrentTime())),v.on("interaction",()=>o(v.getCurrentTime())),()=>v.destroy()},h=[i,n,u],t[0]=u,t[1]=n,t[2]=i,t[3]=y,t[4]=h):(y=t[3],h=t[4]),(0,C.useEffect)(y,h);let _;t[5]===Symbol.for("react.memo_cache_sentinel")?(_=v=>{v.stopPropagation(),d.current?.playPause()},t[5]=_):_=t[5];const P=_,p=ut,x=!r,w=n?"bg-white/20 text-white":"bg-[#8774e1] text-white";let b;t[6]!==w?(b=$("size-10 flex shrink-0 items-center justify-center rounded-full transition-all active:scale-90",w),t[6]=w,t[7]=b):b=t[7];let N;t[8]!==l||t[9]!==r?(N=r?l?(0,g.jsx)(B,{size:20,fill:"currentColor"}):(0,g.jsx)(z,{size:20,fill:"currentColor",className:"ml-0.5"}):(0,g.jsx)("span",{className:"animate-pulse font-bold",children:"..."}),t[8]=l,t[9]=r,t[10]=N):N=t[10];let S;t[11]!==x||t[12]!==b||t[13]!==N?(S=(0,g.jsx)("button",{type:"button",onClick:P,disabled:x,className:b,children:N}),t[11]=x,t[12]=b,t[13]=N,t[14]=S):S=t[14];let E;t[15]===Symbol.for("react.memo_cache_sentinel")?(E=(0,g.jsx)("div",{className:"h-7 w-full overflow-hidden",children:(0,g.jsx)("div",{ref:m,className:"w-full cursor-pointer"})}),t[15]=E):E=t[15];const U=n?"text-white/80":"text-[#8774e1]";let R;t[16]!==U?(R=$("text-[11px] font-medium mt-0.5 select-none tabular-nums",U),t[16]=U,t[17]=R):R=t[17];const A=l||a>0?p(a):p(s);let j;t[18]!==R||t[19]!==A?(j=(0,g.jsxs)("div",{className:"flex-1 flex flex-col justify-center min-w-0",children:[E,(0,g.jsx)("div",{className:R,children:A})]}),t[18]=R,t[19]=A,t[20]=j):j=t[20];let T;return t[21]!==j||t[22]!==S?(T=(0,g.jsxs)("div",{className:"flex items-center gap-3 py-1 min-w-[220px] md:min-w-[280px]",children:[S,j]}),t[21]=j,t[22]=S,t[23]=T):T=t[23],T},Pt=ct;function ut(e){return`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`}var ft=L(),mt=e=>{const t=(0,ft.c)(17),{src:i,poster:u}=e,n=(0,C.useRef)(null),{reportVisibility:m,unregister:d}=K(),{dataSaver:l}=J(),c=(0,C.useId)();let r;t[0]===Symbol.for("react.memo_cache_sentinel")?(r={play:()=>{const p=n.current?.plyr;p&&(p.muted=!0,p.play().catch(pt))},pause:()=>{const p=n.current?.plyr;p&&typeof p.pause=="function"&&p.pause()}},t[0]=r):r=t[0];const f=r;let a,o;t[1]!==l||t[2]!==c||t[3]!==m||t[4]!==d?(a=()=>{const p=new IntersectionObserver(b=>{const[N]=b;m(c,l?0:N.intersectionRatio,f)},{threshold:[0,.25,.5,.75,1]}),x=n.current?.elements?.container,w=n.current;return x&&p.observe(x),()=>{const b=w?.plyr;b&&typeof b.pause=="function"&&b.pause(),d(c),x&&p.unobserve(x)}},o=[c,m,d,f,l],t[1]=l,t[2]=c,t[3]=m,t[4]=d,t[5]=a,t[6]=o):(a=t[5],o=t[6]),(0,C.useEffect)(a,o);let s;t[7]!==i?(s=[{src:i,type:"video/mp4"}],t[7]=i,t[8]=s):s=t[8];let k;t[9]!==u||t[10]!==s?(k={type:"video",sources:s,poster:u},t[9]=u,t[10]=s,t[11]=k):k=t[11];let y;t[12]===Symbol.for("react.memo_cache_sentinel")?(y={controls:["play-large","play","progress","current-time","mute","volume","fullscreen"],settings:["quality","speed"],ratio:"16:9",clickToPlay:!0,hideControls:!0,resetOnEnd:!0},t[12]=y):y=t[12];let h;t[13]!==k?(h={source:k,options:y},t[13]=k,t[14]=h):h=t[14];const _=h;let P;return t[15]!==_?(P=(0,g.jsx)("div",{className:"w-full bg-black",onClick:dt,children:(0,g.jsx)(G,{ref:n,..._})}),t[15]=_,t[16]=P):P=t[16],P},Nt=mt;function pt(){}function dt(e){return e.stopPropagation()}export{kt as a,bt as i,Pt as n,Ct as r,Nt as t};
