import{a as oe}from"./rolldown-runtime-BaZ8gS7u.js";import{E as ce,b as de,c as xe,d as me}from"./framework-CsA6nn9m.js";import"./database-BiY55TQY.js";import{Jn as he,Jt as fe,On as pe,Pn as ue,Pt as je,Xt as be,Yn as ve,Zn as ge,hn as ze,vn as u}from"./ui-libs-Px4MBmNX.js";import"./media-libs-Btb8RX-I.js";import"./animations-T0TOZv2c.js";import{C as le,H as Ne,I as we,J as ne,K as ke,L as ye,Rt as Ce,S as Fe,T as Pe,V as _e,X as Me,Y as ie,Z as Se,at as Te,d as Le,f as Ie,g as De,h as $e,ht as re,it as Ee,m as Ue,p as We,q as Ae,rt as Oe,v as qe,vt as Be,w as He}from"./index-0Nj-jM9P.js";import"./VideoPlayer-BtC_qOtL.js";import{n as Je}from"./post-oiE9jMza.js";import{t as Ve}from"./text-processing-DFvQvkgt.js";import{t as Xe}from"./linkify-BIniK2-v.js";import{l as Re}from"./hooks-wSD5Qk1m.js";var Ye=xe(),Ze=oe(ce(),1),s=oe(me(),1),Ge=({profile:t,currentUser:e,isCurrentUser:q,onEditProfile:Z,isCommunity:B,onShowFollowers:G,onShowFollowing:H})=>{const{addToast:o}=Be(),{isFollowing:j,stats:m,loading:b,handleFollow:v}=ye(t,e?.id),h=de(),[c,n]=(0,Ze.useState)(!1),g=async()=>{if(!e){o("Please sign in to message users","info");return}n(!0);try{h(`/m/${await Ce(e.id,t.id)}`)}catch(i){console.error("Failed to start conversation:",i),o("Failed to open chat","error")}finally{n(!1)}};return(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("div",{className:"relative h-32 w-full bg-zinc-200 dark:bg-zinc-800 sm:h-48",children:[t.cover&&(0,s.jsx)("img",{src:t.cover,className:"h-full w-full object-cover transition-opacity duration-500",alt:"Cover"}),(0,s.jsx)("div",{className:"absolute -bottom-12 left-4 sm:-bottom-16 sm:left-6",children:(0,s.jsx)("div",{className:"relative rounded-full bg-white p-1 shadow-xl ring-4 ring-white dark:bg-black dark:ring-black",children:(0,s.jsxs)(Oe,{className:"size-24 sm:size-32",children:[(0,s.jsx)(Te,{src:t.avatar,alt:t.handle,className:"object-cover"}),(0,s.jsx)(Ee,{className:"text-4xl font-bold",children:t.handle?.[0]?.toUpperCase()})]})})})]}),(0,s.jsxs)("div",{className:"flex flex-col space-y-4 p-4 pt-16 sm:p-6 sm:pt-20",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsx)("div",{className:"min-w-0 flex-1 pr-4"}),(0,s.jsx)("div",{className:"flex shrink-0 gap-2",children:q?(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>Z?.(t),className:"flex size-10 items-center justify-center rounded-full border border-zinc-200 text-zinc-700 transition-all hover:bg-zinc-50 active:scale-95 dark:border-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-900",title:"Edit Profile",children:(0,s.jsx)(Le,{size:20})}),(0,s.jsx)("button",{onClick:()=>h("/settings"),className:"rounded-full border border-zinc-200 p-2 text-zinc-700 transition-all hover:bg-zinc-50 active:scale-95 dark:border-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-900",title:"Settings",children:(0,s.jsx)(De,{size:20})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:g,disabled:c,className:"rounded-full border border-zinc-200 p-2 text-zinc-700 transition-colors hover:bg-zinc-50 disabled:opacity-50 dark:border-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-900",children:c?(0,s.jsx)(u,{size:20,className:"animate-spin"}):(0,s.jsx)(ze,{size:20})}),(0,s.jsx)("button",{className:"rounded-full border border-zinc-200 p-2 text-zinc-700 transition-colors hover:bg-zinc-50 dark:border-zinc-700 dark:text-zinc-300 dark:hover:bg-zinc-900",children:(0,s.jsx)(he,{size:20})}),(0,s.jsx)(re,{variant:j?"secondary":"primary",onClick:v,className:"flex min-w-0 items-center gap-2 px-4 text-sm sm:min-w-[100px]",disabled:b,children:b?(0,s.jsx)(u,{size:16,className:"mx-auto animate-spin"}):j?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(We,{size:18}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Following"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Ie,{size:18}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Follow"})]})}),(0,s.jsxs)(ke,{children:[(0,s.jsx)(Se,{asChild:!0,children:(0,s.jsx)("button",{className:"rounded-full p-2 text-zinc-700 transition-colors hover:bg-zinc-100 dark:text-zinc-300 dark:hover:bg-zinc-800",children:(0,s.jsx)(ue,{size:20})})}),(0,s.jsxs)(Ae,{align:"end",className:"w-48",children:[(0,s.jsxs)(ne,{children:[(0,s.jsxs)(ie,{className:"cursor-pointer gap-2",onClick:()=>{navigator.clipboard.writeText(window.location.href),o("Profile link copied!")},children:[(0,s.jsx)(fe,{size:16}),"Share Profile"]}),(0,s.jsxs)(ie,{className:"cursor-pointer gap-2",onClick:()=>o("User reported","info"),children:[(0,s.jsx)(pe,{size:16}),"Report user"]})]}),(0,s.jsx)(Me,{}),(0,s.jsx)(ne,{children:(0,s.jsxs)(ie,{variant:"destructive",className:"cursor-pointer gap-2",onClick:()=>o("User blocked","info"),children:[(0,s.jsx)(ve,{size:16}),"Block user"]})})]})]})]})})]}),(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsxs)("div",{className:"mt-1 flex items-center gap-1.5",children:[(0,s.jsx)("h1",{className:"text-xl font-extrabold text-zinc-900 dark:text-zinc-100",children:t.name}),t.verified&&(0,s.jsx)(qe,{size:20,className:"text-blue-500"})]}),!B&&(0,s.jsx)("div",{className:"flex items-center space-x-3",children:(0,s.jsxs)("span",{className:"-ml-1.5 rounded-md px-1.5 py-0.5 text-sm font-medium text-zinc-500 dark:text-zinc-400",children:["@",t.handle]})})]}),(0,s.jsx)("div",{className:"whitespace-pre-line text-sm leading-relaxed text-zinc-900 dark:text-zinc-100 sm:text-[15px]",children:(0,s.jsx)(Ve,{options:{...Xe,render:({attributes:i,content:d})=>{const{href:r,...f}=i,z=!r.startsWith("/")&&(r.startsWith("http")||r.startsWith("www"));return r.startsWith("/u/")||r.startsWith("/tags/")||r.startsWith("/c/")||r.startsWith("/explore")?(0,s.jsx)("span",{...f,className:"cursor-pointer font-bold text-rose-500 hover:underline dark:text-rose-400",onClick:J=>{J.stopPropagation(),h(r)},children:d},d):(0,s.jsx)("a",{href:r,...f,target:z?"_blank":void 0,rel:z?"noopener noreferrer":void 0,children:d},d)}},children:t.bio})}),(t.website||t.location)&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-x-5 gap-y-2 pt-1 text-sm",children:[t.location&&(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)($e,{size:14}),t.location]}),t.website&&(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(Ue,{size:14}),(0,s.jsx)("a",{href:`https://${t.website}`,target:"_blank",rel:"noreferrer",className:"font-semibold text-black hover:underline dark:text-white",children:t.website})]})]}),(0,s.jsx)("div",{className:"relative z-10 flex gap-4 pt-2 text-sm sm:gap-6",children:B?(0,s.jsxs)("button",{className:"group flex cursor-pointer gap-x-1",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white",children:t.members}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Members"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:i=>{i.preventDefault(),i.stopPropagation(),H()},className:"group flex cursor-pointer gap-x-1",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white",children:m.following}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Following"})]}),(0,s.jsxs)("button",{onClick:i=>{i.preventDefault(),i.stopPropagation(),G()},className:"group flex cursor-pointer gap-x-1",children:[(0,s.jsx)("span",{className:"font-bold text-zinc-900 dark:text-white",children:m.followers}),(0,s.jsx)("span",{className:"text-zinc-500 dark:text-zinc-400",children:"Followers"})]})]})})]})]})},Ke=Ge,Qe=t=>{const e=(0,Ye.c)(76),{onEditProfile:q}=t,{handle:Z,profile:B,loading:G,activeProfileTab:H,setActiveProfileTab:o,loadingPosts:j,isFetchingMorePosts:m,hasMorePosts:b,filteredPosts:v,isFollowModalOpen:h,setIsFollowModalOpen:c,followModalType:n,followListData:g,isListLoading:i,isFetchingMoreFollows:d,hasMoreFollows:r,openFollowModal:f,fetchNextFollows:z,handlePostClick:J,handleUserClick:K,loadUserPosts:Q,currentUser:p,navigate:N}=Re();if(G){let a;return e[0]===Symbol.for("react.memo_cache_sentinel")?(a=(0,s.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,s.jsx)(u,{size:40,className:"animate-spin text-violet-500"})}),e[0]=a):a=e[0],a}if(!B){const a=`Try searching for another. The user @${Z} could not be found.`;let x;return e[1]!==a?(x=(0,s.jsx)("div",{className:"flex min-h-[600px] items-center justify-center overflow-hidden rounded-none border-zinc-100 bg-white dark:bg-black md:rounded-xl",children:(0,s.jsx)(_e,{title:"Account doesn't exist",message:a,icon:je})}),e[1]=a,e[2]=x):x=e[2],x}const l=B;let V;e[3]!==p||e[4]!==l.handle||e[5]!==v||e[6]!==J||e[7]!==K||e[8]!==b||e[9]!==m||e[10]!==Q||e[11]!==j?(V=a=>{const x=a===void 0?!1:a;return j?(0,s.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,s.jsx)(u,{className:"animate-spin text-violet-500",size:32})}):v.length>0?(0,s.jsxs)(s.Fragment,{children:[v.map(ae=>(0,s.jsx)(Je,{currentUser:p,...ae,onClick:()=>J(ae.id),onUserClick:K},ae.id)),b&&(0,s.jsx)("div",{className:"flex justify-center p-6",children:(0,s.jsxs)(re,{variant:"secondary",className:"w-full max-w-xs",onClick:()=>Q(!0),disabled:m,children:[m&&(0,s.jsx)(u,{size:18,className:"mr-2 animate-spin"}),"Load more posts"]})})]}):x?null:(0,s.jsxs)("div",{className:"flex animate-in fade-in flex-col items-center gap-4 p-20 text-center text-zinc-500 duration-500",children:[(0,s.jsx)("div",{className:"mb-2 rounded-full bg-zinc-50 p-6 ring-1 ring-zinc-100 dark:bg-zinc-900 dark:ring-zinc-800",children:(0,s.jsx)(be,{size:40,className:"text-zinc-300 dark:text-zinc-700"})}),(0,s.jsx)("h3",{className:"text-xl font-bold dark:text-white",children:"No posts yet"}),(0,s.jsxs)("p",{className:"max-w-[250px] text-sm text-zinc-500 dark:text-zinc-400",children:["When @",l.handle," shares posts, they will appear here."]})]})},e[3]=p,e[4]=l.handle,e[5]=v,e[6]=J,e[7]=K,e[8]=b,e[9]=m,e[10]=Q,e[11]=j,e[12]=V):V=e[12];const w=V;let k;e[13]!==N?(k=()=>N(-1),e[13]=N,e[14]=k):k=e[14];let X;e[15]===Symbol.for("react.memo_cache_sentinel")?(X=(0,s.jsx)(ge,{size:22}),e[15]=X):X=e[15];let y;e[16]!==k?(y=(0,s.jsx)("button",{onClick:k,className:"rounded-full p-1 transition-colors hover:bg-zinc-100 dark:text-white dark:hover:bg-zinc-800",children:X}),e[16]=k,e[17]=y):y=e[17];let C;e[18]!==l.name?(C=(0,s.jsx)("h5",{className:"text-lg font-bold leading-none dark:text-white",children:l.name}),e[18]=l.name,e[19]=C):C=e[19];const ee=l.follower_count||0;let F;e[20]!==ee?(F=(0,s.jsxs)("span",{className:"mt-0.5 text-xs text-zinc-500",children:[ee," Followers"]}),e[20]=ee,e[21]=F):F=e[21];let P;e[22]!==C||e[23]!==F?(P=(0,s.jsxs)("div",{className:"flex flex-col",children:[C,F]}),e[22]=C,e[23]=F,e[24]=P):P=e[24];let _;e[25]!==y||e[26]!==P?(_=(0,s.jsx)("div",{className:"sticky top-0 z-20 border-b border-zinc-100 bg-white/90 p-4 py-3 backdrop-blur-md dark:border-zinc-800 dark:bg-black/90 md:hidden",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4",children:[y,P]})}),e[25]=y,e[26]=P,e[27]=_):_=e[27];const se=p?.handle===l.handle;let M,S;e[28]!==f?(M=()=>f("Followers"),S=()=>f("Following"),e[28]=f,e[29]=M,e[30]=S):(M=e[29],S=e[30]);let T;e[31]!==p||e[32]!==l||e[33]!==q||e[34]!==se||e[35]!==M||e[36]!==S?(T=(0,s.jsx)(Ke,{profile:l,currentUser:p,isCurrentUser:se,onEditProfile:q,onShowFollowers:M,onShowFollowing:S}),e[31]=p,e[32]=l,e[33]=q,e[34]=se,e[35]=M,e[36]=S,e[37]=T):T=e[37];let R;e[38]===Symbol.for("react.memo_cache_sentinel")?(R=(0,s.jsx)("div",{className:"sticky top-[60px] z-10 border-b border-zinc-100 bg-white/90 backdrop-blur-md dark:border-zinc-800 dark:bg-black/90 md:top-0",children:(0,s.jsx)(He,{className:"hide-scrollbar h-auto w-full justify-start overflow-x-auto rounded-none bg-transparent p-0 px-2",children:["feed","media"].map(es)})}),e[38]=R):R=e[38];let L;e[39]!==w?(L=w(),e[39]=w,e[40]=L):L=e[40];let I;e[41]!==L?(I=(0,s.jsx)(le,{value:"feed",className:"m-0 border-none",children:L}),e[41]=L,e[42]=I):I=e[42];let D;e[43]!==w?(D=w(),e[43]=w,e[44]=D):D=e[44];let $;e[45]!==D?($=(0,s.jsx)(le,{value:"media",className:"m-0 border-none",children:D}),e[45]=D,e[46]=$):$=e[46];let E;e[47]!==H||e[48]!==o||e[49]!==I||e[50]!==$?(E=(0,s.jsxs)(Fe,{value:H,onValueChange:o,className:"w-full",children:[R,I,$]}),e[47]=H,e[48]=o,e[49]=I,e[50]=$,e[51]=E):E=e[51];let U;e[52]!==T||e[53]!==E||e[54]!==_?(U=(0,s.jsxs)("div",{className:"border-y border-zinc-100 dark:border-zinc-800 md:border-b-0",children:[_,T,E]}),e[52]=T,e[53]=E,e[54]=_,e[55]=U):U=e[55];let W;e[56]!==c?(W=()=>c(!1),e[56]=c,e[57]=W):W=e[57];const te=n==="Followers"?`People who follow @${l.handle}`:`People @${l.handle} follows`;let A;e[58]!==z||e[59]!==g||e[60]!==n||e[61]!==r||e[62]!==d||e[63]!==i||e[64]!==N||e[65]!==c?(A=(0,s.jsx)("div",{className:"flex max-h-[75vh] flex-col overflow-y-auto",children:(0,s.jsx)("div",{className:"min-h-[300px]",children:i?(0,s.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,s.jsx)(u,{className:"animate-spin text-violet-500",size:32})}):g.length>0?(0,s.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:[g.map(a=>(0,s.jsx)(we,{profile:a,onUserClick:x=>{c(!1),N(`/u/${x}`)}},a.id)),r&&(0,s.jsx)("div",{className:"flex justify-center p-4",children:(0,s.jsxs)(re,{variant:"secondary",className:"w-full text-xs",onClick:()=>z(),disabled:d,children:[d?(0,s.jsx)(u,{size:14,className:"mr-2 animate-spin"}):null,"Load more"]})})]}):(0,s.jsx)("div",{className:"flex flex-col items-center justify-center py-20 text-zinc-500",children:(0,s.jsxs)("p",{className:"font-medium",children:["No ",n.toLowerCase()," yet."]})})})}),e[58]=z,e[59]=g,e[60]=n,e[61]=r,e[62]=d,e[63]=i,e[64]=N,e[65]=c,e[66]=A):A=e[66];let O;e[67]!==n||e[68]!==h||e[69]!==W||e[70]!==te||e[71]!==A?(O=(0,s.jsx)(Ne,{isOpen:h,onClose:W,title:n,description:te,className:"sm:max-w-md",children:A}),e[67]=n,e[68]=h,e[69]=W,e[70]=te,e[71]=A,e[72]=O):O=e[72];let Y;return e[73]!==U||e[74]!==O?(Y=(0,s.jsxs)("div",{className:"min-h-screen overflow-hidden rounded-none border-zinc-100 bg-white pb-20 dark:bg-black dark:border-zinc-800 md:rounded-xl",children:[U,O]}),e[73]=U,e[74]=O,e[75]=Y):Y=e[75],Y},hs=Qe;function es(t){return(0,s.jsx)(Pe,{value:t,className:"flex-1 whitespace-nowrap rounded-none border-b-2 px-4 py-4 text-sm font-bold capitalize text-zinc-500 transition-all data-[state=active]:border-black data-[state=active]:text-black dark:data-[state=active]:border-white dark:data-[state=active]:text-white",children:t==="feed"?"Posts":t},t)}export{hs as default};
