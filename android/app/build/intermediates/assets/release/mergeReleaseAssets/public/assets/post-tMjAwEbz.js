import{a as It}from"./rolldown-runtime-BaZ8gS7u.js";import{c as Y,d as Yt,l as es,n as ts,v as Lt,w as ss}from"./framework-3lkjbTvb.js";import{a as ls,r as is}from"./query-CZHA9T67.js";import{$t as as,At as $e,Bn as ns,Dn as rs,En as os,Fn as Le,Gn as cs,Gt as rt,Hn as ds,Ht as ms,Jn as fs,Kn as Be,Ln as ot,Lt as ct,Sn as us,Un as xs,Vt as dt,Zt as mt,an as Ae,cn as ft,dn as hs,er as ps,gn as gs,hn as bs,in as vs,on as We,pn as js,rn as qe,sn as ut,un as ys,yn as At,zn as He,zt as ks}from"./ui-libs-oBja7Jpd.js";import{n as zs}from"./media-libs-C98UjHPF.js";import{Cn as Ns,Dn as ws,En as xt,Et as Cs,Gt as ht,Hn as pt,In as Se,Jt as gt,Kt as bt,Ln as Ge,Mn as Ss,N as _s,On as $s,Pn as _e,Pt as Ps,R as Ts,Rn as Me,Sn as Fs,St as Rs,Tt as Ms,Un as Es,Ut as Dt,Wt as vt,Xt as jt,Yt as yt,Zt as kt,_ as Is,_n as Ls,cn as As,ct as Ds,dn as Ot,dt as Os,en as G,et as Us,fn as Vs,g as zt,gn as Bs,gt as Ut,hn as Nt,in as ze,it as Ws,ln as Xe,nn as Ne,on as Vt,qt as wt,rn as we,rt as qs,sn as Hs,st as Gs,tn as Qe,tt as Bt,ut as De,v as Qs,wn as Wt,wt as ye,xn as Js,xt as Ks,z as Xs}from"./index-Dx8YIyON.js";import{a as Zs,i as Je,n as Ct,r as Ze}from"./VideoPlayer-CEJXf_tI.js";import{n as ke,t as Ys}from"./actionsheet-Bc1363kU.js";var el=Y(),z=It(ss(),1),t=It(es(),1),tl=l=>{const e=(0,el.c)(37),{isComment:s,liked:r,reposted:i,handleLike:a,handleRepost:o,handleCommentClick:n,handleShareClick:c,isDetail:h}=l;if(h!==void 0&&h){let w;e[0]!==a||e[1]!==r?(w=(0,t.jsx)(ve,{icon:Le,label:"Like",type:"like",onClick:a,active:r}),e[0]=a,e[1]=r,e[2]=w):w=e[2];let N;e[3]!==o||e[4]!==s||e[5]!==i?(N=!s&&(0,t.jsx)(ve,{icon:qe,label:"Repost",type:"repost",onClick:o,active:i}),e[3]=o,e[4]=s,e[5]=i,e[6]=N):N=e[6];let $;e[7]!==n?($=(0,t.jsx)(ve,{icon:Bt,label:"Comment",type:"comment",onClick:n}),e[7]=n,e[8]=$):$=e[8];let C;e[9]!==c||e[10]!==s?(C=!s&&(0,t.jsx)(ve,{icon:De,label:"Share",type:"share",onClick:c}),e[9]=c,e[10]=s,e[11]=C):C=e[11];let f;return e[12]!==w||e[13]!==N||e[14]!==$||e[15]!==C?(f=(0,t.jsxs)("div",{className:"mt-5 flex w-full items-center justify-around py-2",children:[w,N,$,C]}),e[12]=w,e[13]=N,e[14]=$,e[15]=C,e[16]=f):f=e[16],f}const g=`flex items-center gap-x-1.5 ${s?"mt-2":"mt-3.5"}`,m=s?16:18;let x;e[17]!==a||e[18]!==r||e[19]!==m?(x=(0,t.jsx)(ve,{icon:Le,size:m,type:"like",onClick:a,active:r}),e[17]=a,e[18]=r,e[19]=m,e[20]=x):x=e[20];const u=s?16:18;let d;e[21]!==n||e[22]!==u?(d=(0,t.jsx)(ve,{icon:At,size:u,type:"comment",onClick:n}),e[21]=n,e[22]=u,e[23]=d):d=e[23];const v=s?16:18;let b;e[24]!==o||e[25]!==i||e[26]!==v?(b=(0,t.jsx)(ve,{icon:qe,size:v,type:"repost",onClick:o,active:i}),e[24]=o,e[25]=i,e[26]=v,e[27]=b):b=e[27];let p;e[28]!==c||e[29]!==s?(p=!s&&c&&(0,t.jsx)(ve,{icon:De,type:"share",onClick:c}),e[28]=c,e[29]=s,e[30]=p):p=e[30];let j;return e[31]!==g||e[32]!==x||e[33]!==d||e[34]!==b||e[35]!==p?(j=(0,t.jsxs)("div",{className:g,children:[x,d,b,p]}),e[31]=g,e[32]=x,e[33]=d,e[34]=b,e[35]=p,e[36]=j):j=e[36],j},St=tl,sl=Y(),ll=l=>{const e=(0,sl.c)(38),{views:s,likes:r,comments:i,isDetail:a,isComment:o,onRepliesClick:n}=l,c=a===void 0?!1:a,h=o===void 0?!1:o;if(c){const b=s||0;let p;e[0]!==b?(p=(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:b}),e[0]=b,e[1]=p):p=e[1];let j;e[2]===Symbol.for("react.memo_cache_sentinel")?(j=(0,t.jsx)("span",{className:"opacity-70",children:"Views"}),e[2]=j):j=e[2];let w;e[3]!==p?(w=(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[p," ",j]}),e[3]=p,e[4]=w):w=e[4];const N=r||0;let $;e[5]!==N?($=(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:N}),e[5]=N,e[6]=$):$=e[6];let C;e[7]===Symbol.for("react.memo_cache_sentinel")?(C=(0,t.jsx)("span",{className:"opacity-70",children:"Likes"}),e[7]=C):C=e[7];let f;e[8]!==$?(f=(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[$," ",C]}),e[8]=$,e[9]=f):f=e[9];const R=i||0;let E;e[10]!==R?(E=(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:R}),e[10]=R,e[11]=E):E=e[11];let T;e[12]===Symbol.for("react.memo_cache_sentinel")?(T=(0,t.jsx)("span",{className:"opacity-70",children:"Comments"}),e[12]=T):T=e[12];let y;e[13]!==E?(y=(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[E," ",T]}),e[13]=E,e[14]=y):y=e[14];let P;return e[15]!==f||e[16]!==y||e[17]!==w?(P=(0,t.jsxs)("div",{className:"mt-5 flex items-center gap-x-6 border-b border-zinc-100 pb-4 text-sm text-zinc-500 dark:border-zinc-800 dark:text-zinc-400",children:[w,f,y]}),e[15]=f,e[16]=y,e[17]=w,e[18]=P):P=e[18],P}if(i===0&&r===0&&(s===0||h))return null;const g=`mt-2 flex items-center gap-x-2 px-0.5 ${h?"text-[12px]":"text-[14px]"} font-medium text-zinc-500 dark:text-zinc-400`;let m;e[19]!==i||e[20]!==h||e[21]!==r||e[22]!==s?(m=s>0&&!h&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{className:"hover:underline",children:[s," ",s===1?"view":"views"]}),(i>0||r>0)&&(0,t.jsx)("span",{className:"opacity-50",children:"·"})]}),e[19]=i,e[20]=h,e[21]=r,e[22]=s,e[23]=m):m=e[23];let x;e[24]!==i||e[25]!==n?(x=i>0&&(0,t.jsxs)("button",{className:"hover:underline",onClick:b=>{b.stopPropagation(),n&&n(b)},children:[i," ",i===1?"reply":"replies"]}),e[24]=i,e[25]=n,e[26]=x):x=e[26];let u;e[27]!==i||e[28]!==r?(u=i>0&&r>0&&(0,t.jsx)("span",{className:"opacity-50",children:"·"}),e[27]=i,e[28]=r,e[29]=u):u=e[29];let d;e[30]!==r?(d=r>0&&(0,t.jsxs)("button",{className:"hover:underline",children:[r," ",r===1?"like":"likes"]}),e[30]=r,e[31]=d):d=e[31];let v;return e[32]!==g||e[33]!==m||e[34]!==x||e[35]!==u||e[36]!==d?(v=(0,t.jsxs)("div",{className:g,children:[m,x,u,d]}),e[32]=g,e[33]=m,e[34]=x,e[35]=u,e[36]=d,e[37]=v):v=e[37],v},_t=ll,il=Y(),al=l=>{const e=(0,il.c)(53),{user:s,timeAgo:r,community:i,onUserClick:a,actionsMenu:o,isComment:n,isDetail:c,showAvatar:h,isPinned:g}=l,m=h===void 0?!1:h,x=g===void 0?!1:g,u=Lt();let d;e[0]!==a||e[1]!==s.handle?(d=A=>{A.stopPropagation(),a&&a(s.handle)},e[0]=a,e[1]=s.handle,e[2]=d):d=e[2];const v=d;let b;e[3]!==i||e[4]!==u?(b=A=>{A.stopPropagation(),i&&u(`/c/${i.handle}`)},e[3]=i,e[4]=u,e[5]=b):b=e[5];const p=b,j=`flex items-center justify-between ${c?"pb-5":"min-h-[40px] mb-2"}`;let w;e[6]!==v||e[7]!==n||e[8]!==c||e[9]!==m||e[10]!==s.avatar||e[11]!==s.handle?(w=m&&(0,t.jsx)("button",{className:"shrink-0",onClick:v,children:(0,t.jsxs)(Ne,{className:`${c?"size-12":n?"size-8":"size-10"} border-0 shadow-sm`,children:[(0,t.jsx)(ze,{src:s.avatar,alt:s.handle,className:"object-cover"}),(0,t.jsx)(we,{className:"text-xs",children:s.handle[0]?.toUpperCase()})]})}),e[6]=v,e[7]=n,e[8]=c,e[9]=m,e[10]=s.avatar,e[11]=s.handle,e[12]=w):w=e[12];const N=`flex shrink-0 items-center gap-1 font-bold text-zinc-900 hover:underline dark:text-white ${c?"text-base sm:text-lg":n?"text-[14px]":"text-[15px]"}`;let $;e[13]!==s.handle?($=(0,t.jsx)("span",{className:"max-w-[150px] truncate sm:max-w-none",children:s.handle}),e[13]=s.handle,e[14]=$):$=e[14];let C;e[15]!==n||e[16]!==c||e[17]!==s.role?(C=s.role==="admin"&&(0,t.jsx)(Us,{size:c?28:n?22:24}),e[15]=n,e[16]=c,e[17]=s.role,e[18]=C):C=e[18];let f;e[19]!==n||e[20]!==c||e[21]!==s.isPro||e[22]!==s.verified?(f=s.verified?(0,t.jsx)(Os,{size:c?16:n?12:14}):s.isPro&&(0,t.jsx)(Ds,{size:c?16:n?12:14}),e[19]=n,e[20]=c,e[21]=s.isPro,e[22]=s.verified,e[23]=f):f=e[23];let R;e[24]!==v||e[25]!==f||e[26]!==N||e[27]!==$||e[28]!==C?(R=(0,t.jsxs)("button",{className:N,onClick:v,children:[$,C,f]}),e[24]=v,e[25]=f,e[26]=N,e[27]=$,e[28]=C,e[29]=R):R=e[29];let E;e[30]!==i||e[31]!==p||e[32]!==c?(E=i&&(0,t.jsxs)("div",{className:"flex min-w-0 items-center gap-1 text-zinc-500",children:[(0,t.jsx)("span",{className:"text-zinc-400",children:"›"}),(0,t.jsxs)("button",{className:`flex items-center gap-1 font-bold text-zinc-900 hover:underline dark:text-zinc-100 ${c?"text-[14px] sm:text-[15px]":"text-[13px]"}`,onClick:p,children:[(0,t.jsxs)(Ne,{className:"size-5 shrink-0",children:[(0,t.jsx)(ze,{src:i.avatar,alt:i.name,className:"object-cover"}),(0,t.jsx)(we,{className:"text-[8px] font-bold text-zinc-500",children:i.name?.[0]?.toUpperCase()})]}),(0,t.jsx)("span",{className:"max-w-[150px] truncate sm:max-w-none",children:i.name})]})]}),e[30]=i,e[31]=p,e[32]=c,e[33]=E):E=e[33];let T;e[34]!==R||e[35]!==E?(T=(0,t.jsx)("div",{className:"flex min-w-0 flex-1 flex-col",children:(0,t.jsx)("div",{className:"flex flex-wrap items-start gap-x-1.5 leading-none sm:items-center",children:(0,t.jsxs)("div",{className:"flex min-w-0 max-w-full flex-col gap-y-1 sm:flex-row sm:items-center sm:gap-x-1.5",children:[R,E]})})}),e[34]=R,e[35]=E,e[36]=T):T=e[36];let y;e[37]!==T||e[38]!==w?(y=(0,t.jsxs)("div",{className:"flex items-center gap-x-3.5 flex-1 min-w-0",children:[w,T]}),e[37]=T,e[38]=w,e[39]=y):y=e[39];let P;e[40]!==n||e[41]!==x?(P=x&&!n&&(0,t.jsx)("div",{className:"flex items-center justify-center p-1 opacity-80",children:(0,t.jsx)(We,{size:14,className:"fill-zinc-400 text-zinc-400 dark:fill-zinc-500 dark:text-zinc-500"})}),e[40]=n,e[41]=x,e[42]=P):P=e[42];const S=r||"Recent";let M;e[43]!==S?(M=(0,t.jsx)("span",{className:"whitespace-nowrap text-[12px] text-zinc-500 dark:text-zinc-400",children:S}),e[43]=S,e[44]=M):M=e[44];let I;e[45]!==o||e[46]!==P||e[47]!==M?(I=(0,t.jsxs)("div",{className:"-mt-1 flex items-center gap-2.5",children:[P,M,o]}),e[45]=o,e[46]=P,e[47]=M,e[48]=I):I=e[48];let D;return e[49]!==y||e[50]!==I||e[51]!==j?(D=(0,t.jsxs)("div",{className:j,children:[y,I]}),e[49]=y,e[50]=I,e[51]=j,e[52]=D):D=e[52],D},$t=al,nl=Y(),rl=l=>{const e=(0,nl.c)(40),{content:s,isDetail:r,isEditing:i,editedContent:a,setEditedContent:o,onCancelEdit:n,onSaveEdit:c,isUpdating:h,contentClass:g}=l,[m,x]=(0,z.useState)(!1),u=typeof s=="string"&&pt(s);if(i&&o){let R;e[0]!==o?(R=A=>o(A.target.value),e[0]=o,e[1]=R):R=e[1];const E=`min-h-[100px] w-full rounded-xl border-zinc-200 bg-zinc-50 focus:ring-violet-500 dark:border-zinc-800 dark:bg-zinc-900 ${pt(a||"")?"font-bangla text-lg":"font-english"}`;let T;e[2]!==a||e[3]!==R||e[4]!==E?(T=(0,t.jsx)(_s,{value:a,onChange:R,className:E,autoFocus:!0}),e[2]=a,e[3]=R,e[4]=E,e[5]=T):T=e[5];let y;e[6]!==n?(y=(0,t.jsx)("button",{onClick:n,className:"px-4 py-1.5 text-sm font-bold text-zinc-500 transition-colors hover:text-zinc-700 dark:hover:text-zinc-300",children:"Cancel"}),e[6]=n,e[7]=y):y=e[7];let P;e[8]!==s||e[9]!==a||e[10]!==h?(P=h||!a?.trim()||a===s,e[8]=s,e[9]=a,e[10]=h,e[11]=P):P=e[11];const S=h?"Saving...":"Save";let M;e[12]!==c||e[13]!==P||e[14]!==S?(M=(0,t.jsx)("button",{onClick:c,disabled:P,className:"rounded-full bg-violet-600 px-4 py-1.5 text-sm font-bold text-white transition-all hover:bg-violet-700 disabled:opacity-50 active:scale-95",children:S}),e[12]=c,e[13]=P,e[14]=S,e[15]=M):M=e[15];let I;e[16]!==y||e[17]!==M?(I=(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[y,M]}),e[16]=y,e[17]=M,e[18]=I):I=e[18];let D;return e[19]!==T||e[20]!==I?(D=(0,t.jsxs)("div",{className:"mt-2 flex flex-col gap-2",onClick:ol,children:[T,I]}),e[19]=T,e[20]=I,e[21]=D):D=e[21],D}const d=!r&&s.length>280;let v;e[22]!==s||e[23]!==m||e[24]!==d?(v=d&&!m?s.substring(0,280):s,e[22]=s,e[23]=m,e[24]=d,e[25]=v):v=e[25];const b=v,p=r?"text-lg leading-relaxed sm:text-xl sm:leading-8 mt-1":"text-[15px] leading-snug mt-0.5",j=u?"font-bangla text-[1.15em]":"font-english";let w;e[26]!==g||e[27]!==p||e[28]!==j?(w=Se("whitespace-pre-line break-words",p,j,g),e[26]=g,e[27]=p,e[28]=j,e[29]=w):w=e[29];let N;e[30]!==b?(N=(0,t.jsx)(Ze,{content:b}),e[30]=b,e[31]=N):N=e[31];const $=d&&!m&&"...";let C;e[32]!==m||e[33]!==d?(C=d&&(0,t.jsx)("button",{onClick:R=>{R.stopPropagation(),x(!m)},className:"ml-1 cursor-pointer font-bold text-rose-600 hover:underline dark:text-rose-400",children:m?"Show less":"See more"}),e[32]=m,e[33]=d,e[34]=C):C=e[34];let f;return e[35]!==w||e[36]!==N||e[37]!==$||e[38]!==C?(f=(0,t.jsxs)("div",{className:w,children:[N,$,C]}),e[35]=w,e[36]=N,e[37]=$,e[38]=C,e[39]=f):f=e[39],f},Pt=rl;function ol(l){return l.stopPropagation()}var cl=Y(),dl=l=>{const e=(0,cl.c)(28),{media:s,isEditing:r,editedMedia:i,setEditedMedia:a,newFiles:o,setNewFiles:n}=l;let c;e[0]!==i?(c=i===void 0?[]:i,e[0]=i,e[1]=c):c=e[1];const h=c;let g;e[2]!==o?(g=o===void 0?[]:o,e[2]=o,e[3]=g):g=e[3];const m=g,x=(0,z.useRef)(null);if(r&&a&&n){let d;if(e[4]!==h||e[5]!==a){let N;e[7]!==a?(N=($,C)=>(0,t.jsxs)("div",{className:"group relative aspect-square overflow-hidden rounded-xl border border-zinc-200 dark:border-zinc-800",children:[$.type==="video"?(0,t.jsx)("div",{className:"flex size-full items-center justify-center bg-zinc-100 dark:bg-zinc-900",children:(0,t.jsx)(ns,{size:24,className:"text-zinc-400"})}):(0,t.jsx)("img",{src:$.url||$.src,className:"size-full object-cover",alt:""}),(0,t.jsx)("button",{onClick:f=>{f.stopPropagation(),a(R=>R.filter((E,T)=>T!==C))},className:"absolute right-1.5 top-1.5 flex size-7 items-center justify-center rounded-full bg-black/60 text-white transition-colors hover:bg-black",children:(0,t.jsx)($e,{size:16})})]},`old-${C}`),e[7]=a,e[8]=N):N=e[8],d=h.map(N),e[4]=h,e[5]=a,e[6]=d}else d=e[6];let v;if(e[9]!==m||e[10]!==n){let N;e[12]!==n?(N=($,C)=>(0,t.jsxs)("div",{className:"group relative aspect-square overflow-hidden rounded-xl border-2 border-dashed border-violet-500 bg-violet-50/10",children:[$.type.startsWith("image/")?(0,t.jsx)("img",{src:URL.createObjectURL($),className:"size-full object-cover",alt:""}):(0,t.jsx)("div",{className:"flex size-full items-center justify-center",children:(0,t.jsx)(os,{size:24,className:"animate-spin text-violet-500"})}),(0,t.jsx)("button",{onClick:f=>{f.stopPropagation(),n(R=>R.filter((E,T)=>T!==C))},className:"absolute right-1.5 top-1.5 flex size-7 items-center justify-center rounded-full bg-black/60 text-white transition-colors hover:bg-black",children:(0,t.jsx)($e,{size:16})}),(0,t.jsx)("div",{className:"absolute bottom-1 left-1 rounded bg-violet-600 px-1 text-[8px] font-bold text-white",children:"NEW"})]},`new-${C}`),e[12]=n,e[13]=N):N=e[13],v=m.map(N),e[9]=m,e[10]=n,e[11]=v}else v=e[11];let b;e[14]!==h.length||e[15]!==m.length?(b=h.length+m.length<4&&(0,t.jsxs)("button",{onClick:N=>{N.stopPropagation(),x.current?.click()},className:"relative flex aspect-square flex-col items-center justify-center gap-1 rounded-xl border-2 border-dashed border-zinc-200 text-zinc-400 transition-all hover:border-violet-500 hover:bg-violet-50/5 hover:text-violet-500 dark:border-zinc-800",children:[(0,t.jsx)(vs,{size:20}),(0,t.jsx)("span",{className:"text-[10px] font-bold",children:"Add Media"})]}),e[14]=h.length,e[15]=m.length,e[16]=b):b=e[16];let p;e[17]!==d||e[18]!==v||e[19]!==b?(p=(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:[d,v,b]}),e[17]=d,e[18]=v,e[19]=b,e[20]=p):p=e[20];let j;e[21]!==n?(j=(0,t.jsx)("input",{type:"file",ref:x,onChange:N=>{if(N.target.files){const $=Array.from(N.target.files);n(C=>[...C,...$])}},multiple:!0,className:"hidden",accept:"image/*,video/*"}),e[21]=n,e[22]=j):j=e[22];let w;return e[23]!==p||e[24]!==j?(w=(0,t.jsxs)("div",{className:"mt-3 space-y-3",children:[p,j]}),e[23]=p,e[24]=j,e[25]=w):w=e[25],w}if(!s||s.length===0)return null;let u;return e[26]!==s?(u=(0,t.jsx)(El,{items:s}),e[26]=s,e[27]=u):u=e[27],u},Tt=dl,ml=Y(),fl=l=>{const e=(0,ml.c)(48),{icon:s,count:r,label:i,onClick:a,active:o,activeColorClass:n,size:c,type:h}=l,g=c===void 0?18:c,m=h===void 0?"default":h;let x,u,d,v,b,p,j;if(e[0]!==o||e[1]!==n||e[2]!==r||e[3]!==i||e[4]!==a||e[5]!==m){const I={like:{hoverBg:"group-hover:bg-rose-500/10",hoverText:"group-hover:text-rose-500",activeText:"text-rose-500",activeFill:"fill-rose-500"},repost:{hoverBg:"group-hover:bg-emerald-500/10",hoverText:"group-hover:text-emerald-500",activeText:"text-emerald-500",activeFill:"fill-emerald-500"},comment:{hoverBg:"group-hover:bg-sky-500/10",hoverText:"group-hover:text-sky-500",activeText:"text-sky-500",activeFill:"fill-sky-500"},share:{hoverBg:"group-hover:bg-violet-500/10",hoverText:"group-hover:text-violet-500",activeText:"text-violet-500",activeFill:"fill-violet-500"},default:{hoverBg:"group-hover:bg-zinc-500/10",hoverText:"group-hover:text-zinc-500",activeText:"text-zinc-900 dark:text-white",activeFill:"fill-current"}};u=I[m]||I.default;const D=n||u.activeText;x=G.button,e[13]===Symbol.for("react.memo_cache_sentinel")?(v={scale:.85},e[13]=v):v=e[13],e[14]!==a?(b=A=>{A.stopPropagation(),a&&a(A)},e[14]=a,e[15]=b):b=e[15],p=`${i} ${r!==void 0?`(${r})`:""}`,j=Se("group -ml-2 flex items-center gap-x-0.5 rounded-xl px-2 py-1.5 text-[12px] font-bold transition-all sm:gap-x-1 sm:text-[13px]",o?D:"text-zinc-500",!o&&u.hoverText),d=Se("rounded-full p-2 transition-all duration-200",!o&&u.hoverBg),e[0]=o,e[1]=n,e[2]=r,e[3]=i,e[4]=a,e[5]=m,e[6]=x,e[7]=u,e[8]=d,e[9]=v,e[10]=b,e[11]=p,e[12]=j}else x=e[6],u=e[7],d=e[8],v=e[9],b=e[10],p=e[11],j=e[12];let w;e[16]!==o?(w=o?{scale:[1,1.4,1],rotate:[0,15,0]}:{scale:1},e[16]=o,e[17]=w):w=e[17];let N;e[18]===Symbol.for("react.memo_cache_sentinel")?(N={duration:.45,type:"spring",stiffness:300,damping:15},e[18]=N):N=e[18];const $=o?2.5:2,C=o&&u.activeFill;let f;e[19]!==C?(f=Se("transition-colors duration-200",C),e[19]=C,e[20]=f):f=e[20];let R;e[21]!==s||e[22]!==g||e[23]!==$||e[24]!==f?(R=(0,t.jsx)(s,{size:g,strokeWidth:$,className:f}),e[21]=s,e[22]=g,e[23]=$,e[24]=f,e[25]=R):R=e[25];let E;e[26]!==R||e[27]!==w?(E=(0,t.jsx)(G.div,{animate:w,transition:N,children:R}),e[26]=R,e[27]=w,e[28]=E):E=e[28];let T;e[29]!==E||e[30]!==d?(T=(0,t.jsx)("div",{className:d,children:E}),e[29]=E,e[30]=d,e[31]=T):T=e[31];let y;e[32]!==i?(y=i&&(0,t.jsx)("span",{className:"hidden xs:inline",children:i}),e[32]=i,e[33]=y):y=e[33];let P;e[34]!==o||e[35]!==r?(P=r!=null&&(0,t.jsx)(G.span,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},className:Se("transition-all",o?"font-black":"font-bold"),children:r||0},r),e[34]=o,e[35]=r,e[36]=P):P=e[36];let S;e[37]!==P?(S=(0,t.jsx)(Qe,{mode:"wait",children:P}),e[37]=P,e[38]=S):S=e[38];let M;return e[39]!==x||e[40]!==T||e[41]!==y||e[42]!==S||e[43]!==v||e[44]!==b||e[45]!==p||e[46]!==j?(M=(0,t.jsxs)(x,{whileTap:v,onClick:b,"aria-label":p,className:j,children:[T,y,S]}),e[39]=x,e[40]=T,e[41]=y,e[42]=S,e[43]=v,e[44]=b,e[45]=p,e[46]=j,e[47]=M):M=e[47],M},ve=fl,ul=Y(),xl=l=>{const e=(0,ul.c)(18),{poll:s,onVote:r}=l,i=s.options.reduce(hl,0),[a,o]=(0,z.useState)(null);let n;e[0]!==r||e[1]!==a?(n=d=>{a||(o(d),r&&r(d))},e[0]=r,e[1]=a,e[2]=n):n=e[2];const c=n;let h;if(e[3]!==c||e[4]!==s.options||e[5]!==i||e[6]!==a){let d;e[8]!==c||e[9]!==i||e[10]!==a?(d=(v,b)=>{const p=i>0?Math.round((v.votes+(a===v.id?1:0))/(i+(a?1:0))*100):0,j=a===v.id;return(0,t.jsxs)("div",{onClick:()=>c(v.id),className:`relative h-10 w-full overflow-hidden rounded-xl border cursor-pointer ${j?"border-violet-500 dark:border-violet-500":"border-zinc-200 dark:border-zinc-700"}`,children:[a&&(0,t.jsx)("div",{className:"absolute left-0 top-0 h-full bg-zinc-200 transition-all duration-500 dark:bg-zinc-800",style:{width:`${p}%`}}),(0,t.jsxs)("div",{className:"absolute inset-0 z-10 flex items-center justify-between px-4",children:[(0,t.jsxs)("span",{className:`text-sm font-medium ${j?"font-bold text-violet-600":"text-zinc-700 dark:text-zinc-200"}`,children:[v.text," ",j&&(0,t.jsx)(ps,{size:14,className:"mb-0.5 inline ml-1"})]}),a&&(0,t.jsxs)("span",{className:"text-sm font-bold text-zinc-900 dark:text-white",children:[p,"%"]})]})]},v.id||b)},e[8]=c,e[9]=i,e[10]=a,e[11]=d):d=e[11],h=s.options.map(d),e[3]=c,e[4]=s.options,e[5]=i,e[6]=a,e[7]=h}else h=e[7];const g=i+(a?1:0),m=a?"6 days left":"Click to vote";let x;e[12]!==g||e[13]!==m?(x=(0,t.jsxs)("div",{className:"pl-1 text-xs text-zinc-500 dark:text-zinc-400",children:[g," votes •"," ",m]}),e[12]=g,e[13]=m,e[14]=x):x=e[14];let u;return e[15]!==h||e[16]!==x?(u=(0,t.jsxs)("div",{className:"mt-3 space-y-2",children:[h,x]}),e[15]=h,e[16]=x,e[17]=u):u=e[17],u},Ft=xl;function hl(l,e){return l+e.votes}var pl=Y(),gl=l=>{const e=(0,pl.c)(25),{user:s,time:r,content:i}=l;let a;e[0]!==s.avatar||e[1]!==s.handle?(a=(0,t.jsx)(ze,{src:s.avatar,alt:s.handle}),e[0]=s.avatar,e[1]=s.handle,e[2]=a):a=e[2];let o;e[3]!==s.handle[0]?(o=s.handle[0]?.toUpperCase(),e[3]=s.handle[0],e[4]=o):o=e[4];let n;e[5]!==o?(n=(0,t.jsx)(we,{children:o}),e[5]=o,e[6]=n):n=e[6];let c;e[7]!==a||e[8]!==n?(c=(0,t.jsxs)(Ne,{className:"size-6",children:[a,n]}),e[7]=a,e[8]=n,e[9]=c):c=e[9];let h;e[10]!==s.handle?(h=(0,t.jsx)("span",{className:"text-sm font-semibold",children:s.handle}),e[10]=s.handle,e[11]=h):h=e[11];let g;e[12]!==c||e[13]!==h?(g=(0,t.jsxs)("div",{className:"flex items-center gap-x-2",children:[c,h]}),e[12]=c,e[13]=h,e[14]=g):g=e[14];let m;e[15]!==r?(m=(0,t.jsx)("span",{className:"text-xs text-zinc-500 sm:text-sm",children:r}),e[15]=r,e[16]=m):m=e[16];let x;e[17]!==g||e[18]!==m?(x=(0,t.jsxs)("div",{className:"mb-2 flex items-center justify-between gap-x-2",children:[g,m]}),e[17]=g,e[18]=m,e[19]=x):x=e[19];let u;e[20]!==i?(u=(0,t.jsx)(Ze,{content:i,className:"text-sm text-zinc-800 dark:text-zinc-300"}),e[20]=i,e[21]=u):u=e[21];let d;return e[22]!==x||e[23]!==u?(d=(0,t.jsxs)("div",{className:"p-4",children:[x,u]}),e[22]=x,e[23]=u,e[24]=d):d=e[24],d},Rt=gl,bl=Y(),vl=l=>{const e=(0,bl.c)(92),{currentUser:s,newComment:r,setNewComment:i,handleSubmitComment:a,loading:o,selectedFiles:n,setSelectedFiles:c,isUploading:h}=l;let g;e[0]!==n?(g=n===void 0?[]:n,e[0]=n,e[1]=g):g=e[1];const m=g,x=(0,z.useRef)(null),{isRecording:u,recordingTime:d,startRecording:v,stopRecording:b,audioBlob:p,audioUrl:j,clearAudio:w}=Is(),[N,$]=(0,z.useState)(!1),C=(0,z.useRef)(null);let f;e[2]!==j||e[3]!==N?(f=()=>{j&&(C.current||(C.current=new Audio(j),C.current.onended=()=>$(!1)),N?C.current.pause():C.current.play(),$(!N))},e[2]=j,e[3]=N,e[4]=f):f=e[4];const R=f;let E,T;e[5]===Symbol.for("react.memo_cache_sentinel")?(E=()=>()=>{C.current&&(C.current.pause(),C.current=null)},T=[],e[5]=E,e[6]=T):(E=e[5],T=e[6]),(0,z.useEffect)(E,T);let y,P;e[7]!==p||e[8]!==N?(y=()=>{!p&&C.current&&(C.current.pause(),C.current=null,N&&$(!1))},P=[p,N],e[7]=p,e[8]=N,e[9]=y,e[10]=P):(y=e[9],P=e[10]),(0,z.useEffect)(y,P);let S;e[11]!==c?(S=U=>{if(U.target.files){const X=Array.from(U.target.files);c&&c(ge=>[...ge,...X])}},e[11]=c,e[12]=S):S=e[12];const M=S;let I;e[13]!==c?(I=U=>{c&&c(X=>X.filter((ge,Ce)=>Ce!==U))},e[13]=c,e[14]=I):I=e[14];const D=I;let A;e[15]!==m?(A=m.map(jl),e[15]=m,e[16]=A):A=e[16];const V=A;let W,q;e[17]!==V?(W=()=>()=>{V.forEach(yl)},q=[V],e[17]=V,e[18]=W,e[19]=q):(W=e[18],q=e[19]),(0,z.useEffect)(W,q);let Q;e[20]!==c?(Q=U=>{const X=U.clipboardData.files;if(X&&X.length>0){const ge=Array.from(X).filter(kl);ge.length>0&&(U.preventDefault(),c&&c(Ce=>[...Ce,...ge]))}},e[20]=c,e[21]=Q):Q=e[21];const J=Q;let k;e[22]!==p||e[23]!==w||e[24]!==a||e[25]!==d?(k=U=>{p?(a(U,{blob:p,duration:d}),w()):a(U)},e[22]=p,e[23]=w,e[24]=a,e[25]=d,e[26]=k):k=e[26];const _=k,L=zl;if(!s){let U;return e[27]===Symbol.for("react.memo_cache_sentinel")?(U=(0,t.jsx)("div",{className:"border-y border-zinc-100 bg-zinc-50/30 p-6 text-center dark:border-zinc-800 dark:bg-zinc-900/10",children:(0,t.jsx)("p",{className:"text-sm text-zinc-500",children:"Please login to join the conversation."})}),e[27]=U):U=e[27],U}let O;e[28]!==s.avatar||e[29]!==s.handle?(O=(0,t.jsx)(ze,{src:s.avatar,alt:s.handle,className:"object-cover"}),e[28]=s.avatar,e[29]=s.handle,e[30]=O):O=e[30];let B;e[31]!==s.handle?.[0]?(B=s.handle?.[0]?.toUpperCase(),e[31]=s.handle?.[0],e[32]=B):B=e[32];let de;e[33]!==B?(de=(0,t.jsx)(we,{children:B}),e[33]=B,e[34]=de):de=e[34];let me;e[35]!==O||e[36]!==de?(me=(0,t.jsxs)(Ne,{className:"size-9 border border-zinc-200 dark:border-zinc-700",children:[O,de]}),e[35]=O,e[36]=de,e[37]=me):me=e[37];let fe;e[38]!==j||e[39]!==w||e[40]!==J||e[41]!==N||e[42]!==u||e[43]!==r||e[44]!==d||e[45]!==i||e[46]!==b||e[47]!==R?(fe=u?(0,t.jsxs)("div",{className:"flex items-center justify-between bg-violet-50 dark:bg-violet-900/20 rounded-xl px-4 py-3 animate-pulse",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 text-violet-600",children:[(0,t.jsx)("div",{className:"size-2 rounded-full bg-red-500 animate-ping"}),(0,t.jsx)("span",{className:"font-mono font-bold",children:L(d)})]}),(0,t.jsx)("button",{onClick:b,className:"text-violet-600 hover:scale-110 transition-transform",children:(0,t.jsx)(rt,{size:20,fill:"currentColor"})})]}):j?(0,t.jsxs)("div",{className:"flex items-center justify-between bg-zinc-100 dark:bg-zinc-800 rounded-xl px-3 py-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("button",{type:"button",onClick:R,className:"flex size-10 shrink-0 items-center justify-center rounded-full bg-violet-500 text-white transition-all hover:bg-violet-600",children:N?(0,t.jsx)(rt,{size:16,fill:"currentColor"}):(0,t.jsx)(Ae,{size:20,fill:"currentColor",className:"ml-0.5"})}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-xs font-semibold text-zinc-500 dark:text-zinc-400",children:"Voice Message"}),(0,t.jsx)("span",{className:"text-sm font-bold text-zinc-900 dark:text-white",children:L(d)})]})]}),(0,t.jsx)("button",{onClick:w,className:"rounded-full p-2 text-zinc-400 transition-colors hover:bg-rose-50 hover:text-rose-500 dark:hover:bg-rose-500/10",children:(0,t.jsx)(ms,{size:18})})]}):(0,t.jsx)("textarea",{id:"comment-input",className:"min-h-[60px] w-full resize-none bg-transparent text-base outline-none placeholder:text-zinc-500 dark:text-white",placeholder:"Post your reply...",value:r,onChange:U=>i(U.target.value),onPaste:J}),e[38]=j,e[39]=w,e[40]=J,e[41]=N,e[42]=u,e[43]=r,e[44]=d,e[45]=i,e[46]=b,e[47]=R,e[48]=fe):fe=e[48];let ue;e[49]!==V||e[50]!==D||e[51]!==m?(ue=m.length>0&&(0,t.jsx)("div",{className:"mt-2 mb-2 flex flex-wrap gap-2",children:m.map((U,X)=>(0,t.jsxs)("div",{className:"relative size-20 overflow-hidden rounded-xl border border-zinc-200 dark:border-zinc-800",children:[U.type.startsWith("image/")?(0,t.jsx)("img",{src:V[X],className:"size-full object-cover",alt:""}):(0,t.jsx)("div",{className:"flex size-full items-center justify-center bg-zinc-100 dark:bg-zinc-800",children:(0,t.jsx)(hs,{size:20,className:"text-zinc-500"})}),(0,t.jsx)("button",{onClick:()=>D(X),className:"absolute right-1 top-1 rounded-full bg-black/60 p-1 text-white transition-colors hover:bg-black",children:(0,t.jsx)($e,{size:12})})]},X))}),e[49]=V,e[50]=D,e[51]=m,e[52]=ue):ue=e[52];let xe;e[53]===Symbol.for("react.memo_cache_sentinel")?(xe=()=>x.current?.click(),e[53]=xe):xe=e[53];const je=u||!!j;let he;e[54]===Symbol.for("react.memo_cache_sentinel")?(he=(0,t.jsx)(Gs,{size:20}),e[54]=he):he=e[54];let ae;e[55]!==je?(ae=(0,t.jsx)("button",{type:"button",onClick:xe,disabled:je,className:"rounded-full p-2 text-violet-600 transition-colors hover:bg-violet-50 dark:hover:bg-zinc-800 disabled:opacity-30",title:"Attach media",children:he}),e[55]=je,e[56]=ae):ae=e[56];let pe;e[57]!==j||e[58]!==u||e[59]!==v||e[60]!==b?(pe=!j&&(0,t.jsx)("button",{type:"button",onClick:u?b:v,className:`rounded-full p-2 transition-colors ${u?"bg-red-50 text-red-600 animate-pulse":"text-violet-600 hover:bg-violet-50 dark:hover:bg-zinc-800"}`,title:u?"Stop recording":"Record voice comment",children:(0,t.jsx)(bs,{size:20,className:u?"fill-current":""})}),e[57]=j,e[58]=u,e[59]=v,e[60]=b,e[61]=pe):pe=e[61];let ne;e[62]!==M?(ne=(0,t.jsx)("input",{type:"file",ref:x,onChange:M,multiple:!0,className:"hidden",accept:"image/*,video/*,application/pdf"}),e[62]=M,e[63]=ne):ne=e[63];let re;e[64]!==ae||e[65]!==pe||e[66]!==ne?(re=(0,t.jsxs)("div",{className:"flex gap-1 text-violet-600",children:[ae,pe,ne]}),e[64]=ae,e[65]=pe,e[66]=ne,e[67]=re):re=e[67];const oe=o||h?"primary":"animated";let ee;e[68]!==h||e[69]!==o?(ee=!(o||h)&&(0,t.jsx)(De,{size:20}),e[68]=h,e[69]=o,e[70]=ee):ee=e[70];const ie=o||h;let K;e[71]!==p||e[72]!==u||e[73]!==r||e[74]!==m.length?(K=!r.trim()&&m.length===0&&!p||u,e[71]=p,e[72]=u,e[73]=r,e[74]=m.length,e[75]=K):K=e[75];let te;e[76]!==_||e[77]!==oe||e[78]!==ee||e[79]!==ie||e[80]!==K?(te=(0,t.jsx)(Dt,{variant:oe,icon:ee,className:"min-w-[70px] !w-auto",onClick:_,loading:ie,disabled:K,children:"Reply"}),e[76]=_,e[77]=oe,e[78]=ee,e[79]=ie,e[80]=K,e[81]=te):te=e[81];let se;e[82]!==re||e[83]!==te?(se=(0,t.jsxs)("div",{className:"mt-2 flex items-center justify-between border-t border-zinc-100 pt-3 dark:border-zinc-800",children:[re,te]}),e[82]=re,e[83]=te,e[84]=se):se=e[84];let le;e[85]!==fe||e[86]!==ue||e[87]!==se?(le=(0,t.jsxs)("div",{className:"flex-1",children:[fe,ue,se]}),e[85]=fe,e[86]=ue,e[87]=se,e[88]=le):le=e[88];let ce;return e[89]!==me||e[90]!==le?(ce=(0,t.jsx)("div",{className:"border-y border-zinc-100 bg-zinc-50/30 p-4 dark:border-zinc-800 dark:bg-zinc-900/10",children:(0,t.jsxs)("div",{className:"flex gap-3",children:[me,le]})}),e[89]=me,e[90]=le,e[91]=ce):ce=e[91],ce},qt=z.memo(vl);function jl(l){return URL.createObjectURL(l)}function yl(l){return URL.revokeObjectURL(l)}function kl(l){return l.type.startsWith("image/")}function zl(l){return`${Math.floor(l/60)}:${Math.floor(l%60).toString().padStart(2,"0")}`}var Nl=Y(),wl=l=>{const e=(0,Nl.c)(30),{url:s}=l;let r,i;e[0]!==s?(r=["link-preview",s],i=()=>Vs(s),e[0]=s,e[1]=r,e[2]=i):(r=e[1],i=e[2]);const a=!!s;let o;e[3]!==r||e[4]!==i||e[5]!==a?(o={queryKey:r,queryFn:i,staleTime:864e5,enabled:a},e[3]=r,e[4]=i,e[5]=a,e[6]=o):o=e[6];const{data:n,isLoading:c,isError:h}=is(o);if(c){let w;return e[7]===Symbol.for("react.memo_cache_sentinel")?(w=(0,t.jsx)("div",{className:"mt-3 flex h-24 animate-pulse items-center justify-center overflow-hidden rounded-2xl border border-zinc-100 bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-900/50",children:(0,t.jsx)(ot,{className:"animate-spin text-zinc-300 dark:text-zinc-700",size:24})}),e[7]=w):w=e[7],w}if(h||!n||!n.title&&!n.image)return null;let g;e[8]!==n.image||e[9]!==n.title?(g=n.image&&(0,t.jsx)("div",{className:"aspect-[1.91/1] w-full overflow-hidden border-b border-zinc-100 bg-zinc-100 dark:border-zinc-800 dark:bg-zinc-900",children:(0,t.jsx)("img",{src:n.image,alt:n.title??void 0,className:"h-full w-full object-cover transition-transform duration-500 group-hover:scale-[1.02]",onError:Sl})}),e[8]=n.image,e[9]=n.title,e[10]=g):g=e[10];let m;e[11]===Symbol.for("react.memo_cache_sentinel")?(m=(0,t.jsx)(ot,{size:12}),e[11]=m):m=e[11];let x;e[12]!==n.siteName?(x=(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs font-bold uppercase tracking-wider text-zinc-600",children:[m,(0,t.jsx)("span",{children:n.siteName})]}),e[12]=n.siteName,e[13]=x):x=e[13];let u;e[14]!==n.title?(u=(0,t.jsx)("div",{className:"line-clamp-2 text-[15px] font-bold leading-snug transition-colors group-hover:text-violet-700 dark:text-white",children:n.title}),e[14]=n.title,e[15]=u):u=e[15];let d;e[16]!==n.description?(d=n.description&&(0,t.jsx)("p",{className:"line-clamp-2 text-xs leading-relaxed text-zinc-600 dark:text-zinc-400",children:n.description}),e[16]=n.description,e[17]=d):d=e[17];let v;e[18]===Symbol.for("react.memo_cache_sentinel")?(v=(0,t.jsx)(cs,{size:10}),e[18]=v):v=e[18];let b;e[19]!==s?(b=(0,t.jsxs)("div",{className:"flex items-center gap-1 pt-1 text-[11px] font-medium text-zinc-500",children:[v,(0,t.jsx)("span",{className:"truncate",children:s})]}),e[19]=s,e[20]=b):b=e[20];let p;e[21]!==b||e[22]!==x||e[23]!==u||e[24]!==d?(p=(0,t.jsxs)("div",{className:"space-y-1 p-3.5",children:[x,u,d,b]}),e[21]=b,e[22]=x,e[23]=u,e[24]=d,e[25]=p):p=e[25];let j;return e[26]!==p||e[27]!==g||e[28]!==s?(j=(0,t.jsxs)("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"group mt-3 flex flex-col overflow-hidden rounded-2xl border border-zinc-100 bg-white shadow-sm transition-all hover:bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-950 dark:hover:bg-zinc-900",onClick:Cl,children:[g,p]}),e[26]=p,e[27]=g,e[28]=s,e[29]=j):j=e[29],j},Mt=wl;function Cl(l){return l.stopPropagation()}function Sl(l){return l.target.style.display="none"}var _l=Y(),$l=l=>{const e=(0,_l.c)(15),{file:s}=l;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=(0,t.jsx)("div",{className:"flex size-10 items-center justify-center rounded-xl bg-violet-100 text-violet-600 dark:bg-violet-900/30",children:(0,t.jsx)(ds,{size:20})}),e[0]=r):r=e[0];let i;e[1]!==s.name?(i=(0,t.jsx)("div",{className:"truncate text-sm font-bold dark:text-white",children:s.name}),e[1]=s.name,e[2]=i):i=e[2];let a;e[3]!==s.size?(a=s.size!==void 0&&(0,t.jsxs)("div",{className:"text-xs uppercase text-zinc-500",children:[(s.size/1024/1024).toFixed(2)," MB"]}),e[3]=s.size,e[4]=a):a=e[4];let o;e[5]!==i||e[6]!==a?(o=(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[i,a]}),e[5]=i,e[6]=a,e[7]=o):o=e[7];let n;e[8]===Symbol.for("react.memo_cache_sentinel")?(n=(0,t.jsx)(fs,{size:18}),e[8]=n):n=e[8];let c;e[9]!==s.name||e[10]!==s.url?(c=(0,t.jsx)("a",{href:s.url,download:s.name,className:"p-2 text-zinc-400 transition-colors hover:text-violet-600",onClick:Tl,children:n}),e[9]=s.name,e[10]=s.url,e[11]=c):c=e[11];let h;return e[12]!==o||e[13]!==c?(h=(0,t.jsxs)("div",{className:"group mt-3 flex items-center gap-3 rounded-2xl border border-zinc-100 bg-zinc-50/50 p-3 transition-colors hover:border-violet-500/30 dark:border-zinc-800 dark:bg-zinc-900/10",children:[r,o,c]}),e[12]=o,e[13]=c,e[14]=h):h=e[14],h},Pl=$l;function Tl(l){return l.stopPropagation()}var Ye=Y(),Fl=l=>{const e=(0,Ye.c)(15),{item:s,onClick:r}=l,[i,a]=(0,z.useState)(!1);let o;e[0]!==i?(o=!i&&(0,t.jsx)("div",{className:"absolute inset-0 animate-pulse bg-zinc-200 dark:bg-zinc-800"}),e[0]=i,e[1]=o):o=e[1];const n=s.url||s.src;let c;e[2]===Symbol.for("react.memo_cache_sentinel")?(c={opacity:0,scale:1.1,filter:"blur(10px)"},e[2]=c):c=e[2];let h;e[3]!==i?(h=i?{opacity:1,scale:1,filter:"blur(0px)"}:{},e[3]=i,e[4]=h):h=e[4];let g;e[5]===Symbol.for("react.memo_cache_sentinel")?(g={duration:.5,ease:"easeOut"},e[5]=g):g=e[5];let m;e[6]===Symbol.for("react.memo_cache_sentinel")?(m=()=>a(!0),e[6]=m):m=e[6];let x;e[7]!==n||e[8]!==h?(x=(0,t.jsx)(G.img,{src:n,initial:c,animate:h,transition:g,className:"size-full object-cover",alt:"",loading:"lazy",onLoad:m}),e[7]=n,e[8]=h,e[9]=x):x=e[9];let u;e[10]===Symbol.for("react.memo_cache_sentinel")?(u=(0,t.jsx)("div",{className:"absolute inset-0 bg-black/0 transition-colors group-hover:bg-black/10"}),e[10]=u):u=e[10];let d;return e[11]!==r||e[12]!==o||e[13]!==x?(d=(0,t.jsxs)(G.div,{className:"group relative size-full overflow-hidden",onClick:r,children:[o,x,u]}),e[11]=r,e[12]=o,e[13]=x,e[14]=d):d=e[14],d},Rl=l=>{const e=(0,Ye.c)(18),{item:s,onClick:r}=l,[i,a]=(0,z.useState)(!1);let o;e[0]!==i?(o=!i&&(0,t.jsx)("div",{className:"absolute inset-0 animate-pulse bg-zinc-200 dark:bg-zinc-800"}),e[0]=i,e[1]=o):o=e[1];let n;e[2]!==s.poster||e[3]!==i?(n=s.poster&&(0,t.jsx)(G.img,{src:s.poster,initial:{opacity:0,scale:1.1,filter:"blur(10px)"},animate:i?{opacity:1,scale:1,filter:"blur(0px)"}:{},transition:{duration:.5,ease:"easeOut"},className:"size-full object-cover",alt:"",loading:"lazy",onLoad:()=>a(!0)}),e[2]=s.poster,e[3]=i,e[4]=n):n=e[4];let c;e[5]!==s.poster?(c=!s.poster&&(0,t.jsx)("div",{className:"flex size-full items-center justify-center bg-zinc-100 dark:bg-zinc-900",onMouseEnter:()=>a(!0),children:(0,t.jsx)("div",{className:"size-full bg-zinc-800/20"})}),e[5]=s.poster,e[6]=c):c=e[6];let h;e[7]===Symbol.for("react.memo_cache_sentinel")?(h=(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent opacity-80"}),e[7]=h):h=e[7];let g;e[8]===Symbol.for("react.memo_cache_sentinel")?(g=(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsx)("div",{className:"flex size-14 items-center justify-center rounded-full bg-white/15 backdrop-blur-md ring-1 ring-white/30 transition-all group-hover:bg-white/25 group-hover:scale-110 group-active:scale-95 shadow-2xl",children:(0,t.jsx)(Ae,{className:"ml-1 size-7 text-white fill-white drop-shadow-xl",strokeWidth:0})})}),e[8]=g):g=e[8];let m;e[9]===Symbol.for("react.memo_cache_sentinel")?(m=(0,t.jsx)(Ae,{className:"size-2.5 fill-white",strokeWidth:0}),e[9]=m):m=e[9];const x=s.duration||"0:00";let u;e[10]!==x?(u=(0,t.jsx)("div",{className:"absolute bottom-3 left-3 flex items-center gap-2",children:(0,t.jsxs)("div",{className:"flex items-center gap-1.5 rounded-lg bg-black/40 px-2 py-1 text-[11px] font-bold text-white backdrop-blur-md border border-white/10 shadow-lg",children:[m,(0,t.jsx)("span",{className:"tabular-nums tracking-wider",children:x})]})}),e[10]=x,e[11]=u):u=e[11];let d;return e[12]!==r||e[13]!==o||e[14]!==n||e[15]!==c||e[16]!==u?(d=(0,t.jsxs)(G.div,{className:"group relative size-full overflow-hidden",onClick:r,children:[o,n,c,h,g,u]}),e[12]=r,e[13]=o,e[14]=n,e[15]=c,e[16]=u,e[17]=d):d=e[17],d},Ml=l=>{const e=(0,Ye.c)(3),{items:s}=l,r=s===void 0?[]:s,{openLightbox:i}=Hs();if(!r||Array.isArray(r)&&r.length===0)return null;const a=Array.isArray(r)?r:[r],o=a.filter(Il),n=a.filter(Ll),c=o.some(Al),h=d=>{i(o,d)},g="mt-2 space-y-2",m=o.length>0&&(0,t.jsx)("div",{className:`grid gap-2 overflow-hidden rounded-2xl border border-zinc-100 dark:border-zinc-800 ${o.length===1?"grid-cols-1":o.length===2?c?"aspect-[8/9] grid-cols-1 grid-rows-2":"aspect-[16/9] grid-cols-2":(o.length===3,"aspect-[16/9] grid-cols-2 grid-rows-2")}`,children:o.map((d,v)=>(0,t.jsx)("div",{className:`relative cursor-pointer overflow-hidden bg-zinc-100 dark:bg-zinc-900 group ${o.length===3&&v===0?"row-span-2":""}`,children:d.type==="video"?(0,t.jsx)(Rl,{item:d,onClick:b=>{b.stopPropagation(),h(v)}}):(0,t.jsx)(Fl,{item:d,onClick:b=>{b.stopPropagation(),h(v)}})},v))}),x=n.map(Dl);let u;return e[0]!==m||e[1]!==x?(u=(0,t.jsxs)("div",{className:g,children:[m,x]}),e[0]=m,e[1]=x,e[2]=u):u=e[2],u},El=Ml;function Il(l){return l.type==="image"||l.type==="video"}function Ll(l){return l.type==="file"}function Al(l){return l.type==="video"}function Dl(l,e){return(0,t.jsx)(Pl,{file:l},e)}var Ol=({isOpen:l,onClose:e,url:s,title:r="Share",overlayClassName:i})=>{const[a,o]=(0,z.useState)(!1),[n,c]=(0,z.useState)(""),[h,g]=(0,z.useState)([]),[m,x]=(0,z.useState)(!1),[u,d]=(0,z.useState)(null),{addToast:v}=Xe(),{currentUser:b}=Ot(),p=(0,z.useCallback)(async()=>{if(b){x(!0);try{g((await Nt(b.id)).map(f=>f.user).filter(f=>f!==null).slice(0,5))}catch(f){console.error("Failed to fetch conversations:",f)}finally{x(!1)}}},[b]),j=(0,z.useCallback)(async()=>{if(b){x(!0);try{g((await Nt(b.id)).map(f=>f.user).filter(f=>f!==null&&(f.name?.toLowerCase().includes(n.toLowerCase())||f.handle?.toLowerCase().includes(n.toLowerCase()))))}catch(f){console.error("Search failed:",f)}finally{x(!1)}}},[n,b]);(0,z.useEffect)(()=>{if(!l||!b){c(""),g([]);return}const f=setTimeout(()=>{n.trim()?j():p()},300);return()=>clearTimeout(f)},[n,l,b,j,p]);const w=async f=>{f&&f.stopPropagation();try{await Ge(s),o(!0),v("Link copied to clipboard!","success"),setTimeout(()=>o(!1),2e3)}catch(R){console.error("Failed to copy:",R),v("Failed to copy link","error")}},N=async f=>{if(b){d(f.id);try{await Ls(await Bs(b.id,f.id),b.id,s,"text"),v(`Sent to ${f.name||f.handle}!`,"success")}catch(R){console.error("Failed to send message:",R),v("Failed to send message","error")}finally{d(null)}}},$=[{name:"X",icon:ks,color:"bg-black text-white",href:`https://twitter.com/intent/tweet?url=${encodeURIComponent(s)}`},{name:"Facebook",icon:xs,color:"bg-[#1877F2] text-white",href:`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(s)}`},{name:"LinkedIn",icon:rs,color:"bg-[#0A66C2] text-white",href:`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(s)}`},{name:"WhatsApp",icon:gs,color:"bg-[#25D366] text-white",href:`https://wa.me/?text=${encodeURIComponent(s)}`},{name:"Email",icon:us,color:"bg-zinc-600 text-white",href:`mailto:?body=${encodeURIComponent(s)}`}],C=async()=>{if(navigator.share)try{await navigator.share({title:r,url:s})}catch(f){f.name!=="AbortError"&&console.error("Native share failed:",f)}else w()};return(0,t.jsx)(Ut,{isOpen:l,onClose:e,className:"max-w-[360px] overflow-hidden rounded-[32px] border border-black/10 bg-white/75 p-0 shadow-2xl backdrop-blur-xl dark:border-white/10 dark:bg-zinc-900/75 sm:max-w-[380px]",overlayClassName:i,children:(0,t.jsxs)("div",{className:"flex h-full flex-col",children:[(0,t.jsx)("div",{className:"flex items-center justify-center pt-6 pb-2",children:(0,t.jsx)("h2",{className:"text-[17px] font-semibold text-zinc-900 dark:text-zinc-50",children:r})}),(0,t.jsx)("div",{className:"px-5 py-3",children:(0,t.jsxs)("div",{className:"group relative",children:[(0,t.jsx)(as,{className:"absolute left-3.5 top-1/2 size-4 -translate-y-1/2 text-zinc-400 transition-colors group-focus-within:text-violet-500"}),(0,t.jsx)("input",{type:"text",placeholder:"Search people...",value:n,onChange:f=>c(f.target.value),className:"w-full rounded-2xl border border-black/5 bg-black/5 py-3 pl-11 pr-4 text-[15px] outline-none transition-all focus:ring-4 focus:ring-violet-500/10 dark:border-white/5 dark:bg-white/5 dark:focus:bg-black/50"})]})}),(0,t.jsx)("div",{className:"no-scrollbar flex min-h-[110px] items-center gap-4 overflow-x-auto px-5 py-4",children:m?(0,t.jsx)("div",{className:"flex flex-1 justify-center",children:(0,t.jsx)("span",{className:"animate-pulse text-[13px] font-medium text-zinc-400",children:"Loading..."})}):h.length>0?h.map(f=>(0,t.jsxs)("button",{onClick:()=>N(f),disabled:u!==null,className:"group flex shrink-0 flex-col items-center gap-2 transition-transform active:scale-95 disabled:opacity-50",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"size-16 overflow-hidden rounded-full border-2 border-white/50 shadow-sm dark:border-zinc-800/50 bg-zinc-100 dark:bg-zinc-800",children:(0,t.jsx)("img",{src:f.avatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=${f.handle}`,alt:f.handle,className:"size-full object-cover"})}),u===f.id&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center rounded-full bg-black/40",children:(0,t.jsx)("span",{className:"animate-pulse text-white font-bold",children:"..."})})]}),(0,t.jsx)("span",{className:"max-w-[70px] truncate text-[11px] font-medium text-zinc-500 dark:text-zinc-400",children:f.name?.split(" ")[0]||f.handle})]},f.id)):(0,t.jsx)("div",{className:"flex-1 py-2 text-center",children:(0,t.jsx)("span",{className:"text-xs text-zinc-400",children:"No people found"})})}),(0,t.jsx)("div",{className:"mx-5 h-px bg-black/5 dark:bg-white/5"}),(0,t.jsxs)("div",{className:"grid grid-cols-5 gap-3 px-5 py-6",children:[$.map(f=>(0,t.jsxs)("a",{href:f.href,target:"_blank",rel:"noopener noreferrer",className:"group flex flex-col items-center gap-2.5",children:[(0,t.jsx)("div",{className:`size-12 ${f.color} flex items-center justify-center rounded-[18px] shadow-sm ring-1 ring-black/5 transition-all group-hover:-translate-y-1 group-hover:scale-105 group-hover:shadow-lg dark:ring-white/5`,children:(0,t.jsx)(f.icon,{size:22,strokeWidth:2.5})}),(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider text-zinc-500/80 dark:text-zinc-400/80",children:f.name})]},f.name)),(0,t.jsxs)("button",{onClick:C,className:"group flex flex-col items-center gap-2.5",children:[(0,t.jsx)("div",{className:"flex size-12 items-center justify-center rounded-[18px] border border-black/10 bg-white/50 text-zinc-600 shadow-sm transition-all group-hover:-translate-y-1 group-hover:scale-105 dark:border-white/10 dark:bg-white/5 dark:text-zinc-300",children:(0,t.jsx)(Be,{size:22,strokeWidth:2.5})}),(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider text-zinc-500/80 dark:text-zinc-400/80",children:"More"})]})]}),(0,t.jsx)("div",{className:"px-5 pb-6",children:(0,t.jsxs)("div",{className:"group relative flex items-center overflow-hidden rounded-2xl border border-black/10 bg-white/40 dark:border-white/10 dark:bg-black/20",children:[(0,t.jsx)("input",{type:"text",readOnly:!0,value:s,className:"w-full bg-transparent py-4 pl-4 pr-16 text-[14px] font-medium text-zinc-600 outline-none dark:text-zinc-300"}),(0,t.jsx)("button",{onClick:w,className:`absolute right-1 text-[13px] font-bold active:scale-95 transition-all px-4 h-10 rounded-xl leading-none ${a?"text-emerald-500":"text-violet-600 hover:text-violet-700 dark:text-violet-400"}`,children:a?"Copied":"Copy"})]})}),(0,t.jsx)("div",{className:"border-t border-black/10 dark:border-white/10",children:(0,t.jsx)("button",{onClick:e,className:"flex h-16 w-full items-center justify-center text-[19px] font-medium text-zinc-500 transition-colors active:bg-black/5 dark:text-zinc-400 dark:active:bg-white/5",children:"Close"})})]})})},Ht=Ol,Gt=Y(),Ul=l=>{const e=(0,Gt.c)(6),{avatars:s}=l;if(!s||s.length===0)return null;let r,i;if(e[0]!==s){const o=s.slice(0,3);r="relative mt-2.5 h-8 w-8",i=o.map((n,c)=>{let h,g;return o.length===1?(h="top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",g="size-5"):o.length===2?(g="size-4.5",h=c===0?"top-0 right-0":"bottom-0 left-0"):(g=c===0?"size-4.5":"size-3.5",c===0?h="top-0 left-1/2 -translate-x-1/2":c===1?h="bottom-0.5 left-0":h="bottom-0.5 right-0"),(0,t.jsx)("div",{className:`absolute rounded-full border-2 border-white bg-zinc-100 dark:border-black dark:bg-zinc-800 overflow-hidden shadow-md transition-transform hover:scale-110 ${h} ${g}`,style:{zIndex:10-c},children:(0,t.jsx)("img",{src:n,alt:"",className:"h-full w-full object-cover",loading:"lazy"})},c)}),e[0]=s,e[1]=r,e[2]=i}else r=e[1],i=e[2];let a;return e[3]!==r||e[4]!==i?(a=(0,t.jsx)("div",{className:r,children:i}),e[3]=r,e[4]=i,e[5]=a):a=e[5],a},Et=l=>{const e=(0,Gt.c)(78),{id:s,user:r,isCurrentUser:i,isComment:a,isPinned:o,onEdit:n,onDelete:c,onTogglePin:h,addToast:g,trigger:m}=l,{openReport:x}=Vt(),[u,d]=(0,z.useState)(!1);if(Ps("(min-width: 1024px)")){let S;e[0]!==m?(S=(0,t.jsx)(Cs,{asChild:!0,onClick:ql,children:(0,t.jsx)("div",{className:"cursor-pointer outline-none",children:m})}),e[0]=m,e[1]=S):S=e[1];let M;e[2]!==g||e[3]!==s||e[4]!==a?(M=!a&&(0,t.jsxs)(ye,{onClick:_=>{_.stopPropagation(),Ge(Je(s)).then(()=>{g("Link copied"),d(!1)}).catch(()=>{g("Failed to copy link","error")})},children:[(0,t.jsx)(mt,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Copy link"})]}),e[2]=g,e[3]=s,e[4]=a,e[5]=M):M=e[5];let I;e[6]!==s||e[7]!==x?(I=_=>{_.stopPropagation(),x("post",s),d(!1)},e[6]=s,e[7]=x,e[8]=I):I=e[8];let D;e[9]===Symbol.for("react.memo_cache_sentinel")?(D=(0,t.jsx)(He,{className:"mr-2 h-4 w-4"}),e[9]=D):D=e[9];const A=a?"comment":"post";let V;e[10]!==A?(V=(0,t.jsxs)("span",{children:["Report ",A]}),e[10]=A,e[11]=V):V=e[11];let W;e[12]!==I||e[13]!==V?(W=(0,t.jsxs)(ye,{onClick:I,children:[D,V]}),e[12]=I,e[13]=V,e[14]=W):W=e[14];let q;e[15]!==i||e[16]!==x||e[17]!==r?(q=!i&&(0,t.jsxs)(ye,{onClick:_=>{_.stopPropagation(),x("user",r.id),d(!1)},children:[(0,t.jsx)(ct,{className:"mr-2 h-4 w-4"}),(0,t.jsxs)("span",{children:["Report @",r.handle]})]}),e[15]=i,e[16]=x,e[17]=r,e[18]=q):q=e[18];let Q;e[19]!==a||e[20]!==i||e[21]!==o||e[22]!==c||e[23]!==n||e[24]!==h?(Q=i&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Ms,{}),!a&&h&&(0,t.jsx)(ye,{onClick:_=>{_.stopPropagation(),h(),d(!1)},children:o?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ut,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Unpin from profile"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(We,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Pin to profile"})]})}),(0,t.jsxs)(ye,{onClick:_=>{_.stopPropagation(),n(),d(!1)},children:[(0,t.jsx)(ft,{className:"mr-2 h-4 w-4"}),(0,t.jsxs)("span",{children:["Edit ",a?"Comment":"Post"]})]}),(0,t.jsxs)(ye,{className:"text-red-500 focus:text-red-500",onClick:_=>{_.stopPropagation(),c(),d(!1)},children:[(0,t.jsx)(dt,{className:"mr-2 h-4 w-4"}),(0,t.jsxs)("span",{children:["Delete ",a?"comment":"post"]})]})]}),e[19]=a,e[20]=i,e[21]=o,e[22]=c,e[23]=n,e[24]=h,e[25]=Q):Q=e[25];let J;e[26]!==M||e[27]!==W||e[28]!==q||e[29]!==Q?(J=(0,t.jsxs)(Rs,{align:"end",className:"w-56",onClick:Hl,children:[M,W,q,Q]}),e[26]=M,e[27]=W,e[28]=q,e[29]=Q,e[30]=J):J=e[30];let k;return e[31]!==u||e[32]!==S||e[33]!==J?(k=(0,t.jsx)("div",{onClick:Wl,children:(0,t.jsxs)(Ks,{open:u,onOpenChange:d,modal:!0,children:[S,J]})}),e[31]=u,e[32]=S,e[33]=J,e[34]=k):k=e[34],k}let v;e[35]===Symbol.for("react.memo_cache_sentinel")?(v=S=>{S.stopPropagation(),d(!0)},e[35]=v):v=e[35];let b;e[36]!==m?(b=(0,t.jsx)("div",{onClick:v,className:"cursor-pointer",children:m}),e[36]=m,e[37]=b):b=e[37];let p;e[38]===Symbol.for("react.memo_cache_sentinel")?(p=()=>d(!1),e[38]=p):p=e[38];let j;e[39]!==g||e[40]!==s||e[41]!==a?(j=!a&&(0,t.jsx)(ke,{icon:(0,t.jsx)(mt,{size:18}),onClick:S=>{S.stopPropagation(),Ge(Je(s)).then(()=>{g("Link copied"),d(!1)}).catch(()=>{g("Failed to copy link","error")})},children:"Copy link"}),e[39]=g,e[40]=s,e[41]=a,e[42]=j):j=e[42];let w;e[43]===Symbol.for("react.memo_cache_sentinel")?(w=(0,t.jsx)(He,{size:18}),e[43]=w):w=e[43];let N;e[44]!==s||e[45]!==x?(N=S=>{S.stopPropagation(),x("post",s),d(!1)},e[44]=s,e[45]=x,e[46]=N):N=e[46];const $=a?"comment":"post";let C;e[47]!==N||e[48]!==$?(C=(0,t.jsxs)(ke,{icon:w,onClick:N,children:["Report ",$]}),e[47]=N,e[48]=$,e[49]=C):C=e[49];let f;e[50]!==i||e[51]!==x||e[52]!==r?(f=!i&&(0,t.jsxs)(ke,{icon:(0,t.jsx)(ct,{size:18}),onClick:S=>{S.stopPropagation(),x("user",r.id),d(!1)},children:["Report @",r.handle]}),e[50]=i,e[51]=x,e[52]=r,e[53]=f):f=e[53];let R;e[54]!==a||e[55]!==i||e[56]!==o||e[57]!==h?(R=i&&!a&&h&&(0,t.jsx)(ke,{icon:o?(0,t.jsx)(ut,{size:18}):(0,t.jsx)(We,{size:18}),onClick:S=>{S.stopPropagation(),h(),d(!1)},children:o?"Unpin from profile":"Pin to profile"}),e[54]=a,e[55]=i,e[56]=o,e[57]=h,e[58]=R):R=e[58];let E;e[59]!==a||e[60]!==i||e[61]!==n?(E=i&&(0,t.jsxs)(ke,{icon:(0,t.jsx)(ft,{size:18}),onClick:S=>{S.stopPropagation(),n(),d(!1)},children:["Edit ",a?"Comment":"Post"]}),e[59]=a,e[60]=i,e[61]=n,e[62]=E):E=e[62];let T;e[63]!==a||e[64]!==i||e[65]!==c?(T=i&&(0,t.jsxs)(ke,{variant:"destructive",icon:(0,t.jsx)(dt,{size:18}),onClick:S=>{S.stopPropagation(),c(),d(!1)},children:["Delete ",a?"comment":"post"]}),e[63]=a,e[64]=i,e[65]=c,e[66]=T):T=e[66];let y;e[67]!==u||e[68]!==R||e[69]!==E||e[70]!==T||e[71]!==j||e[72]!==C||e[73]!==f?(y=(0,t.jsx)("div",{onClick:Gl,children:(0,t.jsxs)(Ys,{isOpen:u,onClose:p,children:[j,C,f,R,E,T]})}),e[67]=u,e[68]=R,e[69]=E,e[70]=T,e[71]=j,e[72]=C,e[73]=f,e[74]=y):y=e[74];let P;return e[75]!==y||e[76]!==b?(P=(0,t.jsxs)(t.Fragment,{children:[b,y]}),e[75]=y,e[76]=b,e[77]=P):P=e[77],P},Ke=({id:l,user:e,timeAgo:s,content:r,contentClass:i,media:a,quotedPost:o,stats:n,onClick:c,repostedBy:h,onUserClick:g,currentUser:m,poll:x,isDetail:u,initialComments:d,onDelete:v,onUpdate:b,isComment:p,onReply:j,community:w,parent_id:N,post_id:$,commenterAvatars:C=[],is_pinned:f=!1,type:R="text",duration:E})=>{const T=Lt(),{addToast:y}=Xe(),P=ls(),[S,M]=(0,z.useState)(f),{liked:I,reposted:D,localStats:A,setLocalStats:V,handleLike:W,handleRepost:q}=Qs($||l,n,m,p?l:void 0),{deletePost:Q,updatePost:J}=As(),k=async()=>{try{const F=!S;await J(l,{is_pinned:F,pinned_at:F?new Date().toISOString():null}),M(F),P.invalidateQueries({queryKey:["posts","user",e.id]}),y(F?"Post pinned to profile":"Post unpinned")}catch(F){console.error("Failed to toggle pin:",F),y("Failed to update pin status")}},{comments:_,fetchNextPage:L,hasNextPage:O,isFetchingNextPage:B,addComment:de,deleteComment:me,updateComment:fe,isSubmitting:ue}=zt($||l,d),[xe,je]=(0,z.useState)(""),[he,ae]=(0,z.useState)([]),[pe,ne]=(0,z.useState)(!1),[re,oe]=(0,z.useState)(!1),[ee,ie]=(0,z.useState)(!1),[K,te]=(0,z.useState)(r),[se,le]=(0,z.useState)(a||[]),[ce,U]=(0,z.useState)([]),[X,ge]=(0,z.useState)(!1),[Ce,Oe]=(0,z.useState)(!1),[Ue,Pe]=(0,z.useState)(null),[Ve,tt]=(0,z.useState)(!1),{comments:Qt,refetch:st}=zt($||l,void 0,Ve?l:void 0),{ref:lt,inView:it}=ts({threshold:.5,triggerOnce:!0});(0,z.useEffect)(()=>{if(it&&!p&&l&&!l.startsWith("temp-")){const F=setTimeout(()=>{Es(l,"post")&&Wt(l).catch(console.error)},1500);return()=>clearTimeout(F)}},[it,l,p]);const Jt=(0,z.useCallback)(async()=>{!l||!$&&!l||A.comments===0||(tt(!0),st())},[l,$,A.comments,st]),at=async()=>{const F=JSON.stringify(se)!==JSON.stringify(a||[])||ce.length>0;if(!K.trim()||K===r&&!F){ie(!1);return}ge(!0);try{const H=[];for(const be of ce){const Fe=await _e(be);H.push(Fe)}const Z=[...se,...H];p?await fe({commentId:l,content:K,media:Z}):await J(l,{content:K,media:Z}),U([]),ie(!1),y(`${p?"Comment":"Post"} updated`),b&&b(l,K,Z)}catch(H){console.error(`Failed to update ${p?"comment":"post"}:`,H),y(`Failed to update ${p?"comment":"post"}`)}finally{ge(!1)}},nt=async F=>{F&&F.stopPropagation();try{p?await me(l):await Q(l),y(`${p?"Comment":"Post"} deleted successfully`),v&&v(l)}catch(H){console.error(`Failed to delete ${p?"comment":"post"}:`,H),y(`Failed to delete ${p?"comment":"post"}`)}finally{oe(!1)}},Kt=async(F,H)=>{if(F?.preventDefault(),!(!xe.trim()&&he.length===0&&!H||!m)){ne(!0);try{let Z=[],be="text",Fe;if(H)Z=[await _e(new File([H.blob],"voice-comment.webm",{type:"audio/webm"}))],be="voice",Fe=H.duration;else for(const Re of he){const Zt=await _e(Re);Z.push(Zt)}await de({userId:m.id,content:xe,media:Z,replyToId:Ue?.id,type:be,duration:Fe}),je(""),ae([]),Pe(null),V(Re=>({...Re,comments:(Re.comments||0)+1})),y(be==="voice"?"Voice reply posted!":"Reply posted!")}catch(Z){console.error("Failed to post comment:",Z),y("Failed to post reply.")}finally{ne(!1)}}},Te=m?.handle===e.handle,Xt=(F,H)=>{Pe(H?{handle:F,id:p?N||l:H}:null),je(Z=>{const be=`@${F} `;return Z.includes(be)?Z:be+Z}),document.getElementById("comment-input")?.focus()};return u?(0,t.jsxs)(G.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"flex flex-col",ref:lt,children:[(0,t.jsxs)("article",{className:"p-6 dark:bg-black",children:[(0,t.jsx)($t,{user:e,timeAgo:s,community:w,onUserClick:g,isDetail:!0,showAvatar:!0,isPinned:S,actionsMenu:(0,t.jsx)(Et,{id:l,user:e,isCurrentUser:Te,isComment:p,isPinned:S,onEdit:()=>ie(!0),onDelete:()=>oe(!0),onTogglePin:k,addToast:y,trigger:(0,t.jsx)("button",{"aria-label":"More options",className:"rounded-full p-2 text-zinc-500 transition-colors hover:bg-zinc-100 dark:hover:bg-zinc-800",children:(0,t.jsx)(Be,{size:20})})})}),(0,t.jsx)(Pt,{content:r,isDetail:!0,isEditing:ee,editedContent:K,setEditedContent:te,onCancelEdit:()=>{ie(!1),te(r),le(a||[]),U([])},onSaveEdit:at,isUpdating:X,contentClass:i}),R==="voice"&&a?.[0]&&(0,t.jsx)("div",{className:"mt-4 max-w-[300px]",children:(0,t.jsx)(Ct,{url:a[0].url,duration:E||0,isMe:Te})}),Me(r)&&(0,t.jsx)(Mt,{url:Me(r)}),(0,t.jsx)(Tt,{media:a,isEditing:ee,editedMedia:se,setEditedMedia:le,newFiles:ce,setNewFiles:U}),x&&(0,t.jsx)(Ft,{poll:x,onVote:F=>ws(l,F,m.id)}),o&&(0,t.jsx)("div",{className:"mt-5 overflow-hidden rounded-2xl border border-zinc-200 shadow-sm dark:border-zinc-700",children:(0,t.jsx)(Rt,{...o})}),(0,t.jsx)(_t,{views:A.views||0,likes:A.likes||0,comments:A.comments||0,isDetail:!0}),(0,t.jsx)("div",{className:"my-4"}),(0,t.jsx)(St,{liked:I,reposted:D,handleLike:W,handleRepost:q,handleCommentClick:()=>document.getElementById("comment-input")?.focus(),handleShareClick:()=>Oe(!0),isDetail:!0,isComment:p})]}),Ue&&(0,t.jsxs)("div",{className:"flex items-center justify-between bg-zinc-50 px-5 py-2 dark:bg-zinc-900/50",children:[(0,t.jsxs)("span",{className:"text-sm text-zinc-500",children:["Replying to"," ",(0,t.jsxs)("span",{className:"font-bold text-violet-600",children:["@",Ue.handle]})]}),(0,t.jsx)("button",{onClick:()=>Pe(null),className:"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200",children:(0,t.jsx)($e,{size:16})})]}),(0,t.jsx)(qt,{currentUser:m,newComment:xe,setNewComment:je,handleSubmitComment:Kt,loading:ue,selectedFiles:he,setSelectedFiles:ae,isUploading:pe}),(0,t.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:[(0,t.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:(0,t.jsxs)(t.Fragment,{children:[O&&_.length>0&&(0,t.jsxs)("button",{onClick:()=>L(),disabled:B,className:"flex w-full items-center justify-center gap-2 py-3 text-sm font-bold text-violet-600 transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[B&&(0,t.jsx)("span",{className:"animate-spin",children:"⌛"}),"View more replies"]}),_.map(F=>(0,t.jsx)(Ke,{...F,isComment:!0,post_id:l,onReply:Xt,onUserClick:g,currentUser:m,stats:{likes:F.stats?.likes||0,comments:F.stats?.comments||0,reposts:F.stats?.reposts||0},timeAgo:F.timeAgo||F.created_at},F.id))]})}),(0,t.jsx)(vt,{open:re,onOpenChange:oe,children:(0,t.jsxs)(wt,{onClick:F=>F.stopPropagation(),children:[(0,t.jsxs)(jt,{children:[(0,t.jsx)(kt,{children:"Are you absolutely sure?"}),(0,t.jsx)(gt,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,t.jsxs)(yt,{children:[(0,t.jsx)(bt,{onClick:F=>F.stopPropagation(),children:"Cancel"}),(0,t.jsx)(ht,{onClick:nt,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]})]}):(0,t.jsxs)(G.article,{initial:{opacity:0,y:10},whileInView:{opacity:1,y:0},viewport:{once:!0,margin:"-50px"},transition:{duration:.4,ease:"easeOut"},ref:lt,onClick:c,className:`px-5 transition-all ${p?"py-3 bg-transparent hover:bg-zinc-50/30 dark:hover:bg-zinc-800/20":"py-5 bg-white hover:bg-zinc-50/30 dark:bg-black dark:hover:bg-white/[0.02]"} ${c?"cursor-pointer":""}`,children:[h&&(0,t.jsxs)("div",{className:"mb-2.5 ml-1 flex items-center space-x-1.5 text-[13px] font-semibold text-zinc-600",children:[(0,t.jsx)(qe,{size:14,className:"text-zinc-500"}),(0,t.jsxs)("span",{className:"flex cursor-pointer items-center text-zinc-700 hover:underline dark:text-zinc-300",onClick:F=>{F.stopPropagation(),g&&g(h.handle)},children:[h.handle," Reposted"]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-x-3.5",children:[(0,t.jsxs)("div",{className:"flex shrink-0 flex-col items-center self-stretch pt-0.5",children:[(0,t.jsx)("div",{className:"cursor-pointer",onClick:F=>{F.stopPropagation(),g&&g(e.handle)},children:(0,t.jsxs)(Ne,{className:`${p?"size-8":"size-10"} border-0 shadow-sm`,children:[(0,t.jsx)(ze,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,t.jsx)(we,{className:"text-xs",children:e.handle[0]?.toUpperCase()})]})}),(!p&&A.comments>0||p&&!N&&A.comments>0)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"mt-2 w-0.5 flex-1 rounded-full bg-zinc-100 dark:bg-zinc-800"}),!p&&(0,t.jsx)(Ul,{avatars:C.length>0?C:(_||[]).slice(0,3).map(F=>F.user.avatar)})]})]}),(0,t.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col xl:max-w-xl",children:[(0,t.jsx)($t,{user:e,timeAgo:s,community:w,onUserClick:g,isComment:p,isPinned:S,actionsMenu:(0,t.jsx)(Et,{id:l,user:e,isCurrentUser:Te,isComment:p,isPinned:S,onEdit:()=>ie(!0),onDelete:()=>oe(!0),onTogglePin:k,addToast:y,trigger:(0,t.jsx)("button",{"aria-label":"More options",className:"rounded-full p-2 text-zinc-500 transition-colors hover:bg-zinc-100 group-hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:group-hover:bg-zinc-800/50",children:(0,t.jsx)(Be,{size:18})})})}),(0,t.jsx)(Pt,{content:r,isEditing:ee,editedContent:K,setEditedContent:te,onCancelEdit:()=>{ie(!1),te(r),le(a||[]),U([])},onSaveEdit:at,isUpdating:X,contentClass:i}),R==="voice"&&a?.[0]&&(0,t.jsx)("div",{className:"mt-3 max-w-[280px]",children:(0,t.jsx)(Ct,{url:a[0].url,duration:E||0,isMe:Te})}),Me(r)&&(0,t.jsx)(Mt,{url:Me(r)}),(0,t.jsx)(Tt,{media:a,isEditing:ee,editedMedia:se,setEditedMedia:le,newFiles:ce,setNewFiles:U}),x&&(0,t.jsx)(Ft,{poll:x}),o&&(0,t.jsx)("div",{className:"mt-3 overflow-hidden rounded-2xl border border-zinc-200 shadow-sm transition-all hover:bg-zinc-50 dark:border-zinc-800 dark:hover:bg-zinc-900",onClick:F=>{F.stopPropagation(),T(`/p/${o.id}`)},children:(0,t.jsx)(Rt,{...o})}),(0,t.jsx)(St,{liked:I,reposted:D,handleLike:W,handleRepost:q,handleCommentClick:F=>{if(F?.stopPropagation(),j){const H=p&&N||l;j(e.handle,H)}else c&&c()},handleShareClick:F=>{F?.stopPropagation(),Oe(!0)},isComment:p}),(0,t.jsx)(_t,{views:A.views||0,likes:A.likes||0,comments:A.comments||0,isComment:p,onRepliesClick:()=>{Ve?tt(!1):Jt()}}),Ve&&(0,t.jsxs)("div",{className:"relative mt-2 space-y-0",children:[(0,t.jsx)("div",{className:"absolute left-[19px] top-0 bottom-4 w-0.5 bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsx)("div",{className:"flex flex-col",children:Qt.map(F=>(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute left-[19px] top-5 h-0.5 w-4 bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsx)("div",{className:"pl-6",children:(0,t.jsx)(Ke,{...F,isComment:!0,post_id:$||l,onReply:j,onUserClick:g,currentUser:m,stats:{likes:F.stats?.likes||0,comments:F.stats?.comments||0,reposts:F.stats?.reposts||0},timeAgo:F.timeAgo||F.created_at})})]},F.id))})]}),(0,t.jsx)(Ht,{isOpen:Ce,onClose:()=>Oe(!1),url:Je(l),title:"Share Post",overlayClassName:"z-[9999]"}),(0,t.jsx)(vt,{open:re,onOpenChange:oe,children:(0,t.jsxs)(wt,{onClick:F=>F.stopPropagation(),children:[(0,t.jsxs)(jt,{children:[(0,t.jsx)(kt,{children:"Are you absolutely sure?"}),(0,t.jsx)(gt,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,t.jsxs)(yt,{children:[(0,t.jsx)(bt,{onClick:F=>F.stopPropagation(),children:"Cancel"}),(0,t.jsx)(ht,{onClick:nt,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]})]})]})};function Vl(l,e){const s=!l.media&&!e.media||l.media?.length===e.media?.length&&l.media?.every((i,a)=>i.url===e.media?.[a].url),r=l.repostedBy?.handle===e.repostedBy?.handle;return l.id===e.id&&l.content===e.content&&l.timeAgo===e.timeAgo&&l.user.id===e.user.id&&l.user.avatar===e.user.avatar&&l.stats.likes===e.stats.likes&&l.stats.comments===e.stats.comments&&l.stats.reposts===e.stats.reposts&&l.currentUser?.id===e.currentUser?.id&&!!s&&!!r}var Bl=z.memo(Ke,Vl);function Wl(l){return l.stopPropagation()}function ql(l){return l.stopPropagation()}function Hl(l){return l.stopPropagation()}function Gl(l){return l.stopPropagation()}var et=null;const Ee=l=>{et=l},Ie=()=>et,ai=()=>{et=null};var Ql=z.memo(({reel:l,isActive:e,volume:s,shouldLoad:r=!0})=>{const{currentUser:i}=Ot(),{addToast:a}=Xe(),{openReport:o}=Vt(),n=(0,z.useRef)(null),[c,h]=(0,z.useState)(!1),[g,m]=(0,z.useState)(!1),[x,u]=(0,z.useState)(!1),[d,v]=(0,z.useState)(!1),[b,p]=(0,z.useState)(null),[j,w]=(0,z.useState)(!1),[N,$]=(0,z.useState)(l.stats?.likes||0),[C,f]=(0,z.useState)(!1),[R,E]=(0,z.useState)(0),[T,y]=(0,z.useState)(!1),P=(0,z.useRef)(null);(0,z.useEffect)(()=>{if(e&&l.id&&!l.id.toString().startsWith("temp-")){const k=setTimeout(()=>{Wt(l.id).catch(console.error)},1500);return()=>clearTimeout(k)}},[e,l.id]);const S=(0,z.useMemo)(()=>Array.isArray(l.media)?l.media[0]?.src||l.media[0]?.url:l.media?.src||l.media?.url||l.url,[l.media,l.url]);(0,z.useEffect)(()=>{v(!1),y(!1);const k=n.current?.plyr;if(k&&typeof k.on=="function"){const _=()=>v(!0),L=()=>y(!0);k.on("ready",_),k.on("canplay",_),k.on("loadeddata",_),k.on("playing",L);const O=setTimeout(()=>{e&&y(!0)},3e3);return()=>{clearTimeout(O),typeof k.off=="function"&&(k.off("ready",_),k.off("canplay",_),k.off("loadeddata",_),k.off("playing",L))}}else{const _=setTimeout(()=>{v(!0),e&&y(!0)},1500);return()=>clearTimeout(_)}},[S]);const M=(0,z.useRef)(null);(0,z.useEffect)(()=>{const k=n.current,_=k?.plyr;if(M.current&&(clearTimeout(M.current),M.current=null),!(!_||!d))return e?M.current=setTimeout(()=>{M.current=null;const L=n.current?.plyr;if(L&&typeof L.play=="function"){const O=Ie();O&&O!==L&&typeof O.pause=="function"&&(O.pause(),typeof O.currentTime<"u"&&(O.currentTime=0)),L.play().catch(()=>{const B=n.current?.plyr;B&&typeof B.play=="function"&&B.play().catch(()=>{})}).then(()=>{Ee(L)})}},50):typeof _.pause=="function"&&(_.pause(),typeof _.currentTime<"u"&&(_.currentTime=0),Ie()===_&&Ee(null)),()=>{M.current&&(clearTimeout(M.current),M.current=null);const L=k?.plyr;L&&typeof L.pause=="function"&&(L.pause(),typeof L.currentTime<"u"&&(L.currentTime=0),Ie()===L&&Ee(null))}},[e,d]),(0,z.useEffect)(()=>{const k=n.current;return()=>{M.current&&(clearTimeout(M.current),M.current=null);const _=k?.plyr;_&&typeof _.pause=="function"&&(_.pause(),_.currentTime=0,Ie()===_&&Ee(null)),v(!1),y(!1),E(0)}},[]),(0,z.useEffect)(()=>{if(!i?.id||!e)return;(async()=>{try{if(!l.id||l.id.toString().startsWith("temp-"))return;const _=[Fs(i.id,l.id)];l.user?.id&&l.user.id!=="undefined"?_.push($s(i.id,l.user.id)):_.push(Promise.resolve(!1));const[L,O]=await Promise.all(_);w(L),f(O)}catch(_){console.error("Failed to check interaction status:",_)}})()},[l.id,i?.id,e,l.user?.id]),(0,z.useEffect)(()=>{const k=n.current?.plyr;k&&e&&(k.muted=s===0,k.volume=s)},[s,d,e]),(0,z.useEffect)(()=>{const k=n.current?.plyr;if(!k||!e)return;const _=()=>{const L=k.currentTime,O=k.duration;O>0&&E(L/O*100)};if(typeof k.on=="function")return k.on("timeupdate",_),()=>{typeof k.off=="function"&&k.off("timeupdate",_)}},[e]);const I=k=>{k.stopPropagation();const _=k.currentTarget.getBoundingClientRect(),L=k.clientX-_.left,O=Math.min(Math.max(0,L/_.width),1),B=n.current?.plyr;B&&B.duration&&(B.currentTime=O*B.duration,E(O*100))};(0,z.useEffect)(()=>()=>{P.current&&clearTimeout(P.current)},[]);const D=k=>{const _=k.target;_.closest("button")||_.closest("a")||_.closest(".plyr__controls")||(P.current?(clearTimeout(P.current),P.current=null,V()):P.current=setTimeout(()=>{P.current=null,A()},250))},A=()=>{const k=n.current?.plyr;k&&(k.paused?(typeof k.play=="function"&&k.play().catch(()=>{}),p("play")):(typeof k.pause=="function"&&k.pause(),p("pause")),setTimeout(()=>p(null),800))},V=async()=>{if(i&&(h(!0),setTimeout(()=>h(!1),800),!j)){w(!0),$(k=>k+1);try{await xt(i.id,l.id)}catch{w(!1),$(k=>k-1)}}},W=async k=>{if(k.stopPropagation(),!i)return;const _=!j;w(_),$(L=>_?L+1:L-1);try{await xt(i.id,l.id)}catch{w(!_),$(L=>_?L-1:L+1)}},q=async k=>{if(k.stopPropagation(),!i)return;const _=!C;f(_);try{await Ss(i.id,l.user?.id)}catch{f(!_)}},Q=k=>{k.stopPropagation(),u(!0)},J=(0,z.useMemo)(()=>({source:{type:"video",sources:[{src:S,type:"video/mp4"}]},options:{controls:[],loop:{active:!0},clickToPlay:!1,ratio:"9:16",autoplay:!1,playsinline:!0,muted:!0}}),[S]);return(0,t.jsxs)("div",{"data-id":l.id,className:"reel-item relative flex h-[100dvh] w-full snap-start items-center justify-center overflow-hidden bg-black cursor-pointer select-none",onClick:D,children:[(0,t.jsxs)("div",{className:"relative flex h-full w-full max-w-[450px] items-center justify-center",children:[(0,t.jsx)("div",{className:"w-full",children:r?(0,t.jsx)(zs,{ref:n,...J}):(0,t.jsx)("div",{className:"aspect-[9/16] w-full bg-zinc-900",children:(0,t.jsx)("img",{src:l.media?.[0]?.preview||l.media?.[0]?.thumbnail||S,className:"h-full w-full object-cover opacity-50 blur-xl",alt:"Reel preview"})})}),!T&&(0,t.jsx)("div",{className:"absolute inset-0 z-[60] flex items-center justify-center bg-zinc-900 pointer-events-none",children:(0,t.jsx)(Xs,{})}),(0,t.jsx)(Qe,{children:c&&(0,t.jsx)(G.div,{initial:{scale:0,opacity:0},animate:{scale:[0,1.2,1],opacity:1},exit:{scale:1.5,opacity:0},transition:{duration:.5,type:"spring",stiffness:400,damping:20},className:"pointer-events-none absolute inset-0 z-50 flex items-center justify-center",children:(0,t.jsx)(Le,{size:120,fill:"white",className:"text-white drop-shadow-[0_0_30px_rgba(255,255,255,0.4)]"})})}),(0,t.jsx)(Qe,{children:b&&(0,t.jsx)(G.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},exit:{scale:1.5,opacity:0},transition:{duration:.4},className:"absolute inset-0 z-50 flex items-center justify-center",onClick:k=>{k.stopPropagation(),A()},children:(0,t.jsx)("div",{className:"rounded-full border border-white/20 bg-white/10 p-8 shadow-2xl backdrop-blur-md cursor-pointer hover:bg-white/20 transition-colors",children:b==="play"?(0,t.jsx)(Ae,{size:50,fill:"white",className:"ml-1.5 text-white"}):(0,t.jsx)(ys,{size:50,fill:"white",className:"text-white"})})})}),(0,t.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-black/60"}),(0,t.jsxs)("div",{className:"pointer-events-none absolute bottom-6 left-4 right-16 text-white",children:[(0,t.jsxs)("div",{className:"pointer-events-auto mb-3 flex items-center gap-2",children:[(0,t.jsxs)(Yt,{to:`/u/${l.user?.handle}`,className:"flex items-center gap-2 transition-opacity hover:opacity-80 active:scale-95",onClick:k=>k.stopPropagation(),children:[(0,t.jsxs)(Ne,{className:"size-10 border-2 border-white",children:[(0,t.jsx)(ze,{src:l.user?.avatar,alt:l.user?.handle,className:"object-cover"}),(0,t.jsx)(we,{children:l.user?.handle?.[0]?.toUpperCase()})]}),(0,t.jsxs)("span",{className:"font-bold",children:["@",l.user?.handle]})]}),i?.id!==l.user?.id&&(0,t.jsx)("button",{className:`ml-2 flex items-center gap-1.5 rounded-full px-3 py-1.5 text-xs font-bold transition-all active:scale-95 ${C?"border border-white/50 bg-transparent text-white":"bg-white text-black hover:bg-zinc-200"}`,onClick:q,children:C?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Ws,{size:14}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Following"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(qs,{size:14}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Follow"})]})})]}),(0,t.jsx)(Ze,{content:l.content,className:"mb-3 line-clamp-2 text-sm text-white"}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs opacity-90",children:[(0,t.jsx)(js,{size:14,className:"animate-spin-slow"}),(0,t.jsxs)("span",{children:["Original Audio - ",l.user?.handle]})]})]}),(0,t.jsxs)("div",{className:"absolute bottom-6 right-2 z-10 flex flex-col items-center gap-6",children:[(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)(G.button,{whileTap:{scale:.8},className:`rounded-full p-3 backdrop-blur-md transition-all ${j?"bg-rose-500/20 text-rose-500":"bg-zinc-800/50 text-white hover:bg-zinc-700"}`,onClick:W,children:(0,t.jsx)(G.div,{animate:j?{scale:[1,1.3,1]}:{scale:1},transition:{duration:.3},children:(0,t.jsx)(Le,{size:28,fill:j?"currentColor":"none"})})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:N})]}),(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)(G.button,{whileTap:{scale:.8},className:"rounded-full bg-zinc-800/50 p-3 text-white backdrop-blur-md transition-colors hover:bg-zinc-700",onClick:k=>{k.stopPropagation(),m(!0)},children:(0,t.jsx)(Bt,{size:28})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:l.stats?.comments||0})]}),(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)(G.button,{whileTap:{scale:.8},className:"rounded-full bg-zinc-800/50 p-3 text-white backdrop-blur-md transition-colors hover:bg-zinc-700",onClick:Q,children:(0,t.jsx)(De,{size:28})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:l.stats?.shares||0})]}),(0,t.jsx)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:(0,t.jsx)(G.button,{whileTap:{scale:.8},className:"rounded-full bg-zinc-800/50 p-3 text-white backdrop-blur-md transition-colors hover:bg-rose-500/20 hover:text-rose-500",onClick:k=>{k.stopPropagation(),o("reel",l.id)},children:(0,t.jsx)(He,{size:28})})})]}),(0,t.jsx)("div",{className:"absolute bottom-0 left-0 z-50 h-[3px] w-full bg-white/20 hover:h-[8px] transition-all cursor-pointer group",onClick:I,children:(0,t.jsx)("div",{className:"h-full bg-white shadow-[0_0_8px_rgba(255,255,255,0.8)] transition-all duration-100 ease-linear relative",style:{width:`${R}%`},children:(0,t.jsx)("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 size-3 bg-white rounded-full shadow-lg scale-0 group-hover:scale-100 transition-transform"})})})]}),(0,t.jsx)(Kl,{isOpen:g,onClose:()=>m(!1),reelId:l.id,currentUser:i,showToast:a}),(0,t.jsx)(Ht,{isOpen:x,onClose:()=>u(!1),url:Zs(l.id),title:"Share Reel",overlayClassName:"z-[9999]"})]})},(l,e)=>l.isActive===e.isActive&&l.reel.id===e.reel.id&&l.volume===e.volume&&l.shouldLoad===e.shouldLoad),ni=Ql,Jl=({isOpen:l,onClose:e,reelId:s,currentUser:r,showToast:i})=>{const[a,o]=(0,z.useState)([]),[n,c]=(0,z.useState)(!1),[h,g]=(0,z.useState)(!1),[m,x]=(0,z.useState)(""),[u,d]=(0,z.useState)([]),[v,b]=(0,z.useState)(!1),[p,j]=(0,z.useState)(!0),[w,N]=(0,z.useState)(!1),[$,C]=(0,z.useState)(null),f=(0,z.useRef)(a);(0,z.useEffect)(()=>{f.current=a},[a]);const R=(0,z.useCallback)(async(T=!1)=>{if(!(!s||s.startsWith("temp-"))){T?N(!0):c(!0);try{const y=f.current,P=await Ns(s,T&&y.length>0?y[y.length-1].created_at:null,10);P.length<10?j(!1):j(!0),o(T?S=>[...S,...P]:P)}catch(y){console.error("Failed to load comments:",y),i&&i("Failed to load comments","error")}finally{c(!1),N(!1)}}},[s,i]);(0,z.useEffect)(()=>{l&&s?R():(o([]),j(!0))},[l,s,R]);const E=async(T,y)=>{if(T?.preventDefault(),!(!m.trim()&&u.length===0&&!y||!r)){g(!0),b(!0);try{let P=[],S="text",M=null;if(y)P=[await _e(new File([y.blob],"voice-comment.webm",{type:"audio/webm"}))],S="voice",M=y.duration;else for(const I of u){const D=await _e(I);P.push(D)}await Js(s,r.id,m,P,$?.id,S,M),x(""),d([]),C(null),i&&i(S==="voice"?"Voice reply posted!":"Reply posted!"),R()}catch(P){console.error("Failed to post comment:",P),i&&i("Failed to post reply.","error")}finally{g(!1),b(!1)}}};return(0,t.jsx)(Ut,{isOpen:l,onClose:e,title:"Comments",className:"max-sm:h-[95dvh] h-[85vh] overflow-hidden !p-0 sm:max-w-xl",children:(0,t.jsxs)("div",{className:"flex h-full flex-col overflow-hidden bg-white dark:bg-zinc-900",children:[(0,t.jsx)("div",{className:"mx-auto my-3 h-1.5 w-12 shrink-0 rounded-full bg-zinc-200 dark:bg-zinc-800 sm:hidden"}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto scroll-smooth scrollbar-thin scrollbar-thumb-zinc-200 dark:scrollbar-thumb-zinc-800",children:n?(0,t.jsx)("div",{className:"flex flex-col",children:[1,2,3].map(T=>(0,t.jsx)(Ts,{},T))}):a.length>0?(0,t.jsxs)("div",{className:"flex flex-col",children:[a.map(T=>(0,t.jsx)(Bl,{...T,isComment:!0,post_id:s,currentUser:r,showToast:i,onReply:(y,P)=>{C(P?{handle:y,id:P}:null),x(S=>S.includes(`@${y}`)?S:S+`@${y} `)},onDelete:y=>o(P=>P.filter(S=>S.id!==y)),onUpdate:(y,P,S)=>o(M=>M.map(I=>I.id===y?{...I,content:P,media:S}:I))},T.id)),p&&(0,t.jsx)("div",{className:"flex justify-center border-t border-zinc-100 py-4 dark:border-zinc-800",children:(0,t.jsx)(Dt,{variant:"ghost",onClick:()=>R(!0),loading:w,className:"text-violet-600 font-bold",children:"View more replies"})})]}):(0,t.jsxs)("div",{className:"flex h-full min-h-[300px] flex-col items-center justify-center p-8 text-center text-zinc-500",children:[(0,t.jsx)("div",{className:"mb-4 flex size-16 items-center justify-center rounded-full bg-zinc-100 dark:bg-zinc-900",children:(0,t.jsx)(At,{size:32,className:"text-zinc-400"})}),(0,t.jsx)("p",{className:"text-lg font-bold dark:text-zinc-300",children:"No comments yet"}),(0,t.jsx)("p",{className:"text-sm dark:text-zinc-500",children:"Be the first to share what you think!"})]})}),(0,t.jsxs)("div",{className:"shrink-0 border-t border-zinc-100 bg-white pb-safe dark:border-zinc-800 dark:bg-zinc-900",children:[$&&(0,t.jsxs)("div",{className:"flex items-center justify-between border-b border-zinc-50 bg-zinc-50/50 px-4 py-2 dark:border-zinc-800/50 dark:bg-zinc-900/50",children:[(0,t.jsxs)("span",{className:"text-xs text-zinc-500",children:["Replying to"," ",(0,t.jsxs)("span",{className:"font-bold text-violet-600",children:["@",$.handle]})]}),(0,t.jsx)("button",{onClick:()=>C(null),className:"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200",children:(0,t.jsx)($e,{size:14})})]}),(0,t.jsx)(qt,{currentUser:r,newComment:m,setNewComment:x,handleSubmitComment:E,loading:h,selectedFiles:u,setSelectedFiles:d,isUploading:v})]})]})})},Kl=Jl;export{ai as n,Bl as r,ni as t};
