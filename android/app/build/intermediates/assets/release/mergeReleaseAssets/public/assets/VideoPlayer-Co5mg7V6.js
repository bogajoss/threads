import{a as S}from"./rolldown-runtime-BaZ8gS7u.js";import{c as R,l as I,v as j,w}from"./framework-3lkjbTvb.js";import{n as T}from"./media-libs-C98UjHPF.js";import{Ln as x,dn as D,on as M}from"./index-B4ok2lMU.js";import{i as U,n as O,r as $,t as F}from"./text-processing-BMF44JzJ.js";var q=$("hashtag",{isLink:!0});function B({scanner:e,parser:t}){const{POUND:c,UNDERSCORE:d,FULLWIDTHMIDDLEDOT:a,ASCIINUMERICAL:m,ALPHANUMERICAL:f}=e.tokens,{alpha:u,numeric:i,alphanumeric:r,emoji:l}=e.tokens.groups,o=t.start.tt(c),s=o.tt(d),n=new O(q);o.tt(m,n),o.tt(f,n),o.ta(i,s),o.ta(u,n),o.ta(l,n),o.ta(a,n),s.tt(m,n),s.tt(f,n),s.ta(u,n),s.ta(l,n),s.ta(a,n),s.ta(i,s),s.tt(d,s),n.ta(r,n),n.ta(l,n),n.tt(a,n),n.tt(d,n)}U("hashtag",B);var V=$("mention",{isLink:!0,toHref(){return"/"+this.toString().slice(1)}});function W({scanner:e,parser:t}){const{HYPHEN:c,SLASH:d,UNDERSCORE:a,AT:m}=e.tokens,{domain:f}=e.tokens.groups,u=t.start.tt(m),i=u.tt(c);i.tt(c,i);const r=u.tt(a,V);u.ta(f,r),i.tt(a,r),i.ta(f,r),r.ta(f,r),r.tt(c,r),r.tt(a,r);const l=r.tt(d);l.ta(f,r),l.tt(a,r),l.tt(c,r)}U("mention",W);const G={formatHref:(e,t)=>t==="mention"?`/u/${e.substring(1)}`:t==="hashtag"?`/tags/${e.substring(1)}`:e,attributes:{onClick:e=>e.stopPropagation(),className:"cursor-pointer font-bold text-rose-600 hover:underline dark:text-rose-400"},validate:{hashtag:e=>/^#[\u0980-\u09FF\w]+$/.test(e)},target:(e,t)=>t==="url"?"_blank":void 0,rel:(e,t)=>t==="url"?"noopener noreferrer":void 0},E={BASE_URL:"https://feed.systemadminbd.com",APP_ID:"com.mysys.app",CUSTOM_SCHEME:"mysys"},A=()=>("Capacitor"in window,E.BASE_URL),L=e=>`${A()}${e.startsWith("/")?e:`/${e}`}`,at=e=>L(`/p/${e}`),it=e=>L(`/r/${e}`);var Y=R(),N=S(w(),1),b=S(I(),1),z=e=>{const t=(0,Y.c)(13),{content:c,className:d,onClick:a}=e,m=j(),f=J;let u;t[0]!==c?(u=typeof c=="string"?f(c):c,t[0]=c,t[1]=u):u=t[1];const i=u;let r;t[2]!==d?(r=x("whitespace-pre-line break-words",d),t[2]=d,t[3]=r):r=t[3];let l;t[4]!==m?(l={...G,render:n=>{const{attributes:y,content:g}=n,{href:h,..._}=y,k=A();if(h.includes("internal.tag/")){const v=decodeURIComponent(h.split("internal.tag/")[1]);return(0,b.jsxs)("span",{..._,className:x("cursor-pointer font-bold text-blue-600 hover:underline dark:text-blue-400",_.className),onClick:C=>{C.stopPropagation(),m(`/tags/${v}`)},children:["#",v]},g)}let p=null;return h.startsWith("/")?p=h:h.startsWith(k)&&(p=h.replace(k,"")),p?(0,b.jsx)("span",{..._,className:x("cursor-pointer font-medium text-blue-600 hover:underline dark:text-blue-400",_.className),onClick:v=>{v.stopPropagation(),m(p)},children:g},g):(0,b.jsx)("a",{href:h,..._,target:"_blank",rel:"noopener noreferrer",className:x("text-blue-600 hover:underline dark:text-blue-400",_.className),onClick:K,children:g},g)}},t[4]=m,t[5]=l):l=t[5];let o;t[6]!==i||t[7]!==l?(o=(0,b.jsx)(F,{options:l,children:i}),t[6]=i,t[7]=l,t[8]=o):o=t[8];let s;return t[9]!==a||t[10]!==r||t[11]!==o?(s=(0,b.jsx)("div",{className:r,onClick:a,children:o}),t[9]=a,t[10]=r,t[11]=o,t[12]=s):s=t[12],s},lt=z;function J(e){return e.replace(/#([\u0980-\u09FF\w]+)/g,"https://internal.tag/$1")}function K(e){return e.stopPropagation()}var Q=R(),X=e=>{const t=(0,Q.c)(17),{src:c,poster:d}=e,a=(0,N.useRef)(null),{reportVisibility:m,unregister:f}=M(),{dataSaver:u}=D(),i=(0,N.useId)();let r;t[0]===Symbol.for("react.memo_cache_sentinel")?(r={play:()=>{const p=a.current?.plyr;p&&(p.muted=!0,p.play().catch(Z))},pause:()=>{const p=a.current?.plyr;p&&typeof p.pause=="function"&&p.pause()}},t[0]=r):r=t[0];const l=r;let o,s;t[1]!==u||t[2]!==i||t[3]!==m||t[4]!==f?(o=()=>{const p=new IntersectionObserver(P=>{const[H]=P;m(i,u?0:H.intersectionRatio,l)},{threshold:[0,.25,.5,.75,1]}),v=a.current?.elements?.container,C=a.current;return v&&p.observe(v),()=>{const P=C?.plyr;P&&typeof P.pause=="function"&&P.pause(),f(i),v&&p.unobserve(v)}},s=[i,m,f,l,u],t[1]=u,t[2]=i,t[3]=m,t[4]=f,t[5]=o,t[6]=s):(o=t[5],s=t[6]),(0,N.useEffect)(o,s);let n;t[7]!==c?(n=[{src:c,type:"video/mp4"}],t[7]=c,t[8]=n):n=t[8];let y;t[9]!==d||t[10]!==n?(y={type:"video",sources:n,poster:d},t[9]=d,t[10]=n,t[11]=y):y=t[11];let g;t[12]===Symbol.for("react.memo_cache_sentinel")?(g={controls:["play-large","play","progress","current-time","mute","volume","fullscreen"],settings:["quality","speed"],ratio:"16:9",clickToPlay:!0,hideControls:!0,resetOnEnd:!0},t[12]=g):g=t[12];let h;t[13]!==y?(h={source:y,options:g},t[13]=y,t[14]=h):h=t[14];const _=h;let k;return t[15]!==_?(k=(0,b.jsx)("div",{className:"w-full bg-black",onClick:tt,children:(0,b.jsx)(T,{ref:a,..._})}),t[15]=_,t[16]=k):k=t[16],k},ct=X;function Z(){}function tt(e){return e.stopPropagation()}export{it as i,lt as n,at as r,ct as t};
