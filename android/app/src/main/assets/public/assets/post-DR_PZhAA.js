import{a as _t}from"./rolldown-runtime-BaZ8gS7u.js";import{c as J,d as Qt,l as Gt,n as Jt,v as St,w as Kt}from"./framework-3lkjbTvb.js";import{a as Xt,r as Zt}from"./query-CZHA9T67.js";import{$t as Yt,At as de,Bn as es,Dn as ts,En as ss,Fn as je,Gn as ls,Hn as is,Jn as as,Kn as Se,Ln as Ye,Lt as et,Sn as ns,Un as rs,Vt as tt,Zt as st,an as $e,cn as lt,dn as os,gn as cs,in as ds,on as Pe,pn as ms,rn as Te,sn as it,tr as fs,un as us,yn as $t,zn as Fe,zt as xs}from"./ui-libs-BrvosAtl.js";import{n as hs}from"./media-libs-C98UjHPF.js";import{$t as at,Cn as ps,Ct as gs,Dn as nt,Dt as bs,Et as vs,F as js,Fn as Re,Ft as ys,H as ye,I as ks,Jt as Me,K as zs,Ln as ce,M as Pt,N as Ns,Nn as ws,On as Cs,Q as _s,Qt as rt,Rn as Ee,Sn as Ss,St as $s,Tn as Tt,Tt as te,U as Ps,Un as ot,Vn as ct,Wt as Ft,Xt as dt,Yt as mt,Z as Ts,Zt as ft,_n as Fs,_t as Rt,an as le,cn as Rs,en as ut,fn as Mt,g as xt,gn as ht,in as ie,j as Ms,kn as Es,ln as Is,nn as pt,pn as Ls,qt as Q,rn as ae,sn as Et,tn as gt,un as Le,v as Ds,vn as As,wn as Us,z as Os,zn as ge}from"./index-DmpXIVBL.js";import{i as Bs,n as De,r as Vs}from"./VideoPlayer-ChzJOyvm.js";import{n as se,t as Ws}from"./actionsheet-rdhGJIs7.js";var Hs=J(),z=_t(Kt(),1),t=_t(Gt(),1),qs=l=>{const e=(0,Hs.c)(37),{isComment:s,liked:r,reposted:i,handleLike:a,handleRepost:o,handleCommentClick:n,handleShareClick:c,isDetail:x}=l;if(x!==void 0&&x){let N;e[0]!==a||e[1]!==r?(N=(0,t.jsx)(X,{icon:je,label:"Like",type:"like",onClick:a,active:r}),e[0]=a,e[1]=r,e[2]=N):N=e[2];let w;e[3]!==o||e[4]!==s||e[5]!==i?(w=!s&&(0,t.jsx)(X,{icon:Te,label:"Repost",type:"repost",onClick:o,active:i}),e[3]=o,e[4]=s,e[5]=i,e[6]=w):w=e[6];let C;e[7]!==n?(C=(0,t.jsx)(X,{icon:Pt,label:"Comment",type:"comment",onClick:n}),e[7]=n,e[8]=C):C=e[8];let _;e[9]!==c||e[10]!==s?(_=!s&&(0,t.jsx)(X,{icon:ye,label:"Share",type:"share",onClick:c}),e[9]=c,e[10]=s,e[11]=_):_=e[11];let f;return e[12]!==N||e[13]!==w||e[14]!==C||e[15]!==_?(f=(0,t.jsxs)("div",{className:"mt-5 flex w-full items-center justify-around py-2",children:[N,w,C,_]}),e[12]=N,e[13]=w,e[14]=C,e[15]=_,e[16]=f):f=e[16],f}const g=`flex items-center gap-x-1.5 ${s?"mt-2":"mt-3.5"}`,m=s?16:18;let h;e[17]!==a||e[18]!==r||e[19]!==m?(h=(0,t.jsx)(X,{icon:je,size:m,type:"like",onClick:a,active:r}),e[17]=a,e[18]=r,e[19]=m,e[20]=h):h=e[20];const v=s?16:18;let d;e[21]!==n||e[22]!==v?(d=(0,t.jsx)(X,{icon:$t,size:v,type:"comment",onClick:n}),e[21]=n,e[22]=v,e[23]=d):d=e[23];const b=s?16:18;let p;e[24]!==o||e[25]!==i||e[26]!==b?(p=(0,t.jsx)(X,{icon:Te,size:b,type:"repost",onClick:o,active:i}),e[24]=o,e[25]=i,e[26]=b,e[27]=p):p=e[27];let u;e[28]!==c||e[29]!==s?(u=!s&&c&&(0,t.jsx)(X,{icon:ye,type:"share",onClick:c}),e[28]=c,e[29]=s,e[30]=u):u=e[30];let y;return e[31]!==g||e[32]!==h||e[33]!==d||e[34]!==p||e[35]!==u?(y=(0,t.jsxs)("div",{className:g,children:[h,d,p,u]}),e[31]=g,e[32]=h,e[33]=d,e[34]=p,e[35]=u,e[36]=y):y=e[36],y},bt=qs,Qs=J(),Gs=l=>{const e=(0,Qs.c)(38),{views:s,likes:r,comments:i,isDetail:a,isComment:o,onRepliesClick:n}=l,c=a===void 0?!1:a,x=o===void 0?!1:o;if(c){const p=s||0;let u;e[0]!==p?(u=(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:p}),e[0]=p,e[1]=u):u=e[1];let y;e[2]===Symbol.for("react.memo_cache_sentinel")?(y=(0,t.jsx)("span",{className:"opacity-70",children:"Views"}),e[2]=y):y=e[2];let N;e[3]!==u?(N=(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[u," ",y]}),e[3]=u,e[4]=N):N=e[4];const w=r||0;let C;e[5]!==w?(C=(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:w}),e[5]=w,e[6]=C):C=e[6];let _;e[7]===Symbol.for("react.memo_cache_sentinel")?(_=(0,t.jsx)("span",{className:"opacity-70",children:"Likes"}),e[7]=_):_=e[7];let f;e[8]!==C?(f=(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[C," ",_]}),e[8]=C,e[9]=f):f=e[9];const F=i||0;let R;e[10]!==F?(R=(0,t.jsx)("span",{className:"font-bold text-black dark:text-white",children:F}),e[10]=F,e[11]=R):R=e[11];let P;e[12]===Symbol.for("react.memo_cache_sentinel")?(P=(0,t.jsx)("span",{className:"opacity-70",children:"Comments"}),e[12]=P):P=e[12];let k;e[13]!==R?(k=(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[R," ",P]}),e[13]=R,e[14]=k):k=e[14];let T;return e[15]!==f||e[16]!==k||e[17]!==N?(T=(0,t.jsxs)("div",{className:"mt-5 flex items-center gap-x-6 border-b border-zinc-100 pb-4 text-sm text-zinc-500 dark:border-zinc-800 dark:text-zinc-400",children:[N,f,k]}),e[15]=f,e[16]=k,e[17]=N,e[18]=T):T=e[18],T}if(i===0&&r===0&&(s===0||x))return null;const g=`mt-2 flex items-center gap-x-2 px-0.5 ${x?"text-[12px]":"text-[14px]"} font-medium text-zinc-500 dark:text-zinc-400`;let m;e[19]!==i||e[20]!==x||e[21]!==r||e[22]!==s?(m=s>0&&!x&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{className:"hover:underline",children:[s," ",s===1?"view":"views"]}),(i>0||r>0)&&(0,t.jsx)("span",{className:"opacity-50",children:"·"})]}),e[19]=i,e[20]=x,e[21]=r,e[22]=s,e[23]=m):m=e[23];let h;e[24]!==i||e[25]!==n?(h=i>0&&(0,t.jsxs)("button",{className:"hover:underline",onClick:p=>{p.stopPropagation(),n&&n(p)},children:[i," ",i===1?"reply":"replies"]}),e[24]=i,e[25]=n,e[26]=h):h=e[26];let v;e[27]!==i||e[28]!==r?(v=i>0&&r>0&&(0,t.jsx)("span",{className:"opacity-50",children:"·"}),e[27]=i,e[28]=r,e[29]=v):v=e[29];let d;e[30]!==r?(d=r>0&&(0,t.jsxs)("button",{className:"hover:underline",children:[r," ",r===1?"like":"likes"]}),e[30]=r,e[31]=d):d=e[31];let b;return e[32]!==g||e[33]!==m||e[34]!==h||e[35]!==v||e[36]!==d?(b=(0,t.jsxs)("div",{className:g,children:[m,h,v,d]}),e[32]=g,e[33]=m,e[34]=h,e[35]=v,e[36]=d,e[37]=b):b=e[37],b},vt=Gs,Js=J(),Ks=l=>{const e=(0,Js.c)(52),{user:s,timeAgo:r,community:i,onUserClick:a,actionsMenu:o,isComment:n,isDetail:c,showAvatar:x,isPinned:g}=l,m=x===void 0?!1:x,h=g===void 0?!1:g,v=St();let d;e[0]!==a||e[1]!==s.handle?(d=U=>{U.stopPropagation(),a&&a(s.handle)},e[0]=a,e[1]=s.handle,e[2]=d):d=e[2];const b=d;let p;e[3]!==i||e[4]!==v?(p=U=>{U.stopPropagation(),i&&v(`/c/${i.handle}`)},e[3]=i,e[4]=v,e[5]=p):p=e[5];const u=p,y=`flex items-center justify-between ${c?"pb-5":"min-h-[40px] mb-2"}`;let N;e[6]!==b||e[7]!==n||e[8]!==c||e[9]!==m||e[10]!==s.avatar||e[11]!==s.handle?(N=m&&(0,t.jsx)("button",{className:"shrink-0",onClick:b,children:(0,t.jsxs)(ae,{className:`${c?"size-12":n?"size-8":"size-10"} border-0 shadow-sm`,children:[(0,t.jsx)(le,{src:s.avatar,alt:s.handle,className:"object-cover"}),(0,t.jsx)(ie,{className:"text-xs",children:s.handle[0]?.toUpperCase()})]})}),e[6]=b,e[7]=n,e[8]=c,e[9]=m,e[10]=s.avatar,e[11]=s.handle,e[12]=N):N=e[12];const w=`flex shrink-0 items-center gap-1 font-bold text-zinc-900 hover:underline dark:text-white ${c?"text-base sm:text-lg":n?"text-[14px]":"text-[15px]"}`;let C;e[13]!==s.handle?(C=(0,t.jsx)("span",{className:"max-w-[150px] truncate sm:max-w-none",children:s.handle}),e[13]=s.handle,e[14]=C):C=e[14];let _;e[15]!==n||e[16]!==c||e[17]!==s.role?(_=s.role==="admin"&&(0,t.jsx)(Ms,{size:c?28:n?22:24}),e[15]=n,e[16]=c,e[17]=s.role,e[18]=_):_=e[18];let f;e[19]!==n||e[20]!==c||e[21]!==s.verified?(f=s.verified&&(0,t.jsx)(Ps,{size:c?16:n?12:14}),e[19]=n,e[20]=c,e[21]=s.verified,e[22]=f):f=e[22];let F;e[23]!==b||e[24]!==f||e[25]!==w||e[26]!==C||e[27]!==_?(F=(0,t.jsxs)("button",{className:w,onClick:b,children:[C,_,f]}),e[23]=b,e[24]=f,e[25]=w,e[26]=C,e[27]=_,e[28]=F):F=e[28];let R;e[29]!==i||e[30]!==u||e[31]!==c?(R=i&&(0,t.jsxs)("div",{className:"flex min-w-0 items-center gap-1 text-zinc-500",children:[(0,t.jsx)(Ns,{size:c?14:12,className:"shrink-0 text-zinc-400"}),(0,t.jsxs)("button",{className:`flex items-center gap-1 font-bold text-zinc-900 hover:underline dark:text-zinc-100 ${c?"text-[14px] sm:text-[15px]":"text-[13px]"}`,onClick:u,children:[(0,t.jsxs)(ae,{className:"size-3.5 shrink-0 border border-zinc-200 bg-zinc-100 dark:border-zinc-700 dark:bg-zinc-800",children:[(0,t.jsx)(le,{src:i.avatar,alt:i.name,className:"object-cover"}),(0,t.jsx)(ie,{className:"text-[6px] font-bold text-zinc-500",children:i.name?.[0]?.toUpperCase()})]}),(0,t.jsx)("span",{className:"max-w-[150px] truncate sm:max-w-none",children:i.name})]})]}),e[29]=i,e[30]=u,e[31]=c,e[32]=R):R=e[32];let P;e[33]!==F||e[34]!==R?(P=(0,t.jsx)("div",{className:"flex min-w-0 flex-1 flex-col",children:(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-x-1.5 leading-none",children:(0,t.jsxs)("div",{className:"flex min-w-0 max-w-full items-center gap-1.5",children:[F,R]})})}),e[33]=F,e[34]=R,e[35]=P):P=e[35];let k;e[36]!==P||e[37]!==N?(k=(0,t.jsxs)("div",{className:"flex items-center gap-x-3.5 flex-1 min-w-0",children:[N,P]}),e[36]=P,e[37]=N,e[38]=k):k=e[38];let T;e[39]!==n||e[40]!==h?(T=h&&!n&&(0,t.jsx)("div",{className:"flex items-center justify-center p-1 opacity-80",children:(0,t.jsx)(Pe,{size:14,className:"fill-zinc-400 text-zinc-400 dark:fill-zinc-500 dark:text-zinc-500"})}),e[39]=n,e[40]=h,e[41]=T):T=e[41];const S=r||"Recent";let E;e[42]!==S?(E=(0,t.jsx)("span",{className:"whitespace-nowrap text-[12px] text-zinc-500 dark:text-zinc-400",children:S}),e[42]=S,e[43]=E):E=e[43];let L;e[44]!==o||e[45]!==T||e[46]!==E?(L=(0,t.jsxs)("div",{className:"-mt-1 flex items-center gap-2.5",children:[T,E,o]}),e[44]=o,e[45]=T,e[46]=E,e[47]=L):L=e[47];let D;return e[48]!==k||e[49]!==L||e[50]!==y?(D=(0,t.jsxs)("div",{className:y,children:[k,L]}),e[48]=k,e[49]=L,e[50]=y,e[51]=D):D=e[51],D},jt=Ks,Xs=J(),Zs=l=>{const e=(0,Xs.c)(40),{content:s,isDetail:r,isEditing:i,editedContent:a,setEditedContent:o,onCancelEdit:n,onSaveEdit:c,isUpdating:x,contentClass:g}=l,[m,h]=(0,z.useState)(!1),v=typeof s=="string"&&ot(s);if(i&&o){let F;e[0]!==o?(F=U=>o(U.target.value),e[0]=o,e[1]=F):F=e[1];const R=`min-h-[100px] w-full rounded-xl border-zinc-200 bg-zinc-50 focus:ring-violet-500 dark:border-zinc-800 dark:bg-zinc-900 ${ot(a||"")?"font-bangla text-lg":"font-english"}`;let P;e[2]!==a||e[3]!==F||e[4]!==R?(P=(0,t.jsx)(zs,{value:a,onChange:F,className:R,autoFocus:!0}),e[2]=a,e[3]=F,e[4]=R,e[5]=P):P=e[5];let k;e[6]!==n?(k=(0,t.jsx)("button",{onClick:n,className:"px-4 py-1.5 text-sm font-bold text-zinc-500 transition-colors hover:text-zinc-700 dark:hover:text-zinc-300",children:"Cancel"}),e[6]=n,e[7]=k):k=e[7];let T;e[8]!==s||e[9]!==a||e[10]!==x?(T=x||!a?.trim()||a===s,e[8]=s,e[9]=a,e[10]=x,e[11]=T):T=e[11];const S=x?"Saving...":"Save";let E;e[12]!==c||e[13]!==T||e[14]!==S?(E=(0,t.jsx)("button",{onClick:c,disabled:T,className:"rounded-full bg-violet-600 px-4 py-1.5 text-sm font-bold text-white transition-all hover:bg-violet-700 disabled:opacity-50 active:scale-95",children:S}),e[12]=c,e[13]=T,e[14]=S,e[15]=E):E=e[15];let L;e[16]!==k||e[17]!==E?(L=(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[k,E]}),e[16]=k,e[17]=E,e[18]=L):L=e[18];let D;return e[19]!==P||e[20]!==L?(D=(0,t.jsxs)("div",{className:"mt-2 flex flex-col gap-2",onClick:Ys,children:[P,L]}),e[19]=P,e[20]=L,e[21]=D):D=e[21],D}const d=!r&&s.length>280;let b;e[22]!==s||e[23]!==m||e[24]!==d?(b=d&&!m?s.substring(0,280):s,e[22]=s,e[23]=m,e[24]=d,e[25]=b):b=e[25];const p=b,u=r?"text-lg leading-relaxed sm:text-xl sm:leading-8 mt-1":"text-[15px] leading-snug mt-0.5",y=v?"font-bangla text-[1.15em]":"font-english";let N;e[26]!==g||e[27]!==u||e[28]!==y?(N=ce("whitespace-pre-line break-words",u,y,g),e[26]=g,e[27]=u,e[28]=y,e[29]=N):N=e[29];let w;e[30]!==p?(w=(0,t.jsx)(De,{content:p}),e[30]=p,e[31]=w):w=e[31];const C=d&&!m&&"...";let _;e[32]!==m||e[33]!==d?(_=d&&(0,t.jsx)("button",{onClick:F=>{F.stopPropagation(),h(!m)},className:"ml-1 cursor-pointer font-bold text-rose-600 hover:underline dark:text-rose-400",children:m?"Show less":"See more"}),e[32]=m,e[33]=d,e[34]=_):_=e[34];let f;return e[35]!==N||e[36]!==w||e[37]!==C||e[38]!==_?(f=(0,t.jsxs)("div",{className:N,children:[w,C,_]}),e[35]=N,e[36]=w,e[37]=C,e[38]=_,e[39]=f):f=e[39],f},yt=Zs;function Ys(l){return l.stopPropagation()}var el=J(),tl=l=>{const e=(0,el.c)(28),{media:s,isEditing:r,editedMedia:i,setEditedMedia:a,newFiles:o,setNewFiles:n}=l;let c;e[0]!==i?(c=i===void 0?[]:i,e[0]=i,e[1]=c):c=e[1];const x=c;let g;e[2]!==o?(g=o===void 0?[]:o,e[2]=o,e[3]=g):g=e[3];const m=g,h=(0,z.useRef)(null);if(r&&a&&n){let d;if(e[4]!==x||e[5]!==a){let w;e[7]!==a?(w=(C,_)=>(0,t.jsxs)("div",{className:"group relative aspect-square overflow-hidden rounded-xl border border-zinc-200 dark:border-zinc-800",children:[C.type==="video"?(0,t.jsx)("div",{className:"flex size-full items-center justify-center bg-zinc-100 dark:bg-zinc-900",children:(0,t.jsx)(es,{size:24,className:"text-zinc-400"})}):(0,t.jsx)("img",{src:C.url||C.src,className:"size-full object-cover",alt:""}),(0,t.jsx)("button",{onClick:f=>{f.stopPropagation(),a(F=>F.filter((R,P)=>P!==_))},className:"absolute right-1.5 top-1.5 flex size-7 items-center justify-center rounded-full bg-black/60 text-white transition-colors hover:bg-black",children:(0,t.jsx)(de,{size:16})})]},`old-${_}`),e[7]=a,e[8]=w):w=e[8],d=x.map(w),e[4]=x,e[5]=a,e[6]=d}else d=e[6];let b;if(e[9]!==m||e[10]!==n){let w;e[12]!==n?(w=(C,_)=>(0,t.jsxs)("div",{className:"group relative aspect-square overflow-hidden rounded-xl border-2 border-dashed border-violet-500 bg-violet-50/10",children:[C.type.startsWith("image/")?(0,t.jsx)("img",{src:URL.createObjectURL(C),className:"size-full object-cover",alt:""}):(0,t.jsx)("div",{className:"flex size-full items-center justify-center",children:(0,t.jsx)(ss,{size:24,className:"animate-spin text-violet-500"})}),(0,t.jsx)("button",{onClick:f=>{f.stopPropagation(),n(F=>F.filter((R,P)=>P!==_))},className:"absolute right-1.5 top-1.5 flex size-7 items-center justify-center rounded-full bg-black/60 text-white transition-colors hover:bg-black",children:(0,t.jsx)(de,{size:16})}),(0,t.jsx)("div",{className:"absolute bottom-1 left-1 rounded bg-violet-600 px-1 text-[8px] font-bold text-white",children:"NEW"})]},`new-${_}`),e[12]=n,e[13]=w):w=e[13],b=m.map(w),e[9]=m,e[10]=n,e[11]=b}else b=e[11];let p;e[14]!==x.length||e[15]!==m.length?(p=x.length+m.length<4&&(0,t.jsxs)("button",{onClick:w=>{w.stopPropagation(),h.current?.click()},className:"relative flex aspect-square flex-col items-center justify-center gap-1 rounded-xl border-2 border-dashed border-zinc-200 text-zinc-400 transition-all hover:border-violet-500 hover:bg-violet-50/5 hover:text-violet-500 dark:border-zinc-800",children:[(0,t.jsx)(ds,{size:20}),(0,t.jsx)("span",{className:"text-[10px] font-bold",children:"Add Media"})]}),e[14]=x.length,e[15]=m.length,e[16]=p):p=e[16];let u;e[17]!==d||e[18]!==b||e[19]!==p?(u=(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:[d,b,p]}),e[17]=d,e[18]=b,e[19]=p,e[20]=u):u=e[20];let y;e[21]!==n?(y=(0,t.jsx)("input",{type:"file",ref:h,onChange:w=>{if(w.target.files){const C=Array.from(w.target.files);n(_=>[..._,...C])}},multiple:!0,className:"hidden",accept:"image/*,video/*"}),e[21]=n,e[22]=y):y=e[22];let N;return e[23]!==u||e[24]!==y?(N=(0,t.jsxs)("div",{className:"mt-3 space-y-3",children:[u,y]}),e[23]=u,e[24]=y,e[25]=N):N=e[25],N}if(!s||s.length===0)return null;let v;return e[26]!==s?(v=(0,t.jsx)(wl,{items:s}),e[26]=s,e[27]=v):v=e[27],v},kt=tl,sl=J(),ll=l=>{const e=(0,sl.c)(48),{icon:s,count:r,label:i,onClick:a,active:o,activeColorClass:n,size:c,type:x}=l,g=c===void 0?18:c,m=x===void 0?"default":x;let h,v,d,b,p,u,y;if(e[0]!==o||e[1]!==n||e[2]!==r||e[3]!==i||e[4]!==a||e[5]!==m){const L={like:{hoverBg:"group-hover:bg-rose-500/10",hoverText:"group-hover:text-rose-500",activeText:"text-rose-500",activeFill:"fill-rose-500"},repost:{hoverBg:"group-hover:bg-emerald-500/10",hoverText:"group-hover:text-emerald-500",activeText:"text-emerald-500",activeFill:"fill-emerald-500"},comment:{hoverBg:"group-hover:bg-sky-500/10",hoverText:"group-hover:text-sky-500",activeText:"text-sky-500",activeFill:"fill-sky-500"},share:{hoverBg:"group-hover:bg-violet-500/10",hoverText:"group-hover:text-violet-500",activeText:"text-violet-500",activeFill:"fill-violet-500"},default:{hoverBg:"group-hover:bg-zinc-500/10",hoverText:"group-hover:text-zinc-500",activeText:"text-zinc-900 dark:text-white",activeFill:"fill-current"}};v=L[m]||L.default;const D=n||v.activeText;h=Q.button,e[13]===Symbol.for("react.memo_cache_sentinel")?(b={scale:.85},e[13]=b):b=e[13],e[14]!==a?(p=U=>{U.stopPropagation(),a&&a(U)},e[14]=a,e[15]=p):p=e[15],u=`${i} ${r!==void 0?`(${r})`:""}`,y=ce("group -ml-2 flex items-center gap-x-0.5 rounded-xl px-2 py-1.5 text-[12px] font-bold transition-all sm:gap-x-1 sm:text-[13px]",o?D:"text-zinc-500",!o&&v.hoverText),d=ce("rounded-full p-2 transition-all duration-200",!o&&v.hoverBg),e[0]=o,e[1]=n,e[2]=r,e[3]=i,e[4]=a,e[5]=m,e[6]=h,e[7]=v,e[8]=d,e[9]=b,e[10]=p,e[11]=u,e[12]=y}else h=e[6],v=e[7],d=e[8],b=e[9],p=e[10],u=e[11],y=e[12];let N;e[16]!==o?(N=o?{scale:[1,1.4,1],rotate:[0,15,0]}:{scale:1},e[16]=o,e[17]=N):N=e[17];let w;e[18]===Symbol.for("react.memo_cache_sentinel")?(w={duration:.45,type:"spring",stiffness:300,damping:15},e[18]=w):w=e[18];const C=o?2.5:2,_=o&&v.activeFill;let f;e[19]!==_?(f=ce("transition-colors duration-200",_),e[19]=_,e[20]=f):f=e[20];let F;e[21]!==s||e[22]!==g||e[23]!==C||e[24]!==f?(F=(0,t.jsx)(s,{size:g,strokeWidth:C,className:f}),e[21]=s,e[22]=g,e[23]=C,e[24]=f,e[25]=F):F=e[25];let R;e[26]!==F||e[27]!==N?(R=(0,t.jsx)(Q.div,{animate:N,transition:w,children:F}),e[26]=F,e[27]=N,e[28]=R):R=e[28];let P;e[29]!==R||e[30]!==d?(P=(0,t.jsx)("div",{className:d,children:R}),e[29]=R,e[30]=d,e[31]=P):P=e[31];let k;e[32]!==i?(k=i&&(0,t.jsx)("span",{className:"hidden xs:inline",children:i}),e[32]=i,e[33]=k):k=e[33];let T;e[34]!==o||e[35]!==r?(T=r!=null&&(0,t.jsx)(Q.span,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},className:ce("transition-all",o?"font-black":"font-bold"),children:r||0},r),e[34]=o,e[35]=r,e[36]=T):T=e[36];let S;e[37]!==T?(S=(0,t.jsx)(Me,{mode:"wait",children:T}),e[37]=T,e[38]=S):S=e[38];let E;return e[39]!==h||e[40]!==P||e[41]!==k||e[42]!==S||e[43]!==b||e[44]!==p||e[45]!==u||e[46]!==y?(E=(0,t.jsxs)(h,{whileTap:b,onClick:p,"aria-label":u,className:y,children:[P,k,S]}),e[39]=h,e[40]=P,e[41]=k,e[42]=S,e[43]=b,e[44]=p,e[45]=u,e[46]=y,e[47]=E):E=e[47],E},X=ll,il=J(),al=l=>{const e=(0,il.c)(18),{poll:s,onVote:r}=l,i=s.options.reduce(nl,0),[a,o]=(0,z.useState)(null);let n;e[0]!==r||e[1]!==a?(n=d=>{a||(o(d),r&&r(d))},e[0]=r,e[1]=a,e[2]=n):n=e[2];const c=n;let x;if(e[3]!==c||e[4]!==s.options||e[5]!==i||e[6]!==a){let d;e[8]!==c||e[9]!==i||e[10]!==a?(d=(b,p)=>{const u=i>0?Math.round((b.votes+(a===b.id?1:0))/(i+(a?1:0))*100):0,y=a===b.id;return(0,t.jsxs)("div",{onClick:()=>c(b.id),className:`relative h-10 w-full overflow-hidden rounded-xl border cursor-pointer ${y?"border-violet-500 dark:border-violet-500":"border-zinc-200 dark:border-zinc-700"}`,children:[a&&(0,t.jsx)("div",{className:"absolute left-0 top-0 h-full bg-zinc-200 transition-all duration-500 dark:bg-zinc-800",style:{width:`${u}%`}}),(0,t.jsxs)("div",{className:"absolute inset-0 z-10 flex items-center justify-between px-4",children:[(0,t.jsxs)("span",{className:`text-sm font-medium ${y?"font-bold text-violet-600":"text-zinc-700 dark:text-zinc-200"}`,children:[b.text," ",y&&(0,t.jsx)(fs,{size:14,className:"mb-0.5 inline ml-1"})]}),a&&(0,t.jsxs)("span",{className:"text-sm font-bold text-zinc-900 dark:text-white",children:[u,"%"]})]})]},b.id||p)},e[8]=c,e[9]=i,e[10]=a,e[11]=d):d=e[11],x=s.options.map(d),e[3]=c,e[4]=s.options,e[5]=i,e[6]=a,e[7]=x}else x=e[7];const g=i+(a?1:0),m=a?"6 days left":"Click to vote";let h;e[12]!==g||e[13]!==m?(h=(0,t.jsxs)("div",{className:"pl-1 text-xs text-zinc-500 dark:text-zinc-400",children:[g," votes •"," ",m]}),e[12]=g,e[13]=m,e[14]=h):h=e[14];let v;return e[15]!==x||e[16]!==h?(v=(0,t.jsxs)("div",{className:"mt-3 space-y-2",children:[x,h]}),e[15]=x,e[16]=h,e[17]=v):v=e[17],v},zt=al;function nl(l,e){return l+e.votes}var rl=J(),ol=l=>{const e=(0,rl.c)(25),{user:s,time:r,content:i}=l;let a;e[0]!==s.avatar||e[1]!==s.handle?(a=(0,t.jsx)(le,{src:s.avatar,alt:s.handle}),e[0]=s.avatar,e[1]=s.handle,e[2]=a):a=e[2];let o;e[3]!==s.handle[0]?(o=s.handle[0]?.toUpperCase(),e[3]=s.handle[0],e[4]=o):o=e[4];let n;e[5]!==o?(n=(0,t.jsx)(ie,{children:o}),e[5]=o,e[6]=n):n=e[6];let c;e[7]!==a||e[8]!==n?(c=(0,t.jsxs)(ae,{className:"size-6",children:[a,n]}),e[7]=a,e[8]=n,e[9]=c):c=e[9];let x;e[10]!==s.handle?(x=(0,t.jsx)("span",{className:"text-sm font-semibold",children:s.handle}),e[10]=s.handle,e[11]=x):x=e[11];let g;e[12]!==c||e[13]!==x?(g=(0,t.jsxs)("div",{className:"flex items-center gap-x-2",children:[c,x]}),e[12]=c,e[13]=x,e[14]=g):g=e[14];let m;e[15]!==r?(m=(0,t.jsx)("span",{className:"text-xs text-zinc-500 sm:text-sm",children:r}),e[15]=r,e[16]=m):m=e[16];let h;e[17]!==g||e[18]!==m?(h=(0,t.jsxs)("div",{className:"mb-2 flex items-center justify-between gap-x-2",children:[g,m]}),e[17]=g,e[18]=m,e[19]=h):h=e[19];let v;e[20]!==i?(v=(0,t.jsx)(De,{content:i,className:"text-sm text-zinc-800 dark:text-zinc-300"}),e[20]=i,e[21]=v):v=e[21];let d;return e[22]!==h||e[23]!==v?(d=(0,t.jsxs)("div",{className:"p-4",children:[h,v]}),e[22]=h,e[23]=v,e[24]=d):d=e[24],d},Nt=ol,cl=J(),dl=l=>{const e=(0,cl.c)(60),{currentUser:s,newComment:r,setNewComment:i,handleSubmitComment:a,loading:o,selectedFiles:n,setSelectedFiles:c,isUploading:x}=l;let g;e[0]!==n?(g=n===void 0?[]:n,e[0]=n,e[1]=g):g=e[1];const m=g,h=(0,z.useRef)(null);let v;e[2]!==c?(v=I=>{if(I.target.files){const A=Array.from(I.target.files);c&&c(H=>[...H,...A])}},e[2]=c,e[3]=v):v=e[3];const d=v;let b;e[4]!==c?(b=I=>{c&&c(A=>A.filter((H,ne)=>ne!==I))},e[4]=c,e[5]=b):b=e[5];const p=b;let u;e[6]!==m?(u=m.map(ml),e[6]=m,e[7]=u):u=e[7];const y=u;let N,w;e[8]!==y?(N=()=>()=>{y.forEach(fl)},w=[y],e[8]=y,e[9]=N,e[10]=w):(N=e[9],w=e[10]),(0,z.useEffect)(N,w);let C;e[11]!==c?(C=I=>{const A=I.clipboardData.files;if(A&&A.length>0){const H=Array.from(A).filter(ul);H.length>0&&(I.preventDefault(),c&&c(ne=>[...ne,...H]))}},e[11]=c,e[12]=C):C=e[12];const _=C;if(!s){let I;return e[13]===Symbol.for("react.memo_cache_sentinel")?(I=(0,t.jsx)("div",{className:"border-y border-zinc-100 bg-zinc-50/30 p-6 text-center dark:border-zinc-800 dark:bg-zinc-900/10",children:(0,t.jsx)("p",{className:"text-sm text-zinc-500",children:"Please login to join the conversation."})}),e[13]=I):I=e[13],I}let f;e[14]!==s.avatar||e[15]!==s.handle?(f=(0,t.jsx)(le,{src:s.avatar,alt:s.handle,className:"object-cover"}),e[14]=s.avatar,e[15]=s.handle,e[16]=f):f=e[16];let F;e[17]!==s.handle?.[0]?(F=s.handle?.[0]?.toUpperCase(),e[17]=s.handle?.[0],e[18]=F):F=e[18];let R;e[19]!==F?(R=(0,t.jsx)(ie,{children:F}),e[19]=F,e[20]=R):R=e[20];let P;e[21]!==R||e[22]!==f?(P=(0,t.jsxs)(ae,{className:"size-9 border border-zinc-200 dark:border-zinc-700",children:[f,R]}),e[21]=R,e[22]=f,e[23]=P):P=e[23];let k;e[24]!==i?(k=I=>i(I.target.value),e[24]=i,e[25]=k):k=e[25];let T;e[26]!==_||e[27]!==r||e[28]!==k?(T=(0,t.jsx)("textarea",{id:"comment-input",className:"min-h-[60px] w-full resize-none bg-transparent text-base outline-none placeholder:text-zinc-500 dark:text-white",placeholder:"Post your reply...",value:r,onChange:k,onPaste:_}),e[26]=_,e[27]=r,e[28]=k,e[29]=T):T=e[29];let S;e[30]!==y||e[31]!==p||e[32]!==m?(S=m.length>0&&(0,t.jsx)("div",{className:"mt-2 mb-2 flex flex-wrap gap-2",children:m.map((I,A)=>(0,t.jsxs)("div",{className:"relative size-20 overflow-hidden rounded-xl border border-zinc-200 dark:border-zinc-800",children:[I.type.startsWith("image/")?(0,t.jsx)("img",{src:y[A],className:"size-full object-cover",alt:""}):(0,t.jsx)("div",{className:"flex size-full items-center justify-center bg-zinc-100 dark:bg-zinc-800",children:(0,t.jsx)(os,{size:20,className:"text-zinc-500"})}),(0,t.jsx)("button",{onClick:()=>p(A),className:"absolute right-1 top-1 rounded-full bg-black/60 p-1 text-white transition-colors hover:bg-black",children:(0,t.jsx)(de,{size:12})})]},A))}),e[30]=y,e[31]=p,e[32]=m,e[33]=S):S=e[33];let E;e[34]===Symbol.for("react.memo_cache_sentinel")?(E=()=>h.current?.click(),e[34]=E):E=e[34];let L;e[35]===Symbol.for("react.memo_cache_sentinel")?(L=(0,t.jsx)("button",{type:"button",onClick:E,className:"rounded-full p-2 text-violet-600 transition-colors hover:bg-violet-50 dark:hover:bg-zinc-800",title:"Attach media",children:(0,t.jsx)(Os,{size:20})}),e[35]=L):L=e[35];let D;e[36]!==d?(D=(0,t.jsxs)("div",{className:"flex gap-1 text-violet-600",children:[L,(0,t.jsx)("input",{type:"file",ref:h,onChange:d,multiple:!0,className:"hidden",accept:"image/*,video/*,application/pdf"})]}),e[36]=d,e[37]=D):D=e[37];const U=o||x?"primary":"animated";let B;e[38]!==x||e[39]!==o?(B=!(o||x)&&(0,t.jsx)(ye,{size:20}),e[38]=x,e[39]=o,e[40]=B):B=e[40];const G=o||x;let V;e[41]!==r||e[42]!==m.length?(V=!r.trim()&&m.length===0,e[41]=r,e[42]=m.length,e[43]=V):V=e[43];let W;e[44]!==a||e[45]!==U||e[46]!==B||e[47]!==G||e[48]!==V?(W=(0,t.jsx)(Ft,{variant:U,icon:B,className:"min-w-[70px] !w-auto",onClick:a,loading:G,disabled:V,children:"Reply"}),e[44]=a,e[45]=U,e[46]=B,e[47]=G,e[48]=V,e[49]=W):W=e[49];let O;e[50]!==D||e[51]!==W?(O=(0,t.jsxs)("div",{className:"mt-2 flex items-center justify-between border-t border-zinc-100 pt-3 dark:border-zinc-800",children:[D,W]}),e[50]=D,e[51]=W,e[52]=O):O=e[52];let j;e[53]!==T||e[54]!==S||e[55]!==O?(j=(0,t.jsxs)("div",{className:"flex-1",children:[T,S,O]}),e[53]=T,e[54]=S,e[55]=O,e[56]=j):j=e[56];let $;return e[57]!==P||e[58]!==j?($=(0,t.jsx)("div",{className:"border-y border-zinc-100 bg-zinc-50/30 p-4 dark:border-zinc-800 dark:bg-zinc-900/10",children:(0,t.jsxs)("div",{className:"flex gap-3",children:[P,j]})}),e[57]=P,e[58]=j,e[59]=$):$=e[59],$},It=z.memo(dl);function ml(l){return URL.createObjectURL(l)}function fl(l){return URL.revokeObjectURL(l)}function ul(l){return l.type.startsWith("image/")}var xl=J(),hl=l=>{const e=(0,xl.c)(30),{url:s}=l;let r,i;e[0]!==s?(r=["link-preview",s],i=()=>Ls(s),e[0]=s,e[1]=r,e[2]=i):(r=e[1],i=e[2]);const a=!!s;let o;e[3]!==r||e[4]!==i||e[5]!==a?(o={queryKey:r,queryFn:i,staleTime:864e5,enabled:a},e[3]=r,e[4]=i,e[5]=a,e[6]=o):o=e[6];const{data:n,isLoading:c,isError:x}=Zt(o);if(c){let N;return e[7]===Symbol.for("react.memo_cache_sentinel")?(N=(0,t.jsx)("div",{className:"mt-3 flex h-24 animate-pulse items-center justify-center overflow-hidden rounded-2xl border border-zinc-100 bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-900/50",children:(0,t.jsx)(Ye,{className:"animate-spin text-zinc-300 dark:text-zinc-700",size:24})}),e[7]=N):N=e[7],N}if(x||!n||!n.title&&!n.image)return null;let g;e[8]!==n.image||e[9]!==n.title?(g=n.image&&(0,t.jsx)("div",{className:"aspect-[1.91/1] w-full overflow-hidden border-b border-zinc-100 bg-zinc-100 dark:border-zinc-800 dark:bg-zinc-900",children:(0,t.jsx)("img",{src:n.image,alt:n.title??void 0,className:"h-full w-full object-cover transition-transform duration-500 group-hover:scale-[1.02]",onError:gl})}),e[8]=n.image,e[9]=n.title,e[10]=g):g=e[10];let m;e[11]===Symbol.for("react.memo_cache_sentinel")?(m=(0,t.jsx)(Ye,{size:12}),e[11]=m):m=e[11];let h;e[12]!==n.siteName?(h=(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs font-bold uppercase tracking-wider text-zinc-600",children:[m,(0,t.jsx)("span",{children:n.siteName})]}),e[12]=n.siteName,e[13]=h):h=e[13];let v;e[14]!==n.title?(v=(0,t.jsx)("div",{className:"line-clamp-2 text-[15px] font-bold leading-snug transition-colors group-hover:text-violet-700 dark:text-white",children:n.title}),e[14]=n.title,e[15]=v):v=e[15];let d;e[16]!==n.description?(d=n.description&&(0,t.jsx)("p",{className:"line-clamp-2 text-xs leading-relaxed text-zinc-600 dark:text-zinc-400",children:n.description}),e[16]=n.description,e[17]=d):d=e[17];let b;e[18]===Symbol.for("react.memo_cache_sentinel")?(b=(0,t.jsx)(ls,{size:10}),e[18]=b):b=e[18];let p;e[19]!==s?(p=(0,t.jsxs)("div",{className:"flex items-center gap-1 pt-1 text-[11px] font-medium text-zinc-500",children:[b,(0,t.jsx)("span",{className:"truncate",children:s})]}),e[19]=s,e[20]=p):p=e[20];let u;e[21]!==p||e[22]!==h||e[23]!==v||e[24]!==d?(u=(0,t.jsxs)("div",{className:"space-y-1 p-3.5",children:[h,v,d,p]}),e[21]=p,e[22]=h,e[23]=v,e[24]=d,e[25]=u):u=e[25];let y;return e[26]!==u||e[27]!==g||e[28]!==s?(y=(0,t.jsxs)("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"group mt-3 flex flex-col overflow-hidden rounded-2xl border border-zinc-100 bg-white shadow-sm transition-all hover:bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-950 dark:hover:bg-zinc-900",onClick:pl,children:[g,u]}),e[26]=u,e[27]=g,e[28]=s,e[29]=y):y=e[29],y},wt=hl;function pl(l){return l.stopPropagation()}function gl(l){return l.target.style.display="none"}var bl=J(),vl=l=>{const e=(0,bl.c)(15),{file:s}=l;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=(0,t.jsx)("div",{className:"flex size-10 items-center justify-center rounded-xl bg-violet-100 text-violet-600 dark:bg-violet-900/30",children:(0,t.jsx)(is,{size:20})}),e[0]=r):r=e[0];let i;e[1]!==s.name?(i=(0,t.jsx)("div",{className:"truncate text-sm font-bold dark:text-white",children:s.name}),e[1]=s.name,e[2]=i):i=e[2];let a;e[3]!==s.size?(a=s.size!==void 0&&(0,t.jsxs)("div",{className:"text-xs uppercase text-zinc-500",children:[(s.size/1024/1024).toFixed(2)," MB"]}),e[3]=s.size,e[4]=a):a=e[4];let o;e[5]!==i||e[6]!==a?(o=(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[i,a]}),e[5]=i,e[6]=a,e[7]=o):o=e[7];let n;e[8]===Symbol.for("react.memo_cache_sentinel")?(n=(0,t.jsx)(as,{size:18}),e[8]=n):n=e[8];let c;e[9]!==s.name||e[10]!==s.url?(c=(0,t.jsx)("a",{href:s.url,download:s.name,className:"p-2 text-zinc-400 transition-colors hover:text-violet-600",onClick:yl,children:n}),e[9]=s.name,e[10]=s.url,e[11]=c):c=e[11];let x;return e[12]!==o||e[13]!==c?(x=(0,t.jsxs)("div",{className:"group mt-3 flex items-center gap-3 rounded-2xl border border-zinc-100 bg-zinc-50/50 p-3 transition-colors hover:border-violet-500/30 dark:border-zinc-800 dark:bg-zinc-900/10",children:[r,o,c]}),e[12]=o,e[13]=c,e[14]=x):x=e[14],x},jl=vl;function yl(l){return l.stopPropagation()}var Ae=J(),kl=l=>{const e=(0,Ae.c)(18),{item:s,onClick:r}=l,[i,a]=(0,z.useState)(!1);let o,n,c;e[0]===Symbol.for("react.memo_cache_sentinel")?(o={scale:1.02},n={scale:.98},c={type:"spring",stiffness:400,damping:25},e[0]=o,e[1]=n,e[2]=c):(o=e[0],n=e[1],c=e[2]);let x;e[3]!==i?(x=!i&&(0,t.jsx)("div",{className:"absolute inset-0 animate-pulse bg-zinc-200 dark:bg-zinc-800"}),e[3]=i,e[4]=x):x=e[4];const g=s.url||s.src;let m;e[5]===Symbol.for("react.memo_cache_sentinel")?(m={opacity:0,scale:1.1,filter:"blur(10px)"},e[5]=m):m=e[5];let h;e[6]!==i?(h=i?{opacity:1,scale:1,filter:"blur(0px)"}:{},e[6]=i,e[7]=h):h=e[7];let v;e[8]===Symbol.for("react.memo_cache_sentinel")?(v={duration:.5,ease:"easeOut"},e[8]=v):v=e[8];let d;e[9]===Symbol.for("react.memo_cache_sentinel")?(d=()=>a(!0),e[9]=d):d=e[9];let b;e[10]!==g||e[11]!==h?(b=(0,t.jsx)(Q.img,{src:g,initial:m,animate:h,transition:v,className:"size-full object-cover transition-transform duration-500 group-hover:scale-105",alt:"",loading:"lazy",onLoad:d}),e[10]=g,e[11]=h,e[12]=b):b=e[12];let p;e[13]===Symbol.for("react.memo_cache_sentinel")?(p=(0,t.jsx)("div",{className:"absolute inset-0 bg-black/0 transition-colors group-hover:bg-black/10"}),e[13]=p):p=e[13];let u;return e[14]!==r||e[15]!==b||e[16]!==x?(u=(0,t.jsxs)(Q.div,{whileHover:o,whileTap:n,transition:c,className:"group relative size-full overflow-hidden",onClick:r,children:[x,b,p]}),e[14]=r,e[15]=b,e[16]=x,e[17]=u):u=e[17],u},zl=l=>{const e=(0,Ae.c)(21),{item:s,onClick:r}=l,[i,a]=(0,z.useState)(!1);let o,n,c;e[0]===Symbol.for("react.memo_cache_sentinel")?(o={scale:1.02},n={scale:.98},c={type:"spring",stiffness:400,damping:25},e[0]=o,e[1]=n,e[2]=c):(o=e[0],n=e[1],c=e[2]);let x;e[3]!==i?(x=!i&&(0,t.jsx)("div",{className:"absolute inset-0 animate-pulse bg-zinc-200 dark:bg-zinc-800"}),e[3]=i,e[4]=x):x=e[4];let g;e[5]!==s.poster||e[6]!==i?(g=s.poster&&(0,t.jsx)(Q.img,{src:s.poster,initial:{opacity:0,scale:1.1,filter:"blur(10px)"},animate:i?{opacity:1,scale:1,filter:"blur(0px)"}:{},transition:{duration:.5,ease:"easeOut"},className:"size-full object-cover transition-transform duration-500 group-hover:scale-105",alt:"",loading:"lazy",onLoad:()=>a(!0)}),e[5]=s.poster,e[6]=i,e[7]=g):g=e[7];let m;e[8]!==s.poster?(m=!s.poster&&(0,t.jsx)("div",{className:"flex size-full items-center justify-center bg-zinc-100 dark:bg-zinc-900",onMouseEnter:()=>a(!0),children:(0,t.jsx)("div",{className:"size-full bg-zinc-800/20"})}),e[8]=s.poster,e[9]=m):m=e[9];let h;e[10]===Symbol.for("react.memo_cache_sentinel")?(h=(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent opacity-80"}),e[10]=h):h=e[10];let v;e[11]===Symbol.for("react.memo_cache_sentinel")?(v=(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsx)("div",{className:"flex size-14 items-center justify-center rounded-full bg-white/15 backdrop-blur-md ring-1 ring-white/30 transition-all group-hover:bg-white/25 group-hover:scale-110 group-active:scale-95 shadow-2xl",children:(0,t.jsx)($e,{className:"ml-1 size-7 text-white fill-white drop-shadow-xl",strokeWidth:0})})}),e[11]=v):v=e[11];let d;e[12]===Symbol.for("react.memo_cache_sentinel")?(d=(0,t.jsx)($e,{className:"size-2.5 fill-white",strokeWidth:0}),e[12]=d):d=e[12];const b=s.duration||"0:00";let p;e[13]!==b?(p=(0,t.jsx)("div",{className:"absolute bottom-3 left-3 flex items-center gap-2",children:(0,t.jsxs)("div",{className:"flex items-center gap-1.5 rounded-lg bg-black/40 px-2 py-1 text-[11px] font-bold text-white backdrop-blur-md border border-white/10 shadow-lg",children:[d,(0,t.jsx)("span",{className:"tabular-nums tracking-wider",children:b})]})}),e[13]=b,e[14]=p):p=e[14];let u;return e[15]!==r||e[16]!==p||e[17]!==x||e[18]!==g||e[19]!==m?(u=(0,t.jsxs)(Q.div,{whileHover:o,whileTap:n,transition:c,className:"group relative size-full overflow-hidden",onClick:r,children:[x,g,m,h,v,p]}),e[15]=r,e[16]=p,e[17]=x,e[18]=g,e[19]=m,e[20]=u):u=e[20],u},Nl=l=>{const e=(0,Ae.c)(3),{items:s}=l,r=s===void 0?[]:s,{openLightbox:i}=Rs();if(!r||Array.isArray(r)&&r.length===0)return null;const a=Array.isArray(r)?r:[r],o=a.filter(Cl),n=a.filter(_l),c=o.some(Sl),x=d=>{i(o,d)},g="mt-2 space-y-2",m=o.length>0&&(0,t.jsx)("div",{className:`grid gap-2 overflow-hidden rounded-2xl border border-zinc-100 dark:border-zinc-800 ${o.length===1?"grid-cols-1":o.length===2?c?"aspect-[8/9] grid-cols-1 grid-rows-2":"aspect-[16/9] grid-cols-2":(o.length===3,"aspect-[16/9] grid-cols-2 grid-rows-2")}`,children:o.map((d,b)=>(0,t.jsx)("div",{className:`relative cursor-pointer overflow-hidden bg-zinc-100 dark:bg-zinc-900 group ${o.length===3&&b===0?"row-span-2":""}`,children:d.type==="video"?(0,t.jsx)(zl,{item:d,onClick:p=>{p.stopPropagation(),x(b)}}):(0,t.jsx)(kl,{item:d,onClick:p=>{p.stopPropagation(),x(b)}})},b))}),h=n.map($l);let v;return e[0]!==m||e[1]!==h?(v=(0,t.jsxs)("div",{className:g,children:[m,h]}),e[0]=m,e[1]=h,e[2]=v):v=e[2],v},wl=Nl;function Cl(l){return l.type==="image"||l.type==="video"}function _l(l){return l.type==="file"}function Sl(l){return l.type==="video"}function $l(l,e){return(0,t.jsx)(jl,{file:l},e)}var Pl=({isOpen:l,onClose:e,url:s,title:r="Share",overlayClassName:i})=>{const[a,o]=(0,z.useState)(!1),[n,c]=(0,z.useState)(""),[x,g]=(0,z.useState)([]),[m,h]=(0,z.useState)(!1),[v,d]=(0,z.useState)(null),{addToast:b}=Le(),{currentUser:p}=Mt(),u=(0,z.useCallback)(async()=>{if(p){h(!0);try{g((await ht(p.id)).map(f=>f.user).filter(f=>f!==null).slice(0,5))}catch(f){console.error("Failed to fetch conversations:",f)}finally{h(!1)}}},[p]);(0,z.useEffect)(()=>{l&&p?u():(c(""),g([]))},[l,p,u]);const y=(0,z.useCallback)(async()=>{if(p){h(!0);try{g((await ht(p.id)).map(f=>f.user).filter(f=>f!==null&&(f.name?.toLowerCase().includes(n.toLowerCase())||f.handle.toLowerCase().includes(n.toLowerCase()))))}catch(f){console.error("Search failed:",f)}finally{h(!1)}}},[n,p]);(0,z.useEffect)(()=>{const f=setTimeout(()=>{n.trim()&&l?y():!n.trim()&&l&&u()},300);return()=>clearTimeout(f)},[n,l,y,u]);const N=async f=>{f&&f.stopPropagation();try{await Ee(s),o(!0),b("Link copied to clipboard!","success"),setTimeout(()=>o(!1),2e3)}catch(F){console.error("Failed to copy:",F),b("Failed to copy link","error")}},w=async f=>{if(p){d(f.id);try{await As(await Fs(p.id,f.id),p.id,s,"text"),b(`Sent to ${f.name||f.handle}!`,"success")}catch(F){console.error("Failed to send message:",F),b("Failed to send message","error")}finally{d(null)}}},C=[{name:"X",icon:xs,color:"bg-black text-white",href:`https://twitter.com/intent/tweet?url=${encodeURIComponent(s)}`},{name:"Facebook",icon:rs,color:"bg-[#1877F2] text-white",href:`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(s)}`},{name:"LinkedIn",icon:ts,color:"bg-[#0A66C2] text-white",href:`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(s)}`},{name:"WhatsApp",icon:cs,color:"bg-[#25D366] text-white",href:`https://wa.me/?text=${encodeURIComponent(s)}`},{name:"Email",icon:ns,color:"bg-zinc-600 text-white",href:`mailto:?body=${encodeURIComponent(s)}`}],_=async()=>{if(navigator.share)try{await navigator.share({title:r,url:s})}catch(f){f.name!=="AbortError"&&console.error("Native share failed:",f)}else N()};return(0,t.jsx)(Rt,{isOpen:l,onClose:e,className:"max-w-[360px] overflow-hidden rounded-[32px] border border-black/10 bg-white/75 p-0 shadow-2xl backdrop-blur-xl dark:border-white/10 dark:bg-zinc-900/75 sm:max-w-[380px]",overlayClassName:i,children:(0,t.jsxs)("div",{className:"flex h-full flex-col",children:[(0,t.jsx)("div",{className:"flex items-center justify-center pt-6 pb-2",children:(0,t.jsx)("h2",{className:"text-[17px] font-semibold text-zinc-900 dark:text-zinc-50",children:r})}),(0,t.jsx)("div",{className:"px-5 py-3",children:(0,t.jsxs)("div",{className:"group relative",children:[(0,t.jsx)(Yt,{className:"absolute left-3.5 top-1/2 size-4 -translate-y-1/2 text-zinc-400 transition-colors group-focus-within:text-violet-500"}),(0,t.jsx)("input",{type:"text",placeholder:"Search people...",value:n,onChange:f=>c(f.target.value),className:"w-full rounded-2xl border border-black/5 bg-black/5 py-3 pl-11 pr-4 text-[15px] outline-none transition-all focus:bg-white/50 focus:ring-4 focus:ring-violet-500/10 dark:border-white/5 dark:bg-white/5 dark:focus:bg-black/50"})]})}),(0,t.jsx)("div",{className:"no-scrollbar flex min-h-[110px] items-center gap-4 overflow-x-auto px-5 py-4",children:m?(0,t.jsx)("div",{className:"flex flex-1 justify-center",children:(0,t.jsx)("span",{className:"animate-pulse text-[13px] font-medium text-zinc-400",children:"Loading..."})}):x.length>0?x.map(f=>(0,t.jsxs)("button",{onClick:()=>w(f),disabled:v!==null,className:"group flex shrink-0 flex-col items-center gap-2 transition-transform active:scale-95 disabled:opacity-50",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"size-16 overflow-hidden rounded-full border-2 border-white/50 shadow-sm dark:border-zinc-800/50 bg-zinc-100 dark:bg-zinc-800",children:(0,t.jsx)("img",{src:f.avatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=${f.handle}`,alt:f.handle,className:"size-full object-cover"})}),v===f.id&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center rounded-full bg-black/40",children:(0,t.jsx)("span",{className:"animate-pulse text-white font-bold",children:"..."})})]}),(0,t.jsx)("span",{className:"max-w-[70px] truncate text-[11px] font-medium text-zinc-500 dark:text-zinc-400",children:f.name?.split(" ")[0]||f.handle})]},f.id)):(0,t.jsx)("div",{className:"flex-1 py-2 text-center",children:(0,t.jsx)("span",{className:"text-xs text-zinc-400",children:"No people found"})})}),(0,t.jsx)("div",{className:"mx-5 h-px bg-black/5 dark:bg-white/5"}),(0,t.jsxs)("div",{className:"grid grid-cols-5 gap-3 px-5 py-6",children:[C.map(f=>(0,t.jsxs)("a",{href:f.href,target:"_blank",rel:"noopener noreferrer",className:"group flex flex-col items-center gap-2.5",children:[(0,t.jsx)("div",{className:`size-12 ${f.color} flex items-center justify-center rounded-[18px] shadow-sm ring-1 ring-black/5 transition-all group-hover:-translate-y-1 group-hover:scale-105 group-hover:shadow-lg dark:ring-white/5`,children:(0,t.jsx)(f.icon,{size:22,strokeWidth:2.5})}),(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider text-zinc-500/80 dark:text-zinc-400/80",children:f.name})]},f.name)),(0,t.jsxs)("button",{onClick:_,className:"group flex flex-col items-center gap-2.5",children:[(0,t.jsx)("div",{className:"flex size-12 items-center justify-center rounded-[18px] border border-black/10 bg-white/50 text-zinc-600 shadow-sm transition-all group-hover:-translate-y-1 group-hover:scale-105 dark:border-white/10 dark:bg-white/5 dark:text-zinc-300",children:(0,t.jsx)(Se,{size:22,strokeWidth:2.5})}),(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider text-zinc-500/80 dark:text-zinc-400/80",children:"More"})]})]}),(0,t.jsx)("div",{className:"px-5 pb-6",children:(0,t.jsxs)("div",{className:"group relative flex items-center overflow-hidden rounded-2xl border border-black/10 bg-white/40 dark:border-white/10 dark:bg-black/20",children:[(0,t.jsx)("input",{type:"text",readOnly:!0,value:s,className:"w-full bg-transparent py-4 pl-4 pr-16 text-[14px] font-medium text-zinc-600 outline-none dark:text-zinc-300"}),(0,t.jsx)("button",{onClick:N,className:`absolute right-1 text-[13px] font-bold active:scale-95 transition-all px-4 h-10 rounded-xl leading-none ${a?"text-emerald-500":"text-violet-600 hover:text-violet-700 dark:text-violet-400"}`,children:a?"Copied":"Copy"})]})}),(0,t.jsx)("div",{className:"border-t border-black/10 dark:border-white/10",children:(0,t.jsx)("button",{onClick:e,className:"flex h-16 w-full items-center justify-center text-[19px] font-medium text-zinc-500 transition-colors active:bg-black/5 dark:text-zinc-400 dark:active:bg-white/5",children:"Close"})})]})})},Lt=Pl,Dt=J(),Tl=l=>{const e=(0,Dt.c)(6),{avatars:s}=l;if(!s||s.length===0)return null;let r,i;if(e[0]!==s){const o=s.slice(0,3);r="relative mt-2.5 h-8 w-8",i=o.map((n,c)=>{let x,g;return o.length===1?(x="top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",g="size-5"):o.length===2?(g="size-4.5",x=c===0?"top-0 right-0":"bottom-0 left-0"):(g=c===0?"size-4.5":"size-3.5",c===0?x="top-0 left-1/2 -translate-x-1/2":c===1?x="bottom-0.5 left-0":x="bottom-0.5 right-0"),(0,t.jsx)("div",{className:`absolute rounded-full border-2 border-white bg-zinc-100 dark:border-black dark:bg-zinc-800 overflow-hidden shadow-md transition-transform hover:scale-110 ${x} ${g}`,style:{zIndex:10-c},children:(0,t.jsx)("img",{src:n,alt:"",className:"h-full w-full object-cover",loading:"lazy"})},c)}),e[0]=s,e[1]=r,e[2]=i}else r=e[1],i=e[2];let a;return e[3]!==r||e[4]!==i?(a=(0,t.jsx)("div",{className:r,children:i}),e[3]=r,e[4]=i,e[5]=a):a=e[5],a},Ct=l=>{const e=(0,Dt.c)(78),{id:s,user:r,isCurrentUser:i,isComment:a,isPinned:o,onEdit:n,onDelete:c,onTogglePin:x,addToast:g,trigger:m}=l,{openReport:h}=Et(),[v,d]=(0,z.useState)(!1);if(ys("(min-width: 1024px)")){let S;e[0]!==m?(S=(0,t.jsx)(bs,{asChild:!0,onClick:El,children:(0,t.jsx)("div",{className:"cursor-pointer outline-none",children:m})}),e[0]=m,e[1]=S):S=e[1];let E;e[2]!==g||e[3]!==s||e[4]!==a?(E=!a&&(0,t.jsxs)(te,{onClick:$=>{$.stopPropagation(),Ee(`${ct()}/p/${s}`).then(()=>{g("Link copied"),d(!1)}).catch(()=>{g("Failed to copy link","error")})},children:[(0,t.jsx)(st,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Copy link"})]}),e[2]=g,e[3]=s,e[4]=a,e[5]=E):E=e[5];let L;e[6]!==s||e[7]!==h?(L=$=>{$.stopPropagation(),h("post",s),d(!1)},e[6]=s,e[7]=h,e[8]=L):L=e[8];let D;e[9]===Symbol.for("react.memo_cache_sentinel")?(D=(0,t.jsx)(Fe,{className:"mr-2 h-4 w-4"}),e[9]=D):D=e[9];const U=a?"comment":"post";let B;e[10]!==U?(B=(0,t.jsxs)("span",{children:["Report ",U]}),e[10]=U,e[11]=B):B=e[11];let G;e[12]!==L||e[13]!==B?(G=(0,t.jsxs)(te,{onClick:L,children:[D,B]}),e[12]=L,e[13]=B,e[14]=G):G=e[14];let V;e[15]!==i||e[16]!==h||e[17]!==r?(V=!i&&(0,t.jsxs)(te,{onClick:$=>{$.stopPropagation(),h("user",r.id),d(!1)},children:[(0,t.jsx)(et,{className:"mr-2 h-4 w-4"}),(0,t.jsxs)("span",{children:["Report @",r.handle]})]}),e[15]=i,e[16]=h,e[17]=r,e[18]=V):V=e[18];let W;e[19]!==a||e[20]!==i||e[21]!==o||e[22]!==c||e[23]!==n||e[24]!==x?(W=i&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(vs,{}),!a&&x&&(0,t.jsx)(te,{onClick:$=>{$.stopPropagation(),x(),d(!1)},children:o?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(it,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Unpin from profile"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Pe,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Pin to profile"})]})}),(0,t.jsxs)(te,{onClick:$=>{$.stopPropagation(),n(),d(!1)},children:[(0,t.jsx)(lt,{className:"mr-2 h-4 w-4"}),(0,t.jsxs)("span",{children:["Edit ",a?"Comment":"Post"]})]}),(0,t.jsxs)(te,{className:"text-red-500 focus:text-red-500",onClick:$=>{$.stopPropagation(),c(),d(!1)},children:[(0,t.jsx)(tt,{className:"mr-2 h-4 w-4"}),(0,t.jsxs)("span",{children:["Delete ",a?"comment":"post"]})]})]}),e[19]=a,e[20]=i,e[21]=o,e[22]=c,e[23]=n,e[24]=x,e[25]=W):W=e[25];let O;e[26]!==E||e[27]!==G||e[28]!==V||e[29]!==W?(O=(0,t.jsxs)(gs,{align:"end",className:"w-56",onClick:Il,children:[E,G,V,W]}),e[26]=E,e[27]=G,e[28]=V,e[29]=W,e[30]=O):O=e[30];let j;return e[31]!==v||e[32]!==S||e[33]!==O?(j=(0,t.jsx)("div",{onClick:Ml,children:(0,t.jsxs)($s,{open:v,onOpenChange:d,modal:!0,children:[S,O]})}),e[31]=v,e[32]=S,e[33]=O,e[34]=j):j=e[34],j}let b;e[35]===Symbol.for("react.memo_cache_sentinel")?(b=S=>{S.stopPropagation(),d(!0)},e[35]=b):b=e[35];let p;e[36]!==m?(p=(0,t.jsx)("div",{onClick:b,className:"cursor-pointer",children:m}),e[36]=m,e[37]=p):p=e[37];let u;e[38]===Symbol.for("react.memo_cache_sentinel")?(u=()=>d(!1),e[38]=u):u=e[38];let y;e[39]!==g||e[40]!==s||e[41]!==a?(y=!a&&(0,t.jsx)(se,{icon:(0,t.jsx)(st,{size:18}),onClick:S=>{S.stopPropagation(),Ee(`${ct()}/p/${s}`).then(()=>{g("Link copied"),d(!1)}).catch(()=>{g("Failed to copy link","error")})},children:"Copy link"}),e[39]=g,e[40]=s,e[41]=a,e[42]=y):y=e[42];let N;e[43]===Symbol.for("react.memo_cache_sentinel")?(N=(0,t.jsx)(Fe,{size:18}),e[43]=N):N=e[43];let w;e[44]!==s||e[45]!==h?(w=S=>{S.stopPropagation(),h("post",s),d(!1)},e[44]=s,e[45]=h,e[46]=w):w=e[46];const C=a?"comment":"post";let _;e[47]!==w||e[48]!==C?(_=(0,t.jsxs)(se,{icon:N,onClick:w,children:["Report ",C]}),e[47]=w,e[48]=C,e[49]=_):_=e[49];let f;e[50]!==i||e[51]!==h||e[52]!==r?(f=!i&&(0,t.jsxs)(se,{icon:(0,t.jsx)(et,{size:18}),onClick:S=>{S.stopPropagation(),h("user",r.id),d(!1)},children:["Report @",r.handle]}),e[50]=i,e[51]=h,e[52]=r,e[53]=f):f=e[53];let F;e[54]!==a||e[55]!==i||e[56]!==o||e[57]!==x?(F=i&&!a&&x&&(0,t.jsx)(se,{icon:o?(0,t.jsx)(it,{size:18}):(0,t.jsx)(Pe,{size:18}),onClick:S=>{S.stopPropagation(),x(),d(!1)},children:o?"Unpin from profile":"Pin to profile"}),e[54]=a,e[55]=i,e[56]=o,e[57]=x,e[58]=F):F=e[58];let R;e[59]!==a||e[60]!==i||e[61]!==n?(R=i&&(0,t.jsxs)(se,{icon:(0,t.jsx)(lt,{size:18}),onClick:S=>{S.stopPropagation(),n(),d(!1)},children:["Edit ",a?"Comment":"Post"]}),e[59]=a,e[60]=i,e[61]=n,e[62]=R):R=e[62];let P;e[63]!==a||e[64]!==i||e[65]!==c?(P=i&&(0,t.jsxs)(se,{variant:"destructive",icon:(0,t.jsx)(tt,{size:18}),onClick:S=>{S.stopPropagation(),c(),d(!1)},children:["Delete ",a?"comment":"post"]}),e[63]=a,e[64]=i,e[65]=c,e[66]=P):P=e[66];let k;e[67]!==v||e[68]!==F||e[69]!==R||e[70]!==P||e[71]!==y||e[72]!==_||e[73]!==f?(k=(0,t.jsx)("div",{onClick:Ll,children:(0,t.jsxs)(Ws,{isOpen:v,onClose:u,children:[y,_,f,F,R,P]})}),e[67]=v,e[68]=F,e[69]=R,e[70]=P,e[71]=y,e[72]=_,e[73]=f,e[74]=k):k=e[74];let T;return e[75]!==k||e[76]!==p?(T=(0,t.jsxs)(t.Fragment,{children:[p,k]}),e[75]=k,e[76]=p,e[77]=T):T=e[77],T},Ie=({id:l,user:e,timeAgo:s,content:r,contentClass:i,media:a,quotedPost:o,stats:n,onClick:c,repostedBy:x,onUserClick:g,currentUser:m,poll:h,isDetail:v,initialComments:d,onDelete:b,onUpdate:p,isComment:u,onReply:y,community:N,parent_id:w,post_id:C,commenterAvatars:_=[],is_pinned:f=!1})=>{const F=St(),{addToast:R}=Le(),P=Xt(),[k,T]=(0,z.useState)(f),{liked:S,reposted:E,localStats:L,setLocalStats:D,handleLike:U,handleRepost:B}=Ds(C||l,n,m),{deletePost:G,updatePost:V}=Is(),W=async()=>{try{const M=!k;await V(l,{is_pinned:M,pinned_at:M?new Date().toISOString():null}),T(M),P.invalidateQueries({queryKey:["posts","user",e.id]}),R(M?"Post pinned to profile":"Post unpinned")}catch(M){console.error("Failed to toggle pin:",M),R("Failed to update pin status")}},{comments:O,fetchNextPage:j,hasNextPage:$,isFetchingNextPage:I,addComment:A,deleteComment:H,updateComment:ne,isSubmitting:At}=xt(C||l,d),[ke,ze]=(0,z.useState)(""),[Ne,Oe]=(0,z.useState)([]),[Ut,Be]=(0,z.useState)(!1),[Ve,re]=(0,z.useState)(!1),[me,Y]=(0,z.useState)(!1),[Z,fe]=(0,z.useState)(r),[ue,xe]=(0,z.useState)(a||[]),[he,oe]=(0,z.useState)([]),[We,He]=(0,z.useState)(!1),[Ot,we]=(0,z.useState)(!1),[Ce,pe]=(0,z.useState)(null),[_e,qe]=(0,z.useState)(!1),{comments:Bt,refetch:Qe}=xt(C||l,void 0,_e?l:void 0),{ref:Ge,inView:Je}=Jt({threshold:.5,triggerOnce:!0});(0,z.useEffect)(()=>{if(Je&&!u&&l&&!l.startsWith("temp-")){const M=setTimeout(()=>{Tt(l).catch(console.error)},1500);return()=>clearTimeout(M)}},[Je,l,u]);const Vt=(0,z.useCallback)(async()=>{!l||!C&&!l||L.comments===0||(qe(!0),Qe())},[l,C,L.comments,Qe]),Ke=async()=>{const M=JSON.stringify(ue)!==JSON.stringify(a||[])||he.length>0;if(!Z.trim()||Z===r&&!M){Y(!1);return}He(!0);try{const q=[];for(const ee of he){const qt=await Re(ee);q.push(qt)}const K=[...ue,...q];u?await ne({commentId:l,content:Z,media:K}):await V(l,{content:Z,media:K}),oe([]),Y(!1),R(`${u?"Comment":"Post"} updated`),p&&p(l,Z,K)}catch(q){console.error(`Failed to update ${u?"comment":"post"}:`,q),R(`Failed to update ${u?"comment":"post"}`)}finally{He(!1)}},Xe=async M=>{M&&M.stopPropagation();try{u?await H(l):await G(l),R(`${u?"Comment":"Post"} deleted successfully`),b&&b(l)}catch(q){console.error(`Failed to delete ${u?"comment":"post"}:`,q),R(`Failed to delete ${u?"comment":"post"}`)}finally{re(!1)}},Wt=async M=>{if(M.preventDefault(),!(!ke.trim()&&Ne.length===0||!m)){Be(!0);try{const q=[];for(const K of Ne){const ee=await Re(K);q.push(ee)}await A({userId:m.id,content:ke,media:q,replyToId:Ce?.id}),ze(""),Oe([]),pe(null),D(K=>({...K,comments:(K.comments||0)+1})),R("Reply posted!")}catch(q){console.error("Failed to post comment:",q),R("Failed to post reply.")}finally{Be(!1)}}},Ze=m?.handle===e.handle,Ht=(M,q)=>{pe(q?{handle:M,id:u?w||l:q}:null),ze(K=>{const ee=`@${M} `;return K.includes(ee)?K:ee+K}),document.getElementById("comment-input")?.focus()};return v?(0,t.jsxs)(Q.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"flex flex-col",ref:Ge,children:[(0,t.jsxs)("article",{className:"p-6 dark:bg-black",children:[(0,t.jsx)(jt,{user:e,timeAgo:s,community:N,onUserClick:g,isDetail:!0,showAvatar:!0,isPinned:k,actionsMenu:(0,t.jsx)(Ct,{id:l,user:e,isCurrentUser:Ze,isComment:u,isPinned:k,onEdit:()=>Y(!0),onDelete:()=>re(!0),onTogglePin:W,addToast:R,trigger:(0,t.jsx)("button",{"aria-label":"More options",className:"rounded-full p-2 text-zinc-500 transition-colors hover:bg-zinc-100 dark:hover:bg-zinc-800",children:(0,t.jsx)(Se,{size:20})})})}),(0,t.jsx)(yt,{content:r,isDetail:!0,isEditing:me,editedContent:Z,setEditedContent:fe,onCancelEdit:()=>{Y(!1),fe(r),xe(a||[]),oe([])},onSaveEdit:Ke,isUpdating:We,contentClass:i}),ge(r)&&(0,t.jsx)(wt,{url:ge(r)}),(0,t.jsx)(kt,{media:a,isEditing:me,editedMedia:ue,setEditedMedia:xe,newFiles:he,setNewFiles:oe}),h&&(0,t.jsx)(zt,{poll:h,onVote:M=>Cs(l,M,m.id)}),o&&(0,t.jsx)("div",{className:"mt-5 overflow-hidden rounded-2xl border border-zinc-200 shadow-sm dark:border-zinc-700",children:(0,t.jsx)(Nt,{...o})}),(0,t.jsx)(vt,{views:L.views||0,likes:L.likes||0,comments:L.comments||0,isDetail:!0}),(0,t.jsx)("div",{className:"my-4"}),(0,t.jsx)(bt,{liked:S,reposted:E,handleLike:U,handleRepost:B,handleCommentClick:()=>document.getElementById("comment-input")?.focus(),handleShareClick:()=>we(!0),isDetail:!0,isComment:u})]}),Ce&&(0,t.jsxs)("div",{className:"flex items-center justify-between bg-zinc-50 px-5 py-2 dark:bg-zinc-900/50",children:[(0,t.jsxs)("span",{className:"text-sm text-zinc-500",children:["Replying to"," ",(0,t.jsxs)("span",{className:"font-bold text-violet-600",children:["@",Ce.handle]})]}),(0,t.jsx)("button",{onClick:()=>pe(null),className:"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200",children:(0,t.jsx)(de,{size:16})})]}),(0,t.jsx)(It,{currentUser:m,newComment:ke,setNewComment:ze,handleSubmitComment:Wt,loading:At,selectedFiles:Ne,setSelectedFiles:Oe,isUploading:Ut}),(0,t.jsxs)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:[(0,t.jsx)("div",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:(0,t.jsxs)(t.Fragment,{children:[$&&O.length>0&&(0,t.jsxs)("button",{onClick:()=>j(),disabled:I,className:"flex w-full items-center justify-center gap-2 py-3 text-sm font-bold text-violet-600 transition-colors hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[I&&(0,t.jsx)("span",{className:"animate-spin",children:"⌛"}),"View more replies"]}),O.map(M=>(0,t.jsx)(Ie,{...M,isComment:!0,post_id:l,onReply:Ht,onUserClick:g,currentUser:m,stats:{likes:M.stats?.likes||0,comments:M.stats?.comments||0,reposts:M.stats?.reposts||0},timeAgo:M.timeAgo||M.created_at},M.id))]})}),(0,t.jsx)(mt,{open:Ve,onOpenChange:re,children:(0,t.jsxs)(rt,{onClick:M=>M.stopPropagation(),children:[(0,t.jsxs)(gt,{children:[(0,t.jsx)(pt,{children:"Are you absolutely sure?"}),(0,t.jsx)(at,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,t.jsxs)(ut,{children:[(0,t.jsx)(ft,{onClick:M=>M.stopPropagation(),children:"Cancel"}),(0,t.jsx)(dt,{onClick:Xe,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]})]}):(0,t.jsxs)(Q.article,{initial:{opacity:0,y:10},whileInView:{opacity:1,y:0},viewport:{once:!0,margin:"-50px"},transition:{duration:.4,ease:"easeOut"},ref:Ge,onClick:c,className:`px-5 transition-all ${u?"py-3 bg-transparent hover:bg-zinc-50/30 dark:hover:bg-zinc-800/20":"py-5 bg-white hover:bg-zinc-50/30 dark:bg-black dark:hover:bg-white/[0.02]"} ${c?"cursor-pointer":""}`,children:[x&&(0,t.jsxs)("div",{className:"mb-2.5 ml-1 flex items-center space-x-1.5 text-[13px] font-semibold text-zinc-600",children:[(0,t.jsx)(Te,{size:14,className:"text-zinc-500"}),(0,t.jsxs)("span",{className:"flex cursor-pointer items-center text-zinc-700 hover:underline dark:text-zinc-300",onClick:M=>{M.stopPropagation(),g&&g(x.handle)},children:[x.handle," Reposted"]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-x-3.5",children:[(0,t.jsxs)("div",{className:"flex shrink-0 flex-col items-center self-stretch pt-0.5",children:[(0,t.jsx)("div",{className:"cursor-pointer",onClick:M=>{M.stopPropagation(),g&&g(e.handle)},children:(0,t.jsxs)(ae,{className:`${u?"size-8":"size-10"} border-0 shadow-sm`,children:[(0,t.jsx)(le,{src:e.avatar,alt:e.handle,className:"object-cover"}),(0,t.jsx)(ie,{className:"text-xs",children:e.handle[0]?.toUpperCase()})]})}),(!u&&L.comments>0||u&&!w&&L.comments>0)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"mt-2 w-0.5 flex-1 rounded-full bg-zinc-100 dark:bg-zinc-800"}),!u&&(0,t.jsx)(Tl,{avatars:_.length>0?_:(O||[]).slice(0,3).map(M=>M.user.avatar)})]})]}),(0,t.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col",children:[(0,t.jsx)(jt,{user:e,timeAgo:s,community:N,onUserClick:g,isComment:u,isPinned:k,actionsMenu:(0,t.jsx)(Ct,{id:l,user:e,isCurrentUser:Ze,isComment:u,isPinned:k,onEdit:()=>Y(!0),onDelete:()=>re(!0),onTogglePin:W,addToast:R,trigger:(0,t.jsx)("button",{"aria-label":"More options",className:"rounded-full p-2 text-zinc-500 transition-colors hover:bg-zinc-100 group-hover:bg-zinc-100 dark:hover:bg-zinc-800 dark:group-hover:bg-zinc-800/50",children:(0,t.jsx)(Se,{size:18})})})}),(0,t.jsx)(yt,{content:r,isEditing:me,editedContent:Z,setEditedContent:fe,onCancelEdit:()=>{Y(!1),fe(r),xe(a||[]),oe([])},onSaveEdit:Ke,isUpdating:We,contentClass:i}),ge(r)&&(0,t.jsx)(wt,{url:ge(r)}),(0,t.jsx)(kt,{media:a,isEditing:me,editedMedia:ue,setEditedMedia:xe,newFiles:he,setNewFiles:oe}),h&&(0,t.jsx)(zt,{poll:h}),o&&(0,t.jsx)("div",{className:"mt-3 overflow-hidden rounded-2xl border border-zinc-200 shadow-sm transition-all hover:bg-zinc-50 dark:border-zinc-800 dark:hover:bg-zinc-900",onClick:M=>{M.stopPropagation(),F(`/p/${o.id}`)},children:(0,t.jsx)(Nt,{...o})}),(0,t.jsx)(bt,{liked:S,reposted:E,handleLike:U,handleRepost:B,handleCommentClick:M=>{if(M?.stopPropagation(),y){const q=u&&w||l;y(e.handle,q)}else c&&c()},handleShareClick:M=>{M?.stopPropagation(),we(!0)},isComment:u}),(0,t.jsx)(vt,{views:L.views||0,likes:L.likes||0,comments:L.comments||0,isComment:u,onRepliesClick:()=>{_e?qe(!1):Vt()}}),_e&&(0,t.jsxs)("div",{className:"relative mt-2 space-y-0",children:[(0,t.jsx)("div",{className:"absolute left-[19px] top-0 bottom-4 w-0.5 bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsx)("div",{className:"flex flex-col",children:Bt.map(M=>(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute left-[19px] top-5 h-0.5 w-4 bg-zinc-100 dark:bg-zinc-800"}),(0,t.jsx)("div",{className:"pl-6",children:(0,t.jsx)(Ie,{...M,isComment:!0,post_id:C||l,onReply:y,onUserClick:g,currentUser:m,stats:{likes:M.stats?.likes||0,comments:M.stats?.comments||0,reposts:M.stats?.reposts||0},timeAgo:M.timeAgo||M.created_at})})]},M.id))})]}),(0,t.jsx)(Lt,{isOpen:Ot,onClose:()=>we(!1),url:Vs(l),title:"Share Post",overlayClassName:"z-[9999]"}),(0,t.jsx)(mt,{open:Ve,onOpenChange:re,children:(0,t.jsxs)(rt,{onClick:M=>M.stopPropagation(),children:[(0,t.jsxs)(gt,{children:[(0,t.jsx)(pt,{children:"Are you absolutely sure?"}),(0,t.jsx)(at,{children:"This action cannot be undone. This will permanently delete your post and all its comments."})]}),(0,t.jsxs)(ut,{children:[(0,t.jsx)(ft,{onClick:M=>M.stopPropagation(),children:"Cancel"}),(0,t.jsx)(dt,{onClick:Xe,className:"bg-rose-500 hover:bg-rose-600",children:"Delete"})]})]})})]})]})]})};function Fl(l,e){const s=!l.media&&!e.media||l.media?.length===e.media?.length&&l.media?.every((i,a)=>i.url===e.media?.[a].url),r=l.repostedBy?.handle===e.repostedBy?.handle;return l.id===e.id&&l.content===e.content&&l.timeAgo===e.timeAgo&&l.user.id===e.user.id&&l.user.avatar===e.user.avatar&&l.stats.likes===e.stats.likes&&l.stats.comments===e.stats.comments&&l.stats.reposts===e.stats.reposts&&l.currentUser?.id===e.currentUser?.id&&!!s&&!!r}var Rl=z.memo(Ie,Fl);function Ml(l){return l.stopPropagation()}function El(l){return l.stopPropagation()}function Il(l){return l.stopPropagation()}function Ll(l){return l.stopPropagation()}var Ue=null;const be=l=>{Ue=l},ve=()=>Ue,Jl=()=>{Ue=null};var Dl=z.memo(({reel:l,isActive:e,volume:s,shouldLoad:r=!0})=>{const{currentUser:i}=Mt(),{addToast:a}=Le(),{openReport:o}=Et(),n=(0,z.useRef)(null),[c,x]=(0,z.useState)(!1),[g,m]=(0,z.useState)(!1),[h,v]=(0,z.useState)(!1),[d,b]=(0,z.useState)(!1),[p,u]=(0,z.useState)(null),[y,N]=(0,z.useState)(!1),[w,C]=(0,z.useState)(l.stats?.likes||0),[_,f]=(0,z.useState)(!1),[F,R]=(0,z.useState)(0),[P,k]=(0,z.useState)(!1),T=(0,z.useRef)(null);(0,z.useEffect)(()=>{if(e&&l.id&&!l.id.toString().startsWith("temp-")){const j=setTimeout(()=>{Tt(l.id).catch(console.error)},1500);return()=>clearTimeout(j)}},[e,l.id]);const S=(0,z.useMemo)(()=>Array.isArray(l.media)?l.media[0]?.src||l.media[0]?.url:l.media?.src||l.media?.url||l.url,[l.media,l.url]);(0,z.useEffect)(()=>{b(!1),k(!1);const j=n.current?.plyr;if(j&&typeof j.on=="function"){const $=()=>b(!0),I=()=>k(!0);j.on("ready",$),j.on("canplay",$),j.on("loadeddata",$),j.on("playing",I);const A=setTimeout(()=>{!P&&e&&k(!0)},3e3);return()=>{clearTimeout(A),typeof j.off=="function"&&(j.off("ready",$),j.off("canplay",$),j.off("loadeddata",$),j.off("playing",I))}}else{const $=setTimeout(()=>{b(!0),e&&k(!0)},1500);return()=>clearTimeout($)}},[S,e,P]);const E=(0,z.useRef)(null);(0,z.useEffect)(()=>{const j=n.current,$=j?.plyr;if(E.current&&(clearTimeout(E.current),E.current=null),!(!$||!d))return e?E.current=setTimeout(()=>{E.current=null;const I=n.current?.plyr;if(I&&typeof I.play=="function"){const A=ve();A&&A!==I&&(A.pause(),typeof A.currentTime<"u"&&(A.currentTime=0)),I.play().catch(()=>{const H=n.current?.plyr;H&&(H.muted=!0,H.play().catch(()=>{}))}).then(()=>{be(I)})}},50):typeof $.pause=="function"&&($.pause(),typeof $.currentTime<"u"&&($.currentTime=0),ve()===$&&be(null)),()=>{E.current&&(clearTimeout(E.current),E.current=null);const I=j?.plyr;I&&typeof I.pause=="function"&&(I.pause(),typeof I.currentTime<"u"&&(I.currentTime=0),ve()===I&&be(null))}},[e,d]),(0,z.useEffect)(()=>{const j=n.current;return()=>{E.current&&(clearTimeout(E.current),E.current=null);const $=j?.plyr;$&&($.pause(),$.currentTime=0,ve()===$&&be(null)),b(!1),k(!1),R(0)}},[]),(0,z.useEffect)(()=>{if(!i?.id||!e)return;(async()=>{try{const[$,I]=await Promise.all([ps(l.id,i.id),Es(i.id,l.user?.id)]);N($),f(I)}catch($){console.error("Failed to check interaction status:",$)}})()},[l.id,i?.id,e,l.user?.id]),(0,z.useEffect)(()=>{const j=n.current?.plyr;j&&(j.muted=s===0,j.volume=s)},[s,d]),(0,z.useEffect)(()=>{const j=n.current?.plyr;if(!j||!e)return;const $=()=>{const I=j.currentTime,A=j.duration;A>0&&R(I/A*100)};if(typeof j.on=="function")return j.on("timeupdate",$),()=>{typeof j.off=="function"&&j.off("timeupdate",$)}},[e]);const L=j=>{j.stopPropagation();const $=j.currentTarget.getBoundingClientRect(),I=j.clientX-$.left,A=Math.min(Math.max(0,I/$.width),1),H=n.current?.plyr;H&&H.duration&&(H.currentTime=A*H.duration,R(A*100))};(0,z.useEffect)(()=>()=>{T.current&&clearTimeout(T.current)},[]);const D=j=>{const $=j.target;$.closest("button")||$.closest("a")||$.closest(".plyr__controls")||(T.current?(clearTimeout(T.current),T.current=null,B()):T.current=setTimeout(()=>{T.current=null,U()},250))},U=()=>{const j=n.current?.plyr;j&&(j.paused?(j.play().catch(()=>{}),u("play")):(j.pause(),u("pause")),setTimeout(()=>u(null),800))},B=async()=>{if(i&&(x(!0),setTimeout(()=>x(!1),800),!y)){N(!0),C(j=>j+1);try{await nt(l.id,i.id)}catch{N(!1),C(j=>j-1)}}},G=async j=>{if(j.stopPropagation(),!i)return;const $=!y;N($),C(I=>$?I+1:I-1);try{await nt(l.id,i.id)}catch{N(!$),C(I=>$?I-1:I+1)}},V=async j=>{if(j.stopPropagation(),!i)return;const $=!_;f($);try{await ws(i.id,l.user?.id)}catch{f(!$)}},W=j=>{j.stopPropagation(),v(!0)},O=(0,z.useMemo)(()=>({source:{type:"video",sources:[{src:S,type:"video/mp4"}]},options:{controls:[],loop:{active:!0},clickToPlay:!1,ratio:"9:16",autoplay:!1,playsinline:!0,muted:!0}}),[S]);return(0,t.jsxs)("div",{"data-id":l.id,className:"reel-item relative flex h-[100dvh] w-full snap-start items-center justify-center overflow-hidden bg-black cursor-pointer select-none",onClick:D,children:[(0,t.jsxs)("div",{className:"relative flex h-full w-full max-w-[450px] items-center justify-center",children:[(0,t.jsx)("div",{className:"w-full",children:r?(0,t.jsx)(hs,{ref:n,...O}):(0,t.jsx)("div",{className:"aspect-[9/16] w-full bg-zinc-900",children:(0,t.jsx)("img",{src:l.media?.[0]?.preview||l.media?.[0]?.thumbnail||S,className:"h-full w-full object-cover opacity-50 blur-xl",alt:"Reel preview"})})}),!P&&(0,t.jsx)("div",{className:"absolute inset-0 z-[60] flex items-center justify-center bg-zinc-900 pointer-events-none",children:(0,t.jsx)(_s,{})}),(0,t.jsx)(Me,{children:c&&(0,t.jsx)(Q.div,{initial:{scale:0,opacity:0},animate:{scale:[0,1.2,1],opacity:1},exit:{scale:1.5,opacity:0},transition:{duration:.5,type:"spring",stiffness:400,damping:20},className:"pointer-events-none absolute inset-0 z-50 flex items-center justify-center",children:(0,t.jsx)(je,{size:120,fill:"white",className:"text-white drop-shadow-[0_0_30px_rgba(255,255,255,0.4)]"})})}),(0,t.jsx)(Me,{children:p&&(0,t.jsx)(Q.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},exit:{scale:1.5,opacity:0},transition:{duration:.4},className:"absolute inset-0 z-50 flex items-center justify-center",onClick:j=>{j.stopPropagation(),U()},children:(0,t.jsx)("div",{className:"rounded-full border border-white/20 bg-white/10 p-8 shadow-2xl backdrop-blur-md cursor-pointer hover:bg-white/20 transition-colors",children:p==="play"?(0,t.jsx)($e,{size:50,fill:"white",className:"ml-1.5 text-white"}):(0,t.jsx)(us,{size:50,fill:"white",className:"text-white"})})})}),(0,t.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-black/60"}),(0,t.jsxs)("div",{className:"pointer-events-none absolute bottom-6 left-4 right-16 text-white",children:[(0,t.jsxs)("div",{className:"pointer-events-auto mb-3 flex items-center gap-2",children:[(0,t.jsxs)(Qt,{to:`/u/${l.user?.handle}`,className:"flex items-center gap-2 transition-opacity hover:opacity-80 active:scale-95",onClick:j=>j.stopPropagation(),children:[(0,t.jsxs)(ae,{className:"size-10 border-2 border-white",children:[(0,t.jsx)(le,{src:l.user?.avatar,alt:l.user?.handle,className:"object-cover"}),(0,t.jsx)(ie,{children:l.user?.handle?.[0]?.toUpperCase()})]}),(0,t.jsxs)("span",{className:"font-bold",children:["@",l.user?.handle]})]}),i?.id!==l.user?.id&&(0,t.jsx)("button",{className:`ml-2 flex items-center gap-1.5 rounded-full px-3 py-1.5 text-xs font-bold transition-all active:scale-95 ${_?"border border-white/50 bg-transparent text-white":"bg-white text-black hover:bg-zinc-200"}`,onClick:V,children:_?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ks,{size:14}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Following"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(js,{size:14}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Follow"})]})})]}),(0,t.jsx)(De,{content:l.content,className:"mb-3 line-clamp-2 text-sm text-white"}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs opacity-90",children:[(0,t.jsx)(ms,{size:14,className:"animate-spin-slow"}),(0,t.jsxs)("span",{children:["Original Audio - ",l.user?.handle]})]})]}),(0,t.jsxs)("div",{className:"absolute bottom-6 right-2 z-10 flex flex-col items-center gap-6",children:[(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)(Q.button,{whileTap:{scale:.8},className:`rounded-full p-3 backdrop-blur-md transition-all ${y?"bg-rose-500/20 text-rose-500":"bg-zinc-800/50 text-white hover:bg-zinc-700"}`,onClick:G,children:(0,t.jsx)(Q.div,{animate:y?{scale:[1,1.3,1]}:{scale:1},transition:{duration:.3},children:(0,t.jsx)(je,{size:28,fill:y?"currentColor":"none"})})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:w})]}),(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)(Q.button,{whileTap:{scale:.8},className:"rounded-full bg-zinc-800/50 p-3 text-white backdrop-blur-md transition-colors hover:bg-zinc-700",onClick:j=>{j.stopPropagation(),m(!0)},children:(0,t.jsx)(Pt,{size:28})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:l.stats?.comments||0})]}),(0,t.jsxs)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:[(0,t.jsx)(Q.button,{whileTap:{scale:.8},className:"rounded-full bg-zinc-800/50 p-3 text-white backdrop-blur-md transition-colors hover:bg-zinc-700",onClick:W,children:(0,t.jsx)(ye,{size:28})}),(0,t.jsx)("span",{className:"text-xs font-bold text-white",children:l.stats?.shares||0})]}),(0,t.jsx)("div",{className:"pointer-events-auto flex flex-col items-center gap-1",children:(0,t.jsx)(Q.button,{whileTap:{scale:.8},className:"rounded-full bg-zinc-800/50 p-3 text-white backdrop-blur-md transition-colors hover:bg-rose-500/20 hover:text-rose-500",onClick:j=>{j.stopPropagation(),o("reel",l.id)},children:(0,t.jsx)(Fe,{size:28})})})]}),(0,t.jsx)("div",{className:"absolute bottom-0 left-0 z-50 h-[3px] w-full bg-white/20 hover:h-[8px] transition-all cursor-pointer group",onClick:L,children:(0,t.jsx)("div",{className:"h-full bg-white shadow-[0_0_8px_rgba(255,255,255,0.8)] transition-all duration-100 ease-linear relative",style:{width:`${F}%`},children:(0,t.jsx)("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 size-3 bg-white rounded-full shadow-lg scale-0 group-hover:scale-100 transition-transform"})})})]}),(0,t.jsx)(Ul,{isOpen:g,onClose:()=>m(!1),reelId:l.id,currentUser:i,showToast:a}),(0,t.jsx)(Lt,{isOpen:h,onClose:()=>v(!1),url:Bs(l.id),title:"Share Reel",overlayClassName:"z-[9999]"})]})},(l,e)=>l.isActive===e.isActive&&l.reel.id===e.reel.id&&l.volume===e.volume&&l.shouldLoad===e.shouldLoad),Kl=Dl,Al=({isOpen:l,onClose:e,reelId:s,currentUser:r,showToast:i})=>{const[a,o]=(0,z.useState)([]),[n,c]=(0,z.useState)(!1),[x,g]=(0,z.useState)(!1),[m,h]=(0,z.useState)(""),[v,d]=(0,z.useState)([]),[b,p]=(0,z.useState)(!1),[u,y]=(0,z.useState)(!0),[N,w]=(0,z.useState)(!1),[C,_]=(0,z.useState)(null),f=(0,z.useRef)(a);(0,z.useEffect)(()=>{f.current=a},[a]);const F=(0,z.useCallback)(async(P=!1)=>{if(!(!s||s.startsWith("temp-"))){P?w(!0):c(!0);try{const k=f.current,T=await Us(s,P&&k.length>0?k[k.length-1].created_at:null,10);T.length<10?y(!1):y(!0),o(P?S=>[...S,...T]:T)}catch(k){console.error("Failed to load comments:",k),i&&i("Failed to load comments","error")}finally{c(!1),w(!1)}}},[s,i]);(0,z.useEffect)(()=>{l&&s?F():(o([]),y(!0))},[l,s,F]);const R=async P=>{if(P.preventDefault(),!(!m.trim()&&v.length===0||!r)){g(!0),p(!0);try{const k=[];for(const T of v){const S=await Re(T);k.push(S)}await Ss(s,r.id,m,k,C?.id),h(""),d([]),_(null),i&&i("Reply posted!"),F()}catch(k){console.error("Failed to post comment:",k),i&&i("Failed to post reply.","error")}finally{g(!1),p(!1)}}};return(0,t.jsx)(Rt,{isOpen:l,onClose:e,title:"Comments",className:"max-sm:h-[95dvh] h-[85vh] overflow-hidden !p-0 sm:max-w-xl",children:(0,t.jsxs)("div",{className:"flex h-full flex-col overflow-hidden bg-white dark:bg-zinc-900",children:[(0,t.jsx)("div",{className:"mx-auto my-3 h-1.5 w-12 shrink-0 rounded-full bg-zinc-200 dark:bg-zinc-800 sm:hidden"}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto scroll-smooth scrollbar-thin scrollbar-thumb-zinc-200 dark:scrollbar-thumb-zinc-800",children:n?(0,t.jsx)("div",{className:"flex flex-col",children:[1,2,3].map(P=>(0,t.jsx)(Ts,{},P))}):a.length>0?(0,t.jsxs)("div",{className:"flex flex-col",children:[a.map(P=>(0,t.jsx)(Rl,{...P,isComment:!0,post_id:s,currentUser:r,showToast:i,onReply:(k,T)=>{_(T?{handle:k,id:T}:null),h(S=>S.includes(`@${k}`)?S:S+`@${k} `)},onDelete:k=>o(T=>T.filter(S=>S.id!==k)),onUpdate:(k,T,S)=>o(E=>E.map(L=>L.id===k?{...L,content:T,media:S}:L))},P.id)),u&&(0,t.jsx)("div",{className:"flex justify-center border-t border-zinc-100 py-4 dark:border-zinc-800",children:(0,t.jsx)(Ft,{variant:"ghost",onClick:()=>F(!0),loading:N,className:"text-violet-600 font-bold",children:"View more replies"})})]}):(0,t.jsxs)("div",{className:"flex h-full min-h-[300px] flex-col items-center justify-center p-8 text-center text-zinc-500",children:[(0,t.jsx)("div",{className:"mb-4 flex size-16 items-center justify-center rounded-full bg-zinc-100 dark:bg-zinc-900",children:(0,t.jsx)($t,{size:32,className:"text-zinc-400"})}),(0,t.jsx)("p",{className:"text-lg font-bold dark:text-zinc-300",children:"No comments yet"}),(0,t.jsx)("p",{className:"text-sm dark:text-zinc-500",children:"Be the first to share what you think!"})]})}),(0,t.jsxs)("div",{className:"shrink-0 border-t border-zinc-100 bg-white pb-safe dark:border-zinc-800 dark:bg-zinc-900",children:[C&&(0,t.jsxs)("div",{className:"flex items-center justify-between border-b border-zinc-50 bg-zinc-50/50 px-4 py-2 dark:border-zinc-800/50 dark:bg-zinc-900/50",children:[(0,t.jsxs)("span",{className:"text-xs text-zinc-500",children:["Replying to"," ",(0,t.jsxs)("span",{className:"font-bold text-violet-600",children:["@",C.handle]})]}),(0,t.jsx)("button",{onClick:()=>_(null),className:"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200",children:(0,t.jsx)(de,{size:14})})]}),(0,t.jsx)(It,{currentUser:r,newComment:m,setNewComment:h,handleSubmitComment:R,loading:x,selectedFiles:v,setSelectedFiles:d,isUploading:b})]})]})})},Ul=Al;export{Jl as n,Rl as r,Kl as t};
